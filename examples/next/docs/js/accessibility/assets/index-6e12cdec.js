var KD=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Xae=KD((hle,pd)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Fr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function cC(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function gO(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var Tc=function(t){return t&&t.Math===Math&&t},Rn=Tc(typeof globalThis=="object"&&globalThis)||Tc(typeof window=="object"&&window)||Tc(typeof self=="object"&&self)||Tc(typeof Fr=="object"&&Fr)||function(){return this}()||Fr||Function("return this")(),hC={},vr=function(t){try{return!!t()}catch{return!0}},XD=vr,mi=!XD(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),qD=vr,lf=!qD(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),ZD=lf,_c=Function.prototype.call,uf=ZD?_c.bind(_c):function(){return _c.apply(_c,arguments)},mO={},pO={}.propertyIsEnumerable,wO=Object.getOwnPropertyDescriptor,QD=wO&&!pO.call({1:2},1);mO.f=QD?function(e){var n=wO(this,e);return!!n&&n.enumerable}:pO;var dC=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},CO=lf,vO=Function.prototype,Kp=vO.call,JD=CO&&vO.bind.bind(Kp,Kp),Fn=CO?JD:function(t){return function(){return Kp.apply(t,arguments)}},SO=Fn,eN=SO({}.toString),tN=SO("".slice),ul=function(t){return tN(eN(t),8,-1)},nN=Fn,rN=vr,iN=ul,cg=Object,oN=nN("".split),sN=rN(function(){return!cg("z").propertyIsEnumerable(0)})?function(t){return iN(t)==="String"?oN(t,""):cg(t)}:cg,yO=function(t){return t==null},aN=yO,lN=TypeError,bO=function(t){if(aN(t))throw lN("Can't call method on "+t);return t},uN=sN,cN=bO,cf=function(t){return uN(cN(t))},Xp=typeof document=="object"&&document.all,hN=typeof Xp>"u"&&Xp!==void 0,RO={all:Xp,IS_HTMLDDA:hN},EO=RO,dN=EO.all,dn=EO.IS_HTMLDDA?function(t){return typeof t=="function"||t===dN}:function(t){return typeof t=="function"},vb=dn,TO=RO,fN=TO.all,js=TO.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:vb(t)||t===fN}:function(t){return typeof t=="object"?t!==null:vb(t)},hg=Rn,gN=dn,mN=function(t){return gN(t)?t:void 0},Qu=function(t,e){return arguments.length<2?mN(hg[t]):hg[t]&&hg[t][e]},pN=Fn,_O=pN({}.isPrototypeOf),fC=typeof navigator<"u"&&String(navigator.userAgent)||"",MO=Rn,dg=fC,Sb=MO.process,yb=MO.Deno,bb=Sb&&Sb.versions||yb&&yb.version,Rb=bb&&bb.v8,Lr,wd;Rb&&(Lr=Rb.split("."),wd=Lr[0]>0&&Lr[0]<4?1:+(Lr[0]+Lr[1]));!wd&&dg&&(Lr=dg.match(/Edge\/(\d+)/),(!Lr||Lr[1]>=74)&&(Lr=dg.match(/Chrome\/(\d+)/),Lr&&(wd=+Lr[1])));var wN=wd,Eb=wN,CN=vr,vN=Rn,SN=vN.String,gC=!!Object.getOwnPropertySymbols&&!CN(function(){var t=Symbol("symbol detection");return!SN(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Eb&&Eb<41}),yN=gC,AO=yN&&!Symbol.sham&&typeof Symbol.iterator=="symbol",bN=Qu,RN=dn,EN=_O,TN=AO,_N=Object,mC=TN?function(t){return typeof t=="symbol"}:function(t){var e=bN("Symbol");return RN(e)&&EN(e.prototype,_N(t))},MN=String,OO=function(t){try{return MN(t)}catch{return"Object"}},AN=dn,ON=OO,PN=TypeError,pC=function(t){if(AN(t))return t;throw PN(ON(t)+" is not a function")},IN=pC,xN=yO,HN=function(t,e){var n=t[e];return xN(n)?void 0:IN(n)},fg=uf,gg=dn,mg=js,DN=TypeError,NN=function(t,e){var n,r;if(e==="string"&&gg(n=t.toString)&&!mg(r=fg(n,t))||gg(n=t.valueOf)&&!mg(r=fg(n,t))||e!=="string"&&gg(n=t.toString)&&!mg(r=fg(n,t)))return r;throw DN("Can't convert object to primitive value")},PO={exports:{}},Tb=Rn,LN=Object.defineProperty,wC=function(t,e){try{LN(Tb,t,{value:e,configurable:!0,writable:!0})}catch{Tb[t]=e}return e},kN=Rn,$N=wC,_b="__core-js_shared__",FN=kN[_b]||$N(_b,{}),CC=FN,Mb=CC;(PO.exports=function(t,e){return Mb[t]||(Mb[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.32.2",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.2/LICENSE",source:"https://github.com/zloirock/core-js"});var IO=PO.exports,WN=bO,VN=Object,hf=function(t){return VN(WN(t))},BN=Fn,UN=hf,zN=BN({}.hasOwnProperty),ro=Object.hasOwn||function(e,n){return zN(UN(e),n)},GN=Fn,YN=0,jN=Math.random(),KN=GN(1 .toString),xO=function(t){return"Symbol("+(t===void 0?"":t)+")_"+KN(++YN+jN,36)},XN=Rn,qN=IO,Ab=ro,ZN=xO,QN=gC,JN=AO,ja=XN.Symbol,pg=qN("wks"),eL=JN?ja.for||ja:ja&&ja.withoutSetter||ZN,df=function(t){return Ab(pg,t)||(pg[t]=QN&&Ab(ja,t)?ja[t]:eL("Symbol."+t)),pg[t]},tL=uf,Ob=js,Pb=mC,nL=HN,rL=NN,iL=df,oL=TypeError,sL=iL("toPrimitive"),aL=function(t,e){if(!Ob(t)||Pb(t))return t;var n=nL(t,sL),r;if(n){if(e===void 0&&(e="default"),r=tL(n,t,e),!Ob(r)||Pb(r))return r;throw oL("Can't convert object to primitive value")}return e===void 0&&(e="number"),rL(t,e)},lL=aL,uL=mC,HO=function(t){var e=lL(t,"string");return uL(e)?e:e+""},cL=Rn,Ib=js,qp=cL.document,hL=Ib(qp)&&Ib(qp.createElement),vC=function(t){return hL?qp.createElement(t):{}},dL=mi,fL=vr,gL=vC,DO=!dL&&!fL(function(){return Object.defineProperty(gL("div"),"a",{get:function(){return 7}}).a!==7}),mL=mi,pL=uf,wL=mO,CL=dC,vL=cf,SL=HO,yL=ro,bL=DO,xb=Object.getOwnPropertyDescriptor;hC.f=mL?xb:function(e,n){if(e=vL(e),n=SL(n),bL)try{return xb(e,n)}catch{}if(yL(e,n))return CL(!pL(wL.f,e,n),e[n])};var Ks={},RL=mi,EL=vr,NO=RL&&EL(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),TL=js,_L=String,ML=TypeError,Ju=function(t){if(TL(t))return t;throw ML(_L(t)+" is not an object")},AL=mi,OL=DO,PL=NO,Mc=Ju,Hb=HO,IL=TypeError,wg=Object.defineProperty,xL=Object.getOwnPropertyDescriptor,Cg="enumerable",vg="configurable",Sg="writable";Ks.f=AL?PL?function(e,n,r){if(Mc(e),n=Hb(n),Mc(r),typeof e=="function"&&n==="prototype"&&"value"in r&&Sg in r&&!r[Sg]){var i=xL(e,n);i&&i[Sg]&&(e[n]=r.value,r={configurable:vg in r?r[vg]:i[vg],enumerable:Cg in r?r[Cg]:i[Cg],writable:!1})}return wg(e,n,r)}:wg:function(e,n,r){if(Mc(e),n=Hb(n),Mc(r),OL)try{return wg(e,n,r)}catch{}if("get"in r||"set"in r)throw IL("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var HL=mi,DL=Ks,NL=dC,ec=HL?function(t,e,n){return DL.f(t,e,NL(1,n))}:function(t,e,n){return t[e]=n,t},LO={exports:{}},Zp=mi,LL=ro,kO=Function.prototype,kL=Zp&&Object.getOwnPropertyDescriptor,SC=LL(kO,"name"),$L=SC&&(function(){}).name==="something",FL=SC&&(!Zp||Zp&&kL(kO,"name").configurable),WL={EXISTS:SC,PROPER:$L,CONFIGURABLE:FL},VL=Fn,BL=dn,Qp=CC,UL=VL(Function.toString);BL(Qp.inspectSource)||(Qp.inspectSource=function(t){return UL(t)});var zL=Qp.inspectSource,GL=Rn,YL=dn,Db=GL.WeakMap,jL=YL(Db)&&/native code/.test(String(Db)),KL=IO,XL=xO,Nb=KL("keys"),$O=function(t){return Nb[t]||(Nb[t]=XL(t))},yC={},qL=jL,FO=Rn,ZL=js,QL=ec,yg=ro,bg=CC,JL=$O,ek=yC,Lb="Object already initialized",Jp=FO.TypeError,tk=FO.WeakMap,Cd,xu,vd,nk=function(t){return vd(t)?xu(t):Cd(t,{})},rk=function(t){return function(e){var n;if(!ZL(e)||(n=xu(e)).type!==t)throw Jp("Incompatible receiver, "+t+" required");return n}};if(qL||bg.state){var jr=bg.state||(bg.state=new tk);jr.get=jr.get,jr.has=jr.has,jr.set=jr.set,Cd=function(t,e){if(jr.has(t))throw Jp(Lb);return e.facade=t,jr.set(t,e),e},xu=function(t){return jr.get(t)||{}},vd=function(t){return jr.has(t)}}else{var oa=JL("state");ek[oa]=!0,Cd=function(t,e){if(yg(t,oa))throw Jp(Lb);return e.facade=t,QL(t,oa,e),e},xu=function(t){return yg(t,oa)?t[oa]:{}},vd=function(t){return yg(t,oa)}}var ik={set:Cd,get:xu,has:vd,enforce:nk,getterFor:rk},bC=Fn,ok=vr,sk=dn,Ac=ro,ew=mi,ak=WL.CONFIGURABLE,lk=zL,WO=ik,uk=WO.enforce,ck=WO.get,kb=String,Uh=Object.defineProperty,hk=bC("".slice),dk=bC("".replace),fk=bC([].join),gk=ew&&!ok(function(){return Uh(function(){},"length",{value:8}).length!==8}),mk=String(String).split("String"),pk=LO.exports=function(t,e,n){hk(kb(e),0,7)==="Symbol("&&(e="["+dk(kb(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Ac(t,"name")||ak&&t.name!==e)&&(ew?Uh(t,"name",{value:e,configurable:!0}):t.name=e),gk&&n&&Ac(n,"arity")&&t.length!==n.arity&&Uh(t,"length",{value:n.arity});try{n&&Ac(n,"constructor")&&n.constructor?ew&&Uh(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=uk(t);return Ac(r,"source")||(r.source=fk(mk,typeof e=="string"?e:"")),t};Function.prototype.toString=pk(function(){return sk(this)&&ck(this).source||lk(this)},"toString");var wk=LO.exports,Ck=dn,vk=Ks,Sk=wk,yk=wC,bk=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(Ck(n)&&Sk(n,o,r),r.global)i?t[e]=n:yk(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:vk.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},VO={},Rk=Math.ceil,Ek=Math.floor,Tk=Math.trunc||function(e){var n=+e;return(n>0?Ek:Rk)(n)},_k=Tk,RC=function(t){var e=+t;return e!==e||e===0?0:_k(e)},Mk=RC,Ak=Math.max,Ok=Math.min,Pk=function(t,e){var n=Mk(t);return n<0?Ak(n+e,0):Ok(n,e)},Ik=RC,xk=Math.min,Hk=function(t){return t>0?xk(Ik(t),9007199254740991):0},Dk=Hk,ff=function(t){return Dk(t.length)},Nk=cf,Lk=Pk,kk=ff,$b=function(t){return function(e,n,r){var i=Nk(e),o=kk(i),s=Lk(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},$k={includes:$b(!0),indexOf:$b(!1)},Fk=Fn,Rg=ro,Wk=cf,Vk=$k.indexOf,Bk=yC,Fb=Fk([].push),BO=function(t,e){var n=Wk(t),r=0,i=[],o;for(o in n)!Rg(Bk,o)&&Rg(n,o)&&Fb(i,o);for(;e.length>r;)Rg(n,o=e[r++])&&(~Vk(i,o)||Fb(i,o));return i},EC=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Uk=BO,zk=EC,Gk=zk.concat("length","prototype");VO.f=Object.getOwnPropertyNames||function(e){return Uk(e,Gk)};var UO={};UO.f=Object.getOwnPropertySymbols;var Yk=Qu,jk=Fn,Kk=VO,Xk=UO,qk=Ju,Zk=jk([].concat),Qk=Yk("Reflect","ownKeys")||function(e){var n=Kk.f(qk(e)),r=Xk.f;return r?Zk(n,r(e)):n},Wb=ro,Jk=Qk,e$=hC,t$=Ks,zO=function(t,e,n){for(var r=Jk(e),i=t$.f,o=e$.f,s=0;s<r.length;s++){var a=r[s];!Wb(t,a)&&!(n&&Wb(n,a))&&i(t,a,o(e,a))}},n$=vr,r$=dn,i$=/#|\.prototype\./,tc=function(t,e){var n=s$[o$(t)];return n===l$?!0:n===a$?!1:r$(e)?n$(e):!!e},o$=tc.normalize=function(t){return String(t).replace(i$,".").toLowerCase()},s$=tc.data={},a$=tc.NATIVE="N",l$=tc.POLYFILL="P",u$=tc,Eg=Rn,c$=hC.f,h$=ec,d$=bk,f$=wC,g$=zO,m$=u$,Xs=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=Eg:i?s=Eg[n]||f$(n,{}):s=(Eg[n]||{}).prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=c$(s,a),l=c&&c.value):l=s[a],o=m$(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;g$(u,l)}(t.sham||l&&l.sham)&&h$(u,"sham",!0),d$(s,a,u,t)}},p$=ul,GO=Array.isArray||function(e){return p$(e)==="Array"},w$=mi,C$=GO,v$=TypeError,S$=Object.getOwnPropertyDescriptor,y$=w$&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),YO=y$?function(t,e){if(C$(t)&&!S$(t,"length").writable)throw v$("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},b$=TypeError,R$=9007199254740991,jO=function(t){if(t>R$)throw b$("Maximum allowed index exceeded");return t},E$=Xs,T$=hf,_$=ff,M$=YO,A$=jO,O$=vr,P$=O$(function(){return[].push.call({length:4294967296},1)!==4294967297}),I$=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},x$=P$||!I$();E$({target:"Array",proto:!0,arity:1,forced:x$},{push:function(e){var n=T$(this),r=_$(n),i=arguments.length;A$(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return M$(n,r),r}});var H$=lf,KO=Function.prototype,Vb=KO.apply,Bb=KO.call,gf=typeof Reflect=="object"&&Reflect.apply||(H$?Bb.bind(Vb):function(){return Bb.apply(Vb,arguments)}),D$=Fn,N$=pC,L$=function(t,e,n){try{return D$(N$(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},k$=dn,$$=String,F$=TypeError,W$=function(t){if(typeof t=="object"||k$(t))return t;throw F$("Can't set "+$$(t)+" as a prototype")},V$=L$,B$=Ju,U$=W$,XO=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=V$(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return B$(i),U$(o),t?n(i,o):i.__proto__=o,i}}():void 0),z$=Ks.f,G$=function(t,e,n){n in t||z$(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},Y$=dn,j$=js,Ub=XO,K$=function(t,e,n){var r,i;return Ub&&Y$(r=e.constructor)&&r!==n&&j$(i=r.prototype)&&i!==n.prototype&&Ub(t,i),t},X$=df,q$=X$("toStringTag"),qO={};qO[q$]="z";var Z$=String(qO)==="[object z]",Q$=Z$,J$=dn,zh=ul,eF=df,tF=eF("toStringTag"),nF=Object,rF=zh(function(){return arguments}())==="Arguments",iF=function(t,e){try{return t[e]}catch{}},oF=Q$?zh:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=iF(e=nF(t),tF))=="string"?n:rF?zh(e):(r=zh(e))==="Object"&&J$(e.callee)?"Arguments":r},sF=oF,aF=String,ZO=function(t){if(sF(t)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return aF(t)},lF=ZO,uF=function(t,e){return t===void 0?arguments.length<2?"":e:lF(t)},cF=js,hF=ec,dF=function(t,e){cF(e)&&"cause"in e&&hF(t,"cause",e.cause)},fF=Fn,QO=Error,gF=fF("".replace),mF=function(t){return String(QO(t).stack)}("zxcasd"),JO=/\n\s*at [^:]*:[^\n]*/,pF=JO.test(mF),wF=function(t,e){if(pF&&typeof t=="string"&&!QO.prepareStackTrace)for(;e--;)t=gF(t,JO,"");return t},CF=vr,vF=dC,SF=!CF(function(){var t=Error("a");return"stack"in t?(Object.defineProperty(t,"stack",vF(1,7)),t.stack!==7):!0}),yF=ec,bF=wF,RF=SF,zb=Error.captureStackTrace,EF=function(t,e,n,r){RF&&(zb?zb(t,e):yF(t,"stack",bF(n,r)))},Gb=Qu,TF=ro,Yb=ec,_F=_O,jb=XO,Kb=zO,Xb=G$,MF=K$,AF=uF,OF=dF,PF=EF,IF=mi,xF=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=Gb.apply(null,s);if(l){var u=l.prototype;if(TF(u,"cause")&&delete u.cause,!n)return l;var c=Gb("Error"),h=e(function(f,g){var w=AF(r?g:f,void 0),C=r?new l(f):new l;return w!==void 0&&Yb(C,"message",w),PF(C,h,C.stack,2),this&&_F(u,this)&&MF(C,this,h),arguments.length>o&&OF(C,arguments[o]),C});h.prototype=u,a!=="Error"?jb?jb(h,c):Kb(h,c,{name:!0}):IF&&i in l&&(Xb(h,l,i),Xb(h,l,"prepareStackTrace")),Kb(h,l);try{u.name!==a&&Yb(u,"name",a),u.constructor=h}catch{}return h}},eP=Xs,HF=Rn,pi=gf,tP=xF,tw="WebAssembly",qb=HF[tw],Sd=Error("e",{cause:7}).cause!==7,qs=function(t,e){var n={};n[t]=tP(t,e,Sd),eP({global:!0,constructor:!0,arity:1,forced:Sd},n)},TC=function(t,e){if(qb&&qb[t]){var n={};n[t]=tP(tw+"."+t,e,Sd),eP({target:tw,stat:!0,constructor:!0,arity:1,forced:Sd},n)}};qs("Error",function(t){return function(n){return pi(t,this,arguments)}});qs("EvalError",function(t){return function(n){return pi(t,this,arguments)}});qs("RangeError",function(t){return function(n){return pi(t,this,arguments)}});qs("ReferenceError",function(t){return function(n){return pi(t,this,arguments)}});qs("SyntaxError",function(t){return function(n){return pi(t,this,arguments)}});qs("TypeError",function(t){return function(n){return pi(t,this,arguments)}});qs("URIError",function(t){return function(n){return pi(t,this,arguments)}});TC("CompileError",function(t){return function(n){return pi(t,this,arguments)}});TC("LinkError",function(t){return function(n){return pi(t,this,arguments)}});TC("RuntimeError",function(t){return function(n){return pi(t,this,arguments)}});var DF=ul,NF=Fn,LF=function(t){if(DF(t)==="Function")return NF(t)},Zb=LF,kF=pC,$F=lf,FF=Zb(Zb.bind),WF=function(t,e){return kF(t),e===void 0?t:$F?FF(t,e):function(){return t.apply(e,arguments)}},VF=Qu,nP=VF("document","documentElement"),BF=Fn,_C=BF([].slice),UF=TypeError,rP=function(t,e){if(t<e)throw UF("Not enough arguments");return t},zF=fC,GF=/(?:ipad|iphone|ipod).*applewebkit/i.test(zF),YF=Rn,jF=ul,KF=jF(YF.process)==="process",ir=Rn,XF=gf,qF=WF,Qb=dn,ZF=ro,iP=vr,Jb=nP,QF=_C,eR=vC,JF=rP,eW=GF,tW=KF,nw=ir.setImmediate,rw=ir.clearImmediate,nW=ir.process,Tg=ir.Dispatch,rW=ir.Function,tR=ir.MessageChannel,iW=ir.String,_g=0,gu={},nR="onreadystatechange",Hu,Qo,Mg,Ag;iP(function(){Hu=ir.location});var MC=function(t){if(ZF(gu,t)){var e=gu[t];delete gu[t],e()}},Og=function(t){return function(){MC(t)}},rR=function(t){MC(t.data)},iR=function(t){ir.postMessage(iW(t),Hu.protocol+"//"+Hu.host)};(!nw||!rw)&&(nw=function(e){JF(arguments.length,1);var n=Qb(e)?e:rW(e),r=QF(arguments,1);return gu[++_g]=function(){XF(n,void 0,r)},Qo(_g),_g},rw=function(e){delete gu[e]},tW?Qo=function(t){nW.nextTick(Og(t))}:Tg&&Tg.now?Qo=function(t){Tg.now(Og(t))}:tR&&!eW?(Mg=new tR,Ag=Mg.port2,Mg.port1.onmessage=rR,Qo=qF(Ag.postMessage,Ag)):ir.addEventListener&&Qb(ir.postMessage)&&!ir.importScripts&&Hu&&Hu.protocol!=="file:"&&!iP(iR)?(Qo=iR,ir.addEventListener("message",rR,!1)):nR in eR("script")?Qo=function(t){Jb.appendChild(eR("script"))[nR]=function(){Jb.removeChild(this),MC(t)}}:Qo=function(t){setTimeout(Og(t),0)});var oP={set:nw,clear:rw},oW=Xs,sW=Rn,oR=oP.clear;oW({global:!0,bind:!0,enumerable:!0,forced:sW.clearImmediate!==oR},{clearImmediate:oR});var aW=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",sP=Rn,lW=gf,uW=dn,cW=aW,hW=fC,dW=_C,fW=rP,gW=sP.Function,mW=/MSIE .\./.test(hW)||cW&&function(){var t=sP.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),pW=function(t,e){var n=e?2:1;return mW?function(r,i){var o=fW(arguments.length,1)>n,s=uW(r)?r:gW(r),a=o?dW(arguments,n):[],l=o?function(){lW(s,this,a)}:s;return e?t(l,i):t(l)}:t},wW=Xs,aP=Rn,sR=oP.set,CW=pW,aR=aP.setImmediate?CW(sR,!1):sR;wW({global:!0,bind:!0,enumerable:!0,forced:aP.setImmediate!==aR},{setImmediate:aR});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function Mo(t){"@babel/helpers - typeof";return Mo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mo(t)}function iw(t,e){return iw=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},iw(t,e)}function vW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gh(t,e,n){return vW()?Gh=Reflect.construct:Gh=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),u=new l;return s&&iw(u,s.prototype),u},Gh.apply(null,arguments)}function xr(t){return SW(t)||yW(t)||bW(t)||RW()}function SW(t){if(Array.isArray(t))return ow(t)}function yW(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bW(t,e){if(t){if(typeof t=="string")return ow(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ow(t,e)}}function ow(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function RW(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var EW=Object.hasOwnProperty,lR=Object.setPrototypeOf,TW=Object.isFrozen,_W=Object.getPrototypeOf,MW=Object.getOwnPropertyDescriptor,$n=Object.freeze,Vr=Object.seal,AW=Object.create,lP=typeof Reflect<"u"&&Reflect,yd=lP.apply,sw=lP.construct;yd||(yd=function(e,n,r){return e.apply(n,r)});$n||($n=function(e){return e});Vr||(Vr=function(e){return e});sw||(sw=function(e,n){return Gh(e,xr(n))});var OW=Cr(Array.prototype.forEach),uR=Cr(Array.prototype.pop),Rl=Cr(Array.prototype.push),Yh=Cr(String.prototype.toLowerCase),Pg=Cr(String.prototype.toString),PW=Cr(String.prototype.match),Rr=Cr(String.prototype.replace),IW=Cr(String.prototype.indexOf),xW=Cr(String.prototype.trim),Mn=Cr(RegExp.prototype.test),Ig=HW(TypeError);function Cr(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return yd(t,e,r)}}function HW(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return sw(t,n)}}function je(t,e,n){var r;n=(r=n)!==null&&r!==void 0?r:Yh,lR&&lR(t,null);for(var i=e.length;i--;){var o=e[i];if(typeof o=="string"){var s=n(o);s!==o&&(TW(e)||(e[i]=s),o=s)}t[o]=!0}return t}function Jo(t){var e=AW(null),n;for(n in t)yd(EW,t,[n])===!0&&(e[n]=t[n]);return e}function Oc(t,e){for(;t!==null;){var n=MW(t,e);if(n){if(n.get)return Cr(n.get);if(typeof n.value=="function")return Cr(n.value)}t=_W(t)}function r(i){return console.warn("fallback value for",i),null}return r}var cR=$n(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),xg=$n(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Hg=$n(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),DW=$n(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Dg=$n(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),NW=$n(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),hR=$n(["#text"]),dR=$n(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Ng=$n(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),fR=$n(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Pc=$n(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),LW=Vr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),kW=Vr(/<%[\w\W]*|[\w\W]*%>/gm),$W=Vr(/\${[\w\W]*}/gm),FW=Vr(/^data-[\-\w.\u00B7-\uFFFF]/),WW=Vr(/^aria-[\-\w]+$/),VW=Vr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),BW=Vr(/^(?:\w+script|data):/i),UW=Vr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),zW=Vr(/^html$/i),GW=function(){return typeof window>"u"?null:window},YW=function(e,n){if(Mo(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function uP(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:GW(),e=function(L){return uP(L)};if(e.version="2.4.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,r=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,h=t.HTMLFormElement,f=t.DOMParser,g=t.trustedTypes,w=a.prototype,C=Oc(w,"cloneNode"),S=Oc(w,"nextSibling"),b=Oc(w,"childNodes"),_=Oc(w,"parentNode");if(typeof o=="function"){var O=r.createElement("template");O.content&&O.content.ownerDocument&&(r=O.content.ownerDocument)}var x=YW(g,n),I=x?x.createHTML(""):"",$=r,z=$.implementation,q=$.createNodeIterator,Y=$.createDocumentFragment,K=$.getElementsByTagName,te=n.importNode,oe={};try{oe=Jo(r).documentMode?r.documentMode:{}}catch{}var ie={};e.isSupported=typeof _=="function"&&z&&z.createHTMLDocument!==void 0&&oe!==9;var ue=LW,be=kW,Ue=$W,Ie=FW,R=WW,d=BW,m=UW,p=VW,E=null,M=je({},[].concat(xr(cR),xr(xg),xr(Hg),xr(Dg),xr(hR))),P=null,G=je({},[].concat(xr(dR),xr(Ng),xr(fR),xr(Pc))),V=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Z=null,Q=null,X=!0,he=!0,Me=!1,Te=!0,_e=!1,j=!1,Ye=!1,Fe=!1,ye=!1,xe=!1,Se=!1,v=!0,y=!1,A="user-content-",W=!0,H=!1,F={},D=null,N=je({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),B=null,k=je({},["audio","video","img","source","image","track"]),U=null,se=je({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),de="http://www.w3.org/1998/Math/MathML",Ce="http://www.w3.org/2000/svg",Ae="http://www.w3.org/1999/xhtml",ke=Ae,wt=!1,Xe=null,at=je({},[de,Ce,Ae],Pg),Rt,ia=["application/xhtml+xml","text/html"],yl="text/html",kt,an=null,Zo=r.createElement("form"),_n=function(L){return L instanceof RegExp||L instanceof Function},qt=function(L){an&&an===L||((!L||Mo(L)!=="object")&&(L={}),L=Jo(L),Rt=ia.indexOf(L.PARSER_MEDIA_TYPE)===-1?Rt=yl:Rt=L.PARSER_MEDIA_TYPE,kt=Rt==="application/xhtml+xml"?Pg:Yh,E="ALLOWED_TAGS"in L?je({},L.ALLOWED_TAGS,kt):M,P="ALLOWED_ATTR"in L?je({},L.ALLOWED_ATTR,kt):G,Xe="ALLOWED_NAMESPACES"in L?je({},L.ALLOWED_NAMESPACES,Pg):at,U="ADD_URI_SAFE_ATTR"in L?je(Jo(se),L.ADD_URI_SAFE_ATTR,kt):se,B="ADD_DATA_URI_TAGS"in L?je(Jo(k),L.ADD_DATA_URI_TAGS,kt):k,D="FORBID_CONTENTS"in L?je({},L.FORBID_CONTENTS,kt):N,Z="FORBID_TAGS"in L?je({},L.FORBID_TAGS,kt):{},Q="FORBID_ATTR"in L?je({},L.FORBID_ATTR,kt):{},F="USE_PROFILES"in L?L.USE_PROFILES:!1,X=L.ALLOW_ARIA_ATTR!==!1,he=L.ALLOW_DATA_ATTR!==!1,Me=L.ALLOW_UNKNOWN_PROTOCOLS||!1,Te=L.ALLOW_SELF_CLOSE_IN_ATTR!==!1,_e=L.SAFE_FOR_TEMPLATES||!1,j=L.WHOLE_DOCUMENT||!1,ye=L.RETURN_DOM||!1,xe=L.RETURN_DOM_FRAGMENT||!1,Se=L.RETURN_TRUSTED_TYPE||!1,Fe=L.FORCE_BODY||!1,v=L.SANITIZE_DOM!==!1,y=L.SANITIZE_NAMED_PROPS||!1,W=L.KEEP_CONTENT!==!1,H=L.IN_PLACE||!1,p=L.ALLOWED_URI_REGEXP||p,ke=L.NAMESPACE||Ae,V=L.CUSTOM_ELEMENT_HANDLING||{},L.CUSTOM_ELEMENT_HANDLING&&_n(L.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(V.tagNameCheck=L.CUSTOM_ELEMENT_HANDLING.tagNameCheck),L.CUSTOM_ELEMENT_HANDLING&&_n(L.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(V.attributeNameCheck=L.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),L.CUSTOM_ELEMENT_HANDLING&&typeof L.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(V.allowCustomizedBuiltInElements=L.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),_e&&(he=!1),xe&&(ye=!0),F&&(E=je({},xr(hR)),P=[],F.html===!0&&(je(E,cR),je(P,dR)),F.svg===!0&&(je(E,xg),je(P,Ng),je(P,Pc)),F.svgFilters===!0&&(je(E,Hg),je(P,Ng),je(P,Pc)),F.mathMl===!0&&(je(E,Dg),je(P,fR),je(P,Pc))),L.ADD_TAGS&&(E===M&&(E=Jo(E)),je(E,L.ADD_TAGS,kt)),L.ADD_ATTR&&(P===G&&(P=Jo(P)),je(P,L.ADD_ATTR,kt)),L.ADD_URI_SAFE_ATTR&&je(U,L.ADD_URI_SAFE_ATTR,kt),L.FORBID_CONTENTS&&(D===N&&(D=Jo(D)),je(D,L.FORBID_CONTENTS,kt)),W&&(E["#text"]=!0),j&&je(E,["html","head","body"]),E.table&&(je(E,["tbody"]),delete Z.tbody),$n&&$n(L),an=L)},Ct=je({},["mi","mo","mn","ms","mtext"]),hb=je({},["foreignobject","desc","title","annotation-xml"]),zD=je({},["title","style","font","a","script"]),Rc=je({},xg);je(Rc,Hg),je(Rc,DW);var ag=je({},Dg);je(ag,NW);var GD=function(L){var re=_(L);(!re||!re.tagName)&&(re={namespaceURI:ke,tagName:"template"});var ae=Yh(L.tagName),st=Yh(re.tagName);return Xe[L.namespaceURI]?L.namespaceURI===Ce?re.namespaceURI===Ae?ae==="svg":re.namespaceURI===de?ae==="svg"&&(st==="annotation-xml"||Ct[st]):!!Rc[ae]:L.namespaceURI===de?re.namespaceURI===Ae?ae==="math":re.namespaceURI===Ce?ae==="math"&&hb[st]:!!ag[ae]:L.namespaceURI===Ae?re.namespaceURI===Ce&&!hb[st]||re.namespaceURI===de&&!Ct[st]?!1:!ag[ae]&&(zD[ae]||!Rc[ae]):!!(Rt==="application/xhtml+xml"&&Xe[L.namespaceURI]):!1},Si=function(L){Rl(e.removed,{element:L});try{L.parentNode.removeChild(L)}catch{try{L.outerHTML=I}catch{L.remove()}}},lg=function(L,re){try{Rl(e.removed,{attribute:re.getAttributeNode(L),from:re})}catch{Rl(e.removed,{attribute:null,from:re})}if(re.removeAttribute(L),L==="is"&&!P[L])if(ye||xe)try{Si(re)}catch{}else try{re.setAttribute(L,"")}catch{}},db=function(L){var re,ae;if(Fe)L="<remove></remove>"+L;else{var st=PW(L,/^[\r\n\t ]+/);ae=st&&st[0]}Rt==="application/xhtml+xml"&&ke===Ae&&(L='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+L+"</body></html>");var Vn=x?x.createHTML(L):L;if(ke===Ae)try{re=new f().parseFromString(Vn,Rt)}catch{}if(!re||!re.documentElement){re=z.createDocument(ke,"template",null);try{re.documentElement.innerHTML=wt?I:Vn}catch{}}var fn=re.body||re.documentElement;return L&&ae&&fn.insertBefore(r.createTextNode(ae),fn.childNodes[0]||null),ke===Ae?K.call(re,j?"html":"body")[0]:j?re.documentElement:fn},fb=function(L){return q.call(L.ownerDocument||L,L,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},YD=function(L){return L instanceof h&&(typeof L.nodeName!="string"||typeof L.textContent!="string"||typeof L.removeChild!="function"||!(L.attributes instanceof c)||typeof L.removeAttribute!="function"||typeof L.setAttribute!="function"||typeof L.namespaceURI!="string"||typeof L.insertBefore!="function"||typeof L.hasChildNodes!="function")},bl=function(L){return Mo(s)==="object"?L instanceof s:L&&Mo(L)==="object"&&typeof L.nodeType=="number"&&typeof L.nodeName=="string"},yi=function(L,re,ae){ie[L]&&OW(ie[L],function(st){st.call(e,re,ae,an)})},gb=function(L){var re;if(yi("beforeSanitizeElements",L,null),YD(L)||Mn(/[\u0080-\uFFFF]/,L.nodeName))return Si(L),!0;var ae=kt(L.nodeName);if(yi("uponSanitizeElement",L,{tagName:ae,allowedTags:E}),L.hasChildNodes()&&!bl(L.firstElementChild)&&(!bl(L.content)||!bl(L.content.firstElementChild))&&Mn(/<[/\w]/g,L.innerHTML)&&Mn(/<[/\w]/g,L.textContent)||ae==="select"&&Mn(/<template/i,L.innerHTML))return Si(L),!0;if(!E[ae]||Z[ae]){if(!Z[ae]&&pb(ae)&&(V.tagNameCheck instanceof RegExp&&Mn(V.tagNameCheck,ae)||V.tagNameCheck instanceof Function&&V.tagNameCheck(ae)))return!1;if(W&&!D[ae]){var st=_(L)||L.parentNode,Vn=b(L)||L.childNodes;if(Vn&&st)for(var fn=Vn.length,ln=fn-1;ln>=0;--ln)st.insertBefore(C(Vn[ln],!0),S(L))}return Si(L),!0}return L instanceof a&&!GD(L)||(ae==="noscript"||ae==="noembed"||ae==="noframes")&&Mn(/<\/no(script|embed|frames)/i,L.innerHTML)?(Si(L),!0):(_e&&L.nodeType===3&&(re=L.textContent,re=Rr(re,ue," "),re=Rr(re,be," "),re=Rr(re,Ue," "),L.textContent!==re&&(Rl(e.removed,{element:L.cloneNode()}),L.textContent=re)),yi("afterSanitizeElements",L,null),!1)},mb=function(L,re,ae){if(v&&(re==="id"||re==="name")&&(ae in r||ae in Zo))return!1;if(!(he&&!Q[re]&&Mn(Ie,re))){if(!(X&&Mn(R,re))){if(!P[re]||Q[re]){if(!(pb(L)&&(V.tagNameCheck instanceof RegExp&&Mn(V.tagNameCheck,L)||V.tagNameCheck instanceof Function&&V.tagNameCheck(L))&&(V.attributeNameCheck instanceof RegExp&&Mn(V.attributeNameCheck,re)||V.attributeNameCheck instanceof Function&&V.attributeNameCheck(re))||re==="is"&&V.allowCustomizedBuiltInElements&&(V.tagNameCheck instanceof RegExp&&Mn(V.tagNameCheck,ae)||V.tagNameCheck instanceof Function&&V.tagNameCheck(ae))))return!1}else if(!U[re]){if(!Mn(p,Rr(ae,m,""))){if(!((re==="src"||re==="xlink:href"||re==="href")&&L!=="script"&&IW(ae,"data:")===0&&B[L])){if(!(Me&&!Mn(d,Rr(ae,m,"")))){if(ae)return!1}}}}}}return!0},pb=function(L){return L.indexOf("-")>0},wb=function(L){var re,ae,st,Vn;yi("beforeSanitizeAttributes",L,null);var fn=L.attributes;if(fn){var ln={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:P};for(Vn=fn.length;Vn--;){re=fn[Vn];var Ec=re,en=Ec.name,ug=Ec.namespaceURI;if(ae=en==="value"?re.value:xW(re.value),st=kt(en),ln.attrName=st,ln.attrValue=ae,ln.keepAttr=!0,ln.forceKeepAttr=void 0,yi("uponSanitizeAttribute",L,ln),ae=ln.attrValue,!ln.forceKeepAttr&&(lg(en,L),!!ln.keepAttr)){if(!Te&&Mn(/\/>/i,ae)){lg(en,L);continue}_e&&(ae=Rr(ae,ue," "),ae=Rr(ae,be," "),ae=Rr(ae,Ue," "));var Cb=kt(L.nodeName);if(mb(Cb,st,ae)){if(y&&(st==="id"||st==="name")&&(lg(en,L),ae=A+ae),x&&Mo(g)==="object"&&typeof g.getAttributeType=="function"&&!ug)switch(g.getAttributeType(Cb,st)){case"TrustedHTML":{ae=x.createHTML(ae);break}case"TrustedScriptURL":{ae=x.createScriptURL(ae);break}}try{ug?L.setAttributeNS(ug,en,ae):L.setAttribute(en,ae),uR(e.removed)}catch{}}}}yi("afterSanitizeAttributes",L,null)}},jD=function Re(L){var re,ae=fb(L);for(yi("beforeSanitizeShadowDOM",L,null);re=ae.nextNode();)yi("uponSanitizeShadowNode",re,null),!gb(re)&&(re.content instanceof i&&Re(re.content),wb(re));yi("afterSanitizeShadowDOM",L,null)};return e.sanitize=function(Re){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re,ae,st,Vn,fn;if(wt=!Re,wt&&(Re="<!-->"),typeof Re!="string"&&!bl(Re))if(typeof Re.toString=="function"){if(Re=Re.toString(),typeof Re!="string")throw Ig("dirty is not a string, aborting")}else throw Ig("toString is not a function");if(!e.isSupported){if(Mo(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Re=="string")return t.toStaticHTML(Re);if(bl(Re))return t.toStaticHTML(Re.outerHTML)}return Re}if(Ye||qt(L),e.removed=[],typeof Re=="string"&&(H=!1),H){if(Re.nodeName){var ln=kt(Re.nodeName);if(!E[ln]||Z[ln])throw Ig("root node is forbidden and cannot be sanitized in-place")}}else if(Re instanceof s)re=db("<!---->"),ae=re.ownerDocument.importNode(Re,!0),ae.nodeType===1&&ae.nodeName==="BODY"||ae.nodeName==="HTML"?re=ae:re.appendChild(ae);else{if(!ye&&!_e&&!j&&Re.indexOf("<")===-1)return x&&Se?x.createHTML(Re):Re;if(re=db(Re),!re)return ye?null:Se?I:""}re&&Fe&&Si(re.firstChild);for(var Ec=fb(H?Re:re);st=Ec.nextNode();)st.nodeType===3&&st===Vn||gb(st)||(st.content instanceof i&&jD(st.content),wb(st),Vn=st);if(Vn=null,H)return Re;if(ye){if(xe)for(fn=Y.call(re.ownerDocument);re.firstChild;)fn.appendChild(re.firstChild);else fn=re;return(P.shadowroot||P.shadowrootmod)&&(fn=te.call(n,fn,!0)),fn}var en=j?re.outerHTML:re.innerHTML;return j&&E["!doctype"]&&re.ownerDocument&&re.ownerDocument.doctype&&re.ownerDocument.doctype.name&&Mn(zW,re.ownerDocument.doctype.name)&&(en="<!DOCTYPE "+re.ownerDocument.doctype.name+`>
`+en),_e&&(en=Rr(en,ue," "),en=Rr(en,be," "),en=Rr(en,Ue," ")),x&&Se?x.createHTML(en):en},e.setConfig=function(Re){qt(Re),Ye=!0},e.clearConfig=function(){an=null,Ye=!1},e.isValidAttribute=function(Re,L,re){an||qt({});var ae=kt(Re),st=kt(L);return mb(ae,st,re)},e.addHook=function(Re,L){typeof L=="function"&&(ie[Re]=ie[Re]||[],Rl(ie[Re],L))},e.removeHook=function(Re){if(ie[Re])return uR(ie[Re])},e.removeHooks=function(Re){ie[Re]&&(ie[Re]=[])},e.removeAllHooks=function(){ie={}},e}var jW=uP();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var cP;function J(){return cP.apply(null,arguments)}function KW(t){cP=t}function Br(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Ws(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function it(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function AC(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(it(t,e))return!1;return!0}function Yn(t){return t===void 0}function Ji(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function nc(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function hP(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Oo(t,e){for(var n in e)it(e,n)&&(t[n]=e[n]);return it(e,"toString")&&(t.toString=e.toString),it(e,"valueOf")&&(t.valueOf=e.valueOf),t}function wi(t,e,n,r){return NP(t,e,n,r,!0).utc()}function XW(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ze(t){return t._pf==null&&(t._pf=XW()),t._pf}var aw;Array.prototype.some?aw=Array.prototype.some:aw=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function OC(t){if(t._isValid==null){var e=ze(t),n=aw.call(e.parsedDateParts,function(i){return i!=null}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r}return t._isValid}function mf(t){var e=wi(NaN);return t!=null?Oo(ze(e),t):ze(e).userInvalidated=!0,e}var gR=J.momentProperties=[],Lg=!1;function PC(t,e){var n,r,i,o=gR.length;if(Yn(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Yn(e._i)||(t._i=e._i),Yn(e._f)||(t._f=e._f),Yn(e._l)||(t._l=e._l),Yn(e._strict)||(t._strict=e._strict),Yn(e._tzm)||(t._tzm=e._tzm),Yn(e._isUTC)||(t._isUTC=e._isUTC),Yn(e._offset)||(t._offset=e._offset),Yn(e._pf)||(t._pf=ze(e)),Yn(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=gR[n],i=e[r],Yn(i)||(t[r]=i);return t}function rc(t){PC(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Lg===!1&&(Lg=!0,J.updateOffset(this),Lg=!1)}function Ur(t){return t instanceof rc||t!=null&&t._isAMomentObject!=null}function dP(t){J.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Sr(t,e){var n=!0;return Oo(function(){if(J.deprecationHandler!=null&&J.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])it(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}dP(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var mR={};function fP(t,e){J.deprecationHandler!=null&&J.deprecationHandler(t,e),mR[t]||(dP(e),mR[t]=!0)}J.suppressDeprecationWarnings=!1;J.deprecationHandler=null;function Ci(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function qW(t){var e,n;for(n in t)it(t,n)&&(e=t[n],Ci(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function lw(t,e){var n=Oo({},t),r;for(r in e)it(e,r)&&(Ws(t[r])&&Ws(e[r])?(n[r]={},Oo(n[r],t[r]),Oo(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)it(t,r)&&!it(e,r)&&Ws(t[r])&&(n[r]=Oo({},n[r]));return n}function IC(t){t!=null&&this.set(t)}var uw;Object.keys?uw=Object.keys:uw=function(t){var e,n=[];for(e in t)it(t,e)&&n.push(e);return n};var ZW={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function QW(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Ci(r)?r.call(e,n):r}function gi(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var xC=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ic=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,kg={},Ja={};function Ee(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Ja[t]=i),e&&(Ja[e[0]]=function(){return gi(i.apply(this,arguments),e[1],e[2])}),n&&(Ja[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function JW(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function eV(t){var e=t.match(xC),n,r;for(n=0,r=e.length;n<r;n++)Ja[e[n]]?e[n]=Ja[e[n]]:e[n]=JW(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=Ci(e[s])?e[s].call(i,t):e[s];return o}}function jh(t,e){return t.isValid()?(e=gP(e,t.localeData()),kg[e]=kg[e]||eV(e),kg[e](t)):t.localeData().invalidDate()}function gP(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Ic.lastIndex=0;n>=0&&Ic.test(t);)t=t.replace(Ic,r),Ic.lastIndex=0,n-=1;return t}var tV={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function nV(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(xC).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var rV="Invalid date";function iV(){return this._invalidDate}var oV="%d",sV=/\d{1,2}/;function aV(t){return this._ordinal.replace("%d",t)}var lV={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function uV(t,e,n,r){var i=this._relativeTime[n];return Ci(i)?i(t,e,n,r):i.replace(/%d/i,t)}function cV(t,e){var n=this._relativeTime[t>0?"future":"past"];return Ci(n)?n(e):n.replace(/%s/i,e)}var mu={};function En(t,e){var n=t.toLowerCase();mu[n]=mu[n+"s"]=mu[e]=t}function yr(t){return typeof t=="string"?mu[t]||mu[t.toLowerCase()]:void 0}function HC(t){var e={},n,r;for(r in t)it(t,r)&&(n=yr(r),n&&(e[n]=t[r]));return e}var mP={};function Tn(t,e){mP[t]=e}function hV(t){var e=[],n;for(n in t)it(t,n)&&e.push({unit:n,priority:mP[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}function pf(t){return t%4===0&&t%100!==0||t%400===0}function wr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Qe(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=wr(e)),n}function cl(t,e){return function(n){return n!=null?(pP(this,t,n),J.updateOffset(this,e),this):bd(this,t)}}function bd(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function pP(t,e,n){t.isValid()&&!isNaN(n)&&(e==="FullYear"&&pf(t.year())&&t.month()===1&&t.date()===29?(n=Qe(n),t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),bf(n,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function dV(t){return t=yr(t),Ci(this[t])?this[t]():this}function fV(t,e){if(typeof t=="object"){t=HC(t);var n=hV(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=yr(t),Ci(this[t]))return this[t](e);return this}var wP=/\d/,ar=/\d\d/,CP=/\d{3}/,DC=/\d{4}/,wf=/[+-]?\d{6}/,bt=/\d\d?/,vP=/\d\d\d\d?/,SP=/\d\d\d\d\d\d?/,Cf=/\d{1,3}/,NC=/\d{1,4}/,vf=/[+-]?\d{1,6}/,hl=/\d+/,Sf=/[+-]?\d+/,gV=/Z|[+-]\d\d:?\d\d/gi,yf=/Z|[+-]\d\d(?::?\d\d)?/gi,mV=/[+-]?\d+(\.\d{1,3})?/,ic=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Rd;Rd={};function me(t,e,n){Rd[t]=Ci(e)?e:function(r,i){return r&&n?n:e}}function pV(t,e){return it(Rd,t)?Rd[t](e._strict,e._locale):new RegExp(wV(t))}function wV(t){return rr(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function rr(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var cw={};function ht(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Ji(e)&&(r=function(o,s){s[e]=Qe(o)}),i=t.length,n=0;n<i;n++)cw[t[n]]=r}function oc(t,e){ht(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function CV(t,e,n){e!=null&&it(cw,t)&&cw[t](e,n._a,n,t)}var Sn=0,Ui=1,ci=2,Qt=3,kr=4,zi=5,Ds=6,vV=7,SV=8;function yV(t,e){return(t%e+e)%e}var Vt;Array.prototype.indexOf?Vt=Array.prototype.indexOf:Vt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function bf(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=yV(e,12);return t+=(e-n)/12,n===1?pf(t)?29:28:31-n%7%2}Ee("M",["MM",2],"Mo",function(){return this.month()+1});Ee("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ee("MMMM",0,0,function(t){return this.localeData().months(this,t)});En("month","M");Tn("month",8);me("M",bt);me("MM",bt,ar);me("MMM",function(t,e){return e.monthsShortRegex(t)});me("MMMM",function(t,e){return e.monthsRegex(t)});ht(["M","MM"],function(t,e){e[Ui]=Qe(t)-1});ht(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Ui]=i:ze(n).invalidMonth=t});var bV="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),yP="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),bP=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,RV=ic,EV=ic;function TV(t,e){return t?Br(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||bP).test(e)?"format":"standalone"][t.month()]:Br(this._months)?this._months:this._months.standalone}function _V(t,e){return t?Br(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[bP.test(e)?"format":"standalone"][t.month()]:Br(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function MV(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=wi([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=Vt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Vt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Vt.call(this._shortMonthsParse,s),i!==-1?i:(i=Vt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Vt.call(this._longMonthsParse,s),i!==-1?i:(i=Vt.call(this._shortMonthsParse,s),i!==-1?i:null))}function AV(t,e,n){var r,i,o;if(this._monthsParseExact)return MV.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=wi([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function RP(t,e){var n;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Qe(e);else if(e=t.localeData().monthsParse(e),!Ji(e))return t}return n=Math.min(t.date(),bf(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function EP(t){return t!=null?(RP(this,t),J.updateOffset(this,!0),this):bd(this,"Month")}function OV(){return bf(this.year(),this.month())}function PV(t){return this._monthsParseExact?(it(this,"_monthsRegex")||TP.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(it(this,"_monthsShortRegex")||(this._monthsShortRegex=RV),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function IV(t){return this._monthsParseExact?(it(this,"_monthsRegex")||TP.call(this),t?this._monthsStrictRegex:this._monthsRegex):(it(this,"_monthsRegex")||(this._monthsRegex=EV),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function TP(){function t(s,a){return a.length-s.length}var e=[],n=[],r=[],i,o;for(i=0;i<12;i++)o=wi([2e3,i]),e.push(this.monthsShort(o,"")),n.push(this.months(o,"")),r.push(this.months(o,"")),r.push(this.monthsShort(o,""));for(e.sort(t),n.sort(t),r.sort(t),i=0;i<12;i++)e[i]=rr(e[i]),n[i]=rr(n[i]);for(i=0;i<24;i++)r[i]=rr(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Ee("Y",0,0,function(){var t=this.year();return t<=9999?gi(t,4):"+"+t});Ee(0,["YY",2],0,function(){return this.year()%100});Ee(0,["YYYY",4],0,"year");Ee(0,["YYYYY",5],0,"year");Ee(0,["YYYYYY",6,!0],0,"year");En("year","y");Tn("year",1);me("Y",Sf);me("YY",bt,ar);me("YYYY",NC,DC);me("YYYYY",vf,wf);me("YYYYYY",vf,wf);ht(["YYYYY","YYYYYY"],Sn);ht("YYYY",function(t,e){e[Sn]=t.length===2?J.parseTwoDigitYear(t):Qe(t)});ht("YY",function(t,e){e[Sn]=J.parseTwoDigitYear(t)});ht("Y",function(t,e){e[Sn]=parseInt(t,10)});function pu(t){return pf(t)?366:365}J.parseTwoDigitYear=function(t){return Qe(t)+(Qe(t)>68?1900:2e3)};var _P=cl("FullYear",!0);function xV(){return pf(this.year())}function HV(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Du(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Ed(t,e,n){var r=7+e-n,i=(7+Du(t,0,r).getUTCDay()-e)%7;return-i+r-1}function MP(t,e,n,r,i){var o=(7+n-r)%7,s=Ed(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=pu(l)+a):a>pu(t)?(l=t+1,u=a-pu(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Nu(t,e,n){var r=Ed(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Qi(s,e,n)):i>Qi(t.year(),e,n)?(o=i-Qi(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Qi(t,e,n){var r=Ed(t,e,n),i=Ed(t+1,e,n);return(pu(t)-r+i)/7}Ee("w",["ww",2],"wo","week");Ee("W",["WW",2],"Wo","isoWeek");En("week","w");En("isoWeek","W");Tn("week",5);Tn("isoWeek",5);me("w",bt);me("ww",bt,ar);me("W",bt);me("WW",bt,ar);oc(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Qe(t)});function DV(t){return Nu(t,this._week.dow,this._week.doy).week}var NV={dow:0,doy:6};function LV(){return this._week.dow}function kV(){return this._week.doy}function $V(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function FV(t){var e=Nu(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ee("d",0,"do","day");Ee("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ee("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ee("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ee("e",0,0,"weekday");Ee("E",0,0,"isoWeekday");En("day","d");En("weekday","e");En("isoWeekday","E");Tn("day",11);Tn("weekday",11);Tn("isoWeekday",11);me("d",bt);me("e",bt);me("E",bt);me("dd",function(t,e){return e.weekdaysMinRegex(t)});me("ddd",function(t,e){return e.weekdaysShortRegex(t)});me("dddd",function(t,e){return e.weekdaysRegex(t)});oc(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:ze(n).invalidWeekday=t});oc(["d","e","E"],function(t,e,n,r){e[r]=Qe(t)});function WV(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function VV(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function LC(t,e){return t.slice(e,7).concat(t.slice(0,e))}var BV="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),AP="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),UV="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),zV=ic,GV=ic,YV=ic;function jV(t,e){var n=Br(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?LC(n,this._week.dow):t?n[t.day()]:n}function KV(t){return t===!0?LC(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function XV(t){return t===!0?LC(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function qV(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=wi([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=Vt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Vt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Vt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Vt.call(this._weekdaysParse,s),i!==-1||(i=Vt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Vt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Vt.call(this._shortWeekdaysParse,s),i!==-1||(i=Vt.call(this._weekdaysParse,s),i!==-1)?i:(i=Vt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Vt.call(this._minWeekdaysParse,s),i!==-1||(i=Vt.call(this._weekdaysParse,s),i!==-1)?i:(i=Vt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function ZV(t,e,n){var r,i,o;if(this._weekdaysParseExact)return qV.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=wi([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function QV(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=WV(t,this.localeData()),this.add(t-e,"d")):e}function JV(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function eB(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=VV(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function tB(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||kC.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(it(this,"_weekdaysRegex")||(this._weekdaysRegex=zV),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function nB(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||kC.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(it(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=GV),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function rB(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||kC.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(it(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=YV),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function kC(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=wi([2e3,1]).day(o),a=rr(this.weekdaysMin(s,"")),l=rr(this.weekdaysShort(s,"")),u=rr(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function $C(){return this.hours()%12||12}function iB(){return this.hours()||24}Ee("H",["HH",2],0,"hour");Ee("h",["hh",2],0,$C);Ee("k",["kk",2],0,iB);Ee("hmm",0,0,function(){return""+$C.apply(this)+gi(this.minutes(),2)});Ee("hmmss",0,0,function(){return""+$C.apply(this)+gi(this.minutes(),2)+gi(this.seconds(),2)});Ee("Hmm",0,0,function(){return""+this.hours()+gi(this.minutes(),2)});Ee("Hmmss",0,0,function(){return""+this.hours()+gi(this.minutes(),2)+gi(this.seconds(),2)});function OP(t,e){Ee(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}OP("a",!0);OP("A",!1);En("hour","h");Tn("hour",13);function PP(t,e){return e._meridiemParse}me("a",PP);me("A",PP);me("H",bt);me("h",bt);me("k",bt);me("HH",bt,ar);me("hh",bt,ar);me("kk",bt,ar);me("hmm",vP);me("hmmss",SP);me("Hmm",vP);me("Hmmss",SP);ht(["H","HH"],Qt);ht(["k","kk"],function(t,e,n){var r=Qe(t);e[Qt]=r===24?0:r});ht(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});ht(["h","hh"],function(t,e,n){e[Qt]=Qe(t),ze(n).bigHour=!0});ht("hmm",function(t,e,n){var r=t.length-2;e[Qt]=Qe(t.substr(0,r)),e[kr]=Qe(t.substr(r)),ze(n).bigHour=!0});ht("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Qt]=Qe(t.substr(0,r)),e[kr]=Qe(t.substr(r,2)),e[zi]=Qe(t.substr(i)),ze(n).bigHour=!0});ht("Hmm",function(t,e,n){var r=t.length-2;e[Qt]=Qe(t.substr(0,r)),e[kr]=Qe(t.substr(r))});ht("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Qt]=Qe(t.substr(0,r)),e[kr]=Qe(t.substr(r,2)),e[zi]=Qe(t.substr(i))});function oB(t){return(t+"").toLowerCase().charAt(0)==="p"}var sB=/[ap]\.?m?\.?/i,aB=cl("Hours",!0);function lB(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var IP={calendar:ZW,longDateFormat:tV,invalidDate:rV,ordinal:oV,dayOfMonthOrdinalParse:sV,relativeTime:lV,months:bV,monthsShort:yP,week:NV,weekdays:BV,weekdaysMin:UV,weekdaysShort:AP,meridiemParse:sB},_t={},El={},Lu;function uB(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function pR(t){return t&&t.toLowerCase().replace("_","-")}function cB(t){for(var e=0,n,r,i,o;e<t.length;){for(o=pR(t[e]).split("-"),n=o.length,r=pR(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Rf(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&uB(o,r)>=n-1)break;n--}e++}return Lu}function hB(t){return t.match("^[^/\\\\]*$")!=null}function Rf(t){var e=null,n;if(_t[t]===void 0&&typeof pd<"u"&&pd&&pd.exports&&hB(t))try{e=Lu._abbr,n=require,n("./locale/"+t),Do(e)}catch{_t[t]=null}return _t[t]}function Do(t,e){var n;return t&&(Yn(e)?n=io(t):n=FC(t,e),n?Lu=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Lu._abbr}function FC(t,e){if(e!==null){var n,r=IP;if(e.abbr=t,_t[t]!=null)fP("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=_t[t]._config;else if(e.parentLocale!=null)if(_t[e.parentLocale]!=null)r=_t[e.parentLocale]._config;else if(n=Rf(e.parentLocale),n!=null)r=n._config;else return El[e.parentLocale]||(El[e.parentLocale]=[]),El[e.parentLocale].push({name:t,config:e}),null;return _t[t]=new IC(lw(r,e)),El[t]&&El[t].forEach(function(i){FC(i.name,i.config)}),Do(t),_t[t]}else return delete _t[t],null}function dB(t,e){if(e!=null){var n,r,i=IP;_t[t]!=null&&_t[t].parentLocale!=null?_t[t].set(lw(_t[t]._config,e)):(r=Rf(t),r!=null&&(i=r._config),e=lw(i,e),r==null&&(e.abbr=t),n=new IC(e),n.parentLocale=_t[t],_t[t]=n),Do(t)}else _t[t]!=null&&(_t[t].parentLocale!=null?(_t[t]=_t[t].parentLocale,t===Do()&&Do(t)):_t[t]!=null&&delete _t[t]);return _t[t]}function io(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Lu;if(!Br(t)){if(e=Rf(t),e)return e;t=[t]}return cB(t)}function fB(){return uw(_t)}function WC(t){var e,n=t._a;return n&&ze(t).overflow===-2&&(e=n[Ui]<0||n[Ui]>11?Ui:n[ci]<1||n[ci]>bf(n[Sn],n[Ui])?ci:n[Qt]<0||n[Qt]>24||n[Qt]===24&&(n[kr]!==0||n[zi]!==0||n[Ds]!==0)?Qt:n[kr]<0||n[kr]>59?kr:n[zi]<0||n[zi]>59?zi:n[Ds]<0||n[Ds]>999?Ds:-1,ze(t)._overflowDayOfYear&&(e<Sn||e>ci)&&(e=ci),ze(t)._overflowWeeks&&e===-1&&(e=vV),ze(t)._overflowWeekday&&e===-1&&(e=SV),ze(t).overflow=e),t}var gB=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mB=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,pB=/Z|[+-]\d\d(?::?\d\d)?/,xc=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],$g=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],wB=/^\/?Date\((-?\d+)/i,CB=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,vB={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function xP(t){var e,n,r=t._i,i=gB.exec(r)||mB.exec(r),o,s,a,l,u=xc.length,c=$g.length;if(i){for(ze(t).iso=!0,e=0,n=u;e<n;e++)if(xc[e][1].exec(i[1])){s=xc[e][0],o=xc[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if($g[e][1].exec(i[3])){a=(i[2]||" ")+$g[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(pB.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),BC(t)}else t._isValid=!1}function SB(t,e,n,r,i,o){var s=[yB(t),yP.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function yB(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function bB(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function RB(t,e,n){if(t){var r=AP.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return ze(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function EB(t,e,n){if(t)return vB[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function HP(t){var e=CB.exec(bB(t._i)),n;if(e){if(n=SB(e[4],e[3],e[2],e[5],e[6],e[7]),!RB(e[1],n,t))return;t._a=n,t._tzm=EB(e[8],e[9],e[10]),t._d=Du.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),ze(t).rfc2822=!0}else t._isValid=!1}function TB(t){var e=wB.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(xP(t),t._isValid===!1)delete t._isValid;else return;if(HP(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:J.createFromInputFallback(t)}J.createFromInputFallback=Sr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Ua(t,e,n){return t??e??n}function _B(t){var e=new Date(J.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function VC(t){var e,n,r=[],i,o,s;if(!t._d){for(i=_B(t),t._w&&t._a[ci]==null&&t._a[Ui]==null&&MB(t),t._dayOfYear!=null&&(s=Ua(t._a[Sn],i[Sn]),(t._dayOfYear>pu(s)||t._dayOfYear===0)&&(ze(t)._overflowDayOfYear=!0),n=Du(s,0,t._dayOfYear),t._a[Ui]=n.getUTCMonth(),t._a[ci]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Qt]===24&&t._a[kr]===0&&t._a[zi]===0&&t._a[Ds]===0&&(t._nextDay=!0,t._a[Qt]=0),t._d=(t._useUTC?Du:HV).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Qt]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(ze(t).weekdayMismatch=!0)}}function MB(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=Ua(e.GG,t._a[Sn],Nu(yt(),1,4).year),r=Ua(e.W,1),i=Ua(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Nu(yt(),o,s),n=Ua(e.gg,t._a[Sn],u.year),r=Ua(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>Qi(n,o,s)?ze(t)._overflowWeeks=!0:l!=null?ze(t)._overflowWeekday=!0:(a=MP(n,r,i,o,s),t._a[Sn]=a.year,t._dayOfYear=a.dayOfYear)}J.ISO_8601=function(){};J.RFC_2822=function(){};function BC(t){if(t._f===J.ISO_8601){xP(t);return}if(t._f===J.RFC_2822){HP(t);return}t._a=[],ze(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=gP(t._f,t._locale).match(xC)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(pV(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&ze(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Ja[o]?(r?ze(t).empty=!1:ze(t).unusedTokens.push(o),CV(o,r,t)):t._strict&&!r&&ze(t).unusedTokens.push(o);ze(t).charsLeftOver=a-l,e.length>0&&ze(t).unusedInput.push(e),t._a[Qt]<=12&&ze(t).bigHour===!0&&t._a[Qt]>0&&(ze(t).bigHour=void 0),ze(t).parsedDateParts=t._a.slice(0),ze(t).meridiem=t._meridiem,t._a[Qt]=AB(t._locale,t._a[Qt],t._meridiem),u=ze(t).era,u!==null&&(t._a[Sn]=t._locale.erasConvertYear(u,t._a[Sn])),VC(t),WC(t)}function AB(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function OB(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){ze(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=PC({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],BC(e),OC(e)&&(s=!0),o+=ze(e).charsLeftOver,o+=ze(e).unusedTokens.length*10,ze(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Oo(t,n||e)}function PB(t){if(!t._d){var e=HC(t._i),n=e.day===void 0?e.date:e.day;t._a=hP([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),VC(t)}}function IB(t){var e=new rc(WC(DP(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function DP(t){var e=t._i,n=t._f;return t._locale=t._locale||io(t._l),e===null||n===void 0&&e===""?mf({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Ur(e)?new rc(WC(e)):(nc(e)?t._d=e:Br(n)?OB(t):n?BC(t):xB(t),OC(t)||(t._d=null),t))}function xB(t){var e=t._i;Yn(e)?t._d=new Date(J.now()):nc(e)?t._d=new Date(e.valueOf()):typeof e=="string"?TB(t):Br(e)?(t._a=hP(e.slice(0),function(n){return parseInt(n,10)}),VC(t)):Ws(e)?PB(t):Ji(e)?t._d=new Date(e):J.createFromInputFallback(t)}function NP(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(Ws(t)&&AC(t)||Br(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,IB(o)}function yt(t,e,n,r){return NP(t,e,n,r,!1)}var HB=Sr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=yt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:mf()}),DB=Sr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=yt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:mf()});function LP(t,e){var n,r;if(e.length===1&&Br(e[0])&&(e=e[0]),!e.length)return yt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function NB(){var t=[].slice.call(arguments,0);return LP("isBefore",t)}function LB(){var t=[].slice.call(arguments,0);return LP("isAfter",t)}var kB=function(){return Date.now?Date.now():+new Date},Tl=["year","quarter","month","week","day","hour","minute","second","millisecond"];function $B(t){var e,n=!1,r,i=Tl.length;for(e in t)if(it(t,e)&&!(Vt.call(Tl,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Tl[r]]){if(n)return!1;parseFloat(t[Tl[r]])!==Qe(t[Tl[r]])&&(n=!0)}return!0}function FB(){return this._isValid}function WB(){return Gr(NaN)}function Ef(t){var e=HC(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=$B(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=io(),this._bubble()}function Kh(t){return t instanceof Ef}function hw(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function VB(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)(n&&t[s]!==e[s]||!n&&Qe(t[s])!==Qe(e[s]))&&o++;return o+i}function kP(t,e){Ee(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+gi(~~(n/60),2)+e+gi(~~n%60,2)})}kP("Z",":");kP("ZZ","");me("Z",yf);me("ZZ",yf);ht(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=UC(yf,t)});var BB=/([\+\-]|\d\d)/gi;function UC(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(BB)||["-",0,0],o=+(i[1]*60)+Qe(i[2]),o===0?0:i[0]==="+"?o:-o)}function zC(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(Ur(t)||nc(t)?t.valueOf():yt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),J.updateOffset(n,!1),n):yt(t).local()}function dw(t){return-Math.round(t._d.getTimezoneOffset())}J.updateOffset=function(){};function UB(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=UC(yf,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=dw(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?WP(this,Gr(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,J.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:dw(this)}function zB(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function GB(t){return this.utcOffset(0,t)}function YB(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(dw(this),"m")),this}function jB(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=UC(gV,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function KB(t){return this.isValid()?(t=t?yt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function XB(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function qB(){if(!Yn(this._isDSTShifted))return this._isDSTShifted;var t={},e;return PC(t,this),t=DP(t),t._a?(e=t._isUTC?wi(t._a):yt(t._a),this._isDSTShifted=this.isValid()&&VB(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function ZB(){return this.isValid()?!this._isUTC:!1}function QB(){return this.isValid()?this._isUTC:!1}function $P(){return this.isValid()?this._isUTC&&this._offset===0:!1}var JB=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,eU=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Gr(t,e){var n=t,r=null,i,o,s;return Kh(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Ji(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=JB.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Qe(r[ci])*i,h:Qe(r[Qt])*i,m:Qe(r[kr])*i,s:Qe(r[zi])*i,ms:Qe(hw(r[Ds]*1e3))*i}):(r=eU.exec(t))?(i=r[1]==="-"?-1:1,n={y:es(r[2],i),M:es(r[3],i),w:es(r[4],i),d:es(r[5],i),h:es(r[6],i),m:es(r[7],i),s:es(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=tU(yt(n.from),yt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Ef(n),Kh(t)&&it(t,"_locale")&&(o._locale=t._locale),Kh(t)&&it(t,"_isValid")&&(o._isValid=t._isValid),o}Gr.fn=Ef.prototype;Gr.invalid=WB;function es(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function wR(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function tU(t,e){var n;return t.isValid()&&e.isValid()?(e=zC(e,t),t.isBefore(e)?n=wR(t,e):(n=wR(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function FP(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(fP(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=Gr(n,r),WP(this,i,t),this}}function WP(t,e,n,r){var i=e._milliseconds,o=hw(e._days),s=hw(e._months);t.isValid()&&(r=r??!0,s&&RP(t,bd(t,"Month")+s*n),o&&pP(t,"Date",bd(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&J.updateOffset(t,o||s))}var nU=FP(1,"add"),rU=FP(-1,"subtract");function VP(t){return typeof t=="string"||t instanceof String}function iU(t){return Ur(t)||nc(t)||VP(t)||Ji(t)||sU(t)||oU(t)||t===null||t===void 0}function oU(t){var e=Ws(t)&&!AC(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||it(t,o);return e&&n}function sU(t){var e=Br(t),n=!1;return e&&(n=t.filter(function(r){return!Ji(r)&&VP(t)}).length===0),e&&n}function aU(t){var e=Ws(t)&&!AC(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||it(t,o);return e&&n}function lU(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function uU(t,e){arguments.length===1&&(arguments[0]?iU(arguments[0])?(t=arguments[0],e=void 0):aU(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||yt(),r=zC(n,this).startOf("day"),i=J.calendarFormat(this,r)||"sameElse",o=e&&(Ci(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,yt(n)))}function cU(){return new rc(this)}function hU(t,e){var n=Ur(t)?t:yt(t);return this.isValid()&&n.isValid()?(e=yr(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function dU(t,e){var n=Ur(t)?t:yt(t);return this.isValid()&&n.isValid()?(e=yr(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function fU(t,e,n,r){var i=Ur(t)?t:yt(t),o=Ur(e)?e:yt(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function gU(t,e){var n=Ur(t)?t:yt(t),r;return this.isValid()&&n.isValid()?(e=yr(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function mU(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function pU(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function wU(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=zC(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=yr(e),e){case"year":o=Xh(this,r)/12;break;case"month":o=Xh(this,r);break;case"quarter":o=Xh(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:wr(o)}function Xh(t,e){if(t.date()<e.date())return-Xh(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}J.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";J.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function CU(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function vU(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?jh(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ci(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",jh(n,"Z")):jh(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function SU(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function yU(t){t||(t=this.isUtc()?J.defaultFormatUtc:J.defaultFormat);var e=jh(this,t);return this.localeData().postformat(e)}function bU(t,e){return this.isValid()&&(Ur(t)&&t.isValid()||yt(t).isValid())?Gr({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function RU(t){return this.from(yt(),t)}function EU(t,e){return this.isValid()&&(Ur(t)&&t.isValid()||yt(t).isValid())?Gr({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function TU(t){return this.to(yt(),t)}function BP(t){var e;return t===void 0?this._locale._abbr:(e=io(t),e!=null&&(this._locale=e),this)}var UP=Sr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function zP(){return this._locale}var Td=1e3,el=60*Td,_d=60*el,GP=(365*400+97)*24*_d;function tl(t,e){return(t%e+e)%e}function YP(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-GP:new Date(t,e,n).valueOf()}function jP(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-GP:Date.UTC(t,e,n)}function _U(t){var e,n;if(t=yr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?jP:YP,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=tl(e+(this._isUTC?0:this.utcOffset()*el),_d);break;case"minute":e=this._d.valueOf(),e-=tl(e,el);break;case"second":e=this._d.valueOf(),e-=tl(e,Td);break}return this._d.setTime(e),J.updateOffset(this,!0),this}function MU(t){var e,n;if(t=yr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?jP:YP,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=_d-tl(e+(this._isUTC?0:this.utcOffset()*el),_d)-1;break;case"minute":e=this._d.valueOf(),e+=el-tl(e,el)-1;break;case"second":e=this._d.valueOf(),e+=Td-tl(e,Td)-1;break}return this._d.setTime(e),J.updateOffset(this,!0),this}function AU(){return this._d.valueOf()-(this._offset||0)*6e4}function OU(){return Math.floor(this.valueOf()/1e3)}function PU(){return new Date(this.valueOf())}function IU(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function xU(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function HU(){return this.isValid()?this.toISOString():null}function DU(){return OC(this)}function NU(){return Oo({},ze(this))}function LU(){return ze(this).overflow}function kU(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ee("N",0,0,"eraAbbr");Ee("NN",0,0,"eraAbbr");Ee("NNN",0,0,"eraAbbr");Ee("NNNN",0,0,"eraName");Ee("NNNNN",0,0,"eraNarrow");Ee("y",["y",1],"yo","eraYear");Ee("y",["yy",2],0,"eraYear");Ee("y",["yyy",3],0,"eraYear");Ee("y",["yyyy",4],0,"eraYear");me("N",GC);me("NN",GC);me("NNN",GC);me("NNNN",KU);me("NNNNN",XU);ht(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?ze(n).era=i:ze(n).invalidEra=t});me("y",hl);me("yy",hl);me("yyy",hl);me("yyyy",hl);me("yo",qU);ht(["y","yy","yyy","yyyy"],Sn);ht(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Sn]=n._locale.eraYearOrdinalParse(t,i):e[Sn]=parseInt(t,10)});function $U(t,e){var n,r,i,o=this._eras||io("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=J(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=J(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function FU(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function WU(t,e){var n=t.since<=t.until?1:-1;return e===void 0?J(t.since).year():J(t.since).year()+(e-t.offset)*n}function VU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function BU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function UU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function zU(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-J(i[t].since).year())*n+i[t].offset;return this.year()}function GU(t){return it(this,"_erasNameRegex")||YC.call(this),t?this._erasNameRegex:this._erasRegex}function YU(t){return it(this,"_erasAbbrRegex")||YC.call(this),t?this._erasAbbrRegex:this._erasRegex}function jU(t){return it(this,"_erasNarrowRegex")||YC.call(this),t?this._erasNarrowRegex:this._erasRegex}function GC(t,e){return e.erasAbbrRegex(t)}function KU(t,e){return e.erasNameRegex(t)}function XU(t,e){return e.erasNarrowRegex(t)}function qU(t,e){return e._eraYearOrdinalRegex||hl}function YC(){var t=[],e=[],n=[],r=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)e.push(rr(s[i].name)),t.push(rr(s[i].abbr)),n.push(rr(s[i].narrow)),r.push(rr(s[i].name)),r.push(rr(s[i].abbr)),r.push(rr(s[i].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ee(0,["gg",2],0,function(){return this.weekYear()%100});Ee(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Tf(t,e){Ee(0,[t,t.length],0,e)}Tf("gggg","weekYear");Tf("ggggg","weekYear");Tf("GGGG","isoWeekYear");Tf("GGGGG","isoWeekYear");En("weekYear","gg");En("isoWeekYear","GG");Tn("weekYear",1);Tn("isoWeekYear",1);me("G",Sf);me("g",Sf);me("GG",bt,ar);me("gg",bt,ar);me("GGGG",NC,DC);me("gggg",NC,DC);me("GGGGG",vf,wf);me("ggggg",vf,wf);oc(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Qe(t)});oc(["gg","GG"],function(t,e,n,r){e[r]=J.parseTwoDigitYear(t)});function ZU(t){return KP.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function QU(t){return KP.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function JU(){return Qi(this.year(),1,4)}function e2(){return Qi(this.isoWeekYear(),1,4)}function t2(){var t=this.localeData()._week;return Qi(this.year(),t.dow,t.doy)}function n2(){var t=this.localeData()._week;return Qi(this.weekYear(),t.dow,t.doy)}function KP(t,e,n,r,i){var o;return t==null?Nu(this,r,i).year:(o=Qi(t,r,i),e>o&&(e=o),r2.call(this,t,e,n,r,i))}function r2(t,e,n,r,i){var o=MP(t,e,n,r,i),s=Du(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Ee("Q",0,"Qo","quarter");En("quarter","Q");Tn("quarter",7);me("Q",wP);ht("Q",function(t,e){e[Ui]=(Qe(t)-1)*3});function i2(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ee("D",["DD",2],"Do","date");En("date","D");Tn("date",9);me("D",bt);me("DD",bt,ar);me("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});ht(["D","DD"],ci);ht("Do",function(t,e){e[ci]=Qe(t.match(bt)[0])});var XP=cl("Date",!0);Ee("DDD",["DDDD",3],"DDDo","dayOfYear");En("dayOfYear","DDD");Tn("dayOfYear",4);me("DDD",Cf);me("DDDD",CP);ht(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Qe(t)});function o2(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ee("m",["mm",2],0,"minute");En("minute","m");Tn("minute",14);me("m",bt);me("mm",bt,ar);ht(["m","mm"],kr);var s2=cl("Minutes",!1);Ee("s",["ss",2],0,"second");En("second","s");Tn("second",15);me("s",bt);me("ss",bt,ar);ht(["s","ss"],zi);var a2=cl("Seconds",!1);Ee("S",0,0,function(){return~~(this.millisecond()/100)});Ee(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ee(0,["SSS",3],0,"millisecond");Ee(0,["SSSS",4],0,function(){return this.millisecond()*10});Ee(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ee(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ee(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ee(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ee(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});En("millisecond","ms");Tn("millisecond",16);me("S",Cf,wP);me("SS",Cf,ar);me("SSS",Cf,CP);var Po,qP;for(Po="SSSS";Po.length<=9;Po+="S")me(Po,hl);function l2(t,e){e[Ds]=Qe(("0."+t)*1e3)}for(Po="S";Po.length<=9;Po+="S")ht(Po,l2);qP=cl("Milliseconds",!1);Ee("z",0,0,"zoneAbbr");Ee("zz",0,0,"zoneName");function u2(){return this._isUTC?"UTC":""}function c2(){return this._isUTC?"Coordinated Universal Time":""}var ne=rc.prototype;ne.add=nU;ne.calendar=uU;ne.clone=cU;ne.diff=wU;ne.endOf=MU;ne.format=yU;ne.from=bU;ne.fromNow=RU;ne.to=EU;ne.toNow=TU;ne.get=dV;ne.invalidAt=LU;ne.isAfter=hU;ne.isBefore=dU;ne.isBetween=fU;ne.isSame=gU;ne.isSameOrAfter=mU;ne.isSameOrBefore=pU;ne.isValid=DU;ne.lang=UP;ne.locale=BP;ne.localeData=zP;ne.max=DB;ne.min=HB;ne.parsingFlags=NU;ne.set=fV;ne.startOf=_U;ne.subtract=rU;ne.toArray=IU;ne.toObject=xU;ne.toDate=PU;ne.toISOString=vU;ne.inspect=SU;typeof Symbol<"u"&&Symbol.for!=null&&(ne[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ne.toJSON=HU;ne.toString=CU;ne.unix=OU;ne.valueOf=AU;ne.creationData=kU;ne.eraName=VU;ne.eraNarrow=BU;ne.eraAbbr=UU;ne.eraYear=zU;ne.year=_P;ne.isLeapYear=xV;ne.weekYear=ZU;ne.isoWeekYear=QU;ne.quarter=ne.quarters=i2;ne.month=EP;ne.daysInMonth=OV;ne.week=ne.weeks=$V;ne.isoWeek=ne.isoWeeks=FV;ne.weeksInYear=t2;ne.weeksInWeekYear=n2;ne.isoWeeksInYear=JU;ne.isoWeeksInISOWeekYear=e2;ne.date=XP;ne.day=ne.days=QV;ne.weekday=JV;ne.isoWeekday=eB;ne.dayOfYear=o2;ne.hour=ne.hours=aB;ne.minute=ne.minutes=s2;ne.second=ne.seconds=a2;ne.millisecond=ne.milliseconds=qP;ne.utcOffset=UB;ne.utc=GB;ne.local=YB;ne.parseZone=jB;ne.hasAlignedHourOffset=KB;ne.isDST=XB;ne.isLocal=ZB;ne.isUtcOffset=QB;ne.isUtc=$P;ne.isUTC=$P;ne.zoneAbbr=u2;ne.zoneName=c2;ne.dates=Sr("dates accessor is deprecated. Use date instead.",XP);ne.months=Sr("months accessor is deprecated. Use month instead",EP);ne.years=Sr("years accessor is deprecated. Use year instead",_P);ne.zone=Sr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",zB);ne.isDSTShifted=Sr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",qB);function h2(t){return yt(t*1e3)}function d2(){return yt.apply(null,arguments).parseZone()}function ZP(t){return t}var ot=IC.prototype;ot.calendar=QW;ot.longDateFormat=nV;ot.invalidDate=iV;ot.ordinal=aV;ot.preparse=ZP;ot.postformat=ZP;ot.relativeTime=uV;ot.pastFuture=cV;ot.set=qW;ot.eras=$U;ot.erasParse=FU;ot.erasConvertYear=WU;ot.erasAbbrRegex=YU;ot.erasNameRegex=GU;ot.erasNarrowRegex=jU;ot.months=TV;ot.monthsShort=_V;ot.monthsParse=AV;ot.monthsRegex=IV;ot.monthsShortRegex=PV;ot.week=DV;ot.firstDayOfYear=kV;ot.firstDayOfWeek=LV;ot.weekdays=jV;ot.weekdaysMin=XV;ot.weekdaysShort=KV;ot.weekdaysParse=ZV;ot.weekdaysRegex=tB;ot.weekdaysShortRegex=nB;ot.weekdaysMinRegex=rB;ot.isPM=oB;ot.meridiem=lB;function Md(t,e,n,r){var i=io(),o=wi().set(r,e);return i[n](o,t)}function QP(t,e,n){if(Ji(t)&&(e=t,t=void 0),t=t||"",e!=null)return Md(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Md(t,r,n,"month");return i}function jC(t,e,n,r){typeof t=="boolean"?(Ji(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Ji(e)&&(n=e,e=void 0),e=e||"");var i=io(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Md(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Md(e,(s+o)%7,r,"day");return a}function f2(t,e){return QP(t,e,"months")}function g2(t,e){return QP(t,e,"monthsShort")}function m2(t,e,n){return jC(t,e,n,"weekdays")}function p2(t,e,n){return jC(t,e,n,"weekdaysShort")}function w2(t,e,n){return jC(t,e,n,"weekdaysMin")}Do("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Qe(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});J.lang=Sr("moment.lang is deprecated. Use moment.locale instead.",Do);J.langData=Sr("moment.langData is deprecated. Use moment.localeData instead.",io);var bi=Math.abs;function C2(){var t=this._data;return this._milliseconds=bi(this._milliseconds),this._days=bi(this._days),this._months=bi(this._months),t.milliseconds=bi(t.milliseconds),t.seconds=bi(t.seconds),t.minutes=bi(t.minutes),t.hours=bi(t.hours),t.months=bi(t.months),t.years=bi(t.years),this}function JP(t,e,n,r){var i=Gr(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function v2(t,e){return JP(this,t,e,1)}function S2(t,e){return JP(this,t,e,-1)}function CR(t){return t<0?Math.floor(t):Math.ceil(t)}function y2(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=CR(fw(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=wr(t/1e3),r.seconds=i%60,o=wr(i/60),r.minutes=o%60,s=wr(o/60),r.hours=s%24,e+=wr(s/24),l=wr(eI(e)),n+=l,e-=CR(fw(l)),a=wr(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function eI(t){return t*4800/146097}function fw(t){return t*146097/4800}function b2(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=yr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+eI(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(fw(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function R2(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Qe(this._months/12)*31536e6:NaN}function oo(t){return function(){return this.as(t)}}var E2=oo("ms"),T2=oo("s"),_2=oo("m"),M2=oo("h"),A2=oo("d"),O2=oo("w"),P2=oo("M"),I2=oo("Q"),x2=oo("y");function H2(){return Gr(this)}function D2(t){return t=yr(t),this.isValid()?this[t+"s"]():NaN}function Zs(t){return function(){return this.isValid()?this._data[t]:NaN}}var N2=Zs("milliseconds"),L2=Zs("seconds"),k2=Zs("minutes"),$2=Zs("hours"),F2=Zs("days"),W2=Zs("months"),V2=Zs("years");function B2(){return wr(this.days()/7)}var Fi=Math.round,Ka={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function U2(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function z2(t,e,n,r){var i=Gr(t).abs(),o=Fi(i.as("s")),s=Fi(i.as("m")),a=Fi(i.as("h")),l=Fi(i.as("d")),u=Fi(i.as("M")),c=Fi(i.as("w")),h=Fi(i.as("y")),f=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(f=f||c<=1&&["w"]||c<n.w&&["ww",c]),f=f||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],f[2]=e,f[3]=+t>0,f[4]=r,U2.apply(null,f)}function G2(t){return t===void 0?Fi:typeof t=="function"?(Fi=t,!0):!1}function Y2(t,e){return Ka[t]===void 0?!1:e===void 0?Ka[t]:(Ka[t]=e,t==="s"&&(Ka.ss=e-1),!0)}function j2(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Ka,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Ka,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=z2(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Fg=Math.abs;function sa(t){return(t>0)-(t<0)||+t}function _f(){if(!this.isValid())return this.localeData().invalidDate();var t=Fg(this._milliseconds)/1e3,e=Fg(this._days),n=Fg(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=wr(t/60),i=wr(r/60),t%=60,r%=60,o=wr(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=sa(this._months)!==sa(a)?"-":"",c=sa(this._days)!==sa(a)?"-":"",h=sa(this._milliseconds)!==sa(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var tt=Ef.prototype;tt.isValid=FB;tt.abs=C2;tt.add=v2;tt.subtract=S2;tt.as=b2;tt.asMilliseconds=E2;tt.asSeconds=T2;tt.asMinutes=_2;tt.asHours=M2;tt.asDays=A2;tt.asWeeks=O2;tt.asMonths=P2;tt.asQuarters=I2;tt.asYears=x2;tt.valueOf=R2;tt._bubble=y2;tt.clone=H2;tt.get=D2;tt.milliseconds=N2;tt.seconds=L2;tt.minutes=k2;tt.hours=$2;tt.days=F2;tt.weeks=B2;tt.months=W2;tt.years=V2;tt.humanize=j2;tt.toISOString=_f;tt.toString=_f;tt.toJSON=_f;tt.locale=BP;tt.localeData=zP;tt.toIsoString=Sr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",_f);tt.lang=UP;Ee("X",0,0,"unix");Ee("x",0,0,"valueOf");me("x",Sf);me("X",mV);ht("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});ht("x",function(t,e,n){n._d=new Date(Qe(t))});//! moment.js
J.version="2.29.4";KW(yt);J.fn=ne;J.min=NB;J.max=LB;J.now=kB;J.utc=wi;J.unix=h2;J.months=f2;J.isDate=nc;J.locale=Do;J.invalid=mf;J.duration=Gr;J.isMoment=Ur;J.weekdays=m2;J.parseZone=d2;J.localeData=io;J.isDuration=Kh;J.monthsShort=g2;J.weekdaysMin=w2;J.defineLocale=FC;J.updateLocale=dB;J.locales=fB;J.weekdaysShort=p2;J.normalizeUnits=yr;J.relativeTimeRounding=G2;J.relativeTimeThreshold=Y2;J.calendarFormat=lU;J.prototype=ne;J.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const K2=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));function tI(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function gw(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function wu(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Ft(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function or(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ve(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function T(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function nI(t){return Ft(t,(e,n)=>e+n,0)}function X2(t){return Ft(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function q2(t){return Ft(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function Z2(t){return t.length?nI(t)/t.length:0}function rI(t){return Ft(t,(e,n)=>e.concat(Array.isArray(n)?rI(n):n),[])}function KC(t){const e=[];return T(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function mw(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return T(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function Q2(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return T(i,s=>{o=o.filter(a=>s.includes(a))}),o}function J2(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return T(i,s=>{T(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function pw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const ez=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:Z2,arrayEach:T,arrayFilter:or,arrayFlatten:rI,arrayMap:Ve,arrayMax:X2,arrayMin:q2,arrayReduce:Ft,arraySum:nI,arrayUnique:KC,extendArray:gw,getDifferenceOfArrays:mw,getIntersectionOfArrays:Q2,getUnionOfArrays:J2,pivot:wu,stringToArray:pw,to2dArray:tI},Symbol.toStringTag,{value:"Module"}));function ct(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Ft(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Nt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function le(t){return typeof t<"u"}function mt(t){return typeof t>"u"}function Xt(t){return t===null||t===""||mt(t)}function iI(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const lu="length",Cu=t=>parseInt(t,16),vR=t=>parseInt(t,10),Ad=(t,e,n)=>t.substr(e,n),vu=t=>t.codePointAt(0)-65,ww=t=>`${t}`.replace(/\-/g,""),tz=t=>Cu(Ad(ww(t),Cu("12"),vu("F")))/(Cu(Ad(ww(t),vu("B"),~~![][lu]))||9),nz=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let SR=!1;const yR={invalid:()=>ct`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ct`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ct`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},bR={invalid:()=>ct`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ct`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ct`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function oI(t,e){const n=!Xt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.0.0-next-b24d538-20231108";let o,s="invalid",a="invalid";t=ww(t||"");const l=rz(t);if(n||r||l)if(l){const u=J("15/11/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=tz(t);o=J((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(nz()&&(s="valid",a="valid"),!SR&&s!=="valid"&&(yR[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](yR[s]({keyValidityDate:o,hotVersion:i})),SR=!0),a!=="valid"&&e.parentNode&&bR[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=bR[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function rz(t){let e=[][lu],n=e;if(t[lu]!==vu("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=vu(i.shift());o;o=vu(i.shift()||"A"))--o<""[lu]?n=n|(vR(`${vR(Cu(r)+(Cu(Ad(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Ad(t,o,o?i[lu]===1?9:8:6);return n===e}const iz=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:oI,isDefined:le,isEmpty:Xt,isRegExp:iI,isUndefined:mt,stringify:Nt},Symbol.toStringTag,{value:"Module"}));function yn(t){return t[0].toUpperCase()+t.substr(1)}function oz(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Nt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function XC(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function qC(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function ZC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function Cw(t){return Mf(`${t}`,{ALLOWED_TAGS:[]})}function Mf(t,e){return jW.sanitize(t,e)}const sz=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:oz,isPercentValue:qC,randomString:XC,sanitize:Mf,stripTags:Cw,substitute:ZC,toUpperCaseFirst:yn},Symbol.toStringTag,{value:"Module"})),dl=t=>["tabindex",t],az=()=>["role","treegrid"],$r=()=>["role","presentation"],lz=()=>["role","gridcell"],uz=()=>["role","rowheader"],cz=()=>["role","columnheader"],sI=()=>["role","row"],hz=()=>["role","menu"],dz=()=>["role","menuitem"],fz=()=>["role","combobox"],aI=()=>["role","listbox"],gz=()=>["role","option"],mz=()=>["role","checkbox"],pz=()=>["scope","col"],wz=()=>["scope","row"],Cz=()=>["type","text"],Wo=t=>["aria-label",t],ku=t=>["aria-description",t],so=()=>["aria-hidden","true"],vz=()=>["aria-disabled","true"],Sz=()=>["aria-multiselectable","true"],fl=t=>["aria-haspopup",t],lI=t=>["aria-rowcount",t],uI=t=>["aria-colcount",t],cI=t=>["aria-rowindex",t],QC=t=>["aria-colindex",t],sn=t=>["aria-expanded",t],yz=t=>["aria-sort",t],RR=()=>["aria-readonly","true"],ER=()=>["aria-invalid","true"],bz=t=>["aria-checked",t],vw=()=>["aria-selected","true"],Rz=()=>["aria-autocomplete","list"],Ez=t=>["aria-controls",t],Tz=t=>["aria-activedescendant",t],_z=t=>["aria-live",t],Mz=t=>["aria-relevant",t],Az=t=>["aria-setsize",t],Oz=t=>["aria-posinset",t];function hI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function dI(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function fI(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function $u(t){return fI(t)&&t.parent}function Pz(t){return!!Object.getPrototypeOf(t.parent)}function Vo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function uu(t,e,n){const r=[];let i=t;for(;i&&(i=Vo(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function No(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function gI(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Eo(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function mI(t){return!t||!t.length?[]:t.filter(e=>!!e)}function pI(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),e?{regexFree:r,regexes:n}:r}function Pe(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function ee(t,e){typeof e=="string"&&(e=e.split(" ")),e=mI(e),e.length>0&&t.classList.add(...e)}function De(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=pI(e,!0);n=mI(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function ve(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Ko(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=pI(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function JC(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)JC(e[n])}}function zr(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const wI=/(<(.*)>|&(.*);)/;function Qs(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;wI.test(e)?t.innerHTML=n?Mf(e):e:Bo(t,e)}function Bo(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(zr(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Uo(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Uo(n.host.impl);if(n.host)return Uo(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(eo(n).display==="none")return!1;n=n.parentNode}return!0}function Bt(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function ev(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Af(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Fu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?ev(e):t.scrollTop}function Od(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Af(e):t.scrollLeft}function Wu(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function Vs(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=eo(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function il(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=eo(t,n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function Iz(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function eo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function ut(t){return t.offsetWidth}function Ot(t){return t.offsetHeight}function Gi(t){return t.clientHeight||t.innerHeight}function Su(t){return t.clientWidth||t.innerWidth}function xz(t,e,n){t.addEventListener(e,n,!1)}function Hz(t,e,n){t.removeEventListener(e,n,!1)}function tv(t){return t.selectionStart?t.selectionStart:0}function CI(t){return t.selectionEnd?t.selectionEnd:0}function Dz(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function Sw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function sc(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let Wg;function Nz(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function Jt(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Wg===void 0&&(Wg=Nz(t)),Wg}function vI(t){return t.offsetWidth!==t.clientWidth}function SI(t){return t.offsetHeight!==t.clientHeight}function Of(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function Lz(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function ac(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Pd(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Pf(t){return Pd(t)&&t.hasAttribute("data-hot-input")===!1}function kz(t){const e=t.ownerDocument.activeElement;Pf(e)||t.select()}function nv(t){return!t.parentNode}function yI(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function rv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();ve(t,"contenteditable",!0),n&&ve(t,...so()),e&&ee(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function iv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&De(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function bI(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;rv(t,n),e(),iv(t,n)}function Bs(t,e){let{tagName:n,className:r,attributes:i}=e;const o=t.ownerDocument.createElement(n);return r&&ee(o,r),i&&i.length&&ve(o,i),t.appendChild(o),o}const $z=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:wI,addClass:ee,addEvent:xz,appendElement:Bs,clearTextSelection:Sw,closest:Vo,closestDown:uu,empty:zr,fastInnerHTML:Qs,fastInnerText:Bo,getCaretPosition:tv,getComputedStyle:eo,getCssTransform:Lz,getFrameElement:fI,getParent:hI,getParentWindow:$u,getScrollLeft:Od,getScrollTop:Fu,getScrollableElement:Wu,getScrollbarWidth:Jt,getSelectionEndPosition:CI,getSelectionText:Dz,getStyle:il,getTrimmingContainer:Vs,getWindowScrollLeft:Af,getWindowScrollTop:ev,hasAccessToParentWindow:Pz,hasClass:Pe,hasHorizontalScrollbar:SI,hasVerticalScrollbar:vI,index:gI,innerHeight:Gi,innerWidth:Su,isChildOf:No,isDetached:nv,isInput:Pd,isOutsideInput:Pf,isThisHotChild:dI,isVisible:Uo,makeElementContentEditableAndSelectItsContent:rv,matchesCSSRules:Iz,observeVisibilityChangeOnce:yI,offset:Bt,outerHeight:Ot,outerWidth:ut,overlayContainsElement:Eo,removeAttribute:Ko,removeClass:De,removeContentEditableFromElementAndDeselect:iv,removeEvent:Hz,removeTextNodes:JC,resetCssTransform:ac,runWithSelectedContendEditableElement:bI,selectElementIfAllowed:kz,setAttribute:ve,setCaretPosition:sc,setOverlayPosition:Of},Symbol.toStringTag,{value:"Module"}));function gt(t){return typeof t=="function"}function RI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function Fz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=RI(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function ov(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function Wz(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return Ft(i,(u,c)=>c(u),r.apply(this,a))}}function sv(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function EI(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Vz(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Id(t,e,n,r,i,o,s,a){return le(a)?t.call(e,n,r,i,o,s,a):le(s)?t.call(e,n,r,i,o,s):le(o)?t.call(e,n,r,i,o):le(i)?t.call(e,n,r,i):le(r)?t.call(e,n,r):le(n)?t.call(e,n):t.call(e)}const Bz=Object.freeze(Object.defineProperty({__proto__:null,curry:EI,curryRight:Vz,debounce:ov,fastCall:Id,isFunction:gt,partial:sv,pipe:Wz,throttle:RI,throttleAfterHits:Fz},Symbol.toStringTag,{value:"Module"}));var Uz=Fn,TR=GO,zz=dn,_R=ul,Gz=ZO,MR=Uz([].push),Yz=function(t){if(zz(t))return t;if(TR(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?MR(n,i):(typeof i=="number"||_R(i)==="Number"||_R(i)==="String")&&MR(n,Gz(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(TR(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},jz=Xs,TI=Qu,_I=gf,Kz=uf,lc=Fn,MI=vr,AR=dn,OR=mC,AI=_C,Xz=Yz,qz=gC,Zz=String,Lo=TI("JSON","stringify"),Hc=lc(/./.exec),PR=lc("".charAt),Qz=lc("".charCodeAt),Jz=lc("".replace),eG=lc(1 .toString),tG=/[\uD800-\uDFFF]/g,IR=/^[\uD800-\uDBFF]$/,xR=/^[\uDC00-\uDFFF]$/,HR=!qz||MI(function(){var t=TI("Symbol")("stringify detection");return Lo([t])!=="[null]"||Lo({a:t})!=="{}"||Lo(Object(t))!=="{}"}),DR=MI(function(){return Lo("\uDF06\uD834")!=='"\\udf06\\ud834"'||Lo("\uDEAD")!=='"\\udead"'}),nG=function(t,e){var n=AI(arguments),r=Xz(e);if(!(!AR(r)&&(t===void 0||OR(t))))return n[1]=function(i,o){if(AR(r)&&(o=Kz(r,this,Zz(i),o)),!OR(o))return o},_I(Lo,null,n)},rG=function(t,e,n){var r=PR(n,e-1),i=PR(n,e+1);return Hc(IR,t)&&!Hc(xR,i)||Hc(xR,t)&&!Hc(IR,r)?"\\u"+eG(Qz(t,0),16):t};Lo&&jz({target:"JSON",stat:!0,arity:3,forced:HR||DR},{stringify:function(e,n,r){var i=AI(arguments),o=_I(HR?nG:Lo,null,i);return DR&&typeof o=="string"?Jz(o,tG,rG):o}});function ol(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Be(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=ol(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[ol(n[0])]:e[r]=[]:e[r]=null)})),e}function ao(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Ut(t,e,n){const r=Array.isArray(n);return Be(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function uc(t,e){Be(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),uc(t[r],e[r])):t[r]=e[r]})}function bn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Ln(t){const e={};return Be(t,(n,r)=>{e[r]=n}),e}function dt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return T(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Be(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const f=`_${c}`,g=w=>{let C=w;return(Array.isArray(C)||$e(C))&&(C=bn(C)),C};return function(){return this[f]===void 0&&(this[f]=g(h)),this[f]}},l=function(c){const h=`_${c}`;return function(f){this[h]=f}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function If(t,e){return JSON.stringify(t)===JSON.stringify(e)}function $e(t){return Object.prototype.toString.call(t)==="[object Object]"}function vi(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Be(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function OI(t,e){const n=e.split(".");let r=t;return Be(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function qh(t,e,n){const r=e.split(".");let i=t;r.forEach((o,s)=>{s!==r.length-1?(At(i,o)||(i[o]={}),i=i[o]):i[o]=n})}function xf(t){if(!$e(t))return 0;const e=function(n){let r=0;return $e(n)?Be(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Us(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function At(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const iG=Object.freeze(Object.defineProperty({__proto__:null,clone:Ln,createObjectPropListener:Us,deepClone:bn,deepExtend:uc,deepObjectSize:xf,defineGetter:vi,duckSchema:ol,extend:Ut,getProperty:OI,hasOwnProperty:At,inherit:ao,isObject:$e,isObjectEqual:If,mixin:dt,objectEach:Be,setProperty:qh},Symbol.toStringTag,{value:"Module"})),gr=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},lo={chrome:gr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:gr(t=>/CriOS/.test(t)),edge:gr(t=>/Edge/.test(t)),edgeWebKit:gr(t=>/EdgiOS/.test(t)),firefox:gr(t=>/Firefox/.test(t)),firefoxWebKit:gr(t=>/FxiOS/.test(t)),mobile:gr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:gr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},gl={mac:gr(t=>/^Mac/.test(t)),win:gr(t=>/^Win/.test(t)),linux:gr(t=>/^Linux/.test(t)),ios:gr(t=>/iPhone|iPad|iPod/i.test(t))};function PI(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Be(lo,n=>{let{test:r}=n;return void r(t,e)})}function II(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Be(gl,e=>{let{test:n}=e;return void n(t)})}PI();II();function av(){return lo.chrome.value}function xI(){return lo.chromeWebKit.value}function Zh(){return lo.firefox.value}function HI(){return lo.firefoxWebKit.value}function lv(){return lo.safari.value}function DI(){return lo.edge.value}function oG(){return lo.edgeWebKit.value}function Yi(){return lo.mobile.value}function uv(){return gl.ios.value}function cv(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&gl.mac.value}function yw(){return gl.win.value}function Vu(){return gl.mac.value}function sG(){return gl.linux.value}const aG=Object.freeze(Object.defineProperty({__proto__:null,isChrome:av,isChromeWebKit:xI,isEdge:DI,isEdgeWebKit:oG,isFirefox:Zh,isFirefoxWebKit:HI,isIOS:uv,isIpadOS:cv,isLinuxOS:sG,isMacOS:Vu,isMobileBrowser:Yi,isSafari:lv,isWindowsOS:yw,setBrowserMeta:PI,setPlatformMeta:II},Symbol.toStringTag,{value:"Module"})),ge={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Zh()?182:174,AUDIO_MUTE:Zh()?181:173,AUDIO_UP:Zh()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},lG=[ge.ALT,ge.ARROW_DOWN,ge.ARROW_LEFT,ge.ARROW_RIGHT,ge.ARROW_UP,ge.AUDIO_DOWN,ge.AUDIO_MUTE,ge.AUDIO_UP,ge.BACKSPACE,ge.CAPS_LOCK,ge.DELETE,ge.END,ge.ENTER,ge.ESCAPE,ge.F1,ge.F2,ge.F3,ge.F4,ge.F5,ge.F6,ge.F7,ge.F8,ge.F9,ge.F10,ge.F11,ge.F12,ge.F13,ge.F14,ge.F15,ge.F16,ge.F17,ge.F18,ge.F19,ge.HOME,ge.INSERT,ge.MEDIA_NEXT,ge.MEDIA_PLAY_PAUSE,ge.MEDIA_PREV,ge.MEDIA_STOP,ge.NULL,ge.NUM_LOCK,ge.PAGE_DOWN,ge.PAGE_UP,ge.PAUSE,ge.SCROLL_LOCK,ge.SHIFT,ge.TAB];function NI(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function hv(t){return lG.includes(t)}function uG(t){const e=[];return Vu()?e.push(ge.COMMAND_LEFT,ge.COMMAND_RIGHT,ge.COMMAND_FIREFOX):e.push(ge.CONTROL),e.includes(t)}function LI(t){return[ge.CONTROL,ge.COMMAND_LEFT,ge.COMMAND_RIGHT,ge.COMMAND_FIREFOX].includes(t)}function ml(t,e){const n=e.split("|");let r=!1;return T(n,i=>{if(t===ge[i])return r=!0,!1}),r}const cG=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:ge,isCtrlKey:uG,isCtrlMetaKey:LI,isFunctionKey:hv,isKey:ml,isPrintableChar:NI},Symbol.toStringTag,{value:"Module"}));function br(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Ao(t){return t.isImmediatePropagationEnabled===!1}function zo(t){return t.button===2}function Hf(t){return t.button===0}function kI(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const hG=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Ao,isLeftClick:Hf,isRightClick:zo,offsetRelativeTo:kI,stopImmediatePropagation:br},Symbol.toStringTag,{value:"Module"}));function pt(){le(console)&&console.warn(...arguments)}function dv(){le(console)&&console.error(...arguments)}function dG(t,e,n){return e=fG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fG(t){var e=gG(t,"string");return typeof e=="symbol"?e:String(e)}function gG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const aa=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],mG=ct`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Vg=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Bg=new Map([[]]);class $I{static getSingleton(){return wG()}constructor(){dG(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return T(aa,n=>e[n]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))T(n,i=>this.add(e,i,r));else{Vg.has(e)&&pt(ZC(mG,{hookName:e,removedInVersion:Vg.get(e)})),Bg.has(e)&&pt(Bg.get(e));const i=this.getBucket(r);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),n.skip=!1,i[e].indexOf(n)===-1){let o=!1;n.initialHook&&T(i[e],(s,a)=>{if(s.initialHook)return i[e][a]=n,o=!0,!1}),o||i[e].push(n)}}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?T(n,i=>this.once(e,i,r)):(n.runOnce=!0,this.add(e,n,r))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,i,o,s,a,l){{const u=this.globalBucket[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const f=Id(u[h],e,r,i,o,s,a,l);f!==void 0&&(r=f),u[h]&&u[h].runOnce&&this.remove(n,u[h]),h+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const f=Id(u[h],e,r,i,o,s,a,l);f!==void 0&&(r=f),u[h]&&u[h].runOnce&&this.remove(n,u[h],e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Be(this.getBucket(e),(n,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||aa.push(e)}deregister(e){this.isRegistered(e)&&aa.splice(aa.indexOf(e),1)}isDeprecated(e){return Bg.has(e)||Vg.has(e)}isRegistered(e){return aa.indexOf(e)>=0}getRegistered(){return aa}}const pG=new $I;function wG(){return pG}const fe=$I,Ug=new Map;function Yr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Ug.has(t)||Ug.set(t,new Map);const e=Ug.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const bw=new WeakMap,{register:CG,getItem:FI,hasItem:WI,getNames:vG,getValues:Qae}=Yr("editors");function SG(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},fe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function VI(t,e){let n;if(typeof t=="function")bw.get(t)||jn(null,t),n=bw.get(t);else if(typeof t=="string")n=FI(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function xd(t){if(typeof t=="function")return t;if(!WI(t))throw Error(`No registered editor found under "${t}" name`);return FI(t).getConstructor()}function jn(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new SG(e);typeof t=="string"&&CG(t,n),bw.set(e,n)}function yG(t,e,n){return e=bG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bG(t){var e=RG(t,"string");return typeof e=="symbol"?e:String(e)}function RG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Qh=0;class EG{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;yG(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,TG(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Qh+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Qh-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Qh-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function TG(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),br(this)},t}const sr=EG;function _G(){return Qh}function NR(t,e){MG(t,e),e.add(t)}function MG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ho(t,e,n){return e=AG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AG(t){var e=OG(t,"string");return typeof e=="symbol"?e:String(e)}function OG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function LR(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Df="editorManager.navigation";var kR=new WeakSet,$R=new WeakSet;class Rw{constructor(e,n,r){NR(this,$R),NR(this,kR),ho(this,"hot",void 0),ho(this,"tableMeta",void 0),ho(this,"selection",void 0),ho(this,"eventManager",void 0),ho(this,"destroyed",!1),ho(this,"lock",!1),ho(this,"activeEditor",void 0),ho(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new sr(e),this.hot.addHook("afterDocumentKeyDown",i=>LR(this,kR,PG).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>LR(this,$R,IG).call(this,i,o,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,l=>{l&&this.prepareEditor()});return}const{highlight:e}=this.hot.getSelectedRangeLast();if(e.isHeader())return;const{row:n,col:r}=e,i=this.hot.runHooks("modifyGetCellCoords",n,r);let o=n,s=r;if(Array.isArray(i)&&([o,s]=i),this.cellProperties=this.hot.getCellMeta(o,s),!this.isCellEditable()){this.clearActiveEditor();return}const a=this.hot.getCell(n,r,!0);if(a){const l=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(s),c=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),s);this.activeEditor=VI(l,this.hot),this.activeEditor.prepare(n,r,u,a,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function PG(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Ao(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!hv(n)&&!LI(n)&&!r&&!this.isEditorOpened()){const o=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>le(this.hot.getSelected()),group:Df};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.openEditor("",t)}}function IG(t,e,n){n.nodeName==="TD"&&this.openEditor(null,t,!0)}const FR=new WeakMap;Rw.getInstance=function(t,e,n){let r=FR.get(t);return r||(r=new Rw(t,e,n),FR.set(t,r)),r};const xG=Rw;function Dc(t,e){BI(t,e),e.add(t)}function Nc(t,e,n){BI(t,e),e.set(t,n)}function BI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xa(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function pn(t,e){var n=UI(t,e,"get");return HG(t,n)}function HG(t,e){return e.get?e.get.call(t):e.value}function _l(t,e,n){var r=UI(t,e,"set");return DG(t,r,n),n}function UI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function DG(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const Io=Object.freeze({CELL:"cell",MIXED:"mixed"});var tr=new WeakMap,Lc=new WeakMap,kc=new WeakMap,$c=new WeakMap,Ew=new WeakSet,Tw=new WeakSet,WR=new WeakSet,VR=new WeakSet;class NG{constructor(e){var n=this;Dc(this,VR),Dc(this,WR),Dc(this,Tw),Dc(this,Ew),Nc(this,tr,{writable:!0,value:void 0}),Nc(this,Lc,{writable:!0,value:void 0}),Nc(this,kc,{writable:!0,value:50}),Nc(this,$c,{writable:!0,value:null});const r=e.getSettings();_l(this,tr,e),_l(this,Lc,r.imeFastEdit?Io.MIXED:Io.CELL),pn(this,tr).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Xa(n,VR,kG).call(n,...o)}),pn(this,tr).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Xa(n,WR,LG).call(n,...o)})}getFocusMode(){return pn(this,Lc)}setFocusMode(e){Object.values(Io).includes(e)?_l(this,Lc,e):pt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return pn(this,kc)}setRefocusDelay(e){_l(this,kc,e)}setRefocusElementGetter(e){_l(this,$c,e)}getRefocusElement(){if(typeof pn(this,$c)=="function")return pn(this,$c).call(this);var e;return(e=pn(this,tr).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){var n;const r=Xa(this,Ew,zI).call(this),i=e||Xa(this,Tw,GI).call(this);let o=pn(this,tr).runHooks("modifyFocusedElement",r.row,r.col,i);o instanceof HTMLElement||(o=i),o&&!((n=pn(this,tr).getActiveEditor())!==null&&n!==void 0&&n.isOpened())&&o.focus({preventScroll:!0})}refocusToEditorTextarea(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pn(this,kc);const n=this.getRefocusElement();pn(this,tr).getSettings().imeFastEdit&&n&&pn(this,tr)._registerTimeout(()=>{n.select()},e)}}function zI(){return pn(this,tr).getSelectedRangeLast().highlight}function GI(){const t=Xa(this,Ew,zI).call(this);return pn(this,tr).getCell(t.row,t.col,!0)}function LG(){const t=Xa(this,Tw,GI).call(this),{activeElement:e}=pn(this,tr).rootDocument;e&&Pf(e)&&e.blur(),this.focusOnHighlightedCell(t),this.getFocusMode()===Io.MIXED&&t.nodeName==="TD"&&pn(this,tr).addHookOnce("afterSelectionEnd",()=>{this.refocusToEditorTextarea()})}function kG(t){t.imeFastEdit&&this.getFocusMode()!==Io.MIXED?this.setFocusMode(Io.MIXED):!t.imeFastEdit&&this.getFocusMode()!==Io.CELL&&this.setFocusMode(Io.CELL)}const YI={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},$G=new RegExp(Object.keys(YI).map(t=>`(${t})`).join("|"),"gi");function FG(t){return(t&&t.nodeName||"")==="TABLE"}function _w(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let f=0;f<o;f+=1){const g=e&&f===0,w=[];for(let S=0;S<s;S+=1){const b=!g&&n&&S===0;let _="";if(g)_=`<th>${t.getColHeader(S-c)}</th>`;else if(b)_=`<th>${t.getRowHeader(f-h)}</th>`;else{const O=i[f][S],{hidden:x,rowspan:I,colspan:$}=t.getCellMeta(f-h,S-c);if(!x){const z=[];if(I&&z.push(`rowspan="${I}"`),$&&z.push(`colspan="${$}"`),Xt(O))_=`<td ${z.join(" ")}></td>`;else{const q=O.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");_=`<td ${z.join(" ")}>${q}</td>`}}}w.push(_)}const C=["<tr>",...w,"</tr>"].join("");g?l.splice(1,0,C):u.splice(-1,0,C)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function Mw(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Xt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function jI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const O=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,x=>{const I=x.match(/<td\b[^>]*?>/g)[0],$=x.substring(I.length,x.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${I}${$}</td>`});i.insertAdjacentHTML("afterbegin",`${O}`),o=i.querySelector("table")}if(!o||!FG(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((O,x)=>O+x.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let f=!1,g=0,w=0;if(o.tHead){const O=Array.from(o.tHead.rows).filter(x=>{const I=x.querySelector("td")!==null;return I&&h.push(x),!I});g=O.length,f=g>0,g>1?n.nestedHeaders=Array.from(O).reduce((x,I)=>{const $=Array.from(I.cells).reduce((z,q,Y)=>{if(a&&Y===0)return z;const{colSpan:K,innerHTML:te}=q,oe=K>1?{label:te,colspan:K}:te;return z.push(oe),z},[]);return x.push($),x},[]):f&&(n.colHeaders=Array.from(O[0].children).reduce((x,I,$)=>(a&&$===0||x.push(I.innerHTML),x),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const C=[...h,...Array.from(o.tBodies).reduce((O,x)=>(O.push(...Array.from(x.rows)),O),[]),...c];w=C.length;const S=new Array(w);for(let O=0;O<w;O++)S[O]=new Array(u);const b=[],_=[];for(let O=0;O<w;O++){const x=C[O],I=Array.from(x.cells),$=I.length;for(let z=0;z<$;z++){const q=I[z],{nodeName:Y,innerHTML:K,rowSpan:te,colSpan:oe}=q,ie=S[O].findIndex(ue=>ue===void 0);if(Y==="TD"){if(te>1||oe>1){for(let Ie=O;Ie<O+te;Ie++)if(Ie<w)for(let R=ie;R<ie+oe;R++)S[Ie][R]=null;const be=q.getAttribute("style");be&&be.includes("mso-ignore:colspan")||b.push({col:ie,row:O,rowspan:te,colspan:oe})}let ue="";s&&/excel/gi.test(s.content)?ue=K.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ue=K.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[O][ie]=ue.replace($G,be=>YI[be])}else _.push(K)}}return b.length&&(n.mergeCells=b),_.length&&(n.rowHeaders=_),S.length&&(n.data=S),n}const WG=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:Mw,htmlToGridSettings:jI,instanceToHTML:_w},Symbol.toStringTag,{value:"Module"}));function Nn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function KI(t){return Nn(t,[","])}function pe(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function Hd(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function fv(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function qn(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const VG=Object.freeze(Object.defineProperty({__proto__:null,clamp:qn,isNumeric:Nn,isNumericLike:KI,rangeEach:pe,rangeEachReverse:Hd,valueAccordingPercent:fv},Symbol.toStringTag,{value:"Module"})),Aw="asc",BG="desc",BR=new Map([[Aw,[-1,1]],[BG,[1,-1]]]),UG=t=>`The priority '${t}' is already declared in a map.`,zG=t=>`The priority '${t}' is not a number.`;function GG(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=gt(t)?t:UG,e=gt(e)?e:zG;function r(o,s){if(!Nn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Aw;const[s,a]=BR.get(o)||BR.get(Aw);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const YG=t=>`The id '${t}' is already declared in a map.`;function Nf(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=gt(t)?t:YG;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[f,g]=h;return u===g?f:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const jG=t=>`'${t}' value is already declared in a unique set.`;function KG(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=gt(t)?t:jG;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const gv=t=>`There is already registered "${t}" plugin.`,XG=t=>`There is already registered plugin on priority "${t}".`,qG=t=>`The priority "${t}" is not a number.`,XI=GG({errorPriorityExists:XG,errorPriorityNaN:qG}),qI=KG({errorItemExists:gv}),Ow=Nf({errorIdExists:gv});function mv(){return[...XI.getItems(),...qI.getItems()]}function cc(t){const e=yn(t);return Ow.getItem(e)}function ZG(t){return!!cc(t)}function et(t,e,n){[t,e,n]=JG(t,e,n),cc(t)===void 0&&QG(t,e,n)}function QG(t,e,n){const r=yn(t);if(Ow.hasItem(r))throw new Error(gv(r));n===void 0?qI.addItem(r):XI.addItem(n,r),Ow.addItem(r,e)}function JG(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:eY,getItem:tY,hasItem:ZI,getNames:nY,getValues:Jae}=Yr("renderers");function Dd(t){if(typeof t=="function")return t;if(!ZI(t))throw Error(`No registered renderer found under "${t}" name`);return tY(t)}function ai(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),eY(t,e)}const{register:rY,getItem:iY,hasItem:QI,getNames:oY,getValues:ele}=Yr("validators");function pv(t){if(typeof t=="function")return t;if(!QI(t))throw Error(`No registered validator found under "${t}" name`);return iY(t)}function qa(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),rY(t,e)}var JI={},sY=BO,aY=EC,lY=Object.keys||function(e){return sY(e,aY)},uY=mi,cY=NO,hY=Ks,dY=Ju,fY=cf,gY=lY;JI.f=uY&&!cY?Object.defineProperties:function(e,n){dY(e);for(var r=fY(n),i=gY(n),o=i.length,s=0,a;o>s;)hY.f(e,a=i[s++],r[a]);return e};var mY=Ju,pY=JI,UR=EC,wY=yC,CY=nP,vY=vC,SY=$O,zR=">",GR="<",Pw="prototype",Iw="script",ex=SY("IE_PROTO"),zg=function(){},tx=function(t){return GR+Iw+zR+t+GR+"/"+Iw+zR},YR=function(t){t.write(tx("")),t.close();var e=t.parentWindow.Object;return t=null,e},yY=function(){var t=vY("iframe"),e="java"+Iw+":",n;return t.style.display="none",CY.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(tx("document.F=Object")),n.close(),n.F},Fc,Jh=function(){try{Fc=new ActiveXObject("htmlfile")}catch{}Jh=typeof document<"u"?document.domain&&Fc?YR(Fc):yY():YR(Fc);for(var t=UR.length;t--;)delete Jh[Pw][UR[t]];return Jh()};wY[ex]=!0;var bY=Object.create||function(e,n){var r;return e!==null?(zg[Pw]=mY(e),r=new zg,zg[Pw]=null,r[ex]=e):r=Jh(),n===void 0?r:pY.f(r,n)},RY=df,EY=bY,TY=Ks.f,xw=RY("unscopables"),Hw=Array.prototype;Hw[xw]===void 0&&TY(Hw,xw,{configurable:!0,value:EY(null)});var nx=function(t){Hw[xw][t]=!0},_Y=Xs,MY=hf,AY=ff,OY=RC,PY=nx;_Y({target:"Array",proto:!0},{at:function(e){var n=MY(this),r=AY(n),i=OY(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});PY("at");const Hs=1,Cn=2;function jR(t,e,n){IY(t,e),e.set(t,n)}function IY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ri(t,e,n){return e=xY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xY(t){var e=HY(t,"string");return typeof e=="symbol"?e:String(e)}function HY(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gt(t,e){var n=rx(t,e,"get");return DY(t,n)}function DY(t,e){return e.get?e.get.call(t):e.value}function KR(t,e,n){var r=rx(t,e,"set");return NY(t,r,n),n}function rx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function NY(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Wc=new WeakMap,Yt=new WeakMap;class wv{static get DEFAULT_WIDTH(){return 50}constructor(e){Ri(this,"count",0),Ri(this,"startColumn",null),Ri(this,"endColumn",null),Ri(this,"startPosition",null),Ri(this,"isVisibleInTrimmingContainer",!1),Ri(this,"stretchAllRatio",0),Ri(this,"stretchLastWidth",0),jR(this,Wc,{writable:!0,value:0}),Ri(this,"needVerifyLastColumnWidth",!0),Ri(this,"stretchAllColumnsWidth",[]),jR(this,Yt,{writable:!0,value:void 0}),KR(this,Yt,e),typeof Gt(this,Yt).stretchingColumnWidthFn!="function"&&(Gt(this,Yt).stretchingColumnWidthFn=n=>n),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,scrollOffset:r,totalColumns:i,viewportWidth:o}=Gt(this,Yt),s=Math.max(Gt(this,Yt).scrollOffset,0),a=s>0?o+1:o;let l=0,u=!0;const c=[];let h,f=0,g=0;for(let b=0;b<i;b++)if(h=this._getColumnWidth(b),l<=s&&e!==Cn&&(this.startColumn=b,f=h),l>=s&&l+(e===Cn?h:0)<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=b,f=h),this.endColumn=b),c.push(l),l+=h,g=h,e!==Cn&&(this.endColumn=b),l>=s+o){u=!1;break}const w=r+o-a,C=e===Cn?0:g,S=e===Cn?f:0;if(w<-1*Gt(this,Yt).inlineStartOffset||r>c.at(-1)+C||-1*Gt(this,Yt).scrollOffset-Gt(this,Yt).viewportWidth>-1*S?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===i-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const b=c[this.endColumn]+h-c[this.startColumn-1];if((b<=o||e!==Cn)&&(this.startColumn-=1),b>o)break}e===Hs&&this.startColumn!==null&&n&&n(this),this.startPosition=c[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(Gt(this,Yt).stretchMode==="none")return;let n=e;KR(this,Wc,n);const r=Gt(this,Yt).totalColumns;let i=0;for(let s=0;s<r;s++){const a=this._getColumnWidth(s),l=Gt(this,Yt).stretchingColumnWidthFn(void 0,s);typeof l=="number"?n-=l:i+=a}const o=n-i;if(Gt(this,Yt).stretchMode==="all"&&o>0)this.stretchAllRatio=n/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(Gt(this,Yt).stretchMode==="last"&&n!==1/0){const s=this._getColumnWidth(r-1),a=o+s;this.stretchLastWidth=a>=0?a:s}}getStretchedColumnWidth(e,n){let r=null;return Gt(this,Yt).stretchMode==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):Gt(this,Yt).stretchMode==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0;const i=Gt(this,Yt).totalColumns;if(!this.stretchAllColumnsWidth[e]){const o=Math.round(n*this.stretchAllRatio),s=Gt(this,Yt).stretchingColumnWidthFn(o,e);s===void 0?this.stretchAllColumnsWidth[e]=o:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let o=0;o<this.stretchAllColumnsWidth.length;o++)r+=this.stretchAllColumnsWidth[o];r!==Gt(this,Wc)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=Gt(this,Wc)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const n=Gt(this,Yt).totalColumns;return e===n-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=Gt(this,Yt).columnWidthFn(e);return isNaN(n)&&(n=wv.DEFAULT_WIDTH),n}}const Cv=wv;function LY(t,e,n){kY(t,e),e.set(t,n)}function kY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ml(t,e,n){return e=$Y(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Y(t){var e=FY(t,"string");return typeof e=="symbol"?e:String(e)}function FY(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gg(t,e){var n=ix(t,e,"get");return WY(t,n)}function WY(t,e){return e.get?e.get.call(t):e.value}function VY(t,e,n){var r=ix(t,e,"set");return BY(t,r,n),n}function ix(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function BY(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Al=new WeakMap;class vv{static get DEFAULT_HEIGHT(){return 23}constructor(e){Ml(this,"count",0),Ml(this,"startRow",null),Ml(this,"endRow",null),Ml(this,"startPosition",null),Ml(this,"isVisibleInTrimmingContainer",!1),LY(this,Al,{writable:!0,value:void 0}),VY(this,Al,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,rowHeightFn:r,scrollOffset:i,totalRows:o,viewportHeight:s}=Gg(this,Al),a=Math.max(Gg(this,Al).scrollOffset,0),l=Gg(this,Al).horizontalScrollbarHeight||0;let u=0,c=!0;const h=[];let f,g=0,w=0;for(let _=0;_<o;_++)if(f=r(_),isNaN(f)&&(f=vv.DEFAULT_HEIGHT),u<=a&&e!==Cn&&(this.startRow=_,g=f),u>=a&&u+(e===Cn?f:0)<=a+s-l&&(this.startRow===null&&(this.startRow=_,g=f),this.endRow=_),h.push(u),u+=f,w=f,e!==Cn&&(this.endRow=_),u>=a+s-l){c=!1;break}const C=i+s-l,S=e===Cn?g:0,b=e===Cn?0:w;if(C<S||i>h.at(-1)+b?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const _=h[this.endRow]+f-h[this.startRow-1];if((_<=s-l||e!==Cn)&&(this.startRow-=1),_>=s-l)break}e===Hs&&this.startRow!==null&&n&&n(this),this.startPosition=h[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}const ox=vv;function UY(t,e,n){zY(t,e),e.set(t,n)}function zY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XR(t,e,n){return e=GY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GY(t){var e=YY(t,"string");return typeof e=="symbol"?e:String(e)}function YY(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function la(t,e){var n=sx(t,e,"get");return jY(t,n)}function jY(t,e){return e.get?e.get.call(t):e.value}function qR(t,e,n){var r=sx(t,e,"set");return KY(t,r,n),n}function sx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function KY(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ei=new WeakMap;class Nd{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;XR(this,"row",null),XR(this,"col",null),UY(this,Ei,{writable:!0,value:!1}),qR(this,Ei,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return la(this,Ei)}isSouthEastOf(e){return this.row>=e.row&&(la(this,Ei)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(la(this,Ei)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(la(this,Ei)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(la(this,Ei)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Nd&&qR(this,Ei,e.isRtl()),this}clone(){return new Nd(this.row,this.col,la(this,Ei))}toObject(){return{row:this.row,col:this.col}}}const Ld=Nd;function XY(t,e,n){qY(t,e),e.set(t,n)}function qY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yg(t,e,n){return e=ZY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZY(t){var e=QY(t,"string");return typeof e=="symbol"?e:String(e)}function QY(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kr(t,e){var n=ax(t,e,"get");return JY(t,n)}function JY(t,e){return e.get?e.get.call(t):e.value}function ej(t,e,n){var r=ax(t,e,"set");return tj(t,r,n),n}function ax(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function tj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var lr=new WeakMap;class Sv{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Yg(this,"highlight",null),Yg(this,"from",null),Yg(this,"to",null),XY(this,lr,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),ej(this,lr,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(r.row,s.row),c=Math.max(r.col,s.col),h=this._createCellCoords(a,l),f=this._createCellCoords(u,c);return this.from=h,this.to=f,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Kr(this,lr)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Kr(this,lr)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Kr(this,lr)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Kr(this,lr)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Kr(this,lr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Kr(this,lr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Kr(this,lr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Kr(this,lr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,n){return n&&n.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,n){if(!(e instanceof Ld))return!1;if(n){const{from:r,to:i}=n;if(n.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(r.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,r.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push("right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push("left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new Sv(this.highlight,this.from,this.to,Kr(this,lr))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new Ld(e,n,Kr(this,lr))}}const yv=Sv;function Lf(t){return window.requestAnimationFrame(t)}function Bu(t){window.cancelAnimationFrame(t)}function bv(){return"ontouchstart"in window}let ua;function lx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ua||(typeof Intl=="object"?ua=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?ua=(n,r)=>`${n}`.localeCompare(r):ua=(n,r)=>n===r?0:n>r?-1:1,ua)}const nj=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Bu,getComparisonFunction:lx,isTouchSupported:bv,requestAnimationFrame:Lf},Symbol.toStringTag,{value:"Module"}));function Xr(t,e,n){rj(t,e),e.set(t,n)}function rj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function we(t,e){var n=ux(t,e,"get");return ij(t,n)}function ij(t,e){return e.get?e.get.call(t):e.value}function fo(t,e,n){var r=ux(t,e,"set");return oj(t,r,n),n}function ux(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function oj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ur=new WeakMap,jg=new WeakMap,tn=new WeakMap,ca=new WeakMap,Vc=new WeakMap,Er=new WeakMap,Kg=new WeakMap,Ol=new WeakMap,ts=new WeakMap,qr=new WeakMap;let sj=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Xr(this,ur,{writable:!0,value:void 0}),Xr(this,jg,{writable:!0,value:void 0}),Xr(this,tn,{writable:!0,value:void 0}),Xr(this,ca,{writable:!0,value:void 0}),Xr(this,Vc,{writable:!0,value:void 0}),Xr(this,Er,{writable:!0,value:void 0}),Xr(this,Kg,{writable:!0,value:void 0}),Xr(this,Ol,{writable:!0,value:void 0}),Xr(this,ts,{writable:!0,value:[null,null]}),Xr(this,qr,{writable:!0,value:[null,null]}),fo(this,ur,r),fo(this,jg,n),fo(this,tn,o),fo(this,ca,s),fo(this,Vc,a),fo(this,Er,i),fo(this,Kg,e),this.registerEvents()}registerEvents(){we(this,Er).addEventListener(we(this,tn).holder,"contextmenu",r=>this.onContextMenu(r)),we(this,Er).addEventListener(we(this,tn).TABLE,"mouseover",r=>this.onMouseOver(r)),we(this,Er).addEventListener(we(this,tn).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{we(this,Er).addEventListener(we(this,tn).holder,"touchstart",r=>this.onTouchStart(r)),we(this,Er).addEventListener(we(this,tn).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),we(this,Er).addEventListener(we(this,tn).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||we(this,ur).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,we(this,ur).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{we(this,Er).addEventListener(we(this,tn).holder,"mouseup",r=>this.onMouseUp(r)),we(this,Er).addEventListener(we(this,tn).holder,"mousedown",r=>this.onMouseDown(r))};Yi()?e():(bv()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(we(this,Ol)&&r){const[i,o]=[r.row,we(this,Ol).from.row],[s,a]=[r.col,we(this,Ol).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=we(this,tn).TABLE,i=uu(e,["TD","TH"],r);return i?(n.coords=we(this,tn).getCoords(i),n.TD=i):Pe(e,"wtBorder")&&Pe(e,"current")?(n.coords=we(this,ca).getFocusSelection().cellRange.highlight,n.TD=we(this,tn).getCell(n.coords)):Pe(e,"wtBorder")&&Pe(e,"area")&&we(this,ca).getAreaSelection().cellRange&&(n.coords=we(this,ca).getAreaSelection().cellRange.to,n.TD=we(this,tn).getCell(n.coords)),n}onMouseDown(e){const n=we(this,jg).rootDocument.activeElement,r=sv(hI,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);Pe(i,"corner")?we(this,ur).getSetting("onCellCornerMouseDown",e,i):o.TD&&we(this,ur).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(we(this,qr)[0]=o.TD,clearTimeout(we(this,ts)[0]),we(this,ts)[0]=setTimeout(()=>{we(this,qr)[0]=null},1e3))}onContextMenu(e){if(we(this,ur).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!we(this,ur).has("onCellMouseOver"))return;const n=we(this,tn).TABLE,r=uu(e.target,["TD","TH"],n),i=we(this,Vc)||this;r&&r!==i.lastMouseOver&&No(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,we(this,tn).getCoords(r),r))}onMouseOut(e){if(!we(this,ur).has("onCellMouseOut"))return;const n=we(this,tn).TABLE,r=uu(e.target,["TD","TH"],n),i=uu(e.relatedTarget,["TD","TH"],n),o=we(this,Vc)||this;r&&r!==i&&No(r,n)&&(this.callListener("onCellMouseOut",e,we(this,tn).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&we(this,ur).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===we(this,qr)[0]&&n.TD===we(this,qr)[1]?(Pe(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),we(this,qr)[0]=null,we(this,qr)[1]=null):n.TD===we(this,qr)[0]&&(we(this,qr)[1]=n.TD,clearTimeout(we(this,ts)[1]),we(this,ts)[1]=setTimeout(()=>{we(this,qr)[1]=null},500)))}onTouchStart(e){fo(this,Ol,we(this,ca).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=le(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&we(this,ur).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];uv()&&(xI()||HI())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=we(this,ur).getSettingPure(e);o&&o(n,r,i,we(this,Kg).call(this))}destroy(){clearTimeout(we(this,ts)[0]),clearTimeout(we(this,ts)[1]),we(this,Er).destroy()}};const cx=sj;function Xg(t,e,n){return e=aj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aj(t){var e=lj(t,"string");return typeof e=="symbol"?e:String(e)}function lj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uj{constructor(e,n,r){Xg(this,"offset",void 0),Xg(this,"total",void 0),Xg(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const cj=uj;function qg(t,e,n){return e=hj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hj(t){var e=dj(t,"string");return typeof e=="symbol"?e:String(e)}function dj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fj{constructor(e,n,r){qg(this,"offset",void 0),qg(this,"total",void 0),qg(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const gj=fj,mj=0,kd=1,$d=2;function Bc(t,e,n){return e=pj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pj(t){var e=wj(t,"string");return typeof e=="symbol"?e:String(e)}function wj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZR{constructor(){Bc(this,"currentSize",0),Bc(this,"nextSize",0),Bc(this,"currentOffset",0),Bc(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function Zg(t,e,n){return e=Cj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cj(t){var e=vj(t,"string");return typeof e=="symbol"?e:String(e)}function vj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sj{constructor(){Zg(this,"size",new ZR),Zg(this,"workingSpace",mj),Zg(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof ZR}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=kd,e.workingSpace=$d,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=$d,e.workingSpace=kd,this.sharedSize=e.getViewSize()}}function ha(t,e,n){return e=yj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yj(t){var e=bj(t,"string");return typeof e=="symbol"?e:String(e)}function bj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hx{constructor(e,n,r){ha(this,"rootNode",void 0),ha(this,"nodesPool",void 0),ha(this,"sizeSet",new Sj),ha(this,"childNodeType",void 0),ha(this,"visualIndex",0),ha(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(kd))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn($d)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}const s=r&&n.isPlaceOn(kd);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn($d)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class dx extends hx{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function Rj(t,e,n){return e=Ej(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ej(t){var e=Tj(t,"string");return typeof e=="symbol"?e:String(e)}function Tj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _j{constructor(e){Rj(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Pl(t,e,n){return e=Mj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mj(t){var e=Aj(t,"string");return typeof e=="symbol"?e:String(e)}function Aj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hc{constructor(e,n){Pl(this,"nodesPool",null),Pl(this,"nodeType",void 0),Pl(this,"rootNode",void 0),Pl(this,"table",null),Pl(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new _j(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function QR(t,e,n){return e=Oj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oj(t){var e=Pj(t,"string");return typeof e=="symbol"?e:String(e)}function Pj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ij extends hc{constructor(){super("TH"),QR(this,"orderViews",new WeakMap),QR(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new dx(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<r;h++){u.render();const f=u.getCurrentNode();f.className="",f.removeAttribute("style"),Ko(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ve(f,[uz(),wz(),QC(h+1),dl(-1)]),n[h](a,f,h)}u.end()}}}class xj extends hc{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&zr(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&ve(this.rootNode,[$r()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&ve(s,[sI(),cI(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Ko(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ve(u,[QC(a+1+this.table.rowHeadersCount),dl(-1),...a<0?[$r()]:[cz(),pz()]]),r[n](l,u,n)}}}}class Hj extends hc{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&ee(r,"rowHeader")}}function Dj(t,e,n){return e=Nj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nj(t){var e=Lj(t,"string");return typeof e=="symbol"?e:String(e)}function Lj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let JR=!1;class kj extends hc{constructor(e){super("TR",e),Dj(this,"orderView",void 0),this.orderView=new hx(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!JR&&e>1e3&&(JR=!0,pt(ct`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&ve(this.rootNode,[$r()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;ve(o,[sI(),cI(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}function eE(t,e,n){return e=$j(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $j(t){var e=Fj(t,"string");return typeof e=="symbol"?e:String(e)}function Fj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wj extends hc{constructor(){super("TD"),eE(this,"orderViews",new WeakMap),eE(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new dx(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let f=0;f<n;f++){c.render();const g=c.getCurrentNode(),w=this.table.renderedColumnToSource(f);if(Pe(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),Ko(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,w,g),this.table.isAriaEnabled()){var o,s;ve(g,[...g.hasAttribute("role")?[]:[lz()],dl(-1),QC(w+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function nn(t,e,n){return e=Vj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vj(t){var e=Bj(t,"string");return typeof e=="symbol"?e:String(e)}function Bj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uj{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};nn(this,"rootNode",void 0),nn(this,"rootDocument",void 0),nn(this,"rowHeaders",null),nn(this,"columnHeaders",null),nn(this,"colGroup",null),nn(this,"rows",null),nn(this,"cells",null),nn(this,"rowFilter",null),nn(this,"columnFilter",null),nn(this,"rowUtils",null),nn(this,"columnUtils",null),nn(this,"rowsToRender",0),nn(this,"columnsToRender",0),nn(this,"rowHeaderFunctions",[]),nn(this,"rowHeadersCount",0),nn(this,"columnHeaderFunctions",[]),nn(this,"columnHeadersCount",0),nn(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r);if(i.firstChild){const o=this.renderedRowToSource(r),s=this.rowUtils.getHeight(o);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}}class zj{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Uj(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new Ij,columnHeaders:new xj(n),colGroup:new Hj(r),rows:new kj(i),cells:new Wj}),this.renderer.setAxisUtils(o,s)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Qg(t,e,n){return e=Gj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gj(t){var e=Yj(t,"string");return typeof e=="symbol"?e:String(e)}function Yj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jj{constructor(e,n){Qg(this,"dataAccessObject",void 0),Qg(this,"wtSettings",void 0),Qg(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const n=this.dataAccessObject.wtViewport.columnsRenderCalculator;let r=this.getWidth(e);if(n){const i=n.getStretchedColumnWidth(e,r);i&&(r=i)}return r}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:n,wtViewport:r,cloneSource:i}=this.dataAccessObject,o=i?i.wtTable.holder:n.holder,s=o.offsetHeight<o.scrollHeight?Jt():0;let a=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-s),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){const l=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth");for(let c=0;c<l;c++){let h=Array.isArray(a)?a[c]:a;h=h??u,this.headerWidths.set(c,h)}}}}function tE(t,e,n){return e=Kj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kj(t){var e=Xj(t,"string");return typeof e=="symbol"?e:String(e)}function Xj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qj{constructor(e,n){tE(this,"dataAccessObject",void 0),tE(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}}function Zr(t,e,n){return e=Zj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zj(t){var e=Qj(t,"string");return typeof e=="symbol"?e:String(e)}function Qj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jj{constructor(e,n,r,i,o){Zr(this,"wtSettings",null),Zr(this,"domBindings",void 0),Zr(this,"TBODY",null),Zr(this,"THEAD",null),Zr(this,"COLGROUP",null),Zr(this,"hasTableHeight",!0),Zr(this,"hasTableWidth",!0),Zr(this,"isTableVisible",!1),Zr(this,"tableOffset",0),Zr(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,JC(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new qj(this.dataAccessObject,this.wtSettings),this.columnUtils=new jj(this.dataAccessObject,this.wtSettings),this.tableRenderer=new zj({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Pe(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&ve(r,[$r()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Pe(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ve(r,[$r()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Pe(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&ve(r.parentNode,[$r()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ve(r,[$r()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=!1,f=e;if(this.isMaster&&(this.holderOffset=Bt(this.holder),f=i.createRenderCalculators(f),l&&!n.getSetting("fixedColumnsStart"))){const w=r.inlineStartOverlay.getScrollPosition(),C=this.correctHeaderWidth;this.correctHeaderWidth=w!==0,C!==this.correctHeaderWidth&&(f=!1)}if(this.isMaster&&(h=r.updateStateOfRendering()),f)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=Bt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const w=o>0?this.getFirstRenderedRow():0,C=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new gj(w,o,c),this.columnFilter=new cj(C,s,l);let S=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),S=b.skipRender!==!0}if(S){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(hi)||this.is(ko))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let b;if(this.isMaster&&(b=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(hi))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const _=ut(this.hider),O=ut(this.TABLE);_!==0&&O!==_&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),b!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(hi)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let g=!1;return this.isMaster&&(g=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(g=r.bottomOverlay.resetFixedPosition()||g),g=r.inlineStartOverlay.resetFixedPosition()||g,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),g?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(f),h&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Gi(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(hi))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Vo(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let o=gI(r),s=n.cellIndex;return Eo(Ys,n,this.wtRootElement)||Eo(zs,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Eo(ko,n,this.wtRootElement)||Eo(hi,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),Eo(Ys,n,this.wtRootElement)||Eo(Gs,n,this.wtRootElement)||Eo(ko,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),r=Gi(this.TBODY)-1;let i,o,s,a,l;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=Gi(l):o=Gi(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return ut(this.TABLE)}getHeight(){return Ot(this.TABLE)}getTotalWidth(){const e=ut(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Ot(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Uo(this.TABLE)}_modifyRowHeaderWidth(e){let n=gt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const pl=Jj,eK="stickyRowsBottom",fx={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};vi(fx,"MIXIN_NAME",eK,{writable:!1,enumerable:!1});const gx=fx,tK="stickyColumnsStart",mx={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};vi(mx,"MIXIN_NAME",tK,{writable:!1,enumerable:!1});const Rv=mx;class Ev extends pl{constructor(e,n,r,i){super(e,n,r,i,ko)}}dt(Ev,gx);dt(Ev,Rv);const nK=Ev,zs="top",hi="bottom",Gs="inline_start",Ys="top_inline_start_corner",ko="bottom_inline_start_corner",rK=[zs,hi,Gs,Ys,ko],iK=new Map([[zs,`ht_clone_${zs}`],[hi,`ht_clone_${hi}`],[Gs,`ht_clone_${Gs} ht_clone_left`],[Ys,`ht_clone_${Ys} ht_clone_top_left_corner`],[ko,`ht_clone_${ko} ht_clone_bottom_left_corner`]]);function Jg(t,e,n){return e=oK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oK(t){var e=sK(t,"string");return typeof e=="symbol"?e:String(e)}function sK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aK{constructor(e){Jg(this,"dataAccessObject",void 0),Jg(this,"lastScrolledColumnPos",-1),Jg(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,n,r,i,o){const s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,n,i);return s||a}scrollViewportHorizontally(e,n,r){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=n===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let h=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?h=c.scrollTo(e,l?e>this.lastScrolledColumnPos:n):(l&&(e<s||e>a)||!l)&&(h=c.scrollTo(e,l?e>a:n)),h&&(this.lastScrolledColumnPos=e),h}scrollViewportVertically(e,n,r){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=n===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:h}=this.dataAccessObject;if(l&&(e<c||e>o-u-1))return!1;let f=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?f=h.scrollTo(e,l?e>this.lastScrolledRowPos:r):(l&&(e<s||e>a)||!l)&&(f=h.scrollTo(e,l?e>a:r)),f&&(this.lastScrolledRowPos=e),f}getFirstVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,fixedRowsTop:o,rootWindow:s}=this.dataAccessObject;let a=n.getFirstVisibleRow();if(e.mainTableScrollableElement===s){const l=Bt(n.wtRootElement),u=Gi(n.hider),c=Gi(s),h=Fu(s,s);if(l.top+u-c<=h){let f=r.getColumnHeaderHeight();f+=e.sumCellSizes(0,o);for(let g=i;g>0;g--)if(f+=e.sumCellSizes(g-1,g),l.top+u-f<=h){a=g;break}}}return a}getLastVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;let s=n.getLastVisibleRow();if(e.mainTableScrollableElement===o){const a=Bt(n.wtRootElement),l=Fu(o,o);if(a.top>l){const u=Gi(o);let c=r.getColumnHeaderHeight();for(let h=1;h<=i;h++)if(c+=e.sumCellSizes(h-1,h),a.top+c-l>=u){s=h-2;break}}}return s}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:n,wtViewport:r,totalColumns:i,rootWindow:o}=this.dataAccessObject;let s=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===o){const a=Bt(n.wtRootElement),l=Su(n.hider),u=Su(o),c=Math.abs(Od(o,o));if(a.left+l-u<=c){let h=r.getRowHeaderWidth();for(let f=i;f>0;f--)if(h+=e.sumCellSizes(f-1,f),a.left+l-h<=c){s=f;break}}}return s}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;let a=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){const l=e.getSetting("rtlMode");let u=null;if(l){const h=r.TABLE.getBoundingClientRect(),g=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(h.right-g)}else u=Bt(r.wtRootElement).left;const c=Math.abs(Od(s,s));if(u>c){const h=Su(s);let f=i.getRowHeaderWidth();for(let g=1;g<=o;g++)if(f+=n.sumCellSizes(g-1,g),u+f-c>=h){a=g-2;break}}}return a}}const lK=aK;function Tr(t,e,n){return e=uK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uK(t){var e=cK(t,"string");return typeof e=="symbol"?e:String(e)}function cK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tv{get eventManager(){return new sr(this)}constructor(e,n){Tr(this,"wtTable",void 0),Tr(this,"wtScroll",void 0),Tr(this,"wtViewport",void 0),Tr(this,"wtOverlays",void 0),Tr(this,"selectionManager",void 0),Tr(this,"wtEvent",void 0),Tr(this,"guid",`wt_${XC()}`),Tr(this,"drawInterrupted",!1),Tr(this,"drawn",!1),Tr(this,"domBindings",void 0),Tr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new lK(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Bo(r,e[n])}])}}createCellCoords(e,n){return new Ld(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new yv(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function nE(t,e,n){return e=hK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hK(t){var e=dK(t,"string");return typeof e=="symbol"?e:String(e)}function dK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fK extends Tv{constructor(e,n,r){super(e,n),nE(this,"cloneSource",void 0),nE(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new cx(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function gK(t,e,n){return e=mK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mK(t){var e=pK(t,"string");return typeof e=="symbol"?e:String(e)}function pK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dc{constructor(e,n,r,i,o){gK(this,"wtSettings",null),vi(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Vs(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Vs(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Wu(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){pt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Jt())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(rK.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("DIV"),s=r.createElement("TABLE"),a=e.wtRootElement.parentNode;o.className=`${iK.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&ve(o,[$r()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===zs||u==="vertical"&&this.type===Gs?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Wu(e.TABLE),new fK(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;T([r,i,o],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class wK extends dc{constructor(e,n,r,i,o,s){super(e,n,ko,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new nK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else ac(n),this.repositionOverlay();let r=Ot(this.clone.wtTable.TABLE);const i=ut(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Jt(r)),i.style.bottom=`${o}px`}}const CK="calculatedColumns",px={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};vi(px,"MIXIN_NAME",CK,{writable:!1,enumerable:!1});const _v=px;class Mv extends pl{constructor(e,n,r,i){super(e,n,r,i,hi)}}dt(Mv,gx);dt(Mv,_v);const vK=Mv;function SK(t,e,n){return e=yK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yK(t){var e=bK(t,"string");return typeof e=="symbol"?e:String(e)}function bK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RK extends dc{constructor(e,n,r,i){super(e,n,hi,r,i),SK(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new vK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Jt(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(Af(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=Jt(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=o),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Ot(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=Jt(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Fu(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=Pe(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(ee(s,"innerBorderBottom"),o=!a):(De(s,"innerBorderBottom"),o=a)}return o}}const EK="calculatedRows",wx={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};vi(wx,"MIXIN_NAME",EK,{writable:!1,enumerable:!1});const Cx=wx;class Av extends pl{constructor(e,n,r,i){super(e,n,r,i,Gs)}}dt(Av,Cx);dt(Av,Rv);const TK=Av,_K="localHooks",vx={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Id(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};vi(vx,"MIXIN_NAME",_K,{writable:!1,enumerable:!1});const Qn=vx;let Sx=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};dt(Sx,Qn);const MK=Sx,yx="active-header",Ov="header",Pv="area",Iv="focus",AK="fill",OK="row",PK="column",IK="custom-selection",xv=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var xK=nx;xK("flat");function HK(t,e){bx(t,e),e.add(t)}function rE(t,e,n){bx(t,e),e.set(t,n)}function bx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function em(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Wt(t,e){var n=Rx(t,e,"get");return DK(t,n)}function DK(t,e){return e.get?e.get.call(t):e.value}function iE(t,e,n){var r=Rx(t,e,"set");return NK(t,r,n),n}function Rx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function NK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var _r=new WeakMap,zn=new WeakMap,Uc=new WeakSet;class LK{constructor(){HK(this,Uc),rE(this,_r,{writable:!0,value:void 0}),rE(this,zn,{writable:!0,value:void 0})}setActiveOverlay(e){return iE(this,zn,e),this}setActiveSelection(e){return iE(this,_r,e),this}scan(){const e=Wt(this,_r).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Wt(this,_r).getCorners(),{wtTable:s}=Wt(this,zn),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let f=-l;f<0;f++){if(f<n||f>i)continue;const g=f+l;let w=s.getColumnHeader(h,g);const C=Wt(this,zn).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:Wt(this,_r).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});C!==null&&(C!==h&&(w=s.getColumnHeader(C,g)),e(w))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Wt(this,_r).getCorners(),{wtTable:s}=Wt(this,zn),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let f=-l;f<0;f++){if(f<r||f>o)continue;const g=f+l;let w=s.getRowHeader(h,g);const C=Wt(this,zn).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:Wt(this,_r).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});C!==null&&(C!==h&&(w=s.getRowHeader(C,g)),e(w))}u+=1}}}scanCellsRange(e){const[n,r,i,o]=Wt(this,_r).getCorners(),{wtTable:s}=Wt(this,zn);em(this,Uc,tm).call(this,(a,l)=>{if(a>=n&&a<=i&&l>=r&&l<=o){const u=s.getCell(Wt(this,zn).createCellCoords(a,l)),c=Wt(this,zn).getSetting("onAfterDrawSelection",a,l,Wt(this,_r).settings.layerLevel);typeof c=="string"&&ee(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,r]=Wt(this,_r).getCorners(),{wtTable:i}=Wt(this,zn);em(this,Uc,tm).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Wt(this,zn).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Wt(this,_r).getCorners(),{wtTable:i}=Wt(this,zn);em(this,Uc,tm).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Wt(this,zn).createCellCoords(o,s));e(a)}})}}function tm(t){const{wtTable:e}=Wt(this,zn),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class kK{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=xv,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),br(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Yi()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Be(i,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Be(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:f}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),w=parseInt(u.width,10),C=parseInt(c.width,10),S=this.wot.wtTable.getWidth(),b=this.wot.wtTable.getHeight();u.top=`${parseInt(r-w-1,10)}px`,u[l]=`${parseInt(i-w-1,10)}px`,c.top=`${parseInt(r-C/4*3,10)}px`,c[l]=`${parseInt(i-C/4*3,10)}px`;const _=Math.min(parseInt(i+o,10),S-w-g*2),O=Math.min(parseInt(i+o-C/4,10),S-C-g*2);h[l]=`${_}px`,f[l]=`${O}px`;const x=Math.min(parseInt(r+s,10),b-w-g*2),I=Math.min(parseInt(r+s-C/4,10),b-C-g*2);h.top=`${x}px`,f.top=`${I}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",f.display="none"):(h.display="block",f.display="block")):(u.display="none",h.display="none",c.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:r,rootWindow:i}=this.wot;let o,s,a,l,u,c;const h=n.getRenderedRowsCount();for(let R=0;R<h;R+=1){const d=n.rowFilter.renderedToSource(R);if(d>=e[0]&&d<=e[2]){o=d,u=e[0];break}}for(let R=h-1;R>=0;R-=1){const d=n.rowFilter.renderedToSource(R);if(d>=e[0]&&d<=e[2]){s=d;break}}const f=n.getRenderedColumnsCount();for(let R=0;R<f;R+=1){const d=n.columnFilter.renderedToSource(R);if(d>=e[1]&&d<=e[3]){a=d,c=e[1];break}}for(let R=f-1;R>=0;R-=1){const d=n.columnFilter.renderedToSource(R);if(d>=e[1]&&d<=e[3]){l=d;break}}if(o===void 0||a===void 0){this.disappear();return}let g=n.getCell(this.wot.createCellCoords(o,a));const w=o!==s||a!==l,C=w?n.getCell(this.wot.createCellCoords(s,l)):g,S=Bt(g),b=w?Bt(C):S,_=Bt(n.TABLE),O=ut(n.TABLE),x=S.top,I=S.left,$=this.wot.wtSettings.getSetting("rtlMode");let z=0,q=0;if($){const R=ut(g),d=i.innerWidth-_.left-O;q=I+R-b.left,z=i.innerWidth-I-R-d-1}else q=b.left+ut(C)-I,z=I-_.left-1;if(this.isEntireColumnSelected(o,s)){const R=this.getDimensionsFromHeader("columns",a,l,u,_);let d=null;R&&([d,z,q]=R),d&&(g=d)}let Y=x-_.top-1,K=b.top+Ot(C)-x;if(this.isEntireRowSelected(a,l)){const R=this.getDimensionsFromHeader("rows",o,s,c,_);let d=null;R&&([d,Y,K]=R),d&&(g=d)}const te=eo(g,i);parseInt(te.borderTopWidth,10)>0&&(Y+=1,K=K>0?K-1:0),parseInt(te[$?"borderRightWidth":"borderLeftWidth"],10)>0&&(z+=1,q=q>0?q-1:0);const oe=$?"right":"left";this.topStyle.top=`${Y}px`,this.topStyle[oe]=`${z}px`,this.topStyle.width=`${q}px`,this.topStyle.display="block",this.startStyle.top=`${Y}px`,this.startStyle[oe]=`${z}px`,this.startStyle.height=`${K}px`,this.startStyle.display="block";const ie=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${Y+K-ie}px`,this.bottomStyle[oe]=`${z}px`,this.bottomStyle.width=`${q}px`,this.bottomStyle.display="block",this.endStyle.top=`${Y}px`,this.endStyle[oe]=`${z+q-ie}px`,this.endStyle.height=`${K+1}px`,this.endStyle.display="block";let ue=this.settings.border.cornerVisible;ue=typeof ue=="function"?ue(this.settings.layerLevel):ue;const be=this.wot.getSetting("onModifyGetCellCoords",s,l);let[Ue,Ie]=[s,l];if(be&&Array.isArray(be)&&([,,Ue,Ie]=be),Yi()||!ue||this.isPartRange(Ue,Ie))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Y+K+this.cornerCenterPointOffset-1}px`,this.cornerStyle[oe]=`${z+q+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let R=Vs(n.TABLE);const d=R===i;d&&(R=r.documentElement);const m=parseInt(this.cornerDefaultStyle.width,10)/2,p=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const E=d?C.getBoundingClientRect().left:C.offsetLeft;let M=!1,P=0;$?(P=E-parseInt(this.cornerDefaultStyle.width,10)/2,M=P<0):(P=E+ut(C)+parseInt(this.cornerDefaultStyle.width,10)/2,M=P>=Su(R)),M&&(this.cornerStyle[oe]=`${Math.floor(z+q+this.cornerCenterPointOffset-m)}px`,this.cornerStyle[$?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(d?C.getBoundingClientRect().top:C.offsetTop)+Ot(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=Gi(R)&&(this.cornerStyle.top=`${Math.floor(Y+K+this.cornerCenterPointOffset-p)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Yi()&&this.updateMultipleSelectionHandlesPosition(s,l,Y,z,q,K)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,f=null,g=null,w=null,C=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return Ot(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return ut(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const S=this.wot.getSetting("columnHeaders").length;if(w=l(n,S-i),C=l(r,S-i),!w||!C)return!1;const b=Bt(w),_=Bt(C);return w&&C&&(h=b[g]-o[g]-1,f=_[g]+u(C)-b[g]),[w,h,f]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?ee(this[e],"hidden"):(Pe(this[e],"hidden")&&De(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?ee(this[e],"hidden"):De(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Yi()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const oE=kK;function $K(t,e){Ex(t,e),e.add(t)}function da(t,e,n){Ex(t,e),e.set(t,n)}function Ex(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FK(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function We(t,e){var n=Tx(t,e,"get");return WK(t,n)}function WK(t,e){return e.get?e.get.call(t):e.value}function sE(t,e,n){var r=Tx(t,e,"set");return VK(t,r,n),n}function Tx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function VK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var mn=new WeakMap,wn=new WeakMap,nm=new WeakMap,cu=new WeakMap,rm=new WeakMap,ns=new WeakMap,aE=new WeakSet;class BK{constructor(e){$K(this,aE),da(this,mn,{writable:!0,value:void 0}),da(this,wn,{writable:!0,value:void 0}),da(this,nm,{writable:!0,value:new LK}),da(this,cu,{writable:!0,value:new WeakMap}),da(this,rm,{writable:!0,value:new WeakSet}),da(this,ns,{writable:!0,value:new Map}),sE(this,wn,e)}setActiveOverlay(e){return sE(this,mn,e),We(this,nm).setActiveOverlay(We(this,mn)),We(this,cu).has(We(this,mn))||We(this,cu).set(We(this,mn),new Set),this}getFocusSelection(){return We(this,wn)!==null?We(this,wn).getFocus():null}getAreaSelection(){return We(this,wn)!==null?We(this,wn).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(We(this,ns).has(e)){const r=We(this,ns).get(e);if(r.has(We(this,mn)))return r.get(We(this,mn));const i=new oE(We(this,mn),e.settings);return r.set(We(this,mn),i),i}const n=new oE(We(this,mn),e.settings);return We(this,ns).set(e,new Map([[We(this,mn),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=We(this,ns).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){We(this,ns).get(e).forEach(n=>n.destroy()),We(this,ns).delete(e)}render(e){if(We(this,wn)===null)return;e&&FK(this,aE,UK).call(this);const n=Array.from(We(this,wn)),r=new Map;for(let i=0;i<n.length;i++){const o=n[i],{className:s,createLayers:a,selectionType:l}=o.settings;We(this,rm).has(o)||(We(this,rm).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const u=this.getBorderInstance(o);if(o.isEmpty()){u==null||u.disappear();continue}s&&We(this,nm).setActiveSelection(o).scan().forEach(f=>{if(r.has(f)){const g=r.get(f);g.has(s)&&a===!0?g.set(s,g.get(s)+1):g.set(s,1)}else r.set(f,new Map([[s,1]]))});const c=o.getCorners();We(this,mn).getSetting("onBeforeDrawBorders",c,l),u==null||u.appear(c)}r.forEach((i,o)=>{var s,a;const l=Array.from(i).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(f,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>We(this,cu).get(We(this,mn)).add(u)),ee(o,l),o.nodeName==="TD"&&Array.isArray((s=We(this,wn).options)===null||s===void 0?void 0:s.cellAttributes)?ve(o,We(this,wn).options.cellAttributes):o.nodeName==="TH"&&Array.isArray((a=We(this,wn).options)===null||a===void 0?void 0:a.headerAttributes)&&ve(o,We(this,wn).options.headerAttributes)})}}function UK(){const t=We(this,cu).get(We(this,mn)),e=We(this,mn).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=We(this,mn).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=We(this,wn).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=We(this,wn).options.cellAttributes.map(a=>a[0])),Array.isArray((i=We(this,wn).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...We(this,wn).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)De(o[a],n),Ko(o[a],s)}),t.clear()}class zK extends dc{constructor(e,n,r,i){super(e,n,Gs,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new TK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Of(r,`${o}px`,"0px")):(o=this.getScrollPosition(),ac(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,ev(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=Jt(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=ut(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(xv.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;if(n){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(n=!1)}return n&&o.offsetWidth!==o.clientWidth&&(s=Jt(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(Od(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?De(n,"emptyRows"):ee(n,"emptyRows");let s=!1;if(i&&!r.length)ee(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const a=Pe(n,"innerBorderInlineStart");e?(ee(n,"innerBorderLeft innerBorderInlineStart"),s=!a):(De(n,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}}const GK="stickyRowsTop",_x={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};vi(_x,"MIXIN_NAME",GK,{writable:!1,enumerable:!1});const Mx=_x;class Hv extends pl{constructor(e,n,r,i){super(e,n,r,i,Ys)}}dt(Hv,Mx);dt(Hv,Rv);const YK=Hv;function lE(t,e,n){return e=jK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jK(t){var e=KK(t,"string");return typeof e=="symbol"?e:String(e)}function KK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XK extends dc{constructor(e,n,r,i,o,s){super(e,n,Ys,r,i),lE(this,"topOverlay",void 0),lE(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new YK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Of(e,`${i}px`,`${o}px`)}else ac(e);let n=Ot(this.clone.wtTable.TABLE);const r=ut(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class Dv extends pl{constructor(e,n,r,i){super(e,n,r,i,zs)}}dt(Dv,Mx);dt(Dv,_v);const qK=Dv;function ZK(t,e,n){return e=QK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QK(t){var e=JK(t,"string");return typeof e=="symbol"?e:String(e)}function JK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e3 extends dc{constructor(e,n,r,i){super(e,n,zs,r,i),ZK(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new qK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Of(e,"0px",`${i}px`)}else i=this.getScrollPosition(),ac(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(Af(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=Jt(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Ot(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(xv.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(n){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(l=Jt(this.domBindings.rootDocument)),n){const u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Fu(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?De(r,"emptyColumns"):ee(r,"emptyColumns");let o=!1;if(!n){const s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,l=this.wtSettings.getSetting("columnHeaders");if((a||s===0)&&l.length>0){const u=Pe(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(ee(r,"innerBorderTop"),o=!u):(De(r,"innerBorderTop"),o=u)}}return o}}function Ti(t,e,n){return e=t3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t3(t){var e=n3(t,"string");return typeof e=="symbol"?e:String(e)}function n3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class r3{constructor(e,n,r,i,o,s){Ti(this,"wot",null),Ti(this,"topOverlay",null),Ti(this,"bottomOverlay",null),Ti(this,"inlineStartOverlay",null),Ti(this,"topInlineStartCornerOverlay",null),Ti(this,"bottomInlineStartCornerOverlay",null),Ti(this,"browserLineHeight",void 0),Ti(this,"wtSettings",null),Ti(this,"resizeObserver",new ResizeObserver(c=>{Lf(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Jt(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Wu(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new e3(...e),this.bottomOverlay=new RK(...e),this.inlineStartOverlay=new zK(...e),this.topInlineStartCornerOverlay=new XK(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new wK(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!av())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:f}=h.clone.wtTable;this.eventManager.addEventListener(f,"wheel",g=>this.onCloneWheel(g,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=ml(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Wu(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:n}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),a=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,o)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:h,scrollWidth:f}=r.holder;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<f,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return T(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];T(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}const i3=r3;function uE(t,e,n){return e=o3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o3(t){var e=s3(t,"string");return typeof e=="symbol"?e:String(e)}function s3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class a3{constructor(e){uE(this,"settings",{}),uE(this,"defaults",Object.freeze(this.getDefaults())),Be(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Bo(r,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Be(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Nv extends pl{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Vs(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=il(e,"height",n),o=il(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?r.insertBefore(f,e.nextElementSibling):r.appendChild(f);const g=parseInt(eo(f,n).height,10);r.removeChild(f),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Uo(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}dt(Nv,Cx);dt(Nv,_v);const l3=Nv;class u3{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=Ot(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-o:u.left,h=o-c;let f,g;if(a)return ut(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?f=Math.min(h,o):f=Math.min(this.getContainerFillWidth(),h,o),i===r&&s>0&&this.sumColumnWidths(0,s-1)>f)return n.documentElement.clientWidth;if(i!==r&&(g=il(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(f,i.clientWidth);const w=e.getSetting("stretchH");return w==="none"||!w?Math.max(f,ut(this.wtTable.TABLE)):f}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return Bt(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Ot(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=ut(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Hs;const{wtSettings:n,wtTable:r}=this;let i,o,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&e===Hs?i=1/0:i=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=Jt(this.domBindings.rootDocument),new ox({viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Hs;const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=Jt(this.domBindings.rootDocument)),new Cv({viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:n.getSetting("stretchH"),stretchingColumnWidthFn:(a,l)=>n.getSetting("onBeforeStretchingColumnWidth",a,l),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(n){const r=this.createRowsCalculator(Cn),i=this.createColumnsCalculator(Cn);this.areAllProposedVisibleRowsAlreadyRendered(r)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Hs),this.columnsRenderCalculator=this.createColumnsCalculator(Hs)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(Cn),this.columnsVisibleCalculator=this.createColumnsCalculator(Cn)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:n,endRow:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startRow:o,endRow:s}=this.rowsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:n,endColumn:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Be(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}const c3=u3;class h3 extends Tv{constructor(e,n){super(e,new a3(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new l3(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new c3(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new BK(this.wtSettings.getSetting("selections")),this.wtEvent=new cx(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new i3(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Be(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),De(this.wtTable.wtRootElement.parentNode,n),ee(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Lv{constructor(e){e instanceof Tv?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new Lv(n);return()=>r},this._wot=new h3(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,i,o){return this._wot.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function cE(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),f=n||r&&h;i.row<0&&i.col>=0&&!s.column?f&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?f&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?f&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function d3(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n)}const f3=new Map([["mousedown",cE],["mouseover",d3],["touchstart",cE]]);function hE(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;f3.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:Hf(t)||t.type==="touchstart",isRightClick:zo(t)})}const Ax=new WeakMap,kv=Symbol("rootInstance");function g3(t){Ax.set(t,!0)}function m3(t){return t===kv}function ed(t){return Ax.has(t)}function rs(t,e,n){p3(t,e),e.set(t,n)}function p3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function go(t,e,n){return e=w3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w3(t){var e=C3(t,"string");return typeof e=="symbol"?e:String(e)}function C3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function un(t,e){var n=Ox(t,e,"get");return v3(t,n)}function v3(t,e){return e.get?e.get.call(t):e.value}function cr(t,e,n){var r=Ox(t,e,"set");return S3(t,r,n),n}function Ox(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function S3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var im=new WeakMap,om=new WeakMap,zc=new WeakMap,_i=new WeakMap,Mr=new WeakMap,sm=new WeakMap,am=new WeakMap;class y3{constructor(e){go(this,"hot",void 0),go(this,"eventManager",void 0),go(this,"settings",void 0),go(this,"THEAD",void 0),go(this,"TBODY",void 0),go(this,"_wt",void 0),go(this,"activeWt",void 0),rs(this,im,{writable:!0,value:0}),rs(this,om,{writable:!0,value:0}),go(this,"postponedAdjustElementsSize",!1),rs(this,zc,{writable:!0,value:!1}),rs(this,_i,{writable:!0,value:void 0}),rs(this,Mr,{writable:!0,value:void 0}),rs(this,sm,{writable:!0,value:0}),rs(this,am,{writable:!0,value:0}),this.hot=e,this.eventManager=new sr(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,i,o){return this._wt.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),ee(e,"handsontable"),cr(this,Mr,n.createElement("TABLE")),ee(un(this,Mr),"htCore"),this.hot.getSettings().tableClassName&&ee(un(this,Mr),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(ve(un(this,Mr),[$r()]),ve(e,[az(),lI(this.hot.countRows()),uI(this.hot.countCols()),Sz()])),this.THEAD=n.createElement("THEAD"),un(this,Mr).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),un(this,Mr).appendChild(this.TBODY),this.hot.table=un(this,Mr),this.hot.container.insertBefore(un(this,Mr),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r}=this.hot,i=n.documentElement;this.eventManager.addEventListener(e,"mousedown",o=>{if(cr(this,zc,!0),!this.isTextSelectionAllowed(o.target)){const{rootWindow:s}=this.hot;Sw(s),o.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{cr(this,zc,!1)}),this.eventManager.addEventListener(e,"mousemove",o=>{un(this,zc)&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&Sw(this.hot.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(i,"keyup",o=>{r.isInProgress()&&!o.shiftKey&&r.finish()}),this.eventManager.addEventListener(i,"mouseup",o=>{r.isInProgress()&&Hf(o)&&r.finish(),cr(this,_i,!1);const s=Pf(n.activeElement);s&&(s||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(o.target)&&!zo(o))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",o=>{r.isInProgress()&&zo(o)&&(r.finish(),cr(this,_i,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{r.isInProgress()&&r.finish(),cr(this,_i,!1)}),this.eventManager.addEventListener(i,"mousedown",o=>{const s=o.target,a=o.x||o.clientX,l=o.y||o.clientY;let u=o.target;if(un(this,_i)||!e||!this.hot.view)return;const{holder:c}=this.hot.view._wt.wtTable;if(u===c){const f=Jt(n);if(n.elementFromPoint(a+f,l)!==c||n.elementFromPoint(a,l+f)!==c)return}else for(;u!==i;){if(u===null){if(o.isTargetWebComponent)break;return}if(u===e)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(un(this,Mr),"selectstart",o=>{this.settings.fragmentSelection||Pd(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:un(this,Mr),isDataViewInstance:()=>ed(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),cr(this,om,o.length),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),cr(this,im,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let h=l,f=u;Array.isArray(c)&&([h,f]=c);const g=this.hot.getCellMeta(h,f),w=this.hot.colToProp(f);let C=this.hot.getDataAtRowProp(h,w);this.hot.hasHook("beforeValueRender")&&(C=this.hot.runHooks("beforeValueRender",C,g)),this.hot.runHooks("beforeRenderer",a,l,u,w,C,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,w,C,g),this.hot.runHooks("afterRenderer",a,l,u,w,C,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Uo(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,cr(this,_i,!0),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Ao(o)&&(hE(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,cr(this,_i,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Ao(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Ao(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Ao(o)&&(un(this,_i)&&hE(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Ao(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,h=o>=0?l.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",h,c,a);if(Array.isArray(f)){const[g,w,C,S]=f;return[g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g,w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,1)):w,C>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(C,-1)):C,S>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(S,-1)):S]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.ceil(u/a*12);o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.ceil(u/a*6);o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Lv(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(Pd(e))return!0;const n=No(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return un(this,_i)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!Pe(r,"relative")){zr(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){const o=n.firstChild;Pe(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,i):(zr(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span");s.className="relative",a.className="colHeader",this.updateCellHeader(a,e,r,i),s.appendChild(a),n.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Pe(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):Pe(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Qs(e,r(n,i)):(Bo(e,String.fromCharCode(160)),ee(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){cr(this,sm,e),cr(this,am,n)}getLastSize(){return{width:un(this,sm),height:un(this,am)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return un(this,im)}getRowHeadersCount(){return un(this,om)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}const b3=y3,Px="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Dw=Px.length;function kf(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%Dw,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/Dw,10);return n}function R3(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=Dw**r*(Px.indexOf(t[n])+1);return e-=1,e}function E3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(kf(i)+(r+1));n.push(o)}return n}function T3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=kf(i)+(r+1);n.push(o)}return n}function _3(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function $v(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function Fv(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&$e(t[0])&&(e=xf(t[0]))),e}function Ix(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function xx(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const M3=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:Fv,createEmptySpreadsheetData:_3,createSpreadsheetData:E3,createSpreadsheetObjectData:T3,dataRowToChangesArray:$v,isArrayOfArrays:Ix,isArrayOfObjects:xx,spreadsheetColumnIndex:R3,spreadsheetColumnLabel:kf},Symbol.toStringTag,{value:"Module"}));function Il(t,e,n){return e=A3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A3(t){var e=O3(t,"string");return typeof e=="symbol"?e:String(e)}function O3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P3{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Il(this,"hot",void 0),Il(this,"data",void 0),Il(this,"dataType","array"),Il(this,"colToProp",()=>{}),Il(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return T(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0;let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,s)}):pe(n,r,l=>{a[l-n]=this.getAtPhysicalCell(e,l,s)});else if($e(s)||gt(s))if(i?a=[]:a={},!o||i){const u=this.countFirstRowKeys()-1;pe(0,u,c=>{const h=this.colToProp(c);if(c>=(n||0)&&c<=(r||u)&&!Number.isInteger(h)){const f=this.getAtPhysicalCell(e,h,s);i?a.push(f):qh(a,h,f)}})}else Be(s,(l,u)=>{qh(a,u,this.getAtPhysicalCell(e,u,s))});return a}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Us(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:qh(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r&&(typeof n=="string"?i=OI(r,n):typeof n=="function"?i=n(r):i=r[n]),this.hot.hasHook("modifySourceData")){const o=Us(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return pe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return Fv(this.data)}destroy(){this.data=null,this.hot=null}}const I3=P3;function dE(t,e,n){return e=x3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x3(t){var e=H3(t,"string");return typeof e=="symbol"?e:String(e)}function H3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Js{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;dE(this,"indexedValues",[]),dE(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,gt(this.initValueOrFn)?pe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):pe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}dt(Js,Qn);function Wv(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>gt(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function Vv(t,e){return or(t,(n,r)=>e.includes(r)===!1)}class Xo extends Js{insert(e,n){this.indexedValues=Wv(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=Vv(this.indexedValues,e),super.remove(e)}}class $f extends Xo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Ft(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function Bv(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Uu(t,e){return or(t,n=>e.includes(n)===!1)}function Uv(t,e){return Ve(t,n=>n-e.filter(r=>r<n).length)}function zv(t,e){const n=e[0],r=e.length;return Ve(t,i=>i>=n?i+r:i)}function D3(t,e,n){return e=N3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N3(t){var e=L3(t,"string");return typeof e=="symbol"?e:String(e)}function L3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ff extends Js{constructor(){super(...arguments),D3(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Uu(this.orderOfIndexes,[e]),gt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=Wv(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=zv(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=Vv(this.indexedValues,e),this.orderOfIndexes=Uu(this.orderOfIndexes,e),this.orderOfIndexes=Uv(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class fc extends Xo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Ft(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const fE=new Map([["indexesSequence",{getListWithInsertedItems:Bv,getListWithRemovedItems:Uu}],["physicallyIndexed",{getListWithInsertedItems:Wv,getListWithRemovedItems:Vv}]]),Hx=t=>{if(fE.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return fE.get(t)};class Dx extends Js{constructor(){super(e=>e)}insert(e,n){const r=zv(this.indexedValues,n);this.indexedValues=Bv(r,e,n),super.insert(e,n)}remove(e){const n=Uu(this.indexedValues,e);this.indexedValues=Uv(n,e),super.remove(e)}}const gE=new Map([["hiding",$f],["index",Js],["linkedPhysicalIndexToValue",Ff],["physicalIndexToValue",Xo],["trimming",fc]]);function k3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!gE.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(gE.get(t))(e)}function $3(t,e,n){return e=F3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F3(t){var e=W3(t,"string");return typeof e=="symbol"?e:String(e)}function W3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Nw=0;class Gv{constructor(){$3(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),Nw+=1)}unregister(e){const n=this.collection.get(e);le(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),Nw-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return mt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}dt(Gv,Qn);function V3(){return Nw}function lm(t,e,n){return e=B3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B3(t){var e=U3(t,"string");return typeof e=="symbol"?e:String(e)}function U3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mE extends Gv{constructor(e,n){super(),lm(this,"mergedValuesCache",[]),lm(this,"aggregationFunction",void 0),lm(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ve(this.get(),o=>o.getValues()),r=[],i=le(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ve(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return le(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function z3(t,e,n){G3(t,e),e.set(t,n)}function G3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Y3(t,e,n){var r=Nx(t,e,"set");return j3(t,r,n),n}function j3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function K3(t,e){var n=Nx(t,e,"get");return X3(t,n)}function Nx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function X3(t,e){return e.get?e.get.call(t):e.value}var um=new WeakMap;class Lx{constructor(){z3(this,um,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(K3(this,um)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Y3(this,um,e)}}dt(Lx,Qn);function pE(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function xl(t,e,n){q3(t,e),e.set(t,n)}function q3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hr(t,e){var n=kx(t,e,"get");return Z3(t,n)}function Z3(t,e){return e.get?e.get.call(t):e.value}function Gc(t,e,n){var r=kx(t,e,"set");return Q3(t,r,n),n}function kx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Q3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Yc=new WeakMap,Hl=new WeakMap,jc=new WeakMap,Kc=new WeakMap,Xc=new WeakMap;class J3{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};xl(this,Yc,{writable:!0,value:new Set}),xl(this,Hl,{writable:!0,value:[]}),xl(this,jc,{writable:!0,value:[]}),xl(this,Kc,{writable:!0,value:!1}),xl(this,Xc,{writable:!0,value:!1}),Gc(this,Xc,e??!1)}createObserver(){const e=new Lx;return hr(this,Yc).add(e),e.addLocalHook("unsubscribe",()=>{hr(this,Yc).delete(e)}),e._writeInitialChanges(pE(hr(this,Hl),hr(this,jc))),e}emit(e){let n=hr(this,jc);(!hr(this,Kc)||hr(this,Hl).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(hr(this,Xc)):Gc(this,Hl,new Array(e.length).fill(hr(this,Xc))),hr(this,Kc)||(Gc(this,Kc,!0),n=hr(this,Hl)));const r=pE(n,e);hr(this,Yc).forEach(i=>i._write(r)),Gc(this,jc,e)}}function An(t,e,n){return e=eX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eX(t){var e=tX(t,"string");return typeof e=="symbol"?e:String(e)}function tX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lw{constructor(){An(this,"indexesSequence",new Dx),An(this,"trimmingMapsCollection",new mE(e=>e.some(n=>n===!0),!1)),An(this,"hidingMapsCollection",new mE(e=>e.some(n=>n===!0),!1)),An(this,"variousMapsCollection",new Gv),An(this,"hidingChangesObservable",new J3({initialIndexValue:!1})),An(this,"notTrimmedIndexesCache",[]),An(this,"notHiddenIndexesCache",[]),An(this,"isBatched",!1),An(this,"indexesSequenceChanged",!1),An(this,"indexesChangeSource",void 0),An(this,"trimmedIndexesChanged",!1),An(this,"hiddenIndexesChanged",!1),An(this,"renderablePhysicalIndexesCache",[]),An(this,"fromPhysicalToVisualIndexesCache",new Map),An(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,k3(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof fc?this.trimmingMapsCollection.register(e,n):n instanceof $f?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return le(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return le(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return le(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return le(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ve(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Uu(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(Bv(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=le(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ve(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}dt(Lw,Qn);function nX(t,e){return Be(e,(n,r)=>{mt(t[r])&&(t[r]=n)}),t}function $x(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function Fx(t){le(t)&&dv(ct`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function rX(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:iX,getValues:oX}=Yr("phraseFormatters");function sX(t,e){iX(t,e)}function aX(){return oX()}sX("pluralize",rX);const Wx="ContextMenu:items",Le=Wx,Yv=`${Le}.noItems`,jv=`${Le}.insertRowAbove`,Kv=`${Le}.insertRowBelow`,Xv=`${Le}.insertColumnOnTheLeft`,qv=`${Le}.insertColumnOnTheRight`,Zv=`${Le}.removeRow`,Qv=`${Le}.removeColumn`,Jv=`${Le}.undo`,eS=`${Le}.redo`,tS=`${Le}.readOnly`,nS=`${Le}.clearColumn`,rS=`${Le}.copy`,iS=`${Le}.copyWithHeaders`,oS=`${Le}.copyWithGroupHeaders`,sS=`${Le}.copyHeadersOnly`,aS=`${Le}.cut`,lS=`${Le}.freezeColumn`,uS=`${Le}.unfreezeColumn`,cS=`${Le}.mergeCells`,hS=`${Le}.unmergeCells`,dS=`${Le}.addComment`,fS=`${Le}.editComment`,gS=`${Le}.removeComment`,mS=`${Le}.readOnlyComment`,pS=`${Le}.align`,wS=`${Le}.align.left`,CS=`${Le}.align.center`,vS=`${Le}.align.right`,SS=`${Le}.align.justify`,yS=`${Le}.align.top`,bS=`${Le}.align.middle`,RS=`${Le}.align.bottom`,ES=`${Le}.borders`,TS=`${Le}.borders.top`,_S=`${Le}.borders.right`,MS=`${Le}.borders.bottom`,AS=`${Le}.borders.left`,OS=`${Le}.borders.remove`,PS=`${Le}.nestedHeaders.insertChildRow`,IS=`${Le}.nestedHeaders.detachFromParent`,xS=`${Le}.hideColumn`,HS=`${Le}.showColumn`,DS=`${Le}.hideRow`,NS=`${Le}.showRow`,Wn="Filters:",Lt=`${Wn}conditions`,Wf=`${Lt}.none`,LS=`${Lt}.isEmpty`,kS=`${Lt}.isNotEmpty`,$S=`${Lt}.isEqualTo`,FS=`${Lt}.isNotEqualTo`,WS=`${Lt}.beginsWith`,VS=`${Lt}.endsWith`,BS=`${Lt}.contains`,US=`${Lt}.doesNotContain`,lX=`${Lt}.byValue`,zS=`${Lt}.greaterThan`,GS=`${Lt}.greaterThanOrEqualTo`,YS=`${Lt}.lessThan`,jS=`${Lt}.lessThanOrEqualTo`,KS=`${Lt}.isBetween`,XS=`${Lt}.isNotBetween`,qS=`${Lt}.after`,ZS=`${Lt}.before`,QS=`${Lt}.today`,JS=`${Lt}.tomorrow`,ey=`${Lt}.yesterday`,ty=`${Wn}labels.filterByCondition`,ny=`${Wn}labels.filterByValue`,ry=`${Wn}labels.conjunction`,Vf=`${Wn}labels.disjunction`,Fd=`${Wn}values.blankCells`,iy=`${Wn}buttons.selectAll`,oy=`${Wn}buttons.clear`,sy=`${Wn}buttons.ok`,ay=`${Wn}buttons.cancel`,ly=`${Wn}buttons.placeholder.search`,uy=`${Wn}buttons.placeholder.value`,cy=`${Wn}buttons.placeholder.secondValue`,hy="CheckboxRenderer:",dy=`${hy}checked`,fy=`${hy}unchecked`,qo="ColumnHeader:",gy=`${qo}description.expandColumn`,my=`${qo}description.collapseColumn`,py=`${qo}description.sortRows`,wy=`${qo}label.multiColumnSortOrder`,Cy=`${qo}label.openMenu`,vy=`${qo}label.beforeHiddenColumn`,Sy=`${qo}label.afterHiddenColumn`,gc="RowHeader:",yy=`${gc}description.expandRow`,by=`${gc}description.collapseRow`,Ry=`${gc}label.beforeHiddenRow`,Ey=`${gc}label.afterHiddenRow`,uX=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:dy,CHECKBOX_RENDERER_NAMESPACE:hy,CHECKBOX_UNCHECKED:fy,COLUMN_HEADER_DESCRIPTION_COLLAPSE_COLUMN:my,COLUMN_HEADER_DESCRIPTION_EXPAND_COLUMN:gy,COLUMN_HEADER_DESCRIPTION_SORT_ROWS:py,COLUMN_HEADER_LABEL_AFTER_HIDDEN_COLUMN:Sy,COLUMN_HEADER_LABEL_BEFORE_HIDDEN_COLUMN:vy,COLUMN_HEADER_LABEL_MULTI_COLUMN_SORT_ORDER:wy,COLUMN_HEADER_LABEL_OPEN_MENU:Cy,COLUMN_HEADER_NAMESPACE:qo,CONTEXTMENU_ITEMS_ADD_COMMENT:dS,CONTEXTMENU_ITEMS_ALIGNMENT:pS,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:RS,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:CS,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:SS,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:wS,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:bS,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:vS,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:yS,CONTEXTMENU_ITEMS_BORDERS:ES,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:MS,CONTEXTMENU_ITEMS_BORDERS_LEFT:AS,CONTEXTMENU_ITEMS_BORDERS_RIGHT:_S,CONTEXTMENU_ITEMS_BORDERS_TOP:TS,CONTEXTMENU_ITEMS_CLEAR_COLUMN:nS,CONTEXTMENU_ITEMS_COPY:rS,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:sS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:oS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:iS,CONTEXTMENU_ITEMS_CUT:aS,CONTEXTMENU_ITEMS_EDIT_COMMENT:fS,CONTEXTMENU_ITEMS_FREEZE_COLUMN:lS,CONTEXTMENU_ITEMS_HIDE_COLUMN:xS,CONTEXTMENU_ITEMS_HIDE_ROW:DS,CONTEXTMENU_ITEMS_INSERT_LEFT:Xv,CONTEXTMENU_ITEMS_INSERT_RIGHT:qv,CONTEXTMENU_ITEMS_MERGE_CELLS:cS,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:IS,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:PS,CONTEXTMENU_ITEMS_NO_ITEMS:Yv,CONTEXTMENU_ITEMS_READ_ONLY:tS,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:mS,CONTEXTMENU_ITEMS_REDO:eS,CONTEXTMENU_ITEMS_REMOVE_BORDERS:OS,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Qv,CONTEXTMENU_ITEMS_REMOVE_COMMENT:gS,CONTEXTMENU_ITEMS_REMOVE_ROW:Zv,CONTEXTMENU_ITEMS_ROW_ABOVE:jv,CONTEXTMENU_ITEMS_ROW_BELOW:Kv,CONTEXTMENU_ITEMS_SHOW_COLUMN:HS,CONTEXTMENU_ITEMS_SHOW_ROW:NS,CONTEXTMENU_ITEMS_UNDO:Jv,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:uS,CONTEXTMENU_ITEMS_UNMERGE_CELLS:hS,CONTEXT_MENU_ITEMS_NAMESPACE:Wx,FILTERS_BUTTONS_CANCEL:ay,FILTERS_BUTTONS_CLEAR:oy,FILTERS_BUTTONS_OK:sy,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:ly,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:cy,FILTERS_BUTTONS_PLACEHOLDER_VALUE:uy,FILTERS_BUTTONS_SELECT_ALL:iy,FILTERS_CONDITIONS_AFTER:qS,FILTERS_CONDITIONS_BEFORE:ZS,FILTERS_CONDITIONS_BEGINS_WITH:WS,FILTERS_CONDITIONS_BETWEEN:KS,FILTERS_CONDITIONS_BY_VALUE:lX,FILTERS_CONDITIONS_CONTAINS:BS,FILTERS_CONDITIONS_EMPTY:LS,FILTERS_CONDITIONS_ENDS_WITH:VS,FILTERS_CONDITIONS_EQUAL:$S,FILTERS_CONDITIONS_GREATER_THAN:zS,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:GS,FILTERS_CONDITIONS_LESS_THAN:YS,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:jS,FILTERS_CONDITIONS_NAMESPACE:Lt,FILTERS_CONDITIONS_NONE:Wf,FILTERS_CONDITIONS_NOT_BETWEEN:XS,FILTERS_CONDITIONS_NOT_CONTAIN:US,FILTERS_CONDITIONS_NOT_EMPTY:kS,FILTERS_CONDITIONS_NOT_EQUAL:FS,FILTERS_CONDITIONS_TODAY:QS,FILTERS_CONDITIONS_TOMORROW:JS,FILTERS_CONDITIONS_YESTERDAY:ey,FILTERS_DIVS_FILTER_BY_CONDITION:ty,FILTERS_DIVS_FILTER_BY_VALUE:ny,FILTERS_LABELS_CONJUNCTION:ry,FILTERS_LABELS_DISJUNCTION:Vf,FILTERS_NAMESPACE:Wn,FILTERS_VALUES_BLANK_CELLS:Fd,ROW_HEADER_DESCRIPTION_COLLAPSE_ROW:by,ROW_HEADER_DESCRIPTION_EXPAND_ROW:yy,ROW_HEADER_LABEL_AFTER_HIDDEN_ROW:Ey,ROW_HEADER_LABEL_BEFORE_HIDDEN_ROW:Ry,ROW_HEADER_NAMESPACE:gc},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const cX={languageCode:"en-US",[Yv]:"No available options",[jv]:"Insert row above",[Kv]:"Insert row below",[Xv]:"Insert column left",[qv]:"Insert column right",[Zv]:["Remove row","Remove rows"],[Qv]:["Remove column","Remove columns"],[Jv]:"Undo",[eS]:"Redo",[tS]:"Read only",[nS]:"Clear column",[pS]:"Alignment",[wS]:"Left",[CS]:"Center",[vS]:"Right",[SS]:"Justify",[yS]:"Top",[bS]:"Middle",[RS]:"Bottom",[lS]:"Freeze column",[uS]:"Unfreeze column",[ES]:"Borders",[TS]:"Top",[_S]:"Right",[MS]:"Bottom",[AS]:"Left",[OS]:"Remove border(s)",[dS]:"Add comment",[fS]:"Edit comment",[gS]:"Delete comment",[mS]:"Read-only comment",[cS]:"Merge cells",[hS]:"Unmerge cells",[rS]:"Copy",[iS]:["Copy with header","Copy with headers"],[oS]:["Copy with group header","Copy with group headers"],[sS]:["Copy header only","Copy headers only"],[aS]:"Cut",[PS]:"Insert child row",[IS]:"Detach from parent",[xS]:["Hide column","Hide columns"],[HS]:["Show column","Show columns"],[DS]:["Hide row","Hide rows"],[NS]:["Show row","Show rows"],[Wf]:"None",[LS]:"Is empty",[kS]:"Is not empty",[$S]:"Is equal to",[FS]:"Is not equal to",[WS]:"Begins with",[VS]:"Ends with",[BS]:"Contains",[US]:"Does not contain",[zS]:"Greater than",[GS]:"Greater than or equal to",[YS]:"Less than",[jS]:"Less than or equal to",[KS]:"Is between",[XS]:"Is not between",[qS]:"After",[ZS]:"Before",[QS]:"Today",[JS]:"Tomorrow",[ey]:"Yesterday",[Fd]:"Blank cells",[ty]:"Filter by condition",[ny]:"Filter by value",[ry]:"And",[Vf]:"Or",[iy]:"Select all",[oy]:"Clear",[sy]:"OK",[ay]:"Cancel",[ly]:"Search",[uy]:"Value",[cy]:"Second value",[dy]:"Checked",[fy]:"Unchecked",[gy]:"Press ENTER to expand column.",[my]:"Press ENTER to collapse column.",[py]:"Press ENTER to change sorting.",[wy]:"Multi-column sorting order:",[Cy]:"Press CTRL/CMD+ENTER to open menu.",[vy]:"The next column is hidden.",[Sy]:"The previous column is hidden.",[yy]:"Press ENTER to expand row.",[by]:"Press ENTER to collapse row.",[Ry]:"The next row is hidden.",[Ey]:"The previous row is hidden."},Vx=cX,hX=uX,kw=Vx.languageCode,{register:dX,getItem:Bx,hasItem:fX,getValues:gX}=Yr("languagesDictionaries");Ux(Vx);function Ux(t,e){let n=t,r=e;return $e(t)&&(r=t,n=r.languageCode),mX(n,r),dX(n,bn(r)),bn(r)}function mX(t,e){t!==kw&&nX(e,Bx(kw))}function zx(t){return Ty(t)?bn(Bx(t)):null}function Ty(t){return fX(t)}function pX(){return gX()}function Gx(t,e,n){const r=zx(t);if(r===null)return null;const i=r[e];if(mt(i))return null;const o=wX(i,n);return Array.isArray(o)?o[0]:o}function wX(t,e){let n=t;return T(aX(),r=>{n=r(t,e)}),n}function CX(t){let e=$x(t);return Ty(e)||(e=kw,Fx(t)),e}function vX(t,e,n){return e=SX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SX(t){var e=yX(t,"string");return typeof e=="symbol"?e:String(e)}function yX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bX extends MK{constructor(e,n){super(e,null),vX(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}const uo=bX;function cm(t){let{activeHeaderClassName:e,...n}=t;return new uo({className:e,...n,selectionType:yx})}function RX(t){let{areaCornerVisible:e,...n}=t;return new uo({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:Pv})}function EX(t){let{...e}=t;return new uo({className:"highlight",...e,selectionType:Pv})}function TX(t){let{columnClassName:e,...n}=t;return new uo({className:e,...n,selectionType:PK})}function _X(t){let{cellCornerVisible:e,...n}=t;return new uo({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Iv})}function MX(t){let{border:e,visualCellRange:n,...r}=t;return new uo({...e,...r,selectionType:IK},n)}function AX(t){let{...e}=t;return new uo({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:AK})}function wE(t){let{headerClassName:e,...n}=t;return new uo({className:e,...n,selectionType:Ov})}function OX(t){let{rowClassName:e,...n}=t;return new uo({className:e,...n,selectionType:OK})}let Yx;function PX(t,e){IX(t,e),e.add(t)}function IX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bn(t,e,n){return e=xX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xX(t){var e=HX(t,"string");return typeof e=="symbol"?e:String(e)}function HX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Qr=new WeakSet;Yx=Symbol.iterator;class DX{constructor(e){PX(this,Qr),Bn(this,"options",void 0),Bn(this,"layerLevel",0),Bn(this,"focus",void 0),Bn(this,"fill",void 0),Bn(this,"layeredAreas",new Map),Bn(this,"areas",new Map),Bn(this,"rowHeaders",new Map),Bn(this,"columnHeaders",new Map),Bn(this,"activeRowHeaders",new Map),Bn(this,"activeColumnHeaders",new Map),Bn(this,"activeCornerHeaders",new Map),Bn(this,"rowHighlights",new Map),Bn(this,"columnHighlights",new Map),Bn(this,"customSelections",[]),this.options=e,this.focus=_X(e),this.fill=AX(e)}isEnabledFor(e,n){let r=e;e===Iv&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Mi(this,Qr,Ai).call(this,this.layeredAreas,RX)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Mi(this,Qr,Ai).call(this,this.areas,EX)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Mi(this,Qr,Ai).call(this,this.rowHeaders,wE)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Mi(this,Qr,Ai).call(this,this.columnHeaders,wE)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Mi(this,Qr,Ai).call(this,this.activeRowHeaders,cm)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Mi(this,Qr,Ai).call(this,this.activeColumnHeaders,cm)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Mi(this,Qr,Ai).call(this,this.activeCornerHeaders,cm)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Mi(this,Qr,Ai).call(this,this.rowHighlights,OX)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Mi(this,Qr,Ai).call(this,this.columnHighlights,TX)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(MX({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),T(this.areas.values(),e=>void e.clear()),T(this.layeredAreas.values(),e=>void e.clear()),T(this.rowHeaders.values(),e=>void e.clear()),T(this.columnHeaders.values(),e=>void e.clear()),T(this.activeRowHeaders.values(),e=>void e.clear()),T(this.activeColumnHeaders.values(),e=>void e.clear()),T(this.activeCornerHeaders.values(),e=>void e.clear()),T(this.rowHighlights.values(),e=>void e.clear()),T(this.columnHighlights.values(),e=>void e.clear())}[Yx](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Ai(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}const NX=DX;let jx;function CE(t,e,n){return e=LX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LX(t){var e=kX(t,"string");return typeof e=="symbol"?e:String(e)}function kX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}jx=Symbol.iterator;class $X{constructor(e){CE(this,"ranges",[]),CE(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[jx](){return this.ranges[Symbol.iterator]()}}const FX=$X;function Dl(t,e){Kx(t,e),e.add(t)}function hm(t,e,n){Kx(t,e),e.set(t,n)}function Kx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ze(t,e){var n=Xx(t,e,"get");return WX(t,n)}function WX(t,e){return e.get?e.get.call(t):e.value}function Gn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function $w(t,e,n){var r=Xx(t,e,"set");return VX(t,r,n),n}function Xx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function VX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var qc=new WeakMap,rt=new WeakMap,Go=new WeakMap,dm=new WeakSet,fm=new WeakSet,Fw=new WeakSet,gm=new WeakSet,is=new WeakSet;class qx{constructor(e,n){Dl(this,is),Dl(this,gm),Dl(this,Fw),Dl(this,fm),Dl(this,dm),hm(this,qc,{writable:!0,value:void 0}),hm(this,rt,{writable:!0,value:void 0}),hm(this,Go,{writable:!0,value:{x:0,y:0}}),$w(this,qc,e),$w(this,rt,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Gn(this,dm,vE).call(this,{x:Ze(this,rt).navigableHeaders()?Ze(this,rt).countRowHeaders():0,y:Ze(this,rt).navigableHeaders()?Ze(this,rt).countColHeaders():0});const i=Ze(this,rt).createCellCoords(e,n);let o=Ze(this,qc).current().highlight;const s=Ze(this,rt).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=Gn(this,Fw,Zx).call(this),{row:h,col:f}=Gn(this,gm,yE).call(this,o),g=Ze(this,rt).fixedRowsBottom(),w=Ze(this,rt).minSpareRows(),C=Ze(this,rt).minSpareCols(),S=Ze(this,rt).autoWrapRow(),b=Ze(this,rt).autoWrapCol(),_=Ze(this,rt).createCellCoords(h+i.row,f+i.col);if(_.row>=c){const I=r&&w>0&&g===0,$=!I&&b,z=_.col+1,q=Ze(this,rt).createCellCoords(_.row-c,z>=u?z-u:z);this.runLocalHooks("beforeColumnWrap",$,Gn(this,is,fa).call(this,q),z>=u),I?this.runLocalHooks("insertRowRequire",Ze(this,rt).countRenderableRows()):$&&_.assign(q)}else if(_.row<0){const I=_.col-1,$=Ze(this,rt).createCellCoords(c+_.row,I<0?u+I:I);this.runLocalHooks("beforeColumnWrap",b,Gn(this,is,fa).call(this,$),I<0),b&&_.assign($)}if(_.col>=u){const I=r&&C>0,$=!I&&S,z=_.row+1,q=Ze(this,rt).createCellCoords(z>=c?z-c:z,_.col-u);this.runLocalHooks("beforeRowWrap",$,Gn(this,is,fa).call(this,q),z>=c),I?this.runLocalHooks("insertColRequire",Ze(this,rt).countRenderableColumns()):$&&_.assign(q)}else if(_.col<0){const I=_.row-1,$=Ze(this,rt).createCellCoords(I<0?c+I:I,u+_.col);this.runLocalHooks("beforeRowWrap",S,Gn(this,is,fa).call(this,$),I<0),S&&_.assign($)}const{rowDir:O,colDir:x}=Gn(this,fm,SE).call(this,_);a=O,l=x,o=Gn(this,is,fa).call(this,_)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){Gn(this,dm,vE).call(this,{x:Ze(this,rt).navigableHeaders()?Ze(this,rt).countRowHeaders():0,y:Ze(this,rt).navigableHeaders()?Ze(this,rt).countColHeaders():0});const r=Ze(this,rt).createCellCoords(e,n),i=Ze(this,qc).current(),o=Ze(this,rt).visualToRenderableCoords(i.highlight),s=i.to.clone();let a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null){const{row:u,col:c}=Gn(this,gm,yE).call(this,i.to),h=Ze(this,rt).createCellCoords(u+r.row,c+r.col),{rowDir:f,colDir:g}=Gn(this,fm,SE).call(this,h);a=f,l=g;const w=Gn(this,is,fa).call(this,h);r.row===0&&r.col!==0?s.col=w.col:r.row!==0&&r.col===0?s.row=w.row:(s.row=w.row,s.col=w.col)}return this.runLocalHooks("afterTransformEnd",s,a,l),s}}function vE(t){let{x:e,y:n}=t;$w(this,Go,{x:e,y:n})}function SE(t){const{width:e,height:n}=Gn(this,Fw,Zx).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function Zx(){return{width:Ze(this,Go).x+Ze(this,rt).countRenderableColumns(),height:Ze(this,Go).y+Ze(this,rt).countRenderableRows()}}function yE(t){const{row:e,col:n}=Ze(this,rt).visualToRenderableCoords(t);return Ze(this,rt).createCellCoords(Ze(this,Go).y+e,Ze(this,Go).x+n)}function fa(t){const e=t.clone();return e.col=t.col-Ze(this,Go).x,e.row=t.row-Ze(this,Go).y,Ze(this,rt).renderableToVisualCoords(e)}dt(qx,Qn);const BX=qx,Bf=0,Uf=1,Qx=2,_y=3,UX=[_y,Qx],zX=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],mm=Symbol("root"),bE=Symbol("child");function sl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mm;if(e!==mm&&e!==bE)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===mm;let i=Bf;if(n){const o=t[0];t.length===0?i=Uf:r&&o instanceof yv?i=_y:r&&Array.isArray(o)?i=sl(o,bE):t.length>=2&&t.length<=4&&!t.some((a,l)=>!zX[l].includes(typeof a))&&(i=Qx)}return i}function zu(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!UX.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===_y;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),mt(u)&&(u=a),mt(c)&&(c=l),!r){const g=a,w=l,C=u,S=c;a=Math.min(g,C),l=Math.min(w,S),u=Math.max(g,C),c=Math.max(w,S)}const h=e(a,l),f=e(u,c);return n(h,h,f)}}function GX(t){const e=sl(t.getSelected());if(e===Bf||e===Uf)return[];const n=zu(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;T(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;T(Array.from(new Array(c),(h,f)=>u+f),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Ft(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function YX(t){const e=sl(t.getSelected());if(e===Bf||e===Uf)return[];const n=zu(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;T(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;T(Array.from(new Array(c),(h,f)=>u+f),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Ft(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function jX(t,e,n){KX(t,e),e.set(t,n)}function KX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mo(t,e,n){return e=XX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XX(t){var e=qX(t,"string");return typeof e=="symbol"?e:String(e)}function qX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RE(t,e,n){var r=Jx(t,e,"set");return ZX(t,r,n),n}function ZX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function EE(t,e){var n=Jx(t,e,"get");return QX(t,n)}function Jx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function QX(t,e){return e.get?e.get.call(t):e.value}var Nl=new WeakMap;class e1{constructor(e,n){var r=this;mo(this,"settings",void 0),mo(this,"tableProps",void 0),mo(this,"inProgress",!1),mo(this,"selectedRange",new FX((i,o,s)=>this.tableProps.createCellRange(i,o,s))),mo(this,"highlight",void 0),mo(this,"transformation",void 0),mo(this,"selectedByRowHeader",new Set),mo(this,"selectedByColumnHeader",new Set),jX(this,Nl,{writable:!0,value:!1}),this.settings=e,this.tableProps=n,this.highlight=new NX({headerClassName:e.currentHeaderClassName,headerAttributes:[vw()],activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[vw()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),this.transformation=new BX(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=mt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&mt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(n),r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(Iv,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(T(this.highlight.getAreas(),_=>void _.clear()),T(this.highlight.getLayeredAreas(),_=>void _.clear()),T(this.highlight.getRowHeaders(),_=>void _.clear()),T(this.highlight.getColumnHeaders(),_=>void _.clear()),T(this.highlight.getActiveRowHeaders(),_=>void _.clear()),T(this.highlight.getActiveColumnHeaders(),_=>void _.clear()),T(this.highlight.getActiveCornerHeaders(),_=>void _.clear()),T(this.highlight.getRowHighlights(),_=>void _.clear()),T(this.highlight.getColumnHighlights(),_=>void _.clear())),this.highlight.useLayerLevel(l);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),h=this.highlight.createRowHeader(),f=this.highlight.createColumnHeader(),g=this.highlight.createActiveRowHeader(),w=this.highlight.createActiveColumnHeader(),C=this.highlight.createActiveCornerHeader(),S=this.highlight.createRowHighlight(),b=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),h.clear(),f.clear(),g.clear(),w.clear(),C.clear(),S.clear(),b.clear(),this.highlight.isEnabledFor(Pv,s.highlight)&&(this.isMultiple()||l>=1)&&(u.add(s.from).add(s.to).commit(),c.add(s.from).add(s.to).commit(),l===1)){const _=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(_.from).commit().syncWith(_),this.highlight.createLayeredArea().add(_.from).commit().syncWith(_),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(Ov,s.highlight)){if(!s.isSingleHeader()){const x=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),I=this.tableProps.createCellCoords(s.to.row,-1),$=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),z=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(h.add(x).commit(),f.add($).commit(),S.add(x).commit(),b.add($).commit()):(h.add(x).add(I).commit(),f.add($).add(z).commit(),S.add(x).add(I).commit(),b.add($).add(z).commit())}const _=!EE(this,Nl)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||i===0&&this.isSelectedByRowHeader()),O=!EE(this,Nl)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||r===0&&this.isSelectedByColumnHeader());_&&g.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),O&&w.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),_&&O&&C.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=Us(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,r))}transformEnd(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:f,disableHeadersHighlight:g}=i;RE(this,Nl,g),f&&Number.isInteger(f==null?void 0:f.row)&&Number.isInteger(f==null?void 0:f.col)&&(h=this.tableProps.createCellCoords(qn(f.row,u,o-1),qn(f.col,c,s-1)));const w=this.tableProps.createCellCoords(u,c),C=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(w,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(C),this.finish(),RE(this,Nl,!1)}selectCells(e){var n=this;const r=sl(e);if(r===Uf)return!1;if(r===Bf)throw new Error(ct`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=zu(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),T(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone()),this.finish()})),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),f=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(f){const g=l===0?0:qn(r,u,-1),w=s-1,C=this.tableProps.createCellCoords(g,i),S=this.tableProps.createCellCoords(w,o),b=this.tableProps.createCellCoords(qn(r,u,s-1),i);this.runLocalHooks("beforeSelectColumns",C,S,b),C.row=g,S.row=w,this.setRangeStartOnly(C,void 0,b),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.runLocalHooks("afterSelectColumns",C,S,b),this.finish()}return f}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){const h=s===0?0:qn(r,a,-1),f=o-1,g=this.tableProps.createCellCoords(e,h),w=this.tableProps.createCellCoords(n,f),C=this.tableProps.createCellCoords(e,qn(r,a,o-1));this.runLocalHooks("beforeSelectRows",g,w,C),g.col=h,w.col=f,this.setRangeStartOnly(g,void 0,C),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.runLocalHooks("afterSelectRows",g,w,C),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),f.commit(),g.commit()}this.highlight.useLayerLevel(r)}}dt(e1,Qn);const JX=e1,TE=/^(\r\n|\n\r|\r|\n)/,eq=/^[^\t\r\n]+/,_E=/^\t/;function tq(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(_E))t=t.replace(_E,""),n+=1,e[r][n]="";else if(t.match(TE))t=t.replace(TE,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(eq);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function yu(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function os(t,e,n){return e=nq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nq(t){var e=rq(t,"string");return typeof e=="symbol"?e:String(e)}function rq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Za{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){os(this,"hot",void 0),os(this,"metaManager",void 0),os(this,"tableMeta",void 0),os(this,"dataSource",void 0),os(this,"duckSchema",void 0),os(this,"colToPropCache",void 0),os(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=xf(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if($e(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return Fv(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Be(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&le(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(le(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?ol(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,f=[];for(;a<n&&o+a<c;){let w=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?w=bn(this.getSchema()):(w=[],pe(h-1,()=>w.push(null))):this.hot.dataType==="function"?w=this.tableMeta.dataSchema(l+a):(w={},uc(w,this.getSchema())),f.push(w),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,f);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===f.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",g,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let f=this.hot.countCols(),g=0,w=c;i==="end"&&(w=Math.min(w+1,a));const C=w;for(;g<n&&f<s;){if(typeof l!="number"||l>=f)if(h>0)for(let b=0;b<h;b+=1)typeof o[b]>"u"&&(o[b]=[]),o[b].push(null);else o.push([null]);else for(let b=0;b<h;b++)o[b].splice(w,0,null);g+=1,w+=1,f+=1}this.hot.columnIndexMapper.insertIndexes(l,g),g>0&&(e==null?this.metaManager.createColumn(null,g):r!=="auto"&&this.metaManager.createColumn(C,n));const S=this.hot.toVisualColumn(C);return this.hot.runHooks("afterCreateCol",S,g,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:C}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=le(this.tableMeta.columns)||le(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,f)=>f-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,f=this.hot.countSourceRows();h<f;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,f=this.hot.countSourceRows();h<f;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];gw(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return tI(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];gw(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;let s=null;if(i&&i.hasOwnProperty&&At(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){const a=n.split(".");let l=i;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;s=l}else typeof n=="function"&&(s=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const a=Us(s);this.hot.runHooks("modifyData",r,this.propToCol(n),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const l=Us(o);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"set"),l.isTouched()&&(o=l.value)}if(s&&s.hasOwnProperty&&At(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){const l=n.split(".");let u=s,c=0,h;for(c=0,h=l.length-1;c<h;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=o}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Za.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Za.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),f=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=f&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,n){return yu(this.getRange(e,n,Za.DESTINATION_RENDERER))}getCopyableText(e,n){return yu(this.getRange(e,n,Za.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const iq=Za,{register:oq,getItem:sq,hasItem:t1,getNames:aq,getValues:rle}=Yr("cellTypes");function My(t){if(!t1(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return sq(t)}function dr(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&jn(t,n),r&&ai(t,r),i&&qa(t,i),oq(t,e)}function lq(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!At(e,t)}function zf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?My(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Be(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!$e(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Be(r,(o,s)=>{if(lq(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),Ut(t,i)}function uq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}ao(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function td(t){return Number.isInteger(t)&&t>=0}function nd(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Zc(t){return t==null}const n1=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Xt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Xt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),If(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,disableTabNavigation:!1,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function ME(t,e,n){return e=cq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cq(t){var e=hq(t,"string");return typeof e=="symbol"?e:String(e)}function hq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dq(){return class{}}class fq{constructor(e){ME(this,"metaCtor",dq()),ME(this,"meta",void 0),this.meta=this.metaCtor.prototype,Ut(this.meta,n1()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;Ut(this.meta,e),zf(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function gq(t,e,n){return e=mq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mq(t){var e=pq(t,"string");return typeof e=="symbol"?e:String(e)}function pq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wq{constructor(e){gq(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){Ut(this.meta,e),zf(this.meta,e,e)}}let r1;function Qc(t,e,n){return e=Cq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cq(t){var e=vq(t,"string");return typeof e=="symbol"?e:String(e)}function vq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}r1=Symbol.iterator;class Wd{constructor(e){Qc(this,"valueFactory",void 0),Qc(this,"data",[]),Qc(this,"index",[]),Qc(this,"holes",new Set),this.valueFactory=e}obtain(e){nd(()=>td(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;nd(()=>td(e)||Zc(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=Zc(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;nd(()=>td(e)||Zc(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Zc(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return or(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[r1](){return this.entries()}}function AE(t,e,n){return e=Sq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sq(t){var e=yq(t,"string");return typeof e=="symbol"?e:String(e)}function yq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const bq=["data","width"];class Rq{constructor(e){AE(this,"globalMeta",void 0),AE(this,"metas",new Wd(()=>this._createMeta())),this.globalMeta=e,this.metas=new Wd(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);Ut(r,n),zf(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return uq(this.globalMeta.getMetaConstructor(),bq).prototype}}function OE(t,e,n){return e=Eq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eq(t){var e=Tq(t,"string");return typeof e=="symbol"?e:String(e)}function Tq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _q{constructor(e){OE(this,"columnMeta",void 0),OE(this,"metas",new Wd(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);Ut(i,r),zf(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)e.push(...n[r].values());return e}getMetasAtRow(e){nd(()=>td(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Wd(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class i1{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new fq(e),this.tableMeta=new wq(this.globalMeta),this.columnMeta=new Rq(this.globalMeta),this.cellMeta=new _q(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:o}=r;const s=this.cellMeta.getMeta(e,n);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}dt(i1,Qn);function PE(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=yn(a),f=i.getSettings();Array.isArray(f.dataSchema)?i.dataType="array":gt(f.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new iq(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const w=g.getSchema();t=[];let C,S=0,b=0;for(S=0,b=f.startRows;S<b;S++)if((i.dataType==="object"||i.dataType==="function")&&f.dataSchema)C=bn(w),t.push(C);else if(i.dataType==="array")C=bn(w[0]),t.push(C);else{C=[];for(let _=0,O=f.startCols;_<O;_++)C.push(null);t.push(C)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),f.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),n(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&ve(i.rootElement,[lI(i.countRows()),uI(i.countCols())])}function IE(t,e,n){return e=Mq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mq(t){var e=Aq(t,"string");return typeof e=="symbol"?e:String(e)}function Aq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Oq{constructor(e){IE(this,"metaManager",void 0),IE(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),fe.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=At(e,"type")?e.type:null;let c=gt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function pm(t,e,n){return e=Pq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pq(t){var e=Iq(t,"string");return typeof e=="symbol"?e:String(e)}function Iq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xq{constructor(e){pm(this,"metaManager",void 0),pm(this,"usageTracker",new Set),pm(this,"propDescriptors",new Map([["ariaTags",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{target:r,onChange:i=()=>{}}=e,o=typeof r=="string",s=o?r:n,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(n,a,i),o&&this.installPropWatcher(r,a,i)})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const o1="gridDefault",Ay="editorManager.handlingEditor",Hq={name:"editorCloseAndSave",callback(t,e,n){const r=t._getEditorManager();r.closeEditorAndSaveChanges(t.getShortcutManager().isCtrlPressed()),r.moveSelectionAfterEnter(n.includes("shift"))}},Dq={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},Nq={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},Lq={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(n.includes("shift")),br(e))}};function kq(){return[Hq,Dq,Nq,Lq]}const $q={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},Fq={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},Wq={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},Vq={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},Bq={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e.row)}},Uq={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},zq={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},Gq={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}},Yq={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},jq={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},Kq={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},Xq={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e.col)}},qq={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},Zq={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function Qq(){return[$q,Fq,Wq,Vq,Bq,Uq,zq,Gq,Yq,jq,Kq,Xq,qq,Zq]}const Jq={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},e4={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},t4={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-r.row,-r.col)}},n4={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(r.row,r.col,!0)}},r4={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},i4={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},o4={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},s4={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},a4={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},l4={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,o))}},u4={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},c4={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},h4={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},d4={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},f4={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},g4={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function m4(){return[Jq,e4,t4,n4,r4,i4,o4,s4,a4,l4,u4,c4,h4,d4,f4,g4]}const p4={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},w4={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},C4={name:"selectAll",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},v4={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},S4=[...kq(),...Qq(),...m4(),p4,w4,C4,v4];function s1(t){const e={};return S4.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function y4(t){const e=t.getShortcutManager().addContext("editor"),n=s1(t),r={group:Ay};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function b4(t){const e=t.getShortcutManager().addContext("grid"),n=s1(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return le(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:o1};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Ay,runOnlyIf:()=>le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"],["Control/Meta","Shift","Space"]],callback:()=>n.selectAll()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function R4(t){[y4,b4].forEach(e=>e(t))}function E4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=xE(t),i=xE(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function xE(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&ve(n,[$r()]),n}function T4(t){let e;const{activate:n,deactivate:r}=E4(t,{onFocusFromTop(){var s;const a=(s=e)!==null&&s!==void 0?s:HE(t);a&&(t.runHooks("modifyFocusOnTabNavigation","from_above",a),t.selectCell(a.row,a.col)),t.listen()},onFocusFromBottom(){var s;const a=(s=e)!==null&&s!==void 0?s:DE(t);a&&(t.runHooks("modifyFocusOnTabNavigation","from_below",a),t.selectCell(a.row,a.col)),t.listen()}}),i={wrapped:!1,flipped:!1};t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",()=>{var s;e=(s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight}),t.addHook("beforeRowWrap",(s,a,l)=>{i.wrapped=!0,i.flipped=l});function o(){i.wrapped=!1,i.flipped=!1,t.deselectCell(),t.unlisten()}t.getShortcutManager().getContext("grid").addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:s=>{const{disableTabNavigation:a,autoWrapRow:l}=t.getSettings();if(a||!t.selection.isSelected()||l&&i.wrapped&&i.flipped||!l&&i.wrapped)return l&&i.wrapped&&i.flipped&&(e=s.shiftKey?HE(t):DE(t)),o(),!1;s.preventDefault()},runOnlyIf:()=>!t.getSettings().minSpareCols,preventDefault:!1,stopPropagation:!1,position:"after",relativeToGroup:o1,group:"focusCatcher"})}function HE(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function DE(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}const NE=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Jc=t=>t.map(e=>{const n=e.toLowerCase();return NE.has(n)?NE.get(n):n}).sort().join("+"),_4=t=>t.split("+"),LE=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),wm=t=>{let{key:e,code:n}=t;return(LE.test(n)?n.replace(LE,"$1"):e).toLowerCase()},a1=Symbol("shortcut-context");function l1(t){return $e(t)&&t.__kindOf===a1}const M4=t=>{const e=Nf({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:f=!1,preventDefault:g=!0,stopPropagation:w=!1,relativeToGroup:C,position:S,forwardToContext:b}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(mt(c))throw new Error("You need to define the shortcut's group.");if(gt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ct`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const _={callback:u,group:c,runOnlyIf:h,captureCtrl:f,preventDefault:g,stopPropagation:w};le(C)&&([_.relativeToGroup,_.position]=[C,S]),l1(b)&&(_.forwardToContext=b),l.forEach(O=>{const x=Jc(O);if(e.hasItem(x)){const $=e.getItem(x);let z=$.findIndex(q=>q.group===C);z!==-1?S==="before"?z-=1:z+=1:z=$.length,$.splice(z,0,_)}else e.addItem(x,[_])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Be(u,(h,f)=>{Object.prototype.hasOwnProperty.call(c,f)===!1&&(c[f]=u[f])}),n(c)})},i=l=>{const u=Jc(l);e.removeItem(u)};return{__kindOf:a1,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=Jc(l),c=e.getItem(u);return le(c)?c.slice():[]},hasShortcut:l=>{const u=Jc(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,f]=c;const g=f.filter(w=>w.group!==l);g.length===0?i(_4(h)):(f.length=0,f.push(...g))})}}};function A4(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const O4=["meta","alt","shift","control"],Ll=A4();let eh=0;function P4(t,e,n,r,i){const o=g=>O4.includes(g),s=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const C=[];return g.altKey&&C.push("alt"),w&&(g.ctrlKey||g.metaKey)?C.push("control/meta"):(g.ctrlKey&&C.push("control"),g.metaKey&&C.push("meta")),g.shiftKey&&C.push("shift"),C},a=g=>{if(e(g)===!1)return;const w=n(g);if(g.keyCode===229||w===!1||Ao(g))return;const C=wm(g);let S=[];o(C)||(S=s(g));const b=[C].concat(S);!i(g,b)&&(Vu()&&S.includes("meta")||!Vu()&&S.includes("control"))&&i(g,[C].concat(s(g,!0))),r(g)},l=g=>{const w=wm(g);o(w)&&Ll.press(w)},u=g=>{const w=wm(g);o(w)&&Ll.release(w)},c=()=>{Ll.releaseAll()};return{mount:()=>{let g=t;for(eh+=1;g;)eh===1&&(g.document.documentElement.addEventListener("keydown",l),g.document.documentElement.addEventListener("keyup",u)),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=$u(g)},unmount:()=>{let g=t;for(eh-=1;g;)eh===0&&(g.document.documentElement.removeEventListener("keydown",l),g.document.documentElement.removeEventListener("keyup",u)),g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=$u(g)},isPressed:g=>Ll.isPressed(g),releasePressedKeys:()=>Ll.releaseAll()}}const I4=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Nf({errorIdExists:w=>`The "${w}" context name is already registered.`});let s="grid";const a=w=>{const C=M4(w);return o.addItem(w,C),C},l=()=>s,u=w=>o.getItem(w),c=w=>{if(!o.hasItem(w))throw new Error(ct`You've tried to activate the "${w}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=w};let h=!1;const f=function(w,C){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const b=l1(S)?S:u(S);let _=!1;if(!b.hasShortcut(C))return _;const O=b.getShortcuts(C);for(let x=0;x<O.length;x++){const{callback:I,runOnlyIf:$,preventDefault:z,stopPropagation:q,captureCtrl:Y,forwardToContext:K}=O[x];if($(w)===!0){if(h=Y,_=I(w,C)===!1,h=!1,z&&w.preventDefault(),q&&(br(w),w.stopPropagation()),_)break;K&&f(w,C,K)}}return _},g=P4(e,n,r,i,f);return g.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};let Cm=null;const vm=new Map;function u1(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this;const a=new sr(s);let l,u,c,h,f,g=!0;m3(i)&&g3(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const w=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",C=["rtl","ltr"].includes(w)?w:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",C),this.isRtl=function(){return C==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=CX(e.language);const S=new i1(s,e,[Oq,xq]),b=S.getTableMeta(),_=S.getGlobalMeta(),O=Nf();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),ed(this)&&oI(e.licenseKey,t),this.guid=`ht_${XC()}`,vm.set(this.guid,this),this.columnIndexMapper=new Lw,this.rowIndexMapper=new Lw,this.columnIndexMapper.addLocalHook("indexesSequenceChange",d=>{s.runHooks("afterColumnSequenceChange",d)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",d=>{s.runHooks("afterRowSequenceChange",d)}),u=new I3(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const x=d=>{const{row:m,col:p}=d;return s._createCellCoords(m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m,p>=0?s.columnIndexMapper.getRenderableFromVisualIndex(p):p)},I=d=>{const{row:m,col:p}=d;return s._createCellCoords(m>=0?s.rowIndexMapper.getVisualFromRenderableIndex(m):m,p>=0?s.columnIndexMapper.getVisualFromRenderableIndex(p):p)};let $=new JX(b,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:d=>l.propToCol(d),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(d,m)=>s._createCellCoords(d,m),createCellRange:(d,m,p)=>s._createCellRange(d,m,p),visualToRenderableCoords:x,renderableToVisualCoords:I,isDisabledCellSelection:(d,m)=>d<0||m<0?s.getSettings().disableVisualSelection:s.getCellMeta(d,m).disableVisualSelection});this.selection=$;const z=d=>{let{hiddenIndexesChanged:m}=d;m&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",z),this.rowIndexMapper.addLocalHook("cacheUpdated",z),this.selection.addLocalHook("afterSetRangeEnd",d=>{const m=Us(!1),p=this.selection.getSelectedRange(),{from:E,to:M}=p.current(),P=p.size()-1;this.runHooks("afterSelection",E.row,E.col,M.row,M.col,m,P),this.runHooks("afterSelectionByProp",E.row,s.colToProp(E.col),M.row,s.colToProp(M.col),m,P);let G=!0;o&&(G=!1),m.isTouched()&&(G=!m.value);const V=this.selection.selectedRange.current(),Z=this.selection.isSelectedByAnyHeader(),Q=this.selection.isSelectedByRowHeader(),X=this.selection.isSelectedByColumnHeader();if(G!==!1)if(Z)Q?this.scrollViewportTo({row:d.row}):X&&this.scrollViewportTo({col:d.col});else if(V&&!this.selection.isMultiple()){const{row:he,col:Me}=V.from;he<0&&Me>=0?this.scrollViewportTo({col:Me}):Me<0&&he>=0?this.scrollViewportTo({row:he}):this.scrollViewportTo({row:he,col:Me})}else this.scrollViewportTo(d.toObject());Q&&X?ee(this.rootElement,["ht__selection--rows","ht__selection--columns"]):Q?(De(this.rootElement,"ht__selection--columns"),ee(this.rootElement,"ht__selection--rows")):X?(De(this.rootElement,"ht__selection--rows"),ee(this.rootElement,"ht__selection--columns")):De(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",d=>{const m=d.length-1,{from:p,to:E}=d[m];this.runHooks("afterSelectionEnd",p.row,p.col,E.row,E.col,m),this.runHooks("afterSelectionEndByProp",p.row,s.colToProp(p.col),E.row,s.colToProp(E.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",d=>{const m=this.runHooks("afterIsMultipleSelection",d.value);d.value&&(d.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{h.destroyEditor(),this._refreshBorders(),De(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("afterSelectRows",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",d=>this.alter("insert_row_above",d,1,"auto")).addLocalHook("insertColRequire",d=>this.alter("insert_col_start",d,1,"auto")),c={alter(d,m){var p,E;let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,P=arguments.length>3?arguments[3]:void 0,G=arguments.length>4?arguments[4]:void 0;const V=Z=>{if(Z.length===0)return[];const Q=[...Z];return Q.sort((he,Me)=>{let[Te]=he,[_e]=Me;return Te===_e?0:Te>_e?1:-1}),Ft(Q,(he,Me)=>{let[Te,_e]=Me;const j=he[he.length-1],[Ye,Fe]=j,ye=Ye+Fe;if(Te<=ye){const xe=Math.max(_e-(ye-Te),0);j[1]+=xe}else he.push([Te,_e]);return he},[Q[0]])};switch(d){case"insert_row_below":case"insert_row_above":const Z=s.countSourceRows();if(b.maxRows===Z)return;const Q=d==="insert_row_below"?"below":"above";m=(p=m)!==null&&p!==void 0?p:Q==="below"?Z:0;const{delta:X,startPhysicalIndex:he}=l.createRow(m,M,{source:P,mode:Q});if(X){const Fe=$.selectedRange.current(),ye=Fe==null?void 0:Fe.from,xe=ye==null?void 0:ye.row,Se=s.toVisualRow(he);if($.isSelectedByCorner())$.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(le(xe)&&xe>=Se){const{row:v,col:y}=Fe.to;let A=ye.col;$.isSelectedByRowHeader()&&(A=-1),$.getSelectedRange().pop(),$.setRangeStartOnly(s._createCellCoords(xe+X,A),!0),$.setRangeEnd(s._createCellCoords(v+X,y))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Me=d==="insert_col_end"?"end":"start";m=(E=m)!==null&&E!==void 0?E:Me==="end"?s.countSourceCols():0;const{delta:Te,startPhysicalIndex:_e}=l.createCol(m,M,{source:P,mode:Me});if(Te){if(Array.isArray(b.colHeaders)){const v=[s.toVisualColumn(_e),0];v.length+=Te,Array.prototype.splice.apply(b.colHeaders,v)}const Fe=$.selectedRange.current(),ye=Fe==null?void 0:Fe.from,xe=ye==null?void 0:ye.col,Se=s.toVisualColumn(_e);if($.isSelectedByCorner())$.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(le(xe)&&xe>=Se){const{row:v,col:y}=Fe.to;let A=ye.row;$.isSelectedByColumnHeader()&&(A=-1),$.getSelectedRange().pop(),$.setRangeStartOnly(s._createCellCoords(A,xe+Te),!0),$.setRangeEnd(s._createCellCoords(v,y+Te))}else s._refreshBorders()}break;case"remove_row":const j=Fe=>{let ye=0;T(Fe,xe=>{let[Se,v]=xe;const y=Xt(Se)?s.countRows()-1:Math.max(Se-ye,0);if(Number.isInteger(Se)&&(Se=Math.max(Se-ye,0)),!l.removeRow(Se,v,P))return;const W=s.countRows(),H=b.fixedRowsTop;H>=y+1&&(b.fixedRowsTop-=Math.min(v,H-y));const F=b.fixedRowsBottom;F&&y>=W-F&&(b.fixedRowsBottom-=Math.min(v,F)),ye+=v})};Array.isArray(m)?j(V(m)):j([[m,M]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const Ye=Fe=>{let ye=0;T(Fe,xe=>{let[Se,v]=xe;const y=Xt(Se)?s.countCols()-1:Math.max(Se-ye,0);let A=s.toPhysicalColumn(y);if(Number.isInteger(Se)&&(Se=Math.max(Se-ye,0)),!l.removeCol(Se,v,P))return;const H=b.fixedColumnsStart;H>=y+1&&(b.fixedColumnsStart-=Math.min(v,H-y)),Array.isArray(b.colHeaders)&&(typeof A>"u"&&(A=-1),b.colHeaders.splice(A,v)),ye+=v})};Array.isArray(m)?Ye(V(m)):Ye([[m,M]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${d}"`)}G||c.adjustRowsAndCols()},adjustRowsAndCols(){const d=b.minRows,m=b.minSpareRows,p=b.minCols,E=b.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&$.deselect(),d){const M=s.countRows();M<d&&l.createRow(M,d-M,{source:"auto"})}if(m){const M=s.countEmptyRows(!0);if(M<m){const P=m-M,G=Math.min(P,b.maxRows-s.countSourceRows());l.createRow(s.countRows(),G,{source:"auto"})}}{let M;(p||E)&&(M=s.countEmptyCols(!0));let P=s.countCols();if(p&&!b.columns&&P<p){const G=p-P;M+=G,l.createCol(P,G,{source:"auto"})}if(E&&!b.columns&&s.dataType==="array"&&M<E){P=s.countCols();const G=E-M,V=Math.min(G,b.maxCols-P);l.createCol(P,V,{source:"auto"})}}if($.isSelected()){const M=s.countRows(),P=s.countCols();T($.selectedRange,G=>{let V=!1,Z=G.from.row,Q=G.from.col,X=G.to.row,he=G.to.col;Z>M-1?(Z=M-1,V=!0,X>Z&&(X=Z)):X>M-1&&(X=M-1,V=!0,Z>X&&(Z=X)),Q>P-1?(Q=P-1,V=!0,he>Q&&(he=Q)):he>P-1&&(he=P-1,V=!0,Q>he&&(Q=he)),V&&s.selectCell(Z,Q,X,he)})}s.view&&s.view.adjustElementsSize()},populateFromArray(d,m,p,E,M){let P,G,V,Z;const Q=[],X={},he=[],Me=d.row,Te=d.col;if(G=m.length,G===0)return!1;let _e=0,j=0;switch($e(p)&&(_e=p.col-Te+1,j=p.row-Me+1),M){case"shift_down":const Ye=wu(m),Fe=Ye.length,ye=Math.max(Fe,_e),xe=s.getData().slice(Me),Se=wu(xe).slice(Te,Te+ye);for(V=0;V<ye;V+=1)if(V<Fe){for(P=0,G=Ye[V].length;P<j-G;P+=1)Ye[V].push(Ye[V][P%G]);V<Se.length?he.push(Ye[V].concat(Se[V])):he.push(Ye[V].concat(new Array(xe.length).fill(null)))}else he.push(Ye[V%Fe].concat(Se[V]));s.populateFromArray(Me,Te,wu(he));break;case"shift_right":const v=m.length,y=Math.max(v,j),A=s.getData().slice(Me).map(U=>U.slice(Te));for(P=0;P<y;P+=1)if(P<v){for(V=0,Z=m[P].length;V<_e-Z;V+=1)m[P].push(m[P][V%Z]);if(P<A.length)for(let U=0;U<A[P].length;U+=1)m[P].push(A[P][U]);else m[P].push(...new Array(A[0].length).fill(null))}else m.push(m[P%G].slice(0,y).concat(A[P]));s.populateFromArray(Me,Te,m);break;case"overwrite":default:X.row=d.row,X.col=d.col;let W=0,H=0,F=!0,D;const N=function(se){let de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ce=m[se%m.length];return de!==null?Ce[de%Ce.length]:Ce},B=m.length,k=p?p.row-d.row+1:0;for(p?G=k:G=Math.max(B,k),P=0;P<G&&!(p&&X.row>p.row&&k>B||!b.allowInsertRow&&X.row>s.countRows()-1||X.row>=b.maxRows);P++){const U=P-W,se=N(U).length,de=p?p.col-d.col+1:0;if(p?Z=de:Z=Math.max(se,de),X.col=d.col,D=s.getCellMeta(X.row,X.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&D.skipRowOnPaste){W+=1,X.row+=1,G+=1;continue}for(H=0,V=0;V<Z&&!(p&&X.col>p.col&&de>se||!b.allowInsertColumn&&X.col>s.countCols()-1||X.col>=b.maxCols);V++){if(D=s.getCellMeta(X.row,X.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&D.skipColumnOnPaste){H+=1,X.col+=1,Z+=1;continue}if(D.readOnly&&E!=="UndoRedo.undo"){X.col+=1;continue}const Ce=V-H;let Ae=N(U,Ce),ke=s.getDataAtCell(X.row,X.col);if(Ae!==null&&typeof Ae=="object")if(Array.isArray(Ae)&&ke===null&&(ke=[]),ke===null||typeof ke!="object")F=!1;else{const wt=ol(Array.isArray(ke)?ke:ke[0]||ke),Xe=ol(Array.isArray(Ae)?Ae:Ae[0]||Ae);If(wt,Xe)||Array.isArray(wt)&&Array.isArray(Xe)?Ae=bn(Ae):F=!1}else ke!==null&&typeof ke=="object"&&(F=!1);F&&Q.push([X.row,X.col,Ae]),F=!0,X.col+=1}X.row+=1}s.setDataAtCell(Q,null,null,E||"populateFromArray");break}}};function q(d){const m=$x(d);Ty(m)?(s.runHooks("beforeLanguageChange",m),_.language=m,s.runHooks("afterLanguageChange",m)):Fx(d)}function Y(d,m){const p=d==="className"?s.rootElement:s.table;if(g)ee(p,m);else{let E=[],M=[];_[d]&&(E=Array.isArray(_[d])?_[d]:pw(_[d])),m&&(M=Array.isArray(m)?m:pw(m));const P=mw(E,M),G=mw(M,E);P.length&&De(p,P),G.length&&ee(p,G)}_[d]=m}this.init=function(){u.setData(b.data),s.runHooks("beforeInit"),(Yi()||cv())&&ee(s.rootElement,"mobile"),this.updateSettings(b,!0),this.view=new b3(this),h=xG.getInstance(s,b,$),f=new NG(s),ed(this)&&T4(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&s.rootElement.offsetParent===null&&yI(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof g=="object"&&(s.runHooks("afterChange",g[0],g[1]),g=!1),s.runHooks("afterInit")};function K(){let d=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,d=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&d===!1&&(d=!0,this.onQueueEmpty(this.valid))}}}function te(d){const m=d.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):d}function oe(d,m,p){if(!d.length)return;const E=s.getActiveEditor(),M=new K;let P=!0;M.onQueueEmpty=G=>{E&&P&&E.cancelChanges(),p(G)};for(let G=d.length-1;G>=0;G--){const[V,Z,,Q]=d[G],X=l.propToCol(Z),he=s.getCellMeta(V,X);he.type==="numeric"&&typeof Q=="string"&&KI(Q)&&(d[G][3]=te(Q)),s.getCellValidator(he)&&(M.addValidatorToQueue(),s.validateCell(d[G][3],he,function(Me,Te){return function(_e){if(typeof _e!="boolean")throw new Error("Validation error: result is not boolean");if(_e===!1&&Te.allowInvalid===!1){P=!1,d.splice(Me,1),Te.valid=!0;const j=s.getCell(Te.visualRow,Te.visualCol);j!==null&&De(j,b.invalidCellClassName)}M.removeValidatorFormQueue()}}(G,he),m))}M.checkIfQueueIsEmpty()}function ie(d,m){let p=d.length-1;if(p<0)return;for(;p>=0;p--){let M=!1;if(d[p]===null){d.splice(p,1);continue}if(!((d[p][2]===null||d[p][2]===void 0)&&(d[p][3]===null||d[p][3]===void 0))){if(b.allowInsertRow)for(;d[p][0]>s.countRows()-1;){const{delta:P}=l.createRow(void 0,void 0,{source:m});if(P===0){M=!0;break}}if(s.dataType==="array"&&(!b.columns||b.columns.length===0)&&b.allowInsertColumn)for(;l.propToCol(d[p][1])>s.countCols()-1;){const{delta:P}=l.createCol(void 0,void 0,{source:m});if(P===0){M=!0;break}}M||l.set(d[p][0],d[p][1],d[p][3])}}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",d,m),h.lockEditor(),s._refreshBorders(null),h.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",d,m||"edit");const E=s.getActiveEditor();E&&le(E.refreshValue)&&E.refreshValue()}this._createCellCoords=function(d,m){return s.view._wt.createCellCoords(d,m)},this._createCellRange=function(d,m,p){return s.view._wt.createCellRange(d,m,p)},this.validateCell=function(d,m,p,E){let M=s.getCellValidator(m);function P(G){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){p(G);return}const Z=m.visualCol,Q=m.visualRow,X=s.getCell(Q,Z,!0);if(X&&X.nodeName!=="TH"){const he=s.rowIndexMapper.getRenderableFromVisualIndex(Q),Me=s.columnIndexMapper.getRenderableFromVisualIndex(Z);s.view._wt.getSetting("cellRenderer",he,Me,X)}p(G)}iI(M)&&(M=function(G){return function(V,Z){Z(G.test(V))}}(M)),gt(M)?(d=s.runHooks("beforeValidate",d,m.visualRow,m.prop,E),s._registerImmediate(()=>{M.call(m,d,G=>{s&&(G=s.runHooks("afterValidate",G,d,m.visualRow,m.prop,E),m.valid=G,P(G),s.runHooks("postAfterValidate",G,d,m.visualRow,m.prop,E))})})):s._registerImmediate(()=>{m.valid=!0,P(m.valid,!1)})};function ue(d,m,p){return Array.isArray(d)?d:[[d,m,p]]}function be(d,m){const p=s.getActiveEditor(),E=s.runHooks("beforeChange",d,m||"edit"),M=d.filter(P=>P!==null);return E===!1||M.length===0?(p&&p.cancelChanges(),[]):M}this.setDataAtCell=function(d,m,p,E){const M=ue(d,m,p),P=[];let G=E,V,Z,Q;for(V=0,Z=M.length;V<Z;V++){if(typeof M[V]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof M[V][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");M[V][1]>=this.countCols()?Q=M[V][1]:Q=l.colToProp(M[V][1]),P.push([M[V][0],Q,u.getAtCell(this.toPhysicalRow(M[V][0]),M[V][1]),M[V][2]])}!G&&typeof d=="object"&&(G=m);const X=be(P,E);s.runHooks("afterSetDataAtCell",X,G),oe(X,G,()=>{ie(X,G)})},this.setDataAtRowProp=function(d,m,p,E){const M=ue(d,m,p),P=[];let G=E,V,Z;for(V=0,Z=M.length;V<Z;V++)P.push([M[V][0],M[V][1],u.getAtCell(this.toPhysicalRow(M[V][0]),M[V][1]),M[V][2]]);!G&&typeof d=="object"&&(G=m);const Q=be(P,E);s.runHooks("afterSetDataAtRowProp",Q,G),oe(Q,G,()=>{ie(Q,G)})},this.listen=function(){s&&!s.isListening()&&(vm.forEach(d=>{s!==d&&d.unlisten()}),Cm=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Cm=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Cm===s.guid},this.destroyEditor=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(d,m)},this.populateFromArray=function(d,m,p,E,M,P,G){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const V=typeof E=="number"?s._createCellCoords(E,M):null;return c.populateFromArray(s._createCellCoords(d,m),p,V,P,G)},this.spliceCol=function(d,m,p){for(var E=arguments.length,M=new Array(E>3?E-3:0),P=3;P<E;P++)M[P-3]=arguments[P];return l.spliceCol(d,m,p,...M)},this.spliceRow=function(d,m,p){for(var E=arguments.length,M=new Array(E>3?E-3:0),P=3;P<E;P++)M[P-3]=arguments[P];return l.spliceRow(d,m,p,...M)},this.getSelected=function(){if($.isSelected())return Ve($.getSelectedRange(),d=>{let{from:m,to:p}=d;return[m.row,m.col,p.row,p.col]})},this.getSelectedLast=function(){const d=this.getSelected();let m;return d&&d.length>0&&(m=d[d.length-1]),m},this.getSelectedRange=function(){if($.isSelected())return Array.from($.getSelectedRange())},this.getSelectedRangeLast=function(){const d=this.getSelectedRange();let m;return d&&d.length>0&&(m=d[d.length-1]),m},this.emptySelectedCells=function(d){if(!$.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];T($.getSelectedRange(),p=>{if(p.isSingleHeader())return;const E=p.getTopStartCorner(),M=p.getBottomEndCorner();pe(E.row,M.row,P=>{pe(E.col,M.col,G=>{this.getCellMeta(P,G).readOnly||m.push([P,G,null])})})}),m.length>0&&this.setDataAtCell(m,d)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const d=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(d,0),!this.isRenderSuspended()&&d===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(h.lockEditor(),this._refreshBorders(null),h.unlockEditor()))},this.batchRender=function(d){this.suspendRender();const m=d();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||d)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=d();return this.resumeExecution(m),p},this.batch=function(d){this.suspendRender(),this.suspendExecution();const m=d();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!s.view)return;const{width:d,height:m}=s.view.getLastSize(),{width:p,height:E}=s.rootElement.getBoundingClientRect(),M=p!==d||E!==m;s.runHooks("beforeRefreshDimensions",{width:d,height:m},{width:p,height:E},M)!==!1&&((M||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(p,E),s.render()),s.runHooks("afterRefreshDimensions",{width:d,height:m},{width:p,height:E},M))},this.updateData=function(d,m){PE(d,p=>{l=p},p=>{l=p,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:m,metaManager:S,firstRun:g})},this.loadData=function(d,m){PE(d,p=>{l=p},()=>{S.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),g&&(g=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:m,metaManager:S,firstRun:g})},this.getInitialColumnCount=function(){const d=b.columns;let m=0;if(Array.isArray(d))m=d.length;else if(gt(d))if(s.dataType==="array"){const p=this.countSourceCols();for(let E=0;E<p;E+=1)d(E)&&(m+=1)}else(s.dataType==="object"||s.dataType==="function")&&(m=l.colToPropCache.length);else if(le(b.dataSchema)){const p=l.getSchema();m=Array.isArray(p)?p.length:xf(p)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(d,m,p,E){return mt(d)?l.getAll():l.getRange(s._createCellCoords(d,m),s._createCellCoords(p,E),l.DESTINATION_RENDERER)},this.getCopyableText=function(d,m,p,E){return l.getCopyableText(s._createCellCoords(d,m),s._createCellCoords(p,E))},this.getCopyableData=function(d,m){return l.getCopyable(d,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(g?s.loadData:s.updateData).bind(this);let E=!1,M,P;if(le(d.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(le(d.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(le(d.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(M in d)M==="data"||(M==="language"?q(d.language):M==="className"?Y("className",d.className):M==="tableClassName"&&s.table?(Y("tableClassName",d.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):fe.getSingleton().isRegistered(M)||fe.getSingleton().isDeprecated(M)?(gt(d[M])||Array.isArray(d[M]))&&(d[M].initialHook=!0,s.addHook(M,d[M])):!m&&At(d,M)&&(_[M]=d[M]));d.data===void 0&&b.data===void 0?p(null,"updateSettings"):d.data!==void 0?p(d.data,"updateSettings"):d.columns!==void 0&&(l.createMap(),s.initIndexMappers());const G=s.countCols(),V=b.columns;if(V&&gt(V)&&(E=!0),(d.cell!==void 0||d.cells!==void 0||d.columns!==void 0)&&S.clearCache(),G>0)for(M=0,P=0;M<G;M++){if(V){const X=E?V(M):V[P];X&&S.updateColumnMeta(P,X)}P+=1}le(d.cell)&&Be(d.cell,X=>{s.setCellMetaObject(X.row,X.col,X)}),s.runHooks("afterCellMetaReset");let Z=s.rootElement.style.height;Z!==""&&(Z=parseInt(s.rootElement.style.height,10));let Q=d.height;if(gt(Q)&&(Q=Q()),m&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),Q===null){const X=s.rootElement.getAttribute("data-initialstyle");X&&(X.indexOf("height")>-1||X.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",X):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else Q!==void 0&&(s.rootElement.style.height=isNaN(Q)?`${Q}`:`${Q}px`,s.rootElement.style.overflow="hidden");if(typeof d.width<"u"){let X=d.width;gt(X)&&(X=X()),s.rootElement.style.width=isNaN(X)?`${X}`:`${X}px`}m||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",d)),c.adjustRowsAndCols(),s.view&&!g&&(s.forceFullRender=!0,h.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),h.unlockEditor()),!m&&s.view&&(Z===""||Q===""||Q===void 0)&&Z!==Q&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const d=s.getSelectedLast();if(b.getValue){if(gt(b.getValue))return b.getValue.call(s);if(d)return s.getData()[d[0][0]][b.getValue]}else if(d)return s.getDataAtCell(d[0],d[1])},this.getSettings=function(){return b},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(d,m,p,E,M){c.alter(d,m,p,E,M)},this.getCell=function(d,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=m,M=d;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;E=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(d>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(d)))return null;M=this.rowIndexMapper.getRenderableFromVisualIndex(d)}return M===null||E===null?null:s.view.getCellAtCoords(s._createCellCoords(M,E),p)},this.getCoords=function(d){const m=this.view._wt.wtTable.getCoords(d);if(m===null)return null;const{row:p,col:E}=m;let M=p,P=E;return p>=0&&(M=this.rowIndexMapper.getVisualFromRenderableIndex(p)),E>=0&&(P=this.columnIndexMapper.getVisualFromRenderableIndex(E)),s._createCellCoords(M,P)},this.colToProp=function(d){return l.colToProp(d)},this.propToCol=function(d){return l.propToCol(d)},this.toVisualRow=d=>this.rowIndexMapper.getVisualFromPhysicalIndex(d),this.toVisualColumn=d=>this.columnIndexMapper.getVisualFromPhysicalIndex(d),this.toPhysicalRow=d=>this.rowIndexMapper.getPhysicalFromVisualIndex(d),this.toPhysicalColumn=d=>this.columnIndexMapper.getPhysicalFromVisualIndex(d),this.getDataAtCell=function(d,m){return l.get(d,l.colToProp(m))},this.getDataAtRowProp=function(d,m){return l.get(d,m)},this.getDataAtCol=function(d){const m=[],p=l.getRange(s._createCellCoords(0,d),s._createCellCoords(b.data.length-1,d),l.DESTINATION_RENDERER);for(let E=0;E<p.length;E+=1)for(let M=0;M<p[E].length;M+=1)m.push(p[E][M]);return m},this.getDataAtProp=function(d){const m=[],p=l.getRange(s._createCellCoords(0,l.propToCol(d)),s._createCellCoords(b.data.length-1,l.propToCol(d)),l.DESTINATION_RENDERER);for(let E=0;E<p.length;E+=1)for(let M=0;M<p[E].length;M+=1)m.push(p[E][M]);return m},this.getSourceData=function(d,m,p,E){let M;return d===void 0?M=u.getData():M=u.getByRange(s._createCellCoords(d,m),s._createCellCoords(p,E)),M},this.getSourceDataArray=function(d,m,p,E){let M;return d===void 0?M=u.getData(!0):M=u.getByRange(s._createCellCoords(d,m),s._createCellCoords(p,E),!0),M},this.getSourceDataAtCol=function(d){return u.getAtColumn(d)},this.setSourceDataAtCell=function(d,m,p,E){const M=ue(d,m,p),P=this.hasHook("afterSetSourceDataAtCell"),G=[];P&&T(M,Z=>{let[Q,X,he]=Z;G.push([Q,X,u.getAtCell(Q,X),he])}),T(M,Z=>{let[Q,X,he]=Z;u.setAtCell(Q,X,he)}),P&&this.runHooks("afterSetSourceDataAtCell",G,E),this.render();const V=s.getActiveEditor();V&&le(V.refreshValue)&&V.refreshValue()},this.getSourceDataAtRow=function(d){return u.getAtRow(d)},this.getSourceDataAtCell=function(d,m){return u.getAtCell(d,m)},this.getDataAtRow=function(d){return l.getRange(s._createCellCoords(d,0),s._createCellCoords(d,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(d,m,p,E){const M=d===void 0?[0,0,this.countRows(),this.countCols()]:[d,m,p,E],[P,G]=M;let[,,V,Z]=M,Q=null,X=null;V===void 0&&(V=P),Z===void 0&&(Z=G);let he="mixed";return pe(Math.max(Math.min(P,V),0),Math.max(P,V),Me=>{let Te=!0;return pe(Math.max(Math.min(G,Z),0),Math.max(G,Z),_e=>(X=this.getCellMeta(Me,_e).type,Q?Te=Q===X:Q=X,Te)),he=Te?X:"mixed",Te}),he},this.removeCellMeta=function(d,m,p){const[E,M]=[this.toPhysicalRow(d),this.toPhysicalColumn(m)];let P=S.getCellMetaKeyValue(E,M,p);s.runHooks("beforeRemoveCellMeta",d,m,p,P)!==!1&&(S.removeCellMeta(E,M,p),s.runHooks("afterRemoveCellMeta",d,m,p,P)),P=null},this.spliceCellsMeta=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,E=new Array(p>2?p-2:0),M=2;M<p;M++)E[M-2]=arguments[M];if(E.length>0&&!Array.isArray(E[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&S.removeRow(this.toPhysicalRow(d),m),E.length>0&&T(E.reverse(),P=>{S.createRow(this.toPhysicalRow(d)),T(P,(G,V)=>this.setCellMetaObject(d,V,G))}),s.render()},this.setCellMetaObject=function(d,m,p){typeof p=="object"&&Be(p,(E,M)=>{this.setCellMeta(d,m,M,E)})},this.setCellMeta=function(d,m,p,E){if(s.runHooks("beforeSetCellMeta",d,m,p,E)===!1)return;let P=d,G=m;d<this.countRows()&&(P=this.toPhysicalRow(d)),m<this.countCols()&&(G=this.toPhysicalColumn(m)),S.setCellMeta(P,G,p,E),s.runHooks("afterSetCellMeta",d,m,p,E)},this.getCellsMeta=function(){return S.getCellsMeta()},this.getCellMeta=function(d,m){let p=this.toPhysicalRow(d),E=this.toPhysicalColumn(m);return p===null&&(p=d),E===null&&(E=m),S.getCellMeta(p,E,{visualRow:d,visualColumn:m})},this.getCellMetaAtRow=function(d){return S.getCellsMetaAtRow(d)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||b.columns)},this.getCellRenderer=function(d,m){const p=typeof d=="number"?s.getCellMeta(d,m).renderer:d.renderer;return typeof p=="string"?Dd(p):mt(p)?Dd("text"):p},this.getCellEditor=function(d,m){const p=typeof d=="number"?s.getCellMeta(d,m).editor:d.editor;return typeof p=="string"?xd(p):mt(p)?xd("text"):p},this.getCellValidator=function(d,m){const p=typeof d=="number"?s.getCellMeta(d,m).validator:d.validator;return typeof p=="string"?pv(p):p},this.validateCells=function(d){this._validateCells(d)},this.validateRows=function(d,m){if(!Array.isArray(d))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,d)},this.validateColumns=function(d,m){if(!Array.isArray(d))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,d)},this._validateCells=function(d,m,p){const E=new K;d&&(E.onQueueEmpty=d);let M=s.countRows()-1;for(;M>=0;){if(m!==void 0&&m.indexOf(M)===-1){M-=1;continue}let P=s.countCols()-1;for(;P>=0;){if(p!==void 0&&p.indexOf(P)===-1){P-=1;continue}E.addValidatorToQueue(),s.validateCell(s.getDataAtCell(M,P),s.getCellMeta(M,P),G=>{if(typeof G!="boolean")throw new Error("Validation error: result is not boolean");G===!1&&(E.valid=!1),E.removeValidatorFormQueue()},"validateCells"),P-=1}M-=1}E.checkIfQueueIsEmpty()},this.getRowHeader=function(d){let m=b.rowHeaders,p=d;return p!==void 0&&(p=s.runHooks("modifyRowHeader",p)),p===void 0?(m=[],pe(s.countRows()-1,E=>{m.push(s.getRowHeader(E))})):Array.isArray(m)&&m[p]!==void 0?m=m[p]:gt(m)?m=m(p):m&&typeof m!="string"&&typeof m!="number"&&(m=p+1),m},this.hasRowHeaders=function(){return!!b.rowHeaders},this.hasColHeaders=function(){if(b.colHeaders!==void 0&&b.colHeaders!==null)return!!b.colHeaders;for(let d=0,m=s.countCols();d<m;d++)if(s.getColHeader(d))return!0;return!1},this.getColHeader=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=s.runHooks("modifyColHeader",d);if(p===void 0){const V=[],Z=s.countCols();for(let Q=0;Q<Z;Q++)V.push(s.getColHeader(Q));return V}let E=b.colHeaders;const M=function(V){const Z=[],Q=s.countCols();let X=0;for(;X<Q;X++)gt(b.columns)&&b.columns(X)&&Z.push(X);return Z[V]},P=s.toPhysicalColumn(p),G=M(P);return b.colHeaders===!1?E=null:b.columns&&gt(b.columns)&&b.columns(G)&&b.columns(G).title?E=b.columns(G).title:b.columns&&b.columns[P]&&b.columns[P].title?E=b.columns[P].title:Array.isArray(b.colHeaders)&&b.colHeaders[P]!==void 0?E=b.colHeaders[P]:gt(b.colHeaders)?E=b.colHeaders(P):b.colHeaders&&typeof b.colHeaders!="string"&&typeof b.colHeaders!="number"&&(E=kf(p)),E=s.runHooks("modifyColumnHeaderValue",E,d,m),E},this._getColWidthFromSettings=function(d){let m;if(d>=0&&(m=s.getCellMeta(0,d).width),(m===void 0||m===b.width)&&(m=b.colWidths),m!=null){switch(typeof m){case"object":m=m[d];break;case"function":m=m(d);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(d){let m=s._getColWidthFromSettings(d);return m=s.runHooks("modifyColWidth",m,d),m===void 0&&(m=Cv.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(d){let m=b.rowHeights;if(m!=null){switch(typeof m){case"object":m=m[d];break;case"function":m=m(d);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(d){let m=s._getRowHeightFromSettings(d);return m=s.runHooks("modifyRowHeight",m,d),m},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const d=b.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(d,m)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Hd(s.countRows()-1,p=>{if(s.isEmptyRow(p))m+=1;else if(d===!0)return!1}),m},this.countEmptyCols=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Hd(s.countCols()-1,p=>{if(s.isEmptyCol(p))m+=1;else if(d===!0)return!1}),m},this.isEmptyRow=function(d){return b.isEmptyRow.call(s,d)},this.isEmptyCol=function(d){return b.isEmptyCol.call(s,d)},this.selectCell=function(d,m,p,E){let M=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,P=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return mt(d)||mt(m)?!1:this.selectCells([[d,m,p,E]],M,P)},this.selectCells=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(o=!0);const E=$.selectCells(d);return E&&p&&s.listen(),o=!1,E},this.selectColumns=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,p=arguments.length>2?arguments[2]:void 0;return $.selectColumns(d,m,p)},this.selectRows=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,p=arguments.length>2?arguments[2]:void 0;return $.selectRows(d,m,p)},this.deselectCell=function(){$.deselect()},this.selectAll=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,p=arguments.length>2?arguments[2]:void 0;o=!0,$.selectAll(d,m,p),o=!1};const Ue=(d,m)=>d.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(){let{row:d,col:m,verticalSnap:p,horizontalSnap:E,considerHiddenIndexes:M}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},P,G,V,Z;p!==void 0&&(P=p==="top",G=!P),E!==void 0&&(V=E==="start",Z=!V);let Q=d,X=m;if(M===void 0||M){const Te=Number.isInteger(d)&&d>=0,_e=Number.isInteger(m)&&m>=0,j=Te?Ue(this.rowIndexMapper,d):void 0,Ye=_e?Ue(this.columnIndexMapper,m):void 0;if(j===null||Ye===null)return!1;Q=Te?s.rowIndexMapper.getRenderableFromVisualIndex(j):d,X=_e?s.columnIndexMapper.getRenderableFromVisualIndex(Ye):m}const he=Number.isInteger(Q),Me=Number.isInteger(X);return he&&Q>=0&&Me&&X>=0?s.view.scrollViewport(s._createCellCoords(Q,X),P,Z,G,V):he&&Q>=0&&(Me&&X<0||!Me)?s.view.scrollViewportVertically(Q,P,G):Me&&X>=0&&(he&&Q<0||!he)?s.view.scrollViewportHorizontally(X,Z,V):!1},this.scrollToFocusedCell=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",d);const{highlight:m}=this.getSelectedRangeLast();this.scrollViewportTo(m.toObject())?this.view.render():(this.removeHook("afterScroll",d),this._registerImmediate(()=>d()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),S.clearCache(),vm.delete(this.guid),ed(s)){const d=this.rootDocument.querySelector(".hot-display-license-info");d&&d.parentNode.removeChild(d)}zr(s.rootElement),a.destroy(),h&&h.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),O.getItems().forEach(d=>{let[,m]=d;m.destroy()}),O.clear(),s.runHooks("afterDestroy")},!0),fe.getSingleton().destroy(s),Be(s,(d,m,p)=>{gt(d)?p[m]=Ie(m):m!=="guid"&&(p[m]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,$=null,h=null,s=null};function Ie(d){return()=>{throw new Error(`The "${d}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getPlugin=function(d){const m=yn(d);return m==="UndoRedo"?this.undoRedo:O.getItem(m)},this.getPluginName=function(d){return d===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:O.getId(d)},this.getInstance=function(){return s},this.addHook=function(d,m){fe.getSingleton().add(d,m,s)},this.hasHook=function(d){return fe.getSingleton().has(d,s)||fe.getSingleton().has(d)},this.addHookOnce=function(d,m){fe.getSingleton().once(d,m,s)},this.removeHook=function(d,m){fe.getSingleton().remove(d,m,s)},this.runHooks=function(d,m,p,E,M,P,G){return fe.getSingleton().run(s,d,m,p,E,M,P,G)},this.getTranslatedPhrase=function(d,m){return Gx(b.language,d,m)},this.toHTML=()=>_w(this),this.toTableElement=()=>{const d=this.rootDocument.createElement("div");return d.insertAdjacentHTML("afterbegin",_w(this)),d.firstElementChild},this.timeouts=[],this._registerTimeout=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=d;typeof p=="function"&&(p=setTimeout(p,m)),this.timeouts.push(p)},this._clearTimeouts=function(){T(this.timeouts,d=>{clearTimeout(d)})},this.immediates=[],this._registerImmediate=function(d){this.immediates.push(setImmediate(d))},this._clearImmediates=function(){T(this.immediates,d=>{clearImmediate(d)})},this._refreshBorders=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.destroyEditor(d),s.view.render(),m&&$.isSelected()&&h.prepareEditor()},this._getEditorManager=function(){return h},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const R=I4({handleEvent(){return s.isListening()},beforeKeyDown:d=>this.runHooks("beforeKeyDown",d),afterKeyDown:d=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",d)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",d=>{d.ctrlKey===!1&&d.metaKey===!1&&R.releasePressedKeys()}),this.getShortcutManager=function(){return R},this.getFocusManager=function(){return f},mv().forEach(d=>{const m=cc(d);O.addItem(d,new m(this))}),R4(s),R.setActiveContextName("grid"),fe.getSingleton().run(s,"construct")}const x4="hooksRefRegisterer",c1={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){T(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Be(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};vi(c1,"MIXIN_NAME",x4,{writable:!1,enumerable:!1});const H4=c1;function Ar(t,e,n){return e=D4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D4(t){var e=N4(t,"string");return typeof e=="symbol"?e:String(e)}function N4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const L4="base",Kt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Ww="baseEditor";class wl{static get EDITOR_TYPE(){return L4}constructor(e){Ar(this,"hot",void 0),Ar(this,"state",Kt.VIRGIN),Ar(this,"_opened",!1),Ar(this,"_fullEditMode",!1),Ar(this,"_closeCallback",null),Ar(this,"TD",null),Ar(this,"row",null),Ar(this,"col",null),Ar(this,"prop",null),Ar(this,"originalValue",null),Ar(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=Kt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const h=this.hot.getSelectedLast();r=Math.max(Math.min(h[0],h[2]),0),i=Math.max(Math.min(h[1],h[3]),0),o=Math.max(h[0],h[2]),s=Math.max(h[1],h[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>le(this.hot.getSelected()),group:Ww};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Kt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=Kt.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:Nt(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let i;if(r){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),r(l),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(Ww),s.removeShortcutsByGroup(Df),this.state===Kt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Kt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=Kt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=Kt.FINISHED,this.discardEditor(l)}):(this.state=Kt.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=Kt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Kt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Kt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Kt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Kt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Bt(n),a=ut(n),l=Bt(this.hot.rootElement),u=ut(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,f=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,w=o.innerWidth-l.left-u,{wtTable:C}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,S=C.name,b=["master","inline_start"].includes(S)?f:0,_=["master","top","bottom"].includes(S)?g:0,O=s.top===l.top?0:1;let x=s.top-l.top-O-b,I=0;this.hot.isRtl()?I=o.innerWidth-s.left-a-w-1+_:I=s.left-l.left-1-_,["top","top_inline_start_corner"].includes(S)&&(x+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(S)&&(I+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const $=this.hot.hasColHeaders(),z=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),q=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),K=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");($&&z<=0||z===K)&&(x+=1),q<=0&&(I+=1);const te=i.rowsRenderCalculator.startPosition,oe=i.columnsRenderCalculator.startPosition,ie=Math.abs(r.inlineStartOverlay.getScrollPosition()),ue=r.topOverlay.getScrollPosition(),be=Jt(this.hot.rootDocument);let Ue=n.offsetTop;if(["inline_start","master"].includes(S)&&(Ue+=te-ue),["bottom","bottom_inline_start_corner"].includes(S)){const{wtViewport:Q,wtTable:X}=r.bottomOverlay.clone;Ue+=Q.getWorkspaceHeight()-X.getHeight()-be}let Ie=n.offsetLeft;this.hot.isRtl()?(Ie>=0?Ie=C.getWidth()-n.offsetLeft:Ie=Math.abs(Ie),Ie+=oe-ie-a):["top","master","bottom"].includes(S)&&(Ie+=oe-ie);const R=eo(this.TD,this.hot.rootWindow),d=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",m=parseInt(R[d],10)>0?0:1,p=parseInt(R.borderTopWidth,10)>0?0:1,E=ut(n)+m,M=Ot(n)+p,P=vI(c)?be:0,G=SI(h)?be:0,V=this.hot.view.maximumVisibleElementWidth(Ie)-P+m,Z=Math.max(this.hot.view.maximumVisibleElementHeight(Ue)-G+p,23);return{top:x,start:I,height:M,maxHeight:Z,width:E,maxWidth:V}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}dt(wl,H4);function k4(){var t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},e,n=document.body,r=document.createTextNode(""),i=document.createElement("SPAN"),o=function(f,g,w){f.addEventListener(g,w,!1)},s=function(f,g,w){f.removeEventListener(g,w,!1)},a=function(f){var g,w;f?/^[a-zA-Z \.,\\\/\|0-9]$/.test(f)||(f="."):f="",r.textContent!==void 0?r.textContent=e.value+f:r.data=e.value+f,i.style.position="absolute",i.style.fontSize=h(e).fontSize,i.style.fontFamily=h(e).fontFamily,i.style.whiteSpace="pre",n.appendChild(i),g=i.clientWidth+2,n.removeChild(i),e.style.height=t.minHeight+"px",t.minWidth>g?e.style.width=t.minWidth+"px":g>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=g+"px",w=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>w?e.style.height=t.minHeight+"px":t.maxHeight<w?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=w+"px"},l=function(){window.setTimeout(a,0)},u=function(f){if(f&&f.minHeight)if(f.minHeight=="inherit")t.minHeight=e.clientHeight;else{var g=parseInt(f.minHeight);isNaN(g)||(t.minHeight=g)}if(f&&f.maxHeight)if(f.maxHeight=="inherit")t.maxHeight=e.clientHeight;else{var w=parseInt(f.maxHeight);isNaN(w)||(t.maxHeight=w)}if(f&&f.minWidth)if(f.minWidth=="inherit")t.minWidth=e.clientWidth;else{var C=parseInt(f.minWidth);isNaN(C)||(t.minWidth=C)}if(f&&f.maxWidth)if(f.maxWidth=="inherit")t.maxWidth=e.clientWidth;else{var S=parseInt(f.maxWidth);isNaN(S)||(t.maxWidth=S)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))},c=function(f,g,w){e=f,u(g),e.nodeName=="TEXTAREA"&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),w&&(o(e,"change",a),o(e,"cut",l),o(e,"paste",l),o(e,"drop",l),o(e,"keydown",l),o(e,"focus",a),o(e,"compositionstart",l),o(e,"compositionupdate",l),o(e,"compositionend",l)),a()};function h(f){return f.currentStyle||document.defaultView.getComputedStyle(f)}return{init:function(f,g,w){c(f,g,w)},unObserve:function(){s(e,"change",a),s(e,"cut",l),s(e,"paste",l),s(e,"drop",l),s(e,"keydown",l),s(e,"focus",a),s(e,"compositionstart",l),s(e,"compositionupdate",l),s(e,"compositionend",l)},resize:a}}function kE(t,e){const n=tv(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}sc(e,i)}function ss(t,e,n){return e=$4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $4(t){var e=F4(t,"string");return typeof e=="symbol"?e:String(e)}function F4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const W4="ht_editor_visible",th="ht_editor_hidden",$E="textEditor",V4="text";class ea extends wl{static get EDITOR_TYPE(){return V4}constructor(e){super(e),ss(this,"eventManager",new sr(this)),ss(this,"autoResize",k4()),ss(this,"TEXTAREA",void 0),ss(this,"textareaStyle",void 0),ss(this,"TEXTAREA_PARENT",void 0),ss(this,"textareaParentStyle",void 0),ss(this,"layerClass",void 0),this.eventManager=new sr(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",n=>this.onAfterDocumentKeyDown(n)),this.registerShortcuts()}close(){this.autoResize.unObserve(),dI(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&(this.TEXTAREA.value=""),a!==Kt.FINISHED&&this.hideEditableElement()}}beginEditing(e,n){this.state===Kt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),sc(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),ve(this.TEXTAREA,[["data-hot-input",""],dl(-1)]),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[so()]),ee(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),ee(this.TEXTAREA_PARENT,"handsontableInputHolder"),Pe(this.TEXTAREA_PARENT,this.layerClass)&&De(this.TEXTAREA_PARENT,this.layerClass),ee(this.TEXTAREA_PARENT,th),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){DI()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",De(this.TEXTAREA_PARENT,this.layerClass),ee(this.TEXTAREA_PARENT,th)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;pe(e.length-1,r=>{const i=e[r];if(Pe(i,"handsontableEditor"))return n=!0,!1}),Pe(this.TEXTAREA_PARENT,th)&&De(this.TEXTAREA_PARENT,th),n?(this.layerClass=W4,ee(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),ee(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Kt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=eo(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=eo(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),h=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),f=i-c,g=s-h,w=o-c,C=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(f,w),minHeight:Math.min(g,C),maxWidth:w,maxHeight:C},!0)}bindEvents(){uv()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Kt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Kt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>le(this.hot.getSelected()),group:$E},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Tab"]],callback:o=>{const s=this.hot.getSettings(),a=typeof s.tabMoves=="function"?s.tabMoves(o):s.tabMoves;this.hot.selection.transformStart(a.row,a.col,!0)}},{keys:[["Shift","Tab"]],callback:o=>{const s=this.hot.getSettings(),a=typeof s.tabMoves=="function"?s.tabMoves(o):s.tabMoves;this.hot.selection.transformStart(-a.row,-a.col)}},{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;kE(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;kE(a,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}}],r)}unregisterShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");n.removeShortcutsByGroup(Df),n.removeShortcutsByGroup($E),n.removeShortcutsByGroup(Ww)}onAfterDocumentKeyDown(e){[ge.ARROW_UP,ge.ARROW_RIGHT,ge.ARROW_DOWN,ge.ARROW_LEFT].indexOf(e.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}const B4="base";function mc(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&ee(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(RR())):a&&c.push(RR()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(ER())):(u.push(s.invalidCellClassName),a&&c.push(ER()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),De(e,u),ee(e,l),Ko(e,c),ve(e,h)}mc.RENDERER_TYPE=B4;const U4="text";function co(t,e,n,r,i,o,s){mc.apply(this,[t,e,n,r,i,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Nt(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){zr(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else Bo(e,a)}co.RENDERER_TYPE=U4;const z4="text",h1={CELL_TYPE:z4,editor:ea,renderer:co};dr(h1);Oe.editors={BaseEditor:wl};function Oe(t,e){const n=new u1(t,e||{},kv);return n.init(),n}Oe.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new u1(t,e,kv)};Oe.DefaultSettings=n1();Oe.hooks=fe.getSingleton();Oe.CellCoords=Ld;Oe.CellRange=yv;Oe.packageName="handsontable";Oe.buildDate="08/11/2023 09:43:05";Oe.version="14.0.0-next-b24d538-20231108";Oe.languages={dictionaryKeys:hX,getLanguageDictionary:zx,getLanguagesDictionaries:pX,registerLanguageDictionary:Ux,getTranslatedPhrase:Gx};const FE="handsontableEditor",G4="handsontable";class Oy extends ea{static get EDITOR_TYPE(){return G4}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),sc(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions(),this.hot.getSettings().ariaTags&&ve(this.TD,[sn("true")])}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&ve(this.TD,[sn("false")])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Ut(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:FE,relativeToGroup:Df,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),br(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(FE)}}function Y4(t,e,n){j4(t,e),e.set(t,n)}function j4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nh(t,e,n){return e=K4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K4(t){var e=X4(t,"string");return typeof e=="symbol"?e:String(e)}function X4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WE(t,e){var n=q4(t,e,"get");return Z4(t,n)}function q4(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Z4(t,e){return e.get?e.get.call(t):e.value}const Q4="autocomplete";var Sm=new WeakMap;class Py extends Oy{constructor(){super(...arguments),nh(this,"query",null),nh(this,"strippedChoices",[]),nh(this,"rawChoices",[]),Y4(this,Sm,{writable:!0,value:this.hot.guid.slice(0,9)}),nh(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=Cw(Nt(n[c])),r)h=u.indexOf(e);else{const f=this.cellProperties.locale;h=u.toLocaleLowerCase(f).indexOf(e.toLocaleLowerCase(f))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((f,g)=>{if(g.index===-1)return-1;if(f.index===-1)return 1;if(f.index<g.index)return-1;if(g.index<f.index)return 1;if(f.index===g.index){if(f.charsLeft<g.charsLeft)return-1;if(f.charsLeft>g.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return Q4}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),ee(this.htContainer,"autocompleteEditor"),ee(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[Cz(),fz(),fl("listbox"),Rz()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[sn("false"),Ez(`${WE(this,Sm)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=Jt();a===0&&Vu()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[ut(this.TEXTAREA)-2]:void 0,width:e?ut(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,h,f,g,w)=>{co(l,u,c,h,f,g,w);const{filteringCaseSensitive:C,allowHtml:S,locale:b}=this.cellProperties,_=this.query;let O=Nt(g),x,I;O&&!S&&(x=C===!0?O.indexOf(_):O.toLocaleLowerCase(b).indexOf(_.toLocaleLowerCase(b)),x!==-1&&(I=O.substr(x,_.length),O=O.replace(I,`<strong>${I}</strong>`))),n&&ve(u,[gz(),...r?[Az(i)]:[],...r?[Oz(r.indexOf(g)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${h}`]]),u.innerHTML=O},afterSelection:(l,u)=>{if(n){const c=this.htEditor.getCell(l,u,!0);ve(c,[vw()]),ve(this.TEXTAREA,...Tz(c.id))}}}),n&&(ve(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...$r()),ve(this.htEditor.rootElement,[aI(),_z("polite"),Mz("text"),["id",`${WE(this,Sm)}-listbox-${o}-${s}`]]),ve(this.TEXTAREA,...sn("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[sn("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=tv(this.TEXTAREA),r=CI(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,f=l.length;h<f&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(wu([l])),l.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),sc(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=Vs(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const i=Bt(this.TEXTAREA),o=Ot(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=Ot(this.hot.view._wt.wtTable.THEAD),u=Bt(e),c=i.top-u.top-l+a,h=e.scrollHeight-c-l-o,f=s>h&&c>h;return f?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(f?c:h,s),f}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+Jt(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ve(e,o=>Nt(o));return Ve(r,o=>n?o:Cw(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===ge.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===ge.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(NI(e.keyCode)||e.keyCode===ge.BACKSPACE||e.keyCode===ge.DELETE||e.keyCode===ge.INSERT){let n=10;if(e.keyCode===ge.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const J4="checkbox";class d1 extends wl{static get EDITOR_TYPE(){return J4}beginEditing(e,n){if(n&&n.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');Pe(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var f1={exports:{}};const e6=gO(K2);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,e){(function(n,r){var i;{try{i=e6}catch{}t.exports=r(i)}})(Fr,function(n){var r=typeof n=="function",i=!!window.addEventListener,o=window.document,s=window.setTimeout,a=function(R,d,m,p){i?R.addEventListener(d,m,!!p):R.attachEvent("on"+d,m)},l=function(R,d,m,p){i?R.removeEventListener(d,m,!!p):R.detachEvent("on"+d,m)},u=function(R){return R.trim?R.trim():R.replace(/^\s+|\s+$/g,"")},c=function(R,d){return(" "+R.className+" ").indexOf(" "+d+" ")!==-1},h=function(R,d){c(R,d)||(R.className=R.className===""?d:R.className+" "+d)},f=function(R,d){R.className=u((" "+R.className+" ").replace(" "+d+" "," "))},g=function(R){return/Array/.test(Object.prototype.toString.call(R))},w=function(R){return/Date/.test(Object.prototype.toString.call(R))&&!isNaN(R.getTime())},C=function(R){var d=R.getDay();return d===0||d===6},S=function(R){return R%4===0&&R%100!==0||R%400===0},b=function(R,d){return[31,S(R)?29:28,31,30,31,30,31,31,30,31,30,31][d]},_=function(R){w(R)&&R.setHours(0,0,0,0)},O=function(R,d){return R.getTime()===d.getTime()},x=function(R,d,m){var p,E;for(p in d)E=R[p]!==void 0,E&&typeof d[p]=="object"&&d[p]!==null&&d[p].nodeName===void 0?w(d[p])?m&&(R[p]=new Date(d[p].getTime())):g(d[p])?m&&(R[p]=d[p].slice(0)):R[p]=x({},d[p],m):(m||!E)&&(R[p]=d[p]);return R},I=function(R,d,m){var p;o.createEvent?(p=o.createEvent("HTMLEvents"),p.initEvent(d,!0,!1),p=x(p,m),R.dispatchEvent(p)):o.createEventObject&&(p=o.createEventObject(),p=x(p,m),R.fireEvent("on"+d,p))},$=function(R){return R.month<0&&(R.year-=Math.ceil(Math.abs(R.month)/12),R.month+=12),R.month>11&&(R.year+=Math.floor(Math.abs(R.month)/12),R.month-=12),R},z={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},q=function(R,d,m){for(d+=R.firstDay;d>=7;)d-=7;return m?R.i18n.weekdaysShort[d]:R.i18n.weekdays[d]},Y=function(R){var d=[],m="false";if(R.isEmpty)if(R.showDaysInNextAndPreviousMonths)d.push("is-outside-current-month"),R.enableSelectionDaysInNextAndPreviousMonths||d.push("is-selection-disabled");else return'<td class="is-empty"></td>';return R.isDisabled&&d.push("is-disabled"),R.isToday&&d.push("is-today"),R.isSelected&&(d.push("is-selected"),m="true"),R.hasEvent&&d.push("has-event"),R.isInRange&&d.push("is-inrange"),R.isStartRange&&d.push("is-startrange"),R.isEndRange&&d.push("is-endrange"),'<td data-day="'+R.day+'" class="'+d.join(" ")+'" aria-selected="'+m+'"><button class="pika-button pika-day" type="button" data-pika-year="'+R.year+'" data-pika-month="'+R.month+'" data-pika-day="'+R.day+'">'+R.day+"</button></td>"},K=function(R,d){R.setHours(0,0,0,0);var m=R.getDate(),p=R.getDay(),E=d,M=E-1,P=7,G=function(he){return(he+P-1)%P};R.setDate(m+M-G(p));var V=new Date(R.getFullYear(),0,E),Z=24*60*60*1e3,Q=(R.getTime()-V.getTime())/Z,X=1+Math.round((Q-M+G(V.getDay()))/P);return X},te=function(R,d,m,p){var E=new Date(m,d,R),M=r?n(E).isoWeek():K(E,p);return'<td class="pika-week">'+M+"</td>"},oe=function(R,d,m,p){return'<tr class="pika-row'+(m?" pick-whole-week":"")+(p?" is-selected":"")+'">'+(d?R.reverse():R).join("")+"</tr>"},ie=function(R){return"<tbody>"+R.join("")+"</tbody>"},ue=function(R){var d,m=[];for(R.showWeekNumber&&m.push("<th></th>"),d=0;d<7;d++)m.push('<th scope="col"><abbr title="'+q(R,d)+'">'+q(R,d,!0)+"</abbr></th>");return"<thead><tr>"+(R.isRTL?m.reverse():m).join("")+"</tr></thead>"},be=function(R,d,m,p,E,M){var P,G,V,Z=R._o,Q=m===Z.minYear,X=m===Z.maxYear,he='<div id="'+M+'" class="pika-title" role="heading" aria-live="assertive">',Me,Te,_e=!0,j=!0;for(V=[],P=0;P<12;P++)V.push('<option value="'+(m===E?P-d:12+P-d)+'"'+(P===p?' selected="selected"':"")+(Q&&P<Z.minMonth||X&&P>Z.maxMonth?' disabled="disabled"':"")+">"+Z.i18n.months[P]+"</option>");for(Me='<div class="pika-label">'+Z.i18n.months[p]+'<select class="pika-select pika-select-month" tabindex="-1">'+V.join("")+"</select></div>",g(Z.yearRange)?(P=Z.yearRange[0],G=Z.yearRange[1]+1):(P=m-Z.yearRange,G=1+m+Z.yearRange),V=[];P<G&&P<=Z.maxYear;P++)P>=Z.minYear&&V.push('<option value="'+P+'"'+(P===m?' selected="selected"':"")+">"+P+"</option>");return Te='<div class="pika-label">'+m+Z.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+V.join("")+"</select></div>",Z.showMonthAfterYear?he+=Te+Me:he+=Me+Te,Q&&(p===0||Z.minMonth>=p)&&(_e=!1),X&&(p===11||Z.maxMonth<=p)&&(j=!1),d===0&&(he+='<button class="pika-prev'+(_e?"":" is-disabled")+'" type="button">'+Z.i18n.previousMonth+"</button>"),d===R._o.numberOfMonths-1&&(he+='<button class="pika-next'+(j?"":" is-disabled")+'" type="button">'+Z.i18n.nextMonth+"</button>"),he+="</div>"},Ue=function(R,d,m){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+m+'">'+ue(R)+ie(d)+"</table>"},Ie=function(R){var d=this,m=d.config(R);d._onMouseDown=function(E){if(d._v){E=E||window.event;var M=E.target||E.srcElement;if(M)if(c(M,"is-disabled")||(c(M,"pika-button")&&!c(M,"is-empty")&&!c(M.parentNode,"is-disabled")?(d.setDate(new Date(M.getAttribute("data-pika-year"),M.getAttribute("data-pika-month"),M.getAttribute("data-pika-day"))),m.bound&&s(function(){d.hide(),m.blurFieldOnSelect&&m.field&&m.field.blur()},100)):c(M,"pika-prev")?d.prevMonth():c(M,"pika-next")&&d.nextMonth()),c(M,"pika-select"))d._c=!0;else if(E.preventDefault)E.preventDefault();else return E.returnValue=!1,!1}},d._onChange=function(E){E=E||window.event;var M=E.target||E.srcElement;M&&(c(M,"pika-select-month")?d.gotoMonth(M.value):c(M,"pika-select-year")&&d.gotoYear(M.value))},d._onKeyChange=function(E){if(E=E||window.event,d.isVisible())switch(E.keyCode){case 13:case 27:m.field&&m.field.blur();break;case 37:d.adjustDate("subtract",1);break;case 38:d.adjustDate("subtract",7);break;case 39:d.adjustDate("add",1);break;case 40:d.adjustDate("add",7);break;case 8:case 46:d.setDate(null);break}},d._parseFieldValue=function(){if(m.parse)return m.parse(m.field.value,m.format);if(r){var E=n(m.field.value,m.format,m.formatStrict);return E&&E.isValid()?E.toDate():null}else return new Date(Date.parse(m.field.value))},d._onInputChange=function(E){var M;E.firedBy!==d&&(M=d._parseFieldValue(),w(M)&&d.setDate(M),d._v||d.show())},d._onInputFocus=function(){d.show()},d._onInputClick=function(){d.show()},d._onInputBlur=function(){var E=o.activeElement;do if(c(E,"pika-single"))return;while(E=E.parentNode);d._c||(d._b=s(function(){d.hide()},50)),d._c=!1},d._onClick=function(E){E=E||window.event;var M=E.target||E.srcElement,P=M;if(M){!i&&c(M,"pika-select")&&(M.onchange||(M.setAttribute("onchange","return;"),a(M,"change",d._onChange)));do if(c(P,"pika-single")||P===m.trigger)return;while(P=P.parentNode);d._v&&M!==m.trigger&&P!==m.trigger&&d.hide()}},d.el=o.createElement("div"),d.el.className="pika-single"+(m.isRTL?" is-rtl":"")+(m.theme?" "+m.theme:""),a(d.el,"mousedown",d._onMouseDown,!0),a(d.el,"touchend",d._onMouseDown,!0),a(d.el,"change",d._onChange),m.keyboardInput&&a(o,"keydown",d._onKeyChange),m.field&&(m.container?m.container.appendChild(d.el):m.bound?o.body.appendChild(d.el):m.field.parentNode.insertBefore(d.el,m.field.nextSibling),a(m.field,"change",d._onInputChange),m.defaultDate||(m.defaultDate=d._parseFieldValue(),m.setDefaultDate=!0));var p=m.defaultDate;w(p)?m.setDefaultDate?d.setDate(p,!0):d.gotoDate(p):d.gotoDate(new Date),m.bound?(this.hide(),d.el.className+=" is-bound",a(m.trigger,"click",d._onInputClick),a(m.trigger,"focus",d._onInputFocus),a(m.trigger,"blur",d._onInputBlur)):this.show()};return Ie.prototype={config:function(R){this._o||(this._o=x({},z,!0));var d=x(this._o,R,!0);d.isRTL=!!d.isRTL,d.field=d.field&&d.field.nodeName?d.field:null,d.theme=typeof d.theme=="string"&&d.theme?d.theme:null,d.bound=!!(d.bound!==void 0?d.field&&d.bound:d.field),d.trigger=d.trigger&&d.trigger.nodeName?d.trigger:d.field,d.disableWeekends=!!d.disableWeekends,d.disableDayFn=typeof d.disableDayFn=="function"?d.disableDayFn:null;var m=parseInt(d.numberOfMonths,10)||1;if(d.numberOfMonths=m>4?4:m,w(d.minDate)||(d.minDate=!1),w(d.maxDate)||(d.maxDate=!1),d.minDate&&d.maxDate&&d.maxDate<d.minDate&&(d.maxDate=d.minDate=!1),d.minDate&&this.setMinDate(d.minDate),d.maxDate&&this.setMaxDate(d.maxDate),g(d.yearRange)){var p=new Date().getFullYear()-10;d.yearRange[0]=parseInt(d.yearRange[0],10)||p,d.yearRange[1]=parseInt(d.yearRange[1],10)||p}else d.yearRange=Math.abs(parseInt(d.yearRange,10))||z.yearRange,d.yearRange>100&&(d.yearRange=100);return d},toString:function(R){return R=R||this._o.format,w(this._d)?this._o.toString?this._o.toString(this._d,R):r?n(this._d).format(R):this._d.toDateString():""},getMoment:function(){return r?n(this._d):null},setMoment:function(R,d){r&&n.isMoment(R)&&this.setDate(R.toDate(),d)},getDate:function(){return w(this._d)?new Date(this._d.getTime()):null},setDate:function(R,d){if(!R)return this._d=null,this._o.field&&(this._o.field.value="",I(this._o.field,"change",{firedBy:this})),this.draw();if(typeof R=="string"&&(R=new Date(Date.parse(R))),!!w(R)){var m=this._o.minDate,p=this._o.maxDate;w(m)&&R<m?R=m:w(p)&&R>p&&(R=p),this._d=new Date(R.getTime()),_(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),I(this._o.field,"change",{firedBy:this})),!d&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(R){var d=!0;if(w(R)){if(this.calendars){var m=new Date(this.calendars[0].year,this.calendars[0].month,1),p=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),E=R.getTime();p.setMonth(p.getMonth()+1),p.setDate(p.getDate()-1),d=E<m.getTime()||p.getTime()<E}d&&(this.calendars=[{month:R.getMonth(),year:R.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(R,d){var m=this.getDate()||new Date,p=parseInt(d)*24*60*60*1e3,E;R==="add"?E=new Date(m.valueOf()+p):R==="subtract"&&(E=new Date(m.valueOf()-p)),this.setDate(E)},adjustCalendars:function(){this.calendars[0]=$(this.calendars[0]);for(var R=1;R<this._o.numberOfMonths;R++)this.calendars[R]=$({month:this.calendars[0].month+R,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(R){isNaN(R)||(this.calendars[0].month=parseInt(R,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(R){isNaN(R)||(this.calendars[0].year=parseInt(R,10),this.adjustCalendars())},setMinDate:function(R){R instanceof Date?(_(R),this._o.minDate=R,this._o.minYear=R.getFullYear(),this._o.minMonth=R.getMonth()):(this._o.minDate=z.minDate,this._o.minYear=z.minYear,this._o.minMonth=z.minMonth,this._o.startRange=z.startRange),this.draw()},setMaxDate:function(R){R instanceof Date?(_(R),this._o.maxDate=R,this._o.maxYear=R.getFullYear(),this._o.maxMonth=R.getMonth()):(this._o.maxDate=z.maxDate,this._o.maxYear=z.maxYear,this._o.maxMonth=z.maxMonth,this._o.endRange=z.endRange),this.draw()},setStartRange:function(R){this._o.startRange=R},setEndRange:function(R){this._o.endRange=R},draw:function(R){if(!(!this._v&&!R)){var d=this._o,m=d.minYear,p=d.maxYear,E=d.minMonth,M=d.maxMonth,P="",G;this._y<=m&&(this._y=m,!isNaN(E)&&this._m<E&&(this._m=E)),this._y>=p&&(this._y=p,!isNaN(M)&&this._m>M&&(this._m=M));for(var V=0;V<d.numberOfMonths;V++)G="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),P+='<div class="pika-lendar">'+be(this,V,this.calendars[V].year,this.calendars[V].month,this.calendars[0].year,G)+this.render(this.calendars[V].year,this.calendars[V].month,G)+"</div>";this.el.innerHTML=P,d.bound&&d.field.type!=="hidden"&&s(function(){d.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),d.bound&&d.field.setAttribute("aria-label",d.ariaLabel)}},adjustPosition:function(){var R,d,m,p,E,M,P,G,V,Z,Q,X;if(!this._o.container){if(this.el.style.position="absolute",R=this._o.trigger,d=R,m=this.el.offsetWidth,p=this.el.offsetHeight,E=window.innerWidth||o.documentElement.clientWidth,M=window.innerHeight||o.documentElement.clientHeight,P=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,Q=!0,X=!0,typeof R.getBoundingClientRect=="function")Z=R.getBoundingClientRect(),G=Z.left+window.pageXOffset,V=Z.bottom+window.pageYOffset;else for(G=d.offsetLeft,V=d.offsetTop+d.offsetHeight;d=d.offsetParent;)G+=d.offsetLeft,V+=d.offsetTop;(this._o.reposition&&G+m>E||this._o.position.indexOf("right")>-1&&G-m+R.offsetWidth>0)&&(G=G-m+R.offsetWidth,Q=!1),(this._o.reposition&&V+p>M+P||this._o.position.indexOf("top")>-1&&V-p-R.offsetHeight>0)&&(V=V-p-R.offsetHeight,X=!1),this.el.style.left=G+"px",this.el.style.top=V+"px",h(this.el,Q?"left-aligned":"right-aligned"),h(this.el,X?"bottom-aligned":"top-aligned"),f(this.el,Q?"right-aligned":"left-aligned"),f(this.el,X?"top-aligned":"bottom-aligned")}},render:function(R,d,m){var p=this._o,E=new Date,M=b(R,d),P=new Date(R,d,1).getDay(),G=[],V=[];_(E),p.firstDay>0&&(P-=p.firstDay,P<0&&(P+=7));for(var Z=d===0?11:d-1,Q=d===11?0:d+1,X=d===0?R-1:R,he=d===11?R+1:R,Me=b(X,Z),Te=M+P,_e=Te;_e>7;)_e-=7;Te+=7-_e;for(var j=!1,Ye=0,Fe=0;Ye<Te;Ye++){var ye=new Date(R,d,1+(Ye-P)),xe=w(this._d)?O(ye,this._d):!1,Se=O(ye,E),v=p.events.indexOf(ye.toDateString())!==-1,y=Ye<P||Ye>=M+P,A=1+(Ye-P),W=d,H=R,F=p.startRange&&O(p.startRange,ye),D=p.endRange&&O(p.endRange,ye),N=p.startRange&&p.endRange&&p.startRange<ye&&ye<p.endRange,B=p.minDate&&ye<p.minDate||p.maxDate&&ye>p.maxDate||p.disableWeekends&&C(ye)||p.disableDayFn&&p.disableDayFn(ye);y&&(Ye<P?(A=Me+A,W=Z,H=X):(A=A-M,W=Q,H=he));var k={day:A,month:W,year:H,hasEvent:v,isSelected:xe,isToday:Se,isDisabled:B,isEmpty:y,isStartRange:F,isEndRange:D,isInRange:N,showDaysInNextAndPreviousMonths:p.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:p.enableSelectionDaysInNextAndPreviousMonths};p.pickWholeWeek&&xe&&(j=!0),V.push(Y(k)),++Fe===7&&(p.showWeekNumber&&V.unshift(te(Ye-P,d,R,p.firstWeekOfYearMinDays)),G.push(oe(V,p.isRTL,p.pickWholeWeek,j)),V=[],Fe=0,j=!1)}return Ue(p,G,m)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),f(this.el,"is-hidden"),this._o.bound&&(a(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var R=this._v;R!==!1&&(this._o.bound&&l(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),h(this.el,"is-hidden"),this._v=!1,R!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var R=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),R.keyboardInput&&l(o,"keydown",this._onKeyChange),R.field&&(l(R.field,"change",this._onInputChange),R.bound&&(l(R.trigger,"click",this._onInputClick),l(R.trigger,"focus",this._onInputFocus),l(R.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Ie})})(f1);var t6=f1.exports;const VE=cC(t6);function rh(t,e,n){return e=n6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n6(t){var e=r6(t,"string");return typeof e=="symbol"?e:String(e)}function r6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const g1="date",BE="dateEditor";class m1 extends ea{constructor(){super(...arguments),rh(this,"defaultDateFormat","DD/MM/YYYY"),rh(this,"isCellEdited",!1),rh(this,"parentDestroyed",!1),rh(this,"$datePicker",null)}static get EDITOR_TYPE(){return g1}init(){if(typeof J!="function")throw new Error("You need to include moment.js to your project.");if(typeof VE!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),ee(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);const e=new sr(this);e.addEventListener(this.datePicker,"mousedown",n=>{Pe(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()}),e.addEventListener(this.TEXTAREA,"keydown",n=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(n.code)&&n.preventDefault()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),this.hot.getSettings().ariaTags&&ve(this.TD,[sn("true")]),r.addShortcut({keys:[["Enter"]],callback:i=>{i.stopPropagation()},group:BE})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.TD&&this.hot.getSettings().ariaTags&&ve(this.TD,[sn("false")]),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(BE),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const r=this.originalValue;r!==void 0&&this.setValue(r)}super.finishEditing(e,n)}showDatepicker(e){const n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?hv(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new VE(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+n.top+Ot(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=n.right-ut(this.datePicker):a=n.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(s=this.originalValue,J(s,r,!0).isValid()&&this.$datePicker.setMoment(J(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,J(s,r,!0).isValid()&&this.$datePicker.setMoment(J(s,r),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&uc(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=J(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}}const i6="dropdown";class Iy extends Py{static get EDITOR_TYPE(){return i6}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}fe.getSingleton().add("beforeValidate",function(t,e,n){const r=this.getCellMeta(e,this.propToCol(n));r.editor===Iy&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const o6="numeric";class p1 extends ea{static get EDITOR_TYPE(){return o6}}const s6="password";class w1 extends ea{static get EDITOR_TYPE(){return s6}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,zr(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const ym="ht_editor_visible",UE="selectEditor",a6="select";class C1 extends wl{static get EDITOR_TYPE(){return a6}init(){this.select=this.hot.rootDocument.createElement("SELECT"),ee(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Pe(this.select,ym)&&De(this.select,ym),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),zr(this.select),Be(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Qs(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Kt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",ee(this.select,ym)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:UE};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(UE)}}const l6="time";class v1 extends ea{static get EDITOR_TYPE(){return l6}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function u6(){jn(wl),jn(Py),jn(d1),jn(m1),jn(Iy),jn(Oy),jn(p1),jn(w1),jn(C1),jn(ea),jn(v1)}const c6="html";function xy(t,e,n,r,i,o,s){mc.apply(this,[t,e,n,r,i,o,s]),Qs(e,o??"",!1)}xy.RENDERER_TYPE=c6;const h6="autocomplete";function Cl(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?xy:co,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...so()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),ee(e,"htAutocomplete"),c&&e.setAttribute(...fl("listbox")),!t.acArrowListener){const h=new sr(t);t.acArrowListener=function(f){Pe(f.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Cl.RENDERER_TYPE=h6;const zE=new WeakMap,GE=new WeakMap,d6="htBadValue",al="data-row",ll="data-col",f6="checkboxRenderer",S1="checkbox";fe.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===S1){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function Hy(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;mc.apply(this,[t,e,n,r,i,o,s]),g6(t);let u=m6(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),zr(e),o===s.checkedTemplate||Nt(o).toLocaleLowerCase(s.locale)===Nt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Nt(o).toLocaleLowerCase(s.locale)===Nt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Xt(o)?ee(u,"noValue"):(u.style.display="none",ee(u,d6),h=!0),ve(u,[[al,n],[ll,r]]),l&&ve(u,[Wo(u.checked?t.getTranslatedPhrase(dy):t.getTranslatedPhrase(fy)),bz(u.checked),mz()]),!h&&c){let C="";if(c.value)C=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const b=t.getDataAtRowProp(n,c.property);C=b!==null?b:""}const S=p6(a,C,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(S),e.appendChild(u)):(S.appendChild(u),u=S):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(S)):(S.insertBefore(u,S.firstChild),u=S))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),zE.has(t)||(zE.set(t,!0),f());function f(){const S=t.getShortcutManager().getContext("grid"),b={group:f6};S.addShortcuts([{keys:[["space"]],callback:()=>(g(),!w())},{keys:[["enter"]],callback:()=>(g(),!w()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!w()),relativeToGroup:Ay,position:"before"}],b)}function g(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const S=t.getSelectedRange();if(S)for(let b=0;b<S.length;b++){const{row:_,col:O}=S[b].getTopStartCorner(),{row:x,col:I}=S[b].getBottomEndCorner(),$=[];for(let z=_;z<=x;z+=1)for(let q=O;q<=I;q+=1){const Y=t.getCellMeta(z,q);if(Y.type!=="checkbox")return;if(Y.readOnly===!0)continue;typeof Y.checkedTemplate>"u"&&(Y.checkedTemplate=!0),typeof Y.uncheckedTemplate>"u"&&(Y.uncheckedTemplate=!1);const K=t.getDataAtCell(z,q);C===!1?[Y.checkedTemplate,Y.checkedTemplate.toString()].includes(K)?$.push([z,q,Y.uncheckedTemplate]):[Y.uncheckedTemplate,Y.uncheckedTemplate.toString(),null,void 0].includes(K)&&$.push([z,q,Y.checkedTemplate]):$.push([z,q,Y.uncheckedTemplate])}$.length>0&&t.setDataAtCell($)}}function w(){const C=t.getSelectedRange();if(C){for(let S=0;S<C.length;S++){const b=C[S].getTopStartCorner(),_=C[S].getBottomEndCorner();for(let O=b.row;O<=_.row;O++)for(let x=b.col;x<=_.col;x++){const I=t.getCellMeta(O,x);if(I.type!=="checkbox")return!1;const $=t.getCell(O,x);if($==null)return!0;if($.querySelectorAll("input[type=checkbox]").length>0&&!I.readOnly)return!0}}return!1}}}Hy.RENDERER_TYPE=S1;function g6(t){let e=GE.get(t);if(!e){const{rootElement:n}=t;e=new sr(t),e.addEventListener(n,"click",r=>C6(r,t)),e.addEventListener(n,"mouseup",r=>w6(r,t)),e.addEventListener(n,"change",r=>v6(r,t)),GE.set(t,e)}return e}function m6(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function p6(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function w6(t,e){const{target:n}=t;Dy(n)&&(!n.hasAttribute(al)||!n.hasAttribute(ll)||setTimeout(e.listen,10))}function C6(t,e){const{target:n}=t;if(!Dy(n)||!n.hasAttribute(al)||!n.hasAttribute(ll))return;const r=parseInt(n.getAttribute(al),10),i=parseInt(n.getAttribute(ll),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function v6(t,e){const{target:n}=t;if(!Dy(n)||!n.hasAttribute(al)||!n.hasAttribute(ll))return;const r=parseInt(n.getAttribute(al),10),i=parseInt(n.getAttribute(ll),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function Dy(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}function ih(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var y1={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(u,c){if(!i[u]){if(!r[u]){var h=typeof ih=="function"&&ih;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var g=i[u]={exports:{}};r[u][0].call(g.exports,function(w){return s(r[u][1][w]||w)},g,g.exports,n,r,i,o)}return i[u].exports}for(var a=typeof ih=="function"&&ih,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",f=1e14,g=14,w=9007199254740991,C=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],S=1e7,b=1e9;function _(Y){var K=0|Y;return 0<Y||Y===K?K:K-1}function O(Y){for(var K,te,oe=1,ie=Y.length,ue=Y[0]+"";oe<ie;){for(K=Y[oe++]+"",te=g-K.length;te--;K="0"+K);ue+=K}for(ie=ue.length;ue.charCodeAt(--ie)===48;);return ue.slice(0,ie+1||1)}function x(Y,K){var te,oe,ie=Y.c,ue=K.c,be=Y.s,Ue=K.s,Ie=Y.e,R=K.e;if(!be||!Ue)return null;if(te=ie&&!ie[0],oe=ue&&!ue[0],te||oe)return te?oe?0:-Ue:be;if(be!=Ue)return be;if(te=be<0,oe=Ie==R,!ie||!ue)return oe?0:!ie^te?1:-1;if(!oe)return R<Ie^te?1:-1;for(Ue=(Ie=ie.length)<(R=ue.length)?Ie:R,be=0;be<Ue;be++)if(ie[be]!=ue[be])return ie[be]>ue[be]^te?1:-1;return Ie==R?0:R<Ie^te?1:-1}function I(Y,K,te,oe){if(Y<K||te<Y||Y!==(Y<0?l(Y):u(Y)))throw Error(c+(oe||"Argument")+(typeof Y=="number"?Y<K||te<Y?" out of range: ":" not an integer: ":" not a primitive number: ")+String(Y))}function $(Y){var K=Y.c.length-1;return _(Y.e/g)==K&&Y.c[K]%2!=0}function z(Y,K){return(1<Y.length?Y.charAt(0)+"."+Y.slice(1):Y)+(K<0?"e":"e+")+K}function q(Y,K,te){var oe,ie;if(K<0){for(ie=te+".";++K;ie+=te);Y=ie+Y}else if(++K>(oe=Y.length)){for(ie=te,K-=oe;--K;ie+=te);Y+=ie}else K<oe&&(Y=Y.slice(0,K)+"."+Y.slice(K));return Y}(s=function Y(K){var te,oe,ie,ue,be,Ue,Ie,R,d,m,p=j.prototype={constructor:j,toString:null,valueOf:null},E=new j(1),M=20,P=4,G=-7,V=21,Z=-1e7,Q=1e7,X=!1,he=1,Me=0,Te={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},_e="0123456789abcdefghijklmnopqrstuvwxyz";function j(v,y){var A,W,H,F,D,N,B,k,U=this;if(!(U instanceof j))return new j(v,y);if(y==null){if(v instanceof j)return U.s=v.s,U.e=v.e,void(U.c=(v=v.c)?v.slice():v);if((N=typeof v=="number")&&0*v==0){if(U.s=1/v<0?(v=-v,-1):1,v===~~v){for(F=0,D=v;10<=D;D/=10,F++);return U.e=F,void(U.c=[v])}k=String(v)}else{if(k=String(v),!a.test(k))return ie(U,k,N);U.s=k.charCodeAt(0)==45?(k=k.slice(1),-1):1}-1<(F=k.indexOf("."))&&(k=k.replace(".","")),0<(D=k.search(/e/i))?(F<0&&(F=D),F+=+k.slice(D+1),k=k.substring(0,D)):F<0&&(F=k.length)}else{if(I(y,2,_e.length,"Base"),k=String(v),y==10)return xe(U=new j(v instanceof j?v:k),M+U.e+1,P);if(N=typeof v=="number"){if(0*v!=0)return ie(U,k,N,y);if(U.s=1/v<0?(k=k.slice(1),-1):1,j.DEBUG&&15<k.replace(/^0\.0*|\./,"").length)throw Error(h+v);N=!1}else U.s=k.charCodeAt(0)===45?(k=k.slice(1),-1):1;for(A=_e.slice(0,y),F=D=0,B=k.length;D<B;D++)if(A.indexOf(W=k.charAt(D))<0){if(W=="."){if(F<D){F=B;continue}}else if(!H&&(k==k.toUpperCase()&&(k=k.toLowerCase())||k==k.toLowerCase()&&(k=k.toUpperCase()))){H=!0,D=-1,F=0;continue}return ie(U,String(v),N,y)}-1<(F=(k=oe(k,y,10,U.s)).indexOf("."))?k=k.replace(".",""):F=k.length}for(D=0;k.charCodeAt(D)===48;D++);for(B=k.length;k.charCodeAt(--B)===48;);if(k=k.slice(D,++B)){if(B-=D,N&&j.DEBUG&&15<B&&(w<v||v!==u(v)))throw Error(h+U.s*v);if(Q<(F=F-D-1))U.c=U.e=null;else if(F<Z)U.c=[U.e=0];else{if(U.e=F,U.c=[],D=(F+1)%g,F<0&&(D+=g),D<B){for(D&&U.c.push(+k.slice(0,D)),B-=g;D<B;)U.c.push(+k.slice(D,D+=g));k=k.slice(D),D=g-k.length}else D-=B;for(;D--;k+="0");U.c.push(+k)}}else U.c=[U.e=0]}function Ye(v,y,A,W){var H,F,D,N,B;if(A==null?A=P:I(A,0,8),!v.c)return v.toString();if(H=v.c[0],D=v.e,y==null)B=O(v.c),B=W==1||W==2&&(D<=G||V<=D)?z(B,D):q(B,D,"0");else if(F=(v=xe(new j(v),y,A)).e,N=(B=O(v.c)).length,W==1||W==2&&(y<=F||F<=G)){for(;N<y;B+="0",N++);B=z(B,F)}else if(y-=D,B=q(B,F,"0"),N<F+1){if(0<--y)for(B+=".";y--;B+="0");}else if(0<(y+=F-N))for(F+1==N&&(B+=".");y--;B+="0");return v.s<0&&H?"-"+B:B}function Fe(v,y){for(var A,W=1,H=new j(v[0]);W<v.length;W++){if(!(A=new j(v[W])).s){H=A;break}y.call(H,A)&&(H=A)}return H}function ye(v,y,A){for(var W=1,H=y.length;!y[--H];y.pop());for(H=y[0];10<=H;H/=10,W++);return(A=W+A*g-1)>Q?v.c=v.e=null:v.c=A<Z?[v.e=0]:(v.e=A,y),v}function xe(v,y,A,W){var H,F,D,N,B,k,U,se=v.c,de=C;if(se){e:{for(H=1,N=se[0];10<=N;N/=10,H++);if((F=y-H)<0)F+=g,D=y,U=(B=se[k=0])/de[H-D-1]%10|0;else if((k=l((F+1)/g))>=se.length){if(!W)break e;for(;se.length<=k;se.push(0));B=U=0,D=(F%=g)-g+(H=1)}else{for(B=N=se[k],H=1;10<=N;N/=10,H++);U=(D=(F%=g)-g+H)<0?0:B/de[H-D-1]%10|0}if(W=W||y<0||se[k+1]!=null||(D<0?B:B%de[H-D-1]),W=A<4?(U||W)&&(A==0||A==(v.s<0?3:2)):5<U||U==5&&(A==4||W||A==6&&(0<F?0<D?B/de[H-D]:0:se[k-1])%10&1||A==(v.s<0?8:7)),y<1||!se[0])return se.length=0,W?(y-=v.e+1,se[0]=de[(g-y%g)%g],v.e=-y||0):se[0]=v.e=0,v;if(F==0?(se.length=k,N=1,k--):(se.length=k+1,N=de[g-F],se[k]=0<D?u(B/de[H-D]%de[D])*N:0),W)for(;;){if(k==0){for(F=1,D=se[0];10<=D;D/=10,F++);for(D=se[0]+=N,N=1;10<=D;D/=10,N++);F!=N&&(v.e++,se[0]==f&&(se[0]=1));break}if(se[k]+=N,se[k]!=f)break;se[k--]=0,N=1}for(F=se.length;se[--F]===0;se.pop());}v.e>Q?v.c=v.e=null:v.e<Z&&(v.c=[v.e=0])}return v}function Se(v){var y,A=v.e;return A===null?v.toString():(y=O(v.c),y=A<=G||V<=A?z(y,A):q(y,A,"0"),v.s<0?"-"+y:y)}return j.clone=Y,j.ROUND_UP=0,j.ROUND_DOWN=1,j.ROUND_CEIL=2,j.ROUND_FLOOR=3,j.ROUND_HALF_UP=4,j.ROUND_HALF_DOWN=5,j.ROUND_HALF_EVEN=6,j.ROUND_HALF_CEIL=7,j.ROUND_HALF_FLOOR=8,j.EUCLID=9,j.config=j.set=function(v){var y,A;if(v!=null){if(typeof v!="object")throw Error(c+"Object expected: "+v);if(v.hasOwnProperty(y="DECIMAL_PLACES")&&(I(A=v[y],0,b,y),M=A),v.hasOwnProperty(y="ROUNDING_MODE")&&(I(A=v[y],0,8,y),P=A),v.hasOwnProperty(y="EXPONENTIAL_AT")&&((A=v[y])&&A.pop?(I(A[0],-b,0,y),I(A[1],0,b,y),G=A[0],V=A[1]):(I(A,-b,b,y),G=-(V=A<0?-A:A))),v.hasOwnProperty(y="RANGE"))if((A=v[y])&&A.pop)I(A[0],-b,-1,y),I(A[1],1,b,y),Z=A[0],Q=A[1];else{if(I(A,-b,b,y),!A)throw Error(c+y+" cannot be zero: "+A);Z=-(Q=A<0?-A:A)}if(v.hasOwnProperty(y="CRYPTO")){if((A=v[y])!==!!A)throw Error(c+y+" not true or false: "+A);if(A){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw X=!A,Error(c+"crypto unavailable");X=A}else X=A}if(v.hasOwnProperty(y="MODULO_MODE")&&(I(A=v[y],0,9,y),he=A),v.hasOwnProperty(y="POW_PRECISION")&&(I(A=v[y],0,b,y),Me=A),v.hasOwnProperty(y="FORMAT")){if(typeof(A=v[y])!="object")throw Error(c+y+" not an object: "+A);Te=A}if(v.hasOwnProperty(y="ALPHABET")){if(typeof(A=v[y])!="string"||/^.$|[+-.\s]|(.).*\1/.test(A))throw Error(c+y+" invalid: "+A);_e=A}}return{DECIMAL_PLACES:M,ROUNDING_MODE:P,EXPONENTIAL_AT:[G,V],RANGE:[Z,Q],CRYPTO:X,MODULO_MODE:he,POW_PRECISION:Me,FORMAT:Te,ALPHABET:_e}},j.isBigNumber=function(v){return v instanceof j||v&&v._isBigNumber===!0||!1},j.maximum=j.max=function(){return Fe(arguments,p.lt)},j.minimum=j.min=function(){return Fe(arguments,p.gt)},j.random=(ue=9007199254740992,be=Math.random()*ue&2097151?function(){return u(Math.random()*ue)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(v){var y,A,W,H,F,D=0,N=[],B=new j(E);if(v==null?v=M:I(v,0,b),H=l(v/g),X)if(crypto.getRandomValues){for(y=crypto.getRandomValues(new Uint32Array(H*=2));D<H;)9e15<=(F=131072*y[D]+(y[D+1]>>>11))?(A=crypto.getRandomValues(new Uint32Array(2)),y[D]=A[0],y[D+1]=A[1]):(N.push(F%1e14),D+=2);D=H/2}else{if(!crypto.randomBytes)throw X=!1,Error(c+"crypto unavailable");for(y=crypto.randomBytes(H*=7);D<H;)9e15<=(F=281474976710656*(31&y[D])+1099511627776*y[D+1]+4294967296*y[D+2]+16777216*y[D+3]+(y[D+4]<<16)+(y[D+5]<<8)+y[D+6])?crypto.randomBytes(7).copy(y,D):(N.push(F%1e14),D+=7);D=H/7}if(!X)for(;D<H;)(F=be())<9e15&&(N[D++]=F%1e14);for(H=N[--D],v%=g,H&&v&&(F=C[g-v],N[D]=u(H/F)*F);N[D]===0;N.pop(),D--);if(D<0)N=[W=0];else{for(W=-1;N[0]===0;N.splice(0,1),W-=g);for(D=1,F=N[0];10<=F;F/=10,D++);D<g&&(W-=g-D)}return B.e=W,B.c=N,B}),j.sum=function(){for(var v=1,y=arguments,A=new j(y[0]);v<y.length;)A=A.plus(y[v++]);return A},oe=function(){var v="0123456789";function y(A,W,H,F){for(var D,N,B=[0],k=0,U=A.length;k<U;){for(N=B.length;N--;B[N]*=W);for(B[0]+=F.indexOf(A.charAt(k++)),D=0;D<B.length;D++)B[D]>H-1&&(B[D+1]==null&&(B[D+1]=0),B[D+1]+=B[D]/H|0,B[D]%=H)}return B.reverse()}return function(A,W,H,F,D){var N,B,k,U,se,de,Ce,Ae,ke=A.indexOf("."),wt=M,Xe=P;for(0<=ke&&(U=Me,Me=0,A=A.replace(".",""),de=(Ae=new j(W)).pow(A.length-ke),Me=U,Ae.c=y(q(O(de.c),de.e,"0"),10,H,v),Ae.e=Ae.c.length),k=U=(Ce=y(A,W,H,D?(N=_e,v):(N=v,_e))).length;Ce[--U]==0;Ce.pop());if(!Ce[0])return N.charAt(0);if(ke<0?--k:(de.c=Ce,de.e=k,de.s=F,Ce=(de=te(de,Ae,wt,Xe,H)).c,se=de.r,k=de.e),ke=Ce[B=k+wt+1],U=H/2,se=se||B<0||Ce[B+1]!=null,se=Xe<4?(ke!=null||se)&&(Xe==0||Xe==(de.s<0?3:2)):U<ke||ke==U&&(Xe==4||se||Xe==6&&1&Ce[B-1]||Xe==(de.s<0?8:7)),B<1||!Ce[0])A=se?q(N.charAt(1),-wt,N.charAt(0)):N.charAt(0);else{if(Ce.length=B,se)for(--H;++Ce[--B]>H;)Ce[B]=0,B||(++k,Ce=[1].concat(Ce));for(U=Ce.length;!Ce[--U];);for(ke=0,A="";ke<=U;A+=N.charAt(Ce[ke++]));A=q(A,k,N.charAt(0))}return A}}(),te=function(){function v(W,H,F){var D,N,B,k,U=0,se=W.length,de=H%S,Ce=H/S|0;for(W=W.slice();se--;)U=((N=de*(B=W[se]%S)+(D=Ce*B+(k=W[se]/S|0)*de)%S*S+U)/F|0)+(D/S|0)+Ce*k,W[se]=N%F;return U&&(W=[U].concat(W)),W}function y(W,H,F,D){var N,B;if(F!=D)B=D<F?1:-1;else for(N=B=0;N<F;N++)if(W[N]!=H[N]){B=W[N]>H[N]?1:-1;break}return B}function A(W,H,F,D){for(var N=0;F--;)W[F]-=N,N=W[F]<H[F]?1:0,W[F]=N*D+W[F]-H[F];for(;!W[0]&&1<W.length;W.splice(0,1));}return function(W,H,F,D,N){var B,k,U,se,de,Ce,Ae,ke,wt,Xe,at,Rt,ia,yl,kt,an,Zo,_n=W.s==H.s?1:-1,qt=W.c,Ct=H.c;if(!(qt&&qt[0]&&Ct&&Ct[0]))return new j(W.s&&H.s&&(qt?!Ct||qt[0]!=Ct[0]:Ct)?qt&&qt[0]==0||!Ct?0*_n:_n/0:NaN);for(wt=(ke=new j(_n)).c=[],_n=F+(k=W.e-H.e)+1,N||(N=f,k=_(W.e/g)-_(H.e/g),_n=_n/g|0),U=0;Ct[U]==(qt[U]||0);U++);if(Ct[U]>(qt[U]||0)&&k--,_n<0)wt.push(1),se=!0;else{for(yl=qt.length,an=Ct.length,_n+=2,1<(de=u(N/(Ct[U=0]+1)))&&(Ct=v(Ct,de,N),qt=v(qt,de,N),an=Ct.length,yl=qt.length),ia=an,at=(Xe=qt.slice(0,an)).length;at<an;Xe[at++]=0);Zo=Ct.slice(),Zo=[0].concat(Zo),kt=Ct[0],Ct[1]>=N/2&&kt++;do{if(de=0,(B=y(Ct,Xe,an,at))<0){if(Rt=Xe[0],an!=at&&(Rt=Rt*N+(Xe[1]||0)),1<(de=u(Rt/kt)))for(N<=de&&(de=N-1),Ae=(Ce=v(Ct,de,N)).length,at=Xe.length;y(Ce,Xe,Ae,at)==1;)de--,A(Ce,an<Ae?Zo:Ct,Ae,N),Ae=Ce.length,B=1;else de==0&&(B=de=1),Ae=(Ce=Ct.slice()).length;if(Ae<at&&(Ce=[0].concat(Ce)),A(Xe,Ce,at,N),at=Xe.length,B==-1)for(;y(Ct,Xe,an,at)<1;)de++,A(Xe,an<at?Zo:Ct,at,N),at=Xe.length}else B===0&&(de++,Xe=[0]);wt[U++]=de,Xe[0]?Xe[at++]=qt[ia]||0:(Xe=[qt[ia]],at=1)}while((ia++<yl||Xe[0]!=null)&&_n--);se=Xe[0]!=null,wt[0]||wt.splice(0,1)}if(N==f){for(U=1,_n=wt[0];10<=_n;_n/=10,U++);xe(ke,F+(ke.e=U+k*g-1)+1,D,se)}else ke.e=k,ke.r=+se;return ke}}(),Ue=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Ie=/^([^.]+)\.$/,R=/^\.([^.]+)$/,d=/^-?(Infinity|NaN)$/,m=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ie=function(v,y,A,W){var H,F=A?y:y.replace(m,"");if(d.test(F))v.s=isNaN(F)?null:F<0?-1:1,v.c=v.e=null;else{if(!A&&(F=F.replace(Ue,function(D,N,B){return H=(B=B.toLowerCase())=="x"?16:B=="b"?2:8,W&&W!=H?D:N}),W&&(H=W,F=F.replace(Ie,"$1").replace(R,"0.$1")),y!=F))return new j(F,H);if(j.DEBUG)throw Error(c+"Not a"+(W?" base "+W:"")+" number: "+y);v.c=v.e=v.s=null}},p.absoluteValue=p.abs=function(){var v=new j(this);return v.s<0&&(v.s=1),v},p.comparedTo=function(v,y){return x(this,new j(v,y))},p.decimalPlaces=p.dp=function(v,y){var A,W,H;if(v!=null)return I(v,0,b),y==null?y=P:I(y,0,8),xe(new j(this),v+this.e+1,y);if(!(A=this.c))return null;if(W=((H=A.length-1)-_(this.e/g))*g,H=A[H])for(;H%10==0;H/=10,W--);return W<0&&(W=0),W},p.dividedBy=p.div=function(v,y){return te(this,new j(v,y),M,P)},p.dividedToIntegerBy=p.idiv=function(v,y){return te(this,new j(v,y),0,1)},p.exponentiatedBy=p.pow=function(v,y){var A,W,H,F,D,N,B,k,U=this;if((v=new j(v)).c&&!v.isInteger())throw Error(c+"Exponent not an integer: "+Se(v));if(y!=null&&(y=new j(y)),D=14<v.e,!U.c||!U.c[0]||U.c[0]==1&&!U.e&&U.c.length==1||!v.c||!v.c[0])return k=new j(Math.pow(+Se(U),D?2-$(v):+Se(v))),y?k.mod(y):k;if(N=v.s<0,y){if(y.c?!y.c[0]:!y.s)return new j(NaN);(W=!N&&U.isInteger()&&y.isInteger())&&(U=U.mod(y))}else{if(9<v.e&&(0<U.e||U.e<-1||(U.e==0?1<U.c[0]||D&&24e7<=U.c[1]:U.c[0]<8e13||D&&U.c[0]<=9999975e7)))return F=U.s<0&&$(v)?-0:0,-1<U.e&&(F=1/F),new j(N?1/F:F);Me&&(F=l(Me/g+2))}for(B=D?(A=new j(.5),N&&(v.s=1),$(v)):(H=Math.abs(+Se(v)))%2,k=new j(E);;){if(B){if(!(k=k.times(U)).c)break;F?k.c.length>F&&(k.c.length=F):W&&(k=k.mod(y))}if(H){if((H=u(H/2))===0)break;B=H%2}else if(xe(v=v.times(A),v.e+1,1),14<v.e)B=$(v);else{if((H=+Se(v))==0)break;B=H%2}U=U.times(U),F?U.c&&U.c.length>F&&(U.c.length=F):W&&(U=U.mod(y))}return W?k:(N&&(k=E.div(k)),y?k.mod(y):F?xe(k,Me,P,void 0):k)},p.integerValue=function(v){var y=new j(this);return v==null?v=P:I(v,0,8),xe(y,y.e+1,v)},p.isEqualTo=p.eq=function(v,y){return x(this,new j(v,y))===0},p.isFinite=function(){return!!this.c},p.isGreaterThan=p.gt=function(v,y){return 0<x(this,new j(v,y))},p.isGreaterThanOrEqualTo=p.gte=function(v,y){return(y=x(this,new j(v,y)))===1||y===0},p.isInteger=function(){return!!this.c&&_(this.e/g)>this.c.length-2},p.isLessThan=p.lt=function(v,y){return x(this,new j(v,y))<0},p.isLessThanOrEqualTo=p.lte=function(v,y){return(y=x(this,new j(v,y)))===-1||y===0},p.isNaN=function(){return!this.s},p.isNegative=function(){return this.s<0},p.isPositive=function(){return 0<this.s},p.isZero=function(){return!!this.c&&this.c[0]==0},p.minus=function(v,y){var A,W,H,F,D=this,N=D.s;if(y=(v=new j(v,y)).s,!N||!y)return new j(NaN);if(N!=y)return v.s=-y,D.plus(v);var B=D.e/g,k=v.e/g,U=D.c,se=v.c;if(!B||!k){if(!U||!se)return U?(v.s=-y,v):new j(se?D:NaN);if(!U[0]||!se[0])return se[0]?(v.s=-y,v):new j(U[0]?D:P==3?-0:0)}if(B=_(B),k=_(k),U=U.slice(),N=B-k){for((H=(F=N<0)?(N=-N,U):(k=B,se)).reverse(),y=N;y--;H.push(0));H.reverse()}else for(W=(F=(N=U.length)<(y=se.length))?N:y,N=y=0;y<W;y++)if(U[y]!=se[y]){F=U[y]<se[y];break}if(F&&(H=U,U=se,se=H,v.s=-v.s),0<(y=(W=se.length)-(A=U.length)))for(;y--;U[A++]=0);for(y=f-1;N<W;){if(U[--W]<se[W]){for(A=W;A&&!U[--A];U[A]=y);--U[A],U[W]+=f}U[W]-=se[W]}for(;U[0]==0;U.splice(0,1),--k);return U[0]?ye(v,U,k):(v.s=P==3?-1:1,v.c=[v.e=0],v)},p.modulo=p.mod=function(v,y){var A,W,H=this;return v=new j(v,y),!H.c||!v.s||v.c&&!v.c[0]?new j(NaN):!v.c||H.c&&!H.c[0]?new j(H):(he==9?(W=v.s,v.s=1,A=te(H,v,0,3),v.s=W,A.s*=W):A=te(H,v,0,he),(v=H.minus(A.times(v))).c[0]||he!=1||(v.s=H.s),v)},p.multipliedBy=p.times=function(v,y){var A,W,H,F,D,N,B,k,U,se,de,Ce,Ae,ke,wt,Xe=this,at=Xe.c,Rt=(v=new j(v,y)).c;if(!(at&&Rt&&at[0]&&Rt[0]))return!Xe.s||!v.s||at&&!at[0]&&!Rt||Rt&&!Rt[0]&&!at?v.c=v.e=v.s=null:(v.s*=Xe.s,at&&Rt?(v.c=[0],v.e=0):v.c=v.e=null),v;for(W=_(Xe.e/g)+_(v.e/g),v.s*=Xe.s,(B=at.length)<(se=Rt.length)&&(Ae=at,at=Rt,Rt=Ae,H=B,B=se,se=H),H=B+se,Ae=[];H--;Ae.push(0));for(ke=f,wt=S,H=se;0<=--H;){for(A=0,de=Rt[H]%wt,Ce=Rt[H]/wt|0,F=H+(D=B);H<F;)A=((k=de*(k=at[--D]%wt)+(N=Ce*k+(U=at[D]/wt|0)*de)%wt*wt+Ae[F]+A)/ke|0)+(N/wt|0)+Ce*U,Ae[F--]=k%ke;Ae[F]=A}return A?++W:Ae.splice(0,1),ye(v,Ae,W)},p.negated=function(){var v=new j(this);return v.s=-v.s||null,v},p.plus=function(v,y){var A,W=this,H=W.s;if(y=(v=new j(v,y)).s,!H||!y)return new j(NaN);if(H!=y)return v.s=-y,W.minus(v);var F=W.e/g,D=v.e/g,N=W.c,B=v.c;if(!F||!D){if(!N||!B)return new j(H/0);if(!N[0]||!B[0])return B[0]?v:new j(N[0]?W:0*H)}if(F=_(F),D=_(D),N=N.slice(),H=F-D){for((A=0<H?(D=F,B):(H=-H,N)).reverse();H--;A.push(0));A.reverse()}for((H=N.length)-(y=B.length)<0&&(A=B,B=N,N=A,y=H),H=0;y;)H=(N[--y]=N[y]+B[y]+H)/f|0,N[y]=f===N[y]?0:N[y]%f;return H&&(N=[H].concat(N),++D),ye(v,N,D)},p.precision=p.sd=function(v,y){var A,W,H;if(v!=null&&v!==!!v)return I(v,1,b),y==null?y=P:I(y,0,8),xe(new j(this),v,y);if(!(A=this.c))return null;if(W=(H=A.length-1)*g+1,H=A[H]){for(;H%10==0;H/=10,W--);for(H=A[0];10<=H;H/=10,W++);}return v&&this.e+1>W&&(W=this.e+1),W},p.shiftedBy=function(v){return I(v,-w,w),this.times("1e"+v)},p.squareRoot=p.sqrt=function(){var v,y,A,W,H,F=this,D=F.c,N=F.s,B=F.e,k=M+4,U=new j("0.5");if(N!==1||!D||!D[0])return new j(!N||N<0&&(!D||D[0])?NaN:D?F:1/0);if((A=(N=Math.sqrt(+Se(F)))==0||N==1/0?(((y=O(D)).length+B)%2==0&&(y+="0"),N=Math.sqrt(+y),B=_((B+1)/2)-(B<0||B%2),new j(y=N==1/0?"1e"+B:(y=N.toExponential()).slice(0,y.indexOf("e")+1)+B)):new j(N+"")).c[0]){for((N=(B=A.e)+k)<3&&(N=0);;)if(H=A,A=U.times(H.plus(te(F,H,k,1))),O(H.c).slice(0,N)===(y=O(A.c)).slice(0,N)){if(A.e<B&&--N,(y=y.slice(N-3,N+1))!="9999"&&(W||y!="4999")){+y&&(+y.slice(1)||y.charAt(0)!="5")||(xe(A,A.e+M+2,1),v=!A.times(A).eq(F));break}if(!W&&(xe(H,H.e+M+2,0),H.times(H).eq(F))){A=H;break}k+=4,N+=4,W=1}}return xe(A,A.e+M+1,P,v)},p.toExponential=function(v,y){return v!=null&&(I(v,0,b),v++),Ye(this,v,y,1)},p.toFixed=function(v,y){return v!=null&&(I(v,0,b),v=v+this.e+1),Ye(this,v,y)},p.toFormat=function(v,y,A){var W;if(A==null)v!=null&&y&&typeof y=="object"?(A=y,y=null):v&&typeof v=="object"?(A=v,v=y=null):A=Te;else if(typeof A!="object")throw Error(c+"Argument not an object: "+A);if(W=this.toFixed(v,y),this.c){var H,F=W.split("."),D=+A.groupSize,N=+A.secondaryGroupSize,B=A.groupSeparator||"",k=F[0],U=F[1],se=this.s<0,de=se?k.slice(1):k,Ce=de.length;if(N&&(H=D,D=N,Ce-=N=H),0<D&&0<Ce){for(H=Ce%D||D,k=de.substr(0,H);H<Ce;H+=D)k+=B+de.substr(H,D);0<N&&(k+=B+de.slice(H)),se&&(k="-"+k)}W=U?k+(A.decimalSeparator||"")+((N=+A.fractionGroupSize)?U.replace(new RegExp("\\d{"+N+"}\\B","g"),"$&"+(A.fractionGroupSeparator||"")):U):k}return(A.prefix||"")+W+(A.suffix||"")},p.toFraction=function(v){var y,A,W,H,F,D,N,B,k,U,se,de,Ce=this,Ae=Ce.c;if(v!=null&&(!(N=new j(v)).isInteger()&&(N.c||N.s!==1)||N.lt(E)))throw Error(c+"Argument "+(N.isInteger()?"out of range: ":"not an integer: ")+Se(N));if(!Ae)return new j(Ce);for(y=new j(E),k=A=new j(E),W=B=new j(E),de=O(Ae),F=y.e=de.length-Ce.e-1,y.c[0]=C[(D=F%g)<0?g+D:D],v=!v||0<N.comparedTo(y)?0<F?y:k:N,D=Q,Q=1/0,N=new j(de),B.c[0]=0;U=te(N,y,0,1),(H=A.plus(U.times(W))).comparedTo(v)!=1;)A=W,W=H,k=B.plus(U.times(H=k)),B=H,y=N.minus(U.times(H=y)),N=H;return H=te(v.minus(A),W,0,1),B=B.plus(H.times(k)),A=A.plus(H.times(W)),B.s=k.s=Ce.s,se=te(k,W,F*=2,P).minus(Ce).abs().comparedTo(te(B,A,F,P).minus(Ce).abs())<1?[k,W]:[B,A],Q=D,se},p.toNumber=function(){return+Se(this)},p.toPrecision=function(v,y){return v!=null&&I(v,1,b),Ye(this,v,y,2)},p.toString=function(v){var y,A=this,W=A.s,H=A.e;return H===null?W?(y="Infinity",W<0&&(y="-"+y)):y="NaN":(y=v==null?H<=G||V<=H?z(O(A.c),H):q(O(A.c),H,"0"):v===10?q(O((A=xe(new j(A),M+H+1,P)).c),A.e,"0"):(I(v,2,_e.length,"Base"),oe(q(O(A.c),H,"0"),10,v,W,!0)),W<0&&A.c[0]&&(y="-"+y)),y},p.valueOf=p.toJSON=function(){return Se(this)},p._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(p[Symbol.toStringTag]="BigNumber",p[Symbol.for("nodejs.util.inspect.custom")]=p.valueOf),K!=null&&j.set(K),j}()).default=s.BigNumber=s,r!==void 0&&r.exports?r.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(n,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,r,i){function o(_,O){return function(x){if(Array.isArray(x))return x}(_)||function(x,I){var $=[],z=!0,q=!1,Y=void 0;try{for(var K,te=x[Symbol.iterator]();!(z=(K=te.next()).done)&&($.push(K.value),!I||$.length!==I);z=!0);}catch(oe){q=!0,Y=oe}finally{try{z||te.return==null||te.return()}finally{if(q)throw Y}}return $}(_,O)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=n("./globalState"),a=n("./validating"),l=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function f(_){var O=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},x=2<arguments.length?arguments[2]:void 0;if(typeof O=="string"&&(O=l.parseFormat(O)),!a.validateFormat(O))return"ERROR: invalid format";var I=O.prefix||"",$=O.postfix||"",z=function(q,Y,K){switch(Y.output){case"currency":return Y=b(Y,s.currentCurrencyDefaultFormat()),function(_e,j,Ye){var Fe=Ye.currentCurrency(),ye=Object.assign({},h,j),xe=void 0,Se="",v=!!ye.totalLength||!!ye.forceAverage||ye.average,y=j.currencyPosition||Fe.position,A=j.currencySymbol||Fe.symbol;ye.spaceSeparated&&(Se=" "),y==="infix"&&(xe=Se+A+Se);var W=S({instance:_e,providedFormat:j,state:Ye,decimalSeparator:xe});return y==="prefix"&&(W=_e._value<0&&ye.negative==="sign"?"-".concat(Se).concat(A).concat(W.slice(1)):A+Se+W),y&&y!=="postfix"||(W=W+(Se=v?"":Se)+A),W}(q,Y,s);case"percent":return Y=b(Y,s.currentPercentageDefaultFormat()),function(_e,j,Ye,Fe){var ye=j.prefixSymbol,xe=S({instance:Fe(100*_e._value),providedFormat:j,state:Ye}),Se=Object.assign({},h,j);return ye?"%".concat(Se.spaceSeparated?" ":"").concat(xe):"".concat(xe).concat(Se.spaceSeparated?" ":"","%")}(q,Y,s,K);case"byte":return Y=b(Y,s.currentByteDefaultFormat()),E=q,P=s,G=K,V=(M=Y).base||"binary",Z=c[V],Q=g(E._value,Z.suffixes,Z.scale),X=Q.value,he=Q.suffix,Me=S({instance:G(X),providedFormat:M,state:P,defaults:P.currentByteDefaultFormat()}),Te=P.currentAbbreviations(),"".concat(Me).concat(Te.spaced?" ":"").concat(he);case"time":return Y=b(Y,s.currentTimeDefaultFormat()),R=q,d=Math.floor(R._value/60/60),m=Math.floor((R._value-60*d*60)/60),p=Math.round(R._value-60*d*60-60*m),"".concat(d,":").concat(m<10?"0":"").concat(m,":").concat(p<10?"0":"").concat(p);case"ordinal":return Y=b(Y,s.currentOrdinalDefaultFormat()),te=q,oe=Y,ue=(ie=s).currentOrdinal(),be=Object.assign({},h,oe),Ue=S({instance:te,providedFormat:oe,state:ie}),Ie=ue(te._value),"".concat(Ue).concat(be.spaceSeparated?" ":"").concat(Ie);case"number":default:return S({instance:q,providedFormat:Y,numbro:K})}var te,oe,ie,ue,be,Ue,Ie,R,d,m,p,E,M,P,G,V,Z,Q,X,he,Me,Te}(_,O,x);return z=(z=I+z)+$}function g(_,O,x){var I=O[0],$=Math.abs(_);if(x<=$){for(var z=1;z<O.length;++z){var q=Math.pow(x,z),Y=Math.pow(x,z+1);if(q<=$&&$<Y){I=O[z],_/=q;break}}I===O[0]&&(_/=Math.pow(x,O.length-1),I=O[O.length-1])}return{value:_,suffix:I}}function w(_){for(var O="",x=0;x<_;x++)O+="0";return O}function C(_,O){return _.toString().indexOf("e")!==-1?function(x,I){var $=x.toString(),z=o($.split("e"),2),q=z[0],Y=z[1],K=o(q.split("."),2),te=K[0],oe=K[1],ie=oe===void 0?"":oe;if(0<+Y)$=te+ie+w(Y-ie.length);else{var ue=".";ue=+te<0?"-0".concat(ue):"0".concat(ue);var be=(w(-Y-1)+Math.abs(te)+ie).substr(0,I);be.length<I&&(be+=w(I-be.length)),$=ue+be}return 0<+Y&&0<I&&($+=".".concat(w(I))),$}(_,O):(Math.round(+"".concat(_,"e+").concat(O))/Math.pow(10,O)).toFixed(O)}function S(_){var O=_.instance,x=_.providedFormat,I=_.state,$=I===void 0?s:I,z=_.decimalSeparator,q=_.defaults,Y=q===void 0?$.currentDefaults():q,K=O._value;if(K===0&&$.hasZeroFormat())return $.getZeroFormat();if(!isFinite(K))return K.toString();var te,oe,ie,ue,be,Ue,Ie,R,d=Object.assign({},h,Y,x),m=d.totalLength,p=m?0:d.characteristic,E=d.optionalCharacteristic,M=d.forceAverage,P=!!m||!!M||d.average,G=m?-1:P&&x.mantissa===void 0?0:d.mantissa,V=!m&&(x.optionalMantissa===void 0?G===-1:d.optionalMantissa),Z=d.trimMantissa,Q=d.thousandSeparated,X=d.spaceSeparated,he=d.negative,Me=d.forceSign,Te=d.exponential,_e="";if(P){var j=function(v){var y=v.value,A=v.forceAverage,W=v.abbreviations,H=v.spaceSeparated,F=H!==void 0&&H,D=v.totalLength,N=D===void 0?0:D,B="",k=Math.abs(y),U=-1;if(k>=Math.pow(10,12)&&!A||A==="trillion"?(B=W.trillion,y/=Math.pow(10,12)):k<Math.pow(10,12)&&k>=Math.pow(10,9)&&!A||A==="billion"?(B=W.billion,y/=Math.pow(10,9)):k<Math.pow(10,9)&&k>=Math.pow(10,6)&&!A||A==="million"?(B=W.million,y/=Math.pow(10,6)):(k<Math.pow(10,6)&&k>=Math.pow(10,3)&&!A||A==="thousand")&&(B=W.thousand,y/=Math.pow(10,3)),B&&(B=(F?" ":"")+B),N){var se=y.toString().split(".")[0];U=Math.max(N-se.length,0)}return{value:y,abbreviation:B,mantissaPrecision:U}}({value:K,forceAverage:M,abbreviations:$.currentAbbreviations(),spaceSeparated:X,totalLength:m});K=j.value,_e+=j.abbreviation,m&&(G=j.mantissaPrecision)}if(Te){var Ye=(oe=(te={value:K,characteristicPrecision:p}).value,ie=te.characteristicPrecision,ue=ie===void 0?0:ie,be=o(oe.toExponential().split("e"),2),Ue=be[0],Ie=be[1],R=+Ue,ue&&1<ue&&(R*=Math.pow(10,ue-1),Ie=0<=(Ie=+Ie-(ue-1))?"+".concat(Ie):Ie),{value:R,abbreviation:"e".concat(Ie)});K=Ye.value,_e=Ye.abbreviation+_e}var Fe,ye,xe,Se=function(v,y,A,W,H){if(W===-1)return v;var F=C(y,W),D=o(F.toString().split("."),2),N=D[0],B=D[1],k=B===void 0?"":B;if(k.match(/^0+$/)&&(A||H))return N;var U=k.match(/0+$/);return H&&U?"".concat(N,".").concat(k.toString().slice(0,U.index)):F.toString()}(K.toString(),K,V,G,Z);return Se=function(v,y,A,W,H){var F=W.currentDelimiters(),D=F.thousands;H=H||F.decimal;var N=F.thousandsSize||3,B=v.toString(),k=B.split(".")[0],U=B.split(".")[1];return A&&(y<0&&(k=k.slice(1)),function(se,de){for(var Ce=[],Ae=0,ke=se;0<ke;ke--)Ae===de&&(Ce.unshift(ke),Ae=0),Ae++;return Ce}(k.length,N).forEach(function(se,de){k=k.slice(0,se+de)+D+k.slice(se+de)}),y<0&&(k="-".concat(k))),B=U?k+H+U:k}(Se=function(v,y,A,W){var H=v,F=o(H.toString().split("."),2),D=F[0],N=F[1];if(D.match(/^-?0$/)&&A)return N?"".concat(D.replace("0",""),".").concat(N):D.replace("0","");if(D.length<W)for(var B=W-D.length,k=0;k<B;k++)H="0".concat(H);return H.toString()}(Se,0,E,p),K,Q,$,z),(P||Te)&&(Se=Se+_e),(Me||K<0)&&(Fe=Se,xe=he,Se=(ye=K)===0?Fe:+Fe==0?Fe.replace("-",""):0<ye?"+".concat(Fe):xe==="sign"?Fe:"(".concat(Fe.replace("-",""),")")),Se}function b(_,O){if(!_)return O;var x=Object.keys(_);return x.length===1&&x[0]==="output"?O:_}r.exports=function(_){return{format:function(){for(var O=arguments.length,x=new Array(O),I=0;I<O;I++)x[I]=arguments[I];return f.apply(void 0,x.concat([_]))},getByteUnit:function(){for(var O=arguments.length,x=new Array(O),I=0;I<O;I++)x[I]=arguments[I];return(function($){var z=c.general;return g($._value,z.suffixes,z.scale).suffix}).apply(void 0,x.concat([_]))},getBinaryByteUnit:function(){for(var O=arguments.length,x=new Array(O),I=0;I<O;I++)x[I]=arguments[I];return(function($){var z=c.binary;return g($._value,z.suffixes,z.scale).suffix}).apply(void 0,x.concat([_]))},getDecimalByteUnit:function(){for(var O=arguments.length,x=new Array(O),I=0;I<O;I++)x[I]=arguments[I];return(function($){var z=c.decimal;return g($._value,z.suffixes,z.scale).suffix}).apply(void 0,x.concat([_]))},formatOrDefault:b}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,r,i){var o=n("./en-US"),s=n("./validating"),a=n("./parsing"),l={},u=void 0,c={},h=null,f={};function g(C){u=C}function w(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return w().currency},l.currentAbbreviations=function(){return w().abbreviations},l.currentDelimiters=function(){return w().delimiters},l.currentOrdinal=function(){return w().ordinal},l.currentDefaults=function(){return Object.assign({},w().defaults,f)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().timeFormat)},l.setDefaults=function(C){C=a.parseFormat(C),s.validateFormat(C)&&(f=C)},l.getZeroFormat=function(){return h},l.setZeroFormat=function(C){return h=typeof C=="string"?C:null},l.hasZeroFormat=function(){return h!==null},l.languageData=function(C){if(C){if(c[C])return c[C];throw new Error('Unknown tag "'.concat(C,'"'))}return w()},l.registerLanguage=function(C){var S=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(C))throw new Error("Invalid language data");c[C.languageTag]=C,S&&g(C.languageTag)},l.setLanguage=function(C){var S=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[C]){var b=C.split("-")[0],_=Object.keys(c).find(function(O){return O.split("-")[0]===b});return c[_]?void g(_):void g(S)}g(C)},l.registerLanguage(o),u=o.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,r,i){r.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(l){var u=void 0;try{u=n("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(n,r,i){var o=n("bignumber.js");function s(a,l,u){var c=new o(a._value),h=l;return u.isNumbro(l)&&(h=l._value),h=new o(h),a._value=c.minus(h).toNumber(),a}r.exports=function(a){return{add:function(l,u){return h=u,f=a,g=new o((c=l)._value),w=h,f.isNumbro(h)&&(w=h._value),w=new o(w),c._value=g.plus(w).toNumber(),c;var c,h,f,g,w},subtract:function(l,u){return s(l,u,a)},multiply:function(l,u){return h=u,f=a,g=new o((c=l)._value),w=h,f.isNumbro(h)&&(w=h._value),w=new o(w),c._value=g.times(w).toNumber(),c;var c,h,f,g,w},divide:function(l,u){return h=u,f=a,g=new o((c=l)._value),w=h,f.isNumbro(h)&&(w=h._value),w=new o(w),c._value=g.dividedBy(w).toNumber(),c;var c,h,f,g,w},set:function(l,u){return c=l,f=h=u,a.isNumbro(h)&&(f=h._value),c._value=f,c;var c,h,f},difference:function(l,u){return c=u,s(f=(h=a)(l._value),c,h),Math.abs(f._value);var c,h,f}}}},{"bignumber.js":1}],7:[function(n,r,i){function o(S,b){for(var _=0;_<b.length;_++){var O=b[_];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(S,O.key,O)}}var s=n("./globalState"),a=n("./validating"),l=n("./loading")(C),u=n("./unformatting"),c=n("./formatting")(C),h=n("./manipulating")(C),f=n("./parsing"),g=function(){function S(O){(function(x,I){if(!(x instanceof I))throw new TypeError("Cannot call a class as a function")})(this,S),this._value=O}var b,_;return b=S,(_=[{key:"clone",value:function(){return C(this._value)}},{key:"format",value:function(){var O=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,O)}},{key:"formatCurrency",value:function(O){return typeof O=="string"&&(O=f.parseFormat(O)),(O=c.formatOrDefault(O,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,O)}},{key:"formatTime",value:function(){var O=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return O.output="time",c.format(this,O)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(O){return h.difference(this,O)}},{key:"add",value:function(O){return h.add(this,O)}},{key:"subtract",value:function(O){return h.subtract(this,O)}},{key:"multiply",value:function(O){return h.multiply(this,O)}},{key:"divide",value:function(O){return h.divide(this,O)}},{key:"set",value:function(O){return h.set(this,w(O))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(b.prototype,_),S}();function w(S){var b=S;return C.isNumbro(S)?b=S._value:typeof S=="string"?b=C.unformat(S):isNaN(S)&&(b=NaN),b}function C(S){return new g(w(S))}C.version="2.1.2",C.isNumbro=function(S){return S instanceof g},C.language=s.currentLanguage,C.registerLanguage=s.registerLanguage,C.setLanguage=s.setLanguage,C.languages=s.languages,C.languageData=s.languageData,C.zeroFormat=s.setZeroFormat,C.defaultFormat=s.currentDefaults,C.setDefaults=s.setDefaults,C.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,C.validate=a.validate,C.loadLanguagesInNode=l.loadLanguagesInNode,C.unformat=u.unformat,r.exports=C},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,r,i){r.exports={parseFormat:function(o){var s,a,l,u,c,h,f,g,w,C,S,b,_,O,x,I,$,z,q,Y,K=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=K,o=(l=(s=o).match(/^{([^}]*)}/))?(a.prefix=l[1],s.slice(l[0].length)):s,c=K,function(te,oe){if(te.indexOf("$")===-1){if(te.indexOf("%")===-1)return te.indexOf("bd")!==-1?(oe.output="byte",oe.base="general"):te.indexOf("b")!==-1?(oe.output="byte",oe.base="binary"):te.indexOf("d")!==-1?(oe.output="byte",oe.base="decimal"):te.indexOf(":")===-1?te.indexOf("o")!==-1&&(oe.output="ordinal"):oe.output="time";oe.output="percent"}else oe.output="currency"}(o=(h=(u=o).match(/{([^}]*)}$/))?(c.postfix=h[1],u.slice(0,-h[0].length)):u,K),f=K,(g=o.match(/[1-9]+[0-9]*/))&&(f.totalLength=+g[0]),w=K,(C=o.split(".")[0].match(/0+/))&&(w.characteristic=C[0].length),function(te,oe){if(te.indexOf(".")!==-1){var ie=te.split(".")[0];oe.optionalCharacteristic=ie.indexOf("0")===-1}}(o,K),S=K,o.indexOf("a")!==-1&&(S.average=!0),_=K,(b=o).indexOf("K")!==-1?_.forceAverage="thousand":b.indexOf("M")!==-1?_.forceAverage="million":b.indexOf("B")!==-1?_.forceAverage="billion":b.indexOf("T")!==-1&&(_.forceAverage="trillion"),function(te,oe){var ie=te.split(".")[1];if(ie){var ue=ie.match(/0+/);ue&&(oe.mantissa=ue[0].length)}}(o,K),x=K,(O=o).match(/\[\.]/)?x.optionalMantissa=!0:O.match(/\./)&&(x.optionalMantissa=!1),I=K,o.indexOf(",")!==-1&&(I.thousandSeparated=!0),$=K,o.indexOf(" ")!==-1&&($.spaceSeparated=!0),q=K,(z=o).match(/^\+?\([^)]*\)$/)&&(q.negative="parenthesis"),z.match(/^\+?-/)&&(q.negative="sign"),Y=K,o.match(/^\+/)&&(Y.forceSign=!0),K)}}},{}],9:[function(n,r,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<arguments.length?arguments[5]:void 0,w=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===f?0:function C(S,b){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",O=3<arguments.length?arguments[3]:void 0,x=4<arguments.length?arguments[4]:void 0,I=5<arguments.length?arguments[5]:void 0,$=6<arguments.length?arguments[6]:void 0;if(!isNaN(+S))return+S;var z="",q=S.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(q!==S)return-1*C(q,b,_,O,x,I,$);for(var Y=0;Y<o.length;Y++){var K=o[Y];if((z=S.replace(K.key,""))!==S)return C(z,b,_,O,x,I,$)*K.factor}if((z=S.replace("%",""))!==S)return C(z,b,_,O,x,I,$)/100;var te=parseFloat(S);if(!isNaN(te)){var oe=O(te);if(oe&&oe!=="."&&(z=S.replace(new RegExp("".concat(s(oe),"$")),""))!==S)return C(z,b,_,O,x,I,$);var ie={};Object.keys(I).forEach(function(m){ie[I[m]]=m});for(var ue=Object.keys(ie).sort().reverse(),be=ue.length,Ue=0;Ue<be;Ue++){var Ie=ue[Ue],R=ie[Ie];if((z=S.replace(Ie,""))!==S){var d=void 0;switch(R){case"thousand":d=Math.pow(10,3);break;case"million":d=Math.pow(10,6);break;case"billion":d=Math.pow(10,9);break;case"trillion":d=Math.pow(10,12)}return C(z,b,_,O,x,I,$)*d}}}}(function(C,S){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",_=C.replace(b,"");return _=(_=_.replace(new RegExp("([0-9])".concat(s(S.thousands),"([0-9])"),"g"),"$1$2")).replace(S.decimal,".")}(l,u,c),u,c,h,f,g,w)}r.exports={unformat:function(l,u){var c,h,f,g=n("./globalState"),w=g.currentDelimiters(),C=g.currentCurrency().symbol,S=g.currentOrdinal(),b=g.getZeroFormat(),_=g.currentAbbreviations(),O=void 0;if(typeof l=="string")O=function(x,I){if(!x.indexOf(":")||I.thousands===":")return!1;var $=x.split(":");if($.length!==3)return!1;var z=+$[0],q=+$[1],Y=+$[2];return!isNaN(z)&&!isNaN(q)&&!isNaN(Y)}(l,w)?(c=l.split(":"),h=+c[0],f=+c[1],+c[2]+60*f+3600*h):a(l,w,C,S,b,_,u);else{if(typeof l!="number")return;O=l}if(O!==void 0)return O}}},{"./globalState":4}],10:[function(n,r,i){function o(w){return function(C){if(Array.isArray(C)){for(var S=0,b=new Array(C.length);S<C.length;S++)b[S]=C[S];return b}}(w)||function(C){if(Symbol.iterator in Object(C)||Object.prototype.toString.call(C)==="[object Arguments]")return Array.from(C)}(w)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(w){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C})(w)}var a=n("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(w,C){return C.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(w){return w.output==="byte"}},characteristic:{type:"number",restriction:function(w){return 0<=w},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(w){return 0<=w},message:"value must be positive"},{restriction:function(w,C){return!C.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(w){return 0<=w},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(w,C){return C.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(w){return w.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(w){return!!a.unformat(w)}function f(w,C,S){var b=3<arguments.length&&arguments[3]!==void 0&&arguments[3],_=Object.keys(w).map(function(O){if(!C[O])return console.error("".concat(S," Invalid key: ").concat(O)),!1;var x=w[O],I=C[O];if(typeof I=="string"&&(I={type:I}),I.type==="format"){if(!f(x,u,"[Validate ".concat(O,"]"),!0))return!1}else if(s(x)!==I.type)return console.error("".concat(S," ").concat(O,' type mismatched: "').concat(I.type,'" expected, "').concat(s(x),'" provided')),!1;if(I.restrictions&&I.restrictions.length)for(var $=I.restrictions.length,z=0;z<$;z++){var q=I.restrictions[z],Y=q.restriction,K=q.message;if(!Y(x,w))return console.error("".concat(S," ").concat(O," invalid value: ").concat(K)),!1}return I.restriction&&!I.restriction(x,w)?(console.error("".concat(S," ").concat(O," invalid value: ").concat(I.message)),!1):I.validValues&&I.validValues.indexOf(x)===-1?(console.error("".concat(S," ").concat(O," invalid value: must be among ").concat(JSON.stringify(I.validValues),', "').concat(x,'" provided')),!1):!(I.children&&!f(x,I.children,"[Validate ".concat(O,"]")))});return b||_.push.apply(_,o(Object.keys(C).map(function(O){var x=C[O];if(typeof x=="string"&&(x={type:x}),x.mandatory){var I=x.mandatory;if(typeof I=="function"&&(I=I(w)),I&&w[O]===void 0)return console.error("".concat(S,' Missing mandatory key "').concat(O,'"')),!1}return!0}))),_.reduce(function(O,x){return O&&x},!0)}function g(w){return f(w,u,"[Validate format]")}r.exports={validate:function(w,C){var S=h(w),b=g(C);return S&&b},validateFormat:g,validateInput:h,validateLanguage:function(w){return f(w,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(y1);var S6=y1.exports;const as=cC(S6),y6="numeric";function Ny(t,e,n,r,i,o,s){let a=o;if(Nn(a)){const l=s.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,h=s.className||"",f=h.length?h.split(" "):[];if(typeof u<"u"&&!as.languages()[u]){const g=u.replace("-",""),w=as.allLanguages?as.allLanguages[u]:as[g];w&&as.registerLanguage(w)}as.setLanguage(u),a=as(a).format(c||"0"),f.indexOf("htLeft")<0&&f.indexOf("htCenter")<0&&f.indexOf("htRight")<0&&f.indexOf("htJustify")<0&&f.push("htRight"),f.indexOf("htNumeric")<0&&f.push("htNumeric"),s.className=f.join(" "),e.dir="ltr"}co(t,e,n,r,i,a,s)}Ny.RENDERER_TYPE=y6;const b6="password";function Ly(t,e,n,r,i,o,s){co.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";pe(a-1,()=>{u+=l}),Qs(e,u)}Ly.RENDERER_TYPE=b6;const R6="time";function ky(t,e,n,r,i,o,s){co.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}ky.RENDERER_TYPE=R6;function E6(){ai(Cl),ai(mc),ai(Hy),ai(xy),ai(Ny),ai(Ly),ai(co),ai(ky)}const T6="autocomplete";function Gf(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,YE(n,e)):YE(n,e)(this.source):e(!0)}Gf.VALIDATOR_TYPE=T6;function YE(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function b1(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const _6=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:b1},Symbol.toStringTag,{value:"Module"})),M6="date";function $y(t,e){const n=VI(g1,this.instance);let r=t,i=!0;r==null&&(r="");let o=J(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=J(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=A6(r,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),i=!0}else i=!1;e(i)}$y.VALIDATOR_TYPE=M6;function A6(t,e){const n=J(b1(t)),r=J(t,e),i=t.search(/[A-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const O6="numeric";function Fy(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Nn(t))}Fy.VALIDATOR_TYPE=O6;const P6=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],I6="time";function Wy(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=J(i,P6,!0).isValid()?J(i):J(i,n);let a=s.isValid(),l=J(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n),c=this.instance.toVisualRow(this.row),h=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,h,u,"timeValidator"),r=!0}else r=!1;e(r)}Wy.VALIDATOR_TYPE=I6;function x6(){qa(Gf),qa($y),qa(Fy),qa(Wy)}const H6="autocomplete",D6={CELL_TYPE:H6,editor:Py,renderer:Cl,validator:Gf},N6="checkbox",L6={CELL_TYPE:N6,editor:d1,renderer:Hy},k6="date";function R1(t,e,n,r,i,o,s){Cl.apply(this,[t,e,n,r,i,o,s]),t.getSettings().ariaTags&&ve(e,[fl("dialog"),sn("false")])}R1.RENDERER_TYPE=k6;const $6="date",F6={CELL_TYPE:$6,editor:m1,renderer:R1,validator:$y},W6="dropdown",V6={CELL_TYPE:W6,editor:Iy,renderer:Cl,validator:Gf},B6="handsontable";function E1(t,e,n,r,i,o,s){Cl.apply(this,[t,e,n,r,i,o,s]),t.getSettings().ariaTags&&ve(e,[fl("true"),sn("false")])}E1.RENDERER_TYPE=B6;const U6="handsontable",z6={CELL_TYPE:U6,editor:Oy,renderer:E1},G6="numeric",Y6={CELL_TYPE:G6,editor:p1,renderer:Ny,validator:Fy,dataType:"number"},j6="password",K6={CELL_TYPE:j6,editor:w1,renderer:Ly,copyable:!1},X6="select";function T1(t,e,n,r,i,o,s){co.apply(this,[t,e,n,r,i,o,s]),t.getSettings().ariaTags&&ve(e,...fl("listbox"))}T1.RENDERER_TYPE=X6;const q6="select",Z6={CELL_TYPE:q6,editor:C1,renderer:T1},Q6="time",J6={CELL_TYPE:Q6,editor:v1,renderer:ky,validator:Wy};function e9(){dr(D6),dr(L6),dr(F6),dr(V6),dr(z6),dr(Y6),dr(K6),dr(Z6),dr(h1),dr(J6)}function t9(t,e){_1(t,e),e.add(t)}function n9(t,e,n){_1(t,e),e.set(t,n)}function _1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ga(t,e,n){return e=r9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r9(t){var e=i9(t,"string");return typeof e=="symbol"?e:String(e)}function i9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function o9(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ma(t,e){var n=s9(t,e,"get");return a9(t,n)}function s9(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function a9(t,e){return e.get?e.get.call(t):e.value}const jE=new Map([["plugin",ZG],["cell-type",t1],["editor",WI],["renderer",ZI],["validator",QI]]),l9="base",bm=[];let Jr=null;var ls=new WeakMap,KE=new WeakSet;class nt{static get PLUGIN_KEY(){return l9}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){t9(this,KE),ga(this,"eventManager",new sr(this)),ga(this,"pluginName",null),ga(this,"pluginsInitializedCallbacks",[]),ga(this,"isPluginsReady",!1),ga(this,"enabled",!1),ga(this,"initialized",!1),n9(this,ls,{writable:!0,value:{}}),vi(this,"hot",e,{writable:!1}),Jr=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!jE.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);jE.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");bm.push(o)}}if(Jr||(Jr=mv()),Jr.indexOf("UndoRedo")>=0&&Jr.splice(Jr.indexOf("UndoRedo"),1),Jr.indexOf(this.pluginName)>=0&&Jr.splice(Jr.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Jr.length===0){if(bm.length>0){const i=[`${bm.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n){ma(this,ls)[e]=ma(this,ls)[e]||[];const r=ma(this,ls)[e];this.hot.addHook(e,n),r.push(n),ma(this,ls)[e]=r}removeHooks(e){T(ma(this,ls)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=ma(this,ls);Be(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){T(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=o9(this,KE,u9).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Be(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function u9(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function us(t,e,n){return e=c9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c9(t){var e=h9(t,"string");return typeof e=="symbol"?e:String(e)}function h9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let d9=class{constructor(e){us(this,"hot",null),us(this,"container",null),us(this,"injected",!1),us(this,"rows",[]),us(this,"columns",[]),us(this,"samples",null),us(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),T(this.rows,n=>{e(n.row,Ot(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),T(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{T(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{T(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{T(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),T(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{T(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e);a.col=e,a.row=s;const l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),ee(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return ee(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const Vy=d9;function oh(t,e,n){return e=f9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f9(t){var e=g9(t,"string");return typeof e=="symbol"?e:String(e)}function g9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class By{static get SAMPLE_COUNT(){return 3}constructor(e){oh(this,"samples",null),oh(this,"dataFactory",null),oh(this,"customSampleCount",null),oh(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:By.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return pe(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return pe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let f;h?f=c:$e(u)?f=`${Object.keys(u).length}`:Array.isArray(u)?f=`${u.length}`:f=`${Nt(u).length}`,i.has(f)||i.set(f,{needed:this.getSampleCount(),strings:[]});const g=i.get(f);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}const M1=By;function pa(t,e){A1(t,e),e.add(t)}function m9(t,e,n){A1(t,e),e.set(t,n)}function A1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wa(t,e,n){return e=p9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p9(t){var e=w9(t,"string");return typeof e=="symbol"?e:String(e)}function w9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function C9(t,e,n){var r=O1(t,e,"set");return v9(t,r,n),n}function v9(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function sh(t,e){var n=O1(t,e,"get");return S9(t,n)}function O1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function S9(t,e){return e.get?e.get.call(t):e.value}function cs(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("modifyAutoColumnSizeSeed");const kl="autoColumnSize",y9=10,b9="autoColumnSize";var za=new WeakMap,XE=new WeakSet,qE=new WeakSet,ZE=new WeakSet,Rm=new WeakSet,QE=new WeakSet,JE=new WeakSet;class bu extends nt{static get PLUGIN_KEY(){return kl}static get PLUGIN_PRIORITY(){return y9}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),pa(this,JE),pa(this,QE),pa(this,Rm),pa(this,ZE),pa(this,qE),pa(this,XE),wa(this,"ghostTable",new Vy(this.hot)),wa(this,"samplesGenerator",new M1((n,r)=>{const i=this.hot.getCellMeta(n,r);let o="";i.spanned||(o=this.hot.getDataAtCell(n,r));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,o)),{value:o,bundleSeed:s}})),wa(this,"firstCalculation",!0),wa(this,"inProgress",!1),wa(this,"measuredColumns",0),wa(this,"columnWidthsMap",new Xo),m9(this,za,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(b9,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>cs(this,Rm,e0).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[kl]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[kl];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cs(e,qE,E9).call(e,...i)}),this.addHook("beforeChangeRender",r=>cs(this,ZE,T9).call(this,r)),this.addHook("afterFormulasValuesUpdate",r=>cs(this,JE,M9).call(this,r)),this.addHook("beforeViewRender",r=>cs(this,XE,R9).call(this,r)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("afterInit",()=>cs(this,QE,_9).call(this)),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>cs(this,Rm,e0).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const n=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();r===-1||i===-1||this.calculateColumnsWidth({from:r,to:i},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;pe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);if(a===null&&(a=s),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(s,o);T(l,u=>{let[c,h]=u;return this.ghostTable.addColumn(c,h)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){Bu(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+bu.CALCULATION_STEP,r)},e),n=n+bu.CALCULATION_STEP+1,n<r?i=Lf(o):(Bu(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[kl],n=e&&At(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&At(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[kl];let n=bu.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return $e(e)&&(n=e.syncLimit,qC(n)?n=fv(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,Cv.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getFirstVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getFirstRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getLastVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getLastRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader();return Ft(e,(r,i,o)=>{const s=sh(this,za).length;return(s-1<o||sh(this,za)[o]!==i)&&r.push(o),s-1<o?sh(this,za).push(i):sh(this,za)[o]=i,r},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{T(e,n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!or(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function R9(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function E9(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function T9(t){const e=Ve(t,n=>{let[,r]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(r))});this.clearCache(Array.from(new Set(e)))}function e0(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function _9(){C9(this,za,this.hot.getColHeader())}function M9(t){const e=or(t,r=>{var i;return le((i=r.address)===null||i===void 0?void 0:i.col)}),n=Ve(e,r=>r.address.col);this.clearCache(Array.from(new Set(n)))}const Ns={horizontal:"horizontal",vertical:"vertical"};function A9(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function O9(t){const e={};return t===!0?(e.directions=Object.keys(Ns),e.autoInsertRow=!0):$e(t)?(le(t.autoInsertRow)?t.direction===Ns.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Ns)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function $l(t,e){P9(t,e),e.add(t)}function P9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ca(t,e,n){return e=I9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I9(t){var e=x9(t,"string");return typeof e=="symbol"?e:String(e)}function x9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("modifyAutofillRange");fe.getSingleton().register("beforeAutofill");fe.getSingleton().register("afterAutofill");const t0="autofill",H9=20,D9=["fillHandle"],N9="insert_row_below",L9=200;var n0=new WeakSet,r0=new WeakSet,i0=new WeakSet,o0=new WeakSet,s0=new WeakSet;class k9 extends nt{constructor(){super(...arguments),$l(this,s0),$l(this,o0),$l(this,i0),$l(this,r0),$l(this,n0),Ca(this,"addingStarted",!1),Ca(this,"mouseDownOnCellCorner",!1),Ca(this,"mouseDragOutside",!1),Ca(this,"handleDraggedCells",0),Ca(this,"directions",[]),Ca(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return t0}static get PLUGIN_PRIORITY(){return H9}static get SETTING_KEYS(){return[t0,...D9]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Fl(this,r0,F9).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Fl(this,n0,$9).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Fl(this,i0,W9).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return T(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),T(a,c=>{const h=[];T(l,f=>{h.push(this.hot.getCopyableData(c,f))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:f}=A9(l,u,(g,w)=>this.hot._createCellCoords(g,w));if(h&&h.row>-1&&h.col>-1){const g=this.getSelectionData(),w=o.clone(),C=this.hot._createCellRange(h,h,f),S=this.hot.runHooks("beforeAutofill",g,w,C,c);if(S===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let b=S;const _=S;if(["up","left"].indexOf(c)>-1&&!(_.length===1&&_[0].length===0))if(b=[],c==="up"){const O=f.row-h.row+1,x=O%_.length;for(let I=0;I<O;I++)b.push(_[(I+(_.length-x))%_.length])}else{const O=f.col-h.col+1,x=O%_[0].length;for(let I=0;I<_.length;I++){b.push([]);for(let $=0;$<O;$++)b[I].push(_[I][($+(_[I].length-x))%_[I].length])}}this.hot.populateFromArray(h.row,h.col,b,f.row,f.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",b,w,C,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Ns.vertical)&&this.directions.includes(Ns.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Ns.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Ns.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(N9,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},L9)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++)if(n[o][l])return-1;const s=n[o][e[1]-1],a=n[o][e[3]+1];(s||a)&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ve(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Bt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+Ot(this.hot.table),i=Bt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+ut(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Fl(this,o0,V9).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Fl(this,s0,B9).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=O9(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function $9(){this.selectAdjacent()&&this.fillIn()}function F9(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function W9(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function V9(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function B9(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function ah(t,e){U9(t,e),e.add(t)}function U9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hs(t,e,n){return e=z9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z9(t){var e=G9(t,"string");return typeof e=="symbol"?e:String(e)}function G9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const lh="autoRowSize",Y9=40,j9="autoRowSize";var a0=new WeakSet,Em=new WeakSet,l0=new WeakSet,u0=new WeakSet;class Ru extends nt{static get PLUGIN_KEY(){return lh}static get PLUGIN_PRIORITY(){return Y9}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),ah(this,u0),ah(this,l0),ah(this,Em),ah(this,a0),hs(this,"headerHeight",null),hs(this,"ghostTable",new Vy(this.hot)),hs(this,"samplesGenerator",new M1((n,r)=>{if(n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let i;return n>=0?i=this.hot.getDataAtCell(n,r):n===-1&&(i=this.hot.getColHeader(r)),{value:i}})),hs(this,"firstCalculation",!0),hs(this,"inProgress",!1),hs(this,"measuredRows",0),hs(this,"rowHeightsMap",new Xo),this.hot.rowIndexMapper.registerMap(j9,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>Wl(this,Em,c0).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[lh];return e===!0||$e(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Wl(e,l0,X9).call(e,...r)}),this.addHook("beforeChangeRender",n=>Wl(this,u0,q9).call(this,n)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",n=>Wl(this,a0,K9).call(this,n)),this.addHook("modifyRowHeight",(n,r)=>this.getRowHeight(r,n)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>Wl(this,Em,c0).call(this,e,n,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}pe(i.from,i.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){const a=this.samplesGenerator.generateRowSamples(s,o);T(a,l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){Bu(i),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+Ru.CALCULATION_STEP,r)},e),n=n+Ru.CALCULATION_STEP+1,n<r?i=Lf(o):(Bu(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[lh],n=e&&At(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&At(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){Uo(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[lh];let n=Ru.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return $e(e)&&(n=e.syncLimit,qC(n)?n=fv(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{pe(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!or(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function K9(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(!(n===-1||r===-1)){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-e,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function c0(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function X9(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function q9(t){let e=null;t.length===1?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),e!==null&&this.clearCacheByRange(e)}const{getListWithInsertedItems:Z9,getListWithRemovedItems:Q9}=Hx("physicallyIndexed");class J9 extends Js{constructor(){super(e=>e)}insert(e,n){const r=zv(this.indexedValues,n);this.indexedValues=Z9(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=Q9(this.indexedValues,e);this.indexedValues=Uv(n,e),super.remove(e)}}const e8=J9,{getListWithInsertedItems:t8,getListWithRemovedItems:n8}=Hx("physicallyIndexed");class r8 extends Js{constructor(){super(e=>e)}insert(e,n){this.indexedValues=t8(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=n8(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const i8=r8;function o8(t,e){s8(t,e),e.add(t)}function s8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a8(t,e,n){return e=l8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l8(t){var e=u8(t,"string");return typeof e=="symbol"?e:String(e)}function u8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function c8(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Tm="bindRowsWithHeaders",h8=210,d8="loose",f8=new Map([["loose",e8],["strict",i8]]);var h0=new WeakSet;class g8 extends nt{constructor(){super(...arguments),o8(this,h0),a8(this,"headerIndexes",null)}static get PLUGIN_KEY(){return Tm}static get PLUGIN_PRIORITY(){return h8}isEnabled(){return!!this.hot.getSettings()[Tm]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[Tm];typeof e!="string"&&(e=d8);const n=f8.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>c8(this,h0,m8).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function m8(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function uh(t,e){P1(t,e),e.add(t)}function p8(t,e,n){P1(t,e),e.set(t,n)}function P1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function d0(t,e,n){return e=w8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w8(t){var e=C8(t,"string");return typeof e=="symbol"?e:String(e)}function C8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function f0(t,e){var n=I1(t,e,"get");return v8(t,n)}function v8(t,e){return e.get?e.get.call(t):e.value}function ch(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function _m(t,e,n){var r=I1(t,e,"set");return S8(t,r,n),n}function I1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function S8(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const rd="collapsibleColumns",y8=290,b8=["nestedHeaders"],nl="collapsibleIndicator",g0=rd,m0=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var va=new WeakMap,p0=new WeakSet,w0=new WeakSet,C0=new WeakSet,v0=new WeakSet;class R8 extends nt{constructor(){super(...arguments),uh(this,v0),uh(this,C0),uh(this,w0),uh(this,p0),d0(this,"nestedHeadersPlugin",null),d0(this,"headerStateManager",null),p8(this,va,{writable:!0,value:null})}static get PLUGIN_KEY(){return rd}static get PLUGIN_PRIORITY(){return y8}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[rd,...b8]}isEnabled(){return!!this.hot.getSettings()[rd]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||pt("You need to configure the Nested Headers plugin in order to use collapsible headers."),_m(this,va,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>ch(this,C0,_8).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ch(e,v0,M8).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ch(e,p0,E8).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>ch(this,w0,T8).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_m(this,va,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};i&&(o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:g0})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(g0)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};pe(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;pe(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${nl}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${nl}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${nl}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!m0.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=or(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;T(r,f=>{var g;let{row:w,col:C}=f;const{collapsible:S,isCollapsed:b}=(g=this.headerStateManager.getHeaderSettings(w,C))!==null&&g!==void 0?g:{};if(!S||b&&n==="collapse"||!b&&n==="expand")return i=!1,!1});const o=[],s=[];i&&T(r,f=>{let{row:g,col:w}=f;const{colspanCompensation:C,affectedColumns:S,rollbackModification:b}=this.headerStateManager.triggerNodeModification(n,g,w);C>0&&(s.push(...S),o.push(b))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=KC([...a,...s]):n==="expand"&&(l=or(a,f=>!s.includes(f)));const u=m0.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){T(o,f=>{f()});return}this.hot.batchExecution(()=>{T(s,f=>{f0(this,va).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return f0(this,va).getHiddenIndexes()}destroy(){_m(this,va,null),super.destroy()}}function E8(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${nl}`);if(Ko(e,[sn("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),ee(u,nl),e.querySelector("div:first-child").appendChild(u)),De(u,["collapsed","expanded"]),s?(ee(u,"collapsed"),Bo(u,"+"),l&&ve(e,[sn(!1),ku(this.hot.getTranslatedPhrase(gy))])):(ee(u,"expanded"),Bo(u,"-"),l&&ve(e,[sn(!0),ku(this.hot.getTranslatedPhrase(my))])),l&&ve(u,...so());else{var c;(c=u)===null||c===void 0||c.remove()}}function T8(t,e){Pe(t.target,nl)&&(Pe(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Pe(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),br(t))}function _8(){this.updatePlugin()}function M8(t,e){e||this.updatePlugin()}function ds(t,e,n){return e=A8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A8(t){var e=O8(t,"string");return typeof e=="symbol"?e:String(e)}function O8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const P8=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],I8=!1,x8=!0,H8=!0;class D8{constructor(e,n){ds(this,"hot",void 0),ds(this,"sortingStates",new Ff),ds(this,"sortEmptyCells",I8),ds(this,"indicator",x8),ds(this,"headerAction",H8),ds(this,"compareFunctionFactory",void 0),ds(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){$e(e)&&Be(e,(n,r)=>{P8.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return $e(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(le(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const Vd="asc",Bd="desc",N8="colHeader";function L8(t){if($e(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Vd,Bd].includes(n)}function k8(t){if(t.some(n=>L8(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function S0(t){if(t!==Bd)return t===Vd?Bd:Vd}function x1(t){return t.querySelector(`.${N8}`)}function H1(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function Uy(t,e,n){return t===-1&&e>=0&&zo(n)===!1}const $8="ascending",F8="descending",D1="indicatorDisabled",N1="columnSorting",L1="sortAction",k1=new Map([[Vd,$8],[Bd,F8]]);function W8(t,e,n,r){const i=[N1];if(r&&i.push(L1),n===!1)return i.push(D1),i;const o=t.getSortOrderOfColumn(e);return le(o)&&i.push(k1.get(o)),i}function V8(){return Array.from(k1.values()).concat(L1,D1,N1)}function $1(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?fi:Xt(i)?Xt(o)?fi:s&&t==="asc"?Ht:Dt:Xt(o)?s&&t==="asc"?Dt:Ht:isNaN(i)&&!isNaN(o)?t==="asc"?Dt:Ht:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Ht:Dt:i>o?t==="asc"?Dt:Ht:fi}}const F1="default";function B8(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return fi;if(a){if(Xt(r))return t==="asc"?Ht:Dt;if(Xt(i))return t==="asc"?Dt:Ht}return isNaN(o)?Dt:isNaN(s)?Ht:o<s?t==="asc"?Ht:Dt:o>s?t==="asc"?Dt:Ht:fi}}const U8="numeric";function z8(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Xt(s),u=Xt(a),c=l?i:s,h=u?i:a,f=c===i||c===r,g=h===i||h===r;if(o===!1){if(l&&u===!1)return Dt;if(l===!1&&u)return Ht}return f===!1&&g?t==="asc"?Ht:Dt:f&&g===!1?t==="asc"?Dt:Ht:f===!1&&g===!1?$1(t,e,n)(s,a):c===i&&h===r?t==="asc"?Ht:Dt:c===r&&h===i?t==="asc"?Dt:Ht:fi}}const G8="checkbox";function Y8(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return fi;if(Xt(r))return Xt(i)?fi:o&&t==="asc"?Ht:Dt;if(Xt(i))return o&&t==="asc"?Dt:Ht;const s=e.dateFormat,a=J(r,s),l=J(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?t==="asc"?Ht:Dt:l.isBefore(a)?t==="asc"?Dt:Ht:fi:Ht:Dt}}const j8="date",{register:Yf,getItem:y0,hasItem:K8}=Yr("sorting.compareFunctionFactory"),{register:W1,getItem:X8}=Yr("sorting.mainSortComparator");function V1(t){return K8(t)?y0(t):y0(F1)}Yf(U8,B8);Yf(G8,z8);Yf(j8,Y8);Yf(F1,$1);const fi=0,Ht=-1,Dt=1;function q8(t,e){const n=X8(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}function Z8(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],f=u.columnSorting;return(f.compareFunctionFactory?f.compareFunctionFactory:V1(u.type))(l,u,f)(c,h)}(0)}}function hh(t,e){Q8(t,e),e.add(t)}function Q8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dh(t,e,n){return e=J8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J8(t){var e=e7(t,"string");return typeof e=="symbol"?e:String(e)}function e7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ga(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Ud="columnSorting",t7=50,zd="append",n7="replace",b0=Ud,R0="columnSortingIndicator";W1(Ud,Z8);fe.getSingleton().register("beforeColumnSort");fe.getSingleton().register("afterColumnSort");var id=new WeakSet,E0=new WeakSet,T0=new WeakSet,_0=new WeakSet;class B1 extends nt{constructor(){super(...arguments),hh(this,_0),hh(this,T0),hh(this,E0),hh(this,id),dh(this,"columnStatesManager",null),dh(this,"columnMetaCache",null),dh(this,"pluginKey",Ud),dh(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Ud}static get PLUGIN_PRIORITY(){return t7}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new D8(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Xo(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Ga(this,E0,r7).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ga(e,_0,o7).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Ga(this,id,Vw).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ga(e,T0,i7).call(e,...r)}),this.hot.view&&Ga(this,id,Vw).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=x1(r);H1(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:b0})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(b0)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Dx),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return k8(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ve(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return le(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ve(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(le(n)){const i=S0(n);return le(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:S0()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:zd;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(mt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===zd)return[...o.slice(0,r),...o.slice(r+1),s];if(n===n7)return[...o.slice(0,r),s,...o.slice(r+1)]}return le(s)?o.concat(s):o}getPluginColumnConfig(e){if($e(e)){const n=e[this.pluginKey];if($e(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):gt(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const n=[],r=this.hot.countRows(),i=u=>Ve(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ve(n,u=>u[0]);q8(n,this.pluginKey,Ve(e,u=>u.sortOrder),Ve(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ve(n,u=>u[0]),a=new Map(Ve(o,(u,c)=>[u,s[c]])),l=Ve(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if($e(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||$e(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(De(e,V8()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];ee(e,W8(...r))}}updateSortingIndicator(e,n){const r=this.getFirstCellSettings(e)[this.pluginKey],i=this.hot.getSettings().ariaTags,o=r.indicator,s=this.columnStatesManager.isColumnSorted(e),a=n.querySelector(`.${R0}`);o&&s&&!a&&Bs(n,{tagName:"div",className:R0,attributes:i?[so()]:[]})}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&e.target.nodeName==="SPAN"}onAfterOnCellMouseDown(e,n){Uy(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function Vw(){const t=this.getAllSavedSortSettings();if($e(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function r7(t,e){const n=x1(e);if(H1(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=this.hot.getSettings().ariaTags,o=r.indicator,s=r.headerAction,a=this.columnStatesManager.getSortOrderOfColumn(t);this.updateHeaderClasses(n,this.columnStatesManager,t,o,s),this.updateSortingIndicator(t,n),i&&ve(e,[yz(a?`${a}ending`:"none"),ku(this.hot.getTranslatedPhrase(py))])}function i7(t){t===!0&&this.hot.view&&Ga(this,id,Vw).call(this)}function o7(t,e,n,r){Uy(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function fs(t,e,n){return e=s7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s7(t){var e=a7(t,"string");return typeof e=="symbol"?e:String(e)}function a7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l7{constructor(e,n){fs(this,"plugin",void 0),fs(this,"hot",void 0),fs(this,"endpoints",[]),fs(this,"settings",void 0),fs(this,"settingsType","array"),fs(this,"currentEndpoint",null),fs(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),T(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();T(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const f=()=>(this.hot.removeHook("beforeViewRender",f),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",f);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;T(u,f=>{a==="row"&&f.destinationRow>=h&&(f.alterRowOffset=l*r),a==="col"&&f.destinationColumn>=h&&(f.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?T(u,f=>{this.extendEndpointRanges(f,h,i[0],i.length),this.recreatePhysicalRanges(f),this.clearOffsetInformation(f)}):T(u,f=>{this.shiftEndpointCoordinates(f,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){T(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];T(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),T(i,o=>{let s=[];T(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,T(e.ranges,r=>{T(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],T(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],T(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],T(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&T(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),T(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){pt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const u7=l7;function Mm(t){return t==null||isNaN(t)}function Am(t,e){c7(t,e),e.add(t)}function c7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h7(t,e,n){return e=d7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d7(t){var e=f7(t,"string");return typeof e=="symbol"?e:String(e)}function f7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Om(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Pm="columnSummary",g7=220;var M0=new WeakSet,A0=new WeakSet,O0=new WeakSet;class m7 extends nt{constructor(){super(...arguments),Am(this,O0),Am(this,A0),Am(this,M0),h7(this,"endpoints",null)}static get PLUGIN_KEY(){return Pm}static get PLUGIN_PRIORITY(){return g7}isEnabled(){return!!this.hot.getSettings()[Pm]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Pm],this.endpoints=new u7(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Om(e,M0,p7).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Om(e,A0,w7).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Om(e,O0,C7).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Be(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=Mm(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Be(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=Mm(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=Mm(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Be(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ct`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function p7(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}function w7(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function C7(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Sa(t,e,n){return e=v7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v7(t){var e=S7(t,"string");return typeof e=="symbol"?e:String(e)}function S7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qa{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){Sa(this,"rootDocument",void 0),Sa(this,"isRtl",!1),Sa(this,"container",null),Sa(this,"editor",void 0),Sa(this,"editorStyle",void 0),Sa(this,"hidden",!0),this.rootDocument=e,this.isRtl=n,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,n){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:ut(this.getInputElement()),height:Ot(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),ee(this.container,Qa.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),ee(e,Qa.CLASS_EDITOR),ee(n,Qa.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${Qa.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const y7=Qa;function Im(t,e,n){return e=b7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b7(t){var e=R7(t,"string");return typeof e=="symbol"?e:String(e)}function R7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const E7=250,T7=250;class U1{constructor(e){Im(this,"wasLastActionShow",!0),Im(this,"showDebounced",null),Im(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},T7)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:E7;this.showDebounced=ov(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}dt(U1,Qn);const _7=U1;function M7(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function A7(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function gs(t,e){const n={};return T(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function To(t,e,n,r,i){T(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&O7(s,a,e,n,r,i)})})}function O7(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=M7(s.className,r):a=A7(s.className,r)),o(t,e,"className",a)}function Wi(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function ui(t,e){let n=!1;return Array.isArray(t)&&T(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function jf(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Ge="---------";function P7(){return{name:Ge}}const mr="alignment";function I7(){return{key:mr,name(){return this.getTranslatedPhrase(pS)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${mr}:left`,name(){let t=this.getTranslatedPhrase(wS);return ui(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(t=Wi(t)),t},callback(){const t=this.getSelectedRange(),e=gs(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mr}:center`,name(){let t=this.getTranslatedPhrase(CS);return ui(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(t=Wi(t)),t},callback(){const t=this.getSelectedRange(),e=gs(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mr}:right`,name(){let t=this.getTranslatedPhrase(vS);return ui(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(t=Wi(t)),t},callback(){const t=this.getSelectedRange(),e=gs(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mr}:justify`,name(){let t=this.getTranslatedPhrase(SS);return ui(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(t=Wi(t)),t},callback(){const t=this.getSelectedRange(),e=gs(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Ge},{key:`${mr}:top`,name(){let t=this.getTranslatedPhrase(yS);return ui(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(t=Wi(t)),t},callback(){const t=this.getSelectedRange(),e=gs(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mr}:middle`,name(){let t=this.getTranslatedPhrase(bS);return ui(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(t=Wi(t)),t},callback(){const t=this.getSelectedRange(),e=gs(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mr}:bottom`,name(){let t=this.getTranslatedPhrase(RS);return ui(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(t=Wi(t)),t},callback(){const t=this.getSelectedRange(),e=gs(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Kf="clear_column";function x7(){return{key:Kf,name(){return this.getTranslatedPhrase(nS)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const pc="col_left";function H7(){return{key:pc,name(){return this.getTranslatedPhrase(Xv)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const wc="col_right";function D7(){return{key:wc,name(){return this.getTranslatedPhrase(qv)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Cc="make_read_only";function N7(){return{key:Cc,name(){let t=this.getTranslatedPhrase(tS);return ui(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=Wi(t)),t},callback(){const t=this.getSelectedRange(),e=ui(t,(n,r)=>this.getCellMeta(n,r).readOnly);T(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Xf="redo";function L7(){return{key:Xf,name(){return this.getTranslatedPhrase(eS)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const vc="remove_col";function k7(){return{key:vc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(Qv,e)},callback(){this.alter("remove_col",GX(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const qf="remove_row";function $7(){return{key:qf,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(Zv,e)},callback(){this.alter("remove_row",YX(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Zf="row_above";function F7(){return{key:Zf,name(){return this.getTranslatedPhrase(jv)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Qf="row_below";function W7(){return{key:Qf,name(){return this.getTranslatedPhrase(Kv)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Gu="no_items";function V7(){return{key:Gu,name(){return this.getTranslatedPhrase(Yv)},disabled:!0,isCommand:!1}}const Jf="undo";function B7(){return{key:Jf,name(){return this.getTranslatedPhrase(Jv)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const U7=[Zf,Qf,pc,wc,Kf,qf,vc,Jf,Xf,Cc,mr,Ge,Gu],z7={[Ge]:P7,[Gu]:V7,[Zf]:F7,[Qf]:W7,[pc]:H7,[wc]:D7,[Kf]:x7,[qf]:$7,[vc]:k7,[Jf]:B7,[Xf]:L7,[Cc]:N7,[mr]:I7};function z1(){const t={};return Be(z7,(e,n)=>{t[n]=e()}),t}function G7(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(fS):this.getTranslatedPhrase(dS)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Y7(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(gS)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function j7(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(mS);return ui(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,od))?Wi(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,od);t.updateCommentMeta(n,r,{[od]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function ei(t,e){G1(t,e),e.add(t)}function ms(t,e,n){G1(t,e),e.set(t,n)}function G1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function K7(t,e,n){return e=X7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X7(t){var e=q7(t,"string");return typeof e=="symbol"?e:String(e)}function q7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ti(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ji(t,e,n){var r=Y1(t,e,"set");return Z7(t,r,n),n}function Z7(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function qe(t,e){var n=Y1(t,e,"get");return Q7(t,n)}function Y1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Q7(t,e){return e.get?e.get.call(t):e.value}const Eu="comments",J7=60,Vi="comment",hu="value",j1="style",od="readOnly",fh=Eu,Bw=`plugin:${Eu}`;var St=new WeakMap,Hr=new WeakMap,eg=new WeakMap,sd=new WeakMap,Gd=new WeakMap,Uw=new WeakMap,Yd=new WeakMap,P0=new WeakSet,I0=new WeakSet,x0=new WeakSet,H0=new WeakSet,D0=new WeakSet,N0=new WeakSet,L0=new WeakSet,k0=new WeakSet,$0=new WeakSet,F0=new WeakSet;class e5 extends nt{constructor(){super(...arguments),ei(this,F0),ei(this,$0),ei(this,k0),ei(this,L0),ei(this,N0),ei(this,D0),ei(this,H0),ei(this,x0),ei(this,I0),ei(this,P0),K7(this,"range",{}),ms(this,St,{writable:!0,value:null}),ms(this,Hr,{writable:!0,value:null}),ms(this,eg,{writable:!0,value:!1}),ms(this,sd,{writable:!0,value:!1}),ms(this,Gd,{writable:!0,value:{}}),ms(this,Uw,{writable:!0,value:null}),ms(this,Yd,{writable:!0,value:""})}static get PLUGIN_KEY(){return Eu}static get PLUGIN_PRIORITY(){return J7}isEnabled(){return!!this.hot.getSettings()[Eu]}enablePlugin(){this.enabled||(qe(this,St)||ji(this,St,new y7(this.hot.rootDocument,this.hot.isRtl())),qe(this,Hr)||ji(this,Hr,new _7(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,n,r,i,o,s)=>ti(this,H0,i5).call(this,e,s)),this.addHook("afterScroll",()=>ti(this,F0,c5).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>ti(this,$0,u5).call(this,e)),qe(this,Hr).addLocalHook("hide",()=>this.hide()),qe(this,Hr).addLocalHook("show",(e,n)=>this.showAtCell(e,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){qe(this,Hr).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(Bw);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();ji(this,sd,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(Bw),this.hot._registerTimeout(()=>{ji(this,sd,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!qe(this,St).isVisible()},group:fh}),r.addShortcut({keys:[["Escape"]],callback:()=>{qe(this,St).setValue(qe(this,Yd)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&qe(this,St).isVisible()},group:fh}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&qe(this,St).isVisible()},group:fh})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(fh)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>ti(this,I0,n5).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>ti(this,P0,t5).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>ti(this,x0,r5).call(this)),this.eventManager.addEventListener(n,"focus",()=>ti(this,N0,s5).call(this)),this.eventManager.addEventListener(n,"blur",()=>ti(this,D0,o5).call(this)),this.eventManager.addEventListener(n,"mousedown",r=>ti(this,L0,a5).call(this,r)),this.eventManager.addEventListener(n,"mouseup",r=>ti(this,k0,l5).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Vo(e.target,"TD","TBODY");return!!(n&&Pe(n,"htCommentCell")&&Vo(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=qe(this,St).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[hu]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Vi),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,hu)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,hu)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return qe(this,Hr).cancelHiding(),qe(this,St).setValue((e=i[Vi]?i[Vi][hu]:null)!==null&&e!==void 0?e:""),qe(this,St).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){qe(this,St).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!qe(this,St).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(s),u=o.getRenderableFromVisualIndex(a);const c=l===null;qe(this,St).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),u===null&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));const h=l===null,f=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:g,view:{_wt:w}}=this.hot,{wtTable:C}=w,S=w.getCell({row:l,col:u},!0),b=this.getCommentMeta(s,a,j1);b?qe(this,St).setSize(b.width,b.height):qe(this,St).resetSize();const _=f?0:C.getStretchedColumnWidth(u),O=c&&!h?Ot(S):0,{left:x,top:I,width:$,height:z}=S.getBoundingClientRect(),{width:q,height:Y}=qe(this,St).getSize(),{innerWidth:K,innerHeight:te}=this.hot.rootWindow,oe=this.hot.rootDocument.documentElement;let ie=x+g.scrollX+_,ue=I+g.scrollY+O;this.hot.isRtl()&&(ie-=q+_),this.hot.isLtr()&&x+$+q>K?ie=x+g.scrollX-q-1:this.hot.isRtl()&&ie<-(oe.scrollWidth-oe.clientWidth)&&(ie=x+g.scrollX+_+1),I+Y>te&&(ue-=Y-z+1),qe(this,St).setPosition(ie,ue),qe(this,St).setReadOnlyState(this.getCommentMeta(s,a,od))}focusEditor(){qe(this,St).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Vi];let o;i?(o=bn(i),uc(o,r)):o=r,this.hot.setCellMeta(e,n,Vi,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Vi])return i[Vi][r]}addToContextMenu(e){e.items.push({name:Ge},G7(this),Y7(this),j7(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[Eu];if($e(e))return e.displayDelay}getEditorInputElement(){return qe(this,St).getInputElement()}destroy(){qe(this,St)&&qe(this,St).destroy(),qe(this,Hr)&&qe(this,Hr).destroy(),super.destroy()}}function t5(t){if(!(!this.hot.view||!this.hot.view._wt)&&!qe(this,eg)&&!this.targetIsCommentTextArea(t)){const e=Vo(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function n5(t){const{rootDocument:e}=this.hot;if(!(qe(this,eg)||qe(this,St).isFocused()||Pe(t.target,"wtBorder")||qe(this,Uw)===t.target||!qe(this,St)))if(ji(this,Uw,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));qe(this,Hr).show(n)}else No(t.target,e)&&!this.targetIsCommentTextArea(t)&&qe(this,Hr).hide()}function r5(){ji(this,eg,!1)}function i5(t,e){e[Vi]&&e[Vi][hu]&&ee(t,e.commentedCellClassName)}function o5(){ji(this,Yd,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function s5(){ji(this,Yd,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(Bw)}function a5(t){ji(this,Gd,{width:ut(t.target),height:Ot(t.target)})}function l5(t){const e=ut(t.target),n=Ot(t.target);(e!==qe(this,Gd).width+1||n!==qe(this,Gd).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[j1]:{width:e,height:n}})}function u5(t){qe(this,St).isVisible()&&br(t)}function c5(){qe(this,sd)||this.hide()}var W0=OO,h5=TypeError,d5=function(t,e){if(!delete t[e])throw h5("Cannot delete property "+W0(e)+" of "+W0(t))},f5=Xs,g5=hf,m5=ff,p5=YO,w5=d5,C5=jO,v5=[].unshift(0)!==1,S5=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},y5=v5||!S5();f5({target:"Array",proto:!0,arity:1,forced:y5},{unshift:function(e){var n=g5(this),r=m5(n),i=arguments.length;if(i){C5(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:w5(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return p5(n,r+i)}});function xm(t,e,n){return e=b5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b5(t){var e=R5(t,"string");return typeof e=="symbol"?e:String(e)}function R5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class K1{constructor(e){xm(this,"hot",void 0),xm(this,"commands",{}),xm(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=E5(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||At(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),T(u,c=>c.apply(this.hot,r))}}function E5(t,e){let n;return T(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function Hm(t,e,n){return e=T5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T5(t){var e=_5(t,"string");return typeof e=="symbol"?e:String(e)}function _5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X1{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Hm(this,"hot",void 0),Hm(this,"predefinedItems",z1()),Hm(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Be(e,(r,i)=>{let o="";r.name===Ge?(n[Ge]=r,o=Ge):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return M5(e,this.defaultOrderPattern,this.predefinedItems)}}function M5(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),$e(i)?Be(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),$e(o)?Ut(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):T(i,(o,s)=>{let a=n[o];!a&&U7.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),$e(o)&&Ut(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function po(t,e,n){return e=A5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A5(t){var e=O5(t,"string");return typeof e=="symbol"?e:String(e)}function O5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P5{constructor(e,n){po(this,"top",void 0),po(this,"topRelative",void 0),po(this,"left",void 0),po(this,"leftRelative",void 0),po(this,"scrollTop",void 0),po(this,"scrollLeft",void 0),po(this,"cellHeight",void 0),po(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Vl(t,e,n){I5(t,e),e.set(t,n)}function I5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ke(t,e){var n=q1(t,e,"get");return x5(t,n)}function x5(t,e){return e.get?e.get.call(t):e.value}function gh(t,e,n){var r=q1(t,e,"set");return H5(t,r,n),n}function q1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function H5(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var On=new WeakMap,wo=new WeakMap,cn=new WeakMap,Dm=new WeakMap,ya=new WeakMap;class D5{constructor(e){Vl(this,On,{writable:!0,value:void 0}),Vl(this,wo,{writable:!0,value:void 0}),Vl(this,cn,{writable:!0,value:void 0}),Vl(this,Dm,{writable:!0,value:!1}),Vl(this,ya,{writable:!0,value:{above:0,below:0,left:0,right:0}}),gh(this,Dm,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Ke(this,ya)[e]=n,this}setElement(e){return gh(this,On,e),this}setParentElement(e){return gh(this,wo,e),this}updatePosition(e){gh(this,cn,new P5(e,Ke(this,On).ownerDocument.defaultView)),Ke(this,Dm)?(Ke(this,cn).fitsBelow(Ke(this,On))?this.setPositionBelowCursor():Ke(this,cn).fitsAbove(Ke(this,On))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Ke(this,On).dir==="rtl"?Ke(this,cn).fitsOnLeft(Ke(this,On))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ke(this,cn).fitsOnRight(Ke(this,On))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Ke(this,ya).above+Ke(this,cn).top-Ke(this,On).offsetHeight;Ke(this,wo)&&(e=Ke(this,cn).top+Ke(this,cn).cellHeight-Ke(this,On).offsetHeight+3),Ke(this,On).style.top=`${e}px`}setPositionBelowCursor(){let e=Ke(this,ya).below+Ke(this,cn).top+1;Ke(this,wo)&&(e=Ke(this,cn).top-1),Ke(this,On).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Ke(this,cn).left;if(Ke(this,wo)){const{right:n}=Ke(this,wo).getBoundingClientRect();e+=Ke(this,cn).cellWidth+n-(Ke(this,cn).left+Ke(this,cn).cellWidth)}else e+=Ke(this,ya).right;Ke(this,On).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Ke(this,ya).left+Ke(this,cn).left-Ke(this,On).offsetWidth;if(Ke(this,wo)){const{left:n}=Ke(this,wo).getBoundingClientRect();e-=Ke(this,cn).left-n}Ke(this,On).style.left=`${e}px`}}function Z1(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=qn(e,-1,w()-1);function a(S,b){const _=w()-1;return S<0&&(S=_),S>_&&(S=0),o.has(S)?-1:(o.add(S),r(S,!1)===!1&&(S=a(b===1?++S:--S,b)),S)}function l(S){S>-1&&S<w()&&r(S,!0)!==!1&&(s=S)}function u(){return s}function c(){w()>0&&(o.clear(),s=a(0,1))}function h(){w()>0&&(o.clear(),s=a(w()-1,-1))}function f(){w()>0&&(o.clear(),s=a(++s,1))}function g(){w()>0&&(o.clear(),s=a(--s,-1))}function w(){return Math.max(n(),0)}function C(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:f,toPreviousItem:g,getSize:w,clear:C}}function N5(t){return Ve(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function ad(t){return At(t,"submenu")}function zw(t){return new RegExp(Ge,"i").test(t.name)}function ld(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function V0(t){return At(t,"disableSelection")}function L5(t){return Pe(t,"htSeparator")}function k5(t){return Pe(t,"htSubmenu")}function $5(t){return Pe(t,"htDisabled")}function F5(t){return Pe(t,"htSelectionDisabled")}function W5(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function Q1(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function V5(t,e){let n=t.slice(0);return n.reverse(),n=Q1(n,e),n.reverse(),n}function B5(t){const e=[];return T(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function U5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ge,n=t.slice(0);return n=Q1(n,e),n=V5(n,e),n=B5(n),n}function z5(t){return Z1({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||L5(r)||$5(r)||F5(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function G5(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.hotMenu.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const n=t.hotMenu.getSelectedLast();n&&(t.hotMenu.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const J1="menu",B0=J1;function Y5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(G5(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:J1})}function i(u,c){const h=a(c);u.forEach(f=>{let{keys:g}=f;g.forEach(w=>h.removeShortcutsByKeys(w))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${B0}:${u}`:B0}function a(u){var c;const h=t.hotMenu.getShortcutManager(),f=s(u);return(c=h.getContext(f))!==null&&c!==void 0?c:h.addContext(f)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}const j5="submenuIndicator";function K5(t){return(e,n,r,i,o,s)=>{if(n.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s;if(zr(n),ee(l,"htItemWrapper"),t.getSettings().ariaTags){const c=!ld(a,t)&&!V0(a)&&!zw(a);ve(n,[dz(),Wo(u),...c?[dl(-1)]:[],...ld(a,t)?[vz()]:[],...ad(a)?[sn(!1)]:[]])}ad(a)&&(n.querySelector(".submenuIndicator")||Bs(n,{tagName:"div",attributes:t.getSettings().ariaTags?[so()]:[],className:j5})),n.className="",n.appendChild(l),zw(a)?ee(n,"htSeparator"):typeof a.renderer=="function"?(ee(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Qs(l,u),ld(a,t)?ee(n,"htDisabled"):V0(a)?ee(n,"htSelectionDisabled"):ad(a)&&ee(n,"htSubmenu")}}function U0(t,e,n){X5(t,e),e.set(t,n)}function X5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ni(t,e,n){return e=q5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q5(t){var e=Z5(t,"string");return typeof e=="symbol"?e:String(e)}function Z5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function z0(t,e,n){var r=eH(t,e,"set");return Q5(t,r,n),n}function Q5(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Bl(t,e){var n=eH(t,e,"get");return J5(t,n)}function eH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function J5(t,e){return e.get?e.get.call(t):e.value}const G0=215;var Ul=new WeakMap,mh=new WeakMap;class vl{constructor(e,n){var r=this;ni(this,"hot",void 0),ni(this,"options",void 0),ni(this,"eventManager",new sr(this)),ni(this,"container",void 0),ni(this,"positioner",void 0),ni(this,"hotMenu",null),ni(this,"hotSubMenus",{}),ni(this,"parentMenu",void 0),ni(this,"menuItems",null),ni(this,"origOutsideClickDeselects",null),U0(this,Ul,{writable:!0,value:void 0}),U0(this,mh,{writable:!0,value:void 0}),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:G0,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new D5(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=$u(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Bl(this,Ul)}getKeyboardShortcutsCtrl(){return Bl(this,mh)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=ov(a=>this.openSubMenu(a),300),n=this.options.minWidth||G0;let r=!1,i=or(this.menuItems,a=>(a.key===Gu&&(r=!0),W5(a,this.hot)));if(i.length<1&&!r)i.push(z1()[Gu]);else if(i.length===0)return;i=U5(i,Ge);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return le(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:K5(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{Bl(this,Ul).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===Ge?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),yw()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!yw()||!zo(a))&&o&&this.hasSelectedItem()&&(Yi()||cv()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),z0(this,Ul,z5(this.hotMenu)),z0(this,mh,Y5(this)),Bl(this,mh).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Bl(this,Ul).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);ve(r,[sn(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!k5(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new vl(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&ve(n,[sn(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&ve(i,[sn(!1)])}}closeAllSubMenus(){T(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?N5(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||zw(e)||ld(e,this.hot)||ad(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(gt(r)&&(r=r.call(this.hot),r===null||mt(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),ee(i,`htMenu ${this.options.className}`),r&&ee(i,r),this.options.container.appendChild(i)),i}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=Ft(n,(a,l)=>a+(l.name===Ge?1:26),0);i.width=`${o+3}px`,i.height=`${s+3}px`,r.height=i.height,this.hot.getSettings().ariaTags&&ve(this.hotMenu.rootElement,[hz(),dl(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!No(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!No(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Pe(e.target,"htCore")&&No(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}dt(vl,Qn);function ph(t,e){eZ(t,e),e.add(t)}function eZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nm(t,e,n){return e=tZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tZ(t){var e=nZ(t,"string");return typeof e=="symbol"?e:String(e)}function nZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const du="contextMenu",rZ=70,Y0=du;fe.getSingleton().register("afterContextMenuDefaultOptions");fe.getSingleton().register("beforeContextMenuShow");fe.getSingleton().register("afterContextMenuShow");fe.getSingleton().register("afterContextMenuHide");fe.getSingleton().register("afterContextMenuExecute");var j0=new WeakSet,K0=new WeakSet,X0=new WeakSet,q0=new WeakSet;class tg extends nt{constructor(){super(...arguments),ph(this,q0),ph(this,X0),ph(this,K0),ph(this,j0),Nm(this,"commandExecutor",new K1(this.hot)),Nm(this,"itemsFactory",null),Nm(this,"menu",null)}static get PLUGIN_KEY(){return du}static get PLUGIN_PRIORITY(){return rZ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Zf,Qf,Ge,pc,wc,Ge,qf,vc,Ge,Jf,Xf,Ge,Cc,Ge,mr]}isEnabled(){return!!this.hot.getSettings()[du]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[du];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new vl(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>wh(this,K0,oZ).call(this)),this.menu.addLocalHook("afterOpen",()=>wh(this,X0,sZ).call(this)),this.menu.addLocalHook("afterClose",()=>wh(this,q0,aZ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>wh(this,j0,iZ).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","\\"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=jf(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height})},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:Y0})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Y0)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Be(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new X1(this.hot,tg.DEFAULT_ITEMS);const e=this.hot.getSettings()[du],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),T(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function iZ(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),Pe(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(Pe(o,"current")&&Pe(o,"wtBorder"))))return;const s=jf(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function oZ(){this.hot.runHooks("beforeContextMenuShow",this)}function sZ(){this.hot.runHooks("afterContextMenuShow",this)}function aZ(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}tg.SEPARATOR={name:Ge};function lZ(t){return{key:"copy",name(){return this.getTranslatedPhrase(rS)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function uZ(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?qn(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(sS,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function cZ(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?qn(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(oS,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function hZ(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?qn(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(iS,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function dZ(t){return{key:"cut",name(){return this.getTranslatedPhrase(aS)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class fZ{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class gZ{constructor(){this.clipboardData=new fZ}}function Z0(t,e){tH(t,e),e.add(t)}function ba(t,e,n){tH(t,e),e.set(t,n)}function tH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ch(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Hn(t,e){var n=nH(t,e,"get");return mZ(t,n)}function mZ(t,e){return e.get?e.get.call(t):e.value}function Ra(t,e,n){var r=nH(t,e,"set");return pZ(t,r,n),n}function nH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function pZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Co=new WeakMap,Lm=new WeakMap,zl=new WeakMap,Gw=new WeakMap,Yw=new WeakMap,Gl=new WeakMap,vh=new WeakSet,Q0=new WeakSet;class wZ{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;Z0(this,Q0),Z0(this,vh),ba(this,Co,{writable:!0,value:void 0}),ba(this,Lm,{writable:!0,value:void 0}),ba(this,zl,{writable:!0,value:void 0}),ba(this,Gw,{writable:!0,value:void 0}),ba(this,Yw,{writable:!0,value:void 0}),ba(this,Gl,{writable:!0,value:void 0}),Ra(this,Lm,n),Ra(this,zl,r),Ra(this,Gw,i),Ra(this,Yw,o),Ra(this,Gl,s)}setSelectedRange(e){Ra(this,Co,e)}getCellsRange(){if(Hn(this,Lm).call(this)===0||Hn(this,zl).call(this)===0)return null;const{row:e,col:n}=Hn(this,Co).getTopStartCorner(),{row:r,col:i}=Hn(this,Co).getBottomEndCorner(),o=Ch(this,Q0,CZ).call(this,e,r),s=Ch(this,vh,km).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Hn(this,zl).call(this)===0||Hn(this,Gl).call(this)===0)return null;const{col:e}=Hn(this,Co).getTopStartCorner(),{col:n}=Hn(this,Co).getBottomEndCorner(),r=Ch(this,vh,km).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Hn(this,zl).call(this)===0||Hn(this,Gl).call(this)===0)return null;const{col:e}=Hn(this,Co).getTopStartCorner(),{col:n}=Hn(this,Co).getBottomEndCorner(),r=Ch(this,vh,km).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-Hn(this,Gl).call(this),startCol:e,endRow:-1,endCol:r}}}function km(t,e){return Math.min(e,Math.max(t+Hn(this,Yw).call(this)-1,t))}function CZ(t,e){return Math.min(e,Math.max(t+Hn(this,Gw).call(this)-1,t))}function rH(t){const e=[],n=[];return T(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);pe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);pe(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Oi(t,e){iH(t,e),e.add(t)}function ps(t,e,n){iH(t,e),e.set(t,n)}function iH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yl(t,e,n){return e=vZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vZ(t){var e=SZ(t,"string");return typeof e=="symbol"?e:String(e)}function SZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function er(t,e){var n=oH(t,e,"get");return yZ(t,n)}function yZ(t,e){return e.get?e.get.call(t):e.value}function Nr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Pi(t,e,n){var r=oH(t,e,"set");return bZ(t,r,n),n}function oH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function bZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}fe.getSingleton().register("afterCopyLimit");fe.getSingleton().register("modifyCopyableRange");fe.getSingleton().register("beforeCut");fe.getSingleton().register("afterCut");fe.getSingleton().register("beforePaste");fe.getSingleton().register("afterPaste");fe.getSingleton().register("beforeCopy");fe.getSingleton().register("afterCopy");const Sh="copyPaste",RZ=80,EZ=["fragmentSelection"],J0=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var jw=new WeakMap,Kw=new WeakMap,Xw=new WeakMap,Ea=new WeakMap,yh=new WeakMap,bh=new WeakMap,Ta=new WeakMap,$m=new WeakSet,eT=new WeakSet,sH=new WeakSet,zy=new WeakSet,tT=new WeakSet,nT=new WeakSet,rT=new WeakSet,iT=new WeakSet,oT=new WeakSet;class TZ extends nt{constructor(){super(...arguments),Oi(this,oT),Oi(this,iT),Oi(this,rT),Oi(this,nT),Oi(this,tT),Oi(this,zy),Oi(this,sH),Oi(this,eT),Oi(this,$m),Yl(this,"columnsLimit",1/0),Yl(this,"rowsLimit",1/0),Yl(this,"pasteMode","overwrite"),Yl(this,"uiContainer",this.hot.rootDocument.body),ps(this,jw,{writable:!0,value:!1}),ps(this,Kw,{writable:!0,value:!1}),ps(this,Xw,{writable:!0,value:!1}),ps(this,Ea,{writable:!0,value:"cells-only"}),ps(this,yh,{writable:!0,value:!1}),ps(this,bh,{writable:!0,value:!1}),ps(this,Ta,{writable:!0,value:new wZ({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),Yl(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Sh}static get SETTING_KEYS(){return[Sh,...EZ]}static get PLUGIN_PRIORITY(){return RZ}isEnabled(){return!!this.hot.getSettings()[Sh]}enablePlugin(){var e=this;if(this.enabled)return;const{[Sh]:n}=this.hot.getSettings();if(typeof n=="object"){var r,i;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,Pi(this,jw,!!n.copyColumnHeaders),Pi(this,Kw,!!n.copyColumnGroupHeaders),Pi(this,Xw,!!n.copyColumnHeadersOnly),this.uiContainer=(i=n.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>Nr(this,tT,AZ).call(this,o)),this.addHook("afterSelectionEnd",()=>Nr(this,nT,OZ).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),lv()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Nr(e,rT,PZ).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Nr(e,iT,IZ).call(e,...s)}),this.addHook("afterSelection",()=>Nr(this,oT,xZ).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Pi(this,Ea,e),Pi(this,yh,!0),Nr(this,$m,sT).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Pi(this,bh,!0),Nr(this,$m,sT).call(this,"cut")}getRangedCopyableData(e){return yu(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=rH(e);return T(r,o=>{const s=[];T(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new gZ;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}er(this,Ta).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);er(this,Ea)==="column-headers-only"?n.set("headers",er(this,Ta).getMostBottomColumnHeadersRange()):(er(this,Ea)==="with-column-headers"?n.set("headers",er(this,Ta).getMostBottomColumnHeadersRange()):er(this,Ea)==="with-column-group-headers"&&n.set("headers",er(this,Ta).getAllColumnHeadersRange()),n.set("cells",er(this,Ta).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,f=s,g=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:w,visualRow:C}=this.hot.getCellMeta(c,a);if(c=C+1,w===!0)continue;f=C,h=a;const S=[],b=o.length%r;for(;S.length<i||h<=u;){const{skipColumnOnPaste:_,visualCol:O}=this.hot.getCellMeta(s,h);if(h=O+1,_===!0)continue;g=O;const x=S.length%i;S.push(e[b][x])}o.push(S)}return this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,f,g]}onCopy(e){if(!this.hot.isListening()&&!er(this,yh)||this.isEditorOpened())return;this.setCopyableText(),Pi(this,yh,!1);const n=this.getRangedData(this.copyableRanges),r=Nr(this,eT,_Z).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){const o=yu(n);if(e&&e.clipboardData){const s=Mw(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[J0,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}Pi(this,Ea,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!er(this,bh)||this.isEditorOpened())return;this.setCopyableText(),Pi(this,bh,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const i=yu(n);if(e&&e.clipboardData){const o=Mw(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[J0,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const a=Mf(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=jI(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=tq(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[r,i,o,s]=this.populateValues(n);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function sT(t){if(lv()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&bI(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function _Z(t){const{rows:e}=rH(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function MZ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&rv(r)}}}function aH(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&iv(r)}}}function AZ(t){t.items.push({name:"---------"},lZ(this)),er(this,jw)&&t.items.push(hZ(this)),er(this,Kw)&&t.items.push(cZ(this)),er(this,Xw)&&t.items.push(uZ(this)),t.items.push(dZ(this))}function OZ(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function PZ(){Nr(this,zy,aH).call(this)}function IZ(){Nr(this,sH,MZ).call(this)}function xZ(){Nr(this,zy,aH).call(this)}function lH(t,e){return`border_row${t}col${e}`}function fu(){return{width:1,color:"#000"}}function Ki(){return{hide:!0}}function HZ(){return{width:1,color:"#000",cornerVisible:!1}}function Fm(t){if(le(t.start)||le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(le(t.end)||le(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function jl(t){return le(t.start)&&(t.left=t.start),le(t.end)&&(t.right=t.end),t}function Wm(t,e){return{id:lH(t,e),border:HZ(),row:t,col:e,top:Ki(),bottom:Ki(),start:Ki(),end:Ki()}}function DZ(t,e){return At(e,"border")&&e.border&&(t.border=e.border),At(e,"top")&&le(e.top)&&(e.top?($e(e.top)||(e.top=fu()),t.top=e.top):(e.top=Ki(),t.top=e.top)),At(e,"bottom")&&le(e.bottom)&&(e.bottom?($e(e.bottom)||(e.bottom=fu()),t.bottom=e.bottom):(e.bottom=Ki(),t.bottom=e.bottom)),At(e,"start")&&le(e.start)&&(e.start?($e(e.start)||(e.start=fu()),t.start=e.start):(e.start=Ki(),t.start=e.start)),At(e,"end")&&le(e.end)&&(e.end?($e(e.end)||(e.end=fu()),t.end=e.end):(e.end=Ki(),t.end=e.end)),t}function to(t,e){let n=!1;return T(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!At(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function ng(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function NZ(t){return t.some(e=>le(e.left)||le(e.right))}function LZ(t){return t.some(e=>le(e.start)||le(e.end))}const kZ=new Map([["left","start"],["right","end"]]);function $Z(t){var e;return(e=kZ.get(t))!==null&&e!==void 0?e:t}function FZ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(MS);return to(this,"bottom")&&(e=ng(e)),e},callback(e,n){const r=to(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function WZ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(AS);return to(this,e)&&(n=ng(n)),n},callback(n,r){const i=to(this,e);t.prepareBorder(r,e,i)}}}function VZ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(OS)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!to(this)}}}function BZ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(_S);return to(this,e)&&(n=ng(n)),n},callback(n,r){const i=to(this,e);t.prepareBorder(r,e,i)}}}function UZ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(TS);return to(this,"top")&&(e=ng(e)),e},callback(e,n){const r=to(this,"top");t.prepareBorder(n,"top",r)}}}function aT(t,e){zZ(t,e),e.add(t)}function zZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GZ(t,e,n){return e=YZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YZ(t){var e=jZ(t,"string");return typeof e=="symbol"?e:String(e)}function jZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lT(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const ud="customBorders",KZ=90;var uT=new WeakSet,cT=new WeakSet;class XZ extends nt{constructor(){super(...arguments),aT(this,cT),aT(this,uT),GZ(this,"savedBorders",[])}static get PLUGIN_KEY(){return ud}static get PLUGIN_PRIORITY(){return KZ}isEnabled(){return!!this.hot.getSettings()[ud]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>lT(this,uT,qZ).call(this,e)),this.addHook("init",()=>lT(this,cT,ZZ).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Fm(n));const o=sl(e),s=zu(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});T(e,a=>{s(a).forAll((l,u)=>{T(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,$Z(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=sl(e),r=zu(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return T(e,o=>{r(o).forAll((s,a)=>{T(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(jl(l))})})}),i}clearBorders(e){e?this.setBorders(e):(T(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Wm(e,n);r&&(a=DZ(a,r),T(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",jl(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);pe(e.from.row,r,o=>{pe(e.from.col,i,s=>{const a=Wm(o,s);let l=0;o===e.from.row&&At(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&At(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&At(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&At(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",jl(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=lH(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Wm(e,n):o=Fm(o),i?(o[r]=Ki(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",jl(o)))):(o[r]=fu(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",jl(o)))}prepareBorder(e,n,r){T(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":pe(o.col,s.col,a=>{pe(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":pe(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":pe(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":pe(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":pe(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){T(e,n=>{const r=Fm(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return Ft([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ve(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){T(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){T(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ve(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):T(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return T(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return T(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):T(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);T(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[ud];if(Array.isArray(e)){const n=bn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=NZ(e),r=LZ(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function qZ(t){this.hot.getSettings()[ud]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(ES)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[UZ(this),BZ(this),FZ(this),WZ(this),VZ(this)]}})}function ZZ(){this.changeBorderSettings()}function QZ(t,e){JZ(t,e),e.add(t)}function JZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vm(t,e,n){return e=eQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eQ(t){var e=tQ(t,"string");return typeof e=="symbol"?e:String(e)}function tQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hT(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const dT="dragToScroll",nQ=100;var Bm=new WeakSet;class rQ extends nt{constructor(){super(...arguments),QZ(this,Bm),Vm(this,"boundaries",null),Vm(this,"callback",null),Vm(this,"listening",!1)}static get PLUGIN_KEY(){return dT}static get PLUGIN_PRIORITY(){return nQ}isEnabled(){return!!this.hot.getSettings()[dT]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>hT(this,Bm,fT).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>hT(this,Bm,fT).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=$u(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function fT(t){if(zo(t))return;const e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback((n,r)=>{n<0?e.scrollLeft-=50:n>0&&(e.scrollLeft+=50),r<0?e.scrollTop-=20:r>0&&(e.scrollTop+=20)}),this.listen())}function ws(t,e){iQ(t,e),e.add(t)}function iQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Um(t,e,n){return e=oQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oQ(t){var e=sQ(t,"string");return typeof e=="symbol"?e:String(e)}function sQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _o(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("afterDropdownMenuDefaultOptions");fe.getSingleton().register("beforeDropdownMenuShow");fe.getSingleton().register("afterDropdownMenuShow");fe.getSingleton().register("afterDropdownMenuHide");fe.getSingleton().register("afterDropdownMenuExecute");const cd="dropdownMenu",aQ=230,qw="changeType",zm=cd;var Gy=new WeakSet,gT=new WeakSet,mT=new WeakSet,pT=new WeakSet,wT=new WeakSet,CT=new WeakSet,vT=new WeakSet;class rg extends nt{static get PLUGIN_KEY(){return cd}static get PLUGIN_PRIORITY(){return aQ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[pc,wc,Ge,vc,Ge,Kf,Ge,Cc,Ge,mr]}constructor(e){super(e),ws(this,vT),ws(this,CT),ws(this,wT),ws(this,pT),ws(this,mT),ws(this,gT),ws(this,Gy),Um(this,"commandExecutor",new K1(this.hot)),Um(this,"itemsFactory",null),Um(this,"menu",null),this.hot.addHook("afterGetColHeader",(n,r)=>_o(this,mT,uQ).call(this,n,r))}isEnabled(){return this.hot.getSettings()[cd]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new X1(this.hot,rg.DEFAULT_ITEMS);const n=this.hot.getSettings()[cd],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new vl(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>_o(this,pT,cQ).call(this)),this.menu.addLocalHook("afterOpen",()=>_o(this,wT,hQ).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>_o(this,CT,dQ).call(this,o)),this.menu.addLocalHook("afterClose",()=>_o(this,vT,fQ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),T(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=jf(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width})}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:zm},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:zm}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(zm)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>_o(this,gT,lQ).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Be(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function uH(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function lQ(t){if(t.stopPropagation(),Pe(t.target,qw)){const e=jf(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function uQ(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${qw}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=qw,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(ve(s,[Wo(this.hot.getTranslatedPhrase(Cy))]),ve(e,[fl("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function cQ(){this.hot.runHooks("beforeDropdownMenuShow",this)}function hQ(){this.hot.runHooks("afterDropdownMenuShow",this),_o(this,Gy,uH).call(this,this.menu)}function dQ(t){_o(this,Gy,uH).call(this,t)}function fQ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}rg.SEPARATOR={name:Ge};function ST(t,e,n){return e=gQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gQ(t){var e=mQ(t,"string");return typeof e=="symbol"?e:String(e)}function mQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pQ{constructor(e){ST(this,"hot",void 0),ST(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return pe(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(pe(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();pe(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();pe(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const wQ=pQ;function yT(t,e,n){return e=CQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CQ(t){var e=vQ(t,"string");return typeof e=="symbol"?e:String(e)}function vQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yy{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){yT(this,"dataProvider",void 0),yT(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=Ln(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=Ut(Ln(Yy.DEFAULT_OPTIONS),n),n=Ut(n,e),n.filename=ZC(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const SQ=Yy,yQ=String.fromCharCode(13),bQ=String.fromCharCode(34),RQ=String.fromCharCode(10);class EQ extends SQ{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?String.fromCharCode(65279):"";return i&&(r=Ve(r,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),T(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Nt(e);return r!==""&&(n||r.indexOf(yQ)>=0||r.indexOf(bQ)>=0||r.indexOf(RQ)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const TQ=EQ,_Q="csv",Zw={[_Q]:TQ};function MQ(t,e,n){return typeof Zw[t]=="function"?new Zw[t](e,n):null}const AQ="exportFile",OQ=240;class PQ extends nt{static get PLUGIN_KEY(){return AQ}static get PLUGIN_PRIORITY(){return OQ}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Zw[e])throw new Error(`Export format type "${e}" is not supported.`);return MQ(e,new wQ(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function _a(t,e,n){return e=IQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IQ(t){var e=xQ(t,"string");return typeof e=="symbol"?e:String(e)}function xQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sc{constructor(e,n){let{id:r,stateless:i=!0}=n;_a(this,"hot",void 0),_a(this,"id",void 0),_a(this,"elements",[]),_a(this,"hidden",!1),_a(this,"stateId",""),_a(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Ff)}getElements(){return this.elements}reset(){T(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),T(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}dt(Sc,Qn);const Yu={};function Yo(t,e){if(!Yu[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Yu[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function Ls(t){if(!Yu[t])throw Error(`Filter condition "${t}" does not exist.`);return Yu[t].descriptor}function zt(t,e,n){n.key=t,Yu[t]={condition:e,descriptor:n}}const on="none";function HQ(){return!0}zt(on,HQ,{name:Wf,inputsCount:0,showOperators:!1});const Tu="empty";function DQ(t){return Xt(t.value)}zt(Tu,DQ,{name:LS,inputsCount:0,showOperators:!0});const hd="not_empty";function NQ(t,e){return!Yo(Tu,e)(t)}zt(hd,NQ,{name:kS,inputsCount:0,showOperators:!0});const _u="eq";function LQ(t,e){let[n]=e;return Nt(t.value).toLocaleLowerCase(t.meta.locale)===Nt(n)}zt(_u,LQ,{name:$S,inputsCount:1,showOperators:!0});const dd="neq";function kQ(t,e){return!Yo(_u,e)(t)}zt(dd,kQ,{name:FS,inputsCount:1,showOperators:!0});const cH="gt";function $Q(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}zt(cH,$Q,{name:zS,inputsCount:1,showOperators:!0});const hH="gte";function FQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}zt(hH,FQ,{name:GS,inputsCount:1,showOperators:!0});const dH="lt";function WQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}zt(dH,WQ,{name:YS,inputsCount:1,showOperators:!0});const fH="lte";function VQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}zt(fH,VQ,{name:jS,inputsCount:1,showOperators:!0});const jy="date_after";function BQ(t,e){let[n]=e;const r=J(t.value,t.meta.dateFormat),i=J(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}zt(jy,BQ,{name:qS,inputsCount:1,showOperators:!0});const Ky="date_before";function UQ(t,e){let[n]=e;const r=J(t.value,t.meta.dateFormat),i=J(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}zt(Ky,UQ,{name:ZS,inputsCount:1,showOperators:!0});const jd="between";function zQ(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Yo(Ky,[o]),a=Yo(jy,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}zt(jd,zQ,{name:KS,inputsCount:2,showOperators:!0});const gH="not_between";function GQ(t,e){return!Yo(jd,e)(t)}zt(gH,GQ,{name:XS,inputsCount:2,showOperators:!0});const mH="begins_with";function YQ(t,e){let[n]=e;return Nt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Nt(n))}zt(mH,YQ,{name:WS,inputsCount:1,showOperators:!0});const pH="ends_with";function jQ(t,e){let[n]=e;return Nt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Nt(n))}zt(pH,jQ,{name:VS,inputsCount:1,showOperators:!0});const Xy="contains";function KQ(t,e){let[n]=e;return Nt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Nt(n))>=0}zt(Xy,KQ,{name:BS,inputsCount:1,showOperators:!0});const wH="not_contains";function XQ(t,e){return!Yo(Xy,e)(t)}zt(wH,XQ,{name:US,inputsCount:1,showOperators:!0});const CH="date_tomorrow";function qQ(t){const e=J(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(J().subtract(-1,"days").startOf("day"),"d"):!1}zt(CH,qQ,{name:JS,inputsCount:0});const vH="date_today";function ZQ(t){const e=J(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(J().startOf("day"),"d"):!1}zt(vH,ZQ,{name:QS,inputsCount:0});const SH="date_yesterday";function QQ(t){const e=J(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(J().subtract(1,"days").startOf("day"),"d"):!1}zt(SH,QQ,{name:ey,inputsCount:0});lx();function JQ(t,e){let n=t;return n===""&&(n=`(${e})`),n}const Qw=new Set([1]).has(1),eJ=Qw&&typeof Array.from=="function";function yc(t){let e=t;return Qw&&(e=new Set(e)),function(n){let r;return Qw?r=e.has(n):r=!!~e.indexOf(n),r}}function yH(t){return t??""}function Jw(t){let e=t;return eJ?e=Array.from(new Set(e)):e=KC(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function bT(t,e,n,r){const i=[],o=t===e;let s;return o||(s=yc(e)),T(t,a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:JQ(a,n)};r&&r(u),i.push(u)}),i}const ks="by_value";function tJ(t,e){let[n]=e;return n(t.value)}zt(ks,tJ,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[yc(e)]},showOperators:!1});const ju={};function nJ(t){if(!ju[t])throw Error(`Operation with id "${t}" does not exist.`);const e=ju[t].func;return function(n,r){return e(n,r)}}function rJ(t){return ju[t].name}function qy(t,e,n){ju[t]={name:e,func:n}}const $o="conjunction",iJ=ry;function oJ(t,e){return t.every(n=>n.func(e))}qy($o,iJ,oJ);const Kd="disjunction",sJ=Vf;function aJ(t,e){return t.some(n=>n.func(e))}qy(Kd,sJ,aJ);const Zy="disjunctionWithExtraCondition",lJ=Vf;function uJ(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}qy(Zy,lJ,uJ);const cJ="numeric",bH="text",hJ="date",RT={[cJ]:[on,Ge,Tu,hd,Ge,_u,dd,Ge,cH,hH,dH,fH,jd,gH],[bH]:[on,Ge,Tu,hd,Ge,_u,dd,Ge,mH,pH,Ge,Xy,wH],[hJ]:[on,Ge,Tu,hd,Ge,_u,dd,Ge,Ky,jy,jd,Ge,CH,vH,SH]};function dJ(t){const e=[];let n=t;return RT[n]||(n=bH),T(RT[n],r=>{let i;r===Ge?i={name:Ge}:i=Ln(Ls(r)),e.push(i)}),e}function Kl(t,e,n){return e=fJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fJ(t){var e=gJ(t,"string");return typeof e=="symbol"?e:String(e)}function gJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Gm="built",Ym="building",ET=["click","input","keydown","keypress","keyup","focus","blur","change"];let Wr=class RH{static get DEFAULTS(){return Ln({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Kl(this,"hot",void 0),Kl(this,"eventManager",new sr(this)),Kl(this,"options",void 0),Kl(this,"_element",void 0),Kl(this,"buildState",void 0),this.hot=e,this.options=Ut(RH.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Ym?this._element:this.buildState===Gm?(this.update(),this._element):(this.buildState=Ym,this.build(),this.buildState=Gm,this._element)}isBuilt(){return this.buildState===Gm}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Wn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Ym),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&ee(this._element,this.options.className),this.options.children.length)T(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Be(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),T(ET,r=>e(n,r))}else T(ET,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};dt(Wr,Qn);function mJ(t,e){EH(t,e),e.add(t)}function pJ(t,e,n){EH(t,e),e.set(t,n)}function EH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rh(t,e){var n=TH(t,e,"get");return wJ(t,n)}function wJ(t,e){return e.get?e.get.call(t):e.value}function CJ(t,e,n){var r=TH(t,e,"set");return vJ(t,r,n),n}function TH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function vJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function SJ(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Ma=new WeakMap,TT=new WeakSet;class Fo extends Wr{static get DEFAULTS(){return Ln({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,Ut(Fo.DEFAULTS,n)),mJ(this,TT),pJ(this,Ma,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>SJ(this,TT,yJ).call(this,e))}build(){super.build(),CJ(this,Ma,this._element.firstChild),ee(this._element,"htUIInput"),this.update()}update(){this.isBuilt()&&(Rh(this,Ma).type=this.options.type,Rh(this,Ma).placeholder=this.translateIfPossible(this.options.placeholder),Rh(this,Ma).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Rh(this,Ma).focus()}}function yJ(t){this.options.value=t.target.value}function jm(t,e){_H(t,e),e.add(t)}function Xl(t,e,n){_H(t,e),e.set(t,n)}function _H(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Aa(t,e,n){var r=MH(t,e,"set");return bJ(t,r,n),n}function bJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Km(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Pt(t,e){var n=MH(t,e,"get");return RJ(t,n)}function MH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function RJ(t,e){return e.get?e.get.call(t):e.value}var Zt=new WeakMap,Eh=new WeakMap,Th=new WeakMap,Xm=new WeakMap,_h=new WeakMap,_T=new WeakSet,MT=new WeakSet,AT=new WeakSet;class Ku extends Wr{static get DEFAULTS(){return Ln({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,Ut(Ku.DEFAULTS,n)),jm(this,AT),jm(this,MT),jm(this,_T),Xl(this,Zt,{writable:!0,value:null}),Xl(this,Eh,{writable:!0,value:[]}),Xl(this,Th,{writable:!0,value:void 0}),Xl(this,Xm,{writable:!0,value:void 0}),Xl(this,_h,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return Pt(this,Zt)}registerHooks(){this.addLocalHook("click",()=>Km(this,AT,_J).call(this))}setItems(e){Aa(this,Eh,this.translateNames(e)),Pt(this,Zt)&&Pt(this,Zt).setMenuItems(Pt(this,Eh))}translateNames(e){return T(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Aa(this,Zt,new vl(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Pt(this,Zt).setMenuItems(Pt(this,Eh));const e=new Wr(this.hot,{className:"htUISelectCaption"}),n=new Wr(this.hot,{className:"htUISelectDropdown"});Aa(this,Th,e),Aa(this,Xm,e.element),Aa(this,_h,n),this.hot.getSettings().ariaTags&&(ve(n.element,[so()]),ve(this._element,[aI()])),T([e,n],r=>this._element.appendChild(r.element)),Pt(this,Zt).addLocalHook("select",r=>Km(this,_T,EJ).call(this,r)),Pt(this,Zt).addLocalHook("afterClose",()=>Km(this,MT,TJ).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Pt(this,Zt).hot.getTranslatedPhrase(Wf),Pt(this,Xm).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Pt(this,Zt)&&(Pt(this,Zt).open(),Pt(this,Zt).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Pt(this,Zt).getNavigator().toFirstItem(),Pt(this,Zt).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Pt(this,Zt)&&Pt(this,Zt).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Pt(this,Zt)&&(Pt(this,Zt).destroy(),Aa(this,Zt,null)),Pt(this,Th)&&Pt(this,Th).destroy(),Pt(this,_h)&&Pt(this,_h).destroy(),super.destroy()}}function EJ(t){t.name!==Ge&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function TJ(){this.runLocalHooks("afterClose")}function _J(){this.openOptions()}function OT(t,e){MJ(t,e),e.add(t)}function MJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PT(t,e,n){return e=AJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AJ(t){var e=OJ(t,"string");return typeof e=="symbol"?e:String(e)}function OJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IT(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var xT=new WeakSet,HT=new WeakSet;class eC extends Sc{constructor(e,n){super(e,{id:n.id,stateless:!1}),OT(this,HT),OT(this,xT),PT(this,"name",""),PT(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Ku(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Fo(this.hot,{placeholder:uy})),this.elements.push(new Fo(this.hot,{placeholder:cy})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>IT(this,xT,PJ).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),T(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>IT(this,HT,IJ).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=Ln(e.command);n.name.startsWith(Lt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),T(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Ls(on),n=[];return T(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=Ls(e?e.name:on);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||T(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Ku)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Fo)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{ee(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&ee(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return ee(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),T(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Ls(on)];if(e!==null){const{visualIndex:r}=e;n=dJ(this.hot.getDataType(0,r,this.hot.countRows(),r))}T(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function PJ(t){T(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function IJ(t){ml(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),br(t))}function DT(t,e,n){xJ(t,e),e.set(t,n)}function xJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ql(t,e){var n=AH(t,e,"get");return HJ(t,n)}function HJ(t,e){return e.get?e.get.call(t):e.value}function NT(t,e,n){var r=AH(t,e,"set");return DJ(t,r,n),n}function AH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function DJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Oa=new WeakMap,qm=new WeakMap;class Xd extends Wr{static get DEFAULTS(){return Ln({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,Ut(Xd.DEFAULTS,n)),DT(this,Oa,{writable:!0,value:void 0}),DT(this,qm,{writable:!0,value:void 0})}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),NT(this,qm,e),NT(this,Oa,this._element.firstChild),ql(this,Oa).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(ql(this,qm).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return ql(this,Oa).checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(ql(this,Oa).checked=e)}focus(){this.isBuilt()&&ql(this,Oa).focus()}}function NJ(t,e){LJ(t,e),e.add(t)}function LJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kJ(t,e,n){return e=$J(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $J(t){var e=FJ(t,"string");return typeof e=="symbol"?e:String(e)}function FJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WJ(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const LT=0;var kT=new WeakSet;class VJ extends Sc{constructor(e,n){super(e,{id:n.id,stateless:!1}),NJ(this,kT),kJ(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(ee(n.parentNode,"htFiltersMenuOperators"),T(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[$o,Kd];T(e,n=>{const r=new Xd(this.hot,{name:"operator",label:{htmlFor:n,textContent:rJ(n)},value:n,checked:n===e[LT],id:n});r.addLocalHook("change",i=>WJ(this,kT,BJ).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ct`Radio button with index ${e} doesn't exist.`);T(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Xd&&n.isChecked());return e?e.getValue():$o}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&T(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$o,n=arguments.length>1?arguments[1]:void 0,r=e;r===Zy&&(r=Kd),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(LT)}}function BJ(t){this.setState(t.target.value)}function UJ(t,e,n){zJ(t,e),e.set(t,n)}function zJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zm(t,e){var n=OH(t,e,"get");return GJ(t,n)}function GJ(t,e){return e.get?e.get.call(t):e.value}function YJ(t,e,n){var r=OH(t,e,"set");return jJ(t,r,n),n}function OH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function jJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Zl=new WeakMap;class Xu extends Wr{static get DEFAULTS(){return Ln({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,Ut(Xu.DEFAULTS,n)),UJ(this,Zl,{writable:!0,value:void 0})}build(){super.build(),YJ(this,Zl,this._element.firstChild)}update(){this.isBuilt()&&(Zm(this,Zl).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Zm(this,Zl).focus()}activate(){Zm(this,Zl).click()}}function Mh(t,e){PH(t,e),e.add(t)}function Pa(t,e,n){PH(t,e),e.set(t,n)}function PH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ah(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function He(t,e){var n=IH(t,e,"get");return KJ(t,n)}function KJ(t,e){return e.get?e.get.call(t):e.value}function Or(t,e,n){var r=IH(t,e,"set");return XJ(t,r,n),n}function IH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function XJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const $T="multipleSelect.itemBox";var Dr=new WeakMap,Tt=new WeakMap,Qm=new WeakMap,Ii=new WeakMap,vo=new WeakMap,So=new WeakMap,FT=new WeakSet,WT=new WeakSet,VT=new WeakSet,BT=new WeakSet;class qu extends Wr{static get DEFAULTS(){return Ln({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,Ut(qu.DEFAULTS,n)),Mh(this,BT),Mh(this,VT),Mh(this,WT),Mh(this,FT),Pa(this,Dr,{writable:!0,value:[]}),Pa(this,Tt,{writable:!0,value:void 0}),Pa(this,Qm,{writable:!0,value:void 0}),Pa(this,Ii,{writable:!0,value:void 0}),Pa(this,vo,{writable:!0,value:void 0}),Pa(this,So,{writable:!0,value:void 0}),Or(this,Ii,new Fo(this.hot,{placeholder:ly,className:"htUIMultipleSelectSearch"})),Or(this,vo,new Xu(this.hot,{textContent:iy,className:"htUISelectAll"})),Or(this,So,new Xu(this.hot,{textContent:oy,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return He(this,Tt)}registerHooks(){He(this,Ii).addLocalHook("keydown",e=>Ah(this,WT,ZJ).call(this,e)),He(this,Ii).addLocalHook("input",e=>Ah(this,FT,qJ).call(this,e)),He(this,vo).addLocalHook("click",e=>Ah(this,VT,QJ).call(this,e)),He(this,So).addLocalHook("click",e=>Ah(this,BT,JJ).call(this,e))}setItems(e){Or(this,Dr,e),He(this,Tt)&&He(this,Tt).loadData(He(this,Dr))}setLocale(e){Or(this,Qm,e)}getLocale(){return He(this,Qm)}getItems(){return[...He(this,Dr)]}getValue(){return tee(He(this,Dr))}getSearchInputElement(){return He(this,Ii)}getSelectAllElement(){return He(this,vo)}getClearAllElement(){return He(this,So)}isSelectedAllValues(){return He(this,Dr).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new Wr(this.hot,{className:"htUISelectionControls",children:[He(this,vo),He(this,So)]});this._element.appendChild(He(this,Ii).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{if(!this._element)return;He(this,Tt)&&He(this,Tt).destroy(),ee(o,"htUIMultipleSelectHot"),Or(this,Tt,new this.hot.constructor(o,{data:He(this,Dr),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,h,f,g)=>{l.title=g.instance.getDataAtRowProp(u,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{He(this,Tt).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>He(this,Tt).container.scrollWidth-Jt(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),He(this,Tt).init();const a=He(this,Tt).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:$T}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{He(this,Tt).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:$T})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&He(this,Tt).listen()}reset(){He(this,Ii).reset(),He(this,vo).reset(),He(this,So).reset()}update(){this.isBuilt()&&(He(this,Tt).loadData(eee(He(this,Dr),this.options.value)),super.update())}destroy(){He(this,Tt)&&He(this,Tt).destroy(),He(this,Ii).destroy(),He(this,So).destroy(),He(this,vo).destroy(),Or(this,Ii,null),Or(this,So,null),Or(this,vo,null),Or(this,Tt,null),Or(this,Dr,null),super.destroy()}}function qJ(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...He(this,Dr)]:n=or(He(this,Dr),r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),He(this,Tt).loadData(n)}function ZJ(t){this.runLocalHooks("keydown",t,this),sv(ml,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),br(t),He(this,Tt).listen(),He(this,Tt).selectCell(0,0))}function QJ(t){const e=[];t.preventDefault(),T(He(this,Tt).getSourceData(),(n,r)=>{n.checked=!0,e.push($v(n,r)[0])}),He(this,Tt).setSourceDataAtCell(e)}function JJ(t){const e=[];t.preventDefault(),T(He(this,Tt).getSourceData(),(n,r)=>{n.checked=!1,e.push($v(n,r)[0])}),He(this,Tt).setSourceDataAtCell(e)}function eee(t,e){const n=yc(e);return Ve(t,r=>(r.checked=n(r.value),r))}function tee(t){const e=[];return T(t,n=>{n.checked&&e.push(n.value)}),e}function nee(t,e){ree(t,e),e.add(t)}function ree(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iee(t,e,n){return e=oee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oee(t){var e=see(t,"string");return typeof e=="symbol"?e:String(e)}function see(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var UT=new WeakSet;class lee extends Sc{constructor(e,n){super(e,{id:n.id,stateless:!1}),nee(this,UT),iee(this,"name",""),this.name=n.name,this.elements.push(new qu(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>aee(this,UT,uee).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===ks){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?on:ks},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=or(i,h=>h.name===ks),u={},c=this.hot.getTranslatedPhrase(Fd);if(l){const h=Jw(Ve(s(r,a),C=>C.value));o&&(l.args[0]=o);const f=[],g=bT(h,l.args[0],c,C=>{C.checked&&f.push(C.value)}),w=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,w).locale,u.args=[f],u.command=Ls(ks),u.itemsSnapshot=g}else u.args=[],u.command=Ls(on);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof qu)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{ee(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return ee(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),T(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Fd),n=Jw(this._getColumnVisibleValues()),r=bT(n,n,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(n);const i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ve(this.hot.getDataAtCol(e.visualIndex),n=>yH(n))}}function uee(t){ml(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),br(t))}var xH;function cee(t,e){hee(t,e),e.add(t)}function hee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dee(t,e,n){return e=fee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fee(t){var e=gee(t,"string");return typeof e=="symbol"?e:String(e)}function gee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var zT=new WeakSet;class Zu extends Sc{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),cee(this,zT),dee(this,"name",""),this.name=n.name,this.elements.push(new Fo(this.hot,{type:"button",value:sy,className:"htUIButton htUIButtonOK",identifier:Zu.BUTTON_OK})),this.elements.push(new Fo(this.hot,{type:"button",value:ay,className:"htUIButton htUIButtonCancel",identifier:Zu.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){T(this.elements,e=>{e.addLocalHook("click",(n,r)=>mee(this,zT,pee).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(ee(n.parentNode,"htFiltersMenuActionBar"),T(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}xH=Zu;function pee(t,e){e.options.identifier===xH.BUTTON_OK?this.accept():this.cancel()}function Jm(t,e,n){return e=wee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wee(t){var e=Cee(t,"string");return typeof e=="symbol"?e:String(e)}function Cee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const GT="ConditionCollection.filteringStates";class HH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Jm(this,"hot",void 0),Jm(this,"isMapRegistrable",void 0),Jm(this,"filteringStates",new Ff),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(GT,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$o;return e.length?nJ(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$o,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=Ve(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(ct`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(mt(ju[r]))throw new Error(ct`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:Yo(a,s)}]},i):u.push({name:a,args:s,func:Yo(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Ft(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:Ve(o,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),T(e,n=>{T(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(GT),this.filteringStates=null,this.clearLocalHooks()}}dt(HH,Qn);const DH=HH;function YT(t,e,n){return e=vee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vee(t){var e=See(t,"string");return typeof e=="symbol"?e:String(e)}function See(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yee{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];YT(this,"conditionCollection",void 0),YT(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return T(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return T(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return T(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}const NH=yee;function ep(t,e){bee(t,e),e.add(t)}function bee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cs(t,e,n){return e=Ree(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ree(t){var e=Eee(t,"string");return typeof e=="symbol"?e:String(e)}function Eee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tp(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var jT=new WeakSet,KT=new WeakSet,XT=new WeakSet;class LH{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];ep(this,XT),ep(this,KT),ep(this,jT),Cs(this,"hot",void 0),Cs(this,"conditionCollection",void 0),Cs(this,"columnDataFactory",void 0),Cs(this,"changes",[]),Cs(this,"grouping",!1),Cs(this,"latestEditedColumnPosition",-1),Cs(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>tp(this,jT,Tee).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>tp(this,KT,_ee).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>tp(this,XT,Mee).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,T(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=EI(function(c,h){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const g=new DH(r.hot,!1),w=[].concat(c,f);g.importAllConditions(w);const C=r.columnDataFactory(h);let S;g.isEmpty()?S=C:S=new NH(g,_=>r.columnDataFactory(_)).filter(),S=Ve(S,_=>_.meta.visualRow);const b=yc(S);return g.destroy(),or(C,_=>b(_.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Be(this,(e,n)=>{this[n]=null})}}function Tee(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function _ee(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Mee(){T(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}dt(LH,Qn);const Aee=LH;function Oee(t){return Z1({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof qu)return r;if(i.element&&!Uo(i.element))return!1;i.focus()}})}const Ql="filters";function Pee(t,e){const n=Oee(e),r=s=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(Ql),n.setCurrentPage(e.indexOf(s))};e.forEach(s=>{s instanceof Wr&&(s.addLocalHook("click",r(s)),s.addLocalHook("focus",r(s)),s.addLocalHook("afterClose",r(s)))}),t.addLocalHook("afterSelectionChange",s=>{s.key.startsWith("filter_")||n.clear()});function i(s){const a=t.getKeyboardShortcutsCtrl(),l=s.getKeyboardShortcutsCtrl();n.clear(),l.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:a.getContext(Ql),callback:()=>{s.isSubMenu()&&s.close(),a.listen(Ql)}}]),!s.isSubMenu()&&a.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:u=>{t.getNavigator().clear(),u.shiftKey?n.toPreviousItem():n.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:u=>{const c=e[n.getCurrentPage()];c instanceof Ku&&(c.openOptions(),u.preventDefault()),c instanceof Xu&&(c.activate(),u.preventDefault()),c instanceof Wr||u.preventDefault()}}],Ql)}t.addLocalHook("afterSubmenuOpen",i),t.addLocalHook("afterOpen",i);function o(){t.focus(),t.getKeyboardShortcutsCtrl().listen(Ql)}return{...n,listen:o}}function xi(t,e){kH(t,e),e.add(t)}function Iee(t,e,n){kH(t,e),e.set(t,n)}function kH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jl(t,e,n){return e=xee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xee(t){var e=Hee(t,"string");return typeof e=="symbol"?e:String(e)}function Hee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dee(t,e,n){var r=$H(t,e,"set");return Nee(t,r,n),n}function Nee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Oh(t,e){var n=$H(t,e,"get");return Lee(t,n)}function $H(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Lee(t,e){return e.get?e.get.call(t):e.value}function Pr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const tC="filters",kee=250,qT=tC;var Ia=new WeakMap,ZT=new WeakSet,QT=new WeakSet,JT=new WeakSet,e_=new WeakSet,np=new WeakSet,t_=new WeakSet,rp=new WeakSet,n_=new WeakSet,r_=new WeakSet;class $ee extends nt{static get PLUGIN_KEY(){return tC}static get PLUGIN_PRIORITY(){return kee}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),xi(this,r_),xi(this,n_),xi(this,rp),xi(this,t_),xi(this,np),xi(this,e_),xi(this,JT),xi(this,QT),xi(this,ZT),Jl(this,"dropdownMenuPlugin",null),Jl(this,"conditionCollection",null),Jl(this,"conditionUpdateObserver",null),Jl(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Jl(this,"filtersRowsMap",null),Iee(this,Ia,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(n,r)=>Pr(this,n_,zee).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[tC]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new fc),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>Pr(this,np,i_).call(this,"accept")),s.addLocalHook("cancel",()=>Pr(this,np,i_).call(this,"cancel")),s.addLocalHook("change",a=>Pr(this,t_,Uee).call(this,s,a)),s),i=()=>`${this.hot.getTranslatedPhrase(ty)}:`,o=()=>`${this.hot.getTranslatedPhrase(ny)}:`;if(!this.components.get("filter_by_condition")){const s=new eC(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>Pr(this,rp,o_).call(this)),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new VJ(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new eC(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>Pr(this,rp,o_).call(this)),this.components.set("filter_by_condition2",r(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new lee(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Zu(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new DH(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new Aee(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>Pr(this,r_,Gee).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>Pr(this,e_,Bee).call(this,s)),this.addHook("afterDropdownMenuShow",()=>Pr(this,QT,Wee).call(this)),this.addHook("afterDropdownMenuHide",()=>Pr(this,JT,Vee).call(this)),this.addHook("afterChange",s=>Pr(this,ZT,Fee).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Oh(this,Ia)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>s.focus()},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];Dee(this,Ia,Pee(s,a));const l=u=>{Oh(this,Ia).listen(),u.preventDefault(),ml(u.keyCode,"TAB")&&(u.shiftKey?Oh(this,Ia).toPreviousItem():Oh(this,Ia).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:qT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(qT)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:$o;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ve(n.filter(),u=>u.meta.visualRow);const l=yc(i);pe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),T(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return T(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:f,dateFormat:g,locale:w}=this.hot.getCellMeta(o,n),C=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:f,dateFormat:g,locale:w},value:yH(C)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=Jw(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Kd&&n.command.key!==on&&r.command.key!==on&&i.command.key!==on?o=Zy:i.command.key!==on&&(n.command.key===on||r.command.key===on)&&(o=$o),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new NH(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return T(i,s=>{T(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Fee(t){t&&T(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Wee(){this.restoreComponents(Array.from(this.components.values()))}function Vee(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Bee(t){t.items.push({name:Ge}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function i_(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==on&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==on&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==on&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Uee(t,e){this.updateDependentComponentsVisibility(),t.constructor===eC&&!e.inputsCount&&this.setListeningDropdownMenu()}function o_(){this.setListeningDropdownMenu()}function zee(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?ee(e,"htFiltersActive"):De(e,"htFiltersActive")}function Gee(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(s=>s.name===ks),o=n.filter(s=>s.name!==ks);if(i.length>=2||o.length>=3)pt(ct`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(s,r),this.components.get("filter_by_value").updateState(t)}}const FH="internal-use-in-handsontable",nC={licenseKey:FH,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function WH(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[vn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function VH(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Yee(t){var e;const n=t[vn],r=VH(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=WH(t);return{...nC,...r,...i}}function jee(t){var e;const n=t[vn],r=VH(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=WH(t);return{...r,...i}}function Kee(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function ig(){const t="engine_relationship",e=Yr(vn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Qy(){const t="shared_engine_usage",e=Yr(vn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Xee(t){const e=t.getSettings(),n=e[vn],r=n==null?void 0:n.engine;if(n===!0||mt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return qee((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&mt(r.hyperformula)){const o=ig(),s=Qy().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:FH}),(r.getConfig().leapYear1900!==nC.leapYear1900||If(r.getConfig().nullDate,nC.nullDate)===!1)&&pt(ct`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function qee(t,e,n){const r=e[vn],i=Yee(e),o=ig(),s=Qy();Zee(t,r.functions),Qee(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Jee(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function s_(t){var e;const n=ig(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function a_(t,e){if(t){const n=ig(),r=n.get(t),i=Qy(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Zee(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){pt(s.message)}})}function Qee(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){pt(r.message)}}}function Jee(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){pt(a.message)}}),t.resumeEvaluation())}function ete(t,e){return(mt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const BH="DD/MM/YYYY";function UH(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function tte(t){return UH(t)?t.substr(1):t}function nte(t){return typeof t=="string"&&t.startsWith("=")}function Jy(t,e){return typeof t=="string"&&e==="date"}function zH(t,e){return J(t,e,!0).isValid()}function GH(t,e){return J(t,e,!0).format(BH)}function rte(t,e){return J(t,BH,!0).format(e)}function YH(t,e){const r=new Date(Date.UTC(0,0,t+-1));return J(r).format(e)}function vs(t,e,n){ite(t,e),e.set(t,n)}function ite(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vt(t,e){var n=jH(t,e,"get");return ote(t,n)}function ote(t,e){return e.get?e.get.call(t):e.value}function yo(t,e,n){var r=jH(t,e,"set");return ste(t,r,n),n}function jH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ste(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var eu=new WeakMap,bo=new WeakMap,Jn=new WeakMap,Ph=new WeakMap,ip=new WeakMap,op=new WeakMap,Ih=new WeakMap;class ate{constructor(e,n,r){vs(this,eu,{writable:!0,value:void 0}),vs(this,bo,{writable:!0,value:void 0}),vs(this,Jn,{writable:!0,value:void 0}),vs(this,Ph,{writable:!0,value:[]}),vs(this,ip,{writable:!0,value:[]}),vs(this,op,{writable:!0,value:void 0}),vs(this,Ih,{writable:!0,value:[]}),yo(this,eu,e),yo(this,bo,n),yo(this,Jn,r)}setRemovedHfIndexes(e){return yo(this,Ih,e.map(n=>{const r=vt(this,bo).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),vt(this,Ih)}getRemovedHfIndexes(){return vt(this,Ih)}getHfIndexFromVisualIndex(e){const n=vt(this,bo).getIndexesSequence(),r=vt(this,bo).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${yn(vt(this,eu))}s`;vt(this,Jn).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&vt(this,Jn).getEngine()[r](vt(this,Jn).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(yo(this,ip,e.map(i=>this.getHfIndexFromVisualIndex(i))),yo(this,op,this.getHfIndexFromVisualIndex(n)))}getMoveLine(e,n){const r=vt(this,bo).getNumberOfIndexes(),i=Array.from(Array(r).keys()).filter(s=>e.includes(s)===!1);if(n===0){var o;return(o=i[n])!==null&&o!==void 0?o:0}return i[n-1]+1}getInitiallyCalculatedMoves(e,n){let r=this.getMoveLine(e,n);const i=[];return e.forEach(o=>{const s={from:o,to:r};i.forEach(a=>{const l=a.from>a.to,u=a.to<=s.from;a.from>s.from&&u&&l&&(s.from+=1)}),s.from>=r&&(r+=1),i.push(s)}),i}adjustedCalculatedMoves(e){return e.forEach((n,r)=>{e.slice(r+1).forEach(o=>{const s=o.from<o.to;o.from>n.from&&s&&(o.from-=1)})}),e}calculateAndSyncMoves(e,n){if(vt(this,Jn).isPerformingUndoRedo()||e===!1||n===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(vt(this,ip),vt(this,op)));vt(this,Jn).getSheetId()===null?vt(this,Jn).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${yn(vt(this,eu))}Order`;return n=>{if(vt(this,Jn).isPerformingUndoRedo())return;const r=vt(this,bo).getIndexesSequence();if(n==="update"){const i=vt(this,Ph).map(l=>r.indexOf(l)),o=vt(this,Jn).getEngine().getSheetDimensions(vt(this,Jn).getSheetId());let s;vt(this,eu)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);vt(this,Jn).getEngine()[e](vt(this,Jn).getSheetId(),i)}yo(this,Ph,r)}}init(){yo(this,Ph,vt(this,bo).getIndexesSequence())}}const l_=ate;function Ss(t,e,n){lte(t,e),e.set(t,n)}function lte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hi(t,e){var n=KH(t,e,"get");return ute(t,n)}function ute(t,e){return e.get?e.get.call(t):e.value}function ys(t,e,n){var r=KH(t,e,"set");return cte(t,r,n),n}function KH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function cte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var xh=new WeakMap,Hh=new WeakMap,sp=new WeakMap,ap=new WeakMap,lp=new WeakMap,up=new WeakMap,cp=new WeakMap;class hte{constructor(e,n,r){Ss(this,xh,{writable:!0,value:void 0}),Ss(this,Hh,{writable:!0,value:void 0}),Ss(this,sp,{writable:!0,value:void 0}),Ss(this,ap,{writable:!0,value:!1}),Ss(this,lp,{writable:!0,value:!1}),Ss(this,up,{writable:!0,value:null}),Ss(this,cp,{writable:!0,value:null}),ys(this,xh,new l_("row",e,this)),ys(this,Hh,new l_("column",n,this)),ys(this,sp,r)}getForAxis(e){return e==="row"?Hi(this,xh):Hi(this,Hh)}setPerformUndo(e){ys(this,ap,e)}setPerformRedo(e){ys(this,lp,e)}isPerformingUndoRedo(){return Hi(this,ap)||Hi(this,lp)}getSheetId(){return Hi(this,cp)}getEngine(){return Hi(this,up)}getPostponeAction(){return Hi(this,sp)}setupSyncEndpoint(e,n){ys(this,up,e),ys(this,cp,n),Hi(this,xh).init(),Hi(this,Hh).init()}}const dte=hte;function Et(t,e){XH(t,e),e.add(t)}function xa(t,e,n){return e=fte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fte(t){var e=gte(t,"string");return typeof e=="symbol"?e:String(e)}function gte(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hp(t,e,n){XH(t,e),e.set(t,n)}function XH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jo(t,e,n){var r=qH(t,e,"set");return mte(t,r,n),n}function mte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function rl(t,e){var n=qH(t,e,"get");return pte(t,n)}function qH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function pte(t,e){return e.get?e.get.call(t):e.value}function ft(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const vn="formulas",wte=["maxRows","maxColumns","language"],Cte=260;fe.getSingleton().register("afterNamedExpressionAdded");fe.getSingleton().register("afterNamedExpressionRemoved");fe.getSingleton().register("afterSheetAdded");fe.getSingleton().register("afterSheetRemoved");fe.getSingleton().register("afterSheetRenamed");fe.getSingleton().register("afterFormulasValuesUpdate");const Sl=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var no=new WeakMap,eb=new WeakMap,tu=new WeakMap,u_=new WeakSet,c_=new WeakSet,dp=new WeakSet,h_=new WeakSet,fp=new WeakSet,d_=new WeakSet,f_=new WeakSet,gp=new WeakSet,g_=new WeakSet,m_=new WeakSet,p_=new WeakSet,w_=new WeakSet,C_=new WeakSet,v_=new WeakSet,S_=new WeakSet,y_=new WeakSet,b_=new WeakSet,R_=new WeakSet,E_=new WeakSet,T_=new WeakSet,__=new WeakSet,M_=new WeakSet,A_=new WeakSet,O_=new WeakSet;class vte extends nt{constructor(){var e;super(...arguments),e=this,Et(this,O_),Et(this,A_),Et(this,M_),Et(this,__),Et(this,T_),Et(this,E_),Et(this,R_),Et(this,b_),Et(this,y_),Et(this,S_),Et(this,v_),Et(this,C_),Et(this,w_),Et(this,p_),Et(this,m_),Et(this,g_),Et(this,gp),Et(this,f_),Et(this,d_),Et(this,fp),Et(this,h_),Et(this,dp),Et(this,c_),Et(this,u_),hp(this,no,{writable:!0,value:!1}),hp(this,eb,{writable:!0,value:!1}),hp(this,tu,{writable:!0,value:[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,E_,Nte).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,T_,Lte).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,__,kte).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,M_,$te).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,A_,Fte).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,O_,Wte).call(e,...r)}]]}),xa(this,"staticRegister",Yr("formulas")),xa(this,"engine",null),xa(this,"sheetName",null),xa(this,"indexSyncer",null),xa(this,"rowAxisSyncer",null),xa(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return vn}static get PLUGIN_PRIORITY(){return Cte}static get SETTING_KEYS(){return[vn,...wte]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[vn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Xee(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){pt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,dp,P_).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,fp,I_).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,dp,P_).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,fp,I_).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,d_,Rte).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,f_,Ete).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,u_,Ste).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,g_,Tte).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,gp,x_).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,gp,x_).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,m_,_te).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,p_,Mte).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,v_,Pte).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,S_,Ite).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,w_,Ate).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,C_,Ote).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,y_,xte).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,b_,Hte).call(n,...i)}),this.indexSyncer=new dte(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,h_,bte).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,R_,Dte).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,c_,yte).call(n,...i)}),rl(this,tu).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){rl(this,tu).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),a_(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=jee(this.hot.getSettings());Kee(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[vn];if(le(r)&&le(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[vn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){rl(this,tu).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),jo(this,tu,null),a_(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(le(n)&&!Ix(n))return pt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return pt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return pt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){dv(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${yn(vn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),s_(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return le(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(le(l)===!1||le(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const f=s_(this.engine).get(c);if(!f)return;f.validateCell(f.getDataAtCell(l,u),f.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){pt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return Jy(r,o.type)&&(zH(r,o.dateFormat)?r=GH(r,o.dateFormat):nte(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function Ste(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Nn(s)&&(s=YH(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function yte(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(f)===!1)return!1;const g=this.engine.getFillRangeData(h,f),{row:w,col:C}=h.start,{row:S,col:b}=h.end,_=S-w+1,O=b-C+1;for(let x=0;x<g.length;x+=1)for(let I=0;I<g[x].length;I+=1){const $=g[x][I],z=x%_,q=I%O,Y=this.hot.getCellMeta(z,q);Jy($,Y.type)&&($.startsWith("'")?g[x][I]=$.slice(1):this.isFormulaCellType(z,q,this.sheetId)===!1&&(g[x][I]=rte($,Y.dateFormat)))}return g}function P_(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(yn(vn))||jo(this,eb,mt(this.hot.getSettings().data))}function bte(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o),a=s.dateFormat;Jy(i,s.type)&&(e=!0,zH(i,a)?t[r][o]=GH(i,a):this.isFormulaCellType(r,o)===!1&&(t[r][o]=`'${i}`))})}),e===!0&&(jo(this,no,!0),this.engine.setSheetContent(this.sheetId,t),jo(this,no,!1))}function I_(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(yn(vn)))if(this.sheetName=ete(this.engine,this.hot.getSettings()[vn].sheetName),rl(this,eb))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){jo(this,no,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),jo(this,no,!1)}}}function Rte(t,e,n,r){if(r!=="get"||rl(this,no)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){UH(n.value)&&(n.value=tte(n.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e);l.type==="date"&&Nn(a)&&(a=YH(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function Ete(t,e,n,r){if(r!=="get"||rl(this,no)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null||!this.isFormulaCellType(i,o)&&this.getCellType(i,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function x_(t,e){if(Sl(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),f={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:f})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Tte(t,e){if(Sl(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Nn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){pt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function _te(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Mte(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Ate(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Ote(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Pte(t,e,n){if(Sl(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Ite(t,e,n){if(Sl(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function xte(t,e,n,r){if(Sl(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Hte(t,e,n,r){if(Sl(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Dte(t,e,n){var r;jo(this,no,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());jo(this,no,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function Nte(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Lte(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function kte(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function $te(t){this.hot.runHooks("afterSheetAdded",t)}function Fte(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}function Wte(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Vte(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(xS,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Bte(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(HS,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ve(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,f=l-a+1;if(h>f){const g=u.slice(i,o+1);c.push(...g.filter(w=>n.includes(w)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===f&&h>o&&c.push(...u.slice(o+1))}return T(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function bs(t,e){ZH(t,e),e.add(t)}function H_(t,e,n){ZH(t,e),e.set(t,n)}function ZH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rs(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function nr(t,e){var n=QH(t,e,"get");return Ute(t,n)}function Ute(t,e){return e.get?e.get.call(t):e.value}function nu(t,e,n){var r=QH(t,e,"set");return zte(t,r,n),n}function QH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function zte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}fe.getSingleton().register("beforeHideColumns");fe.getSingleton().register("afterHideColumns");fe.getSingleton().register("beforeUnhideColumns");fe.getSingleton().register("afterUnhideColumns");const mp="hiddenColumns",Gte=310,JH="beforeHiddenColumnIndicator",eD="afterHiddenColumnIndicator";var di=new WeakMap,ri=new WeakMap,D_=new WeakSet,N_=new WeakSet,L_=new WeakSet,k_=new WeakSet,$_=new WeakSet,F_=new WeakSet,W_=new WeakSet;class Yte extends nt{constructor(){super(...arguments),bs(this,W_),bs(this,F_),bs(this,$_),bs(this,k_),bs(this,L_),bs(this,N_),bs(this,D_),H_(this,di,{writable:!0,value:{}}),H_(this,ri,{writable:!0,value:null})}static get PLUGIN_KEY(){return mp}static get PLUGIN_PRIORITY(){return Gte}isEnabled(){return!!this.hot.getSettings()[mp]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[mp];$e(n)&&(nu(this,di,n),mt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),nu(this,ri,new $f),nr(this,ri).addLocalHook("init",()=>Rs(this,W_,Jte).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,nr(this,ri)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rs(e,F_,Qte).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>Rs(this,L_,Xte).call(this,r,i,o)),this.addHook("modifyColWidth",(r,i)=>Rs(this,N_,Kte).call(this,r,i)),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rs(e,$_,Zte).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Rs(this,k_,qte).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=(n,r)=>{Rs(this,D_,jte).call(this,r)};this.hot.columnIndexMapper.unregisterMap(this.pluginName),nu(this,di,{}),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=nr(this,ri).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));T(l,u=>{o[u]=!1}),i=Ft(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&nr(this,ri).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{nr(this,ri).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ve(nr(this,ri).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return nr(this,ri).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){T(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){nu(this,di,null),nu(this,ri,null),super.destroy()}}function jte(t){Array.from(t.querySelectorAll(`.${eD}, .${JH}`)).forEach(e=>{e.remove()})}function Kte(t,e){if(this.isHidden(e))return 0;if(nr(this,di).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Xte(t,e,n){if(nr(this,di).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function qte(t){if(nr(this,di).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return T(t,r=>{let i=!0,o=0;pe(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Zte(t,e){const n=this.hot.getSettings().ariaTags,r=e.querySelector(".beforeHiddenColumnIndicator"),i=e.querySelector(".afterHiddenColumnIndicator");if(!nr(this,di).indicators||t<0){r==null||r.remove(),i==null||i.remove();return}const o=[];if(t>=1&&this.isHidden(t-1)){if(!i){const s=n?[Wo(this.hot.getTranslatedPhrase(Sy))]:[];Bs(e,{tagName:"div",attributes:s,className:eD})}o.push("afterHiddenColumn")}if(t<this.hot.countCols()-1&&this.isHidden(t+1)){if(!r){const s=n?[Wo(this.hot.getTranslatedPhrase(vy))]:[];Bs(e,{tagName:"div",attributes:s,className:JH})}o.push("beforeHiddenColumn")}ee(e,o)}function Qte(t){t.items.push({name:Ge},Vte(this),Bte(this))}function Jte(){Array.isArray(nr(this,di).columns)&&this.hideColumns(nr(this,di).columns)}function ene(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(DS,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function tne(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(NS,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ve(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,f=l-a+1;if(h>f){const g=u.slice(i,o+1);c.push(...g.filter(w=>n.includes(w)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===f&&h>o&&c.push(...u.slice(o+1))}return T(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Es(t,e){tD(t,e),e.add(t)}function V_(t,e,n){tD(t,e),e.set(t,n)}function tD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ts(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function pr(t,e){var n=nD(t,e,"get");return nne(t,n)}function nne(t,e){return e.get?e.get.call(t):e.value}function ru(t,e,n){var r=nD(t,e,"set");return rne(t,r,n),n}function nD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function rne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}fe.getSingleton().register("beforeHideRows");fe.getSingleton().register("afterHideRows");fe.getSingleton().register("beforeUnhideRows");fe.getSingleton().register("afterUnhideRows");const pp="hiddenRows",ine=320,rD="afterHiddenRowIndicator",iD="beforeHiddenRowIndicator";var Xi=new WeakMap,ii=new WeakMap,B_=new WeakSet,U_=new WeakSet,z_=new WeakSet,G_=new WeakSet,Y_=new WeakSet,j_=new WeakSet,K_=new WeakSet;class one extends nt{constructor(){super(...arguments),Es(this,K_),Es(this,j_),Es(this,Y_),Es(this,G_),Es(this,z_),Es(this,U_),Es(this,B_),V_(this,Xi,{writable:!0,value:{}}),V_(this,ii,{writable:!0,value:null})}static get PLUGIN_KEY(){return pp}static get PLUGIN_PRIORITY(){return ine}isEnabled(){return!!this.hot.getSettings()[pp]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[pp];$e(n)&&(ru(this,Xi,n),mt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),ru(this,ii,new $f),pr(this,ii).addLocalHook("init",()=>Ts(this,K_,dne).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,pr(this,ii)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ts(e,j_,hne).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>Ts(this,z_,lne).call(this,r,i,o)),this.addHook("modifyRowHeight",(r,i)=>Ts(this,U_,ane).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ts(e,Y_,cne).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Ts(this,G_,une).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=(n,r)=>{Ts(this,B_,sne).call(this,r)};this.hot.rowIndexMapper.unregisterMap(this.pluginName),ru(this,Xi,{}),this.hot.addHook("afterGetRowHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetRowHeader",e)}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=pr(this,ii).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));T(l,u=>{o[u]=!1}),i=Ft(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&pr(this,ii).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{pr(this,ii).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ve(pr(this,ii).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return pr(this,ii).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){T(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){ru(this,Xi,null),ru(this,ii,null),super.destroy()}}function sne(t){Array.from(t.querySelectorAll(`.${rD}, .${iD}`)).forEach(e=>{e.remove()})}function ane(t,e){return this.isHidden(e)?0:t}function lne(t,e,n){if(pr(this,Xi).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function une(t){if(pr(this,Xi).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return T(t,r=>{let i=!0,o=0;pe(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function cne(t,e){const n=this.hot.getSettings().ariaTags,r=e.querySelector(".beforeHiddenRowIndicator"),i=e.querySelector(".afterHiddenRowIndicator");if(!pr(this,Xi).indicators||t<0){r==null||r.remove(),i==null||i.remove();return}const o=[];if(t>=1&&this.isHidden(t-1)){if(!i){const s=n?[Wo(this.hot.getTranslatedPhrase(Ey))]:[];Bs(e,{tagName:"div",attributes:s,className:rD})}o.push("afterHiddenRow")}if(t<this.hot.countRows()-1&&this.isHidden(t+1)){if(!r){const s=n?[Wo(this.hot.getTranslatedPhrase(Ry))]:[];Bs(e,{tagName:"div",attributes:s,className:iD})}o.push("beforeHiddenRow")}ee(e,o)}function hne(t){t.items.push({name:Ge},ene(this),tne(this))}function dne(){Array.isArray(pr(this,Xi).rows)&&this.hideRows(pr(this,Xi).rows)}function fne(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(lS)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function gne(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(uS)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function X_(t,e){oD(t,e),e.add(t)}function mne(t,e,n){oD(t,e),e.set(t,n)}function oD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rC(t,e){var n=sD(t,e,"get");return pne(t,n)}function pne(t,e){return e.get?e.get.call(t):e.value}function wp(t,e,n){var r=sD(t,e,"set");return wne(t,r,n),n}function sD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function wne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function q_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("beforeColumnFreeze");fe.getSingleton().register("afterColumnFreeze");fe.getSingleton().register("beforeColumnUnfreeze");fe.getSingleton().register("afterColumnUnfreeze");const Z_="manualColumnFreeze",Cne=110;var xs=new WeakMap,Q_=new WeakSet,J_=new WeakSet;class vne extends nt{constructor(){super(...arguments),X_(this,J_),X_(this,Q_),mne(this,xs,{writable:!0,value:!1})}static get PLUGIN_KEY(){return Z_}static get PLUGIN_PRIORITY(){return Cne}isEnabled(){return!!this.hot.getSettings()[Z_]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>q_(this,Q_,Sne).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>q_(this,J_,yne).call(this,e,n)),super.enablePlugin())}disablePlugin(){wp(this,xs,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;rC(this,xs)||wp(this,xs,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;rC(this,xs)||wp(this,xs,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Sne(t){t.items.push({name:"---------"},fne(this),gne(this))}function yne(t,e){if(rC(this,xs)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Dh(t,e,n){return e=bne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bne(t){var e=Rne(t,"string");return typeof e=="symbol"?e:String(e)}function Rne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Cp=0,eM=1,tM=2,Ha="px";let Ene=class{constructor(e){Dh(this,"hot",void 0),Dh(this,"_element",null),Dh(this,"state",Cp),Dh(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=tM}build(){this.state===Cp&&(this._element=this.hot.rootDocument.createElement("div"),this.state=eM)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Cp}isAppended(){return this.state===tM}isBuilt(){return this.state>=eM}setPosition(e,n){Nn(e)&&(this._element.style.top=e+Ha),Nn(n)&&(this._element.style[this.inlineProperty]=n+Ha)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Nn(e)&&(this._element.style.width=e+Ha),Nn(n)&&(this._element.style.height=n+Ha)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Nn(e)&&(this._element.style.marginTop=e+Ha),Nn(n)&&(this._element.style[`margin${yn(this.inlineProperty)}`]=n+Ha)}getOffset(){const e=this._element.style,n=`margin${yn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const aD=Ene,Tne="ht__manualColumnMove--backlight";let _ne=class extends aD{build(){super.build(),ee(this._element,Tne)}};const Mne=_ne,Ane="ht__manualColumnMove--guideline";let One=class extends aD{build(){super.build(),ee(this._element,Ane)}};const Pne=One;function Da(t,e){lD(t,e),e.add(t)}function Di(t,e,n){lD(t,e),e.set(t,n)}function lD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nM(t,e,n){return e=Ine(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ine(t){var e=xne(t,"string");return typeof e=="symbol"?e:String(e)}function xne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kn(t,e,n){var r=uD(t,e,"set");return Hne(t,r,n),n}function Hne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ne(t,e){var n=uD(t,e,"get");return Dne(t,n)}function uD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Dne(t,e){return e.get?e.get.call(t):e.value}function Na(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("beforeColumnMove");fe.getSingleton().register("afterColumnMove");const vp="manualColumnMove",Nne=120,rM="ht__manualColumnMove",qd="show-ui",iC="on-moving--columns",oC="after-selection--columns";var qi=new WeakMap,fd=new WeakMap,xo=new WeakMap,Dn=new WeakMap,Nh=new WeakMap,fr=new WeakMap,Ya=new WeakMap,Zd=new WeakMap,Mu=new WeakMap,iM=new WeakSet,oM=new WeakSet,sM=new WeakSet,aM=new WeakSet,lM=new WeakSet,uM=new WeakSet;class Lne extends nt{constructor(){super(...arguments),Da(this,uM),Da(this,lM),Da(this,aM),Da(this,sM),Da(this,oM),Da(this,iM),nM(this,"backlight",new Mne(this.hot)),nM(this,"guideline",new Pne(this.hot)),Di(this,qi,{writable:!0,value:[]}),Di(this,fd,{writable:!0,value:0}),Di(this,xo,{writable:!0,value:!1}),Di(this,Dn,{writable:!0,value:{}}),Di(this,Nh,{writable:!0,value:void 0}),Di(this,fr,{writable:!0,value:void 0}),Di(this,Ya,{writable:!0,value:void 0}),Di(this,Zd,{writable:!0,value:void 0}),Di(this,Mu,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return vp}static get PLUGIN_PRIORITY(){return Nne}isEnabled(){return!!this.hot.getSettings()[vp]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Na(e,iM,kne).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Na(e,sM,Fne).call(e,...r)}),this.addHook("afterScrollVertically",()=>Na(this,lM,Vne).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Na(e,uM,Bne).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),ee(this.hot.rootElement,rM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){De(this.hot.rootElement,rM),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=Ne(this,Nh),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Kn(this,Nh,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Kn(this,Nh,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Ft(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[vp];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return pe(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Ne(this,fr))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Ne(this,fr)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=this.backlight.getOffset().start,u=this.backlight.getSize().width;let c=0,h=0;if(this.hot.isRtl()){const w=this.hot.rootWindow,C=ut(this.hot.rootElement),S=w.innerWidth-Ne(this,Ya)-C;h=w.innerWidth-Ne(this,Dn).eventPageX-S-(r.scrollX===void 0?i:0)}else h=Ne(this,Dn).eventPageX-(Ne(this,Ya)-(r.scrollX===void 0?i:0));if(Ne(this,Zd)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Ne(this,fr))&&(o+=i),o+=c,Ne(this,fr)<0)Ne(this,Mu)>0?Ne(this,Dn).col=0:Ne(this,Dn).col=e>0?e-1:e;else if(Ne(this,Dn).TD.offsetWidth/2+o<=h){const w=Ne(this,fr)>=Ne(this,fd)?Ne(this,fd)-1:Ne(this,fr);Ne(this,Dn).col=w+1,o+=Ne(this,Dn).TD.offsetWidth}else Ne(this,Dn).col=Ne(this,fr);let f=h,g=o;h+u+l>=s?f=s-u-l:h+l<a+c&&(f=a+c+Math.abs(l)),o>=s-1?g=s-1:g===0?g=1:r.scrollX!==void 0&&Ne(this,fr)<Ne(this,Mu)&&(g-=Ne(this,Ya)<=r.scrollX?Ne(this,Ya):0),this.backlight.setPosition(null,f),this.guideline.setPosition(null,g)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Na(this,oM,$ne).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Na(this,aM,Wne).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){this.backlight.build(),this.guideline.build()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}function kne(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=Pe(t.target,"sortAction");if(!s||!o||Ne(this,xo)||t.button!==0||a){Kn(this,xo,!1),Ne(this,qi).length=0,De(this.hot.rootElement,[iC,qd]);return}const l=this.guideline.isBuilt()&&!this.guideline.isAppended(),u=this.backlight.isBuilt()&&!this.backlight.isAppended();l&&u&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:c,to:h}=s,f=Math.min(c.col,h.col),g=Math.max(c.col,h.col);if(e.row<0&&e.col>=f&&e.col<=g){r.column=!0,Kn(this,xo,!0);const w=n.firstChild?kI(t,n.firstChild).x:t.offsetX;Ne(this,Dn).eventPageX=t.pageX,Kn(this,fr,e.col),Ne(this,Dn).TD=n,Ne(this,Dn).col=e.col,Kn(this,qi,this.prepareColumnsToMoving(f,g)),Kn(this,Zd,!!this.hot.getSettings().rowHeaders),Kn(this,fd,this.hot.countCols()),Kn(this,Mu,this.hot.getSettings().fixedColumnsStart),Kn(this,Ya,Bt(this.hot.rootElement).left);const C=Ne(this,Zd)?-1:0,S=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,b=e.col<Ne(this,Mu),_=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),O=Math.abs(w-(this.hot.isRtl()?n.offsetWidth:0)),x=this.getColumnsWidth(f,e.col-1)+O,I=this.getColumnsWidth(C,f-1)+(b?_:0)+x;this.backlight.setPosition(S,I),this.backlight.setSize(this.getColumnsWidth(f,g),i.hider.offsetHeight-S),this.backlight.setOffset(null,-x),ee(this.hot.rootElement,iC)}else De(this.hot.rootElement,oC),Kn(this,xo,!1),Ne(this,qi).length=0}function $ne(t){Ne(this,xo)&&(Ne(this,Dn).eventPageX=t.pageX,this.refreshPositions())}function Fne(t,e,n,r){!this.hot.getSelectedRangeLast()||!Ne(this,xo)||(Ne(this,qi).indexOf(e.col)>-1?De(this.hot.rootElement,qd):ee(this.hot.rootElement,qd),r.row=!0,r.column=!0,r.cell=!0,Kn(this,fr,e.col),Ne(this,Dn).TD=n)}function Wne(){const t=Ne(this,Dn).col,e=Ne(this,qi).length;if(Kn(this,fr,void 0),Kn(this,xo,!1),De(this.hot.rootElement,[iC,qd,oC]),this.hot.selection.isSelectedByColumnHeader()&&ee(this.hot.rootElement,oC),e<1||t===void 0)return;const n=Ne(this,qi)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(Ne(this,qi),t);if(Ne(this,qi).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function Vne(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;this.backlight.setPosition(r),this.backlight.setSize(null,t.hider.offsetHeight-r)}function Bne(){this.moveBySettingsOrLoad()}function Ni(t,e){cD(t,e),e.add(t)}function Une(t,e,n){cD(t,e),e.set(t,n)}function cD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pn(t,e,n){return e=zne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zne(t){var e=Gne(t,"string");return typeof e=="symbol"?e:String(e)}function Gne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cM(t,e){var n=dD(t,e,"get");return Yne(t,n)}function Yne(t,e){return e.get?e.get.call(t):e.value}function hD(t,e,n){var r=dD(t,e,"set");return jne(t,r,n),n}function dD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function jne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Li(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Qd="manualColumnResize",Kne=130,hM="manualColumnWidths";var Au=new WeakMap,dM=new WeakSet,fM=new WeakSet,gM=new WeakSet,mM=new WeakSet,pM=new WeakSet,wM=new WeakSet,CM=new WeakSet,vM=new WeakSet,SM=new WeakSet;class Xne extends nt{static get PLUGIN_KEY(){return Qd}static get PLUGIN_PRIORITY(){return Kne}constructor(e){super(e),Ni(this,SM),Ni(this,vM),Ni(this,CM),Ni(this,wM),Ni(this,pM),Ni(this,mM),Ni(this,gM),Ni(this,fM),Ni(this,dM),Pn(this,"currentTH",null),Pn(this,"currentCol",null),Pn(this,"selectedCols",[]),Pn(this,"currentWidth",null),Pn(this,"newSize",null),Pn(this,"startY",null),Pn(this,"startWidth",null),Pn(this,"startOffset",null),Pn(this,"handle",this.hot.rootDocument.createElement("DIV")),Pn(this,"guide",this.hot.rootDocument.createElement("DIV")),Pn(this,"pressed",null),Pn(this,"isTriggeredByRMB",!1),Pn(this,"dblclick",0),Pn(this,"autoresizeTimeout",null),Pn(this,"columnWidthsMap",void 0),Une(this,Au,{writable:!0,value:void 0}),ee(this.handle,"manualColumnResizer"),ee(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Qd]}enablePlugin(){this.enabled||(this.columnWidthsMap=new Xo,this.columnWidthsMap.addLocalHook("init",()=>Li(this,dM,qne).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(e,n)=>Li(this,CM,nre).call(this,e,n)),this.addHook("beforeStretchingColumnWidth",(e,n)=>Li(this,vM,rre).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,r)=>Li(this,SM,ire).call(this,e,n,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){hD(this,Au,this.columnWidthsMap.getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",hM,this.columnWidthsMap.getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",hM,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;this.currentTH=e;const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(this.currentTH),i=r.col;if(i<0)return;const o=Ot(this.currentTH),s=this.currentTH.getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),this.selectedCols=[];const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();T(c,h=>{const f=h.getTopStartCorner().col,g=h.getBottomEndCorner().col;pe(f,g,w=>{this.selectedCols.includes(w)||this.selectedCols.push(w)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=l.start-6,this.startWidth=parseInt(s.width,10),this.handle.style.top=`${l.top}px`,this.handle.style[this.inlineDir]=`${this.startOffset+this.startWidth}px`,this.handle.style.height=`${o}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style[this.inlineDir]=`${this.startOffset+this.currentWidth}px`}setupGuidePosition(){const e=parseInt(Ot(this.handle),10),n=parseInt(this.handle.style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);ee(this.handle,"active"),ee(this.guide,"active"),this.guide.style.top=`${n}px`,this.refreshGuidePosition(),this.guide.style.height=`${r-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){De(this.handle,"active"),De(this.guide,"active")}checkIfColumnHeader(e){return!!Vo(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",this.newSize,r,!0);o!==void 0&&(this.newSize=o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,r,!0),i&&e()};this.dblclick>=2&&(this.selectedCols.length>1?(T(this.selectedCols,i=>{n(i)}),e()):T(this.selectedCols,i=>{n(i,!0)})),this.dblclick=0,this.autoresizeTimeout=null}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Li(this,fM,Zne).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Li(this,gM,Qne).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Li(this,mM,Jne).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Li(this,pM,ere).call(this)),this.eventManager.addEventListener(this.handle,"contextmenu",()=>Li(this,wM,tre).call(this))}destroy(){super.destroy()}}function qne(){const t=this.hot.getSettings()[Qd],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{this.columnWidthsMap.setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{this.columnWidthsMap.setValueAtIndex(r,n)})},!0),hD(this,Au,t)):t===!0&&Array.isArray(cM(this,Au))&&this.hot.batchExecution(()=>{cM(this,Au).forEach((n,r)=>{this.columnWidthsMap.setValueAtIndex(r,n)})},!0)}function Zne(t){if(!nv(t.target)&&this.isTriggeredByRMB!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(this.pressed||this.setupHandlePosition(e))}}function Qne(t){Pe(t.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=t.pageX,this.newSize=this.startWidth)}function Jne(t){if(this.pressed){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+e,T(this.selectedCols,n=>{this.newSize=this.setManualSize(n,this.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function ere(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",this.newSize,n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?(T(this.selectedCols,r=>{e(r)}),t()):T(this.selectedCols,r=>{e(r,!0)})),this.setupHandlePosition(this.currentTH))}function tre(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}function nre(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=this.columnWidthsMap.getValueAtIndex(r);this.hot.getSettings()[Qd]&&i&&(n=i)}return n}function rre(t,e){let n=this.columnWidthsMap.getValueAtIndex(e);return n===null&&(n=t),n}function ire(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function Sp(t,e,n){return e=ore(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ore(t){var e=sre(t,"string");return typeof e=="symbol"?e:String(e)}function sre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const yp=0,yM=1,bM=2,La="px";let are=class{constructor(e){Sp(this,"hot",void 0),Sp(this,"_element",null),Sp(this,"state",yp),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=bM}build(){this.state===yp&&(this._element=this.hot.rootDocument.createElement("div"),this.state=yM)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=yp}isAppended(){return this.state===bM}isBuilt(){return this.state>=yM}setPosition(e,n){e!==void 0&&(this._element.style.top=e+La),n!==void 0&&(this._element.style.left=n+La)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+La),n&&(this._element.style.height=n+La)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+La),n&&(this._element.style.marginLeft=n+La)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const fD=are,lre="ht__manualRowMove--backlight";class ure extends fD{build(){super.build(),ee(this._element,lre)}}const cre=ure,hre="ht__manualRowMove--guideline";class dre extends fD{build(){super.build(),ee(this._element,hre)}}const fre=dre;function ka(t,e){gD(t,e),e.add(t)}function Lh(t,e,n){gD(t,e),e.set(t,n)}function gD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RM(t,e,n){return e=gre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gre(t){var e=mre(t,"string");return typeof e=="symbol"?e:String(e)}function mre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $s(t,e,n){var r=mD(t,e,"set");return pre(t,r,n),n}function pre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Mt(t,e){var n=mD(t,e,"get");return wre(t,n)}function mD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function wre(t,e){return e.get?e.get.call(t):e.value}function $a(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("beforeRowMove");fe.getSingleton().register("afterRowMove");const bp="manualRowMove",Cre=140,EM="ht__manualRowMove",Jd="show-ui",sC="on-moving--rows",aC="after-selection--rows";var Zi=new WeakMap,Ho=new WeakMap,Xn=new WeakMap,kh=new WeakMap,TM=new WeakSet,_M=new WeakSet,MM=new WeakSet,AM=new WeakSet,OM=new WeakSet,PM=new WeakSet;class vre extends nt{constructor(){super(...arguments),ka(this,PM),ka(this,OM),ka(this,AM),ka(this,MM),ka(this,_M),ka(this,TM),RM(this,"backlight",new cre(this.hot)),RM(this,"guideline",new fre(this.hot)),Lh(this,Zi,{writable:!0,value:[]}),Lh(this,Ho,{writable:!0,value:void 0}),Lh(this,Xn,{writable:!0,value:{}}),Lh(this,kh,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return bp}static get PLUGIN_PRIORITY(){return Cre}isEnabled(){return!!this.hot.getSettings()[bp]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $a(e,TM,Sre).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $a(e,MM,bre).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>$a(this,OM,Ere).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $a(e,PM,Tre).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),ee(this.hot.rootElement,EM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){De(this.hot.rootElement,EM),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Mt(this,kh),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if($s(this,kh,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return $s(this,kh,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Ft(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[bp];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return pe(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Mt(this,Xn).coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Mt(this,Xn).TD,a=this.hot.rootElement,l=Bt(a),u=Vs(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,f=l.top-h,g=Mt(this,Xn).eventPageY-f+c,w=o.hider.offsetHeight,C=o.TBODY.offsetTop,S=this.backlight.getOffset().top,b=this.backlight.getSize().height,_=s.offsetHeight/2,O=s.offsetHeight;let x=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const I=g>=x+_;this.isFixedRowTop(e.row)&&(x+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Mt(this,Xn).row=n>0?n-1:n:I?(Mt(this,Xn).row=e.row+1,x+=e.row===0?O-1:O):Mt(this,Xn).row=e.row;let $=g,z=x;g+b+S>=w?$=w-b-S:g+S<C&&($=C+Math.abs(S)),x>=w-1&&(z=w-1),this.backlight.setPosition($),this.guideline.setPosition(z)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>$a(this,_M,yre).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>$a(this,AM,Rre).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){this.backlight.build(),this.guideline.build()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}function Sre(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Mt(this,Ho)||t.button!==0){$s(this,Ho,!1),Mt(this,Zi).length=0,De(this.hot.rootElement,[sC,Jd]);return}const l=this.guideline.isBuilt()&&!this.guideline.isAppended(),u=this.backlight.isBuilt()&&!this.backlight.isAppended();l&&u&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:c,to:h}=a,f=Math.min(c.row,h.row),g=Math.max(c.row,h.row);if(e.col<0&&e.row>=f&&e.row<=g){r.row=!0,$s(this,Ho,!0),Mt(this,Xn).eventPageY=t.pageY,Mt(this,Xn).coords=e,Mt(this,Xn).TD=n,$s(this,Zi,this.prepareRowsToMoving());const w=i.holder.scrollLeft+o.getRowHeaderWidth(),C=this.getRowsHeight(f,e.row-1)+t.offsetY;this.backlight.setPosition(null,w),this.backlight.setSize(i.hider.offsetWidth-w,this.getRowsHeight(f,g)),this.backlight.setOffset(-C,null),ee(this.hot.rootElement,sC),this.refreshPositions()}else De(this.hot.rootElement,aC),$s(this,Ho,!1),Mt(this,Zi).length=0}function yre(t){Mt(this,Ho)&&(Mt(this,Xn).eventPageY=t.pageY,this.refreshPositions())}function bre(t,e,n,r){!this.hot.getSelectedRangeLast()||!Mt(this,Ho)||(Mt(this,Zi).indexOf(e.row)>-1?De(this.hot.rootElement,Jd):ee(this.hot.rootElement,Jd),r.row=!0,r.column=!0,r.cell=!0,Mt(this,Xn).coords=e,Mt(this,Xn).TD=n)}function Rre(){const t=Mt(this,Xn).row,e=Mt(this,Zi).length;if($s(this,Ho,!1),De(this.hot.rootElement,[sC,Jd,aC]),this.hot.selection.isSelectedByRowHeader()&&ee(this.hot.rootElement,aC),e<1||t===void 0)return;const n=Mt(this,Zi)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Mt(this,Zi),t);if(Mt(this,Zi).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function Ere(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;this.backlight.setPosition(null,r),this.backlight.setSize(t.hider.offsetWidth-r)}function Tre(){this.moveBySettingsOrLoad()}function _s(t,e){pD(t,e),e.add(t)}function _re(t,e,n){pD(t,e),e.set(t,n)}function pD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function In(t,e,n){return e=Mre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mre(t){var e=Are(t,"string");return typeof e=="symbol"?e:String(e)}function Are(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IM(t,e){var n=CD(t,e,"get");return Ore(t,n)}function Ore(t,e){return e.get?e.get.call(t):e.value}function wD(t,e,n){var r=CD(t,e,"set");return Pre(t,r,n),n}function CD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Pre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ms(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const ef="manualRowResize",Ire=30,xM="manualRowHeights";var Ou=new WeakMap,HM=new WeakSet,DM=new WeakSet,NM=new WeakSet,LM=new WeakSet,kM=new WeakSet,$M=new WeakSet,FM=new WeakSet;class xre extends nt{static get PLUGIN_KEY(){return ef}static get PLUGIN_PRIORITY(){return Ire}constructor(e){super(e),_s(this,FM),_s(this,$M),_s(this,kM),_s(this,LM),_s(this,NM),_s(this,DM),_s(this,HM),In(this,"currentTH",null),In(this,"currentRow",null),In(this,"selectedRows",[]),In(this,"currentHeight",null),In(this,"newSize",null),In(this,"startY",null),In(this,"startHeight",null),In(this,"startOffset",null),In(this,"handle",this.hot.rootDocument.createElement("DIV")),In(this,"guide",this.hot.rootDocument.createElement("DIV")),In(this,"pressed",!1),In(this,"isTriggeredByRMB",!1),In(this,"dblclick",0),In(this,"autoresizeTimeout",null),In(this,"rowHeightsMap",void 0),_re(this,Ou,{writable:!0,value:void 0}),ee(this.handle,"manualRowResizer"),ee(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[ef]}enablePlugin(){this.enabled||(this.rowHeightsMap=new Xo,this.rowHeightsMap.addLocalHook("init",()=>Ms(this,FM,Fre).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(e,n)=>Ms(this,$M,$re).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){wD(this,Ou,this.rowHeightsMap.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",xM,this.rowHeightsMap.getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",xM,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,ox.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(r,i),i}setupHandlePosition(e){this.currentTH=e;const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(this.currentTH),o=i.row;if(o<0)return;const s=ut(this.currentTH),a=this.currentTH.getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),this.selectedRows=[];const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const f=this.hot.getSelectedRange();T(f,g=>{const w=g.getTopStartCorner().row,C=g.getBottomStartCorner().row;pe(w,C,S=>{this.selectedRows.includes(S)||this.selectedRows.push(S)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=c.top-6,this.startHeight=parseInt(a.height,10),this.handle.style.top=`${this.startOffset+this.startHeight}px`,this.handle.style[this.inlineDir]=`${c.start}px`,this.handle.style.width=`${s}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style.top=`${this.startOffset+this.currentHeight}px`}setupGuidePosition(){const e=parseInt(ut(this.handle),10),n=parseInt(this.handle.style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);ee(this.handle,"active"),ee(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=`${n}px`,this.guide.style.width=`${r-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){De(this.handle,"active"),De(this.guide,"active")}checkIfRowHeader(e){var n;return Vo(e,["TH"],this.hot.rootElement)&&((n=e.parentNode)===null||n===void 0||(n=n.parentNode)===null||n===void 0?void 0:n.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&this.newSize<n?n:this.newSize}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&(this.newSize=o),this.setManualSize(r,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};this.dblclick>=2&&(this.selectedRows.length>1?(T(this.selectedRows,i=>{n(i)}),e()):T(this.selectedRows,i=>{n(i,!0)})),this.dblclick=0,this.autoresizeTimeout=null}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Ms(this,HM,Hre).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Ms(this,DM,Dre).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Ms(this,NM,Nre).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Ms(this,LM,Lre).call(this)),this.eventManager.addEventListener(this.handle,"contextmenu",()=>Ms(this,kM,kre).call(this))}destroy(){super.destroy()}}function Hre(t){if(!nv(t.target)&&this.isTriggeredByRMB!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(this.pressed||this.setupHandlePosition(e))}}function Dre(t){Pe(t.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=t.pageY,this.newSize=this.startHeight)}function Nre(t){this.pressed&&(this.currentHeight=this.startHeight+(t.pageY-this.startY),T(this.selectedRows,e=>{this.newSize=this.setManualSize(e,this.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Lre(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?(T(this.selectedRows,r=>{e(r)}),t()):T(this.selectedRows,r=>{e(r,!0)})),this.setupHandlePosition(this.currentTH))}function kre(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}function $re(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=this.rowHeightsMap.getValueAtIndex(r);this.hot.getSettings()[ef]&&i&&(n=i)}return n}function Fre(){const t=this.hot.getSettings()[ef],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{this.rowHeightsMap.setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{this.rowHeightsMap.setValueAtIndex(r,n)}),wD(this,Ou,t)):t===!0&&Array.isArray(IM(this,Ou))&&IM(this,Ou).forEach((n,r)=>{this.rowHeightsMap.setValueAtIndex(r,n)})},!0)}function As(t,e,n){return e=Wre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wre(t){var e=Vre(t,"string");return typeof e=="symbol"?e:String(e)}function Vre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bre{constructor(e,n,r,i,o,s){As(this,"row",void 0),As(this,"col",void 0),As(this,"rowspan",void 0),As(this,"colspan",void 0),As(this,"removed",!1),As(this,"cellCoordsFactory",void 0),As(this,"cellRangeFactory",void 0),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return ct`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return ct`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return ct`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return ct`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const h=l-u+1,f=Math.abs(r)-h;this[s]-=f+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const li=Bre;function lC(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function Rp(t,e,n){return e=Ure(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ure(t){var e=zre(t,"string");return typeof e=="symbol"?e:String(e)}function zre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tb{constructor(e){Rp(this,"plugin",void 0),Rp(this,"mergedCells",[]),Rp(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return ct`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){const r=this.mergedCells;let i=!1;return T(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=n&&o.col+o.colspan-1>=n?(i=o,!1):!0),i}getByRange(e){const n=this.mergedCells;let r=!1;return T(n,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,i=[];let o=e;if(!o.includesRange){const s=this.hot._createCellCoords(o.from.row,o.from.col),a=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(s,s,a)}return T(r,s=>{const a=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),u=this.hot._createCellRange(a,a,l);n?o.overlaps(u)&&i.push(s):o.includesRange(u)&&i.push(s)}),i.length?i:!1}add(e){const n=this.mergedCells,r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new li(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),n.push(a),a):(pt(tb.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.mergedCells,i=this.get(e,n),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(r.splice(o,1),i):!1}clear(){const e=this.mergedCells,n=[],r=[];T(e,i=>{const o=this.hot.getCell(i.row,i.col);o&&n.push([o,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,T(n,(i,o)=>{pe(0,i.rowspan-1,s=>{pe(0,i.colspan-1,a=>{if(a!==0||s!==0){const l=this.hot.getCell(i.row+s,i.col+a);l&&r.push([l,null,null,null])}})}),n[o][1]=null}),T(n,i=>{lC(...i)}),T(r,i=>{lC(...i)})}isOverlapping(e){const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return T(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(n)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}T(this.mergedCells,o=>{o.shift(i,n)}),Hd(this.mergedCells.length-1,0,o=>{const s=this.mergedCells[o];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}}const Gre=tb;function Ep(t,e,n){return e=Yre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yre(t){var e=jre(t,"string");return typeof e=="symbol"?e:String(e)}function jre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kre{constructor(e){Ep(this,"plugin",void 0),Ep(this,"mergedCellsCollection",void 0),Ep(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,f=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,g=Math.floor(s/f)*f,w=s-g,C=this.getFarthestCollection(e,n,r,i);if(C){if(r==="down"){const S=C.row+C.rowspan-a-w;o[2]+S>=this.plugin.hot.countRows()?o[2]-=w:o[2]+=w?S:0}else if(r==="right"){const S=C.col+C.colspan-l-w;o[3]+S>=this.plugin.hot.countCols()?o[3]-=w:o[3]+=w?S:0}else if(r==="up"){const S=u-w-C.row+1;o[0]+S<0?o[0]+=w:o[0]-=w?S:0}else if(r==="left"){const S=c-w-C.col+1;o[1]+S<0?o[1]+=w:o[1]-=w?S:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:f}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Ut(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":return[s+1,o,c,a];case"left":return[l,u,s,o-1];case"right":return[i,a+1,c,h];default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,f=this.getAutofillSize(e,n,r),g=u?a-o+1:l-s+1,w=Math.floor(f/g)*g,C=f-w;let S=null,b=null,_=null;switch(r){case"up":S="includesVertically",_=c-C+1;break;case"left":S="includesHorizontally",_=c-C+1;break;case"down":S="includesVertically",_=h+C-1;break;case"right":S="includesHorizontally",_=h+C-1;break}return T(i,O=>{O[S](_)&&O.isFarther(b,r)&&(b=O)}),b}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return T(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(h,!0)}}const Xre=Kre;function Tp(t,e,n){return e=qre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qre(t){var e=Zre(t,"string");return typeof e=="symbol"?e:String(e)}function Zre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qre{constructor(e){Tp(this,"plugin",void 0),Tp(this,"hot",void 0),Tp(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}snapDelta(e,n,r){const i=n.to,o=i.row+e.row,s=i.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,s)}jumpOverMergedCell(e,n,r){let i=e.row||e.col,o=null,s=null,a=null;e.row?(o=n.includesVertically(r),s=n.row,a=n.getLastRow()):e.col&&(o=n.includesHorizontally(r),s=n.col,a=n.getLastColumn()),i!==0&&(i>0?o&&r!==s&&(i+=a-r+1):o&&r!==a&&(i-=r-s+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,n){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+n.row,e.to.col+n.col))}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),f=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=f)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const Jre=Qre;function eie(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(hS)}return this.getTranslatedPhrase(cS)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?li.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function $t(t,e){vD(t,e),e.add(t)}function tie(t,e,n){vD(t,e),e.set(t,n)}function vD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _p(t,e,n){return e=nie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nie(t){var e=rie(t,"string");return typeof e=="symbol"?e:String(e)}function rie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mp(t,e,n){var r=SD(t,e,"set");return iie(t,r,n),n}function iie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Fa(t,e){var n=SD(t,e,"get");return oie(t,n)}function SD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function oie(t,e){return e.get?e.get.call(t):e.value}function It(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("beforeMergeCells");fe.getSingleton().register("afterMergeCells");fe.getSingleton().register("beforeUnmergeCells");fe.getSingleton().register("afterUnmergeCells");const Pu="mergeCells",sie=150,WM=Pu;var si=new WeakMap,VM=new WeakSet,BM=new WeakSet,UM=new WeakSet,zM=new WeakSet,GM=new WeakSet,YM=new WeakSet,jM=new WeakSet,Ap=new WeakSet,KM=new WeakSet,XM=new WeakSet,qM=new WeakSet,ZM=new WeakSet,QM=new WeakSet,JM=new WeakSet,eA=new WeakSet,tA=new WeakSet,nA=new WeakSet,rA=new WeakSet,iA=new WeakSet,oA=new WeakSet,sA=new WeakSet,aA=new WeakSet;class aie extends nt{constructor(){super(...arguments),$t(this,aA),$t(this,sA),$t(this,oA),$t(this,iA),$t(this,rA),$t(this,nA),$t(this,tA),$t(this,eA),$t(this,JM),$t(this,QM),$t(this,ZM),$t(this,qM),$t(this,XM),$t(this,KM),$t(this,Ap),$t(this,jM),$t(this,YM),$t(this,GM),$t(this,zM),$t(this,UM),$t(this,BM),$t(this,VM),_p(this,"mergedCellsCollection",null),_p(this,"autofillCalculations",null),_p(this,"selectionCalculations",null),tie(this,si,{writable:!0,value:null})}static get PLUGIN_KEY(){return Pu}static get PLUGIN_PRIORITY(){return sie}isEnabled(){return!!this.hot.getSettings()[Pu]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Gre(this),this.autofillCalculations=new Xre(this),this.selectionCalculations=new Jre(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,VM,lie).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,UM,cie).call(e,...r)}),this.addHook("afterModifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,oA,_ie).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,zM,hie).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,GM,die).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,Ap,lA).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,Ap,lA).call(e,...r)}),this.addHook("beforeSetRangeEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,KM,mie).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,BM,uie).call(e,...r)}),this.addHook("afterRenderer",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,jM,gie).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,YM,fie).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,XM,pie).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,qM,wie).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,ZM,Cie).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,QM,vie).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,JM,Sie).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,eA,yie).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,tA,bie).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,nA,Rie).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,rA,Eie).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,iA,Tie).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,sA,Mie).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,aA,Aie).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[Pu];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!av())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=il(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=il(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let n=!0;return e?(li.containsNegativeValues(e)?(pt(li.NEGATIVE_VALUES_WARNING(e)),n=!1):li.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(pt(li.IS_OUT_OF_BOUNDS_WARNING(e)),n=!1):li.isSingleCell(e)?(pt(li.IS_SINGLE_CELL(e)),n=!1):li.containsZeroSpan(e)&&(pt(li.ZERO_SPAN_WARNING(e)),n=!1),n):!1}generateFromSettings(e){if(Array.isArray(e)){const n=[];if(T(e,r=>{if(!this.validateSetting(r))return;const i=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(i,i,o);this.mergeRange(s,!0,!0),pe(r.row,r.row+r.rowspan-1,a=>{pe(r.col,r.col+r.colspan-1,l=>{a===r.row&&l===r.col||n.push([a,l,null])})})}),n.length===0)return;this.hot.setDataAtCell(n)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.toggleMerge(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),pe(0,s.rowspan-1,c=>{pe(0,s.colspan-1,h=>{let f=null;a[c]||(a[c]=[]),c===0&&h===0?f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=f})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),T(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),pe(0,i.rowspan-1,o=>{pe(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:WM})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(WM)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if($e(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if($e(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if($e(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if($e(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function lie(){this.generateFromSettings(this.hot.getSettings()[Pu]),this.hot.render()}function uie(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1}return t}function cie(t){const e=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},r=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),o=this.mergedCellsCollection.get(i.row,i.col);if(Fa(this,si)||Mp(this,si,this.hot._createCellCoords(null,null)),o){const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);this.hot._createCellRange(a,a,l).includes(Fa(this,si))||Mp(this,si,this.hot._createCellCoords(null,null)),n.row=Fa(this,si).row?Fa(this,si).row-i.row:n.row,n.col=Fa(this,si).col?Fa(this,si).col-i.col:n.col,t.row>0?n.row=o.row+o.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-o.row+t.row),t.col>0?n.col=o.col+o.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-o.col+t.col)}r=this.hot._createCellCoords(e.highlight.row+n.row,e.highlight.col+n.col);const s=this.mergedCellsCollection.get(r.row,r.col);if(s){const a=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);Mp(this,si,r),n={row:a.row-i.row,col:a.col-i.col}}n.row!==0&&(t.row=n.row),n.col!==0&&(t.col=n.col)}function hie(t){const e=this.hot.getSelectedRangeLast(),n=Ln(t),r=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=Ln(n);const o=this.mergedCellsCollection.getWithinRange(r,!0);do i=Ln(n),this.selectionCalculations.getUpdatedSelectionRange(e,n),T(o,s=>{this.selectionCalculations.snapDelta(n,e,s)});while(n.row!==i.row||n.col!==i.col);t.row=n.row,t.col=n.col}function die(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:r,col:i,colspan:o,rowspan:s}=n;return[r,i,r+s-1,i+o-1]}function fie(t){t.items.push({name:"---------"},eie(this))}function gie(t,e,n){const r=this.mergedCellsCollection.get(e,n),i=$e(r)?Ln(r):void 0;if($e(i)){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:a,col:l,colspan:u,rowspan:c}=i,[h,f]=this.translateMergedCellToRenderable(a,c,l,u),g=o.getRenderableFromVisualIndex(e),w=s.getRenderableFromVisualIndex(n),C=h-g+1,S=f-w+1;i.row=o.getNearestNotHiddenIndex(i.row,1),i.col=s.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,C),i.colspan=Math.min(i.colspan,S)}lC(t,i,e,n)}function lA(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function mie(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){const o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}function pie(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function wie(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Cie(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function vie(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(r=this.autofillCalculations.snapDragArea(e,r,n,i)),r}function Sie(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function yie(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function bie(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Rie(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Eie(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Tie(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);T(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function _ie(t,e,n){if(!this.enabled)return;const r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;const i=e>0,o=e<0,s=n<0,a=n>0,l=r.row+r.rowspan-1===this.hot.countRows()-1,u=r.row===0,c=r.col+r.colspan-1===this.hot.countCols()-1,h=r.col===0;(i&&l||o&&u||a&&c||s&&h)&&(t.row=r.row,t.col=r.col)}function Mie(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function Aie(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Oie(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],f=u.multiColumnSorting,w=(f.compareFunctionFactory?f.compareFunctionFactory:V1(u.type))(l,u,f)(c,h);if(w===fi){const C=a+1;if(typeof e[C]<"u")return s(C)}return w}(0)}}function uA(){pt(ct`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const yD="sort";function Pie(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${yD}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function Iie(t){const e=t.className.split(" "),n=new RegExp(`^${yD}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function xie(t,e,n){return e=Hie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hie(t){var e=Die(t,"string");return typeof e=="symbol"?e:String(e)}function Die(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const tf="multiColumnSorting",Nie=170,cA="columnSorting",hA=tf;W1(tf,Oie);class Lie extends B1{constructor(){super(...arguments),xie(this,"pluginKey",tf)}static get PLUGIN_KEY(){return tf}static get PLUGIN_PRIORITY(){return Nie}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[cA]&&uA(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,zd))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:hA})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(hA)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),De(e,Iie(e)),this.enabled!==!1&&ee(e,Pie(...r))}updateSortingIndicator(e,n){super.updateSortingIndicator(e,n);const r=n.querySelector(".columnSortingIndicator");if(!r||!this.hot.getSettings().ariaTags||!this.columnStatesManager.isColumnSorted(e)||this.columnStatesManager.getNumberOfSortedColumns()<=1)return;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e)+1,o=Wo(`${this.hot.getTranslatedPhrase(wy)} ${i}.`);Ko(r,so()[0]),ve(r,...o)}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[cA]&&uA(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){Uy(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,zd))):this.sort(this.getColumnNextConfig(n.col)))}}function dA(t,e,n){return e=kie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kie(t){var e=$ie(t,"string");return typeof e=="symbol"?e:String(e)}function $ie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Fie="multipleSelectionHandles",Wie=160;class Vie extends nt{constructor(){super(...arguments),dA(this,"dragged",[]),dA(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Fie}static get PLUGIN_PRIORITY(){return Wie}isEnabled(){return Yi()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(Pe(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(Pe(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(Pe(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Pe(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const f=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!f||f===e.lastSetCell||((f.nodeName==="TD"||f.nodeName==="TH")&&(s=e.hot.getCoords(f),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=f),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function uC(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function bD(){return{label:"",isPlaceholder:!0}}function Bie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;T(t,i=>{const o=[];let s=0;n.push(o),T(i,a=>{const l=uC();if($e(a)){const{label:c,colspan:h}=a;l.label=Nt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h)}else l.label=Nt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(bD());return!u})});const r=Math.max(...Ve(n,i=>i.length));return T(n,i=>{if(i.length<r){const o=Ve(new Array(r-i.length),()=>uC());i.splice(i.length,0,...o)}}),n}function Op(t,e,n){Uie(t,e),e.set(t,n)}function Uie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ir(t,e){var n=RD(t,e,"get");return zie(t,n)}function zie(t,e){return e.get?e.get.call(t):e.value}function iu(t,e,n){var r=RD(t,e,"set");return Gie(t,r,n),n}function RD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Gie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const fA=["label","collapsible"];var ki=new WeakMap,Os=new WeakMap,Pp=new WeakMap;class Yie{constructor(){Op(this,ki,{writable:!0,value:[]}),Op(this,Os,{writable:!0,value:0}),Op(this,Pp,{writable:!0,value:1/0})}setColumnsLimit(e){iu(this,Pp,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];iu(this,ki,Bie(e,Ir(this,Pp))),iu(this,Os,Ir(this,ki).length)}getData(){return Ir(this,ki)}mergeWith(e){T(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&Ut(s,o,fA)})}map(e){T(Ir(this,ki),n=>{T(n,r=>{const i=e({...r});$e(i)&&Ut(r,i,fA)})})}getHeaderSettings(e,n){var r;if(e>=Ir(this,Os)||e<0)return null;const i=Ir(this,ki)[e];return n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Ir(this,Os)||e<0)return i;const o=Ir(this,ki)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Ir(this,Os)}getColumnsCount(){return Ir(this,Os)>0?Ir(this,ki)[0].length:0}clear(){iu(this,ki,[]),iu(this,Os,0)}}function Ip(t,e,n){return e=jie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jie(t){var e=Kie(t,"string");return typeof e=="symbol"?e:String(e)}function Kie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ED="DF-pre-order";function TD(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=TD.call(this.childs[r],t,e)}return n}const Xie="DF-post-order";function _D(t,e){for(let n=0;n<this.childs.length;n++)if(_D.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const MD="BF";function qie(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const Zie=MD,gA=new Map([[ED,TD],[Xie,_D],[MD,qie]]);class nf{constructor(e){Ip(this,"data",{}),Ip(this,"parent",null),Ip(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new nf({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Zie;if(!gA.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);gA.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function xp(t,e,n){Qie(t,e),e.set(t,n)}function Qie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xn(t,e){var n=AD(t,e,"get");return Jie(t,n)}function Jie(t,e){return e.get?e.get.call(t):e.value}function eoe(t,e,n){var r=AD(t,e,"set");return toe(t,r,n),n}function AD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function toe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Wa=new WeakMap,Ps=new WeakMap,Va=new WeakMap;class noe{constructor(e){xp(this,Wa,{writable:!0,value:new Map}),xp(this,Ps,{writable:!0,value:new Map}),xp(this,Va,{writable:!0,value:null}),eoe(this,Va,e)}getRoots(){return Array.from(xn(this,Wa).values())}getRootByColumn(e){let n;return xn(this,Ps).has(e)&&(n=xn(this,Wa).get(xn(this,Ps).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-xn(this,Ps).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;xn(this,Ps).clear(),T(xn(this,Wa),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)xn(this,Ps).set(i,e);e+=r})}buildTree(){this.clear();const e=xn(this,Va).getColumnsCount();let n=0;for(;n<e;){const r=xn(this,Va).getHeaderSettings(0,n),i=new nf;xn(this,Wa).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=xn(this,Va).getHeadersSettings(r,n,i);r+=1,T(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new nf(a),e.addChild(l)),r<xn(this,Va).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){xn(this,Wa).clear(),xn(this,Ps).clear()}}function OD(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function rf(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function of(t){return rf(t,"origColspan")===t.data.origColspan}function nb(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(of(t))return nb(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)T(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,OD(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):of(a)&&(l.isCollapsed=rf(a,"isCollapsed"))}),{rollbackModification:()=>rb(t),affectedColumns:Array.from(o),colspanCompensation:s}}function rb(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(of(t))return rb(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)T(o,l=>{OD(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=rf(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):of(l)&&(u.isCollapsed=rf(l,"isCollapsed"))}),{rollbackModification:()=>nb(t),affectedColumns:Array.from(s),colspanCompensation:a}}function roe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ct`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function ioe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ct`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const mA=new Map([["collapse",rb],["expand",nb],["hide-column",roe],["show-column",ioe]]);function ooe(t,e,n){if(!mA.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return mA.get(t)(e,n)}function $h(t){const e=[];return T(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=aoe(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(bD());else{const g=soe(i);g.isRoot=!0,u.push(g),c=!0}})}),e}function soe(t){const{crossHiddenColumns:e,...n}=uC(t);return n}function aoe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function Hp(t,e,n){loe(t,e),e.set(t,n)}function loe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ou(t,e,n){var r=PD(t,e,"set");return uoe(t,r,n),n}function uoe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function xt(t,e){var n=PD(t,e,"get");return coe(t,n)}function PD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function coe(t,e){return e.get?e.get.call(t):e.value}var oi=new WeakMap,Un=new WeakMap,Is=new WeakMap;class hoe{constructor(){Hp(this,oi,{writable:!0,value:new Yie}),Hp(this,Un,{writable:!0,value:new noe(xt(this,oi))}),Hp(this,Is,{writable:!0,value:[[]]})}setState(e){xt(this,oi).setData(e);let n=!1;try{xt(this,Un).buildTree()}catch{xt(this,Un).clear(),xt(this,oi).clear(),n=!0}return ou(this,Is,$h(xt(this,Un).getRoots())),n}setColumnsLimit(e){xt(this,oi).setColumnsLimit(e)}mergeStateWith(e){const n=Ve(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});xt(this,oi).mergeWith(n),xt(this,Un).buildTree(),ou(this,Is,$h(xt(this,Un).getRoots()))}mapState(e){xt(this,oi).map(e),xt(this,Un).buildTree(),ou(this,Is,$h(xt(this,Un).getRoots()))}mapNodes(e){return Ft(xt(this,Un).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=xt(this,Un).getNode(n,r);let o;return i&&(o=ooe(e,i,r),ou(this,Is,$h(xt(this,Un).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=xt(this,Is)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=xt(this,Un).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let o=!1,s=null;for(let a=e;a<=r;a++){const l=xt(this,Un).getRootByColumn(a);if(!l)break;o=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:h,origColspan:f,isHidden:g}=u.data;g||f<=i&&c>=e&&c+f-1<=r&&(s===null||h<s)&&(s=h)},ED)}return o&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return xt(this,oi).getLayersCount()}getColumnsCount(){return xt(this,oi).getColumnsCount()}clear(){ou(this,Is,[]),xt(this,oi).clear(),xt(this,Un).clear()}}function su(t,e,n){return e=doe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function doe(t){var e=foe(t,"string");return typeof e=="symbol"?e:String(e)}function foe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class goe{constructor(e,n){su(this,"hot",void 0),su(this,"nestedHeaderSettingsGetter",void 0),su(this,"layersCount",0),su(this,"container",void 0),su(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const f=n.createElement("th"),g=this.nestedHeaderSettingsGetter(l,h);if(g&&(!g.isPlaceholder||g.isHidden)){let w=g.label;s&&(w+='<button class="changeType"></button>'),Qs(f,w),f.colSpan=g.colspan,u.appendChild(f)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}const moe=goe;function rn(t,e){ID(t,e),e.add(t)}function pA(t,e,n){return e=poe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function poe(t){var e=woe(t,"string");return typeof e=="symbol"?e:String(e)}function woe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fh(t,e,n){ID(t,e),e.set(t,n)}function ID(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fs(t,e,n){var r=xD(t,e,"set");return Coe(t,r,n),n}function Coe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Je(t,e){var n=xD(t,e,"get");return voe(t,n)}function xD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function voe(t,e){return e.get?e.get.call(t):e.value}function jt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const wA="nestedHeaders",Soe=280;var lt=new WeakMap,Ro=new WeakMap,Iu=new WeakMap,og=new WeakMap,Wh=new WeakSet,CA=new WeakSet,vA=new WeakSet,SA=new WeakSet,yA=new WeakSet,bA=new WeakSet,RA=new WeakSet,EA=new WeakSet,TA=new WeakSet,_A=new WeakSet,MA=new WeakSet,AA=new WeakSet,OA=new WeakSet,PA=new WeakSet,IA=new WeakSet,xA=new WeakSet,HA=new WeakSet,DA=new WeakSet;class yoe extends nt{constructor(){super(...arguments),rn(this,DA),rn(this,HA),rn(this,xA),rn(this,IA),rn(this,PA),rn(this,OA),rn(this,AA),rn(this,MA),rn(this,_A),rn(this,TA),rn(this,EA),rn(this,RA),rn(this,bA),rn(this,yA),rn(this,SA),rn(this,vA),rn(this,CA),rn(this,Wh),Fh(this,lt,{writable:!0,value:new hoe}),Fh(this,Ro,{writable:!0,value:null}),Fh(this,Iu,{writable:!0,value:null}),Fh(this,og,{writable:!0,value:!1}),pA(this,"ghostTable",new moe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),pA(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return wA}static get PLUGIN_PRIORITY(){return Soe}isEnabled(){return!!this.hot.getSettings()[wA]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&pt(ct`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>jt(this,HA,koe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,DA,$oe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,yA,Toe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,bA,_oe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,RA,Moe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,EA,Aoe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,TA,Ooe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,_A,Poe).call(e,...i)}),this.addHook("afterSelection",()=>jt(this,Wh,Dp).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,CA,boe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>jt(this,AA,xoe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,PA,Doe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,IA,Noe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,vA,Roe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,SA,Eoe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,MA,Ioe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,OA,Hoe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,xA,Loe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>jt(this,Wh,Dp).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>jt(this,Wh,Dp).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Je(this,lt).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Je(this,lt).setState(e)),this.detectedOverlappedHeaders&&pt(ct`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";Je(this,lt).triggerColumnModification(i,r)}),!Je(this,Ro)&&this.enabled&&Fs(this,Ro,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";Je(this,lt).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Je(this,lt).clear(),Je(this,Ro).unsubscribe(),Fs(this,Ro,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Je(this,lt)}getLayersCount(){return Je(this,lt).getLayersCount()}getHeaderSettings(e,n){return Je(this,lt).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),De(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),De(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),De(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),De(o,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:f}=(s=Je(this,lt).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(f||h)ee(o,"hiddenHeader");else if(c>1){var g,w;const{wtOverlays:C}=l._wt,S=(g=C.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),b=(w=C.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(o),_=S||b?Math.min(c,r-i):c;_>1&&o.setAttribute("colspan",_)}this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=Je(this,lt).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){Fs(this,lt,null),Je(this,Ro)!==null&&(Je(this,Ro).unsubscribe(),Fs(this,Ro,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Je(this,lt).getHeaderTreeNodeData(e.row,e.col)}}function Dp(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=Je(this,lt).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function boe(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const i=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=Je(this,lt).findLeftMostColumnIndex(n.row,n.col),a=Je(this,lt).findRightMostColumnIndex(n.row,n.col);return s<i&&a>o?t:s<i?s:a}function Roe(t,e,n){const r=Je(this,lt).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=Je(this,lt).getHeaderSettings(e,t);if(o===Ov){if(!a)return r.columnIndex}else if(o===yx&&(l>s-i||!a))return null;return t}function Eoe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let f=a;f<=u;f++)for(let g=s;g<=l;g++){var i;const w=c+g,C=f-a;if(C===0)continue;((i=Je(this,lt).getHeaderTreeNodeData(g,f))===null||i===void 0?void 0:i.isRoot)===!1&&(t[w][C]="")}}}function Toe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function _oe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Fs(this,Iu,e.clone()),Fs(this,og,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(Hf(t)||zo(t)&&l)&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function Moe(t,e,n,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],f=qn(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,f):e.col>c.col?h.push(l.col,o+s-1,f):h.push(o,o+s-1,f),this.hot.selection.selectColumns(...h)}function Aoe(){Fs(this,og,!1)}function Ooe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Je(this,og)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=Je(this,lt).getHeaderTreeNodeData(Je(this,Iu).row,Je(this,Iu).col);if(e.setHighlight(Je(this,Iu)),o>e.getWidth()||i<n||i+o-1>r){const s=Je(this,lt).findTopMostEntireHeaderLevel(qn(n,i,i+o-1),qn(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Poe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=Je(this,lt).findLeftMostColumnIndex(n.row,n.col),o=Je(this,lt).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Ioe(t,e){const n=t.row,r=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function xoe(t){t.length=0;for(let e=0;e<Je(this,lt).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function Hoe(t){const e=Je(this,lt).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=Je(this,lt).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Nn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?Je(this,lt).getHeaderTreeNodeData(0,n).columnIndex:n}function Doe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Noe(t,e,n){var r;const{label:i}=(r=Je(this,lt).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Loe(t,e){if(t<0)return this.hot.getCell(t,Je(this,lt).findLeftMostColumnIndex(t,e),!0)}function koe(){this.updatePlugin()}function $oe(t,e){e||this.updatePlugin()}function au(t,e,n){return e=Foe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Foe(t){var e=Woe(t,"string");return typeof e=="symbol"?e:String(e)}function Woe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Voe{constructor(e,n){au(this,"hot",void 0),au(this,"data",null),au(this,"plugin",void 0),au(this,"parentReference",new WeakMap),au(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},pe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&T(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&T(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Be(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(T(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(pe(e[0],e[2],f=>{const g=this.translateTrimmedRow(f);i.push(this.getDataObject(g))}),pe(0,i.length-2,f=>{this.detachFromParent(i[f],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const f=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,f,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,f,this.plugin.pluginName),u){h=c+this.countChildren(u);const g=this.getChild(u,this.countChildren(u)-1),w=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",w+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];T(r,o=>{i.push(this.getDataObject(o))}),T(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),f=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&f?1:0),1),this.syncRowWithRawSource(s),f||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const Boe=Voe;function NA(t,e,n){return e=Uoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uoe(t){var e=zoe(t,"string");return typeof e=="symbol"?e:String(e)}function zoe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Goe{constructor(e,n){NA(this,"hot",void 0),NA(this,"plugin",void 0),this.hot=n,this.plugin=e}}const ib=Goe;class Bi extends ib{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(T(l,c=>{c&&s.removeChild(c)}),ee(n,Bi.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",pe(0,i-1,()=>{const f=c.createElement("SPAN");ee(f,Bi.CSS_CLASSES.emptyIndicator),s.appendChild(f)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&ve(c,[so()]),ee(n,Bi.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(ee(c,`${Bi.CSS_CLASSES.button} ${Bi.CSS_CLASSES.expandButton}`),u&&ve(n,[sn(!1),ku(this.hot.getTranslatedPhrase(yy))])):(ee(c,`${Bi.CSS_CLASSES.button} ${Bi.CSS_CLASSES.collapseButton}`),u&&ve(n,[sn(!0),ku(this.hot.getTranslatedPhrase(by))])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}const HD=Bi;class Yoe extends ib{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),T(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{pe(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&T(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];T(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return T(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);T(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return T(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);T(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&T(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];T(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];T(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];T(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{T(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{T(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&T(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);Pe(e.target,HD.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),br(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const joe=Yoe;function Koe(t,e,n){Xoe(t,e),e.set(t,n)}function Xoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qoe(t,e,n){return e=Zoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zoe(t){var e=Qoe(t,"string");return typeof e=="symbol"?e:String(e)}function Qoe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Joe(t,e){var n=ese(t,e,"get");return tse(t,n)}function ese(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function tse(t,e){return e.get?e.get.call(t):e.value}var LA=new WeakMap;class nse extends ib{constructor(){super(...arguments),qoe(this,"dataManager",this.plugin.dataManager),Koe(this,LA,{writable:!0,value:{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(PS)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(IS)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return pe(0,e.items.length-1,r=>{if(r===0)return T(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return pe(0,e.items.length-1,n=>{const r=Joe(this,LA)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}const rse=nse;function Vh(t,e,n){return e=ise(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ise(t){var e=ose(t,"string");return typeof e=="symbol"?e:String(e)}function ose(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sse{constructor(e){Vh(this,"plugin",void 0),Vh(this,"hot",void 0),Vh(this,"dataManager",void 0),Vh(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(w=>{if(!l)return!1;const C=this.dataManager.translateTrimmedRow(w);return l=this.shouldAllowMoving(C,a),C}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),f=this.getTargetParent(s,a),g=h===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,g),this.moveRows(u,a,f),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return mt(i)&&(pt(ct`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function gn(t,e){DD(t,e),e.add(t)}function kA(t,e,n){DD(t,e),e.set(t,n)}function DD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Np(t,e,n){return e=ase(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ase(t){var e=lse(t,"string");return typeof e=="symbol"?e:String(e)}function lse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gd(t,e){var n=ND(t,e,"get");return use(t,n)}function use(t,e){return e.get?e.get.call(t):e.value}function sf(t,e,n){var r=ND(t,e,"set");return cse(t,r,n),n}function ND(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function cse(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function hn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const af="nestedRows",hse=300,$A=af,dse="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var sg=new WeakMap,Ba=new WeakMap,FA=new WeakSet,WA=new WeakSet,VA=new WeakSet,BA=new WeakSet,UA=new WeakSet,zA=new WeakSet,GA=new WeakSet,YA=new WeakSet,jA=new WeakSet,KA=new WeakSet,XA=new WeakSet,qA=new WeakSet,ZA=new WeakSet,QA=new WeakSet,JA=new WeakSet,Lp=new WeakSet;class fse extends nt{constructor(){super(...arguments),gn(this,Lp),gn(this,JA),gn(this,QA),gn(this,ZA),gn(this,qA),gn(this,XA),gn(this,KA),gn(this,jA),gn(this,YA),gn(this,GA),gn(this,zA),gn(this,UA),gn(this,BA),gn(this,VA),gn(this,WA),gn(this,FA),Np(this,"dataManager",null),Np(this,"headersUI",null),Np(this,"collapsedRowsMap",null),kA(this,sg,{writable:!0,value:!1}),kA(this,Ba,{writable:!0,value:!1})}static get PLUGIN_KEY(){return af}static get PLUGIN_PRIORITY(){return hse}isEnabled(){return!!this.hot.getSettings()[af]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new fc),this.dataManager=new Boe(this,this.hot),this.collapsingUI=new joe(this,this.hot),this.headersUI=new HD(this,this.hot),this.contextMenuUI=new rse(this,this.hot),this.rowMoveController=new sse(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,QA,Mse).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,JA,Ase).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,VA,pse).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,BA,wse).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,UA,Cse).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,WA,mse).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,YA,yse).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,GA,Sse).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,jA,bse).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,KA,Rse).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,XA,Ese).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,qA,Tse).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,zA,vse).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,ZA,_se).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,FA,gse).call(e,...r)}),this.addHook("beforeLoadData",n=>hn(this,Lp,eO).call(this,n)),this.addHook("beforeUpdateData",n=>hn(this,Lp,eO).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){const n=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n)}},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:$A})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup($A)}disableCoreAPIModifiers(){sf(this,Ba,!0)}enableCoreAPIModifiers(){sf(this,Ba,!1)}onModifyRowData(e){if(!gd(this,Ba))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!gd(this,Ba))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return gd(this,Ba)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function gse(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function mse(t,e,n){this.collapsingUI.toggleState(t,e,n)}function pse(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),sf(this,sg,!0),this.dataManager.getData().slice()}function wse(t){return this.contextMenuUI.appendOptions(t)}function Cse(t,e){this.headersUI.appendLevelIndicators(t,e)}function vse(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Sse(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{sf(this,sg,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function yse(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function bse(){this.collapsingUI.collapsedRowsStash.stash()}function Rse(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Ese(){this.collapsingUI.collapsedRowsStash.stash()}function Tse(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _se(){this.dataManager.rewriteCache()}function Mse(){this.headersUI.updateRowHeaderWidth()}function Ase(t,e){gd(this,sg)&&(e.skipRender=!0)}function eO(t){if(!xx(t)){dv(dse),this.hot.getSettings()[af]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function kp(t,e,n){return e=Ose(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ose(t){var e=Pse(t,"string");return typeof e=="symbol"?e:String(e)}function Pse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ise{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;kp(this,"rootWindow",void 0),kp(this,"prefix",void 0),kp(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){T(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const xse=Ise;function Hse(t,e,n){return e=Dse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dse(t){var e=Nse(t,"string");return typeof e=="symbol"?e:String(e)}function Nse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}fe.getSingleton().register("persistentStateSave");fe.getSingleton().register("persistentStateLoad");fe.getSingleton().register("persistentStateReset");const tO="persistentState",Lse=0;class kse extends nt{constructor(){super(...arguments),Hse(this,"storage",void 0)}static get PLUGIN_KEY(){return tO}static get PLUGIN_PRIORITY(){return Lse}isEnabled(){return!!this.hot.getSettings()[tO]}enablePlugin(){this.enabled||(this.storage||(this.storage=new xse(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function $se(t,e){Fse(t,e),e.add(t)}function Fse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $p(t,e,n){return e=Wse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wse(t){var e=Vse(t,"string");return typeof e=="symbol"?e:String(e)}function Vse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nO(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Fp="search",Bse=190,Use="htSearchResult",zse=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},Gse=function(t,e,n){return mt(t)||t===null||!t.toLocaleLowerCase||t.length===0||mt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var Wp=new WeakSet;class Yse extends nt{constructor(){super(...arguments),$se(this,Wp),$p(this,"callback",zse),$p(this,"queryMethod",Gse),$p(this,"searchResultClass",Use)}static get PLUGIN_KEY(){return Fp}static get PLUGIN_PRIORITY(){return Bse}isEnabled(){return this.hot.getSettings()[Fp]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Fp];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nO(e,Wp,rO).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nO(e,Wp,rO).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return pe(0,i-1,l=>{pe(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),f=h.search.callback||n,w=(h.search.queryMethod||r)(e,c,h);if(w){const C={row:l,col:u,data:c};s.push(C)}f&&f(a,l,u,c,w)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){$e(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function rO(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function Vp(t,e){jse(t,e),e.add(t)}function jse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bh(t,e,n){return e=Kse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kse(t){var e=Xse(t,"string");return typeof e=="symbol"?e:String(e)}function Xse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bp(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const qse="touchScroll",Zse=200;var iO=new WeakSet,oO=new WeakSet,sO=new WeakSet;class Qse extends nt{constructor(){super(...arguments),Vp(this,sO),Vp(this,oO),Vp(this,iO),Bh(this,"scrollbars",[]),Bh(this,"clones",[]),Bh(this,"lockedCollection",!1),Bh(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return qse}static get PLUGIN_PRIORITY(){return Zse}static get SETTING_KEYS(){return!0}isEnabled(){return bv()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>Bp(this,iO,Jse).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>Bp(this,oO,eae).call(this)),this.addHook("afterMomentumScroll",()=>Bp(this,sO,tae).call(this))}}function Jse(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function eae(){this.freezeOverlays=!0,T(this.clones,t=>{ee(t,"hide-tween")})}function tae(){this.freezeOverlays=!1,T(this.clones,t=>{De(t,"hide-tween"),ee(t,"show-tween")}),this.hot._registerTimeout(()=>{T(this.clones,t=>{De(t,"show-tween")})},400),T(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function nae(t,e){rae(t,e),e.add(t)}function rae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iae(t,e,n){return e=oae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oae(t){var e=sae(t,"string");return typeof e=="symbol"?e:String(e)}function sae(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aae(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const md="trimRows",lae=330;var aO=new WeakSet;class uae extends nt{constructor(){super(...arguments),nae(this,aO),iae(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return md}static get PLUGIN_PRIORITY(){return lae}isEnabled(){return!!this.hot.getSettings()[md]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new fc),this.trimmedRowsMap.addLocalHook("init",()=>aae(this,aO,cae).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[md];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),T(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(T(e,l=>{o[l]=!1}),i=Ft(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function cae(){const t=this.hot.getSettings()[md];Array.isArray(t)&&this.hot.batchExecution(()=>{T(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}const LD="undoRedo",hae="undoRedo";function ce(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(n,r){const i=n&&n.length;if(!i||!n.find(a=>{const[,,l,u]=a;return l!==u}))return;const s=()=>{const a=n.reduce((u,c)=>(u.push([...c]),u),[]);T(a,u=>{u[1]=t.propToCol(u[1])});const l=i>1?this.getSelected():[[a[0][0],a[0][1]]];return new ce.ChangeAction(a,l)};e.done(s,r)}),t.addHook("afterCreateRow",(n,r,i)=>{e.done(()=>new ce.CreateRowAction(n,r),i)}),t.addHook("beforeRemoveRow",(n,r,i,o)=>{const s=()=>{const a=t.toPhysicalRow(n),l=bn(e.instance.getSourceData(a,0,a+r-1,e.instance.countSourceCols()-1));return new ce.RemoveRowAction(a,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(s,o)}),t.addHook("afterCreateCol",(n,r,i)=>{e.done(()=>new ce.CreateColumnAction(n,r),i)}),t.addHook("beforeRemoveCol",(n,r,i,o)=>{const s=()=>{const a=e.instance.getSourceDataArray(),l=(e.instance.countCols()+n)%e.instance.countCols(),u=[],c=[],h=[];pe(a.length-1,w=>{const C=[],S=a[w];pe(l,l+(r-1),b=>{C.push(S[t.toPhysicalColumn(b)])}),u.push(C)}),pe(r-1,w=>{h.push(t.toPhysicalColumn(l+w))}),Array.isArray(t.getSettings().colHeaders)&&pe(r-1,w=>{c.push(t.getSettings().colHeaders[t.toPhysicalColumn(l+w)]||null)});const f=t.columnIndexMapper.getIndexesSequence(),g=t.rowIndexMapper.getIndexesSequence();return new ce.RemoveColumnAction(l,h,u,c,f,g,t.getSettings().fixedColumnsStart)};e.done(s,o)}),t.addHook("beforeCellAlignment",(n,r,i,o)=>{e.done(()=>new ce.CellAlignmentAction(n,r,i,o))}),t.addHook("beforeFilter",n=>{e.done(()=>new ce.FiltersAction(n))}),t.addHook("beforeRowMove",(n,r)=>{n!==!1&&e.done(()=>new ce.RowMoveAction(n,r))}),t.addHook("beforeMergeCells",(n,r)=>{r||e.done(()=>new ce.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",(n,r)=>{r||e.done(()=>new ce.UnmergeCellsAction(t,n))}),t.addHook("afterInit",()=>{e.init()})}ce.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};ce.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=bn(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};ce.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=bn(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};ce.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ce.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ce.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ce.prototype.isEnabled=function(){return this.enabled};ce.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,gae(t),this.registerShortcuts(),t.addHook("afterChange",kD)};ce.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,mae(t),this.unregisterShortcuts(),t.removeHook("afterChange",kD)};ce.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ce.Action=function(){};ce.Action.prototype.undo=function(){};ce.Action.prototype.redo=function(){};ce.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};ao(ce.ChangeAction,ce.Action);ce.ChangeAction.prototype.undo=function(t,e){const n=bn(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let o=0,s=n.length;o<s;o++)n[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let o=0,s=n.length;o<s;o++){const[a,l]=n[o];t.getSettings().minSpareRows&&a+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(a+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&l+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(l+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};ce.ChangeAction.prototype.redo=function(t,e){const n=bn(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};ce.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};ao(ce.CreateRowAction,ce.Action);ce.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ce.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ce.RemoveRowAction=function(t,e,n,r,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i};ao(ce.RemoveRowAction,ce.Action);ce.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,o)=>{Object.keys(i).forEach(s=>{const a=parseInt(s,10);r.push([this.index+o,isNaN(a)?s:a,i[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ce.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ce.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};ao(ce.CreateColumnAction,ce.Action);ce.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ce.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ce.RemoveColumnAction=function(t,e,n,r,i,o,s){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s};ao(ce.RemoveColumnAction,ce.Action);ce.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,h)=>h[this.indexes.indexOf(r[c])],o=this.data.length,s=[];for(let u=0;u<o;u++)s.push(Ve(this.data[u],i));const a=Ve(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),T(t.getSourceDataArray(),(u,c)=>{T(r,(h,f)=>{u[h]=s[c][f],l.push([c,h,u[h]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&T(a,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};ce.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ce.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};ce.CellAlignmentAction.prototype.undo=function(t,e){T(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};ce.CellAlignmentAction.prototype.redo=function(t,e){To(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,o)=>t.setCellMeta(n,r,i,o)),t.addHookOnce("afterViewRender",e),t.render()};ce.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};ao(ce.FiltersAction,ce.Action);ce.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()};ce.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class dae extends ce.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}ce.MergeCellsAction=dae;class fae extends ce.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}ce.UnmergeCellsAction=fae;ce.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};ao(ce.RowMoveAction,ce.Action);ce.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(a=>a>this.finalIndex),o=r.filter(a=>a<=this.finalIndex),s=i.sort((a,l)=>l-a).concat(o.sort((a,l)=>a-l));t.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){const l=t.toVisualRow(s[a]);n.moveRow(l,s[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ce.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ce.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ce.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:LD};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};ce.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(LD)};function kD(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function gae(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function mae(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const bc=fe.getSingleton();bc.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});bc.register("beforeUndo");bc.register("afterUndo");bc.register("beforeRedo");bc.register("afterRedo");ce.PLUGIN_KEY=hae;ce.SETTING_KEYS=!0;function pae(){et(bu),et(k9),et(Ru),et(g8),et(R8),et(B1),et(m7),et(e5),et(tg),et(TZ),et(XZ),et(rQ),et(rg),et(PQ),et($ee),et(vte),et(Yte),et(one),et(vne),et(Lne),et(Xne),et(vre),et(xre),et(aie),et(Lie),et(Vie),et(yoe),et(fse),et(kse),et(Yse),et(Qse),et(uae),et(ce)}function wae(){u6(),E6(),x6(),e9(),pae()}function Cae(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var Up,zp,Gp,Yp,jp;wae();Cae(Oe);Oe.__GhostTable=Vy;Oe._getListenersCounter=_G;Oe._getRegisteredMapsCounter=V3;Oe.EventManager=sr;const vae=[ez,aG,M3,_6,nj,Bz,iz,VG,iG,sz,cG,WG],Sae=[$z,hG];Oe.helper={};Oe.dom={};T(vae,t=>{T(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Oe.helper[e]=t[e])})});T(Sae,t=>{T(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Oe.dom[e]=t[e])})});Oe.cellTypes=(Up=Oe.cellTypes)!==null&&Up!==void 0?Up:{};T(aq(),t=>{Oe.cellTypes[t]=My(t)});Oe.cellTypes.registerCellType=dr;Oe.cellTypes.getCellType=My;Oe.editors=(zp=Oe.editors)!==null&&zp!==void 0?zp:{};T(vG(),t=>{Oe.editors[`${yn(t)}Editor`]=xd(t)});Oe.editors.registerEditor=jn;Oe.editors.getEditor=xd;Oe.renderers=(Gp=Oe.renderers)!==null&&Gp!==void 0?Gp:{};T(nY(),t=>{const e=Dd(t);t==="base"&&(Oe.renderers.cellDecorator=e),Oe.renderers[`${yn(t)}Renderer`]=e});Oe.renderers.registerRenderer=ai;Oe.renderers.getRenderer=Dd;Oe.validators=(Yp=Oe.validators)!==null&&Yp!==void 0?Yp:{};T(oY(),t=>{Oe.validators[`${yn(t)}Validator`]=pv(t)});Oe.validators.registerValidator=qa;Oe.validators.getValidator=pv;Oe.plugins=(jp=Oe.plugins)!==null&&jp!==void 0?jp:{};T(mv(),t=>{Oe.plugins[t]=cc(t)});Oe.plugins[`${yn(nt.PLUGIN_KEY)}Plugin`]=nt;Oe.plugins.registerPlugin=et;Oe.plugins.getPlugin=cc;var ob={exports:{}};ob.exports;(function(t){(function(e,n,r){function i(l){var u=this,c=a();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function s(l,u){var c=new i(l),h=u&&u.state,f=c.next;return f.int32=function(){return c.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,h&&(typeof h=="object"&&o(h,c),f.state=function(){return o(c,{})}),f}function a(){var l=4022871197,u=function(c){c=String(c);for(var h=0;h<c.length;h++){l+=c.charCodeAt(h);var f=.02519603282416938*l;l=f>>>0,f-=l,f*=l,l=f>>>0,f-=l,l+=f*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.alea=s})(Fr,t,!1)})(ob);var yae=ob.exports,sb={exports:{}};sb.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,w=(f+g)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xor128=s})(Fr,t,!1)})(sb);var bae=sb.exports,ab={exports:{}};ab.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,w=(f+g)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xorwow=s})(Fr,t,!1)})(ab);var Rae=ab.exports,lb={exports:{}};lb.exports;(function(t){(function(e,n,r){function i(a){var l=this;l.next=function(){var c=l.x,h=l.i,f,g;return f=c[h],f^=f>>>7,g=f^f<<24,f=c[h+1&7],g^=f^f>>>10,f=c[h+3&7],g^=f^f>>>3,f=c[h+4&7],g^=f^f<<7,f=c[h+7&7],f=f^f<<13,g^=f^f<<9,c[h]=g,l.i=h+1&7,g};function u(c,h){var f,g=[];if(h===(h|0))g[0]=h;else for(h=""+h,f=0;f<h.length;++f)g[f&7]=g[f&7]<<15^h.charCodeAt(f)+g[f+1&7]<<13;for(;g.length<8;)g.push(0);for(f=0;f<8&&g[f]===0;++f);for(f==8?g[7]=-1:g[f],c.x=g,c.i=0,f=256;f>0;--f)c.next()}u(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function s(a,l){a==null&&(a=+new Date);var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,w=(f+g)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,c&&(c.x&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xorshift7=s})(Fr,t,!1)})(lb);var Eae=lb.exports,ub={exports:{}};ub.exports;(function(t){(function(e,n,r){function i(a){var l=this;l.next=function(){var c=l.w,h=l.X,f=l.i,g,w;return l.w=c=c+1640531527|0,w=h[f+34&127],g=h[f=f+1&127],w^=w<<13,g^=g<<17,w^=w>>>15,g^=g>>>12,w=h[f]=w^g,l.i=f,w+(c^c>>>16)|0};function u(c,h){var f,g,w,C,S,b=[],_=128;for(h===(h|0)?(g=h,h=null):(h=h+"\0",g=0,_=Math.max(_,h.length)),w=0,C=-32;C<_;++C)h&&(g^=h.charCodeAt((C+32)%h.length)),C===0&&(S=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,C>=0&&(S=S+1640531527|0,f=b[C&127]^=g+S,w=f==0?w+1:0);for(w>=128&&(b[(h&&h.length||0)&127]=-1),w=127,C=4*128;C>0;--C)g=b[w+34&127],f=b[w=w+1&127],g^=g<<13,f^=f<<17,g^=g>>>15,f^=f>>>12,b[w]=g^f;c.w=S,c.X=b,c.i=w}u(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function s(a,l){a==null&&(a=+new Date);var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,w=(f+g)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,c&&(c.X&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xor4096=s})(Fr,t,!1)})(ub);var Tae=ub.exports,cb={exports:{}};cb.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.next=function(){var h=l.b,f=l.c,g=l.d,w=l.a;return h=h<<25^h>>>7^f,f=f-g|0,g=g<<24^g>>>8^w,w=w-h|0,l.b=h=h<<20^h>>>12^f,l.c=f=f-g|0,l.d=g<<16^f>>>16^w,l.a=w-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,w=(f+g)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.tychei=s})(Fr,t,!1)})(cb);var _ae=cb.exports,$D={exports:{}};const Mae={},Aae=Object.freeze(Object.defineProperty({__proto__:null,default:Mae},Symbol.toStringTag,{value:"Module"})),Oae=gO(Aae);(function(t){(function(e,n,r){var i=256,o=6,s=52,a="random",l=r.pow(i,o),u=r.pow(2,s),c=u*2,h=i-1,f;function g(x,I,$){var z=[];I=I==!0?{entropy:!0}:I||{};var q=b(S(I.entropy?[x,O(n)]:x??_(),3),z),Y=new w(z),K=function(){for(var te=Y.g(o),oe=l,ie=0;te<u;)te=(te+ie)*i,oe*=i,ie=Y.g(1);for(;te>=c;)te/=2,oe/=2,ie>>>=1;return(te+ie)/oe};return K.int32=function(){return Y.g(4)|0},K.quick=function(){return Y.g(4)/4294967296},K.double=K,b(O(Y.S),n),(I.pass||$||function(te,oe,ie,ue){return ue&&(ue.S&&C(ue,Y),te.state=function(){return C(Y,{})}),ie?(r[a]=te,oe):te})(K,q,"global"in I?I.global:this==r,I.state)}function w(x){var I,$=x.length,z=this,q=0,Y=z.i=z.j=0,K=z.S=[];for($||(x=[$++]);q<i;)K[q]=q++;for(q=0;q<i;q++)K[q]=K[Y=h&Y+x[q%$]+(I=K[q])],K[Y]=I;(z.g=function(te){for(var oe,ie=0,ue=z.i,be=z.j,Ue=z.S;te--;)oe=Ue[ue=h&ue+1],ie=ie*i+Ue[h&(Ue[ue]=Ue[be=h&be+oe])+(Ue[be]=oe)];return z.i=ue,z.j=be,ie})(i)}function C(x,I){return I.i=x.i,I.j=x.j,I.S=x.S.slice(),I}function S(x,I){var $=[],z=typeof x,q;if(I&&z=="object")for(q in x)try{$.push(S(x[q],I-1))}catch{}return $.length?$:z=="string"?x:x+"\0"}function b(x,I){for(var $=x+"",z,q=0;q<$.length;)I[h&q]=h&(z^=I[h&q]*19)+$.charCodeAt(q++);return O(I)}function _(){try{var x;return f&&(x=f.randomBytes)?x=x(i):(x=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(x)),O(x)}catch{var I=e.navigator,$=I&&I.plugins;return[+new Date,e,$,e.screen,O(n)]}}function O(x){return String.fromCharCode.apply(0,x)}if(b(r.random(),n),t.exports){t.exports=g;try{f=Oae}catch{}}else r["seed"+a]=g})(typeof self<"u"?self:Fr,[],Math)})($D);var Pae=$D.exports,Iae=yae,xae=bae,Hae=Rae,Dae=Eae,Nae=Tae,Lae=_ae,ta=Pae;ta.alea=Iae;ta.xor128=xae;ta.xorwow=Hae;ta.xorshift7=Dae;ta.xor4096=Nae;ta.tychei=Lae;var kae=ta;const FD=cC(kae);let WD=FD();function VD(){return WD()}function $ae(t){WD=FD(t)}function na(t,e){let n=t;if(Array.isArray(t)){let r=t;e!=null&&e.maxCharCount&&typeof t[0]=="string"&&(r=t.filter(i=>i.length<=e.maxCharCount)),n=()=>BD(r)}return(e==null?void 0:e.length)===void 0?n(0):Array.from({length:e.length},(r,i)=>n(i))}function BD(t){return t[Math.floor(VD()*t.length)]}function Fae({min:t=1,max:e=9999.99,fraction:n=0}={}){if(e<t)throw new Error("Max must be bigger than min");return Number((VD()*(e-t)+t).toFixed(n))}function lO(t){return na(()=>BD([!0,!1]),t)}function $i(t){const e={min:(t==null?void 0:t.min)??0,max:(t==null?void 0:t.max)??999999,precision:t==null?void 0:t.precision,fraction:t==null?void 0:t.fraction};return na(()=>{if(e.min===e.max)return e.min;const n=Fae(e);return e.precision!==void 0?Math.floor(n/e.precision)*e.precision:n},t)}function Wae(t){const e=new Date(t.from).getTime(),n=new Date(t.to).getTime();if(e>=n)throw new Error("From must be before to");return na(()=>new Date($i({min:e,max:n})),t)}var Vae=["Kautzer, Macejkovic and Fisher","Greenholt - Mosciski","Marquardt - Runolfsdottir","Abernathy Inc","Dickens - Lang","Hand, Bernhard and Kessler","Abbott LLC","Kub Inc","Johnston - Wisozk","Reichert LLC","Kohler LLC","Shanahan - Boyle","Batz - Rice","Cronin, Oberbrunner and Beier","Kuhlman, Schowalter and West","Luettgen Inc","Ward Group","Hills and Sons","Prohaska, Balistreri and Walker","Rempel - Durgan","Bernier LLC","Stehr - Lockman","Roberts, Rogahn and Dooley","Lesch - Jakubowski","Jenkins - Turcotte","Gerhold - Rowe","Block - Rau","Dickinson, Tremblay and Moore","Nader - Fritsch","Kreiger and Sons","Bartell, Wehner and Schowalter","Hegmann Inc","Orn, Spencer and Kiehn","Graham, Sipes and Towne","Hodkiewicz Inc","Mills Group","Legros, Tillman and Hodkiewicz","Lesch - Carter","Lesch Group","Kreiger - Sauer","Cartwright - Schuster","Labadie LLC","Pfannerstill, White and Mosciski","Jenkins LLC","Boehm, Hettinger and Huels","Maggio, Wisoky and Blick","Kozey Inc","Stracke - Wisozk","Olson, Olson and Carter","Orn, Gerlach and Runolfsdottir","Stracke - Kertzmann","Walker - Zieme","Hodkiewicz - Hintz","Lind Group","Fahey, Leannon and Gleichner","Mertz, Gusikowski and Lemke","Heidenreich - Aufderhar","Zboncak and Sons","Carroll Group","Brown LLC","Weber Inc","Rath LLC","Walker Inc","Heller, Hyatt and Jaskolski","Jacobi - Kutch","Skiles and Sons","Durgan - Stamm","Renner - Prosacco","Hahn - Welch","Lesch, Dooley and Bartell","Crona and Sons","Rogahn, Armstrong and Goyette","Lubowitz, Kuhlman and Bailey","Doyle Group","Dooley and Sons","Kerluke LLC","Bogan - Daniel","Hintz - Boehm","Swaniawski and Sons","Kris, Legros and Cartwright","Reichel Group","Russel - Hintz","Welch, Lockman and Hand","Pouros - Brakus","Mohr, Fritsch and Wisozk","Upton - Reichert","Koepp and Sons","Weber and Sons","Quigley, Bins and Becker","Strosin, Oberbrunner and Wunsch","Rodriguez - Spencer","Wilkinson - Dare","Gutkowski Inc","OReilly LLC","Collins, Mante and Pacocha","Steuber, Luettgen and Corkery","Kub and Sons","Lesch and Sons"];function uO(t){return na(Vae,t)}var Bae=["Argentina","Peru","Colombia","Chile","Uruguay","Gabon","Congo","Norfolk Island","Qatar","Syrian Arab Republic","Wallis and Futuna","Somalia","Saint Barthelemy","Comoros","Sri Lanka","Czech Republic","Christmas Island","Macao","Montenegro","Anguilla","Canada","Mayotte","Tajikistan","Afghanistan","Liechtenstein","Cocos (Keeling) Islands","Angola","Bahrain","Dominican Republic","Croatia","Latvia","Virgin Islands, U.S.","United Kingdom","Brazil","Spain","Mongolia","Montserrat","Estonia","Benin","Guinea","Guinea-Bissau","Greece","Lao Peoples Democratic Republic","Puerto Rico","Slovakia (Slovak Republic)","United States of America","Switzerland","Costa Rica","Mauritius","Nigeria","Russian Federation","Germany","Antigua and Barbuda","Albania","Romania","Moldova","Senegal","Tanzania","British Indian Ocean Territory (Chagos Archipelago)","Central African Republic","New Caledonia","Burundi","Panama","Azerbaijan","Namibia","French Southern Territories","Vanuatu","Ethiopia","Burkina Faso","Tunisia","Mozambique","Belarus","Saint Kitts and Nevis","Hungary","Indonesia","Cyprus","Ecuador","Saint Martin","Nauru","Faroe Islands","Iran","Bolivia","Pitcairn Islands","France","Paraguay","Isle of Man","Sierra Leone","Monaco","Belize","Trinidad and Tobago"];function Uae(t){return na(Bae,t)}var zae={china:["Peking roasted duck","Kung pao chicken","Sweet and sour pork","Hot pot","Dim sum","Dumplings","Ma po tofu","Char siu","Chicken chow mein","Beef chow mein","vegetable chow mein","Chicken fried rice","Beef fried rice","Vegetable fried Rice","Special fried Rice","Sichuan pork","Xiaolongbao","Zhajiangmian","Wonton soup","Sweet and sour pork","Duck spring Rolls","Vegetable spring Rolls","Wonton","Peking duck","Lamb hot pot","Spicy crayfish","Guilin rice noodles","Lanzhou hand-pulled noodles","Steamed crab","Shredded pork with garlic sauce","Red braised pork","Sweet and sour Ribs","Xinjiang","Braised pork with vermicelli"],italy:["Butternut squash risotto","Mushroom risotto","Beetroot risotto","Courgette risotto","Pizza","Gnocchi","Spaghetti bolognese","Spaghetti carbonara","Pesto alla Genovese","Beef lasagne","Vegetable lasagne","Gelato","Prosciutto di Parma","Ribollita","Bagna cauda","Polenta","Tortelli and ravioli","Focaccia","Garlic bread","Arancini","Il tartufo","Panzerotto fritto","Fiorentina","Minestrone","Frico","Arrosticini","Olive ascolante","Fritto misto piemontes","TiramisÃ¹"],india:["Biryani","Dosa","Tandoori chicken","Samosas","Chaat","Plain naan","Garlic naan","Pilau rice","Steamed rice","Chicken madras","Vegetable madras","Chicken vindaloo","Chicken jalfrezi","Chicken roghan josh","Lamb roghan josh","Beef roghan josh","Butter chicken","Dosa","Gulab jamun","Chicken korma","Mutter paneer","Papadum","Paratha","Raita","Saag paneer","Tandoori chicken","Chicken tikka masala","Pakora","Dal","Chapati","Pasanda","Aloo gobi","Kofta","Chicken makhani","Paneer naan","Chana Aloo Curry"],mexico:["Chilaquiles","Pozole","Tacos al pastor","Tostadas","Chiles en nogada","Elote","Enchiladas","Mole","Guacamole","Tamales","Huevos rancheros","Machaca","Discada","Beef Burrito","Chicken Burrito","Pozole de pollo o duajolote","Menudo","Cochinita pibil","Tamale","Quesadilla","Frijoles puercos","Chile en nogada","Esquites","Alegria de amaranto","PipiÃ¡n","Aguachile","Ceviche","Pescado zarandeado","Camarones a la diabla","Birria de chivo","Tlayuda","Guacamole con chapulines","Flautas","Torta Ahogada","Carnitas","Caldo Azteca","Gorditas de Nata"],japan:["Sushi","Udon","Tofu","Tempura","Yakitori","Sashimi","Ramen","Donburi","Natto","Oden","Tamagoyaki","Soba","Tonkatsu","Kashipan","Sukiyaki","Miso soup","Okonomiyaki","Mentaiko","Nikujaga","Unagi no kabayaki","Shabu Shabu","Onigiri","Gyoza","Takoyaki","aiseki ryori","Edamame","Yakisoba","Chawanmushi","Wagashi"],france:["Foie gras","HuÃ®tres","Cassoulet","Poulet basquaise","Escargots au beurre persillÃ©","Mouclade charentaise","Galettes bretonnes","Flemish carbonnade","Quiche lorraine","Raclette","Cheese fondue","Beef fondue","Gratin dauphinois","Tartiflette","Bouillabaisse","Ratatouille","Boeuf bourguignon","Blanquette de veau","Pot-au-feu","Coq-au-vin","Hachis parmentier","Steak tartare","Choucroute","SoufflÃ© au fromage","Cuisses de grenouilles","Soupe Ã  lâoignon","Baguette","Croissant","French cheeses","Fondant au chocolat","Tarte tatin","Macarons","CrÃ¨me brÃ»lÃ©e","Ãle flottante","Profiteroles","Pain au chocolat"],lebanon:["Kibbeh","Kafta","Kanafeh","Hummus","Rice pilaf","Fattoush","Manakish","Tabbouleh","Sfeeha","Fattoush","Labneh","Muhammara","Lahm bi ajin","Kaak","Chanklich","Mssabaha","Shawarma","Kebbe","Falafel","Halewit el jeben","Namoura","Maamoul","Foul mdammas","Balila","Kawarma","Fattouch"],thailand:["Pad kra pao moo","Tom kha gai","Khao Pad","Chicken pad Thai","Vegetable pad Thai","Moo satay","Tom yum goong","Khao niew mamuang","Kai yad sai","Khao soi","Pad see ew","Laab moo","Gaeng panang","Gai pad med ma muang","Som tam","Poh pia tod","Gaeng massaman","Pla kapung nueng manao","Tod mun pla","Gaeng ped","Gaeng garee","Gaeng keow wan","Moo ping","Durian","Sai ooah","Hoy tod","Kuay teow reua","Mu kratha","Kao ka moo","Yam nua"],greece:["Moussaka","Papoutsakia","Pastitsio","Souvlaki","Soutzoukakia","Stifado","Tomatokeftedes","Tzatziki","Kolokithokeftedes","Giouvetsi","Choriatiki","Kleftiko","Gemista","Fasolada","Bougatsa","Tiropita","Spanakopita","Feta Cheese with Honey","Horta","Tirokroketes","Briam","Saganaki","Gigantes","Dolmades","Fasolatha","Koulouri","Loukoumades","Gyros","Galaktoboureko","Baklava"],turkey:["ÅiÅ kebap","DÃ¶ner","KÃ¶fte","Pide","Kumpir","Meze","MantÄ±","Lahmacun","Menemen","ÅiÅ kebap","Ä°skender kebab","Corba","Kuzu tandir","ÃiÄ KÃ¶fte","Pilav","Yaprak sarma","Dolma","Ä°mam bayÄ±ldÄ±","Borek","Durum","Kumpir","Balik ekmek","Simit","Kunefe","Baklava","Lokum","Halva","Mozzaik pasta","GÃ¼llaÃ§","Mercimek KÃ¶ftesi","Haydari","Tursu suyu","Kahvalti","Kazan dibi","Hunkar begendi","Islak burgers","Salep","Yogurtlu kebab"],spain:["Tortilla de patatas","Fabada asturiana","CalÃ§ots","Boquerones al vinagre","Empanada gallega","Paella","Gazpacho","Gachas","Migas","Bocadillo de calamares","Pulpo a feira","Caldo gallego","Lentejas con chorizo","Cocido madrileÃ±o","Cachopo","Caracoles"],venezuela:["PabellÃ³n criollo","Arepa","Mondongo","Empanadas","Quesillo","Chicha andina","TequeÃ±os","Cachapa","Hallaca","Perico","Pasticho","Mandocas","Caraotas negras","Patacones","Dulce de leche","Pan de JamÃ³n"],chile:["Humitas","Empanadas","Porotos con riendas","Completos","Manjar","Cordero al palo","Pastel de choclo","Mote con huesillos","Sopaipillas","Curanto"],argentina:["Milanesas","Empanadas","Pizza fugazeta","Asado","Choripan","Bondiola","Bife de chorizo"],colombia:["Bandeja paisa","Chuleta valluna","Sancocho trifÃ¡sico","Empanada valluna","Salpicon de frutas","Pastel de garbanzo","Ajiaco","Arepas","Arroz de lisa","Sancocho","Pan de bono","Cuchuco","Oblea","Cazuela de mariscos","Pan de yuca","Bollo Limpio","AlmojÃ¡bana","Empanadas","Arroz con Coco","Sopa de mondongo","Cazuela de Mariscos","Arroz con Pollo","Arepa de Huevo","Mote de Queso"],ecuador:["Encebollado","Ceviche","Tigrillo","Bolon de verde","Llapingacho","Mote pillo","Locro de papa","Churrasco"],peru:["Ceviche","Arroz con pollo","Aji de gallina","Llunca de gallina"],"el salvador":["Pupusa","Sopa de patas","Rigua","Flor de izote con huevo","Gallo en chicha"],romania:["Sarmale","Mici","Pomana porcului","CiorbÄ de fasole cu ciolan","CiorbÄ de burtÄ","CiorbÄ rÄdÄuÈeanÄ","PlÄcintÄ cu brÃ¢nzÄ","CiorbÄ de potroace","MÄmÄligÄ cu brÃ¢nzÄ Èi smÃ¢ntÃ¢nÄ","TochiturÄ","Piftie","Iahnie de fasole","SlÄninÄ afumatÄ","CÃ¢rnaÈi afumaÈi","VarzÄ a la Cluj","GulaÈ de cartofi cu afumÄturÄ","Cozonac de casÄ","CiorbÄ ardeleneascÄ de porc","Mucenici moldoveneÈti","SalatÄ de boeuf","Dovleac copt","PapanaÈi cu brÃ¢nzÄ de vacÄ Èi afine","Drob de miel","PÃ¢rjoale moldoveneÈti","ZacuscÄ de vinete","ZacuscÄ de fasole","TurtÄ dulce","ClÄtitele cu gem","ClÄtitele cu brÃ¢nza de vacÄ","BalmoÈ","Cozonac","Chiftele"]},fO;(fO=Object.keys(zae))==null||fO.length;function cO(t){const e=(t==null?void 0:t.years)??1;if(e<=0)throw new Error("Years must be positive, use future() instead");const n=365*e*24*60*60*1e3,r=new Date,i=new Date(r.getTime()-n);return na(()=>Wae({from:i,to:r}),t)}var Gae=["Small Rubber Shoes","Fantastic Wooden Sausages","Handmade Frozen Salad","Intelligent Soft Car","Intelligent Concrete Chips","Handcrafted Concrete Bacon","Small Fresh Fish","Rustic Metal Towels","Unbranded Cotton Hat","Fantastic Frozen Bike","Generic Rubber Shirt","Unbranded Wooden Keyboard","Awesome Metal Computer","Gorgeous Fresh Shoes","Unbranded Concrete Sausages","Practical Wooden Ball","Ergonomic Soft Towels","Small Plastic Table","Awesome Metal Pants","Licensed Steel Sausages","Handcrafted Rubber Bike","Ergonomic Cotton Computer","Generic Wooden Ball","Fantastic Frozen Soap","Generic Plastic Keyboard","Awesome Cotton Pizza","Licensed Metal Chips","Handcrafted Cotton Towels","Handmade Plastic Tuna","Practical Granite Keyboard","Intelligent Concrete Soap","Rustic Concrete Chips","Fantastic Steel Hat","Rustic Cotton Chair","Gorgeous Metal Pants","Intelligent Metal Bacon","Handmade Rubber Car","Tasty Concrete Keyboard","Incredible Granite Hat","Practical Rubber Fish","Rustic Cotton Gloves","Rustic Cotton Ball","Refined Fresh Shirt","Generic Granite Sausages","Rustic Granite Fish","Practical Wooden Bacon","Sleek Plastic Chair","Handcrafted Fresh Mouse","Small Concrete Shoes","Awesome Fresh Chair","Incredible Soft Computer","Tasty Concrete Chips","Generic Rubber Sausages","Intelligent Concrete Chicken","Rustic Soft Ball","Awesome Steel Towels","Incredible Fresh Bike","Unbranded Granite Chicken","Rustic Concrete Bike","Small Frozen Sausages","Intelligent Plastic Gloves","Ergonomic Frozen Towels","Refined Frozen Ball","Refined Cotton Ball","Licensed Steel Salad","Intelligent Wooden Bacon","Unbranded Metal Shoes","Fantastic Granite Car","Ergonomic Granite Bacon","Awesome Wooden Shirt","Rustic Wooden Pizza","Tasty Frozen Table","Awesome Wooden Hat","Awesome Rubber Salad","Licensed Concrete Fish","Fantastic Soft Cheese","Rustic Frozen Pizza","Refined Concrete Tuna","Small Frozen Tuna","Licensed Granite Cheese","Practical Rubber Car","Rustic Steel Sausages","Awesome Concrete Hat","Awesome Granite Sausages","Sleek Plastic Chips","Handcrafted Wooden Gloves","Intelligent Metal Computer","Fantastic Fresh Sausages","Fantastic Plastic Salad","Unbranded Steel Sausages","Handcrafted Wooden Fish","Sleek Wooden Bacon","Unbranded Plastic Towels","Tasty Soft Sausages","Generic Metal Shirt","Handmade Granite Cheese","Small Fresh Bacon","Tasty Granite Towels","Licensed Steel Chips"];function hO(t){return na(Gae,t)}$ae("42219");const UD=[{companyName:uO({maxCharCount:18}),productName:hO({maxCharCount:18}),sellDate:cO().toLocaleDateString("en-gb"),inStock:lO(),qty:$i({max:500}),orderId:`${$i({max:9,min:0})}${$i({max:9,min:0})}-${$i({max:9999999,min:1111111})}`,country:"United Kingdom"},...Array.from({length:150},()=>({companyName:uO({maxCharCount:18}),productName:hO({maxCharCount:18}),sellDate:cO().toLocaleDateString("en-gb"),inStock:lO(),qty:$i({max:500}),orderId:`${$i({max:9,min:0})}${$i({max:9,min:0})}-${$i({max:9999999,min:1111111})}`,country:Uae({maxCharCount:28})}))],Yae=UD.reduce((t,e)=>t.includes(e.country)?t:[...t,e.country],[]),dO=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]);function jae(t,e){if(!(t<0)&&e.firstChild){const n=this.isRtl()?"htRight":"htLeft";dO.has(t.toString())?(Oe.dom.removeClass(e.firstChild,n),Oe.dom.addClass(e.firstChild,dO.get(t.toString()))):Oe.dom.addClass(e.firstChild,n)}}const Kae=document.getElementById("handsontable"),Zn={data:UD,height:464,colWidths:[140,165,100,100,100,110,178],colHeaders:["Company name","Product name","Sell date","In stock","Qty","Order ID","Country"],columns:[{data:"companyName",type:"text"},{data:"productName",type:"text"},{data:"sellDate",type:"date",dateFormat:"DD/MM/YYYY",allowInvalid:!1},{data:"inStock",type:"checkbox",className:"htCenter"},{data:"qty",type:"numeric"},{data:"orderId",type:"text"},{data:"country",type:"dropdown",source:Yae}],dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,navigableHeaders:!0,disableTabNavigation:!1,autoWrapRow:!0,autoWrapCol:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,manualRowMove:!0,afterGetColHeader:jae,licenseKey:"non-commercial-and-evaluation"};let kn=new Oe(Kae,Zn);const ra=(t,e)=>t.addEventListener("click",n=>e(t.checked));ra(document.querySelector("#enable-tab-navigation"),t=>{Zn.disableTabNavigation=!t,kn.updateSettings({disableTabNavigation:Zn.disableTabNavigation}),console.log("Updated setting: disableTabNavigation to",kn.getSettings().disableTabNavigation)});ra(document.querySelector("#enable-header-navigation"),t=>{Zn.navigableHeaders=t,kn.updateSettings({navigableHeaders:Zn.navigableHeaders}),console.log("Updated setting: navigableHeaders to",kn.getSettings().navigableHeaders)});ra(document.querySelector("#enable-cell-virtualization"),t=>{kn.destroy(),kn=new Oe(document.getElementById("handsontable"),{...Zn,renderAllRows:!t,viewportColumnRenderingOffset:t?"auto":9}),console.log("Updated setting: renderAllRows to",kn.getSettings().renderAllRows)});ra(document.querySelector("#enable-cell-enter-editing"),t=>{Zn.enterBeginsEditing=t,kn.updateSettings({enterBeginsEditing:Zn.enterBeginsEditing}),console.log("Updated setting: enable-cell-enter-editing to",kn.getSettings().enterBeginsEditing)});ra(document.querySelector("#enable-arrow-rl-first-last-column"),t=>{Zn.autoWrapRow=t,kn.updateSettings({autoWrapRow:Zn.autoWrapRow}),console.log("Updated setting: autoWrapRow to",kn.getSettings().autoWrapRow)});ra(document.querySelector("#enable-arrow-td-first-last-column"),t=>{Zn.autoWrapCol=t,kn.updateSettings({autoWrapCol:Zn.autoWrapCol}),console.log("Updated setting: autoWrapCol to",kn.getSettings().autoWrapCol)});ra(document.querySelector("#enable-enter-focus-editing"),t=>{Zn.enterMoves=t?{col:0,row:1}:{col:0,row:0},kn.updateSettings({enterMoves:Zn.enterMoves}),console.log("Updated setting: enterMoves to",kn.getSettings().enterMoves)})});export default Xae();
