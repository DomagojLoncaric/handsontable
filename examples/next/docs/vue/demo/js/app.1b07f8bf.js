(function(){var t={4877:function(t,e,o){"use strict";var n={};o.r(n),o.d(n,{arrayAvg:function(){return _},arrayEach:function(){return k},arrayFilter:function(){return I},arrayFlatten:function(){return D},arrayMap:function(){return A},arrayMax:function(){return P},arrayMin:function(){return N},arrayReduce:function(){return x},arraySum:function(){return O},arrayUnique:function(){return L},extendArray:function(){return T},getDifferenceOfArrays:function(){return V},getIntersectionOfArrays:function(){return B},getUnionOfArrays:function(){return F},pivot:function(){return H},stringToArray:function(){return W},to2dArray:function(){return M}});var i={};o.r(i),o.d(i,{_injectProductInfo:function(){return st},isDefined:function(){return U},isEmpty:function(){return G},isRegExp:function(){return Y},isUndefined:function(){return $},stringify:function(){return z}});var s={};o.r(s),o.d(s,{equalsIgnoreCase:function(){return at},isPercentValue:function(){return ct},randomString:function(){return ht},sanitize:function(){return gt},stripTags:function(){return ut},substitute:function(){return dt},toUpperCaseFirst:function(){return lt}});var r={};o.r(r),o.d(r,{HTML_CHARACTERS:function(){return we},addClass:function(){return de},addEvent:function(){return _e},clearTextSelection:function(){return Fe},closest:function(){return ne},closestDown:function(){return ie},empty:function(){return pe},fastInnerHTML:function(){return Ce},fastInnerText:function(){return ve},getCaretPosition:function(){return Le},getComputedStyle:function(){return Ae},getCssTransform:function(){return Ke},getFrameElement:function(){return te},getParent:function(){return Jt},getParentWindow:function(){return ee},getScrollLeft:function(){return Me},getScrollTop:function(){return Ee},getScrollableElement:function(){return Te},getScrollbarWidth:function(){return Ue},getSelectionEndPosition:function(){return Ve},getSelectionText:function(){return Be},getStyle:function(){return xe},getTrimmingContainer:function(){return He},getWindowScrollLeft:function(){return Re},getWindowScrollTop:function(){return be},hasAccessToParentWindow:function(){return oe},hasClass:function(){return ce},hasHorizontalScrollbar:function(){return Ge},hasVerticalScrollbar:function(){return $e},index:function(){return re},innerHeight:function(){return Pe},innerWidth:function(){return Ne},isChildOf:function(){return se},isDetached:function(){return Ze},isInput:function(){return qe},isOutsideInput:function(){return Qe},isThisHotChild:function(){return Zt},isVisible:function(){return ye},makeElementContentEditableAndSelectItsContent:function(){return eo},matchesCSSRules:function(){return Ie},observeVisibilityChangeOnce:function(){return to},offset:function(){return Se},outerHeight:function(){return Oe},outerWidth:function(){return ke},overlayContainsElement:function(){return le},removeAttribute:function(){return fe},removeClass:function(){return ue},removeContentEditableFromElementAndDeselect:function(){return oo},removeEvent:function(){return De},removeTextNodes:function(){return me},resetCssTransform:function(){return Xe},runWithSelectedContendEditableElement:function(){return no},selectElementIfAllowed:function(){return Je},setAttribute:function(){return ge},setCaretPosition:function(){return We},setOverlayPosition:function(){return Ye}});var l={};o.r(l),o.d(l,{curry:function(){return co},curryRight:function(){return uo},debounce:function(){return lo},fastCall:function(){return go},isFunction:function(){return io},partial:function(){return ho},pipe:function(){return ao},throttle:function(){return so},throttleAfterHits:function(){return ro}});var a={};o.r(a),o.d(a,{clone:function(){return vo},createObjectPropListener:function(){return xo},deepClone:function(){return Co},deepExtend:function(){return wo},deepObjectSize:function(){return Ho},defineGetter:function(){return Ro},duckSchema:function(){return fo},extend:function(){return po},getProperty:function(){return Mo},hasOwnProperty:function(){return Io},inherit:function(){return mo},isObject:function(){return bo},isObjectEqual:function(){return So},mixin:function(){return yo},objectEach:function(){return Eo},setProperty:function(){return To}});var h={};o.r(h),o.d(h,{isChrome:function(){return _o},isChromeWebKit:function(){return Do},isEdge:function(){return Fo},isEdgeWebKit:function(){return Wo},isFirefox:function(){return Lo},isFirefoxWebKit:function(){return Vo},isIOS:function(){return zo},isIpadOS:function(){return Uo},isLinuxOS:function(){return Yo},isMacOS:function(){return Go},isMobileBrowser:function(){return jo},isSafari:function(){return Bo},isWindowsOS:function(){return $o},setBrowserMeta:function(){return Po},setPlatformMeta:function(){return No}});var c={};o.r(c),o.d(c,{KEY_CODES:function(){return Ko},isCtrlKey:function(){return Jo},isCtrlMetaKey:function(){return Zo},isFunctionKey:function(){return Qo},isKey:function(){return tn},isPrintableChar:function(){return qo}});var d={};o.r(d),o.d(d,{isImmediatePropagationStopped:function(){return on},isLeftClick:function(){return sn},isRightClick:function(){return nn},offsetRelativeTo:function(){return rn},stopImmediatePropagation:function(){return en}});var u={};o.r(u),o.d(u,{_dataToHTML:function(){return di},htmlToGridSettings:function(){return ui},instanceToHTML:function(){return ci}});var g={};o.r(g),o.d(g,{clamp:function(){return Ci},isNumeric:function(){return gi},isNumericLike:function(){return fi},rangeEach:function(){return mi},rangeEachReverse:function(){return pi},valueAccordingPercent:function(){return wi}});var f={};o.r(f),o.d(f,{cancelAnimationFrame:function(){return os},getComparisonFunction:function(){return ss},isTouchSupported:function(){return ns},requestAnimationFrame:function(){return es}});var m={};o.r(m),o.d(m,{countFirstRowKeys:function(){return th},createEmptySpreadsheetData:function(){return Ja},createSpreadsheetData:function(){return qa},createSpreadsheetObjectData:function(){return Qa},dataRowToChangesArray:function(){return Za},isArrayOfArrays:function(){return eh},isArrayOfObjects:function(){return oh},spreadsheetColumnIndex:function(){return Xa},spreadsheetColumnLabel:function(){return Ka}});var p={};o.r(p),o.d(p,{CHECKBOX_CHECKED:function(){return _d},CHECKBOX_RENDERER_NAMESPACE:function(){return Nd},CHECKBOX_UNCHECKED:function(){return Dd},CONTEXTMENU_ITEMS_ADD_COMMENT:function(){return Ic},CONTEXTMENU_ITEMS_ALIGNMENT:function(){return Pc},CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:function(){return Fc},CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:function(){return _c},CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:function(){return Lc},CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:function(){return Nc},CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:function(){return Bc},CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:function(){return Dc},CONTEXTMENU_ITEMS_ALIGNMENT_TOP:function(){return Vc},CONTEXTMENU_ITEMS_BORDERS:function(){return Wc},CONTEXTMENU_ITEMS_BORDERS_BOTTOM:function(){return Uc},CONTEXTMENU_ITEMS_BORDERS_LEFT:function(){return $c},CONTEXTMENU_ITEMS_BORDERS_RIGHT:function(){return zc},CONTEXTMENU_ITEMS_BORDERS_TOP:function(){return jc},CONTEXTMENU_ITEMS_CLEAR_COLUMN:function(){return vc},CONTEXTMENU_ITEMS_COPY:function(){return yc},CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:function(){return Rc},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:function(){return bc},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:function(){return Sc},CONTEXTMENU_ITEMS_CUT:function(){return Ec},CONTEXTMENU_ITEMS_EDIT_COMMENT:function(){return Ac},CONTEXTMENU_ITEMS_FREEZE_COLUMN:function(){return Mc},CONTEXTMENU_ITEMS_HIDE_COLUMN:function(){return Xc},CONTEXTMENU_ITEMS_HIDE_ROW:function(){return Qc},CONTEXTMENU_ITEMS_INSERT_LEFT:function(){return uc},CONTEXTMENU_ITEMS_INSERT_RIGHT:function(){return gc},CONTEXTMENU_ITEMS_MERGE_CELLS:function(){return Hc},CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:function(){return Kc},CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:function(){return Yc},CONTEXTMENU_ITEMS_NO_ITEMS:function(){return hc},CONTEXTMENU_ITEMS_READ_ONLY:function(){return Cc},CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:function(){return Oc},CONTEXTMENU_ITEMS_REDO:function(){return wc},CONTEXTMENU_ITEMS_REMOVE_BORDERS:function(){return Gc},CONTEXTMENU_ITEMS_REMOVE_COLUMN:function(){return mc},CONTEXTMENU_ITEMS_REMOVE_COMMENT:function(){return kc},CONTEXTMENU_ITEMS_REMOVE_ROW:function(){return fc},CONTEXTMENU_ITEMS_ROW_ABOVE:function(){return cc},CONTEXTMENU_ITEMS_ROW_BELOW:function(){return dc},CONTEXTMENU_ITEMS_SHOW_COLUMN:function(){return qc},CONTEXTMENU_ITEMS_SHOW_ROW:function(){return Jc},CONTEXTMENU_ITEMS_UNDO:function(){return pc},CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:function(){return Tc},CONTEXTMENU_ITEMS_UNMERGE_CELLS:function(){return xc},CONTEXT_MENU_ITEMS_NAMESPACE:function(){return lc},FILTERS_BUTTONS_CANCEL:function(){return Ad},FILTERS_BUTTONS_CLEAR:function(){return xd},FILTERS_BUTTONS_OK:function(){return Id},FILTERS_BUTTONS_PLACEHOLDER_SEARCH:function(){return kd},FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:function(){return Pd},FILTERS_BUTTONS_PLACEHOLDER_VALUE:function(){return Od},FILTERS_BUTTONS_SELECT_ALL:function(){return Hd},FILTERS_CONDITIONS_AFTER:function(){return wd},FILTERS_CONDITIONS_BEFORE:function(){return Cd},FILTERS_CONDITIONS_BEGINS_WITH:function(){return rd},FILTERS_CONDITIONS_BETWEEN:function(){return md},FILTERS_CONDITIONS_BY_VALUE:function(){return cd},FILTERS_CONDITIONS_CONTAINS:function(){return ad},FILTERS_CONDITIONS_EMPTY:function(){return od},FILTERS_CONDITIONS_ENDS_WITH:function(){return ld},FILTERS_CONDITIONS_EQUAL:function(){return id},FILTERS_CONDITIONS_GREATER_THAN:function(){return dd},FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:function(){return ud},FILTERS_CONDITIONS_LESS_THAN:function(){return gd},FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:function(){return fd},FILTERS_CONDITIONS_NAMESPACE:function(){return td},FILTERS_CONDITIONS_NONE:function(){return ed},FILTERS_CONDITIONS_NOT_BETWEEN:function(){return pd},FILTERS_CONDITIONS_NOT_CONTAIN:function(){return hd},FILTERS_CONDITIONS_NOT_EMPTY:function(){return nd},FILTERS_CONDITIONS_NOT_EQUAL:function(){return sd},FILTERS_CONDITIONS_TODAY:function(){return vd},FILTERS_CONDITIONS_TOMORROW:function(){return yd},FILTERS_CONDITIONS_YESTERDAY:function(){return Sd},FILTERS_DIVS_FILTER_BY_CONDITION:function(){return bd},FILTERS_DIVS_FILTER_BY_VALUE:function(){return Rd},FILTERS_LABELS_CONJUNCTION:function(){return Ed},FILTERS_LABELS_DISJUNCTION:function(){return Md},FILTERS_NAMESPACE:function(){return Zc},FILTERS_VALUES_BLANK_CELLS:function(){return Td}});var w={};o.r(w),o.d(w,{getNormalizedDate:function(){return cC}});var C=o(6427),v=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("DataGrid")],1)},y=[],S=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"example"}},[e("hot-table",{ref:"hotTableComponent",attrs:{data:t.data,settings:t.hotSettings}})],1)},b=[],R=(o(9796),o(3247),o(9028),o(9757)),E=o(8289);function M(t){const e=t.length;let o=0;while(o<e)t[o]=[t[o]],o+=1}function T(t,e){const o=e.length;let n=0;while(n<o)t.push(e[n]),n+=1}function H(t){const e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;const o=t.length,n=t[0].length;for(let i=0;i<o;i++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function x(t,e,o,n){let i=-1,s=t,r=o;Array.isArray(t)||(s=Array.from(t));const l=s.length;n&&l&&(i+=1,r=s[i]),i+=1;while(i<l)r=e(r,s[i],i,s),i+=1;return r}function I(t,e){let o=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let r=-1;while(o<i){const t=n[o];e(t,o,n)&&(r+=1,s[r]=t),o+=1}return s}function A(t,e){let o=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let r=-1;while(o<i){const t=n[o];r+=1,s[r]=e(t,o,n),o+=1}return s}function k(t,e){let o=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;while(o<i){if(!1===e(n[o],o,n))break;o+=1}return t}function O(t){return x(t,((t,e)=>t+e),0)}function P(t){return x(t,((t,e)=>t>e?t:e),Array.isArray(t)?t[0]:void 0)}function N(t){return x(t,((t,e)=>t<e?t:e),Array.isArray(t)?t[0]:void 0)}function _(t){return t.length?O(t)/t.length:0}function D(t){return x(t,((t,e)=>t.concat(Array.isArray(e)?D(e):e)),[])}function L(t){const e=[];return k(t,(t=>{-1===e.indexOf(t)&&e.push(t)})),e}function V(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...i]=[...e];let s=n;return k(i,(t=>{s=s.filter((e=>!t.includes(e)))})),s}function B(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...i]=[...e];let s=n;return k(i,(t=>{s=s.filter((e=>t.includes(e)))})),s}function F(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...i]=[...e],s=new Set(n);return k(i,(t=>{k(t,(t=>{s.has(t)||s.add(t)}))})),Array.from(s)}function W(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}function j(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];const i=x(t,((t,e,n)=>{const i=e.replace(/\r?\n\s*/g,""),s=o[n]?o[n]:"";return t+i+s}),"");return i.trim()}function z(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function U(t){return"undefined"!==typeof t}function $(t){return"undefined"===typeof t}function G(t){return null===t||""===t||$(t)}function Y(t){return"[object RegExp]"===Object.prototype.toString.call(t)}const K="length",X=t=>parseInt(t,16),q=t=>parseInt(t,10),Q=(t,e,o)=>t["substr"](e,o),J=t=>t["codePointAt"](0)-65,Z=t=>`${t}`.replace(/\-/g,""),tt=t=>X(Q(Z(t),X("12"),J("F")))/(X(Q(Z(t),J("B"),~~![][K]))||9),et=()=>"undefined"!==typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let ot=!1;const nt={invalid:()=>j`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:o}=t;return j`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${o}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>j`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},it={invalid:()=>j`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:o}=t;return j`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${o}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>j`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function st(t,e){const o=!G(t),n="string"===typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),i="13.1.0";let s,r="invalid",l="invalid";t=Z(t||"");const a=rt(t);if(o||n||a)if(a){const e=E("31/08/2023","DD/MM/YYYY"),o=Math.floor(e.toDate().getTime()/864e5),n=tt(t);s=E(864e5*(n+1),"x").format("MMMM DD, YYYY"),o>n?(r="expired",l="expired"):(r="valid",l="valid")}else n?(r="non_commercial",l="valid"):(r="invalid",l="invalid");else r="missing",l="missing";if(et()&&(r="valid",l="valid"),!ot&&"valid"!==r){const t=nt[r]({keyValidityDate:s,hotVersion:i});t&&console["non_commercial"===r?"info":"warn"](nt[r]({keyValidityDate:s,hotVersion:i})),ot=!0}if("valid"!==l&&e.parentNode){const t=it[l]({keyValidityDate:s,hotVersion:i});if(t){const t=document.createElement("div");t.className="hot-display-license-info",t.innerHTML=it[l]({keyValidityDate:s,hotVersion:i}),e.parentNode.insertBefore(t,e.nextSibling)}}}function rt(t){let e=[][K],o=e;if(t[K]!==J("Z"))return!1;for(let n="",i="B<H4P+".split(""),s=J(i.shift());s;s=J(i.shift()||"A"))--s<""[K]?o|=(q(`${q(X(n)+(X(Q(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=Q(t,s,s?1===i[K]?9:8:6);return o===e}function lt(t){return t[0].toUpperCase()+t.substr(1)}function at(){const t=[];for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];let i=o.length;while(i){i-=1;const e=z(o[i]).toLowerCase();-1===t.indexOf(e)&&t.push(e)}return 1===t.length}function ht(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function ct(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function dt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,((t,o)=>"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[o]?"":e[o]))}function ut(t){return gt(`${t}`,{ALLOWED_TAGS:[]})}function gt(t,e){return R.sanitize(t,e)}const ft=t=>["tabindex",t],mt=()=>["role","treegrid"],pt=()=>["role","presentation"],wt=()=>["role","gridcell"],Ct=()=>["role","rowheader"],vt=()=>["role","columnheader"],yt=()=>["role","row"],St=()=>["role","menu"],bt=()=>["role","menuitem"],Rt=()=>["role","combobox"],Et=()=>["role","listbox"],Mt=()=>["role","option"],Tt=()=>["role","checkbox"],Ht=()=>["scope","col"],xt=()=>["scope","row"],It=()=>["type","text"],At=t=>["aria-label",t],kt=()=>["aria-hidden","true"],Ot=()=>["aria-disabled","true"],Pt=()=>["aria-multiselectable","true"],Nt=t=>["aria-haspopup",t],_t=t=>["aria-rowcount",t],Dt=t=>["aria-colcount",t],Lt=t=>["aria-rowindex",t],Vt=t=>["aria-colindex",t],Bt=t=>["aria-expanded",t],Ft=t=>["aria-sort",t],Wt=()=>["aria-readonly","true"],jt=()=>["aria-invalid","true"],zt=t=>["aria-checked",t],Ut=()=>["aria-selected","true"],$t=()=>["aria-autocomplete","list"],Gt=t=>["aria-controls",t],Yt=t=>["aria-activedescendant",t],Kt=t=>["aria-live",t],Xt=t=>["aria-relevant",t],qt=t=>["aria-setsize",t],Qt=t=>["aria-posinset",t];function Jt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=-1,n=null,i=t;while(null!==i){if(o===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(o+=1,i=i.parentNode)}return n}function Zt(t,e){const o=t.closest(".handsontable");return!!o&&(o.parentNode===e||o===e)}function te(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function ee(t){return te(t)&&t.parent}function oe(t){return!!Object.getPrototypeOf(t.parent)}function ne(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=t;while(null!==s&&void 0!==s&&s!==o){const{nodeType:t,nodeName:o}=s;if(t===n&&(e.includes(o)||e.includes(s)))return s;const{host:r}=s;s=r&&t===i?r:s.parentNode}return null}function ie(t,e,o){const n=[];let i=t;while(i){if(i=ne(i,e,o),!i||o&&!o.contains(i))break;n.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode}const s=n.length;return s?n[s-1]:null}function se(t,e){let o=t.parentNode,n=[];"string"===typeof e?n=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);while(null!==o){if(n.indexOf(o)>-1)return!0;o=o.parentNode}return!1}function re(t){let e=0,o=t;if(o.previousSibling)while(o=o.previousSibling)e+=1;return e}function le(t,e,o){const n=o.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function ae(t){return t&&t.length?t.filter((t=>!!t)):[]}function he(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const o=[],n=[];return n.push(...t.filter((t=>{const n=t instanceof RegExp;return n&&e&&o.push(t),!n}))),e?{regexFree:n,regexes:o}:n}function ce(t,e){return void 0!==t.classList&&"string"===typeof e&&""!==e&&t.classList.contains(e)}function de(t,e){"string"===typeof e&&(e=e.split(" ")),e=ae(e),e.length>0&&t.classList.add(...e)}function ue(t,e){"string"===typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:o,regexes:n}=he(e,!0);o=ae(o),o.length>0&&t.classList.remove(...o),n.forEach((e=>{t.classList.forEach((o=>{e.test(o)&&t.classList.remove(o)}))}))}function ge(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,o]]),e.forEach((e=>{Array.isArray(e)&&""!==e[0]&&t.setAttribute(...e)}))}function fe(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"===typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:o,regexes:n}=he(e,!0);o.forEach((e=>{""!==e&&t.removeAttribute(e)})),n.forEach((e=>{t.getAttributeNames().forEach((o=>{e.test(o)&&t.removeAttribute(o)}))}))}function me(t){if(3===t.nodeType)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let t=e.length-1;t>=0;t--)me(e[t])}}function pe(t){let e;while(e=t.lastChild)t.removeChild(e)}const we=/(<(.*)>|&(.*);)/;function Ce(t,e){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];we.test(e)?t.innerHTML=o?gt(e):e:ve(t,e)}function ve(t,e){const o=t.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.textContent=e:(pe(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function ye(t){const e=t.ownerDocument.documentElement;let o=t;while(o!==e){if(null===o)return!1;if(o.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(o.host){if(o.host.impl)return ye(o.host.impl);if(o.host)return ye(o.host);throw new Error("Lost in Web Components world")}return!1}if("none"===Ae(o).display)return!1;o=o.parentNode}return!0}function Se(t){const e=t.ownerDocument,o=e.defaultView,n=e.documentElement;let i,s,r,l=t;i=l.offsetLeft,s=l.offsetTop,r=l;while(l=l.offsetParent){if(l===e.body)break;if(!("offsetLeft"in l))break;i+=l.offsetLeft,s+=l.offsetTop,r=l}return r&&"fixed"===r.style.position&&(i+=o.pageXOffset||n.scrollLeft,s+=o.pageYOffset||n.scrollTop),{left:i,top:s}}function be(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollY}function Re(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollX}function Ee(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?be(e):t.scrollTop}function Me(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?Re(e):t.scrollLeft}function Te(t){let e=t.ownerDocument,o=e?e.defaultView:void 0;e||(e=t.document?t.document:t,o=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;while(i&&i.style&&e.body!==i){let{overflow:t,overflowX:e,overflowY:s}=i.style;if([t,e,s].includes("scroll"))return i;if(({overflow:t,overflowX:e,overflowY:s}=o.getComputedStyle(i)),n.includes(t)||n.includes(e)||n.includes(s))return i;if(i.clientHeight<=i.scrollHeight+1&&(n.includes(s)||n.includes(t)))return i;if(i.clientWidth<=i.scrollWidth+1&&(n.includes(e)||n.includes(t)))return i;i=i.parentNode}return o}function He(t){const e=t.ownerDocument,o=e.defaultView;let n=t.parentNode;while(n&&n.style&&e.body!==n){if("visible"!==n.style.overflow&&""!==n.style.overflow)return n;const t=Ae(n,o),e=["scroll","hidden","auto"],i=t.getPropertyValue("overflow"),s=t.getPropertyValue("overflow-y"),r=t.getPropertyValue("overflow-x");if(e.includes(i)||e.includes(s)||e.includes(r))return n;n=n.parentNode}return o}function xe(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!t)return;if(t===o)return"width"===e?`${o.innerWidth}px`:"height"===e?`${o.innerHeight}px`:void 0;const n=t.style[e];if(""!==n&&void 0!==n)return n;const i=Ae(t,o);return""!==i[e]&&void 0!==i[e]?i[e]:void 0}function Ie(t,e){const{selectorText:o}=e;let n=!1;return e.type===CSSRule.STYLE_RULE&&o&&(t.msMatchesSelector?n=t.msMatchesSelector(o):t.matches&&(n=t.matches(o))),n}function Ae(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function ke(t){return t.offsetWidth}function Oe(t){return t.offsetHeight}function Pe(t){return t.clientHeight||t.innerHeight}function Ne(t){return t.clientWidth||t.innerWidth}function _e(t,e,o){t.addEventListener(e,o,!1)}function De(t,e,o){t.removeEventListener(e,o,!1)}function Le(t){return t.selectionStart?t.selectionStart:0}function Ve(t){return t.selectionEnd?t.selectionEnd:0}function Be(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;const e=t.document;let o="";return t.getSelection?o=t.getSelection().toString():e.selection&&"Control"!==e.selection.type&&(o=e.selection.createRange().text),o}function Fe(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function We(t,e,o){if(void 0===o&&(o=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,o)}catch(n){const i=t.parentNode,s=i.style.display;i.style.display="block",t.setSelectionRange(e,o),i.style.display=s}}}let je;function ze(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const o=t.createElement("div");o.style.boxSizing="content-box",o.style.height="150px",o.style.left="0px",o.style.overflow="hidden",o.style.position="absolute",o.style.top="0px",o.style.width="200px",o.style.visibility="hidden",o.appendChild(e),(t.body||t.documentElement).appendChild(o);const n=e.offsetWidth;o.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=o.clientWidth),(t.body||t.documentElement).removeChild(o),n-i}function Ue(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===je&&(je=ze(t)),je}function $e(t){return t.offsetWidth!==t.clientWidth}function Ge(t){return t.offsetHeight!==t.clientHeight}function Ye(t,e,o){t.style.transform=`translate3d(${e},${o},0)`}function Ke(t){let e;return t.style.transform&&""!==(e=t.style.transform)?["transform",e]:-1}function Xe(t){t.style.transform&&""!==t.style.transform&&(t.style.transform="")}function qe(t){const e=["INPUT","SELECT","TEXTAREA"];return t&&(e.indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function Qe(t){return qe(t)&&!1===t.hasAttribute("data-hot-input")}function Je(t){const e=t.ownerDocument.activeElement;Qe(e)||t.select()}function Ze(t){return!t.parentNode}function to(t,e){const o=new IntersectionObserver(((o,n)=>{o.forEach((o=>{o.isIntersecting&&null!==t.offsetParent&&(e(),n.unobserve(t))}))}),{root:t.ownerDocument.body});o.observe(t)}function eo(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=t.ownerDocument,i=n.createRange(),s=n.defaultView.getSelection();ge(t,"contenteditable",!0),o&&ge(t,...kt()),e&&de(t,"invisibleSelection"),i.selectNodeContents(t),s.removeAllRanges(),s.addRange(i)}function oo(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const o=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),o.removeAllRanges(),e&&ue(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function no(t,e){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];eo(t,o),e(),oo(t,o)}function io(t){return"function"===typeof t}function so(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=0;const n={lastCallThrottled:!0};let i=null;function s(){for(var s=arguments.length,r=new Array(s),l=0;l<s;l++)r[l]=arguments[l];const a=Date.now();let h=!1;n.lastCallThrottled=!0,o||(o=a,h=!0);const c=e-(a-o);return h?(n.lastCallThrottled=!1,t.apply(this,r)):(i&&clearTimeout(i),i=setTimeout((()=>{n.lastCallThrottled=!1,t.apply(this,r),o=0,i=void 0}),c)),n}return s}function ro(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;const n=so(t,e);let i=o;function s(){i=o}function r(){for(var e=arguments.length,o=new Array(e),s=0;s<e;s++)o[s]=arguments[s];return i?(i-=1,t.apply(this,o)):n.apply(this,o)}return r.clearHits=s,r}function lo(t){let e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=null;function i(){for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return n&&clearTimeout(n),n=setTimeout((()=>{e=t.apply(this,s)}),o),e}return i}function ao(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...i]=e;return function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return x(i,((t,e)=>e(t)),n.apply(this,e))}}function ho(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.apply(this,o.concat(n))}}function co(t){const e=t.length;function o(n){return function(){for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];const l=n.concat(s);let a;return a=l.length>=e?t.apply(this,l):o(l),a}}return o([])}function uo(t){const e=t.length;function o(n){return function(){for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];const l=n.concat(s.reverse());let a;return a=l.length>=e?t.apply(this,l):o(l),a}}return o([])}function go(t,e,o,n,i,s,r,l){return U(l)?t.call(e,o,n,i,s,r,l):U(r)?t.call(e,o,n,i,s,r):U(s)?t.call(e,o,n,i,s):U(i)?t.call(e,o,n,i):U(n)?t.call(e,o,n):U(o)?t.call(e,o):t.call(e)}o(7751);function fo(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Eo(t,((t,o)=>{"__children"!==o&&(t&&"object"===typeof t&&!Array.isArray(t)?e[o]=fo(t):Array.isArray(t)?t.length&&"object"===typeof t[0]&&!Array.isArray(t[0])?e[o]=[fo(t[0])]:e[o]=[]:e[o]=null)}))),e}function mo(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function po(t,e,o){const n=Array.isArray(o);return Eo(e,((e,i)=>{(!1===n||o.includes(i))&&(t[i]=e)})),t}function wo(t,e){Eo(e,((o,n)=>{e[n]&&"object"===typeof e[n]?(t[n]||(Array.isArray(e[n])?t[n]=[]:"[object Date]"===Object.prototype.toString.call(e[n])?t[n]=e[n]:t[n]={}),wo(t[n],e[n])):t[n]=e[n]}))}function Co(t){return"object"===typeof t?JSON.parse(JSON.stringify(t)):t}function vo(t){const e={};return Eo(t,((t,o)=>{e[o]=t})),e}function yo(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];return k(o,(e=>{t.MIXINS.push(e.MIXIN_NAME),Eo(e,((e,o)=>{if(void 0!==t.prototype[o])throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if("function"===typeof e)t.prototype[o]=e;else{const n=function(t,e){const o=`_${t}`,n=t=>{let e=t;return(Array.isArray(e)||bo(e))&&(e=Co(e)),e};return function(){return void 0===this[o]&&(this[o]=n(e)),this[o]}},i=function(t){const e=`_${t}`;return function(t){this[e]=t}};Object.defineProperty(t.prototype,o,{get:n(o,e),set:i(o),configurable:!0})}}))})),t}function So(t,e){return JSON.stringify(t)===JSON.stringify(e)}function bo(t){return"[object Object]"===Object.prototype.toString.call(t)}function Ro(t,e,o,n){n.value=o,n.writable=!1!==n.writable,n.enumerable=!1!==n.enumerable,n.configurable=!1!==n.configurable,Object.defineProperty(t,e,n)}function Eo(t,e){for(const o in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,o))&&!1===e(t[o],o,t))break;return t}function Mo(t,e){const o=e.split(".");let n=t;return Eo(o,(t=>{if(n=n[t],void 0===n)return n=void 0,!1})),n}function To(t,e,o){const n=e.split(".");let i=t;n.forEach(((t,e)=>{e!==n.length-1?(Io(i,t)||(i[t]={}),i=i[t]):i[t]=o}))}function Ho(t){if(!bo(t))return 0;const e=function(t){let o=0;return bo(t)?Eo(t,((t,n)=>{"__children"!==n&&(o+=e(t))})):o+=1,o};return e(t)}function xo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const o=`_${e}`,n={_touched:!1,[o]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[o]},set(t){this._touched=!0,this[o]=t},enumerable:!0,configurable:!0}),n}function Io(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const Ao=t=>{const e={value:!1,test:(o,n)=>{e.value=t(o,n)}};return e},ko={chrome:Ao(((t,e)=>/Chrome/.test(t)&&/Google/.test(e))),chromeWebKit:Ao((t=>/CriOS/.test(t))),edge:Ao((t=>/Edge/.test(t))),edgeWebKit:Ao((t=>/EdgiOS/.test(t))),firefox:Ao((t=>/Firefox/.test(t))),firefoxWebKit:Ao((t=>/FxiOS/.test(t))),mobile:Ao((t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t))),safari:Ao(((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e)))},Oo={mac:Ao((t=>/^Mac/.test(t))),win:Ao((t=>/^Win/.test(t))),linux:Ao((t=>/^Linux/.test(t))),ios:Ao((t=>/iPhone|iPad|iPod/i.test(t)))};function Po(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Eo(ko,(o=>{let{test:n}=o;n(t,e)}))}function No(){let{platform:t=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Eo(Oo,(e=>{let{test:o}=e;o(t)}))}function _o(){return ko.chrome.value}function Do(){return ko.chromeWebKit.value}function Lo(){return ko.firefox.value}function Vo(){return ko.firefoxWebKit.value}function Bo(){return ko.safari.value}function Fo(){return ko.edge.value}function Wo(){return ko.edgeWebKit.value}function jo(){return ko.mobile.value}function zo(){return Oo.ios.value}function Uo(){let{maxTouchPoints:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return t>2&&Oo.mac.value}function $o(){return Oo.win.value}function Go(){return Oo.mac.value}function Yo(){return Oo.linux.value}Po(),No();const Ko={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Lo()?182:174,AUDIO_MUTE:Lo()?181:173,AUDIO_UP:Lo()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Xo=[Ko.ALT,Ko.ARROW_DOWN,Ko.ARROW_LEFT,Ko.ARROW_RIGHT,Ko.ARROW_UP,Ko.AUDIO_DOWN,Ko.AUDIO_MUTE,Ko.AUDIO_UP,Ko.BACKSPACE,Ko.CAPS_LOCK,Ko.DELETE,Ko.END,Ko.ENTER,Ko.ESCAPE,Ko.F1,Ko.F2,Ko.F3,Ko.F4,Ko.F5,Ko.F6,Ko.F7,Ko.F8,Ko.F9,Ko.F10,Ko.F11,Ko.F12,Ko.F13,Ko.F14,Ko.F15,Ko.F16,Ko.F17,Ko.F18,Ko.F19,Ko.HOME,Ko.INSERT,Ko.MEDIA_NEXT,Ko.MEDIA_PLAY_PAUSE,Ko.MEDIA_PREV,Ko.MEDIA_STOP,Ko.NULL,Ko.NUM_LOCK,Ko.PAGE_DOWN,Ko.PAGE_UP,Ko.PAUSE,Ko.SCROLL_LOCK,Ko.SHIFT,Ko.TAB];function qo(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function Qo(t){return Xo.includes(t)}function Jo(t){const e=[];return Go()?e.push(Ko.COMMAND_LEFT,Ko.COMMAND_RIGHT,Ko.COMMAND_FIREFOX):e.push(Ko.CONTROL),e.includes(t)}function Zo(t){return[Ko.CONTROL,Ko.COMMAND_LEFT,Ko.COMMAND_RIGHT,Ko.COMMAND_FIREFOX].includes(t)}function tn(t,e){const o=e.split("|");let n=!1;return k(o,(e=>{if(t===Ko[e])return n=!0,!1})),n}function en(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function on(t){return!1===t.isImmediatePropagationEnabled}function nn(t){return 2===t.button}function sn(t){return 0===t.button}function rn(t,e){const o={x:t.offsetX,y:t.offsetY};let n=t.target;if(!(e instanceof HTMLElement)||n!==e&&n.contains(e))return o;while(n!==e)o.x+=n.offsetLeft,o.y+=n.offsetTop,n=n.offsetParent;return o}function ln(){U(console)&&console.warn(...arguments)}function an(){U(console)&&console.error(...arguments)}const hn=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],cn=j`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,dn=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),un=new Map([["beforeRemoveCellClassNames",'The hook "beforeRemoveCellClassNames" is deprecated and will be removed in the next major release.']]);class gn{static getSingleton(){return mn()}constructor(){this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const t=Object.create(null);return k(hn,(e=>t[e]=[])),t}getBucket(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}add(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))k(e,(e=>this.add(t,e,o)));else{dn.has(t)&&ln(dt(cn,{hookName:t,removedInVersion:dn.get(t)})),un.has(t)&&ln(un.get(t));const n=this.getBucket(o);if("undefined"===typeof n[t]&&(this.register(t),n[t]=[]),e.skip=!1,-1===n[t].indexOf(e)){let o=!1;e.initialHook&&k(n[t],((i,s)=>{if(i.initialHook)return n[t][s]=e,o=!0,!1})),o||n[t].push(e)}}return this}once(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?k(e,(e=>this.once(t,e,o))):(e.runOnce=!0,this.add(t,e,o))}remove(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n=this.getBucket(o);return"undefined"!==typeof n[t]&&n[t].indexOf(e)>=0&&(e.skip=!0,!0)}has(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const o=this.getBucket(e);return!(void 0===o[t]||!o[t].length)}run(t,e,o,n,i,s,r,l){{const a=this.globalBucket[e],h=a?a.length:0;let c=0;if(h)while(c<h){if(!a[c]||a[c].skip){c+=1;continue}const h=go(a[c],t,o,n,i,s,r,l);void 0!==h&&(o=h),a[c]&&a[c].runOnce&&this.remove(e,a[c]),c+=1}}{const a=this.getBucket(t)[e],h=a?a.length:0;let c=0;if(h)while(c<h){if(!a[c]||a[c].skip){c+=1;continue}const h=go(a[c],t,o,n,i,s,r,l);void 0!==h&&(o=h),a[c]&&a[c].runOnce&&this.remove(e,a[c],t),c+=1}}return o}destroy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Eo(this.getBucket(t),((t,e,o)=>o[e].length=0))}register(t){this.isRegistered(t)||hn.push(t)}deregister(t){this.isRegistered(t)&&hn.splice(hn.indexOf(t),1)}isDeprecated(t){return un.has(t)||dn.has(t)}isRegistered(t){return hn.indexOf(t)>=0}getRegistered(){return hn}}const fn=new gn;function mn(){return fn}var pn=gn;const wn=new Map;function Cn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";wn.has(t)||wn.set(t,new Map);const e=wn.get(t);function o(t,o){e.set(t,o)}function n(t){return e.get(t)}function i(t){return e.has(t)}function s(){return[...e.keys()]}function r(){return[...e.values()]}return{register:o,getItem:n,hasItem:i,getNames:s,getValues:r}}const vn=new WeakMap,{register:yn,getItem:Sn,hasItem:bn,getNames:Rn,getValues:En}=Cn("editors");function Mn(t){const e={},o=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new o(t)),e[t.guid]},pn.getSingleton().add("afterDestroy",(function(){e[this.guid]=null}))}function Tn(t,e){let o;if("function"===typeof t)vn.get(t)||xn(null,t),o=vn.get(t);else{if("string"!==typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');o=Sn(t)}if(!o)throw Error(`No editor registered under name "${t}"`);return o.getInstance(e)}function Hn(t){if("function"===typeof t)return t;if(!bn(t))throw Error(`No registered editor found under "${t}" name`);return Sn(t).getConstructor()}function xn(t,e){t&&"string"!==typeof t&&(e=t,t=e.EDITOR_TYPE);const o=new Mn(e);"string"===typeof t&&yn(t,o),vn.set(e,o)}let In=0;class An{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(t){o.call(this,kn(t))}return this.context.eventListeners.push({element:t,event:e,callback:o,callbackProxy:i,options:n,eventManager:this}),t.addEventListener(e,i,n),In+=1,()=>{this.removeEventListener(t,e,o)}}removeEventListener(t,e,o){let n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=this.context.eventListeners.length;while(s)if(s-=1,n=this.context.eventListeners[s],n.event===e&&n.element===t){if(o&&o!==n.callback)continue;if(i&&n.eventManager!==this)continue;this.context.eventListeners.splice(s,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),In-=1}}clearEvents(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let e=this.context.eventListeners.length;while(e){e-=1;const o=this.context.eventListeners[e];t&&o.eventManager!==this||(this.context.eventListeners.splice(e,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),In-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(t,e){let o=t.document,n=t;o||(o=t.ownerDocument?t.ownerDocument:t,n=o.defaultView);const i={bubbles:!0,cancelable:"mousemove"!==e,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;o.createEvent?(s=o.createEvent("MouseEvents"),s.initMouseEvent(e,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||o.body.parentNode)):s=o.createEventObject(),t.dispatchEvent?t.dispatchEvent(s):t.fireEvent(`on${e}`,s)}}function kn(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),en(this)},t}var On=An;function Pn(){return In}const Nn="editorManager.navigation";class _n{constructor(t,e,o){this.instance=t,this.tableMeta=e,this.selection=o,this.eventManager=new On(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.addHook("afterDocumentKeyDown",(t=>this.onAfterDocumentKeyDown(t))),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(t=>{!this.destroyed&&this.instance.isListening()&&this.openEditor("",t)})),this.instance.view._wt.update("onCellDblClick",((t,e,o)=>this.onCellDblClick(t,e,o)))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(t){this.lock||this.closeEditor(t)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,(t=>{t&&this.prepareEditor()}));const{highlight:t}=this.instance.getSelectedRangeLast();if(t.isHeader())return;const{row:e,col:o}=t,n=this.instance.runHooks("modifyGetCellCoords",e,o);let i=e,s=o;if(Array.isArray(n)&&([i,s]=n),this.cellProperties=this.instance.getCellMeta(i,s),!this.isCellEditable())return void this.clearActiveEditor();const r=this.instance.getCell(e,o,!0);if(r){const t=this.instance.getCellEditor(this.cellProperties),n=this.instance.colToProp(s),l=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(i),s);this.activeEditor=Tn(t,this.instance),this.activeEditor.prepare(e,o,n,r,l,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.isCellEditable()?(this.activeEditor||(this.instance.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))):this.clearActiveEditor()}closeEditor(t,e,o){this.activeEditor?this.activeEditor.finishEditing(t,e,o):o&&o(!1)}closeEditorAndSaveChanges(t){this.closeEditor(!1,t)}closeEditorAndRestoreOriginalValue(t){this.closeEditor(!0,t)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const t=this.instance.getSelectedRangeLast();if(!t)return!1;const e=this.instance.getCellEditor(this.cellProperties),{row:o,col:n}=t.highlight,{rowIndexMapper:i,columnIndexMapper:s}=this.instance,r=i.isHidden(this.instance.toPhysicalRow(o))||s.isHidden(this.instance.toPhysicalColumn(n));return!(this.cellProperties.readOnly||!e||r)}moveSelectionAfterEnter(t){const e="function"===typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;t?this.selection.transformStart(-e.row,-e.col):this.selection.transformStart(e.row,e.col,!0)}onAfterDocumentKeyDown(t){const e=this.instance.getSelectedRangeLast();if(!this.instance.isListening()||!e||e.highlight.isHeader()||on(t))return;const{keyCode:o}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Qo(o)&&!Zo(o)&&!n&&!this.isEditorOpened()){const e=this.instance.getShortcutManager(),o=e.getContext("editor"),n={runOnlyIf:()=>U(this.instance.getSelected()),group:Nn};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.instance.selection.transformStart(0,-1*this.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.instance.selection.transformStart(0,this.instance.getDirectionFactor())}}],n),this.openEditor("",t)}}onCellDblClick(t,e,o){"TD"===o.nodeName&&this.openEditor(null,t,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}const Dn=new WeakMap;_n.getInstance=function(t,e,o){let n=Dn.get(t);return n||(n=new _n(t,e,o),Dn.set(t,n)),n};var Ln=_n;function Vn(t,e){Fn(t,e),e.add(t)}function Bn(t,e,o){Fn(t,e),e.set(t,o)}function Fn(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wn(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function jn(t,e){var o=$n(t,e,"get");return zn(t,o)}function zn(t,e){return e.get?e.get.call(t):e.value}function Un(t,e,o){var n=$n(t,e,"set");return Gn(t,n,o),o}function $n(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Gn(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}const Yn=Object.freeze({CELL:"cell",MIXED:"mixed"});var Kn=new WeakMap,Xn=new WeakMap,qn=new WeakMap,Qn=new WeakMap,Jn=new WeakSet,Zn=new WeakSet,ti=new WeakSet,ei=new WeakSet;class oi{constructor(t){var e=this;Vn(this,ei),Vn(this,ti),Vn(this,Zn),Vn(this,Jn),Bn(this,Kn,{writable:!0,value:void 0}),Bn(this,Xn,{writable:!0,value:void 0}),Bn(this,qn,{writable:!0,value:50}),Bn(this,Qn,{writable:!0,value:null});const o=t.getSettings();Un(this,Kn,t),Un(this,Xn,o.imeFastEdit?Yn.MIXED:Yn.CELL),jn(this,Kn).addHook("afterUpdateSettings",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return Wn(e,ei,ri).call(e,...o)})),jn(this,Kn).addHook("afterSelection",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return Wn(e,ti,si).call(e,...o)}))}getFocusMode(){return jn(this,Xn)}setFocusMode(t){Object.values(Yn).includes(t)?Un(this,Xn,t):ln(`"${t}" is not a valid focus mode.`)}getRefocusDelay(){return jn(this,qn)}setRefocusDelay(t){Un(this,qn,t)}setRefocusElementGetter(t){Un(this,Qn,t)}getRefocusElement(){return"function"===typeof jn(this,Qn)?jn(this,Qn).call(this):null===(t=jn(this,Kn).getActiveEditor())||void 0===t?void 0:t.TEXTAREA;var t}focusOnHighlightedCell(t){var e;const o=Wn(this,Jn,ni).call(this),n=t||Wn(this,Zn,ii).call(this);let i=jn(this,Kn).runHooks("modifyFocusedElement",o.row,o.col,n);i instanceof HTMLElement||(i=n),!i||null!==(e=jn(this,Kn).getActiveEditor())&&void 0!==e&&e.isOpened()||i.focus({preventScroll:!0})}refocusToEditorTextarea(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jn(this,qn);const e=this.getRefocusElement();jn(this,Kn).getSettings().imeFastEdit&&e&&jn(this,Kn)._registerTimeout((()=>{e.select()}),t)}}function ni(){const t=jn(this,Kn).getSelectedRangeLast();return t.highlight}function ii(){const t=Wn(this,Jn,ni).call(this);return jn(this,Kn).getCell(t.row,t.col,!0)}function si(){const t=Wn(this,Zn,ii).call(this),{activeElement:e}=jn(this,Kn).rootDocument;e&&Qe(e)&&e.blur(),this.focusOnHighlightedCell(t),this.getFocusMode()===Yn.MIXED&&"TD"===t.nodeName&&jn(this,Kn).addHookOnce("afterSelectionEnd",(()=>{this.refocusToEditorTextarea()}))}function ri(t){t.imeFastEdit&&this.getFocusMode()!==Yn.MIXED?this.setFocusMode(Yn.MIXED):t.imeFastEdit||this.getFocusMode()===Yn.CELL||this.setFocusMode(Yn.CELL)}const li={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},ai=new RegExp(Object.keys(li).map((t=>`(${t})`)).join("|"),"gi");function hi(t){return"TABLE"===(t&&t.nodeName||"")}function ci(t){const e=t.hasColHeaders(),o=t.hasRowHeaders(),n=[e?-1:0,o?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),s=i.length,r=s>0?i[0].length:0,l=["<table>","</table>"],a=e?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],c=o?1:0,d=e?1:0;for(let u=0;u<s;u+=1){const n=e&&0===u,s=[];for(let e=0;e<r;e+=1){const r=!n&&o&&0===e;let l="";if(n)l=`<th>${t.getColHeader(e-c)}</th>`;else if(r)l=`<th>${t.getRowHeader(u-d)}</th>`;else{const o=i[u][e],{hidden:n,rowspan:s,colspan:r}=t.getCellMeta(u-d,e-c);if(!n){const t=[];if(s&&t.push(`rowspan="${s}"`),r&&t.push(`colspan="${r}"`),G(o))l=`<td ${t.join(" ")}></td>`;else{const e=o.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");l=`<td ${t.join(" ")}>${e}</td>`}}}s.push(l)}const l=["<tr>",...s,"</tr>"].join("");n?a.splice(1,0,l):h.splice(-1,0,l)}return l.splice(1,0,a.join(""),h.join("")),l.join("")}function di(t){const e=t.length,o=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],s=i.length,r=[];0===n&&o.push("<tbody>");for(let t=0;t<s;t+=1){const e=i[t],o=G(e)?"":e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,(t=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(t.length-1)} </span>`)).replace(/\t/gi,"&#9;");r.push(`<td>${o}</td>`)}o.push("<tr>",...r,"</tr>"),n+1===e&&o.push("</tbody>")}return o.push("</table>"),o.join("")}function ui(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const o={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let s=t;if("string"===typeof s){const t=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(t=>{const e=t.match(/<td\b[^>]*?>/g)[0],o=t.substring(e.length,t.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),n="</td>";return`${e}${o}${n}`}));i.insertAdjacentHTML("afterbegin",`${t}`),s=i.querySelector("table")}if(!s||!hi(s))return;const r=i.querySelector('meta[name$="enerator"]'),l=null!==s.querySelector("tbody th"),a=s.querySelector("tr"),h=a?Array.from(a.cells).reduce(((t,e)=>t+e.colSpan),0)-(l?1:0):0,c=s.tFoot&&Array.from(s.tFoot.rows)||[],d=[];let u=!1,g=0,f=0;if(s.tHead){const t=Array.from(s.tHead.rows).filter((t=>{const e=null!==t.querySelector("td");return e&&d.push(t),!e}));g=t.length,u=g>0,g>1?o.nestedHeaders=Array.from(t).reduce(((t,e)=>{const o=Array.from(e.cells).reduce(((t,e,o)=>{if(l&&0===o)return t;const{colSpan:n,innerHTML:i}=e,s=n>1?{label:i,colspan:n}:i;return t.push(s),t}),[]);return t.push(o),t}),[]):u&&(o.colHeaders=Array.from(t[0].children).reduce(((t,e,o)=>(l&&0===o||t.push(e.innerHTML),t)),[]))}d.length&&(o.fixedRowsTop=d.length),c.length&&(o.fixedRowsBottom=c.length);const m=[...d,...Array.from(s.tBodies).reduce(((t,e)=>(t.push(...Array.from(e.rows)),t)),[]),...c];f=m.length;const p=new Array(f);for(let v=0;v<f;v++)p[v]=new Array(h);const w=[],C=[];for(let v=0;v<f;v++){const t=m[v],e=Array.from(t.cells),o=e.length;for(let n=0;n<o;n++){const t=e[n],{nodeName:o,innerHTML:i,rowSpan:s,colSpan:l}=t,a=p[v].findIndex((t=>void 0===t));if("TD"===o){if(s>1||l>1){for(let t=v;t<v+s;t++)if(t<f)for(let e=a;e<a+l;e++)p[t][e]=null;const e=t.getAttribute("style"),o=e&&e.includes("mso-ignore:colspan");o||w.push({col:a,row:v,rowspan:s,colspan:l})}let e="";e=r&&/excel/gi.test(r.content)?i.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):i.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),p[v][a]=e.replace(ai,(t=>li[t]))}else C.push(i)}}return w.length&&(o.mergeCells=w),C.length&&(o.rowHeaders=C),p.length&&(o.data=p),o}function gi(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=typeof t;if("number"===o)return!isNaN(t)&&isFinite(t);if("string"===o){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);const o=Array.from(new Set([".",...e])).map((t=>`\\${t}`)).join("|");return new RegExp(`^[+-]?\\s*(((${o})?\\d+((${o})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}return"object"===o&&(!!t&&"number"===typeof t.valueOf()&&!(t instanceof Date))}function fi(t){return gi(t,[","])}function mi(t,e,o){let n=-1;"function"===typeof e?(o=e,e=t):n=t-1;while(++n<=e)if(!1===o(n))break}function pi(t,e,o){let n=t+1;"function"===typeof e&&(o=e,e=0);while(--n>=e)if(!1===o(n))break}function wi(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ci(t,e,o){return Math.min(t,e)===t?e:Math.max(t,o)===t?o:t}const vi="asc",yi="desc",Si=new Map([[vi,[-1,1]],[yi,[1,-1]]]),bi=t=>`The priority '${t}' is already declared in a map.`,Ri=t=>`The priority '${t}' is not a number.`;function Ei(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=new Map;function n(n,i){if(!gi(n))throw new Error(e(n));if(o.has(n))throw new Error(t(n));o.set(n,i)}function i(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vi;const[e,n]=Si.get(t)||Si.get(vi);return[...o].sort(((t,o)=>t[0]<o[0]?e:n)).map((t=>t[1]))}return t=io(t)?t:bi,e=io(e)?e:Ri,{addItem:n,getItems:i}}const Mi=t=>`The id '${t}' is already declared in a map.`;function Ti(){let{errorIdExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Map;function o(o,n){if(a(o))throw new Error(t(o));e.set(o,n)}function n(t){return e.delete(t)}function i(){e.clear()}function s(t){const[e]=l().find((e=>{let[o,n]=e;return t===n&&o}))||[null];return e}function r(t){return e.get(t)}function l(){return[...e]}function a(t){return e.has(t)}return t=io(t)?t:Mi,{addItem:o,clear:i,getId:s,getItem:r,getItems:l,hasItem:a,removeItem:n}}const Hi=t=>`'${t}' value is already declared in a unique set.`;function xi(){let{errorItemExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Set;function o(o){if(e.has(o))throw new Error(t(o));e.add(o)}function n(){return[...e]}function i(){e.clear()}return t=io(t)?t:Hi,{addItem:o,clear:i,getItems:n}}const Ii=t=>`There is already registered "${t}" plugin.`,Ai=t=>`There is already registered plugin on priority "${t}".`,ki=t=>`The priority "${t}" is not a number.`,Oi=Ei({errorPriorityExists:Ai,errorPriorityNaN:ki}),Pi=xi({errorItemExists:Ii}),Ni=Ti({errorIdExists:Ii});function _i(){return[...Oi.getItems(),...Pi.getItems()]}function Di(t){const e=lt(t);return Ni.getItem(e)}function Li(t){return!!Di(t)}function Vi(t,e,o){[t,e,o]=Fi(t,e,o),void 0===Di(t)&&Bi(t,e,o)}function Bi(t,e,o){const n=lt(t);if(Ni.hasItem(n))throw new Error(Ii(n));void 0===o?Pi.addItem(n):Oi.addItem(o,n),Ni.addItem(n,e)}function Fi(t,e,o){return"function"===typeof t&&(e=t,t=e.PLUGIN_KEY,o=e.PLUGIN_PRIORITY),[t,e,o]}const{register:Wi,getItem:ji,hasItem:zi,getNames:Ui,getValues:$i}=Cn("renderers");function Gi(t){if("function"===typeof t)return t;if(!zi(t))throw Error(`No registered renderer found under "${t}" name`);return ji(t)}function Yi(t,e){"string"!==typeof t&&(e=t,t=e.RENDERER_TYPE),Wi(t,e)}const{register:Ki,getItem:Xi,hasItem:qi,getNames:Qi,getValues:Ji}=Cn("validators");function Zi(t){if("function"===typeof t)return t;if(!qi(t))throw Error(`No registered validator found under "${t}" name`);return Xi(t)}function ts(t,e){"string"!==typeof t&&(e=t,t=e.VALIDATOR_TYPE),Ki(t,e)}function es(t){return window.requestAnimationFrame(t)}function os(t){window.cancelAnimationFrame(t)}function ns(){return"ontouchstart"in window}let is;function ss(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return is||(is="object"===typeof Intl?new Intl.Collator(t,e).compare:"function"===typeof String.prototype.localeCompare?(t,e)=>`${t}`.localeCompare(e):(t,e)=>t===e?0:t>e?-1:1,is)}const rs=new WeakMap;class ls{constructor(t,e,o,n,i,s){let r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.wtSettings=o,this.domBindings=e,this.wtTable=i,this.selectionManager=s,this.parent=r,this.eventManager=n,this.facadeGetter=t,rs.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}registerEvents(){this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",(t=>this.onContextMenu(t))),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",(t=>this.onMouseOver(t))),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",(t=>this.onMouseOut(t)));const t=()=>{this.eventManager.addEventListener(this.wtTable.holder,"touchstart",(t=>this.onTouchStart(t))),this.eventManager.addEventListener(this.wtTable.holder,"touchend",(t=>this.onTouchEnd(t))),this.momentumScrolling||(this.momentumScrolling={}),this.eventManager.addEventListener(this.wtTable.holder,"scroll",(()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||this.wtSettings.getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout((()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,this.wtSettings.getSetting("onAfterMomentumScroll"))}),200)}))},e=()=>{this.eventManager.addEventListener(this.wtTable.holder,"mouseup",(t=>this.onMouseUp(t))),this.eventManager.addEventListener(this.wtTable.holder,"mousedown",(t=>this.onMouseDown(t)))};jo()?t():(ns()&&t(),e())}selectedCellWasTouched(t){const e=rs.get(this),o=this.parentCell(t),n=o.coords;if(e.selectedCellBeforeTouchEnd&&n){const[t,o]=[n.row,e.selectedCellBeforeTouchEnd.from.row],[i,s]=[n.col,e.selectedCellBeforeTouchEnd.from.col];return t===o&&i===s}return!1}parentCell(t){const e={},o=this.wtTable.TABLE,n=ie(t,["TD","TH"],o);return n?(e.coords=this.wtTable.getCoords(n),e.TD=n):ce(t,"wtBorder")&&ce(t,"current")?(e.coords=this.selectionManager.getFocusSelection().cellRange.highlight,e.TD=this.wtTable.getCell(e.coords)):ce(t,"wtBorder")&&ce(t,"area")&&this.selectionManager.getAreaSelection().cellRange&&(e.coords=this.selectionManager.getAreaSelection().cellRange.to,e.TD=this.wtTable.getCell(e.coords)),e}onMouseDown(t){const e=rs.get(this),o=this.domBindings.rootDocument.activeElement,n=ho(Jt,t.target),i=t.target;if(!["TD","TH"].includes(o.nodeName)&&(i===o||n(0)===o||n(1)===o))return;const s=this.parentCell(i);ce(i,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",t,i):s.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,s.coords,s.TD),(0===t.button||this.touchApplied)&&s.TD&&(e.dblClickOrigin[0]=s.TD,clearTimeout(e.dblClickTimeout[0]),e.dblClickTimeout[0]=setTimeout((()=>{e.dblClickOrigin[0]=null}),1e3))}onContextMenu(t){if(this.wtSettings.has("onCellContextMenu")){const e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}onMouseOver(t){if(!this.wtSettings.has("onCellMouseOver"))return;const e=this.wtTable.TABLE,o=ie(t.target,["TD","TH"],e),n=this.parent||this;o&&o!==n.lastMouseOver&&se(o,e)&&(n.lastMouseOver=o,this.callListener("onCellMouseOver",t,this.wtTable.getCoords(o),o))}onMouseOut(t){if(!this.wtSettings.has("onCellMouseOut"))return;const e=this.wtTable.TABLE,o=ie(t.target,["TD","TH"],e),n=ie(t.relatedTarget,["TD","TH"],e),i=this.parent||this;o&&o!==n&&se(o,e)&&(this.callListener("onCellMouseOut",t,this.wtTable.getCoords(o),o),null===n&&(i.lastMouseOver=null))}onMouseUp(t){const e=rs.get(this),o=this.parentCell(t.target);o.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,o.coords,o.TD),(0===t.button||this.touchApplied)&&(o.TD===e.dblClickOrigin[0]&&o.TD===e.dblClickOrigin[1]?(ce(t.target,"corner")?this.callListener("onCellCornerDblClick",t,o.coords,o.TD):this.callListener("onCellDblClick",t,o.coords,o.TD),e.dblClickOrigin[0]=null,e.dblClickOrigin[1]=null):o.TD===e.dblClickOrigin[0]&&(e.dblClickOrigin[1]=o.TD,clearTimeout(e.dblClickTimeout[1]),e.dblClickTimeout[1]=setTimeout((()=>{e.dblClickOrigin[1]=null}),500)))}onTouchStart(t){const e=rs.get(this);e.selectedCellBeforeTouchEnd=this.selectionManager.getFocusSelection().cellRange,this.touchApplied=!0,this.onMouseDown(t)}onTouchEnd(t){var e;const o=t.target,n=null===(e=this.parentCell(o))||void 0===e?void 0:e.coords,i=U(n)&&n.row>=0&&n.col>=0,s=t.cancelable&&i&&this.wtSettings.getSetting("isDataViewInstance");if(s){const e=["A","BUTTON","INPUT"];zo()&&(Do()||Vo())&&this.selectedCellWasTouched(o)&&!e.includes(o.tagName)?t.preventDefault():this.selectedCellWasTouched(o)||t.preventDefault()}this.onMouseUp(t),this.touchApplied=!1}callListener(t,e,o,n){const i=this.wtSettings.getSettingPure(t);i&&i(e,o,n,this.facadeGetter())}destroy(){const t=rs.get(this);clearTimeout(t.dblClickTimeout[0]),clearTimeout(t.dblClickTimeout[1]),this.eventManager.destroy()}}var as=ls;class hs{constructor(t,e,o){this.offset=t,this.total=e,this.countTH=o}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleRowHeadedColumnToSourceColumn(t){return this.renderedToSource(this.offsettedTH(t))}sourceColumnToVisibleRowHeadedColumn(t){return this.unOffsettedTH(this.sourceToRendered(t))}}var cs=hs;class ds{constructor(t,e,o){this.offset=t,this.total=e,this.countTH=o}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleColHeadedRowToSourceRow(t){return this.renderedToSource(this.offsettedTH(t))}sourceRowToVisibleColHeadedRow(t){return this.unOffsettedTH(this.sourceToRendered(t))}}var us=ds;const gs=0,fs=1,ms=2;class ps{constructor(){this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}setSize(t){this.currentSize=this.nextSize,this.nextSize=t}setOffset(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}class ws{constructor(){this.size=new ps,this.workingSpace=gs,this.sharedSize=null}setSize(t){this.size.setSize(t)}setOffset(t){this.size.setOffset(t)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof ps}isPlaceOn(t){return this.workingSpace===t}append(t){this.workingSpace=fs,t.workingSpace=ms,this.sharedSize=t.getViewSize()}prepend(t){this.workingSpace=ms,t.workingSpace=fs,this.sharedSize=t.getViewSize()}}class Cs{constructor(t,e,o){this.rootNode=t,this.nodesPool=e,this.sizeSet=new ws,this.childNodeType=o.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}setSize(t){return this.sizeSet.setSize(t),this}setOffset(t){return this.sizeSet.setOffset(t),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}getCurrentNode(){const t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}getRenderedChildCount(){const{rootNode:t,sizeSet:e}=this;let o=0;if(this.isSharedViewSet()){let n=t.firstElementChild;while(n){if(n.tagName===this.childNodeType)o+=1;else if(e.isPlaceOn(fs))break;n=n.nextElementSibling}}else o=t.childElementCount;return o}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:t,sizeSet:e}=this,o=this.isSharedViewSet(),{nextSize:n}=e.getViewSize();let i=this.getRenderedChildCount();while(i<n){const n=this.nodesPool();!o||o&&e.isPlaceOn(ms)?t.appendChild(n):t.insertBefore(n,t.firstChild),i+=1}const s=o&&e.isPlaceOn(fs);while(i>n)t.removeChild(s?t.firstChild:t.lastChild),i-=1}render(){const{rootNode:t,sizeSet:e}=this;let o=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(ms)&&(o+=e.sharedSize.nextSize);let n=t.childNodes[o];if(n.tagName!==this.childNodeType){const e=this.nodesPool();t.replaceChild(e,n),n=e}this.collectedNodes.push(n),this.visualIndex+=1}end(){}}class vs extends Cs{prependView(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}appendView(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}class ys{constructor(t){this.nodeType=t.toUpperCase()}setRootDocument(t){this.rootDocument=t}obtain(){return this.rootDocument.createElement(this.nodeType)}}class Ss{constructor(t,e){this.nodesPool="string"===typeof t?new ys(t):null,this.nodeType=t,this.rootNode=e,this.table=null,this.renderedNodes=0}setTable(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}adjust(){}render(){}}class bs extends Ss{constructor(){super("TH"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new vs(t,(t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,rowHeaderFunctions:e,rowHeadersCount:o,rows:n,cells:i}=this.table;for(let s=0;s<t;s++){const t=this.table.renderedRowToSource(s),r=n.getRenderedNode(s);this.sourceRowIndex=t;const l=this.obtainOrderView(r),a=i.obtainOrderView(r);l.appendView(a).setSize(o).setOffset(this.table.renderedColumnToSource(0)).start();for(let n=0;n<o;n++){l.render();const o=l.getCurrentNode();o.className="",o.removeAttribute("style"),this.table.isAriaEnabled()&&ge(o,[Ct(),xt(),Vt(n+1),ft(-1)]),e[n](t,o,n)}l.end()}}}class Rs extends Ss{constructor(t){super(null,t)}adjust(){const{columnHeadersCount:t,rowHeadersCount:e}=this.table;let o=this.rootNode.firstChild;if(t){const{columnsToRender:n}=this.table,i=n+e;for(let e=0,r=t;e<r;e++){o=this.rootNode.childNodes[e],o||(o=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(o)),this.renderedNodes=o.childNodes.length;while(this.renderedNodes<i)o.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;while(this.renderedNodes>i)o.removeChild(o.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>t)for(let e=t;e<s;e++)this.rootNode.removeChild(this.rootNode.lastChild)}else o&&pe(o)}render(){const{columnHeadersCount:t}=this.table;this.table.isAriaEnabled()&&ge(this.rootNode,[pt()]);for(let e=0;e<t;e+=1){const{columnHeaderFunctions:t,columnsToRender:o,rowHeadersCount:n}=this.table,i=this.rootNode.childNodes[e];this.table.isAriaEnabled()&&ge(i,[yt(),Lt(e+1)]);for(let s=-1*n;s<o;s+=1){const o=this.table.renderedColumnToSource(s),r=i.childNodes[s+n];r.className="",r.removeAttribute("style"),this.table.isAriaEnabled()&&ge(r,[Vt(s+1+this.table.rowHeadersCount),ft(-1),...s<0?[pt()]:[vt(),Ht()]]),t[e](o,r,e)}}}}class Es extends Ss{constructor(t){super(null,t)}adjust(){const{columnsToRender:t,rowHeadersCount:e}=this.table,o=t+e;while(this.renderedNodes<o)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;while(this.renderedNodes>o)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:t,rowHeadersCount:e}=this.table;for(let n=0;n<e;n++){const t=this.table.renderedColumnToSource(n),e=this.table.columnUtils.getHeaderWidth(t);this.rootNode.childNodes[n].style.width=`${e}px`}for(let n=0;n<t;n++){const t=this.table.renderedColumnToSource(n),o=this.table.columnUtils.getStretchedColumnWidth(t);this.rootNode.childNodes[n+e].style.width=`${o}px`}const o=this.rootNode.firstChild;o&&de(o,"rowHeader")}}let Ms=!1;class Ts extends Ss{constructor(t){super("TR",t),this.orderView=new Cs(t,(t=>this.nodesPool.obtain(t)),this.nodeType)}getRenderedNode(t){return this.orderView.getNode(t)}render(){const{rowsToRender:t}=this.table;!Ms&&t>1e3&&(Ms=!0,ln(j`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&ge(this.rootNode,[pt()]),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(let n=0;n<t;n++){this.orderView.render();const t=this.orderView.getCurrentNode(),i=this.table.renderedRowToSource(n);var e,o;if(this.table.isAriaEnabled())ge(t,[yt(),Lt(i+(null!==(e=null===(o=this.table.rowUtils)||void 0===o||null===(o=o.dataAccessObject)||void 0===o?void 0:o.columnHeaders.length)&&void 0!==e?e:0)+1)])}this.orderView.end()}}class Hs extends Ss{constructor(){super("TD"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new vs(t,(t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,columnsToRender:e,rows:o,rowHeaders:n}=this.table;for(let r=0;r<t;r++){const t=this.table.renderedRowToSource(r),l=o.getRenderedNode(r);this.sourceRowIndex=t;const a=this.obtainOrderView(l),h=n.obtainOrderView(l);a.prependView(h).setSize(e).setOffset(this.table.renderedColumnToSource(0)).start();for(let o=0;o<e;o++){a.render();const e=a.getCurrentNode(),n=this.table.renderedColumnToSource(o);var i,s;if(ce(e,"hide")||(e.className=""),e.removeAttribute("style"),e.removeAttribute("dir"),fe(e,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(t,n,e),this.table.isAriaEnabled())ge(e,[...e.hasAttribute("role")?[]:[wt()],ft(-1),Vt(n+(null!==(i=null===(s=this.table.rowUtils)||void 0===s||null===(s=s.dataAccessObject)||void 0===s?void 0:s.rowHeaders.length)&&void 0!==i?i:0)+1)])}a.end()}}}class xs{constructor(t){let{cellRenderer:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=e}setAxisUtils(t,e){this.rowUtils=t,this.columnUtils=e}setViewportSize(t,e){this.rowsToRender=t,this.columnsToRender=e}setFilters(t,e){this.rowFilter=t,this.columnFilter=e}setHeaderContentRenderers(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}setRenderers(){let{rowHeaders:t,columnHeaders:e,colGroup:o,rows:n,cells:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setTable(this),e.setTable(this),o.setTable(this),n.setTable(this),i.setTable(this),this.rowHeaders=t,this.columnHeaders=e,this.colGroup=o,this.rows=n,this.cells=i}renderedRowToSource(t){return this.rowFilter.renderedToSource(t)}renderedColumnToSource(t){return this.columnFilter.renderedToSource(t)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:t,rows:e}=this;for(let o=0;o<t;o++){const t=e.getRenderedNode(o);if(t.firstChild){const e=this.renderedRowToSource(o),n=this.rowUtils.getHeight(e);t.firstChild.style.height=n?n-1+"px":""}}}}class Is{constructor(){let{TABLE:t,THEAD:e,COLGROUP:o,TBODY:n,rowUtils:i,columnUtils:s,cellRenderer:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new xs(t,{cellRenderer:r}),this.renderer.setRenderers({rowHeaders:new bs,columnHeaders:new Rs(e),colGroup:new Es(o),rows:new Ts(n),cells:new Hs}),this.renderer.setAxisUtils(i,s)}setFilters(t,e){return this.renderer.setFilters(t,e),this}setViewportSize(t,e){return this.renderer.setViewportSize(t,e),this}setHeaderContentRenderers(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}class As{constructor(t,e){this.dataAccessObject=t,this.wtSettings=e,this.headerWidths=new Map}getWidth(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(t){const e=this.dataAccessObject.wtViewport.columnsRenderCalculator;let o=this.getWidth(t);if(e){const n=e.getStretchedColumnWidth(t,o);n&&(o=n)}return o}getHeaderHeight(t){let e=this.wtSettings.getSetting("defaultRowHeight");const o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==o&&(e=e?Math.max(e,o):o),e}getHeaderWidth(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}calculateWidths(){const{wtSettings:t}=this,{wtTable:e,wtViewport:o,cloneSource:n}=this.dataAccessObject,i=n?n.wtTable.holder:e.holder,s=i.offsetHeight<i.scrollHeight?Ue():0;let r=t.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-s),r=t.getSetting("onModifyRowHeaderWidth",r),null!==r&&void 0!==r){const e=t.getSetting("rowHeaders").length,o=t.getSetting("defaultColumnWidth");for(let t=0;t<e;t++){let e=Array.isArray(r)?r[t]:r;e=null===e||void 0===e?o:e,this.headerWidths.set(t,e)}}}}class ks{constructor(t,e){this.dataAccessObject=t,this.wtSettings=e}getHeight(t){let e=this.wtSettings.getSetting("rowHeight",t);const o=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==o&&(e=void 0===e?o:Math.max(e,o)),e}}const Os="top",Ps="bottom",Ns="inline_start",_s="top_inline_start_corner",Ds="bottom_inline_start_corner",Ls=[Os,Ps,Ns,_s,Ds],Vs=new Map([[Os,`ht_clone_${Os}`],[Ps,`ht_clone_${Ps}`],[Ns,`ht_clone_${Ns} ht_clone_left`],[_s,`ht_clone_${_s} ht_clone_top_left_corner`],[Ds,`ht_clone_${Ds} ht_clone_bottom_left_corner`]]);function Bs(t,e,o){return e=Fs(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Fs(t){var e=Ws(t,"string");return"symbol"===typeof e?e:String(e)}function Ws(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class js{constructor(t,e,o,n,i){Bs(this,"wtSettings",null),Bs(this,"domBindings",void 0),Bs(this,"TBODY",null),Bs(this,"THEAD",null),Bs(this,"COLGROUP",null),Bs(this,"hasTableHeight",!0),Bs(this,"hasTableWidth",!0),Bs(this,"isTableVisible",!1),Bs(this,"tableOffset",0),Bs(this,"holderOffset",0),this.domBindings=o,this.isMaster="master"===i,this.name=i,this.dataAccessObject=t,this.facadeGetter=e,this.wtSettings=n,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=o.rootTable,me(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(()=>this._modifyRowHeaderWidth(s))),this.rowUtils=new ks(this.dataAccessObject,this.wtSettings),this.columnUtils=new As(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Is({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(t){return this.name===t}fixTableDomTree(){const t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(t){const e=t.parentNode;let o;return e&&e.nodeType===Node.ELEMENT_NODE&&ce(e,"wtHolder")||(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",e&&e.insertBefore(o,t),o.appendChild(t)),o.style.position="relative",this.wtSettings.getSetting("ariaTags")&&ge(o,[pt()]),o}createHider(t){const e=t.parentNode;let o;return e&&e.nodeType===Node.ELEMENT_NODE&&ce(e,"wtHolder")||(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",e&&e.insertBefore(o,t),o.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&ge(o,[pt()]),o}createHolder(t){const e=t.parentNode;let o;return e&&e.nodeType===Node.ELEMENT_NODE&&ce(e,"wtHolder")||(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",e&&e.insertBefore(o,t),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&ge(o.parentNode,[pt()])),o.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&ge(o,[pt()]),o}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:e}=this,{wtOverlays:o,wtViewport:n}=this.dataAccessObject,i=e.getSetting("totalRows"),s=e.getSetting("totalColumns"),r=e.getSetting("rowHeaders"),l=r.length,a=e.getSetting("columnHeaders"),h=a.length;let c=!1,d=t;if(this.isMaster&&(this.holderOffset=Se(this.holder),d=n.createRenderCalculators(d),l&&!e.getSetting("fixedColumnsStart"))){const t=o.inlineStartOverlay.getScrollPosition(),e=this.correctHeaderWidth;this.correctHeaderWidth=0!==t,e!==this.correctHeaderWidth&&(d=!1)}if(this.isMaster&&(c=o.updateStateOfRendering()),d)this.isMaster&&n.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=Se(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const t=i>0?this.getFirstRenderedRow():0,e=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new us(t,i,h),this.columnFilter=new cs(e,s,l);let o=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const t={};this.wtSettings.getSetting("beforeDraw",!0,t),o=!0!==t.skipRender}if(o){let t;if(this.tableRenderer.setHeaderContentRenderers(r,a),(this.is(Ps)||this.is(Ds))&&this.tableRenderer.setHeaderContentRenderers(r,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(t=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Ps))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const e=ke(this.hider),o=ke(this.TABLE);0!==e&&o!==e&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),t!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Ps)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let u=!1;return this.isMaster&&(u=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(u=o.bottomOverlay.resetFixedPosition()||u),u=o.inlineStartOverlay.resetFixedPosition()||u,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),u?(o.refreshAll(),o.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(d),c&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(t){const e=this.columnFilter.renderedToSource(t);let o=this.wtSettings.getSetting("columnHeaders").length;const n=this.wtSettings.getSetting("defaultRowHeight");let i,s,r;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];while(o)o-=1,i=this.getColumnHeaderHeight(o),s=this.getColumnHeader(e,o),s&&(r=Pe(s),(!i&&n<r||i<r)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=r),Array.isArray(l)?null!==l[o]&&void 0!==l[o]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l[o]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(l[o]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l[o]||l))}adjustColumnHeaderHeights(){const{wtSettings:t}=this,e=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,n=t.getSetting("columnHeaders");for(let i=0,s=n.length;i<s;i++)if(o[i]){if(!e[i]||0===e[i].childNodes.length)return;e[i].childNodes[0].style.height=`${o[i]}px`}}resetOversizedRows(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject;if((this.isMaster||this.is(Ps))&&!t.getSetting("externalRowCalculator")){const t=this.getRenderedRowsCount();for(let o=0;o<t;o++){const t=this.rowFilter.renderedToSource(o);e.oversizedRows&&e.oversizedRows[t]&&(e.oversizedRows[t]=void 0)}}}getCell(t){let e=t.row,o=t.col;const n=this.wtSettings.getSetting("onModifyGetCellCoords",e,o);if(n&&Array.isArray(n)&&([e,o]=n),this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;const i=this.getRow(e);if(!i&&e>=0)throw new Error("TR was expected to be rendered but is not");const s=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!s&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(t){let e=null,o=null;var n,i;t<0?(e=null===(n=this.rowFilter)||void 0===n?void 0:n.sourceRowToVisibleColHeadedRow(t),o=this.THEAD):(e=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(t),o=this.TBODY);return void 0!==e&&void 0!==o&&(!(o.childNodes.length<e+1)&&o.childNodes[e])}getColumnHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const o=this.THEAD.childNodes[e];return null===o||void 0===o?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}getColumnHeaders(t){const e=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach((t=>{const n=t.childNodes[o];n&&e.push(n)})),e}getRowHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const o=this.wtSettings.getSetting("rowHeaders").length;if(e>=o)return;const n=this.rowFilter.sourceToRendered(t),i=n<0?this.rowFilter.sourceRowToVisibleColHeadedRow(t):n,s=n<0?this.THEAD:this.TBODY,r=s.childNodes[i];return null===r||void 0===r?void 0:r.childNodes[e]}getRowHeaders(t){const e=[],o=this.wtSettings.getSetting("rowHeaders").length;for(let n=0;n<o;n++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],i=null===o||void 0===o?void 0:o.childNodes[n];i&&e.push(i)}return e}getCoords(t){let e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=ne(e,["TD","TH"])),null===e)return null;const o=e.parentNode,n=o.parentNode;let i=re(o),s=e.cellIndex;if(le(_s,e,this.wtRootElement)||le(Os,e,this.wtRootElement))"THEAD"===n.nodeName&&(i-=n.childNodes.length);else if(le(Ds,e,this.wtRootElement)||le(Ps,e,this.wtRootElement)){const t=this.wtSettings.getSetting("totalRows");i=t-n.childNodes.length+i}else i=n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter.renderedToSource(i);return s=le(_s,e,this.wtRootElement)||le(Ns,e,this.wtRootElement)||le(Ds,e,this.wtRootElement)?this.columnFilter.offsettedTH(s):this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(i,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let t=this.TBODY.childNodes.length;const e=t*this.wtSettings.getSetting("defaultRowHeight"),o=Pe(this.TBODY)-1;let n,i,s,r,l;if(e!==o||this.wtSettings.getSetting("fixedRowsBottom"))while(t)t-=1,s=this.rowFilter.renderedToSource(t),n=this.getRowHeight(s),r=this.getTrForRow(s),l=r.querySelector("th"),i=l?Pe(l):Pe(r)-1,(!n&&this.wtSettings.getSetting("defaultRowHeight")<i||n<i)&&(i+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=i)}getTrForRow(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}isColumnHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("rowHeaders"),o=e.length;return Math.abs(t)<=o}isRowHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("columnHeaders"),o=e.length;return Math.abs(t)<=o}isRowBeforeRenderedRows(t){const e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}isRowAfterRenderedRows(t){return t>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(t){const e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}isColumnAfterRenderedColumns(t){return this.columnFilter&&t>this.getLastRenderedColumn()}isColumnAfterViewport(t){return this.columnFilter&&t>this.getLastVisibleColumn()}isRowAfterViewport(t){return this.rowFilter&&t>this.getLastVisibleRow()}isColumnBeforeViewport(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(t){return this.rowUtils.getHeight(t)}getColumnHeaderHeight(t){return this.columnUtils.getHeaderHeight(t)}getColumnWidth(t){return this.columnUtils.getWidth(t)}getStretchedColumnWidth(t){return this.columnUtils.getStretchedColumnWidth(t)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return ke(this.TABLE)}getHeight(){return Oe(this.TABLE)}getTotalWidth(){const t=ke(this.hider);return 0!==t?t:this.getWidth()}getTotalHeight(){const t=Oe(this.hider);return 0!==t?t:this.getHeight()}isVisible(){return ye(this.TABLE)}_modifyRowHeaderWidth(t){let e=io(t)?t():null;return Array.isArray(e)?(e=[...e],e[e.length-1]=this._correctRowHeaderWidth(e[e.length-1])):e=this._correctRowHeaderWidth(e),e}_correctRowHeaderWidth(t){let e=t;return"number"!==typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}var zs=js;const Us="stickyRowsTop",$s={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows");return 0===t?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Ro($s,"MIXIN_NAME",Us,{writable:!1,enumerable:!1});var Gs=$s;const Ys="calculatedColumns",Ks={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Ro(Ks,"MIXIN_NAME",Ys,{writable:!1,enumerable:!1});var Xs=Ks;class qs extends zs{constructor(t,e,o,n){super(t,e,o,n,Os)}}yo(qs,Gs),yo(qs,Xs);var Qs=qs;function Js(t,e,o){return e=Zs(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Zs(t){var e=tr(t,"string");return"symbol"===typeof e?e:String(e)}function tr(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class er{constructor(t){Js(this,"dataAccessObject",void 0),Js(this,"lastScrolledColumnPos",-1),Js(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}scrollViewport(t,e,o,n,i){const s=this.scrollViewportHorizontally(t.col,o,i),r=this.scrollViewportVertically(t.row,e,n);return s||r}scrollViewportHorizontally(t,e,o){const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n||!Number.isInteger(t)||t<0||t>i)return!1;const s=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn(),l=void 0===e&&void 0===o,{fixedColumnsStart:a,inlineStartOverlay:h}=this.dataAccessObject;if(l&&t<a)return!1;let c=!1;return t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",t),-1===s?c=h.scrollTo(t,l?t>this.lastScrolledColumnPos:e):(l&&(t<s||t>r)||!l)&&(c=h.scrollTo(t,l?t>r:e)),c&&(this.lastScrolledColumnPos=t),c}scrollViewportVertically(t,e,o){const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n||!Number.isInteger(t)||t<0||t>i)return!1;const s=this.getFirstVisibleRow(),r=this.getLastVisibleRow(),l=void 0===e&&void 0===o,{fixedRowsBottom:a,fixedRowsTop:h,topOverlay:c}=this.dataAccessObject;if(l&&(t<h||t>i-a-1))return!1;let d=!1;return t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",t),-1===s?d=c.scrollTo(t,l?t>this.lastScrolledRowPos:o):(l&&(t<s||t>r)||!l)&&(d=c.scrollTo(t,l?t>r:o)),d&&(this.lastScrolledRowPos=t),d}getFirstVisibleRow(){const{topOverlay:t,wtTable:e,wtViewport:o,totalRows:n,fixedRowsTop:i,rootWindow:s}=this.dataAccessObject;let r=e.getFirstVisibleRow();if(t.mainTableScrollableElement===s){const l=Se(e.wtRootElement),a=Pe(e.hider),h=Pe(s),c=Ee(s,s);if(l.top+a-h<=c){let e=o.getColumnHeaderHeight();e+=t.sumCellSizes(0,i);for(let o=n;o>0;o--)if(e+=t.sumCellSizes(o-1,o),l.top+a-e<=c){r=o;break}}}return r}getLastVisibleRow(){const{topOverlay:t,wtTable:e,wtViewport:o,totalRows:n,rootWindow:i}=this.dataAccessObject;let s=e.getLastVisibleRow();if(t.mainTableScrollableElement===i){const r=Se(e.wtRootElement),l=Ee(i,i);if(r.top>l){const e=Pe(i);let a=o.getColumnHeaderHeight();for(let o=1;o<=n;o++)if(a+=t.sumCellSizes(o-1,o),r.top+a-l>=e){s=o-2;break}}}return s}getFirstVisibleColumn(){const{inlineStartOverlay:t,wtTable:e,wtViewport:o,totalColumns:n,rootWindow:i}=this.dataAccessObject;let s=e.getFirstVisibleColumn();if(t.mainTableScrollableElement===i){const r=Se(e.wtRootElement),l=Ne(e.hider),a=Ne(i),h=Math.abs(Me(i,i));if(r.left+l-a<=h){let e=o.getRowHeaderWidth();for(let o=n;o>0;o--)if(e+=t.sumCellSizes(o-1,o),r.left+l-e<=h){s=o;break}}}return s}getLastVisibleColumn(){const{wtSettings:t,inlineStartOverlay:e,wtTable:o,wtViewport:n,totalColumns:i,rootWindow:s}=this.dataAccessObject;let r=o.getLastVisibleColumn();if(e.mainTableScrollableElement===s){const l=t.getSetting("rtlMode");let a=null;if(l){const t=o.TABLE.getBoundingClientRect(),e=this.dataAccessObject.rootWindow.document,n=e.documentElement.offsetWidth;a=Math.abs(t.right-n)}else{const t=Se(o.wtRootElement);a=t.left}const h=Math.abs(Me(s,s));if(a>h){const t=Ne(s);let o=n.getRowHeaderWidth();for(let n=1;n<=i;n++)if(o+=e.sumCellSizes(n-1,n),a+o-h>=t){r=n-2;break}}}return r}}var or=er;function nr(t,e,o){ir(t,e),e.set(t,o)}function ir(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sr(t,e,o){return e=rr(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function rr(t){var e=lr(t,"string");return"symbol"===typeof e?e:String(e)}function lr(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ar(t,e){var o=dr(t,e,"get");return hr(t,o)}function hr(t,e){return e.get?e.get.call(t):e.value}function cr(t,e,o){var n=dr(t,e,"set");return ur(t,n,o),o}function dr(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function ur(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var gr=new WeakMap;class fr{constructor(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];sr(this,"row",null),sr(this,"col",null),nr(this,gr,{writable:!0,value:!1}),cr(this,gr,o),"undefined"!==typeof t&&"undefined"!==typeof e&&(this.row=t,this.col=e)}isValid(t){const{countRows:e,countCols:o,countRowHeaders:n,countColHeaders:i}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...t};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col))&&(!(this.row<-i||this.col<-n)&&!(this.row>=e||this.col>=o))}isEqual(t){return t===this||this.row===t.row&&this.col===t.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isSouthEastOf(t){return this.row>=t.row&&(ar(this,gr)?this.col<=t.col:this.col>=t.col)}isNorthWestOf(t){return this.row<=t.row&&(ar(this,gr)?this.col>=t.col:this.col<=t.col)}isSouthWestOf(t){return this.row>=t.row&&(ar(this,gr)?this.col>=t.col:this.col<=t.col)}isNorthEastOf(t){return this.row<=t.row&&(ar(this,gr)?this.col<=t.col:this.col>=t.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}clone(){return new fr(this.row,this.col,ar(this,gr))}toObject(){return{row:this.row,col:this.col}}}var mr=fr;function pr(t,e,o){wr(t,e),e.set(t,o)}function wr(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cr(t,e,o){return e=vr(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function vr(t){var e=yr(t,"string");return"symbol"===typeof e?e:String(e)}function yr(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Sr(t,e){var o=Er(t,e,"get");return br(t,o)}function br(t,e){return e.get?e.get.call(t):e.value}function Rr(t,e,o){var n=Er(t,e,"set");return Mr(t,n,o),o}function Er(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Mr(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var Tr=new WeakMap;class Hr{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Cr(this,"highlight",null),Cr(this,"from",null),Cr(this,"to",null),pr(this,Tr,{writable:!0,value:!1}),this.highlight=t.clone(),this.from=e.clone(),this.to=o.clone(),Rr(this,Tr,n)}setHighlight(t){return this.highlight=t.clone(),this}setFrom(t){return this.from=t.clone(),this}setTo(t){return this.to=t.clone(),this}isValid(t){return this.from.isValid(t)&&this.to.isValid(t)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(t){const{row:e,col:o}=t,n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return n.row<=e&&i.row>=e&&n.col<=o&&i.col>=o}includesRange(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}isEqual(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}overlaps(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}isNorthWestOf(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}isOverlappingHorizontally(t){return this.getOuterTopRightCorner().col>=t.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=t.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=t.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=t.getOuterTopLeftCorner().col}isOverlappingVertically(t){return this.getOuterBottomRightCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=t.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=t.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=t.getOuterTopRightCorner().row}expand(t){const e=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>o.row||t.col>o.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(o.row,t.row),Math.max(o.col,t.col)),!0)}expandByRange(t){if(this.includesRange(t)||!this.overlaps(t))return!1;const e=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),n=this.getDirection(),i=t.getOuterTopStartCorner(),s=t.getOuterBottomEndCorner(),r=Math.min(e.row,i.row),l=Math.min(e.col,i.col),a=Math.max(o.row,s.row),h=Math.max(o.col,s.col),c=this._createCellCoords(r,l),d=this._createCellCoords(a,h);return this.from=c,this.to=d,this.setDirection(n),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(t){switch(t){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break;default:break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){const t=this.getDirection();switch(t){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}flipDirectionHorizontally(){const t=this.getDirection();switch(t){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Sr(this,Tr)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Sr(this,Tr)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Sr(this,Tr)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Sr(this,Tr)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Sr(this,Tr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Sr(this,Tr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Sr(this,Tr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Sr(this,Tr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(t,e){return!!(e&&e.includes(t)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(e.from.row,e.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(e.from.row,e.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(e.to.row,e.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(e.to.row,e.to.col))))||(t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner()))}getOppositeCorner(t,e){if(!(t instanceof mr))return!1;if(e){const{from:o,to:n}=e;if(e.includes(t)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(o.row,n.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(n.row,o.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterTopStartCorner()}}return t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0}getBordersSharedWith(t){if(!this.includesRange(t))return[];const e={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},n=[];return e.top===o.top&&n.push("top"),e.right===o.right&&n.push("right"),e.bottom===o.bottom&&n.push("bottom"),e.left===o.left&&n.push("left"),n}getInner(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),o=[];for(let n=t.row;n<=e.row;n++)for(let i=t.col;i<=e.col;i++)this.from.row===n&&this.from.col===i||this.to.row===n&&this.to.col===i||o.push(this._createCellCoords(n,i));return o}getAll(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),o=[];for(let n=t.row;n<=e.row;n++)for(let i=t.col;i<=e.col;i++)t.row===n&&t.col===i?o.push(t):e.row===n&&e.col===i?o.push(e):o.push(this._createCellCoords(n,i));return o}forAll(t){const e=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();for(let n=e.row;n<=o.row;n++)for(let i=e.col;i<=o.col;i++){const e=t(n,i);if(!1===e)return}}clone(){return new Hr(this.highlight,this.from,this.to,Sr(this,Tr))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(t,e){return new mr(t,e,Sr(this,Tr))}}var xr=Hr;function Ir(t,e,o){return e=Ar(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ar(t){var e=kr(t,"string");return"symbol"===typeof e?e:String(e)}function kr(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Or{get eventManager(){return new On(this)}constructor(t,e){Ir(this,"wtTable",void 0),Ir(this,"wtScroll",void 0),Ir(this,"wtViewport",void 0),Ir(this,"wtOverlays",void 0),Ir(this,"selectionManager",void 0),Ir(this,"wtEvent",void 0),Ir(this,"guid",`wt_${ht()}`),Ir(this,"drawInterrupted",!1),Ir(this,"drawn",!1),Ir(this,"domBindings",void 0),Ir(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new or(this.createScrollDao())}findOriginalHeaders(){const t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let e=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;e<o;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,o){ve(o,t[e])}])}}createCellCoords(t,e){return new mr(t,e,this.wtSettings.getSetting("rtlMode"))}createCellRange(t,e,o){return new xr(t,e,o,this.wtSettings.getSetting("rtlMode"))}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return this.wtTable.getCell(t);const o=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<n&&t.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<s&&t.row>=o-i){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);if(t.row<o&&t.row>=o-i&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}scrollViewport(t,e,o,n,i){return!(t.col<0||t.row<0)&&this.wtScroll.scrollViewport(t,e,o,n,i)}scrollViewportHorizontally(t,e,o){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,o)}scrollViewportVertically(t,e,o){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,o)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selectionManager(){return t.selectionManager},get drawn(){return t.drawn},set drawn(e){t.drawn=e},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return t.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return t.wtSettings.getSetting("rowHeaders")}}}}function Pr(t,e,o){return e=Nr(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Nr(t){var e=_r(t,"string");return"symbol"===typeof e?e:String(e)}function _r(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Dr extends Or{constructor(t,e,o){super(t,e),Pr(this,"cloneSource",void 0),Pr(this,"cloneOverlay",void 0);const n=this.wtSettings.getSetting("facade",this);this.cloneSource=o.source,this.cloneOverlay=o.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=o.viewport,this.selectionManager=o.selectionManager,this.wtEvent=new as(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,o.event),this.findOriginalHeaders()}}function Lr(t,e,o){return e=Vr(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Vr(t){var e=Br(t,"string");return"symbol"===typeof e?e:String(e)}function Br(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Fr{constructor(t,e,o,n,i){Lr(this,"wtSettings",null),Ro(this,"wot",t,{writable:!1}),this.domBindings=i,this.facadeGetter=e,this.wtSettings=n;const{TABLE:s,hider:r,spreader:l,holder:a,wtRootElement:h}=this.wot.wtTable;this.instance=this.wot,this.type=o,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=r,this.spreader=l,this.holder=a,this.wtRootElement=h,this.trimmingContainer=He(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const t=this.needFullRender;this.needFullRender=this.shouldBeRendered();const e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=He(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:t}=this.wot,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Te(t.TABLE)}getRelativeCellPosition(t,e,o){if(!1===this.clone.wtTable.holder.contains(t))return void ln(`The provided element is not a child of the ${this.type} overlay`);const n=this.mainTableScrollableElement===this.domBindings.rootWindow,i=o<this.wtSettings.getSetting("fixedColumnsStart"),s=e<this.wtSettings.getSetting("fixedRowsTop"),r=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,a={start:this.getRelativeStartPosition(l),top:l.offsetTop},h={start:this.getRelativeStartPosition(t),top:t.offsetTop};let c=null;return c=n?this.getRelativeCellPositionWithinWindow(s,i,h,a):this.getRelativeCellPositionWithinHolder(s,r,i,h,a),c}getRelativeStartPosition(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}getRelativeCellPositionWithinWindow(t,e,o,n){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,r=0;if(e){let t=i.left;this.isRtl()&&(t=this.domBindings.rootWindow.innerWidth-(i.left+i.width+Ue())),s=t<=0?-1*t:0}else s=n.start;if(t){const t=this.clone.wtTable.TABLE.getBoundingClientRect();r=t.top-i.top}else r=n.top;return{start:o.start+s,top:o.top+r}}getRelativeCellPositionWithinHolder(t,e,o,n,i){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let r=0,l=0;if(o||(r=s.horizontal-i.start),e){const t=this.wot.wtTable.wtRootElement.getBoundingClientRect(),e=this.clone.wtTable.TABLE.getBoundingClientRect();l=-1*e.top+t.top}else t||(l=s.vertical-i.top);return{start:n.start-r,top:n.top-l}}makeClone(){if(-1===Ls.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:t,wtSettings:e}=this.wot,{rootDocument:o,rootWindow:n}=this.domBindings,i=o.createElement("DIV"),s=o.createElement("TABLE"),r=t.wtRootElement.parentNode;i.className=`${Vs.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,e.getSetting("ariaTags")&&ge(i,[pt()]),s.className=t.TABLE.className;const l=t.TABLE.getAttribute("role");l&&s.setAttribute("role",t.TABLE.getAttribute("role")),i.appendChild(s),r.appendChild(i);const a=this.wtSettings.getSetting("preventOverflow");return!0===a||"horizontal"===a&&this.type===Os||"vertical"===a&&this.type===Ns?this.mainTableScrollableElement=n:"hidden"===n.getComputedStyle(r).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=Te(t.TABLE),new Dr(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}reset(){if(!this.clone)return;const t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,o=t.style,n=e.style,i=t.parentNode.style;k([o,n,i],(t=>{t.width="",t.height=""}))}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}const Wr=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});function jr(t,e,o){return e=zr(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function zr(t){var e=Ur(t,"string");return"symbol"===typeof e?e:String(e)}function Ur(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class $r extends Fr{constructor(t,e,o,n){super(t,e,Os,o,n),jr(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new Qs(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode,{rootWindow:e}=this.domBindings,o=this.wtSettings.getSetting("preventOverflow");let n=0,i=!1;if(this.trimmingContainer!==e||o&&"vertical"===o)n=this.getScrollPosition(),Xe(t);else{const{wtTable:e}=this.wot,o=e.hider.getBoundingClientRect(),s=Math.ceil(o.bottom),r=t.offsetHeight;i=s===r,n=this.getOverlayOffset(),Ye(t,"0px",`${n}px`)}const s=this.adjustHeaderBordersPosition(n,i);return this.adjustElementsSize(),s}setScrollPosition(t){const e=this.domBindings.rootWindow;let o=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo(Re(e),t),o=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const o=this.wtSettings.getSetting("defaultRowHeight");let n=t,i=0;while(n<e){const t=this.wot.wtTable.getRowHeight(n);i+=void 0===t?o:t,n+=1}return i}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:o}=this.domBindings,n=Ue(e),i=this.clone.wtTable.holder.parentNode,s=i.style,r=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===r){let e=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(e-=n),e=Math.min(e,t.wtRootElement.scrollWidth),s.width=`${e}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Oe(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(Wr.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+e}px`}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){const{wot:o,wtSettings:n}=this,i=o.cloneSource?o.cloneSource:o,s=i.wtTable.holder;let r=this.getTableParentOffset(),l=0;if(e){const o=this.wot.wtTable.getRowHeight(t),n=this.wot.wtViewport.getViewportHeight();o>n&&(e=!1)}if(e&&s.offsetHeight!==s.clientHeight&&(l=Ue(this.domBindings.rootDocument)),e){const e=n.getSetting("fixedRowsBottom"),i=n.getSetting("totalRows");r+=this.sumCellSizes(0,t+1),r-=o.wtViewport.getViewportHeight()-this.sumCellSizes(i-e,i),r+=1}else r+=this.sumCellSizes(n.getSetting("fixedRowsTop"),t);return r+=l,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Ee(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let o=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),n=t-e;o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),o>n&&(o=0)}return o}adjustHeaderBordersPosition(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("totalColumns");n?ue(o,"emptyColumns"):de(o,"emptyColumns");let i=!1;if(!e){const e=this.wtSettings.getSetting("fixedRowsTop"),n=this.cachedFixedRowsTop!==e,s=this.wtSettings.getSetting("columnHeaders");if((n||0===e)&&s.length>0){const e=ce(o,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),t||0===this.wtSettings.getSetting("totalRows")?(de(o,"innerBorderTop"),i=!e):(ue(o,"innerBorderTop"),i=e)}}return i}}const Gr="stickyRowsBottom",Yr={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),o=t-e;return 0===t||0===e?-1:o<0?0:o},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Ro(Yr,"MIXIN_NAME",Gr,{writable:!1,enumerable:!1});var Kr=Yr;class Xr extends zs{constructor(t,e,o,n){super(t,e,o,n,Ps)}}yo(Xr,Kr),yo(Xr,Xs);var qr=Xr;function Qr(t,e,o){return e=Jr(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Jr(t){var e=Zr(t,"string");return"symbol"===typeof e?e:String(e)}function Zr(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class tl extends Fr{constructor(t,e,o,n){super(t,e,Ps,o,n),Qr(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new qr(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,e=this.clone.wtTable.holder.parentNode;e.style.top="";let o=0;const n=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||n&&"vertical"===n?(o=this.getScrollPosition(),this.repositionOverlay()):(o=this.getOverlayOffset(),e.style.bottom=`${o}px`);const i=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:o}=this.domBindings,n=this.clone.wtTable.holder.parentNode;let i=0;e.hasVerticalScroll()||(i+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(i+=Ue(o)),n.style.bottom=`${i}px`}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let o=!1;return this.mainTableScrollableElement===e?(e.scrollTo(Re(e),t),o=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const{wtTable:o,wtSettings:n}=this.wot,i=n.getSetting("defaultRowHeight");let s=t,r=0;while(s<e){const t=o.getRowHeight(s);r+=void 0===t?i:t,s+=1}return r}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:o,rootWindow:n}=this.domBindings,i=Ue(o),s=this.clone.wtTable.holder.parentNode,r=s.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===l){let o=e.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(o-=i),o=Math.min(o,t.wtRootElement.scrollWidth),r.width=`${o}px`}else r.width="";this.clone.wtTable.holder.style.width=r.width;let a=Oe(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(a=0),r.height=`${a}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let o=this.getTableParentOffset();const n=this.wot.cloneSource?this.wot.cloneSource:this.wot,i=n.wtTable.holder;let s=0;e&&i.offsetHeight!==i.clientHeight&&(s=Ue(this.domBindings.rootDocument)),e?(o+=this.sumCellSizes(0,t+1),o-=this.wot.wtViewport.getViewportHeight(),o+=1):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),o+=s,this.setScrollPosition(o)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Ee(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let o=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),n=t-e,i=this.domBindings.rootDocument.documentElement.clientHeight;o=Math.max(this.getTableParentOffset()-this.getScrollPosition()-i+t,0),o>n&&(o=0)}return o}adjustHeaderBordersPosition(t){const e=this.wtSettings.getSetting("fixedRowsBottom"),o=this.cachedFixedRowsBottom!==e,n=this.wtSettings.getSetting("columnHeaders");let i=!1;if((o||0===e)&&n.length>0){const e=this.wot.wtTable.holder.parentNode,o=ce(e,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?(de(e,"innerBorderBottom"),i=!o):(ue(e,"innerBorderBottom"),i=o)}return i}}const el="calculatedRows",ol={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Ro(ol,"MIXIN_NAME",el,{writable:!1,enumerable:!1});var nl=ol;const il="stickyColumnsStart",sl={getFirstRenderedColumn(){const t=this.wtSettings.getSetting("totalColumns");return 0===t?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Ro(sl,"MIXIN_NAME",il,{writable:!1,enumerable:!1});var rl=sl;class ll extends zs{constructor(t,e,o,n){super(t,e,o,n,Ns)}}yo(ll,nl),yo(ll,rl);var al=ll;class hl extends Fr{constructor(t,e,o,n){super(t,e,Ns,o,n)}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new al(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:t}=this.wot;if(!this.needFullRender||!t.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,o=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer!==e||n&&"horizontal"===n?(i=this.getScrollPosition(),Xe(o)):(i=this.getOverlayOffset()*(this.isRtl()?-1:1),Ye(o,`${i}px`,"0px"));const s=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),s}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let o=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,be(e)),o=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(t,e){const o=this.wtSettings.getSetting("defaultColumnWidth");let n=t,i=0;while(n<e)i+=this.wot.wtTable.getStretchedColumnWidth(n)||o,n+=1;return i}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:o}=this.domBindings,n=Ue(e),i=this.clone.wtTable.holder.parentNode,s=i.style,r=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"vertical"===r){let e=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(e-=n),e=Math.min(e,t.wtRootElement.scrollHeight),s.height=`${e}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=ke(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(Wr.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+e}px`}applyToDOM(){const t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[e]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(t,e){let o=this.getTableParentOffset();const n=this.wot.cloneSource?this.wot.cloneSource:this.wot,i=n.wtTable.holder;let s=0;if(e){const o=this.wot.wtTable.getColumnWidth(t),n=this.wot.wtViewport.getViewportWidth();o>n&&(e=!1)}return e&&i.offsetWidth!==i.clientWidth&&(s=Ue(this.domBindings.rootDocument)),e?(o+=this.sumCellSizes(0,t+1),o-=this.wot.wtViewport.getViewportWidth()):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),o+=s,this.setScrollPosition(o)}getTableParentOffset(){const t=this.wtSettings.getSetting("preventOverflow");let e=0;return t||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs(Me(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let o=0;if(this.trimmingContainer===t&&(!e||"horizontal"!==e)){o=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const t=this.wot.wtTable.getTotalWidth(),e=this.clone.wtTable.getTotalWidth(),n=t-e;o>n&&(o=0)}return o}adjustHeaderBordersPosition(t){const e=this.wot.wtTable.holder.parentNode,o=this.wtSettings.getSetting("rowHeaders"),n=this.wtSettings.getSetting("fixedColumnsStart"),i=this.wtSettings.getSetting("totalRows");i?ue(e,"emptyRows"):de(e,"emptyRows");let s=!1;if(n&&!o.length)de(e,"innerBorderLeft innerBorderInlineStart");else if(!n&&o.length){const o=ce(e,"innerBorderInlineStart");t?(de(e,"innerBorderLeft innerBorderInlineStart"),s=!o):(ue(e,"innerBorderLeft innerBorderInlineStart"),s=o)}return s}}class cl extends zs{constructor(t,e,o,n){super(t,e,o,n,_s)}}yo(cl,Gs),yo(cl,rl);var dl=cl;function ul(t,e,o){return e=gl(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function gl(t){var e=fl(t,"string");return"symbol"===typeof e?e:String(e)}function fl(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class ml extends Fr{constructor(t,e,o,n,i,s){super(t,e,_s,o,n),ul(this,"topOverlay",void 0),ul(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=s}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new dl(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const e=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Ye(t,`${e}px`,`${o}px`)}else Xe(t);let e=Oe(this.clone.wtTable.TABLE);const o=ke(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(e=0),t.style.height=`${e}px`,t.style.width=`${o}px`,!1}}class pl extends zs{constructor(t,e,o,n){super(t,e,o,n,Ds)}}yo(pl,Kr),yo(pl,rl);var wl=pl;class Cl extends Fr{constructor(t,e,o,n,i,s){super(t,e,Ds,o,n),this.bottomOverlay=i,this.inlineStartOverlay=s}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new wl(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:t}=this;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const t=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]=`${t}px`,e.style.bottom=`${o}px`}else Xe(e),this.repositionOverlay();let o=Oe(this.clone.wtTable.TABLE);const n=ke(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(o=0),e.style.height=`${o}px`,e.style.width=`${n}px`,!1}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:o}=this.domBindings,n=this.clone.wtTable.holder.parentNode;let i=0;e.hasVerticalScroll()||(i+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(i+=Ue(o)),n.style.bottom=`${i}px`}}function vl(t,e,o){return e=yl(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function yl(t){var e=Sl(t,"string");return"symbol"===typeof e?e:String(e)}function Sl(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class bl{constructor(t,e,o,n,i,s){vl(this,"wot",null),vl(this,"topOverlay",null),vl(this,"bottomOverlay",null),vl(this,"inlineStartOverlay",null),vl(this,"topInlineStartCornerOverlay",null),vl(this,"bottomInlineStartCornerOverlay",null),vl(this,"browserLineHeight",void 0),vl(this,"wtSettings",null),vl(this,"resizeObserver",new ResizeObserver((t=>{es((()=>{Array.isArray(t)&&t.length&&this.wtSettings.getSetting("onContainerElementResize")}))}))),this.wot=t,this.wtSettings=n,this.domBindings=o,this.facadeGetter=e,this.wtTable=s;const{rootDocument:r,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=Ue(r);const a="hidden"===l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=a?s.holder:Te(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return t&&e.push(this.wtTable),e}initBrowserLineHeight(){const{rootWindow:t,rootDocument:e}=this.domBindings,o=t.getComputedStyle(e.body),n=parseInt(o.lineHeight,10),i=1.2*parseInt(o.fontSize,10);this.browserLineHeight=n||i}initOverlays(){const t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new $r(...t),this.bottomOverlay=new tl(...t),this.inlineStartOverlay=new hl(...t),this.topInlineStartCornerOverlay=new ml(...t,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new Cl(...t,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let t=this.topOverlay.updateStateOfRendering();return t=this.bottomOverlay.updateStateOfRendering()||t,t=this.inlineStartOverlay.updateStateOfRendering()||t,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(t=this.topInlineStartCornerOverlay.updateStateOfRendering()||t),this.bottomOverlay.needFullRender&&(t=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||t)),t}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument:t,rootWindow:e}=this.domBindings,{mainTableScrollableElement:o}=this.topOverlay,{mainTableScrollableElement:n}=this.inlineStartOverlay;this.eventManager.addEventListener(t.documentElement,"keydown",(t=>this.onKeyDown(t))),this.eventManager.addEventListener(t.documentElement,"keyup",(()=>this.onKeyUp())),this.eventManager.addEventListener(t,"visibilitychange",(()=>this.onKeyUp())),this.eventManager.addEventListener(o,"scroll",(t=>this.onTableScroll(t)),{passive:!0}),o!==n&&this.eventManager.addEventListener(n,"scroll",(t=>this.onTableScroll(t)),{passive:!0});const i=e.devicePixelRatio&&e.devicePixelRatio>1,s=this.scrollableElement===e,r=this.wtSettings.getSetting("preventWheel"),l={passive:s};(r||i||!_o())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(t=>this.onCloneWheel(t,r)),l);const a=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let h;a.forEach((t=>{if(t&&t.needFullRender){const{holder:e}=t.clone.wtTable;this.eventManager.addEventListener(e,"wheel",(t=>this.onCloneWheel(t,r)),l)}})),this.eventManager.addEventListener(e,"resize",(()=>{clearTimeout(h),h=setTimeout((()=>{this.wtSettings.getSetting("onWindowResize")}),200)})),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(t){const e=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,i=t.target;this.keyPressed&&(n!==e&&i!==e&&!t.target.contains(n)||o!==e&&i!==e&&!t.target.contains(o))||this.syncScrollPositions(t)}onCloneWheel(t,e){const{rootWindow:o}=this.domBindings,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=t.target,r=i!==o&&s!==o&&!s.contains(i),l=n!==o&&s!==o&&!s.contains(n);if(this.keyPressed&&(r||l))return;const a=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==o&&a)&&t.preventDefault()}onKeyDown(t){this.keyPressed=tn(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(t){let e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,o=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(o+=o*this.browserLineHeight,e+=e*this.browserLineHeight);const n=this.scrollVertically(e),i=this.scrollHorizontally(o);return n||i}scrollVertically(t){const e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}scrollHorizontally(t){const e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:t}=this.domBindings,e=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,[n,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=e.scrollLeft!==n||this.lastScrollX!==t.scrollX,this.verticalScrolling=o.scrollTop!==i||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=n;const t=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;t&&(t.scrollLeft=n)}this.verticalScrolling&&(o.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){const t=this.topOverlay.mainTableScrollableElement,{scrollLeft:e,scrollTop:o}=t;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:t}=this,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=Te(t.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.updateLastSpreaderSize();e&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}updateLastSpreaderSize(){const t=this.wtTable.spreader,e=t.clientWidth,o=t.clientHeight,n=e!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return n&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=o),n}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtViewport:e}=this.wot,{wtTable:o}=this,n=this.wtSettings.getSetting("totalColumns"),i=this.wtSettings.getSetting("totalRows"),s=e.getRowHeaderWidth(),r=e.getColumnHeaderHeight(),l=o.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,n)}px`,l.height=`${r+this.topOverlay.sumCellSizes(0,i)+1}px`,this.scrollbarSize>0){const{scrollHeight:t,scrollWidth:e}=o.wtRootElement,{scrollHeight:n,scrollWidth:i}=o.holder;this.hasScrollbarRight=t<n,this.hasScrollbarBottom=e<i,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>e?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>t&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.inlineStartOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(t){if(!t)return null;const e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let o=null;return k(e,(e=>{e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(o=e.clone)})),o}syncOverlayTableClassNames(){const t=this.wtTable.TABLE,e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];k(e,(e=>{e&&(e.clone.wtTable.TABLE.className=t.className)}))}}var Rl=bl;function El(t,e,o){return e=Ml(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ml(t){var e=Tl(t,"string");return"symbol"===typeof e?e:String(e)}function Tl(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Hl{constructor(t){El(this,"settings",{}),El(this,"defaults",Object.freeze(this.getDefaults())),Eo(this.defaults,((e,o)=>{if(void 0!==t[o])this.settings[o]=t[o];else{if(void 0===e)throw new Error(`A required setting "${o}" was not provided`);this.settings[o]=e}}))}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(t,e,o)=>{const n=this.getSetting("data",t,e);ve(o,void 0===n||null===n?"":n)},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:t=>t,onBeforeViewportScrollVertically:t=>t,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:t=>t,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:t=>t,onBeforeHighlightingColumnHeader:t=>t,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(t,e){return void 0===e?Eo(t,((t,e)=>{this.settings[e]=t})):this.settings[t]=e,this}getSetting(t,e,o,n,i){return"function"===typeof this.settings[t]?this.settings[t](e,o,n,i):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}getSettingPure(t){return this.settings[t]}has(t){return!!this.settings[t]}}class xl extends zs{constructor(t,e,o,n){super(t,e,o,n,"master")}alignOverlaysWithTrimmingContainer(){const t=He(this.wtRootElement),{rootWindow:e}=this.domBindings;if(t===e){const t=this.wtSettings.getSetting("preventOverflow");t||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{const o=t.parentElement,n=xe(t,"height",e),i=xe(t,"overflow",e),s=this.holder.style,{scrollWidth:r,scrollHeight:l}=t;let a=t.offsetWidth,h=t.offsetHeight;const c=["auto","hidden","scroll"];if(o&&c.includes(i)){const n=t.cloneNode(!1);n.style.overflow="auto",n.style.position="absolute",t.nextElementSibling?o.insertBefore(n,t.nextElementSibling):o.appendChild(n);const i=parseInt(Ae(n,e).height,10);o.removeChild(n),0===i&&(h=0)}h=Math.min(h,l),s.height="auto"===n?"auto":`${h}px`,a=Math.min(a,r),s.width=`${a}px`,s.overflow="",this.hasTableHeight="auto"===s.height||h>0,this.hasTableWidth=a>0}this.isTableVisible=ye(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject,o="master",n=t.getSetting("columnHeaders"),i=n.length;if(i&&!e.hasOversizedColumnHeadersMarked[o]){const n=t.getSetting("rowHeaders"),s=n.length,r=this.getRenderedColumnsCount();for(let t=0;t<i;t++)for(let e=-1*s;e<r;e++)this.markIfOversizedColumnHeader(e);e.hasOversizedColumnHeadersMarked[o]=!0}}}yo(xl,nl),yo(xl,Xs);var Il=xl;const Al=1,kl=2;o(2585);const Ol=new WeakMap;class Pl{static get DEFAULT_HEIGHT(){return 23}constructor(){let{viewportSize:t,scrollOffset:e,totalItems:o,itemSizeFn:n,overrideFn:i,calculationType:s,scrollbarHeight:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ol.set(this,{viewportHeight:t,scrollOffset:e,totalRows:o,rowHeightFn:n,overrideFn:i,calculationType:s,horizontalScrollbarHeight:r}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}calculate(){const t=Ol.get(this),e=t.calculationType,o=t.overrideFn,n=t.rowHeightFn,i=t.scrollOffset,s=Math.max(t.scrollOffset,0),r=t.totalRows,l=t.viewportHeight,a=t.horizontalScrollbarHeight||0;let h=0,c=!0;const d=[];let u,g=0,f=0;for(let C=0;C<r;C++)if(u=n(C),isNaN(u)&&(u=Pl.DEFAULT_HEIGHT),h<=s&&e!==kl&&(this.startRow=C,g=u),h>=s&&h+(e===kl?u:0)<=s+l-a&&(null===this.startRow&&(this.startRow=C,g=u),this.endRow=C),d.push(h),h+=u,f=u,e!==kl&&(this.endRow=C),h>=s+l-a){c=!1;break}const m=i+l-a,p=e===kl?g:0,w=e===kl?0:f;if(m<p||i>d.at(-1)+w?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===r-1&&c){this.startRow=this.endRow;while(this.startRow>0){const t=d[this.endRow]+u-d[this.startRow-1];if((t<=l-a||e!==kl)&&(this.startRow-=1),t>=l-a)break}}e===Al&&null!==this.startRow&&o&&o(this),this.startPosition=d[this.startRow],void 0===this.startPosition&&(this.startPosition=null),r<this.endRow&&(this.endRow=r-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}var Nl=Pl;const _l=new WeakMap;class Dl{static get DEFAULT_WIDTH(){return 50}constructor(){let{viewportSize:t,scrollOffset:e,totalItems:o,itemSizeFn:n,overrideFn:i,calculationType:s,stretchMode:r,stretchingItemWidthFn:l=(t=>t),inlineStartOffset:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_l.set(this,{viewportWidth:t,scrollOffset:e,totalColumns:o,columnWidthFn:n,overrideFn:i,calculationType:s,stretchingColumnWidthFn:l,inlineStartOffset:a}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=r,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}calculate(){let t=0,e=!0;const o=[];let n,i=0,s=0;const r=_l.get(this),l=r.calculationType,a=r.overrideFn,h=r.scrollOffset,c=Math.max(r.scrollOffset,0),d=r.totalColumns,u=r.viewportWidth,g=c>0?u+1:u;for(let w=0;w<d;w++)if(n=this._getColumnWidth(w),t<=c&&l!==kl&&(this.startColumn=w,i=n),t>=c&&t+(l===kl?n:0)<=c+g&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=w,i=n),this.endColumn=w),o.push(t),t+=n,s=n,l!==kl&&(this.endColumn=w),t>=c+u){e=!1;break}const f=h+u-g,m=l===kl?0:s,p=l===kl?i:0;if(f<-1*r.inlineStartOffset||h>o.at(-1)+m||-1*r.scrollOffset-r.viewportWidth>-1*p?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&e){this.startColumn=this.endColumn;while(this.startColumn>0){const t=o[this.endColumn]+n-o[this.startColumn-1];if((t<=u||l!==kl)&&(this.startColumn-=1),t>u)break}}l===Al&&null!==this.startColumn&&a&&a(this),this.startPosition=o[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(t){if("none"===this.stretch)return;let e=t;this.totalTargetWidth=e;const o=_l.get(this),n=o.totalColumns;let i=0;for(let r=0;r<n;r++){const t=this._getColumnWidth(r),n=o.stretchingColumnWidthFn(void 0,r);"number"===typeof n?e-=n:i+=t}const s=e-i;if("all"===this.stretch&&s>0)this.stretchAllRatio=e/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&e!==1/0){const t=this._getColumnWidth(n-1),e=s+t;this.stretchLastWidth=e>=0?e:t}}getStretchedColumnWidth(t,e){let o=null;return"all"===this.stretch&&0!==this.stretchAllRatio?o=this._getStretchedAllColumnWidth(t,e):"last"===this.stretch&&0!==this.stretchLastWidth&&(o=this._getStretchedLastColumnWidth(t)),o}_getStretchedAllColumnWidth(t,e){let o=0;const n=_l.get(this),i=n.totalColumns;if(!this.stretchAllColumnsWidth[t]){const o=Math.round(e*this.stretchAllRatio),i=n.stretchingColumnWidthFn(o,t);this.stretchAllColumnsWidth[t]=void 0===i?o:isNaN(i)?this._getColumnWidth(t):i}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let t=0;t<this.stretchAllColumnsWidth.length;t++)o+=this.stretchAllColumnsWidth[t];o!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-o)}return this.stretchAllColumnsWidth[t]}_getStretchedLastColumnWidth(t){const e=_l.get(this),o=e.totalColumns;return t===o-1?this.stretchLastWidth:null}_getColumnWidth(t){let e=_l.get(this).columnWidthFn(t);return isNaN(e)&&(e=Dl.DEFAULT_WIDTH),e}}var Ll=Dl;class Vl{constructor(t,e,o,n,i){this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=e,this.wtSettings=o,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=n,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(()=>{this.clientHeight=this.getWorkspaceHeight()}))}getWorkspaceHeight(){const t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer;let o=0;if(e===this.domBindings.rootWindow)o=t.documentElement.clientHeight;else{const t=Oe(e);o=t>0&&e.clientHeight>0?e.clientHeight:1/0}return o}getWorkspaceWidth(){const{wtSettings:t}=this,{rootDocument:e,rootWindow:o}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i=e.documentElement.offsetWidth,s=t.getSetting("totalColumns"),r=t.getSetting("preventOverflow"),l=t.getSetting("rtlMode"),a=this.wtTable.TABLE.getBoundingClientRect(),h=l?a.right-i:a.left,c=i-h;let d,u;if(r)return ke(this.wtTable.wtRootElement);if(d=t.getSetting("freezeOverlays")?Math.min(c,i):Math.min(this.getContainerFillWidth(),c,i),n===o&&s>0&&this.sumColumnWidths(0,s-1)>d)return e.documentElement.clientWidth;if(n!==o&&(u=xe(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o),"scroll"===u||"hidden"===u||"auto"===u))return Math.max(d,n.clientWidth);const g=t.getSetting("stretchH");return"none"!==g&&g?d:Math.max(d,ke(this.wtTable.TABLE))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(t,e){let o=0,n=t;while(n<e)o+=this.wtTable.getColumnWidth(n),n+=1;return o}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);const o=e.offsetWidth;return this.containerWidth=o,t.removeChild(e),o}getWorkspaceOffset(){return Se(this.wtTable.TABLE)}getColumnHeaderHeight(){const t=this.wtSettings.getSetting("columnHeaders");return t.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Oe(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let t=this.getWorkspaceHeight();if(t===1/0)return t;const e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}getRowHeaderWidth(){const t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(let o=0,n=e.length;o<n;o++)this.rowHeaderWidth+=t[o]||t}if(isNaN(this.rowHeaderWidth))if(e.length){let t=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let o=0,n=e.length;o<n;o++)t?(this.rowHeaderWidth+=ke(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const t=this.getWorkspaceWidth();if(t===1/0)return t;const e=this.getRowHeaderWidth();return e>0?t-e:t}createRowsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Al;const{wtSettings:e,wtTable:o}=this;let n,i,s;this.rowHeaderWidth=NaN,n=e.getSetting("renderAllRows")&&t===Al?1/0:this.getViewportHeight();let r=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=e.getSetting("fixedRowsTop"),a=e.getSetting("fixedRowsBottom"),h=e.getSetting("totalRows");return l&&r>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),r+=s,n-=s),a&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(h-a,h),n-=s),i=o.holder.clientHeight===o.holder.offsetHeight?0:Ue(this.domBindings.rootDocument),new Nl({viewportSize:n,scrollOffset:r,totalItems:e.getSetting("totalRows"),itemSizeFn:t=>o.getRowHeight(t),overrideFn:e.getSettingPure("viewportRowCalculatorOverride"),calculationType:t,scrollbarHeight:i})}createColumnsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Al;const{wtSettings:e,wtTable:o}=this;let n=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=e.getSetting("fixedColumnsStart");if(s&&i>=0){const t=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);i+=t,n-=t}return o.holder.clientWidth!==o.holder.offsetWidth&&(n-=Ue(this.domBindings.rootDocument)),new Ll({viewportSize:n,scrollOffset:i,totalItems:e.getSetting("totalColumns"),itemSizeFn:t=>o.getColumnWidth(t),overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),calculationType:t,stretchMode:e.getSetting("stretchH"),stretchingItemWidthFn:(t,o)=>e.getSetting("onBeforeStretchingColumnWidth",t,o),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=t;if(e){const t=this.createRowsCalculator(kl),o=this.createColumnsCalculator(kl);this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(Al),this.columnsRenderCalculator=this.createColumnsCalculator(Al)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(kl),this.columnsVisibleCalculator=this.createColumnsCalculator(kl)}areAllProposedVisibleRowsAlreadyRendered(t){if(!this.rowsVisibleCalculator)return!1;const{startRow:e,endRow:o,isVisibleInTrimmingContainer:n}=t;if(null===e&&null===o)return!n;const{startRow:i,endRow:s}=this.rowsRenderCalculator;return!(e<i||e===i&&e>0)&&!(o>s||o===s&&o<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(t){if(!this.columnsVisibleCalculator)return!1;const{startColumn:e,endColumn:o,isVisibleInTrimmingContainer:n}=t;if(null===e&&null===o)return!n;const{startColumn:i,endColumn:s}=this.columnsRenderCalculator;return!(e<i||e===i&&e>0)&&!(o>s||o===s&&o<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Eo(this.hasOversizedColumnHeadersMarked,((t,e,o)=>{o[e]=void 0}))}}var Bl=Vl;o(3599);function Fl(t,e){jl(t,e),e.add(t)}function Wl(t,e,o){jl(t,e),e.set(t,o)}function jl(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zl(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function Ul(t,e){var o=Yl(t,e,"get");return $l(t,o)}function $l(t,e){return e.get?e.get.call(t):e.value}function Gl(t,e,o){var n=Yl(t,e,"set");return Kl(t,n,o),o}function Yl(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Kl(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var Xl=new WeakMap,ql=new WeakMap,Ql=new WeakSet;class Jl{constructor(){Fl(this,Ql),Wl(this,Xl,{writable:!0,value:void 0}),Wl(this,ql,{writable:!0,value:void 0})}setActiveOverlay(t){return Gl(this,ql,t),this}setActiveSelection(t){return Gl(this,Xl,t),this}scan(){const t=Ul(this,Xl).settings.selectionType,e=new Set;return"active-header"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t)))):"area"===t?this.scanCellsRange((t=>e.add(t))):"focus"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t))),this.scanCellsRange((t=>e.add(t)))):"fill"===t?this.scanCellsRange((t=>e.add(t))):"header"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t)))):"row"===t?(this.scanRowsInHeadersRange((t=>e.add(t))),this.scanRowsInCellsRange((t=>e.add(t)))):"column"===t&&(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanColumnsInCellsRange((t=>e.add(t)))),e}scanColumnsInHeadersRange(t){const[e,o,n,i]=Ul(this,Xl).getCorners(),{wtTable:s}=Ul(this,ql),r=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let a=0;for(let h=-s.getRowHeadersCount();h<r;h++){const r=s.columnFilter.renderedToSource(h);if(!(r<o||r>i)){for(let h=-l;h<0;h++){if(h<e||h>n)continue;const c=h+l;let d=s.getColumnHeader(r,c);const u=Ul(this,ql).getSetting("onBeforeHighlightingColumnHeader",r,c,{selectionType:Ul(this,Xl).settings.selectionType,columnCursor:a,selectionWidth:i-o+1});null!==u&&(u!==r&&(d=s.getColumnHeader(u,c)),t(d))}a+=1}}}scanRowsInHeadersRange(t){const[e,o,n,i]=Ul(this,Xl).getCorners(),{wtTable:s}=Ul(this,ql),r=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let a=0;for(let h=-s.getColumnHeadersCount();h<r;h++){const r=s.rowFilter.renderedToSource(h);if(!(r<e||r>n)){for(let h=-l;h<0;h++){if(h<o||h>i)continue;const c=h+l;let d=s.getRowHeader(r,c);const u=Ul(this,ql).getSetting("onBeforeHighlightingRowHeader",r,c,{selectionType:Ul(this,Xl).settings.selectionType,rowCursor:a,selectionHeight:n-e+1});null!==u&&(u!==r&&(d=s.getRowHeader(u,c)),t(d))}a+=1}}}scanCellsRange(t){const[e,o,n,i]=Ul(this,Xl).getCorners(),{wtTable:s}=Ul(this,ql);zl(this,Ql,Zl).call(this,((r,l)=>{if(r>=e&&r<=n&&l>=o&&l<=i){const e=s.getCell(Ul(this,ql).createCellCoords(r,l)),o=Ul(this,ql).getSetting("onAfterDrawSelection",r,l,Ul(this,Xl).settings.layerLevel);"string"===typeof o&&de(e,o),t(e)}}))}scanRowsInCellsRange(t){const[e,,o]=Ul(this,Xl).getCorners(),{wtTable:n}=Ul(this,ql);zl(this,Ql,Zl).call(this,((i,s)=>{if(i>=e&&i<=o){const e=n.getCell(Ul(this,ql).createCellCoords(i,s));t(e)}}))}scanColumnsInCellsRange(t){const[,e,,o]=Ul(this,Xl).getCorners(),{wtTable:n}=Ul(this,ql);zl(this,Ql,Zl).call(this,((i,s)=>{if(s>=e&&s<=o){const e=n.getCell(Ul(this,ql).createCellCoords(i,s));t(e)}}))}}function Zl(t){const{wtTable:e}=Ul(this,ql),o=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<o;i+=1){const o=e.rowFilter.renderedToSource(i);for(let i=0;i<n;i+=1)t(o,e.columnFilter.renderedToSource(i))}}class ta{constructor(t,e){e&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Wr,this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners())}registerListeners(){const t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(()=>this.onMouseDown())),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp()));for(let e=0,o=this.main.childNodes.length;e<o;e++){const t=this.main.childNodes[e];this.eventManager.addEventListener(t,"mouseenter",(t=>this.onMouseEnter(t,this.main.childNodes[e])))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(t,e){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;t.preventDefault(),en(t);const o=this,n=this.wot.rootDocument.body,i=e.getBoundingClientRect();function s(t){return t.clientY<Math.floor(i.top)||(t.clientY>Math.ceil(i.top+i.height)||(t.clientX<Math.floor(i.left)||(t.clientX>Math.ceil(i.left+i.width)||void 0)))}function r(t){s(t)&&(o.eventManager.removeEventListener(n,"mousemove",r),e.style.display="block")}e.style.display="none",this.eventManager.addEventListener(n,"mousemove",r)}createBorders(t){const{rootDocument:e}=this.wot;this.main=e.createElement("div");const o=["top","start","bottom","end","corner"];let n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(let r=0;r<5;r++){const i=o[r],s=e.createElement("div");s.className=`wtBorder ${this.settings.className||""}`,this.settings[i]&&this.settings[i].hide&&(s.className+=" hidden"),n=s.style,n.backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:t.border.color,n.height=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${t.border.width}px`,n.width=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${t.border.width}px`,this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),jo()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let s=i.bordersHolder;s||(s=e.createElement("div"),s.className="htBorders",i.bordersHolder=s,i.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:t}=this.wot;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")};const e=10,o=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const n={position:"absolute",height:`${o}px`,width:`${o}px`,"border-radius":`${parseInt(o/1.5,10)}px`};Eo(n,((t,e)=>{this.selectionHandles.styles.bottomHitArea[e]=t,this.selectionHandles.styles.topHitArea[e]=t}));const i={position:"absolute",height:`${e}px`,width:`${e}px`,"border-radius":`${parseInt(e/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Eo(i,((t,e)=>{this.selectionHandles.styles.bottom[e]=t,this.selectionHandles.styles.top[e]=t})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(t,e){const o=this.wot.selectionManager.getAreaSelection();return!(!o.cellRange||t===o.cellRange.to.row&&e===o.cellRange.to.col)}updateMultipleSelectionHandlesPosition(t,e,o,n,i,s){const r=this.wot.wtSettings.getSetting("rtlMode"),l=r?"right":"left",{top:a,topHitArea:h,bottom:c,bottomHitArea:d}=this.selectionHandles.styles,u=parseInt(a.borderWidth,10),g=parseInt(a.width,10),f=parseInt(h.width,10),m=this.wot.wtTable.getWidth(),p=this.wot.wtTable.getHeight();a.top=`${parseInt(o-g-1,10)}px`,a[l]=`${parseInt(n-g-1,10)}px`,h.top=`${parseInt(o-f/4*3,10)}px`,h[l]=`${parseInt(n-f/4*3,10)}px`;const w=Math.min(parseInt(n+i,10),m-g-2*u),C=Math.min(parseInt(n+i-f/4,10),m-f-2*u);c[l]=`${w}px`,d[l]=`${C}px`;const v=Math.min(parseInt(o+s,10),p-g-2*u),y=Math.min(parseInt(o+s-f/4,10),p-f-2*u);c.top=`${v}px`,d.top=`${y}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(a.display="block",h.display="block",this.isPartRange(t,e)?(c.display="none",d.display="none"):(c.display="block",d.display="block")):(a.display="none",c.display="none",h.display="none",d.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(a.zIndex="9999",h.zIndex="9999"):(a.zIndex="",h.zIndex="")}appear(t){if(this.disabled)return;const{wtTable:e,rootDocument:o,rootWindow:n}=this.wot;let i,s,r,l,a,h;const c=e.getRenderedRowsCount();for(let P=0;P<c;P+=1){const o=e.rowFilter.renderedToSource(P);if(o>=t[0]&&o<=t[2]){i=o,a=t[0];break}}for(let P=c-1;P>=0;P-=1){const o=e.rowFilter.renderedToSource(P);if(o>=t[0]&&o<=t[2]){s=o;break}}const d=e.getRenderedColumnsCount();for(let P=0;P<d;P+=1){const o=e.columnFilter.renderedToSource(P);if(o>=t[1]&&o<=t[3]){r=o,h=t[1];break}}for(let P=d-1;P>=0;P-=1){const o=e.columnFilter.renderedToSource(P);if(o>=t[1]&&o<=t[3]){l=o;break}}if(void 0===i||void 0===r)return void this.disappear();let u=e.getCell(this.wot.createCellCoords(i,r));const g=i!==s||r!==l,f=g?e.getCell(this.wot.createCellCoords(s,l)):u,m=Se(u),p=g?Se(f):m,w=Se(e.TABLE),C=ke(e.TABLE),v=m.top,y=m.left,S=this.wot.wtSettings.getSetting("rtlMode");let b=0,R=0;if(S){const t=ke(u),e=n.innerWidth-w.left-C;R=y+t-p.left,b=n.innerWidth-y-t-e-1}else R=p.left+ke(f)-y,b=y-w.left-1;if(this.isEntireColumnSelected(i,s)){const t=this.getDimensionsFromHeader("columns",r,l,a,w);let e=null;t&&([e,b,R]=t),e&&(u=e)}let E=v-w.top-1,M=p.top+Oe(f)-v;if(this.isEntireRowSelected(r,l)){const t=this.getDimensionsFromHeader("rows",i,s,h,w);let e=null;t&&([e,E,M]=t),e&&(u=e)}const T=Ae(u,n);parseInt(T.borderTopWidth,10)>0&&(E+=1,M=M>0?M-1:0),parseInt(T[S?"borderRightWidth":"borderLeftWidth"],10)>0&&(b+=1,R=R>0?R-1:0);const H=S?"right":"left";this.topStyle.top=`${E}px`,this.topStyle[H]=`${b}px`,this.topStyle.width=`${R}px`,this.topStyle.display="block",this.startStyle.top=`${E}px`,this.startStyle[H]=`${b}px`,this.startStyle.height=`${M}px`,this.startStyle.display="block";const x=Math.floor(this.settings.border.width/2);this.bottomStyle.top=E+M-x+"px",this.bottomStyle[H]=`${b}px`,this.bottomStyle.width=`${R}px`,this.bottomStyle.display="block",this.endStyle.top=`${E}px`,this.endStyle[H]=b+R-x+"px",this.endStyle.height=`${M+1}px`,this.endStyle.display="block";let I=this.settings.border.cornerVisible;I="function"===typeof I?I(this.settings.layerLevel):I;const A=this.wot.getSetting("onModifyGetCellCoords",s,l);let[k,O]=[s,l];if(A&&Array.isArray(A)&&([,,k,O]=A),jo()||!I||this.isPartRange(k,O))this.cornerStyle.display="none";else{this.cornerStyle.top=E+M+this.cornerCenterPointOffset-1+"px",this.cornerStyle[H]=b+R+this.cornerCenterPointOffset-1+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let t=He(e.TABLE);const i=t===n;i&&(t=o.documentElement);const r=parseInt(this.cornerDefaultStyle.width,10)/2,a=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const e=i?f.getBoundingClientRect().left:f.offsetLeft;let o=!1,n=0;S?(n=e-parseInt(this.cornerDefaultStyle.width,10)/2,o=n<0):(n=e+ke(f)+parseInt(this.cornerDefaultStyle.width,10)/2,o=n>=Ne(t)),o&&(this.cornerStyle[H]=`${Math.floor(b+R+this.cornerCenterPointOffset-r)}px`,this.cornerStyle[S?"borderLeftWidth":"borderRightWidth"]=0)}if(s===this.wot.getSetting("totalRows")-1){const e=i?f.getBoundingClientRect().top:f.offsetTop,o=e+Oe(f)+parseInt(this.cornerDefaultStyle.height,10)/2,n=o>=Pe(t);n&&(this.cornerStyle.top=`${Math.floor(E+M+this.cornerCenterPointOffset-a)}px`,this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}jo()&&this.updateMultipleSelectionHandlesPosition(s,l,E,b,R,M)}isEntireColumnSelected(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(t,e,o,n,i){const{wtTable:s}=this.wot,r=s.wtRootElement.parentNode;let l=null,a=null,h=null,c=null,d=null,u=null,g=null,f=null;switch(t){case"rows":l=function(){return s.getRowHeader(...arguments)},a=function(){return Oe(...arguments)},h="ht__selection--rows",u="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},a=function(){return ke(...arguments)},h="ht__selection--columns",u="left";break;default:}if(r.classList.contains(h)){const t=this.wot.getSetting("columnHeaders").length;if(g=l(e,t-n),f=l(o,t-n),!g||!f)return!1;const s=Se(g),r=Se(f);return g&&f&&(c=s[u]-i[u]-1,d=r[u]+a(f)-s[u]),[g,c,d]}return!1}changeBorderStyle(t,e){const o=this[t].style,n=e[t];!n||n.hide?de(this[t],"hidden"):(ce(this[t],"hidden")&&ue(this[t],"hidden"),o.backgroundColor=n.color,"top"!==t&&"bottom"!==t||(o.height=`${n.width}px`),"start"!==t&&"end"!==t||(o.width=`${n.width}px`))}changeBorderToDefaultStyle(t){const e={width:1,color:"#000"},o=this[t].style;o.backgroundColor=e.color,o.width=`${e.width}px`,o.height=`${e.width}px`}toggleHiddenClass(t,e){this.changeBorderToDefaultStyle(t),e?de(this[t],"hidden"):ue(this[t],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",jo()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}var ea=ta;function oa(t,e){ia(t,e),e.add(t)}function na(t,e,o){ia(t,e),e.set(t,o)}function ia(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sa(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function ra(t,e){var o=ha(t,e,"get");return la(t,o)}function la(t,e){return e.get?e.get.call(t):e.value}function aa(t,e,o){var n=ha(t,e,"set");return ca(t,n,o),o}function ha(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function ca(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var da=new WeakMap,ua=new WeakMap,ga=new WeakMap,fa=new WeakMap,ma=new WeakMap,pa=new WeakMap,wa=new WeakSet;class Ca{constructor(t){oa(this,wa),na(this,da,{writable:!0,value:void 0}),na(this,ua,{writable:!0,value:void 0}),na(this,ga,{writable:!0,value:new Jl}),na(this,fa,{writable:!0,value:new WeakMap}),na(this,ma,{writable:!0,value:new WeakSet}),na(this,pa,{writable:!0,value:new Map}),aa(this,ua,t)}setActiveOverlay(t){return aa(this,da,t),ra(this,ga).setActiveOverlay(ra(this,da)),ra(this,fa).has(ra(this,da))||ra(this,fa).set(ra(this,da),new Set),this}getFocusSelection(){return null!==ra(this,ua)?ra(this,ua).getFocus():null}getAreaSelection(){return null!==ra(this,ua)?ra(this,ua).createLayeredArea():null}getBorderInstance(t){if(!t.settings.border)return null;if(ra(this,pa).has(t)){const e=ra(this,pa).get(t);if(e.has(ra(this,da)))return e.get(ra(this,da));const o=new ea(ra(this,da),t.settings);return e.set(ra(this,da),o),o}const e=new ea(ra(this,da),t.settings);return ra(this,pa).set(t,new Map([[ra(this,da),e]])),e}getBorderInstances(t){var e,o;return Array.from(null!==(e=null===(o=ra(this,pa).get(t))||void 0===o?void 0:o.values())&&void 0!==e?e:[])}destroyBorders(t){ra(this,pa).get(t).forEach((t=>t.destroy())),ra(this,pa).delete(t)}render(t){if(null===ra(this,ua))return;t&&sa(this,wa,va).call(this);const e=Array.from(ra(this,ua)),o=new Map;for(let n=0;n<e.length;n++){const t=e[n],{className:i,createLayers:s,selectionType:r}=t.settings;ra(this,ma).has(t)||(ra(this,ma).add(t),t.addLocalHook("destroy",(()=>this.destroyBorders(t))));const l=this.getBorderInstance(t);if(t.isEmpty()){null===l||void 0===l||l.disappear();continue}if(i){const e=ra(this,ga).setActiveSelection(t).scan();e.forEach((t=>{if(o.has(t)){const e=o.get(t);e.has(i)&&!0===s?e.set(i,e.get(i)+1):e.set(i,1)}else o.set(t,new Map([[i,1]]))}))}const a=t.getCorners();ra(this,da).getSetting("onBeforeDrawBorders",a,r),null===l||void 0===l||l.appear(a)}o.forEach(((t,e)=>{var o,n;const i=Array.from(t).map((t=>{let[e,o]=t;return 1===o?e:[e,...Array.from({length:o-1},((t,o)=>`${e}-${o+1}`))]})).flat();i.forEach((t=>ra(this,fa).get(ra(this,da)).add(t))),de(e,i),"TD"===e.nodeName&&Array.isArray(null===(o=ra(this,ua).options)||void 0===o?void 0:o.cellAttributes)?ge(e,ra(this,ua).options.cellAttributes):"TH"===e.nodeName&&Array.isArray(null===(n=ra(this,ua).options)||void 0===n?void 0:n.headerAttributes)&&ge(e,ra(this,ua).options.headerAttributes)}))}}function va(){const t=ra(this,fa).get(ra(this,da)),e=ra(this,da).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let o=0;o<e.length;o++)t.add(e[o]);t.forEach((t=>{var e,o;const n=ra(this,da).wtTable.TABLE.querySelectorAll(`.${t}`);let i=[];Array.isArray(null===(e=ra(this,ua).options)||void 0===e?void 0:e.cellAttributes)&&(i=ra(this,ua).options.cellAttributes.map((t=>t[0]))),Array.isArray(null===(o=ra(this,ua).options)||void 0===o?void 0:o.headerAttributes)&&(i=[...i,...ra(this,ua).options.headerAttributes.map((t=>t[0]))]);for(let s=0,r=n.length;s<r;s++)ue(n[s],t),fe(n[s],i)})),t.clear()}class ya extends Or{constructor(t,e){super(t,new Hl(e));const o=this.wtSettings.getSetting("facade",this);this.wtTable=new Il(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=new Bl(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Ca(this.wtSettings.getSetting("selections")),this.wtEvent=new as(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Rl(this,o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const t={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},e=[],o=[];Eo(t,((t,n)=>{this.wtSettings.getSetting(n).length&&o.push(t),e.push(t)})),ue(this.wtTable.wtRootElement.parentNode,e),de(this.wtTable.wtRootElement.parentNode,o)}getViewportDao(){const t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}class Sa{constructor(t){t instanceof Or?this._wot=t:this._initFromSettings(t)}_initFromSettings(t){t.facade=t=>{const e=new Sa(t);return()=>e},this._wot=new ya(t.table,t)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(t){this._wot.drawn=t}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(t){this._wot.drawInterrupted=t}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(t){this._wot.lastMouseOver=t}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(t){this._wot.momentumScrolling=t}get touchApplied(){return this._wot.touchApplied}set touchApplied(t){this._wot.touchApplied=t}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(t){this._wot.eventListeners=t}get eventManager(){return this._wot.eventManager}createCellCoords(t,e){return this._wot.createCellCoords(t,e)}createCellRange(t,e,o){return this._wot.createCellRange(t,e,o)}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}scrollViewport(t,e,o,n,i){return this._wot.scrollViewport(t,e,o,n,i)}scrollViewportHorizontally(t,e,o){return this._wot.scrollViewportHorizontally(t,e,o)}scrollViewportVertically(t,e,o){return this._wot.scrollViewportVertically(t,e,o)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(t,e){return this._wot.wtSettings.update(t,e),this}getSetting(t,e,o,n,i){return this._wot.wtSettings.getSetting(t,e,o,n,i)}hasSetting(t){return this._wot.wtSettings.hasSetting(t)}destroy(){this._wot.destroy()}}function ba(t){let{isShiftKey:e,isLeftClick:o,isRightClick:n,coords:i,selection:s,controller:r,cellCoordsFactory:l}=t;const a=s.isSelected()?s.getSelectedRange().current():null,h=s.isSelectedByCorner(),c=s.isSelectedByRowHeader();if(e&&a)i.row>=0&&i.col>=0&&!r.cell?s.setRangeEnd(i):(h||c)&&i.row>=0&&i.col>=0&&!r.cell?s.setRangeEnd(l(i.row,i.col)):h&&i.row<0&&!r.column?s.setRangeEnd(l(a.to.row,i.col)):c&&i.col<0&&!r.row?s.setRangeEnd(l(i.row,a.to.col)):(!h&&!c&&i.col<0||h&&i.col<0)&&!r.row?s.selectRows(Math.max(a.from.row,0),i.row,i.col):(!h&&!c&&i.row<0||c&&i.row<0)&&!r.column&&s.selectColumns(Math.max(a.from.col,0),i.col,i.row);else{const t=!s.inInSelection(i),e=o||n&&t;i.row<0&&i.col>=0&&!r.column?e&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!r.row?e&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!r.cell?e&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function Ra(t){let{isLeftClick:e,coords:o,selection:n,controller:i,cellCoordsFactory:s}=t;if(!e)return;const r=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),a=n.tableProps.countCols(),h=n.tableProps.countRows();l&&!i.column?n.setRangeEnd(s(h-1,o.col)):r&&!i.row?n.setRangeEnd(s(o.row,a-1)):i.cell||n.setRangeEnd(o)}const Ea=new Map([["mousedown",ba],["mouseover",Ra],["touchstart",ba]]);function Ma(t,e){let{coords:o,selection:n,controller:i,cellCoordsFactory:s}=e;Ea.get(t.type)({coords:o,selection:n,controller:i,cellCoordsFactory:s,isShiftKey:t.shiftKey,isLeftClick:sn(t)||"touchstart"===t.type,isRightClick:nn(t)})}const Ta=new WeakMap,Ha=Symbol("rootInstance");function xa(t){Ta.set(t,!0)}function Ia(t){return t===Ha}function Aa(t){return Ta.has(t)}function ka(t,e,o){Oa(t,e),e.set(t,o)}function Oa(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pa(t,e,o){return e=Na(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Na(t){var e=_a(t,"string");return"symbol"===typeof e?e:String(e)}function _a(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Da(t,e){var o=Ba(t,e,"get");return La(t,o)}function La(t,e){return e.get?e.get.call(t):e.value}function Va(t,e,o){var n=Ba(t,e,"set");return Fa(t,n,o),o}function Ba(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Fa(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}const Wa=new WeakMap;var ja=new WeakMap,za=new WeakMap;class Ua{constructor(t){Pa(this,"instance",void 0),Pa(this,"eventManager",void 0),Pa(this,"settings",void 0),Pa(this,"THEAD",void 0),Pa(this,"TBODY",void 0),Pa(this,"_wt",void 0),Pa(this,"activeWt",void 0),ka(this,ja,{writable:!0,value:0}),ka(this,za,{writable:!0,value:0}),Pa(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new On(this.instance),this.settings=this.instance.getSettings(),Wa.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(t)}getCellAtCoords(t,e){const o=this._wt.getCell(t,e);return o<0?null:o}scrollViewport(t,e,o,n,i){return this._wt.scrollViewport(t,e,o,n,i)}scrollViewportHorizontally(t,e,o){return this._wt.scrollViewportHorizontally(t,e,o)}scrollViewportVertically(t,e,o){return this._wt.scrollViewportVertically(t,e,o)}createElements(){const t=Wa.get(this),{rootElement:e,rootDocument:o}=this.instance,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),de(e,"handsontable"),t.table=o.createElement("TABLE"),de(t.table,"htCore"),this.instance.getSettings().tableClassName&&de(t.table,this.instance.getSettings().tableClassName),this.settings.ariaTags&&(ge(t.table,[pt()]),ge(e,[mt(),_t(this.instance.countRows()),Dt(this.instance.countCols()),Pt()])),this.THEAD=o.createElement("THEAD"),t.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),t.table.appendChild(this.TBODY),this.instance.table=t.table,this.instance.container.insertBefore(t.table,this.instance.container.firstChild)}registerEvents(){const t=Wa.get(this),{rootElement:e,rootDocument:o,selection:n}=this.instance,i=o.documentElement;this.eventManager.addEventListener(e,"mousedown",(e=>{if(t.selectionMouseDown=!0,!this.isTextSelectionAllowed(e.target)){const{rootWindow:t}=this.instance;Fe(t),e.preventDefault(),t.focus()}})),this.eventManager.addEventListener(e,"mouseup",(()=>{t.selectionMouseDown=!1})),this.eventManager.addEventListener(e,"mousemove",(e=>{t.selectionMouseDown&&!this.isTextSelectionAllowed(e.target)&&(this.settings.fragmentSelection&&Fe(this.instance.rootWindow),e.preventDefault())})),this.eventManager.addEventListener(i,"keyup",(t=>{n.isInProgress()&&!t.shiftKey&&n.finish()})),this.eventManager.addEventListener(i,"mouseup",(i=>{n.isInProgress()&&sn(i)&&n.finish(),t.mouseDown=!1;const s=Qe(o.activeElement);s&&(!s&&(n.isSelected()||n.isSelectedByAnyHeader()||e.contains(i.target)||nn(i))||this.instance.unlisten())})),this.eventManager.addEventListener(i,"contextmenu",(e=>{n.isInProgress()&&nn(e)&&(n.finish(),t.mouseDown=!1)})),this.eventManager.addEventListener(i,"touchend",(()=>{n.isInProgress()&&n.finish(),t.mouseDown=!1})),this.eventManager.addEventListener(i,"mousedown",(n=>{const s=n.target,r=n.x||n.clientX,l=n.y||n.clientY;let a=n.target;if(t.mouseDown||!e||!this.instance.view)return;const{holder:h}=this.instance.view._wt.wtTable;if(a===h){const t=Ue(o);if(o.elementFromPoint(r+t,l)!==h||o.elementFromPoint(r,l+t)!==h)return}else while(a!==i){if(null===a){if(n.isTargetWebComponent)break;return}if(a===e)return;a=a.parentNode}const c="function"===typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects;c?this.instance.deselectCell():this.instance.destroyEditor(!1,!1)})),this.eventManager.addEventListener(t.table,"selectstart",(t=>{this.settings.fragmentSelection||qe(t.target)||t.preventDefault()}))}translateFromRenderableToVisualCoords(t){let{row:e,col:o}=t;return this.instance._createCellCoords(...this.translateFromRenderableToVisualIndex(e,o))}translateFromRenderableToVisualIndex(t,e){let o=t>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t,n=e>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===o&&(o=t),null===n&&(n=e),[o,n]}countRenderableIndexes(t,e){const o=Math.min(t.getNotTrimmedIndexesLength(),e),n=t.getNearestNotHiddenIndex(o-1,-1);return null===n?0:t.getRenderableFromVisualIndex(n)+1}countRenderableColumns(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.instance.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.instance.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(t,e,o,n){if(isNaN(t)||t<0)return 0;const i=o.getNearestNotHiddenIndex(t,e),s=o.getRenderableFromVisualIndex(i);if(!Number.isInteger(s))return 0;let r=0;return e<0?r=s+1:e>0&&(r=n-s),r}countNotHiddenFixedColumnsStart(){const t=this.instance.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}countNotHiddenFixedRowsTop(){const t=this.instance.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}countNotHiddenFixedRowsBottom(){const t=this.instance.countRows(),e=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}countRenderableColumnsInRange(t,e){let o=0;for(let n=t;n<=e;n++)null!==this.instance.columnIndexMapper.getRenderableFromVisualIndex(n)&&(o+=1);return o}countRenderableRowsInRange(t,e){let o=0;for(let n=t;n<=e;n++)null!==this.instance.rowIndexMapper.getRenderableFromVisualIndex(n)&&(o+=1);return o}isMainTableNotFullyCoveredByOverlays(){const t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>t&&this.instance.countRenderedCols()>e}initializeWalkontable(){const t=Wa.get(this),e={ariaTags:this.settings.ariaTags,rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:t.table,isDataViewInstance:()=>Aa(this.instance),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(t,e)=>this.instance.getDataAtCell(...this.translateFromRenderableToVisualIndex(t,e)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const t=[];return this.instance.hasRowHeaders()&&t.push(((t,e)=>{const o=t>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t;this.appendRowHeader(o,e)})),this.instance.runHooks("afterGetRowHeaderRenderers",t),Va(this,za,t.length),t},columnHeaders:()=>{const t=[];return this.instance.hasColHeaders()&&t.push(((t,e)=>{const o=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;this.appendColHeader(o,e)})),this.instance.runHooks("afterGetColumnHeaderRenderers",t),Va(this,ja,t.length),t},columnWidth:t=>{const e=this.instance.columnIndexMapper.getVisualFromRenderableIndex(t);return this.instance.getColWidth(null===e?t:e)},rowHeight:t=>{const e=this.instance.rowIndexMapper.getVisualFromRenderableIndex(t);return this.instance.getRowHeight(null===e?t:e)},cellRenderer:(t,e,o)=>{const[n,i]=this.translateFromRenderableToVisualIndex(t,e),s=this.instance.runHooks("modifyGetCellCoords",n,i);let r=n,l=i;Array.isArray(s)&&([r,l]=s);const a=this.instance.getCellMeta(r,l),h=this.instance.colToProp(l);let c=this.instance.getDataAtRowProp(r,h);this.instance.hasHook("beforeValueRender")&&(c=this.instance.runHooks("beforeValueRender",c,a)),this.instance.runHooks("beforeRenderer",o,n,i,h,c,a),this.instance.getCellRenderer(a)(this.instance,o,n,i,h,c,a),this.instance.runHooks("afterRenderer",o,n,i,h,c,a)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onContainerElementResize:()=>{this.instance&&!this.instance.isDestroyed&&ye(this.instance.rootElement)&&this.instance.refreshDimensions()},onCellMouseDown:(e,o,n,i)=>{const s=this.translateFromRenderableToVisualCoords(o),r={row:!1,column:!1,cell:!1};this.instance.listen(),this.activeWt=i,t.mouseDown=!0,this.instance.runHooks("beforeOnCellMouseDown",e,s,n,r),on(e)||(Ma(e,{coords:s,selection:this.instance.selection,controller:r,cellCoordsFactory:(t,e)=>this.instance._createCellCoords(t,e)}),this.instance.runHooks("afterOnCellMouseDown",e,s,n),this.activeWt=this._wt)},onCellContextMenu:(e,o,n,i)=>{const s=this.translateFromRenderableToVisualCoords(o);this.activeWt=i,t.mouseDown=!1,this.instance.selection.isInProgress()&&this.instance.selection.finish(),this.instance.runHooks("beforeOnCellContextMenu",e,s,n),on(e)||(this.instance.runHooks("afterOnCellContextMenu",e,s,n),this.activeWt=this._wt)},onCellMouseOut:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=n,this.instance.runHooks("beforeOnCellMouseOut",t,i,o),on(t)||(this.instance.runHooks("afterOnCellMouseOut",t,i,o),this.activeWt=this._wt)},onCellMouseOver:(e,o,n,i)=>{const s=this.translateFromRenderableToVisualCoords(o),r={row:!1,column:!1,cell:!1};this.activeWt=i,this.instance.runHooks("beforeOnCellMouseOver",e,s,n,r),on(e)||(t.mouseDown&&Ma(e,{coords:s,selection:this.instance.selection,controller:r,cellCoordsFactory:(t,e)=>this.instance._createCellCoords(t,e)}),this.instance.runHooks("afterOnCellMouseOver",e,s,n),this.activeWt=this._wt)},onCellMouseUp:(t,e,o,n)=>{const i=this.translateFromRenderableToVisualCoords(e);this.activeWt=n,this.instance.runHooks("beforeOnCellMouseUp",t,i,o),on(t)||this.instance.isDestroyed||(this.instance.runHooks("afterOnCellMouseUp",t,i,o),this.activeWt=this._wt)},onCellCornerMouseDown:t=>{t.preventDefault(),this.instance.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:t=>{t.preventDefault(),this.instance.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:(t,e)=>this.beforeRender(t,e),onDraw:t=>this.afterRender(t),onBeforeViewportScrollVertically:t=>{const e=this.instance.rowIndexMapper,o=t<0;let n=t;return o||(n=e.getVisualFromRenderableIndex(t),null!==n)?(n=this.instance.runHooks("beforeViewportScrollVertically",n),this.instance.runHooks("beforeViewportScroll"),o?n:e.getRenderableFromVisualIndex(n)):t},onBeforeViewportScrollHorizontally:t=>{const e=this.instance.columnIndexMapper,o=t<0;let n=t;return o||(n=e.getVisualFromRenderableIndex(t),null!==n)?(n=this.instance.runHooks("beforeViewportScrollHorizontally",n),this.instance.runHooks("beforeViewportScroll"),o?n:e.getRenderableFromVisualIndex(n)):t},onScrollVertically:()=>{this.instance.runHooks("afterScrollVertically"),this.instance.runHooks("afterScroll")},onScrollHorizontally:()=>{this.instance.runHooks("afterScrollHorizontally"),this.instance.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.instance.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(t,e,o)=>{const n=this.instance.rowIndexMapper,i=t<0;let s=t;i||(s=n.getVisualFromRenderableIndex(t));const r=this.instance.runHooks("beforeHighlightingRowHeader",s,e,o);return i?r:n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,1))},onBeforeHighlightingColumnHeader:(t,e,o)=>{const n=this.instance.columnIndexMapper,i=t<0;let s=t;i||(s=n.getVisualFromRenderableIndex(t));const r=this.instance.runHooks("beforeHighlightingColumnHeader",s,e,o);return i?r:n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,1))},onAfterDrawSelection:(t,e,o)=>{let n;const[i,s]=this.translateFromRenderableToVisualIndex(t,e),r=this.instance.selection.getSelectedRange(),l=r.size();if(l>0){const t=r.peekByIndex(null!==o&&void 0!==o?o:0);n=[t.from.row,t.from.col,t.to.row,t.to.col]}return this.instance.runHooks("afterDrawSelection",i,s,n,o)},onBeforeDrawBorders:(t,e)=>{const[o,n,i,s]=t,r=[this.instance.rowIndexMapper.getVisualFromRenderableIndex(o),this.instance.columnIndexMapper.getVisualFromRenderableIndex(n),this.instance.rowIndexMapper.getVisualFromRenderableIndex(i),this.instance.columnIndexMapper.getVisualFromRenderableIndex(s)];return this.instance.runHooks("beforeDrawBorders",r,e)},onBeforeTouchScroll:()=>this.instance.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.instance.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(t,e)=>{const o=this.instance.columnIndexMapper.getVisualFromRenderableIndex(e);return this.instance.runHooks("beforeStretchingColumnWidth",t,o)},onModifyRowHeaderWidth:t=>this.instance.runHooks("modifyRowHeaderWidth",t),onModifyGetCellCoords:(t,e,o)=>{const n=this.instance.rowIndexMapper,i=this.instance.columnIndexMapper,s=e>=0?i.getVisualFromRenderableIndex(e):e,r=t>=0?n.getVisualFromRenderableIndex(t):t,l=this.instance.runHooks("modifyGetCellCoords",r,s,o);if(Array.isArray(l)){const[t,e,o,s]=l;return[t>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(t,1)):t,e>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,1)):e,o>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1)):o,s>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1)):s]}},viewportRowCalculatorOverride:t=>{let e=this.settings.viewportRowRenderingOffset;if("auto"===e&&this.settings.fixedRowsTop&&(e=10),e>0||"auto"===e){const o=this.countRenderableRows(),n=t.startRow,i=t.endRow;if("number"===typeof e)t.startRow=Math.max(n-e,0),t.endRow=Math.min(i+e,o-1);else if("auto"===e){const e=Math.ceil(i/o*12);t.startRow=Math.max(n-e,0),t.endRow=Math.min(i+e,o-1)}}this.instance.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:t=>{let e=this.settings.viewportColumnRenderingOffset;if("auto"===e&&this.settings.fixedColumnsStart&&(e=10),e>0||"auto"===e){const o=this.countRenderableColumns(),n=t.startColumn,i=t.endColumn;if("number"===typeof e&&(t.startColumn=Math.max(n-e,0),t.endColumn=Math.min(i+e,o-1)),"auto"===e){const e=Math.ceil(i/o*6);t.startColumn=Math.max(n-e,0),t.endColumn=Math.min(i+e,o-1)}}this.instance.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const t=this.instance.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||t}};this.instance.runHooks("beforeInitWalkontable",e),this._wt=new Sa(e),this.activeWt=this._wt;const o=this._wt.wtTable.spreader,{width:n,height:i}=this.instance.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(o,"mousedown",(t=>{t.target===o&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(o,"contextmenu",(t=>{t.target===o&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.instance.forceFullRender=!0,this.render())}))}isTextSelectionAllowed(t){if(qe(t))return!0;const e=se(t,this.instance.view._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return Wa.get(this).mouseDown}isSelectedOnlyCell(){var t,e;return null!==(t=null===(e=this.instance.getSelectedRangeLast())||void 0===e?void 0:e.isSingleCell())&&void 0!==t&&t}isCellEdited(){const t=this.instance.getActiveEditor();return t&&t.isOpened()}beforeRender(t,e){t&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,e)}afterRender(t){t&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}appendRowHeader(t,e){if(e.firstChild){const o=e.firstChild;if(!ce(o,"relative"))return pe(e),void this.appendRowHeader(t,e);this.updateCellHeader(o.querySelector(".rowHeader"),t,this.instance.getRowHeader)}else{const{rootDocument:o,getRowHeader:n}=this.instance,i=o.createElement("div"),s=o.createElement("span");i.className="relative",s.className="rowHeader",this.updateCellHeader(s,t,n),i.appendChild(s),e.appendChild(i)}this.instance.runHooks("afterGetRowHeader",t,e)}appendColHeader(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.instance.getColHeader,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e.firstChild){const i=e.firstChild;ce(i,"relative")?this.updateCellHeader(i.querySelector(".colHeader"),t,o,n):(pe(e),this.appendColHeader(t,e,o,n))}else{const{rootDocument:i}=this.instance,s=i.createElement("div"),r=i.createElement("span");s.className="relative",r.className="colHeader",this.updateCellHeader(r,t,o,n),s.appendChild(r),e.appendChild(s)}this.instance.runHooks("afterGetColHeader",t,e,n)}updateCellHeader(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=e;const s=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&(ce(t,"colHeader")?i=s.wtTable.columnFilter.sourceToRendered(e):ce(t,"rowHeader")&&(i=s.wtTable.rowFilter.sourceToRendered(e))),i>-1?Ce(t,o(e,n)):(ve(t,String.fromCharCode(160)),de(t,"cornerHeader"))}maximumVisibleElementWidth(t){const e=this._wt.wtViewport.getWorkspaceWidth(),o=e-t;return o>0?o:0}maximumVisibleElementHeight(t){const e=this._wt.wtViewport.getWorkspaceHeight(),o=e-t;return o>0?o:0}setLastSize(t,e){const o=Wa.get(this);[o.lastWidth,o.lastHeight]=[t,e]}getLastSize(){const t=Wa.get(this);return{width:t.lastWidth,height:t.lastHeight}}getFirstFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return Da(this,ja)}getRowHeadersCount(){return Da(this,za)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}var $a=Ua;const Ga="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Ya=Ga.length;function Ka(t){let e,o=t+1,n="";while(o>0)e=(o-1)%Ya,n=String.fromCharCode(65+e)+n,o=parseInt((o-e)/Ya,10);return n}function Xa(t){let e=0;if(t)for(let o=0,n=t.length-1;o<t.length;o+=1,n-=1)e+=Ya**n*(Ga.indexOf(t[o])+1);return e-=1,e}function qa(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const o=[];let n,i;for(n=0;n<t;n++){const t=[];for(i=0;i<e;i++)t.push(Ka(i)+(n+1));o.push(t)}return o}function Qa(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const o=[];let n,i;for(n=0;n<t;n++){const t={};for(i=0;i<e;i++)t[`prop${i}`]=Ka(i)+(n+1);o.push(t)}return o}function Ja(t,e){const o=[];let n;for(let i=0;i<t;i++){n=[];for(let t=0;t<e;t++)n.push("");o.push(n)}return o}function Za(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=t;const n=[];return Array.isArray(t)&&Array.isArray(t[0])||(o=[t]),o.forEach(((t,o)=>{Array.isArray(t)?t.forEach(((t,i)=>{n.push([o+e,i,t])})):Object.keys(t).forEach((i=>{n.push([o+e,i,t[i]])}))})),n}function th(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&bo(t[0])&&(e=Ho(t[0]))),e}function eh(t){return!!(Array.isArray(t)&&t.length&&t.every((t=>Array.isArray(t))))}function oh(t){return!!(Array.isArray(t)&&t.length&&t.every((t=>"object"===typeof t&&!Array.isArray(t)&&null!==t)))}class nh{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.hot=t,this.data=e,this.dataType="array",this.colToProp=()=>{},this.propToCol=()=>{}}modifyRowData(t){let e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}getData(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}setData(t){this.data=t}getAtColumn(t){const e=[];return k(this.data,((o,n)=>{const i=this.getAtCell(n,t);e.push(i)})),e}getAtRow(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=void 0===e&&void 0===o;let s=null,r=null;if(s=this.modifyRowData(t),Array.isArray(s))r=[],i?s.forEach(((e,o)=>{r[o]=this.getAtPhysicalCell(t,o,s)})):mi(e,o,(o=>{r[o-e]=this.getAtPhysicalCell(t,o,s)}));else if(bo(s)||io(s))if(r=n?[]:{},!i||n){const i=0,l=this.countFirstRowKeys()-1;mi(i,l,(a=>{const h=this.colToProp(a);if(a>=(e||i)&&a<=(o||l)&&!Number.isInteger(h)){const e=this.getAtPhysicalCell(t,h,s);n?r.push(e):To(r,h,e)}}))}else Eo(s,((e,o)=>{To(r,o,this.getAtPhysicalCell(t,o,s))}));return r}setAtCell(t,e,o){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const n=xo(o);this.hot.runHooks("modifySourceData",t,e,n,"set"),n.isTouched()&&(o=n.value)}Number.isInteger(e)?this.data[t][e]=o:To(this.data[t],e,o)}}getAtPhysicalCell(t,e,o){let n=null;if(o&&(n="string"===typeof e?Mo(o,e):"function"===typeof e?e(o):o[e]),this.hot.hasHook("modifySourceData")){const o=xo(n);this.hot.runHooks("modifySourceData",t,e,o,"get"),o.isTouched()&&(n=o.value)}return n}getAtCell(t,e){const o=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),o)}getByRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,i=null,s=null,r=null,l=null;null===t||null===e?(n=!0,i=0,r=this.countRows()-1):(i=Math.min(t.row,e.row),s=Math.min(t.col,e.col),r=Math.max(t.row,e.row),l=Math.max(t.col,e.col));const a=[];return mi(i,r,(t=>{a.push(n?this.getAtRow(t,void 0,void 0,o):this.getAtRow(t,s,l,o))})),a}countRows(){if(this.hot.hasHook("modifySourceLength")){const t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}countFirstRowKeys(){return th(this.data)}destroy(){this.data=null,this.hot=null}}var ih=nh;const sh="localHooks",rh={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,o,n,i,s,r){if(this._localHooks[t]){const l=this._localHooks[t].length;for(let a=0;a<l;a++)go(this._localHooks[t][a],this,e,o,n,i,s,r)}},clearLocalHooks(){return this._localHooks={},this}};Ro(rh,"MIXIN_NAME",sh,{writable:!1,enumerable:!1});var lh=rh;class ah{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.indexedValues=[],this.initValueOrFn=t}getValues(){return this.indexedValues}getValueAtIndex(t){const e=this.indexedValues;if(t<e.length)return e[t]}setValues(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}setValueAtIndex(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,io(this.initValueOrFn)?mi(t-1,(t=>this.indexedValues.push(this.initValueOrFn(t)))):mi(t-1,(()=>this.indexedValues.push(this.initValueOrFn))),this.runLocalHooks("change")}init(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function hh(t,e,o){return[...t.slice(0,e),...o,...t.slice(e)]}function ch(t,e){return I(t,(t=>!1===e.includes(t)))}function dh(t,e){return A(t,(t=>t-e.filter((e=>e<t)).length))}function uh(t,e){const o=e[0],n=e.length;return A(t,(t=>t>=o?t+n:t))}yo(ah,lh);class gh extends ah{constructor(){super((t=>t))}insert(t,e){const o=uh(this.indexedValues,e);this.indexedValues=hh(o,t,e),super.insert(t,e)}remove(t){const e=ch(this.indexedValues,t);this.indexedValues=dh(e,t),super.remove(t)}}function fh(t,e,o,n){const i=o.length?o[0]:void 0;return[...t.slice(0,i),...o.map(((t,e)=>io(n)?n(t,e):n)),...void 0===i?[]:t.slice(i)]}function mh(t,e){return I(t,((t,o)=>!1===e.includes(o)))}class ph extends ah{insert(t,e){this.indexedValues=fh(this.indexedValues,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){this.indexedValues=mh(this.indexedValues,t),super.remove(t)}}class wh extends ph{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getHiddenIndexes(){return x(this.getValues(),((t,e,o)=>(e&&t.push(o),t)),[])}}function Ch(t,e,o){return e=vh(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function vh(t){var e=yh(t,"string");return"symbol"===typeof e?e:String(e)}function yh(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Sh extends ah{constructor(){super(...arguments),Ch(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map((t=>this.indexedValues[t]))}setValues(t){this.orderOfIndexes=[...Array(t.length).keys()],super.setValues(t)}setValueAtIndex(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(o,0,t),this.runLocalHooks("change"),!0)}clearValue(t){this.orderOfIndexes=ch(this.orderOfIndexes,[t]),io(this.initValueOrFn)?super.setValueAtIndex(t,this.initValueOrFn(t)):super.setValueAtIndex(t,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(t)}insert(t,e){this.indexedValues=fh(this.indexedValues,t,e,this.initValueOrFn),this.orderOfIndexes=uh(this.orderOfIndexes,e),super.insert(t,e)}remove(t){this.indexedValues=mh(this.indexedValues,t),this.orderOfIndexes=ch(this.orderOfIndexes,t),this.orderOfIndexes=dh(this.orderOfIndexes,t),super.remove(t)}getEntries(){return this.orderOfIndexes.map((t=>[t,this.getValueAtIndex(t)]))}}class bh extends ph{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getTrimmedIndexes(){return x(this.getValues(),((t,e,o)=>(e&&t.push(o),t)),[])}}const Rh=new Map([["hiding",wh],["index",ah],["linkedPhysicalIndexToValue",Sh],["physicalIndexToValue",ph],["trimming",bh]]);function Eh(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Rh.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(Rh.get(t))(e)}let Mh=0;class Th{constructor(){this.collection=new Map}register(t,e){!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",(()=>this.runLocalHooks("change",e))),Mh+=1)}unregister(t){const e=this.collection.get(t);U(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),Mh-=1)}unregisterAll(){this.collection.forEach(((t,e)=>this.unregister(e))),this.collection.clear()}get(t){return $(t)?Array.from(this.collection.values()):this.collection.get(t)}getLength(){return this.collection.size}removeFromEvery(t){this.collection.forEach((e=>{e.remove(t)}))}insertToEvery(t,e){this.collection.forEach((o=>{o.insert(t,e)}))}initEvery(t){this.collection.forEach((e=>{e.init(t)}))}}function Hh(){return Mh}yo(Th,lh);class xh extends Th{constructor(t,e){super(),this.mergedValuesCache=[],this.aggregationFunction=t,this.fallbackValue=e}getMergedValues(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.mergedValuesCache;if(0===this.getLength())return[];const e=A(this.get(),(t=>t.getValues())),o=[],n=U(e[0])&&e[0].length||0;for(let i=0;i<n;i+=1){const t=[];for(let o=0;o<this.getLength();o+=1)t.push(e[o][i]);o.push(t)}return A(o,this.aggregationFunction)}getMergedValueAtIndex(t,e){const o=this.getMergedValues(e)[t];return U(o)?o:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Ih(t,e,o){Ah(t,e),e.set(t,o)}function Ah(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kh(t,e,o){var n=Nh(t,e,"set");return Oh(t,n,o),o}function Oh(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function Ph(t,e){var o=Nh(t,e,"get");return _h(t,o)}function Nh(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function _h(t,e){return e.get?e.get.call(t):e.value}var Dh=new WeakMap;class Lh{constructor(){Ih(this,Dh,{writable:!0,value:[]})}subscribe(t){return this.addLocalHook("change",t),this._write(Ph(this,Dh)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(t){return t.length>0&&this.runLocalHooks("change",t),this}_writeInitialChanges(t){kh(this,Dh,t)}}function Vh(t,e){const o=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&o.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)o.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)o.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return o}function Bh(t,e,o){Fh(t,e),e.set(t,o)}function Fh(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wh(t,e){var o=Uh(t,e,"get");return jh(t,o)}function jh(t,e){return e.get?e.get.call(t):e.value}function zh(t,e,o){var n=Uh(t,e,"set");return $h(t,n,o),o}function Uh(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function $h(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}yo(Lh,lh);var Gh=new WeakMap,Yh=new WeakMap,Kh=new WeakMap,Xh=new WeakMap,qh=new WeakMap;class Qh{constructor(){let{initialIndexValue:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Bh(this,Gh,{writable:!0,value:new Set}),Bh(this,Yh,{writable:!0,value:[]}),Bh(this,Kh,{writable:!0,value:[]}),Bh(this,Xh,{writable:!0,value:!1}),Bh(this,qh,{writable:!0,value:!1}),zh(this,qh,null!==t&&void 0!==t&&t)}createObserver(){const t=new Lh;return Wh(this,Gh).add(t),t.addLocalHook("unsubscribe",(()=>{Wh(this,Gh).delete(t)})),t._writeInitialChanges(Vh(Wh(this,Yh),Wh(this,Kh))),t}emit(t){let e=Wh(this,Kh);Wh(this,Xh)&&Wh(this,Yh).length===t.length||(0===t.length?t=new Array(e.length).fill(Wh(this,qh)):zh(this,Yh,new Array(t.length).fill(Wh(this,qh))),Wh(this,Xh)||(zh(this,Xh,!0),e=Wh(this,Yh)));const o=Vh(e,t);Wh(this,Gh).forEach((t=>t._write(o))),zh(this,Kh,t)}}new Set;class Jh{constructor(){this.indexesSequence=new gh,this.trimmingMapsCollection=new xh((t=>t.some((t=>!0===t))),!1),this.hidingMapsCollection=new xh((t=>t.some((t=>!0===t))),!1),this.variousMapsCollection=new Th,this.hidingChangesObservable=new Qh({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",(()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(t=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(t=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(t=>{this.runLocalHooks("change",t,this.variousMapsCollection)}))}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(t){if("hiding"!==t)throw new Error(`Unsupported index map type "${t}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(t,e,o){return this.registerMap(t,Eh(e,o))}registerMap(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error(`Map with name "${t}" has been already registered.`);e instanceof bh?this.trimmingMapsCollection.register(t,e):e instanceof wh?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);const o=this.getNumberOfIndexes();return o>0&&e.init(o),e}unregisterMap(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(t){const e=this.notTrimmedIndexesCache[t];return U(e)?e:null}getPhysicalFromRenderableIndex(t){const e=this.renderablePhysicalIndexesCache[t];return U(e)?e:null}getVisualFromPhysicalIndex(t){const e=this.fromPhysicalToVisualIndexesCache.get(t);return U(e)?e:null}getVisualFromRenderableIndex(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}getRenderableFromVisualIndex(t){const e=this.fromVisualToRenderableIndexesCache.get(t);return U(e)?e:null}getNearestNotHiddenIndex(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.getPhysicalFromVisualIndex(t);if(null===n)return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;const i=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return s=e>0?i.findIndex((e=>e>t)):i.reverse().findIndex((e=>e<t)),-1===s?o?this.getNearestNotHiddenIndex(t,-e,!1):null:i[s]}initToLength(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(t).keys()],this.notHiddenIndexesCache=[...new Array(t).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(t){const e=this.getNumberOfIndexes();if(t<e){const e=[...Array(this.getNumberOfIndexes()-t).keys()].map((e=>e+t));this.removeIndexes(e)}else this.insertIndexes(e,t-e)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(t){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(t),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notTrimmedIndexesCache;const e=this.getIndexesSequence();return e.filter((t=>!1===this.isTrimmed(t)))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notHiddenIndexesCache;const e=this.getIndexesSequence();return e.filter((t=>!1===this.isHidden(t)))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.renderablePhysicalIndexesCache;const e=this.getNotTrimmedIndexes();return e.filter((t=>!1===this.isHidden(t)))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(t,e){"number"===typeof t&&(t=[t]);const o=A(t,(t=>this.getPhysicalFromVisualIndex(t))),n=this.getNotTrimmedIndexesLength(),i=t.length,s=ch(this.getIndexesSequence(),o),r=s.filter((t=>!1===this.isTrimmed(t)));let l=s.indexOf(r[r.length-1])+1;if(e+i<n){const t=r[e];l=s.indexOf(t)}this.indexesChangeSource="move",this.setIndexesSequence(hh(s,l,o)),this.indexesChangeSource=void 0}isTrimmed(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}isHidden(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}insertIndexes(t,e){const o=this.getNotTrimmedIndexes()[t],n=U(o)?o:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),s=A(new Array(e).fill(n),((t,e)=>t+e));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,s),this.hidingMapsCollection.insertToEvery(i,s),this.variousMapsCollection.insertToEvery(i,s),this.resumeOperations()}removeIndexes(t){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}updateCache(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(t,e)}}cacheFromVisualToRenderableIndexes(){const t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromRenderableIndex(e),o=this.getVisualFromPhysicalIndex(t);this.fromVisualToRenderableIndexesCache.set(o,e)}}}function Zh(t,e){return Eo(e,((e,o)=>{$(t[o])&&(t[o]=e)})),t}function tc(t){const e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,o=e.exec(t);return o?`${o[1].toLowerCase()}-${o[2].toUpperCase()}`:t}function ec(t){U(t)&&an(j`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function oc(t,e){const o=Array.isArray(t)&&Number.isInteger(e);return o?t[e]:t}yo(Jh,lh);const{register:nc,getValues:ic}=Cn("phraseFormatters");function sc(t,e){nc(t,e)}function rc(){return ic()}sc("pluralize",oc);const lc="ContextMenu:items",ac=lc,hc=`${ac}.noItems`,cc=`${ac}.insertRowAbove`,dc=`${ac}.insertRowBelow`,uc=`${ac}.insertColumnOnTheLeft`,gc=`${ac}.insertColumnOnTheRight`,fc=`${ac}.removeRow`,mc=`${ac}.removeColumn`,pc=`${ac}.undo`,wc=`${ac}.redo`,Cc=`${ac}.readOnly`,vc=`${ac}.clearColumn`,yc=`${ac}.copy`,Sc=`${ac}.copyWithHeaders`,bc=`${ac}.copyWithGroupHeaders`,Rc=`${ac}.copyHeadersOnly`,Ec=`${ac}.cut`,Mc=`${ac}.freezeColumn`,Tc=`${ac}.unfreezeColumn`,Hc=`${ac}.mergeCells`,xc=`${ac}.unmergeCells`,Ic=`${ac}.addComment`,Ac=`${ac}.editComment`,kc=`${ac}.removeComment`,Oc=`${ac}.readOnlyComment`,Pc=`${ac}.align`,Nc=`${ac}.align.left`,_c=`${ac}.align.center`,Dc=`${ac}.align.right`,Lc=`${ac}.align.justify`,Vc=`${ac}.align.top`,Bc=`${ac}.align.middle`,Fc=`${ac}.align.bottom`,Wc=`${ac}.borders`,jc=`${ac}.borders.top`,zc=`${ac}.borders.right`,Uc=`${ac}.borders.bottom`,$c=`${ac}.borders.left`,Gc=`${ac}.borders.remove`,Yc=`${ac}.nestedHeaders.insertChildRow`,Kc=`${ac}.nestedHeaders.detachFromParent`,Xc=`${ac}.hideColumn`,qc=`${ac}.showColumn`,Qc=`${ac}.hideRow`,Jc=`${ac}.showRow`,Zc="Filters:",td=`${Zc}conditions`,ed=`${td}.none`,od=`${td}.isEmpty`,nd=`${td}.isNotEmpty`,id=`${td}.isEqualTo`,sd=`${td}.isNotEqualTo`,rd=`${td}.beginsWith`,ld=`${td}.endsWith`,ad=`${td}.contains`,hd=`${td}.doesNotContain`,cd=`${td}.byValue`,dd=`${td}.greaterThan`,ud=`${td}.greaterThanOrEqualTo`,gd=`${td}.lessThan`,fd=`${td}.lessThanOrEqualTo`,md=`${td}.isBetween`,pd=`${td}.isNotBetween`,wd=`${td}.after`,Cd=`${td}.before`,vd=`${td}.today`,yd=`${td}.tomorrow`,Sd=`${td}.yesterday`,bd=`${Zc}labels.filterByCondition`,Rd=`${Zc}labels.filterByValue`,Ed=`${Zc}labels.conjunction`,Md=`${Zc}labels.disjunction`,Td=`${Zc}values.blankCells`,Hd=`${Zc}buttons.selectAll`,xd=`${Zc}buttons.clear`,Id=`${Zc}buttons.ok`,Ad=`${Zc}buttons.cancel`,kd=`${Zc}buttons.placeholder.search`,Od=`${Zc}buttons.placeholder.value`,Pd=`${Zc}buttons.placeholder.secondValue`,Nd="CheckboxRenderer:",_d=`${Nd}checked`,Dd=`${Nd}unchecked`,Ld={languageCode:"en-US",[hc]:"No available options",[cc]:"Insert row above",[dc]:"Insert row below",[uc]:"Insert column left",[gc]:"Insert column right",[fc]:["Remove row","Remove rows"],[mc]:["Remove column","Remove columns"],[pc]:"Undo",[wc]:"Redo",[Cc]:"Read only",[vc]:"Clear column",[Pc]:"Alignment",[Nc]:"Left",[_c]:"Center",[Dc]:"Right",[Lc]:"Justify",[Vc]:"Top",[Bc]:"Middle",[Fc]:"Bottom",[Mc]:"Freeze column",[Tc]:"Unfreeze column",[Wc]:"Borders",[jc]:"Top",[zc]:"Right",[Uc]:"Bottom",[$c]:"Left",[Gc]:"Remove border(s)",[Ic]:"Add comment",[Ac]:"Edit comment",[kc]:"Delete comment",[Oc]:"Read-only comment",[Hc]:"Merge cells",[xc]:"Unmerge cells",[yc]:"Copy",[Sc]:["Copy with header","Copy with headers"],[bc]:["Copy with group header","Copy with group headers"],[Rc]:["Copy header only","Copy headers only"],[Ec]:"Cut",[Yc]:"Insert child row",[Kc]:"Detach from parent",[Xc]:["Hide column","Hide columns"],[qc]:["Show column","Show columns"],[Qc]:["Hide row","Hide rows"],[Jc]:["Show row","Show rows"],[ed]:"None",[od]:"Is empty",[nd]:"Is not empty",[id]:"Is equal to",[sd]:"Is not equal to",[rd]:"Begins with",[ld]:"Ends with",[ad]:"Contains",[hd]:"Does not contain",[dd]:"Greater than",[ud]:"Greater than or equal to",[gd]:"Less than",[fd]:"Less than or equal to",[md]:"Is between",[pd]:"Is not between",[wd]:"After",[Cd]:"Before",[vd]:"Today",[yd]:"Tomorrow",[Sd]:"Yesterday",[Td]:"Blank cells",[bd]:"Filter by condition",[Rd]:"Filter by value",[Ed]:"And",[Md]:"Or",[Hd]:"Select all",[xd]:"Clear",[Id]:"OK",[Ad]:"Cancel",[kd]:"Search",[Od]:"Value",[Pd]:"Second value",[_d]:"Checked",[Dd]:"Unchecked"};var Vd=Ld;const Bd=p,Fd=Vd.languageCode,{register:Wd,getItem:jd,hasItem:zd,getValues:Ud}=Cn("languagesDictionaries");function $d(t,e){let o=t,n=e;return bo(t)&&(n=t,o=n.languageCode),Gd(o,n),Wd(o,Co(n)),Co(n)}function Gd(t,e){t!==Fd&&Zh(e,jd(Fd))}function Yd(t){return Kd(t)?Co(jd(t)):null}function Kd(t){return zd(t)}function Xd(){return Ud()}function qd(t,e,o){const n=Yd(t);if(null===n)return null;const i=n[e];if($(i))return null;const s=Qd(i,o);return Array.isArray(s)?s[0]:s}function Qd(t,e){let o=t;return k(rc(),(n=>{o=n(t,e)})),o}function Jd(t){let e=tc(t);return Kd(e)||(e=Fd,ec(t)),e}$d(Vd);const Zd="active-header",tu="header",eu="area",ou="focus",nu="fill",iu="row",su="column",ru="custom-selection";class lu{constructor(t,e){this.settings=t,this.cellRange=e||null}isEmpty(){return null===this.cellRange}add(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}replace(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}destroy(){this.runLocalHooks("destroy")}}yo(lu,lh);var au=lu;function hu(t,e,o){return e=cu(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function cu(t){var e=du(t,"string");return"symbol"===typeof e?e:String(e)}function du(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class uu extends au{constructor(t,e){super(t,null),hu(this,"visualCellRange",null),this.visualCellRange=e||null,this.commit()}add(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(t){let{from:e,to:o}=t,n=this.getNearestNotHiddenCoords(e,1),i=this.getNearestNotHiddenCoords(o,-1);return null===n||null===i?null:((n.row>i.row||n.col>i.col)&&(n=e,i=o),this.settings.createCellRange(n,n,i))}getNearestNotHiddenCoords(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const n=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,t.row,e);if(null===n)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,t.col,o);return null===i?null:this.settings.createCellCoords(n,i)}getNearestNotHiddenIndex(t,e,o){return e<0?e:t.getNearestNotHiddenIndex(e,o)}commit(){if(null===this.visualCellRange)return this;const t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===t?null:this.createRenderableCellRange(t.from,t.to),this}syncWith(t){const e=t.from.clone().normalize(),o="N-S"===t.getVerticalDirection()?1:-1,n="W-E"===t.getHorizontalDirection()?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if(null!==i&&null!==i.col&&null!==i.row||(s=this.getNearestNotHiddenCoords(e,o,n)),null!==s&&t.overlaps(s)){const e=t.highlight.clone();if(e.row>=0&&(e.row=s.row),e.col>=0&&(e.col=s.col),null===this.cellRange){const t=this.settings.visualToRenderableCoords(e);this.cellRange=this.settings.createCellRange(t)}t.setHighlight(e)}return"focus"===this.settings.selectionType&&null!==i&&null===s&&t.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:t,to:e}=this.cellRange;return[Math.min(t.row,e.row),Math.min(t.col,e.col),Math.max(t.row,e.row),Math.max(t.col,e.col)]}getVisualCorners(){const t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}createRenderableCellRange(t,e){const o=this.settings.visualToRenderableCoords(t),n=this.settings.visualToRenderableCoords(e);return null===o.row||null===o.col||null===n.row||null===n.col?null:this.settings.createCellRange(o,o,n)}}var gu=uu;function fu(t){let{activeHeaderClassName:e,...o}=t;return new gu({className:e,...o,selectionType:Zd})}function mu(t){let{areaCornerVisible:e,...o}=t;return new gu({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...o,selectionType:eu})}function pu(t){let{...e}=t;return new gu({className:"highlight",...e,selectionType:eu})}function wu(t){let{columnClassName:e,...o}=t;return new gu({className:e,...o,selectionType:su})}function Cu(t){let{cellCornerVisible:e,...o}=t;return new gu({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e},...o,selectionType:ou})}function vu(t){let{border:e,visualCellRange:o,...n}=t;return new gu({...e,...n,selectionType:ru},o)}function yu(t){let{...e}=t;return new gu({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:nu})}function Su(t){let{headerClassName:e,...o}=t;return new gu({className:e,...o,selectionType:tu})}function bu(t){let{rowClassName:e,...o}=t;return new gu({className:e,...o,selectionType:iu})}let Ru;function Eu(t,e){Mu(t,e),e.add(t)}function Mu(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tu(t,e,o){return e=Hu(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Hu(t){var e=xu(t,"string");return"symbol"===typeof e?e:String(e)}function xu(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Iu(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}var Au=new WeakSet;Ru=Symbol.iterator;class ku{constructor(t){Eu(this,Au),Tu(this,"options",void 0),Tu(this,"layerLevel",0),Tu(this,"focus",void 0),Tu(this,"fill",void 0),Tu(this,"layeredAreas",new Map),Tu(this,"areas",new Map),Tu(this,"rowHeaders",new Map),Tu(this,"columnHeaders",new Map),Tu(this,"activeRowHeaders",new Map),Tu(this,"activeColumnHeaders",new Map),Tu(this,"activeCornerHeaders",new Map),Tu(this,"rowHighlights",new Map),Tu(this,"columnHighlights",new Map),Tu(this,"customSelections",[]),this.options=t,this.focus=Cu(t),this.fill=yu(t)}isEnabledFor(t,e){let o=t;t===ou&&(o="current");let n=!1;return e.isCell()&&(n=this.options.disabledCellSelection(e.row,e.col)),"string"===typeof n&&(n=[n]),!1===n||Array.isArray(n)&&!n.includes(o)}useLayerLevel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Iu(this,Au,Ou).call(this,this.layeredAreas,mu)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Iu(this,Au,Ou).call(this,this.areas,pu)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Iu(this,Au,Ou).call(this,this.rowHeaders,Su)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Iu(this,Au,Ou).call(this,this.columnHeaders,Su)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Iu(this,Au,Ou).call(this,this.activeRowHeaders,fu)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Iu(this,Au,Ou).call(this,this.activeColumnHeaders,fu)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Iu(this,Au,Ou).call(this,this.activeCornerHeaders,fu)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Iu(this,Au,Ou).call(this,this.rowHighlights,bu)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Iu(this,Au,Ou).call(this,this.columnHighlights,wu)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(t){this.customSelections.push(vu({...this.options,...t}))}clear(){this.focus.clear(),this.fill.clear(),k(this.areas.values(),(t=>{t.clear()})),k(this.layeredAreas.values(),(t=>{t.clear()})),k(this.rowHeaders.values(),(t=>{t.clear()})),k(this.columnHeaders.values(),(t=>{t.clear()})),k(this.activeRowHeaders.values(),(t=>{t.clear()})),k(this.activeColumnHeaders.values(),(t=>{t.clear()})),k(this.activeCornerHeaders.values(),(t=>{t.clear()})),k(this.rowHighlights.values(),(t=>{t.clear()})),k(this.columnHighlights.values(),(t=>{t.clear()}))}[Ru](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Ou(t,e){const o=this.layerLevel;if(t.has(o))return t.get(o);const n=e({layerLevel:o,...this.options});return t.set(o,n),n}var Pu=ku;class Nu{constructor(t){this.ranges=[],this.createCellRange=t}isEmpty(){return 0===this.size()}set(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}add(t){return this.ranges.push(this.createCellRange(t)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(t){return this.ranges.some((e=>e.includes(t)))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}var _u=Nu;function Du(t,e){Vu(t,e),e.add(t)}function Lu(t,e,o){Vu(t,e),e.set(t,o)}function Vu(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bu(t,e){var o=zu(t,e,"get");return Fu(t,o)}function Fu(t,e){return e.get?e.get.call(t):e.value}function Wu(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function ju(t,e,o){var n=zu(t,e,"set");return Uu(t,n,o),o}function zu(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Uu(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var $u=new WeakMap,Gu=new WeakMap,Yu=new WeakMap,Ku=new WeakSet,Xu=new WeakSet,qu=new WeakSet,Qu=new WeakSet,Ju=new WeakSet;class Zu{constructor(t,e){Du(this,Ju),Du(this,Qu),Du(this,qu),Du(this,Xu),Du(this,Ku),Lu(this,$u,{writable:!0,value:void 0}),Lu(this,Gu,{writable:!0,value:void 0}),Lu(this,Yu,{writable:!0,value:{x:0,y:0}}),ju(this,$u,t),ju(this,Gu,e)}transformStart(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Wu(this,Ku,tg).call(this,{x:Bu(this,Gu).navigableHeaders()?Bu(this,Gu).countRowHeaders():0,y:Bu(this,Gu).navigableHeaders()?Bu(this,Gu).countColHeaders():0});const n=Bu(this,Gu).createCellCoords(t,e);let i=Bu(this,$u).current().highlight;const s=Bu(this,Gu).visualToRenderableCoords(i);let r=0,l=0;if(this.runLocalHooks("beforeTransformStart",n),null!==s.row&&null!==s.col){const{width:t,height:e}=Wu(this,qu,og).call(this),{x:s,y:a}=Wu(this,Qu,ng).call(this,i),h=Bu(this,Gu).fixedRowsBottom(),c=Bu(this,Gu).minSpareRows(),d=Bu(this,Gu).minSpareCols(),u=Bu(this,Gu).autoWrapRow(),g=Bu(this,Gu).autoWrapCol(),f={row:a+n.row,col:s+n.col};if(f.row>=e){if(o&&c>0&&0===h)this.runLocalHooks("insertRowRequire",Bu(this,Gu).countRenderableRows());else if(g){const o=f.col+1;f.row=f.row-e,f.col=o>=t?o-t:o}}else if(f.row<0&&g){const o=f.col-1;f.row=e+f.row,f.col=o<0?t+o:o}if(f.col>=t){if(o&&d>0)this.runLocalHooks("insertColRequire",Bu(this,Gu).countRenderableColumns());else if(u){const o=f.row+1;f.row=o>=e?o-e:o,f.col=f.col-t}}else if(f.col<0&&u){const o=f.row-1;f.row=o<0?e+o:o,f.col=t+f.col}const m=Bu(this,Gu).createCellCoords(f.row,f.col),{rowDir:p,colDir:w}=Wu(this,Xu,eg).call(this,m);r=p,l=w,i=Wu(this,Ju,ig).call(this,m)}return this.runLocalHooks("afterTransformStart",i,r,l),i}transformEnd(t,e){Wu(this,Ku,tg).call(this,{x:Bu(this,Gu).navigableHeaders()?Bu(this,Gu).countRowHeaders():0,y:Bu(this,Gu).navigableHeaders()?Bu(this,Gu).countColHeaders():0});const o=Bu(this,Gu).createCellCoords(t,e),n=Bu(this,$u).current(),i=Bu(this,Gu).visualToRenderableCoords(n.highlight),s=n.to.clone();let r=0,l=0;if(this.runLocalHooks("beforeTransformEnd",o),null!==i.row&&null!==i.col){const{x:t,y:e}=Wu(this,Qu,ng).call(this,n.to),i={row:e+o.row,col:t+o.col},a=Bu(this,Gu).createCellCoords(i.row,i.col),{rowDir:h,colDir:c}=Wu(this,Xu,eg).call(this,a);r=h,l=c;const d=Wu(this,Ju,ig).call(this,a);0===o.row&&0!==o.col?s.col=d.col:0!==o.row&&0===o.col?s.row=d.row:(s.row=d.row,s.col=d.col)}return this.runLocalHooks("afterTransformEnd",s,r,l),s}}function tg(t){let{x:e,y:o}=t;ju(this,Yu,{x:e,y:o})}function eg(t){const{width:e,height:o}=Wu(this,qu,og).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=o&&(n=1,t.row=o-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function og(){return{width:Bu(this,Yu).x+Bu(this,Gu).countRenderableColumns(),height:Bu(this,Yu).y+Bu(this,Gu).countRenderableRows()}}function ng(t){const{row:e,col:o}=Bu(this,Gu).visualToRenderableCoords(t);return{x:Bu(this,Yu).x+o,y:Bu(this,Yu).y+e}}function ig(t){return t.col=t.col-Bu(this,Yu).x,t.row=t.row-Bu(this,Yu).y,Bu(this,Gu).renderableToVisualCoords(t)}yo(Zu,lh);var sg=Zu;const rg=0,lg=1,ag=2,hg=3,cg=[hg,ag],dg=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],ug=Symbol("root"),gg=Symbol("child");function fg(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ug;if(e!==ug&&e!==gg)throw new Error("The second argument is used internally only and cannot be overwritten.");const o=Array.isArray(t),n=e===ug;let i=rg;if(o){const e=t[0];if(0===t.length)i=lg;else if(n&&e instanceof xr)i=hg;else if(n&&Array.isArray(e))i=fg(e,gg);else if(t.length>=2&&t.length<=4){const e=!t.some(((t,e)=>!dg[e].includes(typeof t)));e&&(i=ag)}}return i}function mg(t){let{keepDirection:e=!1,propToCol:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!cg.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(n){const i=t===hg;let s=i?n.from.row:n[0],r=i?n.from.col:n[1],l=i?n.to.row:n[2],a=i?n.to.col:n[3];if("function"===typeof o&&("string"===typeof r&&(r=o(r)),"string"===typeof a&&(a=o(a))),$(l)&&(l=s),$(a)&&(a=r),!e){const t=s,e=r,o=l,n=a;s=Math.min(t,o),r=Math.min(e,n),l=Math.max(t,o),a=Math.max(e,n)}const h=new mr(s,r),c=new mr(l,a);return new xr(h,h,c)}}function pg(t){const e=fg(t);if(e===rg||e===lg)return[];const o=mg(e),n=new Set;k(t,(t=>{const{from:e,to:i}=o(t),s=Math.max(e.col,0),r=i.col-s+1;k(Array.from(new Array(r),((t,e)=>s+e)),(t=>{n.has(t)||n.add(t)}))}));const i=Array.from(n).sort(((t,e)=>t-e)),s=x(i,((t,e,o,n)=>(0!==o&&e===n[o-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t)),[]);return s}function wg(t){const e=fg(t);if(e===rg||e===lg)return[];const o=mg(e),n=new Set;k(t,(t=>{const{from:e,to:i}=o(t),s=Math.max(e.row,0),r=i.row-s+1;k(Array.from(new Array(r),((t,e)=>s+e)),(t=>{n.has(t)||n.add(t)}))}));const i=Array.from(n).sort(((t,e)=>t-e)),s=x(i,((t,e,o,n)=>(0!==o&&e===n[o-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t)),[]);return s}function Cg(t,e,o){vg(t,e),e.set(t,o)}function vg(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yg(t,e,o){return e=Sg(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Sg(t){var e=bg(t,"string");return"symbol"===typeof e?e:String(e)}function bg(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Rg(t,e,o){var n=Tg(t,e,"set");return Eg(t,n,o),o}function Eg(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function Mg(t,e){var o=Tg(t,e,"get");return Hg(t,o)}function Tg(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Hg(t,e){return e.get?e.get.call(t):e.value}var xg=new WeakMap;class Ig{constructor(t,e){var o=this;yg(this,"settings",void 0),yg(this,"tableProps",void 0),yg(this,"inProgress",!1),yg(this,"selectedRange",new _u(((t,e,o)=>this.tableProps.createCellRange(t,e,o)))),yg(this,"highlight",void 0),yg(this,"transformation",void 0),yg(this,"selectedByRowHeader",new Set),yg(this,"selectedByColumnHeader",new Set),Cg(this,xg,{writable:!0,value:!1}),this.settings=t,this.tableProps=e,this.highlight=new Pu({headerClassName:t.currentHeaderClassName,headerAttributes:[Ut()],activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,cellAttributes:[Ut()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(t,e)=>this.tableProps.isDisabledCellSelection(t,e),cellCornerVisible:function(){return o.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return o.isAreaCornerVisible(...arguments)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),createCellRange:(t,e,o)=>this.tableProps.createCellRange(t,e,o)}),this.transformation=new sg(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),navigableHeaders:()=>t.navigableHeaders,fixedRowsBottom:()=>t.fixedRowsBottom,minSpareRows:()=>t.minSpareRows,minSpareCols:()=>t.minSpareCols,autoWrapRow:()=>t.autoWrapRow,autoWrapCol:()=>t.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeModifyTransformStart",...e)})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("afterModifyTransformStart",...e)})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeModifyTransformEnd",...e)})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("afterModifyTransformEnd",...e)})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("insertRowRequire",...e)})),this.transformation.addLocalHook("insertColRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("insertColRequire",...e)}))}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t;const i="multiple"===this.settings.selectionMode,s=$(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,r=t.clone();this.runLocalHooks("beforeSetRangeStart"+(o?"Only":""),r),(!i||i&&!s&&$(e))&&this.selectedRange.clear(),this.selectedRange.add(r).current().setHighlight(n.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),o||this.setRangeEnd(t)}setRangeStartOnly(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;this.setRangeStart(t,e,!0,o)}setRangeEnd(t){if(this.selectedRange.isEmpty())return;const e=t.clone(),o=this.tableProps.countRows(),n=this.tableProps.countCols(),i=this.selectedRange.current().clone().setTo(t).isSingleHeader();if((o>0||n>0)&&(0===o&&e.col<0&&!i||0===n&&e.row<0&&!i))return;this.runLocalHooks("beforeSetRangeEnd",e),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),"single"===this.settings.selectionMode?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(e),o>0&&n>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const r=this.highlight.getFocus();r.clear(),this.highlight.isEnabledFor(ou,s.highlight)&&r.add(this.selectedRange.current().highlight).commit().syncWith(s);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(k(this.highlight.getAreas(),(t=>{t.clear()})),k(this.highlight.getLayeredAreas(),(t=>{t.clear()})),k(this.highlight.getRowHeaders(),(t=>{t.clear()})),k(this.highlight.getColumnHeaders(),(t=>{t.clear()})),k(this.highlight.getActiveRowHeaders(),(t=>{t.clear()})),k(this.highlight.getActiveColumnHeaders(),(t=>{t.clear()})),k(this.highlight.getActiveCornerHeaders(),(t=>{t.clear()})),k(this.highlight.getRowHighlights(),(t=>{t.clear()})),k(this.highlight.getColumnHighlights(),(t=>{t.clear()}))),this.highlight.useLayerLevel(l);const a=this.highlight.createArea(),h=this.highlight.createLayeredArea(),c=this.highlight.createRowHeader(),d=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),f=this.highlight.createActiveCornerHeader(),m=this.highlight.createRowHighlight(),p=this.highlight.createColumnHighlight();if(a.clear(),h.clear(),c.clear(),d.clear(),u.clear(),g.clear(),f.clear(),m.clear(),p.clear(),this.highlight.isEnabledFor(eu,s.highlight)&&(this.isMultiple()||l>=1)&&(a.add(s.from).add(s.to).commit(),h.add(s.from).add(s.to).commit(),1===l)){const t=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(t.from).commit().syncWith(t),this.highlight.createLayeredArea().add(t.from).commit().syncWith(t),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(tu,s.highlight)){if(!s.isSingleHeader()){const t=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),e=this.tableProps.createCellCoords(s.to.row,-1),o=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),n=this.tableProps.createCellCoords(-1,s.to.col);"single"===this.settings.selectionMode?(c.add(t).commit(),d.add(o).commit(),m.add(t).commit(),p.add(o).commit()):(c.add(t).add(e).commit(),d.add(o).add(n).commit(),m.add(t).add(e).commit(),p.add(o).add(n).commit())}const t=!Mg(this,xg)&&this.isEntireRowSelected()&&(n>0&&n===s.getWidth()||0===n&&this.isSelectedByRowHeader()),e=!Mg(this,xg)&&this.isEntireColumnSelected()&&(o>0&&o===s.getHeight()||0===o&&this.isSelectedByColumnHeader());t&&u.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),e&&g.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),t&&e&&f.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",t)}isMultiple(){const t=xo(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}transformStart(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(t,e,o))}transformEnd(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&(-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t))}isEntireRowSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const e=t=>{const{col:e}=t.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),n=this.tableProps.countCols();return(o>0&&e<0||0===o)&&t.getWidth()===n};if(-1===t)return Array.from(this.selectedRange).some((t=>e(t)));const o=this.selectedRange.peekByIndex(t);return!!o&&e(o)}isSelectedByColumnHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t))}isEntireColumnSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const e=t=>{const{row:e}=t.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),n=this.tableProps.countRows();return(o>0&&e<0||0===o)&&t.getHeight()===n};if(-1===t)return Array.from(this.selectedRange).some((t=>e(t)));const o=this.selectedRange.peekByIndex(t);return!!o&&e(o)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(t){return this.selectedRange.includes(t)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isAreaCornerVisible(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var t;let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const i=this.tableProps.countRows(),s=this.tableProps.countCols(),r=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),a=o?-l:0,h=e?-r:0;if(0===a&&0===h&&(0===i||0===s))return;let c=null===(t=this.getSelectedRange().current())||void 0===t?void 0:t.highlight;const{focusPosition:d,disableHeadersHighlight:u}=n;Rg(this,xg,u),d&&Number.isInteger(null===d||void 0===d?void 0:d.row)&&Number.isInteger(null===d||void 0===d?void 0:d.col)&&(c=this.tableProps.createCellCoords(Ci(d.row,a,i-1),Ci(d.col,h,s-1)));const g=this.tableProps.createCellCoords(a,h),f=this.tableProps.createCellCoords(i-1,s-1);this.clear(),this.setRangeStartOnly(g,void 0,c),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),a<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.finish(),Rg(this,xg,!1)}selectCells(t){const e=fg(t);if(e===lg)return!1;if(e===rg)throw new Error(j`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const o=mg(e,{propToCol:t=>this.tableProps.propToCol(t),keepDirection:!0}),n=this.settings.navigableHeaders,i={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:n?this.tableProps.countRowHeaders():0,countColHeaders:n?this.tableProps.countColHeaders():0},s=!t.some((t=>{const e=o(t),n=e.isValid(i);return!(n&&!e.containsHeaders()||n&&e.containsHeaders()&&e.isSingleHeader())}));return s&&(this.clear(),k(t,(t=>{const{from:e,to:n}=o(t);this.setRangeStartOnly(e.clone(),!1),this.setRangeEnd(n.clone()),this.finish()}))),s}selectColumns(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n="string"===typeof t?this.tableProps.propToCol(t):t,i="string"===typeof e?this.tableProps.propToCol(e):e,s=this.tableProps.countRows(),r=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),a=0===l?0:-l,h=new mr(a,n),c=new mr(s-1,i),d=new xr(h,h,c).isValid({countRows:s,countCols:r,countRowHeaders:0,countColHeaders:l});if(d){const t=0===l?0:Ci(o,a,-1),e=s-1,r=this.tableProps.createCellCoords(t,n),h=this.tableProps.createCellCoords(e,i),c=this.tableProps.createCellCoords(Ci(o,a,s-1),n);this.runLocalHooks("beforeSelectColumns",r,h,c),r.row=t,h.row=e,this.setRangeStartOnly(r,void 0,c),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.runLocalHooks("afterSelectColumns",r,h,c),this.finish()}return d}selectRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),r=0===s?0:-s,l=new mr(t,r),a=new mr(e,i-1),h=new xr(l,l,a).isValid({countRows:n,countCols:i,countRowHeaders:s,countColHeaders:0});if(h){const n=0===s?0:Ci(o,r,-1),l=i-1,a=this.tableProps.createCellCoords(t,n),h=this.tableProps.createCellCoords(e,l),c=this.tableProps.createCellCoords(t,Ci(o,r,i-1));this.runLocalHooks("beforeSelectRows",a,h,c),a.col=n,h.col=l,this.setRangeStartOnly(a,void 0,c),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.runLocalHooks("afterSelectRows",a,h,c),this.finish()}return h}refresh(){const t=this.highlight.getCustomSelections();if(t.forEach((t=>{t.commit()})),!this.isSelected())return;const e=this.highlight.getFocus(),o=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(let n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);const t=this.highlight.createArea(),e=this.highlight.createLayeredArea(),o=this.highlight.createRowHeader(),i=this.highlight.createColumnHeader(),s=this.highlight.createActiveRowHeader(),r=this.highlight.createActiveColumnHeader(),l=this.highlight.createActiveCornerHeader(),a=this.highlight.createRowHighlight(),h=this.highlight.createColumnHighlight();t.commit(),e.commit(),o.commit(),i.commit(),s.commit(),r.commit(),l.commit(),a.commit(),h.commit()}this.highlight.useLayerLevel(o)}}yo(Ig,lh);var Ag=Ig;const{register:kg,getItem:Og,hasItem:Pg,getNames:Ng,getValues:_g}=Cn("cellTypes");function Dg(t){if(!Pg(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return Og(t)}function Lg(t,e){"string"!==typeof t&&(e=t,t=e.CELL_TYPE);const{editor:o,renderer:n,validator:i}=e;o&&xn(t,o),n&&Yi(t,n),i&&ts(t,i),kg(t,e)}function Vg(t,e){var o;return"CELL_TYPE"!==t&&((null===(o=e._automaticallyAssignedMetaProps)||void 0===o?void 0:o.has(t))||!Io(e,t))}function Bg(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const n="string"===typeof e.type?Dg(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Eo(e,((e,o)=>{t._automaticallyAssignedMetaProps.delete(o)})),!bo(n))return;o!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);const i={};Eo(n,((e,n)=>{var s;Vg(n,o)&&(i[n]=e,null===(s=t._automaticallyAssignedMetaProps)||void 0===s||s.add(n))})),po(t,i)}function Fg(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function o(){}mo(o,t);for(let n=0;n<e.length;n++)o.prototype[e[n]]=void 0;return o}function Wg(t){return Number.isInteger(t)&&t>=0}function jg(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function zg(t){return null===t||void 0===t}var Ug=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,o,n;for(e=0,o=this.countRows();e<o;e++)if(n=this.getDataAtCell(e,t),!1===G(n))return!1;return!0},isEmptyRow(t){let e,o,n,i;for(e=0,o=this.countCols();e<o;e++)if(n=this.getDataAtCell(t,e),!1===G(n))return"object"===typeof n&&(i=this.getCellMeta(t,e),So(this.getSchema()[i.prop],n));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,disableTabNavigation:!1,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function $g(){return class{}}class Gg{constructor(t){this.metaCtor=$g(),this.meta=this.metaCtor.prototype,po(this.meta,Ug()),this.meta.instance=t}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(t){var e;po(this.meta,t),Bg(this.meta,{...t,type:null!==(e=t.type)&&void 0!==e?e:this.meta.type},t)}}class Yg{constructor(t){const e=t.getMetaConstructor();this.meta=new e}getMeta(){return this.meta}updateMeta(t){po(this.meta,t),Bg(this.meta,t,t)}}class Kg{constructor(t){this.valueFactory=t,this.data=[],this.index=[],this.holes=new Set}obtain(t){jg((()=>Wg(t)),"Expecting an unsigned number.");const e=this._getStorageIndexByKey(t);let o;if(e>=0)o=this.data[e],void 0===o&&(o=this.valueFactory(t),this.data[e]=o);else if(o=this.valueFactory(t),this.holes.size>0){const e=this.holes.values().next().value;this.holes.delete(e),this.data[e]=o,this.index[t]=e}else this.data.push(o),this.index[t]=this.data.length-1;return o}insert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;jg((()=>Wg(t)||zg(t)),"Expecting an unsigned number or null/undefined argument.");const o=[],n=this.data.length;for(let s=0;s<e;s++)o.push(n+s),this.data.push(void 0);const i=zg(t)?this.index.length:t;this.index=[...this.index.slice(0,i),...o,...this.index.slice(i)]}remove(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;jg((()=>Wg(t)||zg(t)),"Expecting an unsigned number or null/undefined argument.");const o=this.index.splice(zg(t)?this.index.length-e:t,e);for(let n=0;n<o.length;n++){const t=o[n];"number"===typeof t&&this.holes.add(t)}}size(){return this.data.length-this.holes.size}values(){return I(this.data,((t,e)=>!this.holes.has(e)))[Symbol.iterator]()}entries(){const t=[];for(let o=0;o<this.data.length;o++){const e=this._getKeyByStorageIndex(o);-1!==e&&t.push([e,this.data[o]])}let e=0;return{next:()=>{if(e<t.length){const o=t[e];return e+=1,{value:o,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(t){return this.index.length>t?this.index[t]:-1}_getKeyByStorageIndex(t){return this.index.indexOf(t)}[Symbol.iterator](){return this.entries()}}const Xg=["data","width"];class qg{constructor(t){this.globalMeta=t,this.metas=new Kg((()=>this._createMeta()))}updateMeta(t,e){const o=this.getMeta(t);po(o,e),Bg(o,e)}createColumn(t,e){this.metas.insert(t,e)}removeColumn(t,e){this.metas.remove(t,e)}getMeta(t){return this.metas.obtain(t)}getMetaConstructor(t){return this.metas.obtain(t).constructor}clearCache(){this.metas.clear()}_createMeta(){return Fg(this.globalMeta.getMetaConstructor(),Xg).prototype}}class Qg{constructor(t){this.columnMeta=t,this.metas=new Kg((()=>this._createRow()))}updateMeta(t,e,o){const n=this.getMeta(t,e);po(n,o),Bg(n,o)}createRow(t,e){this.metas.insert(t,e)}createColumn(t,e){for(let o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(t,e)}removeRow(t,e){this.metas.remove(t,e)}removeColumn(t,e){for(let o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(t,e)}getMeta(t,e,o){const n=this.metas.obtain(t).obtain(e);return void 0===o?n:n[o]}setMeta(t,e,o,n){var i;const s=this.metas.obtain(t).obtain(e);null===(i=s._automaticallyAssignedMetaProps)||void 0===i||i.delete(o),s[o]=n}removeMeta(t,e,o){const n=this.metas.obtain(t).obtain(e);delete n[o]}getMetas(){const t=[],e=Array.from(this.metas.values());for(let o=0;o<e.length;o++)t.push(...e[o].values());return t}getMetasAtRow(t){jg((()=>Wg(t)),"Expecting an unsigned number.");const e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Kg((t=>this._createMeta(t)))}_createMeta(t){const e=this.columnMeta.getMetaConstructor(t);return new e}}class Jg{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=t,this.globalMeta=new Gg(t),this.tableMeta=new Yg(this.globalMeta),this.columnMeta=new qg(this.globalMeta),this.cellMeta=new Qg(this.columnMeta),o.forEach((t=>new t(this))),this.globalMeta.updateMeta(e)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(t){this.globalMeta.updateMeta(t)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(t){this.tableMeta.updateMeta(t)}getColumnMeta(t){return this.columnMeta.getMeta(t)}updateColumnMeta(t,e){this.columnMeta.updateMeta(t,e)}getCellMeta(t,e,o){let{visualRow:n,visualColumn:i}=o;const s=this.cellMeta.getMeta(t,e);return s.visualRow=n,s.visualCol=i,s.row=t,s.col=e,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(t,e,o){if("string"!==typeof o)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,o)}setCellMeta(t,e,o,n){this.cellMeta.setMeta(t,e,o,n)}updateCellMeta(t,e,o){this.cellMeta.updateMeta(t,e,o)}removeCellMeta(t,e,o){this.cellMeta.removeMeta(t,e,o)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(t){return this.cellMeta.getMetasAtRow(t)}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}createColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}removeColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}yo(Jg,lh);class Zg{constructor(t){this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",(t=>this.extendCellMeta(t))),pn.getSingleton().add("beforeRender",(t=>{t&&this.metaSyncMemo.clear()}),this.metaManager.hot)}extendCellMeta(t){var e;const{row:o,col:n}=t;if(null!==(e=this.metaSyncMemo.get(o))&&void 0!==e&&e.has(n))return;const{visualRow:i,visualCol:s}=t,r=this.metaManager.hot,l=r.colToProp(s);t.prop=l,r.runHooks("beforeGetCellMeta",i,s,t);const a=Io(t,"type")?t.type:null;let h=io(t.cells)?t.cells(o,n,l):null;var c;a&&(h?h.type=null!==(c=h.type)&&void 0!==c?c:a:h={type:a});h&&this.metaManager.updateCellMeta(o,n,h),r.runHooks("afterGetCellMeta",i,s,t),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(n)}}class tf{constructor(t){this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["ariaTags",{onChange(t,e,o){if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){const e=this.metaManager.hot.isRtl();if(e&&"fixedColumnsLeft"===t)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,e,o){if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]]),this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach(((t,e)=>{const{target:o,onChange:n=(()=>{})}=t,i="string"===typeof o,s=i?o:e,r=`_${s}`;this.metaManager.globalMeta.meta[r]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(e,r,n),i&&this.installPropWatcher(o,r,n)}))}installPropWatcher(t,e,o){const n=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get(){return this[e]},set(i){const s=!n.usageTracker.has(t);n.usageTracker.add(t),o.call(n,t,i,s),this[e]=i},enumerable:!0,configurable:!0})}}const ef=/^(\r\n|\n\r|\r|\n)/,of=/^[^\t\r\n]+/,nf=/^\t/;function sf(t){const e=[[""]];if(0===t.length)return e;let o,n=0,i=0;while(t.length>0){if(o===t.length)break;if(o=t.length,t.match(nf))t=t.replace(nf,""),n+=1,e[i][n]="";else if(t.match(ef))t=t.replace(ef,""),n=0,i+=1,e[i]=[""];else{let o="";if(t.startsWith('"')){let e=0,n=!0;while(n){const i=t.slice(0,1);'"'===i&&(e+=1),o+=i,t=t.slice(1),(0===t.length||t.match(/^[\t\r\n]/)&&e%2===0)&&(n=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(t=>new Array(Math.floor(t.length/2)).fill('"').join("")))}else{const e=t.match(of);o=e?e[0]:"",t=t.slice(o.length)}e[i][n]=o}}return e}function rf(t){let e,o,n,i,s,r="";for(e=0,o=t.length;e<o;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(r+="\t"),s=t[e][n],"string"===typeof s?s.indexOf("\n")>-1?r+=`"${s.replace(/"/g,'""')}"`:r+=s:r+=null===s||void 0===s?"":s;e!==o-1&&(r+="\n")}return r}class lf{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(t,e,o){this.instance=t,this.metaManager=o,this.tableMeta=o.getTableMeta(),this.dataSource=e,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}createMap(){const t=this.getSchema();if("undefined"===typeof t)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const e=this.tableMeta.columns;let o;if(this.colToPropCache=[],this.propToColCache=new Map,e){let n=0,i=0,s=!1;if("function"===typeof e){const e=Ho(t);n=e>0?e:this.countFirstRowKeys(),s=!0}else{const t=this.tableMeta.maxCols;n=Math.min(t,e.length)}for(o=0;o<n;o++){const t=s?e(o):e[o];if(bo(t)){if("undefined"!==typeof t.data){const e=s?i:o;this.colToPropCache[e]=t.data,this.propToColCache.set(t.data,e)}i+=1}}}else this.recursiveDuckColumns(t)}countFirstRowKeys(){return th(this.dataSource)}recursiveDuckColumns(t,e,o){let n,i=e,s=o;return"undefined"===typeof i&&(i=0,s=""),"object"!==typeof t||Array.isArray(t)||Eo(t,((t,e)=>{null===t?(n=s+e,this.colToPropCache.push(n),this.propToColCache.set(n,i),i+=1):i=this.recursiveDuckColumns(t,i,`${e}.`)})),i}colToProp(t){if(!1===Number.isInteger(t))return t;const e=this.instance.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&U(this.colToPropCache[e])?this.colToPropCache[e]:e}propToCol(t){const e=this.propToColCache.get(t);if(U(e))return this.instance.toVisualColumn(e);const o=this.instance.toVisualColumn(t);return null===o?t:o}getSchema(){const t=this.tableMeta.dataSchema;return t?"function"===typeof t?t():t:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?fo(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:o,mode:n="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.instance.countSourceRows();let s=i,r=0,l=t;("number"!==typeof l||l>=i)&&(l=i),l<this.instance.countRows()&&(s=this.instance.toPhysicalRow(l));const a=this.instance.runHooks("beforeCreateRow",l,e,o);if(!1===a||null===s)return{delta:0};const h=this.tableMeta.maxRows,c=this.getSchema().length,d=[];while(r<e&&i+r<h){let t=null;"array"===this.instance.dataType?this.tableMeta.dataSchema?t=Co(this.getSchema()):(t=[],mi(c-1,(()=>t.push(null)))):"function"===this.instance.dataType?t=this.tableMeta.dataSchema(l+r):(t={},wo(t,this.getSchema())),d.push(t),r+=1}this.instance.rowIndexMapper.insertIndexes(l,r),"below"===n&&(s=Math.min(s+1,i)),this.spliceData(s,0,d);const u=this.instance.toVisualRow(s);return this.instance.countSourceRows()===d.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),r>0&&(void 0===t||null===t?this.metaManager.createRow(null,r):"auto"!==o&&this.metaManager.createRow(s,e)),this.instance.runHooks("afterCreateRow",u,r,o),this.instance.forceFullRender=!0,{delta:r,startPhysicalIndex:s}}createCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:o,mode:n="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,s=this.tableMeta.maxCols,r=this.instance.countSourceCols();let l=t;("number"!==typeof l||l>=r)&&(l=r);const a=this.instance.runHooks("beforeCreateCol",l,e,o);if(!1===a)return{delta:0};let h=r;l<this.instance.countCols()&&(h=this.instance.toPhysicalColumn(l));const c=this.instance.countSourceRows();let d=this.instance.countCols(),u=0,g=h;"end"===n&&(g=Math.min(g+1,r));const f=g;while(u<e&&d<s){if("number"!==typeof l||l>=d)if(c>0)for(let t=0;t<c;t+=1)"undefined"===typeof i[t]&&(i[t]=[]),i[t].push(null);else i.push([null]);else for(let t=0;t<c;t++)i[t].splice(g,0,null);u+=1,g+=1,d+=1}this.instance.columnIndexMapper.insertIndexes(l,u),u>0&&(void 0===t||null===t?this.metaManager.createColumn(null,u):"auto"!==o&&this.metaManager.createColumn(f,e));const m=this.instance.toVisualColumn(f);return this.instance.runHooks("afterCreateCol",m,u,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:u,startPhysicalIndex:f}}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,n=Number.isInteger(t)?t:-e;const i=this.visualRowsToPhysical(n,e),s=this.instance.countSourceRows();n=(s+n)%s;const r=this.instance.runHooks("beforeRemoveRow",n,i.length,i,o);if(!1===r)return!1;const l=i.length;if(this.filterData(n,l,i),n<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(i);const t=U(this.tableMeta.columns)||U(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===t&&this.instance.columnIndexMapper.setIndexesSequence([])}const a=i.slice(0).sort(((t,e)=>e-t));return a.forEach((t=>{this.metaManager.removeRow(t,1)})),this.instance.runHooks("afterRemoveRow",n,l,i,o),this.instance.forceFullRender=!0,!0}removeCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let n="number"!==typeof t?-e:t;n=(this.instance.countCols()+n)%this.instance.countCols();const i=this.visualColumnsToPhysical(n,e),s=i.slice(0).sort(((t,e)=>e-t)),r=this.instance.runHooks("beforeRemoveCol",n,e,i,o);if(!1===r)return!1;let l=!0;const a=s.length,h=this.dataSource;for(let c=0;c<a;c++)l&&i[0]!==i[c]-c&&(l=!1);if(l)for(let c=0,d=this.instance.countSourceRows();c<d;c++)h[c].splice(i[0],e),0===c&&this.metaManager.removeColumn(i[0],e);else for(let c=0,d=this.instance.countSourceRows();c<d;c++)for(let t=0;t<a;t++)h[c].splice(s[t],1),0===c&&this.metaManager.removeColumn(s[t],1);return n<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(i),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",n,e,i,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(t,e,o){const n=this.instance.getDataAtCol(t),i=n.slice(e,e+o),s=n.slice(e+o);for(var r=arguments.length,l=new Array(r>3?r-3:0),a=3;a<r;a++)l[a-3]=arguments[a];T(l,s);let h=0;while(h<o)l.push(null),h+=1;return M(l),this.instance.populateFromArray(e,t,l,null,null,"spliceCol"),i}spliceRow(t,e,o){const n=this.instance.getSourceDataAtRow(t),i=n.slice(e,e+o),s=n.slice(e+o);for(var r=arguments.length,l=new Array(r>3?r-3:0),a=3;a<r;a++)l[a-3]=arguments[a];T(l,s);let h=0;while(h<o)l.push(null),h+=1;return this.instance.populateFromArray(t,e,[l],null,null,"spliceRow"),i}spliceData(t,e,o){const n=this.instance.runHooks("beforeDataSplice",t,e,o);if(!1!==n){const e=[...this.dataSource.slice(0,t),...o,...this.dataSource.slice(t)];this.dataSource.length=0,e.forEach((t=>this.dataSource.push(t)))}}filterData(t,e,o){let n=this.instance.runHooks("filterData",t,e,o);!1===Array.isArray(n)&&(n=this.dataSource.filter(((t,e)=>-1===o.indexOf(e)))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,n)}get(t,e){const o=this.instance.toPhysicalRow(t);let n=this.dataSource[o];const i=this.instance.runHooks("modifyRowData",o);n=isNaN(i)?i:n;let s=null;if(n&&n.hasOwnProperty&&Io(n,e))s=n[e];else if("string"===typeof e&&e.indexOf(".")>-1){const t=e.split(".");let o=n;if(!o)return null;for(let e=0,n=t.length;e<n;e++)if(o=o[t[e]],"undefined"===typeof o)return null;s=o}else"function"===typeof e&&(s=e(this.dataSource.slice(o,o+1)[0]));if(this.instance.hasHook("modifyData")){const t=xo(s);this.instance.runHooks("modifyData",o,this.propToCol(e),t,"get"),t.isTouched()&&(s=t.value)}return s}getCopyable(t,e){return this.instance.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}set(t,e,o){const n=this.instance.toPhysicalRow(t);let i=o,s=this.dataSource[n];const r=this.instance.runHooks("modifyRowData",n);if(s=isNaN(r)?r:s,this.instance.hasHook("modifyData")){const t=xo(i);this.instance.runHooks("modifyData",n,this.propToCol(e),t,"set"),t.isTouched()&&(i=t.value)}if(s&&s.hasOwnProperty&&Io(s,e))s[e]=i;else if("string"===typeof e&&e.indexOf(".")>-1){const t=e.split(".");let o,n=s,r=0;for(r=0,o=t.length-1;r<o;r++)"undefined"===typeof n[t[r]]&&(n[t[r]]={}),n=n[t[r]];n[t[r]]=i}else"function"===typeof e?e(this.dataSource.slice(n,n+1)[0],i):s[e]=i}visualRowsToPhysical(t,e){const o=this.instance.countSourceRows(),n=[];let i,s=(o+t)%o,r=e;while(s<o&&r)i=this.instance.toPhysicalRow(s),n.push(i),r-=1,s+=1;return n}visualColumnsToPhysical(t,e){const o=this.instance.countCols(),n=[];let i=(o+t)%o,s=e;while(i<o&&s){const t=this.instance.toPhysicalColumn(i);n.push(t),s-=1,i+=1}return n}clear(){for(let t=0;t<this.instance.countSourceRows();t++)for(let e=0;e<this.instance.countCols();e++)this.set(t,this.colToProp(e),"")}getLength(){const t=this.tableMeta.maxRows;let e;e=t<0||0===t?0:t||1/0;const o=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,e)}getAll(){const t={row:0,col:0},e={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return t.row-e.row!==0||this.instance.countSourceRows()?this.getRange(t,e,lf.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(t,e,o){const n=[];let i,s,r;const l=this.tableMeta.maxRows,a=this.tableMeta.maxCols;if(0===l||0===a)return[];const h=o===lf.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,c=Math.min(Math.max(l-1,0),Math.max(t.row,e.row)),d=Math.min(Math.max(a-1,0),Math.max(t.col,e.col));for(i=Math.min(t.row,e.row);i<=c;i++){r=[];const o=i>=0?this.instance.toPhysicalRow(i):i;for(s=Math.min(t.col,e.col);s<=d;s++){if(null===o)break;r.push(h.call(this,i,this.colToProp(s)))}null!==o&&n.push(r)}return n}getText(t,e){return rf(this.getRange(t,e,lf.DESTINATION_RENDERER))}getCopyableText(t,e){return rf(this.getRange(t,e,lf.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}var af=lf;function hf(t,e,o,n){const{hotInstance:i,dataMap:s,dataSource:r,internalSource:l,source:a,metaManager:h,firstRun:c}=n,d=lt(l),u=i.getSettings();Array.isArray(u.dataSchema)?i.dataType="array":io(u.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),t=i.runHooks(`before${d}`,t,c,a);const g=new af(i,t,h);if(e(g),"object"===typeof t&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error(`${l} only accepts array of objects or array of arrays (${typeof t} given)`);{const e=g.getSchema();let o;t=[];let n=0,s=0;for(n=0,s=u.startRows;n<s;n++)if("object"!==i.dataType&&"function"!==i.dataType||!u.dataSchema)if("array"===i.dataType)o=Co(e[0]),t.push(o);else{o=[];for(let t=0,e=u.startCols;t<e;t++)o.push(null);t.push(o)}else o=Co(e),t.push(o)}}Array.isArray(t[0])&&(i.dataType="array"),u.data=t,g.dataSource=t,r.data=t,r.dataType=i.dataType,r.colToProp=g.colToProp.bind(g),r.propToCol=g.propToCol.bind(g),r.countCachedColumns=g.countCachedColumns.bind(g),o(g),i.runHooks(`after${d}`,t,c,a),c||(i.runHooks("afterChange",null,l),i.render()),i.getSettings().ariaTags&&ge(i.rootElement,[_t(i.countRows()),Dt(i.countCols())])}const cf="gridDefault",df="editorManager.handlingEditor";function uf(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=t.rootElement,n=gf(t),i=gf(t);return n.addEventListener("focus",(()=>null===e||void 0===e?void 0:e.onFocusFromTop())),i.addEventListener("focus",(()=>null===e||void 0===e?void 0:e.onFocusFromBottom())),o.firstChild.before(n),o.lastChild.after(i),{activate(){t._registerTimeout((()=>{n.tabIndex=0,i.tabIndex=0}),10)},deactivate(){t._registerTimeout((()=>{n.tabIndex=-1,i.tabIndex=-1}),10)}}}function gf(t){const e=t.rootDocument,o=e.createElement("input");return o.type="text",o.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&ge(o,[pt()]),o}function ff(t){let e;const{activate:o,deactivate:n}=uf(t,{onFocusFromTop(){var o;const n=null!==(o=e)&&void 0!==o?o:mf(t);n&&(t.runHooks("modifyFocusOnTabNavigation","from_above",n),t.selectCell(n.row,n.col)),t.listen()},onFocusFromBottom(){var o;const n=null!==(o=e)&&void 0!==o?o:pf(t);n&&(t.runHooks("modifyFocusOnTabNavigation","from_below",n),t.selectCell(n.row,n.col)),t.listen()}});t.addHook("afterListen",(()=>n())),t.addHook("afterUnlisten",(()=>o())),t.addHook("afterSelection",(()=>{var o;e=null===(o=t.getSelectedRangeLast())||void 0===o?void 0:o.highlight})),t.getShortcutManager().getContext("grid").addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:e=>{var o;const{disableTabNavigation:n,autoWrapRow:i}=t.getSettings();if(n)return t.deselectCell(),t.unlisten(),!1;const s=t.selection.isSelected(),r=null===(o=t.getSelectedRangeLast())||void 0===o?void 0:o.highlight,l=mf(t),a=pf(t);return i||(l.row=r.row,a.row=r.row),!(e.shiftKey&&(!s||r.isEqual(l))||!(e.shiftKey||s&&!r.isEqual(a)))||(t.deselectCell(),t.unlisten(),!1)},runOnlyIf:()=>!t.getSettings().minSpareCols,preventDefault:!1,stopPropagation:!1,position:"before",relativeToGroup:cf,group:"focusCatcher"})}function mf(t){const{rowIndexMapper:e,columnIndexMapper:o}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,s=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return 0===i&&(i=e.getVisualFromRenderableIndex(i)),0===s&&(s=o.getVisualFromRenderableIndex(s)),null===i||null===s?null:t._createCellCoords(i,s)}function pf(t){var e,o;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:s}=t.getSettings();let r=n.getRenderableIndexesLength()-1,l=i.getRenderableIndexesLength()-1;if(r<0){if(!s||0===t.countColHeaders())return null;r=-1}if(l<0){if(!s||0===t.countColHeaders())return null;l=-1}return t._createCellCoords(null!==(e=n.getVisualFromRenderableIndex(r))&&void 0!==e?e:r,null!==(o=i.getVisualFromRenderableIndex(l))&&void 0!==o?o:l)}const wf=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Cf=t=>t.map((t=>{const e=t.toLowerCase();return wf.has(e)?wf.get(e):e})).sort().join("+"),vf=t=>t.split("+"),yf=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),Sf=t=>{let{key:e,code:o}=t;return(yf.test(o)?o.replace(yf,"$1"):e).toLowerCase()},bf=Symbol("shortcut-context");function Rf(t){return bo(t)&&t.__kindOf===bf}const Ef=t=>{const e=Ti({errorIdExists:e=>`The "${e}" shortcut is already registered in the "${t}" context.`}),o=function(){let{keys:t,callback:o,group:n,runOnlyIf:i=(()=>!0),captureCtrl:s=!1,preventDefault:r=!0,stopPropagation:l=!1,relativeToGroup:a,position:h,forwardToContext:c}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if($(n))throw new Error("You need to define the shortcut's group.");if(!1===io(o))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(t))throw new Error(j`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const d={callback:o,group:n,runOnlyIf:i,captureCtrl:s,preventDefault:r,stopPropagation:l};U(a)&&([d.relativeToGroup,d.position]=[a,h]),Rf(c)&&(d.forwardToContext=c),t.forEach((t=>{const o=Cf(t),n=e.hasItem(o);if(n){const t=e.getItem(o);let n=t.findIndex((t=>t.group===a));-1!==n?"before"===h?n-=1:n+=1:n=t.length,t.splice(n,0,d)}else e.addItem(o,[d])}))},n=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach((t=>{Eo(e,((o,n)=>{!1===Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=e[n])})),o(t)}))},i=t=>{const o=Cf(t);e.removeItem(o)},s=t=>{const o=e.getItems();o.forEach((e=>{let[o,n]=e;const s=n.filter((e=>e.group!==t));0===s.length?i(vf(o)):(n.length=0,n.push(...s))}))},r=t=>{const o=Cf(t),n=e.getItem(o);return U(n)?n.slice():[]},l=t=>{const o=Cf(t);return e.hasItem(o)};return{__kindOf:bf,addShortcut:o,addShortcuts:n,getShortcuts:r,hasShortcut:l,removeShortcutsByKeys:i,removeShortcutsByGroup:s}};function Mf(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Tf=["meta","alt","shift","control"],Hf=Mf();let xf=0;function If(t,e,o,n,i){const s=t=>Tf.includes(t),r=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=[];return t.altKey&&o.push("alt"),e&&(t.ctrlKey||t.metaKey)?o.push("control/meta"):(t.ctrlKey&&o.push("control"),t.metaKey&&o.push("meta")),t.shiftKey&&o.push("shift"),o},l=t=>{if(!1===e(t))return;const l=o(t);if(229===t.keyCode||!1===l||on(t))return;const a=Sf(t);let h=[];s(a)||(h=r(t));const c=[a].concat(h),d=i(t,c);!d&&(Go()&&h.includes("meta")||!Go()&&h.includes("control"))&&i(t,[a].concat(r(t,!0))),n(t)},a=t=>{const e=Sf(t);s(e)&&Hf.press(e)},h=t=>{const e=Sf(t);s(e)&&Hf.release(e)},c=()=>{Hf.releaseAll()},d=()=>{let e=t;xf+=1;while(e)1===xf&&(e.document.documentElement.addEventListener("keydown",a),e.document.documentElement.addEventListener("keyup",h)),e.document.documentElement.addEventListener("keydown",l),e.document.documentElement.addEventListener("blur",c),e=ee(e)},u=()=>{let e=t;xf-=1;while(e)0===xf&&(e.document.documentElement.removeEventListener("keydown",a),e.document.documentElement.removeEventListener("keyup",h)),e.document.documentElement.removeEventListener("keydown",l),e.document.documentElement.removeEventListener("blur",c),e=ee(e)};return{mount:d,unmount:u,isPressed:t=>Hf.isPressed(t),releasePressedKeys:()=>Hf.releaseAll()}}const Af=t=>{let{ownerWindow:e,handleEvent:o,beforeKeyDown:n,afterKeyDown:i}=t;const s=Ti({errorIdExists:t=>`The "${t}" context name is already registered.`});let r="grid";const l=t=>{const e=Ef(t);return s.addItem(t,e),e},a=()=>r,h=t=>s.getItem(t),c=t=>{if(!s.hasItem(t))throw new Error(j`You've tried to activate the "${t}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);r=t};let d=!1;const u=function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a();const n=Rf(o)?o:h(o);let i=!1;if(!n.hasShortcut(e))return i;const s=n.getShortcuts(e);for(let r=0;r<s.length;r++){const{callback:o,runOnlyIf:n,preventDefault:l,stopPropagation:a,captureCtrl:h,forwardToContext:c}=s[r];if(!1!==n(t)){if(d=h,i=!1===o(t,e),d=!1,l&&t.preventDefault(),a&&(en(t),t.stopPropagation()),i)break;c&&u(t,e,c)}}return i},g=If(e,o,n,i,u);return g.mount(),{addContext:l,getActiveContextName:a,getContext:h,setActiveContextName:c,isCtrlPressed:()=>!d&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}},kf={name:"editorCloseAndSave",callback(t,e,o){const n=t._getEditorManager();n.closeEditorAndSaveChanges(t.getShortcutManager().isCtrlPressed()),n.moveSelectionAfterEnter(o.includes("shift"))}},Of={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},Pf={name:"editorFastOpen",callback(t,e){const{highlight:o}=t.getSelectedRangeLast();o.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},Nf={name:"editorOpen",callback(t,e,o){const n=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter():n.openEditor(null,e,!0):n.moveSelectionAfterEnter(o.includes("shift")),en(e))}};function _f(){return[kf,Of,Pf,Nf]}const Df={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},Lf={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),o=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),n=t.rowIndexMapper.getNearestNotHiddenIndex(o,-1);if(null!==n){const o=t._createCellCoords(n,e.col),i=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(o.row-i,t.countRows()-1);t.selection.setRangeEnd(o),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},Vf={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},Bf={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},Ff={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:o,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(o.col,n.col,e.row)}},Wf={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:o}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),r=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||r){const n=o.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),r&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(n,s.col))}}},jf={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:o}=t,{highlight:n}=t.getSelectedRangeLast();n.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,o.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},zf={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:o}=t,{highlight:n}=t.getSelectedRangeLast();n.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,o.getNearestNotHiddenIndex(0,1)))}},Uf={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:o}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),r=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||r){const n=o.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),r&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,n))}}},$f={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:o}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),r=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||r){const n=o.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),r&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,n))}}},Gf={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:o}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),r=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||r){const n=o.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),r&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(n,s.col))}}},Yf={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:o,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(o.row,n.row,e.col)}},Kf={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},Xf={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),o=Math.max(e.row-t.countVisibleRows(),0),n=t.rowIndexMapper.getNearestNotHiddenIndex(o,1);if(null!==n){const o=t._createCellCoords(n,e.col),i=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(o.row-i,0);t.selection.setRangeEnd(o),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function qf(){return[Df,Lf,Vf,Bf,Ff,Wf,jf,zf,Uf,$f,Gf,Yf,Kf,Xf]}const Qf={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},Jf={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),o=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+o;n===t.countRows()-1?i=1:n+i>t.countRows()&&(i=t.countRows()-n-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},Zf={name:"moveCellSelectionInlineEnd",callback(t,e){const o=t.getSettings(),n="function"===typeof o.tabMoves?o.tabMoves(e):o.tabMoves;t.selection.transformStart(-n.row,-n.col)}},tm={name:"moveCellSelectionInlineStart",callback(t,e){const o=t.getSettings(),n="function"===typeof o.tabMoves?o.tabMoves(e):o.tabMoves;t.selection.transformStart(n.row,n.col,!0)}},em={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},om={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},nm={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let o=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);null===o&&(o=-1),t.selection.setRangeStart(t._createCellCoords(o,e))}},im={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:o,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),s=o.getNearestNotHiddenIndex(t.countRows()-i-1,-1),r=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(s,r))}},sm={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:o}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,o.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},rm={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:o}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,s=o.getNearestNotHiddenIndex(n,1);e.setRangeStart(t._createCellCoords(i,s))}},lm={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:o}=t,n=t.getSelectedRangeLast().highlight.row;let i=o.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);null===i&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(n,i))}},am={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:o}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=o.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);null===i&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(n,i))}},hm={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let o=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===o&&(o=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(o,e))}},cm={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:o,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),r=o.getNearestNotHiddenIndex(i,1),l=n.getNearestNotHiddenIndex(s,1);e.setRangeStart(t._createCellCoords(r,l))}},dm={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},um={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),o=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+o);n===-o?i=-1:n+i<o&&(i=-(n+o)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function gm(){return[Qf,Jf,Zf,tm,em,om,nm,im,sm,rm,lm,am,hm,cm,dm,um]}const fm={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},mm={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),o=t.view.getFirstFullyVisibleRow()-1,n=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,s=t.view.getLastFullyVisibleColumn()+1,r=t._createCellCoords(o,n),l=t._createCellCoords(i,s),a=t._createCellRange(r,r,l);if(!a.includes(e)&&(e.row>=0||e.col>=0)){const o={};if(e.col>=0){const n=Math.floor(t.countVisibleCols()/2);o.col=Math.max(e.col-n,0)}if(e.row>=0){const n=Math.floor(t.countVisibleRows()/2);o.row=Math.max(e.row-n,0)}t.scrollViewportTo({...o,verticalSnap:"top",horizontalSnap:"start"})}}},pm={name:"selectAll",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},wm={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:o,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(o,n),s=new Map;for(let r=0;r<e.length;r++)e[r].forAll(((e,r)=>{if(e>=0&&r>=0&&(e!==o||r!==n)){const{readOnly:o}=t.getCellMeta(e,r);o||s.set(`${e}x${r}`,[e,r,i])}}));t.setDataAtCell(Array.from(s.values()))}},Cm=[..._f(),...qf(),...gm(),fm,mm,pm,wm];function vm(t){const e={};return Cm.forEach((o=>{let{name:n,callback:i}=o;e[n]=function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return i(t,...o)}})),e}function ym(t){const e=t.getShortcutManager().addContext("editor"),o=vm(t),n={group:df};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(t,e)=>o.editorCloseAndSave(t,e)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>o.editorCloseWithoutSaving()}],n)}function Sm(t){const e=t.getShortcutManager().addContext("grid"),o=vm(t),n={runOnlyIf:()=>{const{navigableHeaders:e}=t.getSettings();return U(t.getSelected())&&(e||!e&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:cf};e.addShortcuts([{keys:[["F2"]],callback:t=>o.editorFastOpen(t)},{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>o.editorOpen(t,e)},{keys:[["Backspace"],["Delete"]],callback:()=>o.emptySelectedCells()}],{group:df,runOnlyIf:()=>U(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"],["Control/Meta","Shift","Space"]],callback:()=>o.selectAll()},{keys:[["Control/Meta","Enter"]],callback:()=>o.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>o.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>o.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>o.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>o.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>o.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>o.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>o.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>o.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>o.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>o.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>o.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>o.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>o.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>o.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>o.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>o.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>o.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],callback:()=>o.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],callback:()=>o.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>o.scrollToFocusedCell()}],n)}function bm(t){[ym,Sm].forEach((e=>e(t)))}let Rm=null;const Em=new Map;new Set;function Mm(t,e){var o,n=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=!1,r=this;const l=new On(r);let a,h,c,d,u,g=!0;Ia(i)&&xa(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const f=null!==(o=null===e||void 0===e?void 0:e.layoutDirection)&&void 0!==o?o:"inherit",m=["rtl","ltr"].includes(f)?f:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",m),this.isRtl=function(){return"rtl"===m},this.isLtr=function(){return!r.isRtl()},this.getDirectionFactor=function(){return r.isLtr()?1:-1},e.language=Jd(e.language);const p=new Jg(r,e,[Zg,tf]),w=p.getTableMeta(),C=p.getGlobalMeta(),v=Ti();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Aa(this)&&st(e.licenseKey,t),this.guid=`ht_${ht()}`,Em.set(this.guid,this),this.columnIndexMapper=new Jh,this.rowIndexMapper=new Jh,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(t=>{r.runHooks("afterColumnSequenceChange",t)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(t=>{r.runHooks("afterRowSequenceChange",t)})),h=new ih(r),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);const y=t=>{const{row:e,col:o}=t;return r._createCellCoords(e>=0?r.rowIndexMapper.getRenderableFromVisualIndex(e):e,o>=0?r.columnIndexMapper.getRenderableFromVisualIndex(o):o)},S=t=>{const{row:e,col:o}=t;return r._createCellCoords(e>=0?r.rowIndexMapper.getVisualFromRenderableIndex(e):e,o>=0?r.columnIndexMapper.getVisualFromRenderableIndex(o):o)};let b=new Ag(w,{rowIndexMapper:r.rowIndexMapper,columnIndexMapper:r.columnIndexMapper,countCols:()=>r.countCols(),countRows:()=>r.countRows(),propToCol:t=>a.propToCol(t),isEditorOpened:()=>!!r.getActiveEditor()&&r.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>r.getShortcutManager(),createCellCoords:(t,e)=>r._createCellCoords(t,e),createCellRange:(t,e,o)=>r._createCellRange(t,e,o),visualToRenderableCoords:y,renderableToVisualCoords:S,isDisabledCellSelection:(t,e)=>r.getCellMeta(t,e).disableVisualSelection});this.selection=b;const R=t=>{let{hiddenIndexesChanged:e}=t;e&&this.selection.refresh()};function E(t){const e=tc(t);Kd(e)?(r.runHooks("beforeLanguageChange",e),C.language=e,r.runHooks("afterLanguageChange",e)):ec(t)}function M(t,e){const o="className"===t?r.rootElement:r.table;if(g)de(o,e);else{let n=[],i=[];C[t]&&(n=Array.isArray(C[t])?C[t]:W(C[t])),e&&(i=Array.isArray(e)?e:W(e));const s=V(n,i),r=V(i,n);s.length&&ue(o,s),r.length&&de(o,r)}C[t]=e}function T(){let t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function I(t){const e=t.replace(",",".");return!1===isNaN(parseFloat(e))?parseFloat(e):t}function O(t,e,o){if(!t.length)return;const n=r.getActiveEditor(),i=new T;let s=!0;i.onQueueEmpty=t=>{n&&s&&n.cancelChanges(),o(t)};for(let l=t.length-1;l>=0;l--){const[o,n,,h]=t[l],c=a.propToCol(n),d=r.getCellMeta(o,c);"numeric"===d.type&&"string"===typeof h&&fi(h)&&(t[l][3]=I(h)),r.getCellValidator(d)&&(i.addValidatorToQueue(),r.validateCell(t[l][3],d,function(e,o){return function(n){if("boolean"!==typeof n)throw new Error("Validation error: result is not boolean");if(!1===n&&!1===o.allowInvalid){s=!1,t.splice(e,1),o.valid=!0;const n=r.getCell(o.visualRow,o.visualCol);null!==n&&ue(n,w.invalidCellClassName)}i.removeValidatorFormQueue()}}(l,d),e))}i.checkIfQueueIsEmpty()}function P(t,e){let o=t.length-1;if(o<0)return;for(;o>=0;o--){let n=!1;if(null!==t[o]){if(null!==t[o][2]&&void 0!==t[o][2]||null!==t[o][3]&&void 0!==t[o][3]){if(w.allowInsertRow)while(t[o][0]>r.countRows()-1){const{delta:t}=a.createRow(void 0,void 0,{source:e});if(0===t){n=!0;break}}if("array"===r.dataType&&(!w.columns||0===w.columns.length)&&w.allowInsertColumn)while(a.propToCol(t[o][1])>r.countCols()-1){const{delta:t}=a.createCol(void 0,void 0,{source:e});if(0===t){n=!0;break}}n||a.set(t[o][0],t[o][1],t[o][3])}}else t.splice(o,1)}r.forceFullRender=!0,c.adjustRowsAndCols(),r.runHooks("beforeChangeRender",t,e),d.lockEditor(),r._refreshBorders(null),d.unlockEditor(),r.view.adjustElementsSize(),r.runHooks("afterChange",t,e||"edit");const n=r.getActiveEditor();n&&U(n.refreshValue)&&n.refreshValue()}function N(t,e,o){return Array.isArray(t)?t:[[t,e,o]]}function _(t,e){const o=r.getActiveEditor(),n=r.runHooks("beforeChange",t,e||"edit"),i=t.filter((t=>null!==t));return!1===n||0===i.length?(o&&o.cancelChanges(),[]):i}this.columnIndexMapper.addLocalHook("cacheUpdated",R),this.rowIndexMapper.addLocalHook("cacheUpdated",R),this.selection.addLocalHook("beforeHighlightSet",(()=>{this.runHooks("beforeSelectionHighlightSet")})),this.selection.addLocalHook("beforeSetRangeStart",(t=>{this.runHooks("beforeSetRangeStart",t)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(t=>{this.runHooks("beforeSetRangeStartOnly",t)})),this.selection.addLocalHook("beforeSetRangeEnd",(t=>{this.runHooks("beforeSetRangeEnd",t)})),this.selection.addLocalHook("afterSetRangeEnd",(t=>{const e=xo(!1),o=this.selection.getSelectedRange(),{from:n,to:i}=o.current(),l=o.size()-1;this.runHooks("afterSelection",n.row,n.col,i.row,i.col,e,l),this.runHooks("afterSelectionByProp",n.row,r.colToProp(n.col),i.row,r.colToProp(i.col),e,l);let a=!0;s&&(a=!1),e.isTouched()&&(a=!e.value);const h=this.selection.selectedRange.current(),c=this.selection.isSelectedByAnyHeader(),d=this.selection.isSelectedByRowHeader(),u=this.selection.isSelectedByColumnHeader();if(!1!==a)if(c)d?this.scrollViewportTo({row:t.row}):u&&this.scrollViewportTo({col:t.col});else if(h&&!this.selection.isMultiple()){const{row:t,col:e}=h.from;t<0&&e>=0?this.scrollViewportTo({col:e}):e<0&&t>=0?this.scrollViewportTo({row:t}):this.scrollViewportTo({row:t,col:e})}else this.scrollViewportTo(t.toObject());d&&u?de(this.rootElement,["ht__selection--rows","ht__selection--columns"]):d?(ue(this.rootElement,"ht__selection--columns"),de(this.rootElement,"ht__selection--rows")):u?(ue(this.rootElement,"ht__selection--rows"),de(this.rootElement,"ht__selection--columns")):ue(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(t=>{const e=t.length-1,{from:o,to:n}=t[e];this.runHooks("afterSelectionEnd",o.row,o.col,n.row,n.col,e),this.runHooks("afterSelectionEndByProp",o.row,r.colToProp(o.col),n.row,r.colToProp(n.col),e)})),this.selection.addLocalHook("afterIsMultipleSelection",(t=>{const e=this.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)})),this.selection.addLocalHook("beforeSelectColumns",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSelectColumns",...e)})),this.selection.addLocalHook("afterSelectColumns",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("afterSelectColumns",...e)})),this.selection.addLocalHook("beforeSelectRows",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("beforeSelectRows",...e)})),this.selection.addLocalHook("afterSelectRows",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return n.runHooks("afterSelectRows",...e)})),this.selection.addLocalHook("beforeModifyTransformStart",(t=>{this.runHooks("modifyTransformStart",t)})),this.selection.addLocalHook("afterModifyTransformStart",((t,e,o)=>{this.runHooks("afterModifyTransformStart",t,e,o)})),this.selection.addLocalHook("beforeModifyTransformEnd",(t=>{this.runHooks("modifyTransformEnd",t)})),this.selection.addLocalHook("afterModifyTransformEnd",((t,e,o)=>{this.runHooks("afterModifyTransformEnd",t,e,o)})),this.selection.addLocalHook("afterDeselect",(()=>{d.destroyEditor(),this._refreshBorders(),ue(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(t=>{this.alter("insert_row_above",t,1,"auto")})),this.selection.addLocalHook("insertColRequire",(t=>{this.alter("insert_col_start",t,1,"auto")})),c={alter(t,e){var o,n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0;const h=t=>{if(0===t.length)return[];const e=[...t];e.sort(((t,e)=>{let[o]=t,[n]=e;return o===n?0:o>n?1:-1}));const o=x(e,((t,e)=>{let[o,n]=e;const i=t[t.length-1],[s,r]=i,l=s+r;if(o<=l){const t=Math.max(n-(l-o),0);i[1]+=t}else t.push([o,n]);return t}),[e[0]]);return o};switch(t){case"insert_row_below":case"insert_row_above":const l=r.countSourceRows();if(w.maxRows===l)return;const d="insert_row_below"===t?"below":"above";e=null!==(o=e)&&void 0!==o?o:"below"===d?l:0;const{delta:u,startPhysicalIndex:g}=a.createRow(e,i,{source:s,mode:d});if(u){const t=b.selectedRange.current(),e=null===t||void 0===t?void 0:t.from,o=null===e||void 0===e?void 0:e.row,n=r.toVisualRow(g);if(b.isSelectedByCorner())b.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(U(o)&&o>=n){const{row:n,col:i}=t.to;let s=e.col;b.isSelectedByRowHeader()&&(s=-1),b.getSelectedRange().pop(),b.setRangeStartOnly(r._createCellCoords(o+u,s),!0),b.setRangeEnd(r._createCellCoords(n+u,i))}else r._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const f="insert_col_end"===t?"end":"start";e=null!==(n=e)&&void 0!==n?n:"end"===f?r.countSourceCols():0;const{delta:m,startPhysicalIndex:p}=a.createCol(e,i,{source:s,mode:f});if(m){if(Array.isArray(w.colHeaders)){const t=[r.toVisualColumn(p),0];t.length+=m,Array.prototype.splice.apply(w.colHeaders,t)}const t=b.selectedRange.current(),e=null===t||void 0===t?void 0:t.from,o=null===e||void 0===e?void 0:e.col,n=r.toVisualColumn(p);if(b.isSelectedByCorner())b.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(U(o)&&o>=n){const{row:n,col:i}=t.to;let s=e.row;b.isSelectedByColumnHeader()&&(s=-1),b.getSelectedRange().pop(),b.setRangeStartOnly(r._createCellCoords(s,o+m),!0),b.setRangeEnd(r._createCellCoords(n,i+m))}else r._refreshBorders()}break;case"remove_row":const C=t=>{let e=0;k(t,(t=>{let[o,n]=t;const i=G(o)?r.countRows()-1:Math.max(o-e,0);Number.isInteger(o)&&(o=Math.max(o-e,0));const l=a.removeRow(o,n,s);if(!l)return;const h=r.countRows(),c=w.fixedRowsTop;c>=i+1&&(w.fixedRowsTop-=Math.min(n,c-i));const d=w.fixedRowsBottom;d&&i>=h-d&&(w.fixedRowsBottom-=Math.min(n,d)),e+=n}))};Array.isArray(e)?C(h(e)):C([[e,i]]),c.adjustRowsAndCols(),r._refreshBorders();break;case"remove_col":const v=t=>{let e=0;k(t,(t=>{let[o,n]=t;const i=G(o)?r.countCols()-1:Math.max(o-e,0);let l=r.toPhysicalColumn(i);Number.isInteger(o)&&(o=Math.max(o-e,0));const h=a.removeCol(o,n,s);if(!h)return;const c=w.fixedColumnsStart;c>=i+1&&(w.fixedColumnsStart-=Math.min(n,c-i)),Array.isArray(w.colHeaders)&&("undefined"===typeof l&&(l=-1),w.colHeaders.splice(l,n)),e+=n}))};Array.isArray(e)?v(h(e)):v([[e,i]]),c.adjustRowsAndCols(),r._refreshBorders();break;default:throw new Error(`There is no such action "${t}"`)}l||c.adjustRowsAndCols()},adjustRowsAndCols(){const t=w.minRows,e=w.minSpareRows,o=w.minCols,n=w.minSpareCols;if(0===r.countRows()&&0===r.countCols()&&b.deselect(),t){const e=r.countRows();e<t&&a.createRow(e,t-e,{source:"auto"})}if(e){const t=r.countEmptyRows(!0);if(t<e){const o=e-t,n=Math.min(o,w.maxRows-r.countSourceRows());a.createRow(r.countRows(),n,{source:"auto"})}}{let t;(o||n)&&(t=r.countEmptyCols(!0));let e=r.countCols();if(o&&!w.columns&&e<o){const n=o-e;t+=n,a.createCol(e,n,{source:"auto"})}if(n&&!w.columns&&"array"===r.dataType&&t<n){e=r.countCols();const o=n-t,i=Math.min(o,w.maxCols-e);a.createCol(e,i,{source:"auto"})}}if(b.isSelected()){const t=r.countRows(),e=r.countCols();k(b.selectedRange,(o=>{let n=!1,i=o.from.row,s=o.from.col,l=o.to.row,a=o.to.col;i>t-1?(i=t-1,n=!0,l>i&&(l=i)):l>t-1&&(l=t-1,n=!0,i>l&&(i=l)),s>e-1?(s=e-1,n=!0,a>s&&(a=s)):a>e-1&&(a=e-1,n=!0,s>a&&(s=a)),n&&r.selectCell(i,s,l,a)}))}r.view&&r.view.adjustElementsSize()},populateFromArray(t,e,o,n,i){let s,l,a,h;const c=[],d={},u=[],g=t.row,f=t.col;if(l=e.length,0===l)return!1;let m=0,p=0;switch(bo(o)&&(m=o.col-f+1,p=o.row-g+1),i){case"shift_down":const i=H(e),C=i.length,v=Math.max(C,m),y=r.getData().slice(g),S=H(y).slice(f,f+v);for(a=0;a<v;a+=1)if(a<C){for(s=0,l=i[a].length;s<p-l;s+=1)i[a].push(i[a][s%l]);a<S.length?u.push(i[a].concat(S[a])):u.push(i[a].concat(new Array(y.length).fill(null)))}else u.push(i[a%C].concat(S[a]));r.populateFromArray(g,f,H(u));break;case"shift_right":const b=e.length,R=Math.max(b,p),E=r.getData().slice(g).map((t=>t.slice(f)));for(s=0;s<R;s+=1)if(s<b){for(a=0,h=e[s].length;a<m-h;a+=1)e[s].push(e[s][a%h]);if(s<E.length)for(let t=0;t<E[s].length;t+=1)e[s].push(E[s][t]);else e[s].push(...new Array(E[0].length).fill(null))}else e.push(e[s%l].slice(0,R).concat(E[s]));r.populateFromArray(g,f,e);break;case"overwrite":default:d.row=t.row,d.col=t.col;let M,T=0,x=0,I=!0;const A=function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=e[t%e.length];return null!==o?n[o%n.length]:n},k=e.length,O=o?o.row-t.row+1:0;for(l=o?O:Math.max(k,O),s=0;s<l;s++){if(o&&d.row>o.row&&O>k||!w.allowInsertRow&&d.row>r.countRows()-1||d.row>=w.maxRows)break;const e=s-T,i=A(e).length,u=o?o.col-t.col+1:0;if(h=o?u:Math.max(i,u),d.col=t.col,M=r.getCellMeta(d.row,d.col),"CopyPaste.paste"!==n&&"Autofill.fill"!==n||!M.skipRowOnPaste){for(x=0,a=0;a<h;a++){if(o&&d.col>o.col&&u>i||!w.allowInsertColumn&&d.col>r.countCols()-1||d.col>=w.maxCols)break;if(M=r.getCellMeta(d.row,d.col),("CopyPaste.paste"===n||"Autofill.fill"===n)&&M.skipColumnOnPaste){x+=1,d.col+=1,h+=1;continue}if(M.readOnly&&"UndoRedo.undo"!==n){d.col+=1;continue}const t=a-x;let s=A(e,t),l=r.getDataAtCell(d.row,d.col);if(null!==s&&"object"===typeof s)if(Array.isArray(s)&&null===l&&(l=[]),null===l||"object"!==typeof l)I=!1;else{const t=fo(Array.isArray(l)?l:l[0]||l),e=fo(Array.isArray(s)?s:s[0]||s);So(t,e)||Array.isArray(t)&&Array.isArray(e)?s=Co(s):I=!1}else null!==l&&"object"===typeof l&&(I=!1);I&&c.push([d.row,d.col,s]),I=!0,d.col+=1}d.row+=1}else T+=1,d.row+=1,l+=1}r.setDataAtCell(c,null,null,n||"populateFromArray");break}}},this.init=function(){h.setData(w.data),r.runHooks("beforeInit"),(jo()||Uo())&&de(r.rootElement,"mobile"),this.updateSettings(w,!0),this.view=new $a(this),d=Ln.getInstance(r,w,b),u=new oi(r),Aa(this)&&ff(r),r.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&null===r.rootElement.offsetParent&&to(r.rootElement,(()=>{r.view._wt.wtOverlays.updateLastSpreaderSize(),r.render(),r.view.adjustElementsSize()})),"object"===typeof g&&(r.runHooks("afterChange",g[0],g[1]),g=!1),r.runHooks("afterInit")},this._createCellCoords=function(t,e){return r.view._wt.createCellCoords(t,e)},this._createCellRange=function(t,e,o){return r.view._wt.createCellRange(t,e,o)},this.validateCell=function(t,e,o,n){let i=r.getCellValidator(e);function s(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!n||!0===e.hidden)return void o(t);const i=e.visualCol,s=e.visualRow,l=r.getCell(s,i,!0);if(l&&"TH"!==l.nodeName){const t=r.rowIndexMapper.getRenderableFromVisualIndex(s),e=r.columnIndexMapper.getRenderableFromVisualIndex(i);r.view._wt.getSetting("cellRenderer",t,e,l)}o(t)}Y(i)&&(i=function(t){return function(e,o){o(t.test(e))}}(i)),io(i)?(t=r.runHooks("beforeValidate",t,e.visualRow,e.prop,n),r._registerImmediate((()=>{i.call(e,t,(o=>{r&&(o=r.runHooks("afterValidate",o,t,e.visualRow,e.prop,n),e.valid=o,s(o),r.runHooks("postAfterValidate",o,t,e.visualRow,e.prop,n))}))}))):r._registerImmediate((()=>{e.valid=!0,s(e.valid,!1)}))},this.setDataAtCell=function(t,e,o,n){const i=N(t,e,o),s=[];let l,c,d,u=n;for(l=0,c=i.length;l<c;l++){if("object"!==typeof i[l])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!==typeof i[l][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");d=i[l][1]>=this.countCols()?i[l][1]:a.colToProp(i[l][1]),s.push([i[l][0],d,h.getAtCell(this.toPhysicalRow(i[l][0]),i[l][1]),i[l][2]])}u||"object"!==typeof t||(u=e);const g=_(s,n);r.runHooks("afterSetDataAtCell",g,u),O(g,u,(()=>{P(g,u)}))},this.setDataAtRowProp=function(t,e,o,n){const i=N(t,e,o),s=[];let l,a,c=n;for(l=0,a=i.length;l<a;l++)s.push([i[l][0],i[l][1],h.getAtCell(this.toPhysicalRow(i[l][0]),i[l][1]),i[l][2]]);c||"object"!==typeof t||(c=e);const d=_(s,n);r.runHooks("afterSetDataAtRowProp",d,c),O(d,c,(()=>{P(d,c)}))},this.listen=function(){r&&!r.isListening()&&(Em.forEach((t=>{r!==t&&t.unlisten()})),Rm=r.guid,r.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Rm=null,r.runHooks("afterUnlisten"))},this.isListening=function(){return Rm===r.guid},this.destroyEditor=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];r._refreshBorders(t,e)},this.populateFromArray=function(t,e,o,n,i,s,l){if("object"!==typeof o||"object"!==typeof o[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const a="number"===typeof n?r._createCellCoords(n,i):null;return c.populateFromArray(r._createCellCoords(t,e),o,a,s,l)},this.spliceCol=function(t,e,o){for(var n=arguments.length,i=new Array(n>3?n-3:0),s=3;s<n;s++)i[s-3]=arguments[s];return a.spliceCol(t,e,o,...i)},this.spliceRow=function(t,e,o){for(var n=arguments.length,i=new Array(n>3?n-3:0),s=3;s<n;s++)i[s-3]=arguments[s];return a.spliceRow(t,e,o,...i)},this.getSelected=function(){if(b.isSelected())return A(b.getSelectedRange(),(t=>{let{from:e,to:o}=t;return[e.row,e.col,o.row,o.col]}))},this.getSelectedLast=function(){const t=this.getSelected();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(b.isSelected())return Array.from(b.getSelectedRange())},this.getSelectedRangeLast=function(){const t=this.getSelectedRange();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(t){if(!b.isSelected()||0===this.countRows()||0===this.countCols())return;const e=[];k(b.getSelectedRange(),(t=>{if(t.isSingleHeader())return;const o=t.getTopStartCorner(),n=t.getBottomEndCorner();mi(o.row,n.row,(t=>{mi(o.col,n.col,(o=>{this.getCellMeta(t,o).readOnly||e.push([t,o,null])}))}))})),e.length>0&&this.setDataAtCell(e,t)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const t=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(t,0),this.isRenderSuspended()||t!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(d.lockEditor(),this._refreshBorders(null),d.unlockEditor()))},this.batchRender=function(t){this.suspendRender();const e=t();return this.resumeRender(),e},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(e,0),(!this.isExecutionSuspended()&&e===this.executionSuspendedCounter||t)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const o=t();return this.resumeExecution(e),o},this.batch=function(t){this.suspendRender(),this.suspendExecution();const e=t();return this.resumeExecution(),this.resumeRender(),e},this.refreshDimensions=function(){if(!r.view)return;const{width:t,height:e}=r.view.getLastSize(),{width:o,height:n}=r.rootElement.getBoundingClientRect(),i=o!==t||n!==e,s=!1===r.runHooks("beforeRefreshDimensions",{width:t,height:e},{width:o,height:n},i);s||((i||r.view._wt.wtOverlays.scrollableElement===r.rootWindow)&&(r.view.setLastSize(o,n),r.render()),r.runHooks("afterRefreshDimensions",{width:t,height:e},{width:o,height:n},i))},this.updateData=function(t,e){hf(t,(t=>{a=t}),(t=>{a=t,r.columnIndexMapper.fitToLength(this.getInitialColumnCount()),r.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()}),{hotInstance:r,dataMap:a,dataSource:h,internalSource:"updateData",source:e,metaManager:p,firstRun:g})},this.loadData=function(t,e){hf(t,(t=>{a=t}),(()=>{p.clearCellsCache(),r.initIndexMappers(),c.adjustRowsAndCols(),g&&(g=[null,"loadData"])}),{hotInstance:r,dataMap:a,dataSource:h,internalSource:"loadData",source:e,metaManager:p,firstRun:g})},this.getInitialColumnCount=function(){const t=w.columns;let e=0;if(Array.isArray(t))e=t.length;else if(io(t))if("array"===r.dataType){const o=this.countSourceCols();for(let n=0;n<o;n+=1)t(n)&&(e+=1)}else"object"!==r.dataType&&"function"!==r.dataType||(e=a.colToPropCache.length);else if(U(w.dataSchema)){const t=a.getSchema();e=Array.isArray(t)?t.length:Ho(t)}else e=this.countSourceCols();return e},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(t,e,o,n){return $(t)?a.getAll():a.getRange(r._createCellCoords(t,e),r._createCellCoords(o,n),a.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,o,n){return a.getCopyableText(r._createCellCoords(t,e),r._createCellCoords(o,n))},this.getCopyableData=function(t,e){return a.getCopyable(t,a.colToProp(e))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=(g?r.loadData:r.updateData).bind(this);let n,i,s=!1;if(U(t.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(U(t.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(U(t.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(n in t)"data"===n||("language"===n?E(t.language):"className"===n?M("className",t.className):"tableClassName"===n&&r.table?(M("tableClassName",t.tableClassName),r.view._wt.wtOverlays.syncOverlayTableClassNames()):pn.getSingleton().isRegistered(n)||pn.getSingleton().isDeprecated(n)?(io(t[n])||Array.isArray(t[n]))&&(t[n].initialHook=!0,r.addHook(n,t[n])):!e&&Io(t,n)&&(C[n]=t[n]));void 0===t.data&&void 0===w.data?o(null,"updateSettings"):void 0!==t.data?o(t.data,"updateSettings"):void 0!==t.columns&&(a.createMap(),r.initIndexMappers());const l=r.countCols(),h=w.columns;if(h&&io(h)&&(s=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||p.clearCache(),l>0)for(n=0,i=0;n<l;n++){if(h){const t=s?h(n):h[i];t&&p.updateColumnMeta(i,t)}i+=1}U(t.cell)&&Eo(t.cell,(t=>{r.setCellMetaObject(t.row,t.col,t)})),r.runHooks("afterCellMetaReset");let u=r.rootElement.style.height;""!==u&&(u=parseInt(r.rootElement.style.height,10));let f=t.height;if(io(f)&&(f=f()),e){const t=r.rootElement.getAttribute("style");t&&r.rootElement.setAttribute("data-initialstyle",r.rootElement.getAttribute("style"))}if(null===f){const t=r.rootElement.getAttribute("data-initialstyle");t&&(t.indexOf("height")>-1||t.indexOf("overflow")>-1)?r.rootElement.setAttribute("style",t):(r.rootElement.style.height="",r.rootElement.style.overflow="")}else void 0!==f&&(r.rootElement.style.height=isNaN(f)?`${f}`:`${f}px`,r.rootElement.style.overflow="hidden");if("undefined"!==typeof t.width){let e=t.width;io(e)&&(e=e()),r.rootElement.style.width=isNaN(e)?`${e}`:`${e}px`}e||(r.view&&(r.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),r.view._wt.exportSettingsAsClassNames()),r.runHooks("afterUpdateSettings",t)),c.adjustRowsAndCols(),r.view&&!g&&(r.forceFullRender=!0,d.lockEditor(),r._refreshBorders(null),r.view._wt.wtOverlays.adjustElementsSize(),d.unlockEditor()),e||!r.view||""!==u&&""!==f&&void 0!==f||u===f||r.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const t=r.getSelectedLast();if(w.getValue){if(io(w.getValue))return w.getValue.call(r);if(t)return r.getData()[t[0][0]][w.getValue]}else if(t)return r.getDataAtCell(t[0],t[1])},this.getSettings=function(){return w},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,o,n,i){c.alter(t,e,o,n,i)},this.getCell=function(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e,i=t;if(e>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(e)))return null;n=this.columnIndexMapper.getRenderableFromVisualIndex(e)}if(t>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(t)))return null;i=this.rowIndexMapper.getRenderableFromVisualIndex(t)}return null===i||null===n?null:r.view.getCellAtCoords(r._createCellCoords(i,n),o)},this.getCoords=function(t){const e=this.view._wt.wtTable.getCoords(t);if(null===e)return null;const{row:o,col:n}=e;let i=o,s=n;return o>=0&&(i=this.rowIndexMapper.getVisualFromRenderableIndex(o)),n>=0&&(s=this.columnIndexMapper.getVisualFromRenderableIndex(n)),r._createCellCoords(i,s)},this.colToProp=function(t){return a.colToProp(t)},this.propToCol=function(t){return a.propToCol(t)},this.toVisualRow=t=>this.rowIndexMapper.getVisualFromPhysicalIndex(t),this.toVisualColumn=t=>this.columnIndexMapper.getVisualFromPhysicalIndex(t),this.toPhysicalRow=t=>this.rowIndexMapper.getPhysicalFromVisualIndex(t),this.toPhysicalColumn=t=>this.columnIndexMapper.getPhysicalFromVisualIndex(t),this.getDataAtCell=function(t,e){return a.get(t,a.colToProp(e))},this.getDataAtRowProp=function(t,e){return a.get(t,e)},this.getDataAtCol=function(t){const e=[],o=a.getRange(r._createCellCoords(0,t),r._createCellCoords(w.data.length-1,t),a.DESTINATION_RENDERER);for(let n=0;n<o.length;n+=1)for(let t=0;t<o[n].length;t+=1)e.push(o[n][t]);return e},this.getDataAtProp=function(t){const e=[],o=a.getRange(r._createCellCoords(0,a.propToCol(t)),r._createCellCoords(w.data.length-1,a.propToCol(t)),a.DESTINATION_RENDERER);for(let n=0;n<o.length;n+=1)for(let t=0;t<o[n].length;t+=1)e.push(o[n][t]);return e},this.getSourceData=function(t,e,o,n){let i;return i=void 0===t?h.getData():h.getByRange(r._createCellCoords(t,e),r._createCellCoords(o,n)),i},this.getSourceDataArray=function(t,e,o,n){let i;return i=void 0===t?h.getData(!0):h.getByRange(r._createCellCoords(t,e),r._createCellCoords(o,n),!0),i},this.getSourceDataAtCol=function(t){return h.getAtColumn(t)},this.setSourceDataAtCell=function(t,e,o,n){const i=N(t,e,o),s=this.hasHook("afterSetSourceDataAtCell"),l=[];s&&k(i,(t=>{let[e,o,n]=t;l.push([e,o,h.getAtCell(e,o),n])})),k(i,(t=>{let[e,o,n]=t;h.setAtCell(e,o,n)})),s&&this.runHooks("afterSetSourceDataAtCell",l,n),this.render();const a=r.getActiveEditor();a&&U(a.refreshValue)&&a.refreshValue()},this.getSourceDataAtRow=function(t){return h.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return h.getAtCell(t,e)},this.getDataAtRow=function(t){const e=a.getRange(r._createCellCoords(t,0),r._createCellCoords(t,this.countCols()-1),a.DESTINATION_RENDERER);return e[0]||[]},this.getDataType=function(t,e,o,n){const i=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,o,n],[s,r]=i;let[,,l,a]=i,h=null,c=null;void 0===l&&(l=s),void 0===a&&(a=r);let d="mixed";return mi(Math.max(Math.min(s,l),0),Math.max(s,l),(t=>{let e=!0;return mi(Math.max(Math.min(r,a),0),Math.max(r,a),(o=>{const n=this.getCellMeta(t,o);return c=n.type,h?e=h===c:h=c,e})),d=e?c:"mixed",e})),d},this.removeCellMeta=function(t,e,o){const[n,i]=[this.toPhysicalRow(t),this.toPhysicalColumn(e)];let s=p.getCellMetaKeyValue(n,i,o);const l=r.runHooks("beforeRemoveCellMeta",t,e,o,s);!1!==l&&(p.removeCellMeta(n,i,o),r.runHooks("afterRemoveCellMeta",t,e,o,s)),s=null},this.spliceCellsMeta=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var o=arguments.length,n=new Array(o>2?o-2:0),i=2;i<o;i++)n[i-2]=arguments[i];if(n.length>0&&!Array.isArray(n[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");e>0&&p.removeRow(this.toPhysicalRow(t),e),n.length>0&&k(n.reverse(),(e=>{p.createRow(this.toPhysicalRow(t)),k(e,((e,o)=>this.setCellMetaObject(t,o,e)))})),r.render()},this.setCellMetaObject=function(t,e,o){"object"===typeof o&&Eo(o,((o,n)=>{this.setCellMeta(t,e,n,o)}))},this.setCellMeta=function(t,e,o,n){const i=r.runHooks("beforeSetCellMeta",t,e,o,n);if(!1===i)return;let s=t,l=e;t<this.countRows()&&(s=this.toPhysicalRow(t)),e<this.countCols()&&(l=this.toPhysicalColumn(e)),p.setCellMeta(s,l,o,n),r.runHooks("afterSetCellMeta",t,e,o,n)},this.getCellsMeta=function(){return p.getCellsMeta()},this.getCellMeta=function(t,e){let o=this.toPhysicalRow(t),n=this.toPhysicalColumn(e);return null===o&&(o=t),null===n&&(n=e),p.getCellMeta(o,n,{visualRow:t,visualColumn:e})},this.getCellMetaAtRow=function(t){return p.getCellsMetaAtRow(t)},this.isColumnModificationAllowed=function(){return!("object"===r.dataType||w.columns)},this.getCellRenderer=function(t,e){const o="number"===typeof t?r.getCellMeta(t,e).renderer:t.renderer;return"string"===typeof o?Gi(o):$(o)?Gi("text"):o},this.getCellEditor=function(t,e){const o="number"===typeof t?r.getCellMeta(t,e).editor:t.editor;return"string"===typeof o?Hn(o):$(o)?Hn("text"):o},this.getCellValidator=function(t,e){const o="number"===typeof t?r.getCellMeta(t,e).validator:t.validator;return"string"===typeof o?Zi(o):o},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,o){const n=new T;t&&(n.onQueueEmpty=t);let i=r.countRows()-1;while(i>=0){if(void 0!==e&&-1===e.indexOf(i)){i-=1;continue}let t=r.countCols()-1;while(t>=0)void 0===o||-1!==o.indexOf(t)?(n.addValidatorToQueue(),r.validateCell(r.getDataAtCell(i,t),r.getCellMeta(i,t),(t=>{if("boolean"!==typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(n.valid=!1),n.removeValidatorFormQueue()}),"validateCells"),t-=1):t-=1;i-=1}n.checkIfQueueIsEmpty()},this.getRowHeader=function(t){let e=w.rowHeaders,o=t;return void 0!==o&&(o=r.runHooks("modifyRowHeader",o)),void 0===o?(e=[],mi(r.countRows()-1,(t=>{e.push(r.getRowHeader(t))}))):Array.isArray(e)&&void 0!==e[o]?e=e[o]:io(e)?e=e(o):e&&"string"!==typeof e&&"number"!==typeof e&&(e=o+1),e},this.hasRowHeaders=function(){return!!w.rowHeaders},this.hasColHeaders=function(){if(void 0!==w.colHeaders&&null!==w.colHeaders)return!!w.colHeaders;for(let t=0,e=r.countCols();t<e;t++)if(r.getColHeader(t))return!0;return!1},this.getColHeader=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const o=r.runHooks("modifyColHeader",t);if(void 0===o){const t=[],e=r.countCols();for(let o=0;o<e;o++)t.push(r.getColHeader(o));return t}let n=w.colHeaders;const i=function(t){const e=[],o=r.countCols();let n=0;for(;n<o;n++)io(w.columns)&&w.columns(n)&&e.push(n);return e[t]},s=r.toPhysicalColumn(o),l=i(s);return!1===w.colHeaders?n=null:w.columns&&io(w.columns)&&w.columns(l)&&w.columns(l).title?n=w.columns(l).title:w.columns&&w.columns[s]&&w.columns[s].title?n=w.columns[s].title:Array.isArray(w.colHeaders)&&void 0!==w.colHeaders[s]?n=w.colHeaders[s]:io(w.colHeaders)?n=w.colHeaders(s):w.colHeaders&&"string"!==typeof w.colHeaders&&"number"!==typeof w.colHeaders&&(n=Ka(o)),n=r.runHooks("modifyColumnHeaderValue",n,t,e),n},this._getColWidthFromSettings=function(t){let e;if(t>=0){const o=r.getCellMeta(0,t);e=o.width}if(void 0!==e&&e!==w.width||(e=w.colWidths),void 0!==e&&null!==e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t);break;default:break}"string"===typeof e&&(e=parseInt(e,10))}return e},this.getColWidth=function(t){let e=r._getColWidthFromSettings(t);return e=r.runHooks("modifyColWidth",e,t),void 0===e&&(e=Ll.DEFAULT_WIDTH),e},this._getRowHeightFromSettings=function(t){let e=w.rowHeights;if(void 0!==e&&null!==e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t);break;default:break}"string"===typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){let e=r._getRowHeightFromSettings(t);return e=r.runHooks("modifyRowHeight",e,t),e},this.countSourceRows=function(){return h.countRows()},this.countSourceCols=function(){return h.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const t=w.maxCols,e=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(t,e)},this.countRenderedRows=function(){return r.view._wt.drawn?r.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return r.view._wt.drawn?r.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return r.view._wt.drawn?r.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return r.view._wt.drawn?r.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return pi(r.countRows()-1,(o=>{if(r.isEmptyRow(o))e+=1;else if(!0===t)return!1})),e},this.countEmptyCols=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return pi(r.countCols()-1,(o=>{if(r.isEmptyCol(o))e+=1;else if(!0===t)return!1})),e},this.isEmptyRow=function(t){return w.isEmptyRow.call(r,t)},this.isEmptyCol=function(t){return w.isEmptyCol.call(r,t)},this.selectCell=function(t,e,o,n){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!$(t)&&!$(e)&&this.selectCells([[t,e,o,n]],i,s)},this.selectCells=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===e&&(s=!0);const n=b.selectCells(t);return n&&o&&r.listen(),s=!1,n},this.selectColumns=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2?arguments[2]:void 0;return b.selectColumns(t,e,o)},this.selectRows=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2?arguments[2]:void 0;return b.selectRows(t,e,o)},this.deselectCell=function(){b.deselect()},this.selectAll=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2?arguments[2]:void 0;s=!0,b.selectAll(t,e,o),s=!1};const D=(t,e)=>t.getNearestNotHiddenIndex(e,1,!0);function L(t){return()=>{throw new Error(`The "${t}" method cannot be called because this Handsontable instance has been destroyed`)}}this.scrollViewportTo=function(){let t,e,o,n,{row:i,col:s,verticalSnap:l,horizontalSnap:a,considerHiddenIndexes:h}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};void 0!==l&&(t="top"===l,e=!t),void 0!==a&&(o="start"===a,n=!o);let c=i,d=s;if(void 0===h||h){const t=Number.isInteger(i)&&i>=0,e=Number.isInteger(s)&&s>=0,o=t?D(this.rowIndexMapper,i):void 0,n=e?D(this.columnIndexMapper,s):void 0;if(null===o||null===n)return!1;c=t?r.rowIndexMapper.getRenderableFromVisualIndex(o):i,d=e?r.columnIndexMapper.getRenderableFromVisualIndex(n):s}const u=Number.isInteger(c),g=Number.isInteger(d);return u&&c>=0&&g&&d>=0?r.view.scrollViewport(r._createCellCoords(c,d),t,n,e,o):u&&c>=0&&(g&&d<0||!g)?r.view.scrollViewportVertically(c,t,e):!!(g&&d>=0&&(u&&c<0||!u))&&r.view.scrollViewportHorizontally(d,n,o)},this.scrollToFocusedCell=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",t);const{highlight:e}=this.getSelectedRangeLast(),o=this.scrollViewportTo(e.toObject());o?this.view.render():(this.removeHook("afterScroll",t),this._registerImmediate((()=>t())))},this.destroy=function(){if(r._clearTimeouts(),r._clearImmediates(),r.view&&r.view.destroy(),h&&h.destroy(),h=null,this.getShortcutManager().destroy(),p.clearCache(),Em.delete(this.guid),Aa(r)){const t=this.rootDocument.querySelector(".hot-display-license-info");t&&t.parentNode.removeChild(t)}pe(r.rootElement),l.destroy(),d&&d.destroy(),r.batchExecution((()=>{r.rowIndexMapper.unregisterAll(),r.columnIndexMapper.unregisterAll(),v.getItems().forEach((t=>{let[,e]=t;e.destroy()})),v.clear(),r.runHooks("afterDestroy")}),!0),pn.getSingleton().destroy(r),Eo(r,((t,e,o)=>{io(t)?o[e]=L(e):"guid"!==e&&(o[e]=null)})),r.isDestroyed=!0,a&&a.destroy(),a=null,c=null,b=null,d=null,r=null},this.getActiveEditor=function(){return d.getActiveEditor()},this.getPlugin=function(t){const e=lt(t);return"UndoRedo"===e?this.undoRedo:v.getItem(e)},this.getPluginName=function(t){return t===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:v.getId(t)},this.getInstance=function(){return r},this.addHook=function(t,e){pn.getSingleton().add(t,e,r)},this.hasHook=function(t){return pn.getSingleton().has(t,r)||pn.getSingleton().has(t)},this.addHookOnce=function(t,e){pn.getSingleton().once(t,e,r)},this.removeHook=function(t,e){pn.getSingleton().remove(t,e,r)},this.runHooks=function(t,e,o,n,i,s,l){return pn.getSingleton().run(r,t,e,o,n,i,s,l)},this.getTranslatedPhrase=function(t,e){return qd(w.language,t,e)},this.toHTML=()=>ci(this),this.toTableElement=()=>{const t=this.rootDocument.createElement("div");return t.insertAdjacentHTML("afterbegin",ci(this)),t.firstElementChild},this.timeouts=[],this._registerTimeout=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=t;"function"===typeof o&&(o=setTimeout(o,e)),this.timeouts.push(o)},this._clearTimeouts=function(){k(this.timeouts,(t=>{clearTimeout(t)}))},this.immediates=[],this._registerImmediate=function(t){this.immediates.push(setImmediate(t))},this._clearImmediates=function(){k(this.immediates,(t=>{clearImmediate(t)}))},this._refreshBorders=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];d.destroyEditor(t),r.view.render(),e&&b.isSelected()&&d.prepareEditor()},this._getEditorManager=function(){return d},this.isRtl=function(){return"rtl"===r.rootWindow.getComputedStyle(r.rootElement).direction},this.isLtr=function(){return!r.isRtl()},this.getDirectionFactor=function(){return r.isLtr()?1:-1};const B=Af({handleEvent(){return r.isListening()},beforeKeyDown:t=>this.runHooks("beforeKeyDown",t),afterKeyDown:t=>{this.isDestroyed||r.runHooks("afterDocumentKeyDown",t)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",(t=>{!1===t.ctrlKey&&!1===t.metaKey&&B.releasePressedKeys()})),this.getShortcutManager=function(){return B},this.getFocusManager=function(){return u},_i().forEach((t=>{const e=Di(t);v.addItem(t,new e(this))})),bm(r),B.setActiveContextName("grid"),pn.getSingleton().run(r,"construct")}const Tm="hooksRefRegisterer",Hm={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){k(this._hooksStorage[t]||[],(e=>{this.hot.removeHook(t,e)}))},clearHooks(){Eo(this._hooksStorage,((t,e)=>this.removeHooksByKey(e))),this._hooksStorage={}}};Ro(Hm,"MIXIN_NAME",Tm,{writable:!1,enumerable:!1});var xm=Hm;const Im="base",Am=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),km="baseEditor";class Om{static get EDITOR_TYPE(){return Im}constructor(t){this.hot=t,this.instance=t,this.state=Am.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}_fireCallbacks(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(t,e,o,n,i,s){this.TD=n,this.row=t,this.col=e,this.prop=o,this.originalValue=i,this.cellProperties=s,this.state=Am.VIRGIN}extend(){return class extends this.constructor{}}saveValue(t,e){let o,n,i,s;if(e){const t=this.hot.getSelectedLast();o=Math.max(Math.min(t[0],t[2]),0),n=Math.max(Math.min(t[1],t[3]),0),i=Math.max(t[0],t[2]),s=Math.max(t[1],t[3])}else[o,n,i,s]=[this.row,this.col,null,null];const r=this.hot.runHooks("modifyGetCellCoords",o,n);Array.isArray(r)&&([o,n]=r);const l=this.hot.getShortcutManager(),a=l.getContext("editor"),h={runOnlyIf:()=>U(this.hot.getSelected()),group:km};this.isInFullEditMode()&&a.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],h),this.hot.populateFromArray(o,n,t,i,s,"edit")}beginEditing(t,e){if(this.state!==Am.VIRGIN)return;const o=this.hot,n=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(n,i)),this.state=Am.EDITING,this.isInFullEditMode()){const e="string"===typeof t?t:z(this.originalValue);this.setValue(e)}this.open(e),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(t,e,o){let n;if(o){const t=this._closeCallback;this._closeCallback=e=>{t&&t(e),o(e),this.hot.view.render()}}if(this.isWaiting())return;const i=this.hot.getShortcutManager(),s=i.getContext("editor");if(s.removeShortcutsByGroup(km),s.removeShortcutsByGroup(Nn),this.state!==Am.VIRGIN){if(this.state===Am.EDITING){if(t)return this.cancelChanges(),void this.hot.view.render();const o=this.getValue();n=this.cellProperties.trimWhitespace?[["string"===typeof o?String.prototype.trim.call(o||""):o]]:[[o]],this.state=Am.WAITING,this.saveValue(n,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(t=>{this.state=Am.FINISHED,this.discardEditor(t)})):(this.state=Am.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((()=>{this._fireCallbacks(!0)}))}cancelChanges(){this.state=Am.FINISHED,this.discardEditor()}discardEditor(t){if(this.state===Am.FINISHED)if(!1===t&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=Am.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Am.VIRGIN,this._fireCallbacks(!0);const t=this.hot.getShortcutManager();t.setActiveContextName("grid")}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Am.WAITING}getEditedCellRect(){var t;const e=this.getEditedCell();if(!e)return;const{wtOverlays:o,wtViewport:n}=this.hot.view._wt,i=this.hot.rootWindow,s=Se(e),r=ke(e),l=Se(this.hot.rootElement),a=ke(this.hot.rootElement),h=o.topOverlay.holder,c=o.inlineStartOverlay.holder,d=h!==i?h.scrollTop:0,u=c!==i?c.scrollLeft:0,g=i.innerWidth-l.left-a,{wtTable:f}=null!==(t=o.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt,m=f.name,p=["master","inline_start"].includes(m)?d:0,w=["master","top","bottom"].includes(m)?u:0,C=s.top===l.top?0:1;let v=s.top-l.top-C-p,y=0;y=this.hot.isRtl()?i.innerWidth-s.left-r-g-1+w:s.left-l.left-1-w,["top","top_inline_start_corner"].includes(m)&&(v+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(y+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));const S=this.hot.hasColHeaders(),b=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),R=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),E=this.hot.rowIndexMapper.getRenderableIndexesLength(),M=E-this.hot.view._wt.getSetting("fixedRowsBottom");(S&&b<=0||b===M)&&(v+=1),R<=0&&(y+=1);const T=n.rowsRenderCalculator.startPosition,H=n.columnsRenderCalculator.startPosition,x=Math.abs(o.inlineStartOverlay.getScrollPosition()),I=o.topOverlay.getScrollPosition(),A=Ue(this.hot.rootDocument);let k=e.offsetTop;if(["inline_start","master"].includes(m)&&(k+=T-I),["bottom","bottom_inline_start_corner"].includes(m)){const{wtViewport:t,wtTable:e}=o.bottomOverlay.clone;k+=t.getWorkspaceHeight()-e.getHeight()-A}let O=e.offsetLeft;this.hot.isRtl()?(O=O>=0?f.getWidth()-e.offsetLeft:Math.abs(O),O+=H-x-r):["top","master","bottom"].includes(m)&&(O+=H-x);const P=Ae(this.TD,this.hot.rootWindow),N=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",_=parseInt(P[N],10)>0?0:1,D=parseInt(P.borderTopWidth,10)>0?0:1,L=ke(e)+_,V=Oe(e)+D,B=$e(h)?A:0,F=Ge(c)?A:0,W=this.hot.view.maximumVisibleElementWidth(O)-B+_,j=Math.max(this.hot.view.maximumVisibleElementHeight(k)-F+D,23);return{top:v,start:y,height:V,maxHeight:j,width:L,maxWidth:W}}getEditedCellsLayerClass(){const t=this.checkEditorSection();switch(t){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const t=this.hot.countRows();let e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}function Pm(){var t,e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},o=document.body,n=document.createTextNode(""),i=document.createElement("SPAN"),s=function(t,e,o){t.addEventListener(e,o,!1)},r=function(t,e,o){t.removeEventListener(e,o,!1)},l=function(s){var r,l;s?/^[a-zA-Z \.,\\\/\|0-9]$/.test(s)||(s="."):s="",void 0!==n.textContent?n.textContent=t.value+s:n.data=t.value+s,i.style.position="absolute",i.style.fontSize=d(t).fontSize,i.style.fontFamily=d(t).fontFamily,i.style.whiteSpace="pre",o.appendChild(i),r=i.clientWidth+2,o.removeChild(i),t.style.height=e.minHeight+"px",e.minWidth>r?t.style.width=e.minWidth+"px":r>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=r+"px",l=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>l?t.style.height=e.minHeight+"px":e.maxHeight<l?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=l+"px"},a=function(){window.setTimeout(l,0)},h=function(o){if(o&&o.minHeight)if("inherit"==o.minHeight)e.minHeight=t.clientHeight;else{var s=parseInt(o.minHeight);isNaN(s)||(e.minHeight=s)}if(o&&o.maxHeight)if("inherit"==o.maxHeight)e.maxHeight=t.clientHeight;else{var r=parseInt(o.maxHeight);isNaN(r)||(e.maxHeight=r)}if(o&&o.minWidth)if("inherit"==o.minWidth)e.minWidth=t.clientWidth;else{var l=parseInt(o.minWidth);isNaN(l)||(e.minWidth=l)}if(o&&o.maxWidth)if("inherit"==o.maxWidth)e.maxWidth=t.clientWidth;else{var a=parseInt(o.maxWidth);isNaN(a)||(e.maxWidth=a)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))},c=function(o,n,i){t=o,h(n),"TEXTAREA"==t.nodeName&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),i&&(s(t,"change",l),s(t,"cut",a),s(t,"paste",a),s(t,"drop",a),s(t,"keydown",a),s(t,"focus",l),s(t,"compositionstart",a),s(t,"compositionupdate",a),s(t,"compositionend",a)),l()};function d(t){return t.currentStyle||document.defaultView.getComputedStyle(t)}return{init:function(t,e,o){c(t,e,o)},unObserve:function(){r(t,"change",l),r(t,"cut",a),r(t,"paste",a),r(t,"drop",a),r(t,"keydown",a),r(t,"focus",l),r(t,"compositionstart",a),r(t,"compositionupdate",a),r(t,"compositionend",a)},resize:l}}function Nm(t,e){const o=Le(e),n=e.value.split("\n");let i=o,s=0;for(let r=0;r<n.length;r++){const e=n[r];0!==r&&(s+=n[r-1].length+1);const l=s+e.length;if("home"===t?i=s:"end"===t&&(i=l),o<=l)break}We(e,i)}yo(Om,xm);const _m="ht_editor_visible",Dm="ht_editor_hidden",Lm="textEditor",Vm="text";class Bm extends Om{static get EDITOR_TYPE(){return Vm}constructor(t){super(t),this.eventManager=new On(this),this.autoResize=Pm(),this.TEXTAREA=void 0,this.textareaStyle=void 0,this.TEXTAREA_PARENT=void 0,this.textareaParentStyle=void 0,this.layerClass=void 0,this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",(()=>this.destroy()))}getValue(){return this.TEXTAREA.value}setValue(t){this.TEXTAREA.value=t}open(){this.refreshDimensions(),this.showEditableElement();const t=this.hot.getShortcutManager();t.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",(t=>this.onAfterDocumentKeyDown(t))),this.registerShortcuts()}close(){this.autoResize.unObserve(),Zt(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(t,e,o,n,i,s){const r=this.state;if(super.prepare(t,e,o,n,i,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:t}=s;t&&(this.TEXTAREA.value=""),r!==Am.FINISHED&&this.hideEditableElement()}}beginEditing(t,e){this.state===Am.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(t,e))}focus(){this.TEXTAREA.select(),We(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:t}=this.hot;this.TEXTAREA=t.createElement("TEXTAREA"),ge(this.TEXTAREA,[["data-hot-input",""],ft(-1)]),this.hot.getSettings().ariaTags&&ge(this.TEXTAREA,[kt()]),de(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),de(this.TEXTAREA_PARENT,"handsontableInputHolder"),ce(this.TEXTAREA_PARENT,this.layerClass)&&ue(this.TEXTAREA_PARENT,this.layerClass),de(this.TEXTAREA_PARENT,Dm),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Fo()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ue(this.TEXTAREA_PARENT,this.layerClass),de(this.TEXTAREA_PARENT,Dm)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const t=this.TEXTAREA_PARENT.childNodes;let e=!1;mi(t.length-1,(o=>{const n=t[o];if(ce(n,"handsontableEditor"))return e=!0,!1})),ce(this.TEXTAREA_PARENT,Dm)&&ue(this.TEXTAREA_PARENT,Dm),e?(this.layerClass=_m,de(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),de(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==Am.EDITING&&!t)return;if(this.TD=this.getEditedCell(),!this.TD)return void(t||this.close());const{top:e,start:o,width:n,maxWidth:i,height:s,maxHeight:r}=this.getEditedCellRect();this.textareaParentStyle.top=`${e}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${o}px`,this.showEditableElement();const l=Ae(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const a=Ae(this.TEXTAREA),h=parseInt(a.paddingLeft,10)+parseInt(a.paddingRight,10),c=parseInt(a.paddingTop,10)+parseInt(a.paddingBottom,10),d=n-h,u=s-c,g=i-h,f=r-c;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,g),minHeight:Math.min(u,f),maxWidth:g,maxHeight:f},!0)}bindEvents(){zo()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(()=>this.finishEditing(!1))),this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>{this.refreshDimensions(),this.state===Am.EDITING&&this.focus()})),this.addHook("afterRowResize",(()=>{this.refreshDimensions(),this.state===Am.EDITING&&this.focus()}))}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor"),o={runOnlyIf:()=>U(this.hot.getSelected()),group:Lm},n=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Tab"]],callback:t=>{const e=this.hot.getSettings(),o="function"===typeof e.tabMoves?e.tabMoves(t):e.tabMoves;this.hot.selection.transformStart(o.row,o.col,!0)}},{keys:[["Shift","Tab"]],callback:t=>{const e=this.hot.getSettings(),o="function"===typeof e.tabMoves?e.tabMoves(t):e.tabMoves;this.hot.selection.transformStart(-o.row,-o.col)}},{keys:[["Control","Enter"]],callback:()=>(n(),!1),runOnlyIf:t=>!this.hot.selection.isMultiple()&&!t.altKey},{keys:[["Meta","Enter"]],callback:()=>(n(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(n(),!1)},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(t,e)=>{let[o]=e;Nm(o,this.TEXTAREA)}},{keys:[["End"]],callback:(t,e)=>{let[o]=e;Nm(o,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout((()=>{this.autoResize.resize()}),10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout((()=>{this.autoResize.resize()}),10)}}],o)}unregisterShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(Nn),e.removeShortcutsByGroup(Lm),e.removeShortcutsByGroup(km)}onAfterDocumentKeyDown(t){const e=[Ko.ARROW_UP,Ko.ARROW_RIGHT,Ko.ARROW_DOWN,Ko.ARROW_LEFT];-1===e.indexOf(t.keyCode)&&this.autoResize.resize(String.fromCharCode(t.keyCode))}}const Fm="base";function Wm(t,e,o,n,i,s,r){const l=r.ariaTags,a=[],h=[],c=[],d=[];r.className&&de(e,r.className),r.readOnly?(a.push(r.readOnlyCellClassName),l&&d.push(Wt())):l&&c.push(Wt()[0]),!1===r.valid&&r.invalidCellClassName?(a.push(r.invalidCellClassName),l&&d.push(jt())):(h.push(r.invalidCellClassName),l&&c.push(jt()[0])),!1===r.wordWrap&&r.noWordWrapClassName&&a.push(r.noWordWrapClassName),!s&&r.placeholder&&a.push(r.placeholderCellClassName),ue(e,h),de(e,a),fe(e,c),ge(e,d)}Wm.RENDERER_TYPE=Fm;const jm="text";function zm(t,e,o,n,i,s,r){Wm.apply(this,[t,e,o,n,i,s,r]);let l=s;if(!l&&r.placeholder&&(l=r.placeholder),l=z(l),r.trimWhitespace&&(l=l.trim()),r.rendererTemplate){pe(e);const n=t.rootDocument.createElement("TEMPLATE");n.setAttribute("bind","{{}}"),n.innerHTML=r.rendererTemplate,HTMLTemplateElement.decorate(n),n.model=t.getSourceDataAtRow(o),e.appendChild(n)}else ve(e,l)}zm.RENDERER_TYPE=jm;const Um="text",$m={CELL_TYPE:Um,editor:Bm,renderer:zm};function Gm(t,e){const o=new Mm(t,e||{},Ha);return o.init(),o}Lg($m),Gm.editors={BaseEditor:Om},Gm.Core=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Mm(t,e,Ha)},Gm.DefaultSettings=Ug(),Gm.hooks=pn.getSingleton(),Gm.CellCoords=mr,Gm.CellRange=xr,Gm.packageName="handsontable",Gm.buildDate="24/10/2023 10:51:05",Gm.version="13.1.0",Gm.languages={dictionaryKeys:Bd,getLanguageDictionary:Yd,getLanguagesDictionaries:Xd,registerLanguageDictionary:$d,getTranslatedPhrase:qd};var Ym=Gm,Km=o(1711);function Xm(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function qm(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?Xm(Object(o),!0).forEach((function(e){ep(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Xm(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function Qm(t){return Qm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qm(t)}function Jm(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zm(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cp(n.key),n)}}function tp(t,e,o){return e&&Zm(t.prototype,e),o&&Zm(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function ep(t,e,o){return e=cp(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function op(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ip(t,e)}function np(t){return np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},np(t)}function ip(t,e){return ip=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ip(t,e)}function sp(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function rp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lp(t,e){if(e&&("object"===typeof e||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return rp(t)}function ap(t){var e=sp();return function(){var o,n=np(t);if(e){var i=np(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return lp(this,o)}}function hp(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function cp(t){var e=hp(t,"string");return"symbol"===typeof e?e:String(e)}var dp=Symbol("unassigned"),up=null,gp="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function fp(t){t.hotInstance&&(t.hotInstance.addHook("beforeChange",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateCol",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveCol",(function(){t.__internalEdit=!0})))}function mp(t){var e=Ym.hooks.getRegistered(),o={};for(var n in Object.assign(o,Ym.DefaultSettings),o)o[n]={default:dp};for(var i=0;i<e.length;i++)o[e[i]]={default:dp};return o.settings={default:dp},"HotTable"===t&&(o.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},o.wrapperRendererCacheSize={type:Number,default:3e3}),o}function pp(t){var e={},o=t["settings"];if(o!==dp)for(var n in o)o.hasOwnProperty(n)&&o[n]!==dp&&(e[n]=o[n]);for(var i in t)t.hasOwnProperty(i)&&"settings"!==i&&t[i]!==dp&&(e[i]=t[i]);return e}function wp(t,e){var o=pp(t),n=t.settings?t.settings:o,i=t.settings?o:null,s={};for(var r in n)!n.hasOwnProperty(r)||void 0===n[r]||e&&"data"!==r&&Sp(e[r],n[r])||(s[r]=n[r]);for(var l in i)!i.hasOwnProperty(l)||"id"===l||"settings"===l||"wrapperRendererCacheSize"===l||void 0===i[l]||e&&"data"!==l&&Sp(e[l],i[l])||(s[l]=i[l]);return s}function Cp(t,e){var o=null;return t.every((function(t,n){return!t.data||!t.data.attrs||void 0===t.data.attrs[e]||(o=t,!1)})),o}function vp(t){return t.filter((function(t){return"HotColumn"===t.$options.name}))}function yp(t,e,o,n){var i=e.$el?e.$el.ownerDocument:document,s={propsData:o,parent:e,data:n};up||(up=i.createElement("DIV"),up.id="vueHotComponents",i.body.appendChild(up));var r=i.createElement("DIV");return up.appendChild(r),new t.componentOptions.Ctor(s).$mount(r)}function Sp(t,e){return JSON.stringify(t)===JSON.stringify(e)}var bp="13.1.0";"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self&&self;function Rp(t,e){return e={exports:{}},t(e,e.exports),e.exports}var Ep=Rp((function(t,e){(function(t,o){var n=e;o(n)})(0,(function(t){var e=Symbol("newer"),o=Symbol("older");function n(t,e){"number"!==typeof t&&(e=t,t=0),this.size=0,this.limit=t,this.oldest=this.newest=void 0,this._keymap=new Map,e&&(this.assign(e),t<1&&(this.limit=this.size))}function i(t,n){this.key=t,this.value=n,this[e]=void 0,this[o]=void 0}t.LRUMap=n,n.prototype._markEntryAsUsed=function(t){t!==this.newest&&(t[e]&&(t===this.oldest&&(this.oldest=t[e]),t[e][o]=t[o]),t[o]&&(t[o][e]=t[e]),t[e]=void 0,t[o]=this.newest,this.newest&&(this.newest[e]=t),this.newest=t)},n.prototype.assign=function(t){var n,s=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var r=t[Symbol.iterator](),l=r.next();!l.done;l=r.next()){var a=new i(l.value[0],l.value[1]);if(this._keymap.set(a.key,a),n?(n[e]=a,a[o]=n):this.oldest=a,n=a,0==s--)throw new Error("overflow")}this.newest=n,this.size=this._keymap.size},n.prototype.get=function(t){var e=this._keymap.get(t);if(e)return this._markEntryAsUsed(e),e.value},n.prototype.set=function(t,n){var s=this._keymap.get(t);return s?(s.value=n,this._markEntryAsUsed(s),this):(this._keymap.set(t,s=new i(t,n)),this.newest?(this.newest[e]=s,s[o]=this.newest):this.oldest=s,this.newest=s,++this.size,this.size>this.limit&&this.shift(),this)},n.prototype.shift=function(){var t=this.oldest;if(t)return this.oldest[e]?(this.oldest=this.oldest[e],this.oldest[o]=void 0):(this.oldest=void 0,this.newest=void 0),t[e]=t[o]=void 0,this._keymap["delete"](t.key),--this.size,[t.key,t.value]},n.prototype.has=function(t){return this._keymap.has(t)}}))})),Mp=Ep.LRUMap,Tp={name:"HotTable",props:mp("HotTable"),watch:{mergedHotSettings:function(t){this.hotInstance&&void 0!==t&&(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var t=this,e=new Mp(this.wrapperRendererCacheSize);return e.shift=function(){var t=Mp.prototype.shift.call(this);return t[1].component.$destroy(),t},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:e,editorCache:new Map,get hotInstance(){return!t.__hotInstance||t.__hotInstance&&!t.__hotInstance.isDestroyed?t.__hotInstance:(console.warn(gp),null)},set hotInstance(e){t.__hotInstance=e}}},computed:{mergedHotSettings:function(){return wp(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var t=this.getGlobalRendererVNode(),e=this.getGlobalEditorVNode(),o=wp(this.$props);o.columns=this.columnSettings?this.columnSettings:o.columns,e&&(o.editor=this.getEditorClass(e,this),e.child.$destroy()),t&&(o.renderer=this.getRendererWrapper(t,this),t.child.$destroy()),this.hotInstance=new Ym.Core(this.$el,o),this.hotInstance.init(),fp(this),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var e,o=this.hotInstance.getSourceData(),n=[],i=[],s=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),r=this.hotInstance.isColumnModificationAllowed(),l=0;if(o&&o.length!==s&&o.length<s)for(var a=o.length;a<s;a++)n.push(a);if(r)if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),o&&o[0]&&(null===(e=o[0])||void 0===e?void 0:e.length)!==l&&o[0].length<l)for(var h=o[0].length;h<l;h++)i.push(h);this.hotInstance.batch((function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(s-1,o.length-s),r&&0!==o.length&&(i.length>0?t.hotInstance.columnIndexMapper.removeIndexes(i):t.hotInstance.columnIndexMapper.insertIndexes(l-1,o[0].length-l))}))}},getGlobalRendererVNode:function(){var t=this.$slots["default"]||[];return Cp(t,"hot-renderer")},getGlobalEditorVNode:function(){var t=this.$slots["default"]||[];return Cp(t,"hot-editor")},getColumnSettings:function(){var t=vp(this.$children),e=!1,o=t.map((function(t){return t.usesRendererComponent&&(e=!0),qm({},t.columnSettings)}));return e&&this.settings&&(!1!==this.settings.autoColumnSize||this.settings.autoRowSize)&&(!1!==this.autoColumnSize||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),o.length?o:void 0},getRendererWrapper:function(t,e){var o=this;return function(n,i,s,r,l,a,h){if(i&&!i.getAttribute("ghost-table")){var c=o.rendererCache,d={hotInstance:n,TD:i,row:s,col:r,prop:l,value:a,cellProperties:h,isRenderer:!0};if(c&&!c.has("".concat(s,"-").concat(r))){var u=yp(t,e,t.componentOptions.propsData,d);c.set("".concat(s,"-").concat(r),{component:u,lastUsedTD:null})}var g=c.get("".concat(s,"-").concat(r)),f=g.component,m=g.lastUsedTD;if(Object.assign(f.$data,d),!f.$el.parentElement||m!==i){while(i.firstChild)i.removeChild(i.firstChild);i.appendChild(f.$el),g.lastUsedTD=i}}return i}},getEditorClass:function(t,e){var o=t.key?t.key.toString():null,n=t.componentOptions.Ctor.options.name,i=o?"".concat(n,":").concat(o):n,s=this.editorCache,r=null;return s.has(i)?r=s.get(i):(r=yp(t,e,t.componentOptions.propsData,{isEditor:!0}),s.set(i,r)),r.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:bp};function Hp(t,e,o,n,i,s,r,l,a,h){"boolean"!==typeof r&&(a=l,l=r,r=!1);const c="function"===typeof o?o.options:o;let d;if(t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),n&&(c._scopeId=n),s?(d=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,a(t)),t&&t._registeredComponents&&t._registeredComponents.add(s)},c._ssrRegister=d):e&&(d=r?function(t){e.call(this,h(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,l(t))}),d)if(c.functional){const t=c.render;c.render=function(e,o){return d.call(o),t(e,o)}}else{const t=c.beforeCreate;c.beforeCreate=t?[].concat(t,d):[d]}return o}var xp=Tp,Ip=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:t.id}},[t._t("default")],2)},Ap=[],kp=void 0,Op=void 0,Pp=void 0,Np=!1,_p=Hp({render:Ip,staticRenderFns:Ap},kp,xp,Op,Np,Pp,!1,void 0,void 0,void 0);mp("HotColumn");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function Dp(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r}function Lp(t){return Lp="function"===typeof Symbol&&"symbol"===Qm(Symbol.iterator)?function(t){return Qm(t)}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":Qm(t)},Lp(t)}function Vp(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Bp(t){return Fp(t)||Wp(t)||jp()}function Fp(t){if(Array.isArray(t)){for(var e=0,o=new Array(t.length);e<t.length;e++)o[e]=t[e];return o}}function Wp(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function jp(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function zp(){return"undefined"!==typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function Up(t,e){$p(t,e),Object.getOwnPropertyNames(e.prototype).forEach((function(o){$p(t.prototype,e.prototype,o)})),Object.getOwnPropertyNames(e).forEach((function(o){$p(t,e,o)}))}function $p(t,e,o){var n=o?Reflect.getOwnMetadataKeys(e,o):Reflect.getOwnMetadataKeys(e);n.forEach((function(n){var i=o?Reflect.getOwnMetadata(n,e,o):Reflect.getOwnMetadata(n,e);o?Reflect.defineMetadata(n,i,t,o):Reflect.defineMetadata(n,i,t)}))}var Gp={__proto__:[]},Yp=Gp instanceof Array;function Kp(t){var e=Lp(t);return null==t||"object"!==e&&"function"!==e}function Xp(t,e){var o=e.prototype._init;e.prototype._init=function(){var e=this,o=Object.getOwnPropertyNames(t);if(t.$options.props)for(var n in t.$options.props)t.hasOwnProperty(n)||o.push(n);o.forEach((function(o){Object.defineProperty(e,o,{get:function(){return t[o]},set:function(e){t[o]=e},configurable:!0})}))};var n=new e;e.prototype._init=o;var i={};return Object.keys(n).forEach((function(t){void 0!==n[t]&&(i[t]=n[t])})),i}var qp=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function Qp(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.name=e.name||t._componentTag||t.name;var o=t.prototype;Object.getOwnPropertyNames(o).forEach((function(t){if("constructor"!==t)if(qp.indexOf(t)>-1)e[t]=o[t];else{var n=Object.getOwnPropertyDescriptor(o,t);void 0!==n.value?"function"===typeof n.value?(e.methods||(e.methods={}))[t]=n.value:(e.mixins||(e.mixins=[])).push({data:function(){return Vp({},t,n.value)}}):(n.get||n.set)&&((e.computed||(e.computed={}))[t]={get:n.get,set:n.set})}})),(e.mixins||(e.mixins=[])).push({data:function(){return Xp(this,t)}});var n=t.__decorators__;n&&(n.forEach((function(t){return t(e)})),delete t.__decorators__);var i=Object.getPrototypeOf(t.prototype),s=i instanceof Km.Z?i.constructor:Km.Z,r=s.extend(e);return Zp(r,t,s),zp()&&Up(r,t),r}var Jp={prototype:!0,arguments:!0,callee:!0,caller:!0};function Zp(t,e,o){Object.getOwnPropertyNames(e).forEach((function(n){if(!Jp[n]){var i=Object.getOwnPropertyDescriptor(t,n);if(!i||i.configurable){var s=Object.getOwnPropertyDescriptor(e,n);if(!Yp){if("cid"===n)return;var r=Object.getOwnPropertyDescriptor(o,n);if(!Kp(s.value)&&r&&r.value===s.value)return}Object.defineProperty(t,n,s)}}}))}function tw(t){return"function"===typeof t?Qp(t):function(e){return Qp(e,t)}}tw.registerHooks=function(t){qp.push.apply(qp,Bp(t))};var ew=function(t){op(o,t);var e=ap(o);function o(){var t;return Jm(this,o),t=e.apply(this,arguments),t.name="BaseEditorComponent",t.instance=null,t.row=null,t.col=null,t.prop=null,t.TD=null,t.originalValue=null,t.cellProperties=null,t.state=null,t.hot=null,t}return tp(o,[{key:"mounted",value:function(){var t=this;this.$data.hotCustomEditorClass=function(){var e=function(e){op(n,e);var o=ap(n);function n(e){var i;return Jm(this,n),i=o.call(this,e),t.$data.hotCustomEditorInstance=rp(i),i}return tp(n,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),n}(Ym.editors.BaseEditor);return Object.getOwnPropertyNames(Ym.editors.BaseEditor.prototype).forEach((function(o){"constructor"!==o&&(e.prototype[o]=function(){for(var e,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(e=t[o]).call.apply(e,[this].concat(i))})})),e}()}},{key:"_fireCallbacks",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];(t=Ym.editors.BaseEditor.prototype._fireCallbacks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"beginEditing",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.beginEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"cancelChanges",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.cancelChanges).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"checkEditorSection",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.checkEditorSection).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"close",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.close).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"discardEditor",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.discardEditor).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"enableFullEditMode",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.enableFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"extend",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.extend).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"finishEditing",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.finishEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"focus",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.focus).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getValue",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.getValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"init",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.init).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"isInFullEditMode",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.isInFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"isOpened",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.isOpened).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"isWaiting",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.isWaiting).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"open",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.open).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"prepare",value:function(t,e,o,n,i,s){return this.$data.hotInstance=s.instance,this.$data.row=t,this.$data.col=e,this.$data.prop=o,this.$data.TD=n,this.$data.originalValue=i,this.$data.cellProperties=s,Ym.editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,t,e,o,n,i,s)}},{key:"saveValue",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.saveValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"setValue",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.setValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"addHook",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.addHook).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"removeHooksByKey",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.removeHooksByKey).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"clearHooks",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.clearHooks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCell",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.getEditedCell).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCellRect",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.getEditedCellRect).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCellsZIndex",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCellsLayerClass",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=Ym.editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}}]),o}(Km.Z);ew=Dp([tw({})],ew);var ow=[[!1,"Tagcat","United Kingdom","Classic Vest","11/10/2020","01-2331942",!0,"172",2,2],[!0,"Zoomzone","Indonesia","Cycling Cap","03/05/2020","88-2768633",!0,"188",6,2],[!0,"Meeveo","United States","Full-Finger Gloves","27/03/2020","51-6775945",!0,"162",1,3],[!1,"Buzzdog","Philippines","HL Mountain Frame","29/08/2020","44-4028109",!0,"133",7,1],[!0,"Katz","India","Half-Finger Gloves","02/10/2020","08-2758492",!0,"87",1,3],[!1,"Jaxbean","China","HL Road Frame","28/09/2020","84-3557705",!1,"26",8,1],[!1,"Wikido","Brazil","HL Touring Frame","24/06/2020","20-9397637",!1,"110",4,1],[!1,"Browsedrive","United States","LL Mountain Frame","13/03/2020","36-0079556",!0,"50",4,4],[!1,"Twinder","United Kingdom","LL Road Frame","06/04/2020","41-1489542",!1,"160",6,1],[!1,"Jetwire","China","LL Touring Frame","01/02/2020","37-1531629",!0,"30",8,5],[!1,"Chatterpoint","China","Long-Sleeve Logo Jersey","14/07/2020","25-5083429",!0,"39",7,2],[!1,"Twinder","Egypt","Men's Bib-Shorts","31/08/2020","04-4281278",!1,"96",6,1],[!1,"Midel","United States","Men's Sports Shorts","27/06/2020","55-1711908",!0,"108",10,3],[!1,"Yodo","India","ML Mountain Frame","16/03/2020","58-8360815",!1,"46",1,1],[!1,"Camido","Russia","ML Mountain Frame-W","13/09/2020","10-3786104",!0,"97",8,3],[!1,"Eire","Thailand","ML Road Frame","10/04/2020","45-1186054",!0,"161",1,4],[!1,"Vinte","United Kingdom","ML Road Frame-W","22/01/2020","62-6202742",!0,"58",4,3],[!1,"Twitterlist","China","Mountain Bike Socks","09/11/2020","88-9646223",!0,"92",8,3],[!1,"Eidel","Bangladesh","Mountain-100","19/09/2020","45-5588112",!0,"5",6,5],[!1,"Trunyx","Nigeria","Mountain-200","09/03/2020","66-6271819",!0,"158",4,1],[!1,"Katz","Turkey","Mountain-300","05/03/2020","38-9245023",!1,"121",5,4],[!1,"Kaymbo","United States","Mountain-400-W","24/12/2020","44-5916927",!1,"61",5,4],[!1,"Ozu","Pakistan","Mountain-500","13/06/2020","31-5449914",!0,"155",2,2],[!1,"Rhynyx","India","Racing Socks","05/12/2020","19-9413869",!0,"162",2,4],[!1,"Flashset","Iran","Road-150","14/12/2020","25-9807605",!1,"46",7,1],[!1,"Yata","Congo (Kinshasa)","Road-250","12/06/2020","74-4291983",!0,"47",4,4],[!1,"Brainlounge","Vietnam","Road-350-W","10/03/2020","83-0980643",!0,"104",2,3],[!1,"Babblestorm","United States","Road-450","10/10/2020","19-2878430",!0,"101",6,4],[!1,"Youspan","Brazil","Road-550-W","16/12/2020","19-1838230",!0,"150",10,3],[!1,"Nlounge","China","Road-650","31/10/2020","32-2267938",!0,"42",4,2],[!1,"Twinte","India","Road-750","17/08/2020","79-2821972",!0,"144",9,3],[!1,"Oyonder","United Kingdom","Short-Sleeve Classic Jersey","04/12/2020","46-6597557",!0,"195",4,1],[!1,"Gigabox","Pakistan","Sport-100","03/02/2020","15-1793960",!0,"199",4,4],[!1,"Livetube","France","Touring-1000","16/05/2020","86-0811003",!0,"110",4,5],[!1,"Voomm","United Kingdom","Touring-2000","15/07/2020","95-3068680",!0,"51",4,4],[!1,"Voonyx","China","Touring-3000","27/11/2020","35-3085360",!1,"69",2,5],[!1,"Zoombeat","United States","Women's Mountain Shorts","03/11/2020","56-8673088",!1,"53",2,3],[!1,"Roomm","China","Women's Tights","16/03/2020","76-0085918",!0,"168",1,1],[!1,"Leenti","China","Mountain-400","16/05/2020","03-0893276",!1,"58",1,4],[!1,"Jetpulse","United States","Road-550","08/02/2020","79-9013306",!0,"152",9,3],[!1,"Katz","Peru","Road-350","15/02/2020","55-7799920",!0,"66",4,2],[!1,"Cogidoo","India","LL Mountain Front Wheel","04/06/2020","07-0881122",!1,"112",9,2],[!1,"Divavu","Colombia","Touring Rear Wheel","24/02/2020","58-6157387",!0,"50",10,4],[!1,"Mydeo","China","Touring Front Wheel","07/12/2020","12-2810010",!1,"31",3,5],[!1,"Browsebug","Japan","ML Mountain Front Wheel","14/01/2020","64-9249984",!0,"132",5,5],[!1,"Layo","China","HL Mountain Front Wheel","24/04/2020","45-0739652",!0,"45",1,5],[!1,"Snaptags","United Kingdom","LL Touring Handlebars","06/08/2020","09-5712761",!0,"197",4,2],[!1,"Cogilith","China","HL Touring Handlebars","31/05/2020","01-7345008",!0,"190",4,3],[!1,"Reallinks","United Kingdom","LL Road Front Wheel","14/05/2020","62-1065350",!0,"184",3,4],[!1,"Quaxo","United States","ML Road Front Wheel","23/03/2020","44-7241323",!0,"169",3,4],[!1,"Devify","China","HL Road Front Wheel","12/12/2020","52-0295699",!1,"152",4,4],[!1,"Youopia","Angola","LL Mountain Handlebars","01/04/2020","52-2650922",!1,"182",6,4],[!1,"Ainyx","China","Touring Pedal","27/02/2020","48-3618525",!0,"141",6,1],[!1,"Browsetype","Malaysia","ML Mountain Handlebars","28/04/2020","51-8893923",!0,"169",7,1],[!1,"Muxo","China","HL Mountain Handlebars","22/08/2020","68-5911361",!1,"39",7,1],[!1,"Bubbletube","China","LL Road Handlebars","04/10/2020","41-5880042",!0,"71",8,3],[!1,"Fadeo","Vietnam","ML Road Handlebars","23/04/2020","90-5913983",!0,"148",10,3],[!1,"Yadel","United Kingdom","HL Road Handlebars","18/04/2020","92-0960699",!0,"116",8,1],[!1,"Blognation","China","LL Headset","10/01/2020","06-9493898",!0,"96",10,1],[!1,"Devpoint","China","ML Headset","25/12/2020","69-5878565",!0,"35",4,2],[!1,"Aibox","United Kingdom","HL Headset","18/03/2020","13-1133017",!0,"16",8,2],[!1,"Brightdog","China","LL Mountain Pedal","11/09/2020","39-6530433",!0,"194",2,5],[!1,"Gabcube","Nigeria","ML Mountain Pedal","22/04/2020","96-6860388",!0,"24",1,3],[!1,"Muxo","China","HL Mountain Pedal","05/06/2020","30-0356137",!0,"170",4,4],[!1,"Tambee","China","ML Touring Seat/Saddle","22/02/2020","93-9058255",!0,"184",9,5],[!1,"Cogilith","India","LL Touring Seat/Saddle","06/04/2020","82-9268909",!1,"153",10,4],[!1,"Dynabox","Hong Kong","HL Touring Seat/Saddle","10/01/2020","20-6913815",!1,"88",10,1],[!1,"Shuffledrive","Sudan","LL Road Pedal","16/09/2020","08-8238817",!0,"57",9,2],[!1,"Fivechat","China","ML Road Pedal","26/08/2020","44-7370350",!1,"62",4,1],[!1,"Meembee","United States","HL Road Pedal","27/12/2020","01-3525949",!0,"123",2,4],[!1,"Dynazzy","United Kingdom","LL Mountain Seat/Saddle 1","15/12/2020","04-2414623",!0,"77",10,5],[!1,"Eare","China","ML Mountain Seat/Saddle 1","04/04/2020","15-1917509",!1,"199",9,4],[!1,"Yozio","China","HL Mountain Seat/Saddle 1","15/03/2020","06-2526845",!0,"149",8,2],[!1,"Quinu","Xi'an","425-777-7829","22/02/2020","83-1713558",!1,"191",9,5],[!1,"Jazzy","United Kingdom","ML Road Seat/Saddle 1","07/08/2020","00-8892524",!0,"150",10,2],[!1,"Thoughtsphere","China","HL Road Seat/Saddle 1","28/11/2020","39-5538991",!0,"130",7,3],[!1,"Leenti","China","ML Road Rear Wheel","29/12/2020","06-9002973",!0,"179",1,2],[!1,"Quaxo","United Kingdom","HL Road Rear Wheel","06/09/2020","73-6104901",!0,"98",5,3],[!1,"Tanoodle","Chile","LL Mountain Seat/Saddle 2","24/05/2020","68-7384479",!0,"175",2,3],[!1,"Feednation","China","ML Mountain Seat/Saddle 2","21/11/2020","26-7757763",!0,"11",1,3],[!1,"Kayveo","China","HL Mountain Seat/Saddle 2","21/06/2020","07-4873562",!1,"184",7,4],[!1,"Meevee","Saudi Arabia","LL Road Seat/Saddle 1","16/11/2020","46-5819554",!1,"27",9,3],[!1,"Twitterworks","China","ML Road Seat/Saddle 2","19/04/2020","01-2666826",!0,"186",3,2],[!1,"Wikizz","Tanzania","HL Road Seat/Saddle 2","08/03/2020","54-7090503",!0,"20",3,3],[!1,"Yoveo","United States","LL Mountain Tire","14/10/2020","78-7658520",!1,"153",2,1],[!1,"Yakidoo","China","ML Mountain Tire","12/10/2020","23-9926318",!0,"161",8,5],[!1,"Oyope","China","HL Mountain Tire","20/09/2020","20-0179517",!0,"98",10,5],[!1,"Skipstorm","United States","LL Road Tire","01/10/2020","02-9543343",!0,"30",7,3],[!1,"Minyx","United States","ML Road Tire","07/07/2020","98-3938169",!0,"73",10,2],[!1,"Miboo","China","HL Road Tire","25/07/2020","68-5197934",!0,"158",9,1],[!1,"Realfire","United States","Touring Tire","27/08/2020","39-8260460",!0,"122",5,2],[!1,"Shufflester","China","Mountain Tire Tube","08/06/2020","45-9776170",!0,"33",2,4],[!1,"Ntag","China","Road Tire Tube","06/12/2020","45-0858451",!0,"107",6,2],[!1,"Jabberbean","United States","Touring Tire Tube","26/04/2020","15-4247305",!0,"15",1,2],[!1,"Thoughtblab","China","LL Bottom Bracket","21/05/2020","15-8534931",!0,"168",5,2],[!1,"Jabbertype","China","Classic Vest","25/07/2020","23-1251557",!0,"135",4,2],[!1,"Buzzshare","United Kingdom","Cycling Cap","07/07/2020","86-5920601",!0,"11",1,4],[!1,"Roodel","United States","Full-Finger Gloves","13/01/2020","48-1055459",!0,"41",6,4],[!1,"Zoovu","China","Half-Finger Gloves","03/06/2020","12-7842022",!0,"144",6,1],[!1,"Photofeed","China","HL Mountain Frame","14/07/2020","94-5088099",!0,"106",1,4]],nw="selected",iw="odd";function sw(){return ow}const rw="handsontableEditor",lw="handsontable";class aw extends Bm{static get EDITOR_TYPE(){return lw}open(){super.open(),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),We(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions(),this.hot.getSettings().ariaTags&&ge(this.TD,[Bt("true")])}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&ge(this.TD,[Bt("false")])}prepare(t,e,o,n,i,s){super.prepare(t,e,o,n,i,s);const r=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(t,e){const o=this.getSourceData(e.row,e.col);void 0!==o&&r.setValue(o),r.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&po(l,s.handsontable),this.htOptions=l}beginEditing(t,e){const o=this.hot.getSettings().onBeginEditing;o&&!1===o()||super.beginEditing(t,e)}createElements(){super.createElements();const t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}finishEditing(t,e,o){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const t=this.htEditor.getValue();void 0!==t&&this.setValue(t)}super.finishEditing(t,e,o)}assignHooks(){this.hot.addHook("afterDestroy",(()=>{this.htEditor&&this.htEditor.destroy()}))}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor");super.registerShortcuts();const o={group:rw,relativeToGroup:Nn,position:"before"},n=(t,e)=>{const o=this.htEditor;if(void 0!==t&&(t<0||o.flipped&&t>o.countRows()-1?o.deselectCell():o.selectCell(t,0),o.getData().length))return e.preventDefault(),en(e),this.hot.listen(),this.TEXTAREA.focus(),!1};e.addShortcuts([{keys:[["ArrowUp"]],callback:t=>{const e=this.htEditor;let o,i;return!e.getSelectedLast()&&e.flipped?o=e.countRows()-1:e.getSelectedLast()&&(e.flipped?(i=e.getSelectedLast()[0],o=Math.max(0,i-1)):(i=e.getSelectedLast()[0],o=i-1)),n(o,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:t=>{const e=this.htEditor;let o,i;if(e.getSelectedLast()||e.flipped){if(e.getSelectedLast())if(e.flipped)o=e.getSelectedLast()[0]+1;else if(!e.flipped){const t=e.countRows()-1;i=e.getSelectedLast()[0],o=Math.min(t,i+1)}}else o=0;return n(o,t)},preventDefault:!1}],o)}unregisterShortcuts(){super.unregisterShortcuts();const t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(rw)}}function hw(t,e,o){return e=cw(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function cw(t){var e=dw(t,"string");return"symbol"===typeof e?e:String(e)}function dw(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const uw=new WeakMap,gw="autocomplete";class fw extends aw{static get EDITOR_TYPE(){return gw}constructor(t){super(t),hw(this,"sortByRelevance",(function(t,e,o){const n=[],i=[],s=t.length;let r,l,a,h,c=e.length;if(0===s){for(a=0;a<c;a++)i.push(a);return i}for(a=0;a<c;a++){if(l=ut(z(e[a])),o)h=l.indexOf(t);else{const e=this.cellProperties.locale;h=l.toLocaleLowerCase(e).indexOf(t.toLocaleLowerCase(e))}-1!==h&&(r=l.length-h-s,n.push({baseIndex:a,index:h,charsLeft:r,value:l}))}for(n.sort(((t,e)=>{if(-1===e.index)return-1;if(-1===t.index)return 1;if(t.index<e.index)return-1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0})),a=0,c=n.length;a<c;a++)i.push(n[a].baseIndex);return i})),this.query=null,this.strippedChoices=[],this.rawChoices=[],uw.set(this,{skipOne:!1,isMacOS:this.hot.rootWindow.navigator.platform.indexOf("Mac")>-1,idPrefix:t.guid.slice(0,9)})}getValue(){const t=this.rawChoices.find((t=>{const e=this.stripValueIfNeeded(t);return e===this.TEXTAREA.value}));return U(t)?t:this.TEXTAREA.value}createElements(){super.createElements(),de(this.htContainer,"autocompleteEditor"),de(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&ge(this.TEXTAREA,[It(),Rt(),Nt("listbox"),$t()])}prepare(t,e,o,n,i,s){const r=uw.get(this);super.prepare(t,e,o,n,i,s),this.hot.getSettings().ariaTags&&ge(this.TEXTAREA,[Bt("false"),Gt(`${r.idPrefix}-listbox-${t}-${e}`)])}open(){const t=uw.get(this);super.open();const e=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,o=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=null===n||void 0===n?void 0:n.length,{row:s,col:r}=this;this.showEditableElement(),this.focus();let l=Ue();0===l&&t.isMacOS&&(l+=15),this.addHook("beforeKeyDown",(t=>this.onBeforeKeyDown(t))),this.htEditor.updateSettings({colWidths:e?[ke(this.TEXTAREA)-2]:void 0,width:e?ke(this.TEXTAREA)+l:void 0,autoColumnSize:!0,renderer:(t,e,s,r,l,a,h)=>{zm(t,e,s,r,l,a,h);const{filteringCaseSensitive:c,allowHtml:d,locale:u}=this.cellProperties,g=this.query;let f,m,p=z(a);p&&!d&&(f=!0===c?p.indexOf(g):p.toLocaleLowerCase(u).indexOf(g.toLocaleLowerCase(u)),-1!==f&&(m=p.substr(f,g.length),p=p.replace(m,`<strong>${m}</strong>`))),o&&ge(e,[Mt(),...n?[qt(i)]:[],...n?[Qt(n.indexOf(a)+1)]:[],["id",`${this.htEditor.rootElement.id}_${s}-${r}`]]),e.innerHTML=p},afterSelection:(t,e)=>{if(o){const o=this.htEditor.getCell(t,e,!0);ge(o,[Ut()]),ge(this.TEXTAREA,...Yt(o.id))}}}),o&&(ge(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...pt()),ge(this.htEditor.rootElement,[Et(),Kt("polite"),Xt("text"),["id",`${t.idPrefix}-listbox-${s}-${r}`]]),ge(this.TEXTAREA,...Bt("true"))),t.skipOne&&(t.skipOne=!1),this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}))}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&ge(this.TEXTAREA,[Bt("false")])}discardEditor(t){super.discardEditor(t),this.hot.view.render()}queryChoices(t){const e=this.cellProperties.source;this.query=t,"function"===typeof e?e.call(this.cellProperties,t,(t=>{this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))})):Array.isArray(e)?(this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))):this.updateChoicesList([])}updateChoicesList(t){const e=Le(this.TEXTAREA),o=Ve(this.TEXTAREA),n=this.cellProperties.sortByRelevance,i=this.cellProperties.filter;let s=null,r=null,l=t;n&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const a=Array.isArray(s)?s.length:0;if(!1===i)a&&(r=s[0]);else{const t=[];for(let e=0,o=l.length;e<o;e++){if(n&&a<=e)break;a?t.push(l[s[e]]):t.push(l[e])}r=0,l=t}this.strippedChoices=l,this.htEditor.loadData(H([l])),0===l.length?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(r)),this.hot.listen(),We(this.TEXTAREA,e,e===o?void 0:o)}flipDropdownIfNeeded(){const t=He(this.hot.view._wt.wtTable.TABLE),e=t===this.hot.rootWindow,o=this.cellProperties.preventOverflow;if(e||!e&&(o||"horizontal"===o))return!1;const n=Se(this.TEXTAREA),i=Oe(this.TEXTAREA),s=this.getDropdownHeight(),r=t.scrollTop,l=Oe(this.hot.view._wt.wtTable.THEAD),a=Se(t),h=n.top-a.top-l+r,c=t.scrollHeight-h-l-i,d=s>c&&h>c;return d?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(d?h:c,s),d}limitDropdownIfNeeded(t,e){if(e>t){let o=0,n=0,i=0,s=null;do{i=this.htEditor.getRowHeight(n)||this.htEditor.view._wt.getSetting("defaultRowHeight"),o+=i,n+=1}while(o<t);s=o-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+e-s+"px"),this.setDropdownHeight(o-i)}}flipDropdown(t){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=-t+"px",this.htEditor.flipped=!0}unflipDropdown(){const t=this.htEditor.rootElement.style;t.position="absolute",t.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const t=this.htEditor.getColWidth(0)+Ue(this.hot.rootDocument)+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(t){this.htEditor.updateSettings({height:t})}highlightBestMatchingChoice(t){"number"===typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const t=this.htEditor.getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8}stripValueIfNeeded(t){return this.stripValuesIfNeeded([t])[0]}stripValuesIfNeeded(t){const{allowHtml:e}=this.cellProperties,o=A(t,(t=>z(t))),n=A(o,(t=>e?t:ut(t)));return n}allowKeyEventPropagation(t){const e=this.htEditor.getSelectedRangeLast(),o={row:e?e.from.row:-1};let n=!1;return t===Ko.ARROW_DOWN&&o.row>0&&o.row<this.htEditor.countRows()-1&&(n=!0),t===Ko.ARROW_UP&&o.row>-1&&(n=!0),n}onBeforeKeyDown(t){const e=uw.get(this);if(e.skipOne=!1,qo(t.keyCode)||t.keyCode===Ko.BACKSPACE||t.keyCode===Ko.DELETE||t.keyCode===Ko.INSERT){let o=10;if(t.keyCode===Ko.C&&(t.ctrlKey||t.metaKey))return;this.isOpened()||(o+=10),this.htEditor&&this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value),e.skipOne=!0}),o)}}}const mw="checkbox";class pw extends Om{static get EDITOR_TYPE(){return mw}beginEditing(t,e){if(e&&"mouseup"===e.type){const t=this.TD.querySelector('input[type="checkbox"]');ce(t,"htBadValue")||t.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var ww=o(1077);const Cw="date",vw="dateEditor";class yw extends Bm{static get EDITOR_TYPE(){return Cw}constructor(t){super(t),this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,this.$datePicker=null}init(){if("function"!==typeof E)throw new Error("You need to include moment.js to your project.");if("function"!==typeof ww)throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",(()=>{this.parentDestroyed=!0,this.destroyElements()}))}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),de(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);const t=new On(this);t.addEventListener(this.datePicker,"mousedown",(t=>{ce(t.target,"pika-day")&&this.hideDatepicker(),t.stopPropagation()})),t.addEventListener(this.TEXTAREA,"keydown",(t=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.code)&&t.preventDefault()}))}destroyElements(){const t=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}prepare(t,e,o,n,i,s){super.prepare(t,e,o,n,i,s)}open(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.hot.getShortcutManager(),o=e.getContext("editor");super.open(),this.showDatepicker(t),this.hot.getSettings().ariaTags&&ge(this.TD,[Bt("true")]),o.addShortcut({keys:[["Enter"]],callback:t=>{t.stopPropagation()},group:vw})}close(){var t;this._opened=!1,null!==(t=this.$datePicker)&&void 0!==t&&t.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout((()=>{this.hot._refreshBorders()})),this.TD&&this.hot.getSettings().ariaTags&&ge(this.TD,[Bt("false")]);const e=this.hot.getShortcutManager(),o=e.getContext("editor");o.removeShortcutsByGroup(vw),super.close()}finishEditing(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){const t=this.originalValue;void 0!==t&&this.setValue(t)}super.finishEditing(t,e)}showDatepicker(t){const e=this.TD.getBoundingClientRect(),o=this.cellProperties.dateFormat||this.defaultDateFormat,n=this.hot.view.isMouseDown(),i=!!t&&Qo(t.keyCode);let s;this.datePicker.style.display="block",this.$datePicker=new ww(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+e.top+Oe(this.TD)}px`;let r=this.hot.rootWindow.pageXOffset;r=this.hot.isRtl()?e.right-ke(this.datePicker):e.left,this.datePickerStyle.left=`${r}px`,this.originalValue?(s=this.originalValue,E(s,o,!0).isValid()&&this.$datePicker.setMoment(E(s,o),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),i||n||this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,E(s,o,!0).isValid()&&this.$datePicker.setMoment(E(s,o),!0),i||n||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const t=this.TEXTAREA,e={};this.cellProperties&&this.cellProperties.datePickerConfig&&wo(e,this.cellProperties.datePickerConfig);const o=e.onSelect,n=e.onClose;return e.field=t,e.trigger=t,e.container=this.datePicker,e.bound=!1,e.format=e.format||this.defaultDateFormat,e.reposition=e.reposition||!1,e.isRTL=!1,e.onSelect=t=>{let e=t;isNaN(e.getTime())||(e=E(e).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(e),o&&o()},e.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),n&&n()},e}}const Sw="dropdown";class bw extends fw{static get EDITOR_TYPE(){return Sw}prepare(t,e,o,n,i,s){super.prepare(t,e,o,n,i,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}pn.getSingleton().add("beforeValidate",(function(t,e,o){const n=this.getCellMeta(e,this.propToCol(o));n.editor===bw&&void 0===n.strict&&(n.filter=!1,n.strict=!0)}));const Rw="numeric";class Ew extends Bm{static get EDITOR_TYPE(){return Rw}}const Mw="password";class Tw extends Bm{static get EDITOR_TYPE(){return Mw}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,pe(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Hw="ht_editor_visible",xw="selectEditor",Iw="select";class Aw extends Om{static get EDITOR_TYPE(){return Iw}init(){this.select=this.hot.rootDocument.createElement("SELECT"),de(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(t){this.select.value=t}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";const t=this.hot.getShortcutManager();t.setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",ce(this.select,Hw)&&ue(this.select,Hw),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>this.refreshDimensions())),this.addHook("afterRowResize",(()=>this.refreshDimensions()))}prepare(t,e,o,n,i,s){super.prepare(t,e,o,n,i,s);const r=this.cellProperties.selectOptions;let l;l="function"===typeof r?this.prepareOptions(r(this.row,this.col,this.prop)):this.prepareOptions(r),pe(this.select),Eo(l,((t,e)=>{const o=this.hot.rootDocument.createElement("OPTION");o.value=e,Ce(o,t),this.select.appendChild(o)}))}prepareOptions(t){let e={};if(Array.isArray(t))for(let o=0,n=t.length;o<n;o++)e[t[o]]=t[o];else"object"===typeof t&&(e=t);return e}refreshValue(){const t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){if(this.state!==Am.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top:t,start:e,width:o,height:n}=this.getEditedCellRect(),i=this.select.style;i.height=`${n}px`,i.width=`${o}px`,i.top=`${t}px`,i[this.hot.isRtl()?"right":"left"]=`${e}px`,i.margin="0px",de(this.select,Hw)}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor"),o={group:xw};!1!==this.isInFullEditMode()&&e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const t=this.select.selectedIndex-1;t>=0&&(this.select[t].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const t=this.select.selectedIndex+1;t<=this.select.length-1&&(this.select[t].selected=!0)}}],o)}unregisterShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(xw)}}const kw="time";class Ow extends Bm{static get EDITOR_TYPE(){return kw}prepare(t,e,o,n,i,s){super.prepare(t,e,o,n,i,s),this.TEXTAREA.dir="ltr"}}function Pw(){xn(Om),xn(fw),xn(pw),xn(yw),xn(bw),xn(aw),xn(Ew),xn(Tw),xn(Aw),xn(Bm),xn(Ow)}const Nw="html";function _w(t,e,o,n,i,s,r){Wm.apply(this,[t,e,o,n,i,s,r]),Ce(e,null===s||void 0===s?"":s,!1)}_w.RENDERER_TYPE=Nw;const Dw="autocomplete";function Lw(t,e,o,n,i,s,r){const{rootDocument:l}=t,a=r.allowHtml?_w:zm,h=l.createElement("DIV"),c=t.getSettings().ariaTags;if(h.className="htAutocompleteArrow",c&&h.setAttribute(...kt()),h.appendChild(l.createTextNode(String.fromCharCode(9660))),a.apply(this,[t,e,o,n,i,s,r]),e.firstChild||e.appendChild(l.createTextNode(String.fromCharCode(160))),e.insertBefore(h,e.firstChild),de(e,"htAutocomplete"),c&&e.setAttribute(...Nt("listbox")),!t.acArrowListener){const i=new On(t);t.acArrowListener=function(i){ce(i.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(o,n),e)},i.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",(()=>{i.destroy()}))}}Lw.RENDERER_TYPE=Dw;const Vw=new WeakMap,Bw=new WeakMap,Fw="htBadValue",Ww="data-row",jw="data-col",zw="checkboxRenderer",Uw="checkbox";function $w(t,e,o,n,i,s,r){const{rootDocument:l}=t,a=t.getSettings().ariaTags;Wm.apply(this,[t,e,o,n,i,s,r]),Gw(t);let h=Yw(l);const c=r.label;let d=!1;if("undefined"===typeof r.checkedTemplate&&(r.checkedTemplate=!0),"undefined"===typeof r.uncheckedTemplate&&(r.uncheckedTemplate=!1),pe(e),s===r.checkedTemplate||z(s).toLocaleLowerCase(r.locale)===z(r.checkedTemplate).toLocaleLowerCase(r.locale)?h.checked=!0:s===r.uncheckedTemplate||z(s).toLocaleLowerCase(r.locale)===z(r.uncheckedTemplate).toLocaleLowerCase(r.locale)?h.checked=!1:G(s)?de(h,"noValue"):(h.style.display="none",de(h,Fw),d=!0),ge(h,[[Ww,o],[jw,n]]),a&&ge(h,[At(h.checked?t.getTranslatedPhrase(_d):t.getTranslatedPhrase(Dd)),zt(h.checked),Tt()]),!d&&c){let r="";if(c.value)r="function"===typeof c.value?c.value.call(this,o,n,i,s):c.value;else if(c.property){const e=t.getDataAtRowProp(o,c.property);r=null!==e?e:""}const a=Kw(l,r,!0!==c.separated);"before"===c.position?c.separated?(e.appendChild(a),e.appendChild(h)):(a.appendChild(h),h=a):c.position&&"after"!==c.position||(c.separated?(e.appendChild(h),e.appendChild(a)):(a.insertBefore(h,a.firstChild),h=a))}function u(){const e=t.getShortcutManager(),o=e.getContext("grid"),n={group:zw};o.addShortcuts([{keys:[["space"]],callback:()=>(g(),!f())},{keys:[["enter"]],callback:()=>(g(),!f()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!f()),relativeToGroup:df,position:"before"}],n)}function g(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const o=t.getSelectedRange();if(o)for(let n=0;n<o.length;n++){const{row:i,col:s}=o[n].getTopStartCorner(),{row:r,col:l}=o[n].getBottomEndCorner(),a=[];for(let o=i;o<=r;o+=1)for(let n=s;n<=l;n+=1){const i=t.getCellMeta(o,n);if("checkbox"!==i.type)return;if(!0===i.readOnly)continue;"undefined"===typeof i.checkedTemplate&&(i.checkedTemplate=!0),"undefined"===typeof i.uncheckedTemplate&&(i.uncheckedTemplate=!1);const s=t.getDataAtCell(o,n);!1===e?[i.checkedTemplate,i.checkedTemplate.toString()].includes(s)?a.push([o,n,i.uncheckedTemplate]):[i.uncheckedTemplate,i.uncheckedTemplate.toString(),null,void 0].includes(s)&&a.push([o,n,i.checkedTemplate]):a.push([o,n,i.uncheckedTemplate])}a.length>0&&t.setDataAtCell(a)}}function f(){const e=t.getSelectedRange();if(e){for(let o=0;o<e.length;o++){const n=e[o].getTopStartCorner(),i=e[o].getBottomEndCorner();for(let e=n.row;e<=i.row;e++)for(let o=n.col;o<=i.col;o++){const n=t.getCellMeta(e,o);if("checkbox"!==n.type)return!1;const i=t.getCell(e,o);if(null===i||void 0===i)return!0;{const t=i.querySelectorAll("input[type=checkbox]");if(t.length>0&&!n.readOnly)return!0}}}return!1}}(!c||c&&!c.separated)&&e.appendChild(h),d&&e.appendChild(l.createTextNode("#bad-value#")),Vw.has(t)||(Vw.set(t,!0),u())}function Gw(t){let e=Bw.get(t);if(!e){const{rootElement:o}=t;e=new On(t),e.addEventListener(o,"click",(e=>qw(e,t))),e.addEventListener(o,"mouseup",(e=>Xw(e,t))),e.addEventListener(o,"change",(e=>Qw(e,t))),Bw.set(t,e)}return e}function Yw(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Kw(t,e,o){const n=t.createElement("label");return n.className="htCheckboxRendererLabel "+(o?"fullWidth":""),n.appendChild(t.createTextNode(e)),n.cloneNode(!0)}function Xw(t,e){const{target:o}=t;Jw(o)&&o.hasAttribute(Ww)&&o.hasAttribute(jw)&&setTimeout(e.listen,10)}function qw(t,e){const{target:o}=t;if(!Jw(o))return;if(!o.hasAttribute(Ww)||!o.hasAttribute(jw))return;const n=parseInt(o.getAttribute(Ww),10),i=parseInt(o.getAttribute(jw),10),s=e.getCellMeta(n,i);s.readOnly&&t.preventDefault()}function Qw(t,e){const{target:o}=t;if(!Jw(o))return;if(!o.hasAttribute(Ww)||!o.hasAttribute(jw))return;const n=parseInt(o.getAttribute(Ww),10),i=parseInt(o.getAttribute(jw),10),s=e.getCellMeta(n,i);if(!s.readOnly){let o=null;o=t.target.checked?void 0===s.uncheckedTemplate||s.checkedTemplate:void 0!==s.uncheckedTemplate&&s.uncheckedTemplate,e.setDataAtCell(n,i,o)}}function Jw(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}pn.getSingleton().add("modifyAutoColumnSizeSeed",(function(t,e,o){const{label:n,type:i,row:s,column:r,prop:l}=e;if(i===Uw){if(n){const{value:e,property:i}=n;let a=o;if(e)a="function"===typeof e?e(s,r,l,o):e;else if(i){const t=this.getDataAtRowProp(s,i);a=null!==t?t:o}t=a}return t}})),$w.RENDERER_TYPE=Uw;var Zw=o(204);const tC="numeric";function eC(t,e,o,n,i,s,r){let l=s;if(gi(l)){const t=r.numericFormat,o=t&&t.culture||"-",n=t&&t.pattern,i=r.className||"",s=i.length?i.split(" "):[];if("undefined"!==typeof o&&!Zw.languages()[o]){const t=o.replace("-",""),e=Zw.allLanguages?Zw.allLanguages[o]:Zw[t];e&&Zw.registerLanguage(e)}Zw.setLanguage(o),l=Zw(l).format(n||"0"),s.indexOf("htLeft")<0&&s.indexOf("htCenter")<0&&s.indexOf("htRight")<0&&s.indexOf("htJustify")<0&&s.push("htRight"),s.indexOf("htNumeric")<0&&s.push("htNumeric"),r.className=s.join(" "),e.dir="ltr"}zm(t,e,o,n,i,l,r)}eC.RENDERER_TYPE=tC;const oC="password";function nC(t,e,o,n,i,s,r){zm.apply(this,[t,e,o,n,i,s,r]);const l=r.hashLength||e.innerHTML.length,a=r.hashSymbol||"*";let h="";mi(l-1,(()=>{h+=a})),Ce(e,h)}nC.RENDERER_TYPE=oC;const iC="time";function sC(t,e,o,n,i,s,r){zm.apply(this,[t,e,o,n,i,s,r]),e.dir="ltr"}function rC(){Yi(Lw),Yi(Wm),Yi($w),Yi(_w),Yi(eC),Yi(nC),Yi(zm),Yi(sC)}sC.RENDERER_TYPE=iC;const lC="autocomplete";function aC(t,e){let o=t;null!==o&&void 0!==o||(o=""),this.allowEmpty&&""===o?e(!0):this.strict&&this.source?"function"===typeof this.source?this.source(o,hC(o,e)):hC(o,e)(this.source):e(!0)}function hC(t,e){const o=t;return function(t){let n=!1;for(let e=0,i=t.length;e<i;e++)if(o===t[e]){n=!0;break}e(n)}}function cC(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}aC.VALIDATOR_TYPE=lC;const dC="date";function uC(t,e){const o=Tn(Cw,this.instance);let n=t,i=!0;null!==n&&void 0!==n||(n="");let s=E(n,this.dateFormat||o.defaultDateFormat,!0).isValid(),r=E(new Date(n)).isValid()||s;if(this.allowEmpty&&""===n&&(r=!0,s=!0),r||(i=!1),!r&&s&&(i=!0),r&&!s)if(!0===this.correctFormat){const t=gC(n,this.dateFormat),e=this.instance.toVisualRow(this.row),o=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(e,o,t,"dateValidator"),i=!0}else i=!1;e(i)}function gC(t,e){const o=E(cC(t)),n=E(t,e),i=t.search(/[A-z]/g)>-1;let s;return s=o.isValid()&&o.format("x")===n.format("x")||!n.isValid()||i?o:n,s.format(e)}uC.VALIDATOR_TYPE=dC;const fC="numeric";function mC(t,e){let o=t;null!==o&&void 0!==o||(o=""),this.allowEmpty&&""===o?e(!0):e(""!==o&&gi(t))}mC.VALIDATOR_TYPE=fC;const pC=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],wC="time";function CC(t,e){const o=this.timeFormat||"h:mm:ss a";let n=!0,i=t;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const r=E(i,pC,!0).isValid()?E(i):E(i,o);let l=r.isValid(),a=E(i,o,!0).isValid()&&!s;if(this.allowEmpty&&""===i&&(l=!0,a=!0),l||(n=!1),!l&&a&&(n=!0),l&&!a)if(!0===this.correctFormat){const t=r.format(o),e=this.instance.toVisualRow(this.row),i=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(e,i,t,"timeValidator"),n=!0}else n=!1;e(n)}function vC(){ts(aC),ts(uC),ts(mC),ts(CC)}CC.VALIDATOR_TYPE=wC;const yC="autocomplete",SC={CELL_TYPE:yC,editor:fw,renderer:Lw,validator:aC},bC="checkbox",RC={CELL_TYPE:bC,editor:pw,renderer:$w},EC="date";function MC(t,e,o,n,i,s,r){Lw.apply(this,[t,e,o,n,i,s,r]),t.getSettings().ariaTags&&ge(e,[Nt("dialog"),Bt("false")])}MC.RENDERER_TYPE=EC;const TC="date",HC={CELL_TYPE:TC,editor:yw,renderer:MC,validator:uC},xC="dropdown",IC={CELL_TYPE:xC,editor:bw,renderer:Lw,validator:aC},AC="handsontable";function kC(t,e,o,n,i,s,r){Lw.apply(this,[t,e,o,n,i,s,r]),t.getSettings().ariaTags&&ge(e,[Nt("true"),Bt("false")])}kC.RENDERER_TYPE=AC;const OC="handsontable",PC={CELL_TYPE:OC,editor:aw,renderer:kC},NC="numeric",_C={CELL_TYPE:NC,editor:Ew,renderer:eC,validator:mC,dataType:"number"},DC="password",LC={CELL_TYPE:DC,editor:Tw,renderer:nC,copyable:!1},VC="select";function BC(t,e,o,n,i,s,r){zm.apply(this,[t,e,o,n,i,s,r]),t.getSettings().ariaTags&&ge(e,...Nt("listbox"))}BC.RENDERER_TYPE=VC;const FC="select",WC={CELL_TYPE:FC,editor:Aw,renderer:BC},jC="time",zC={CELL_TYPE:jC,editor:Ow,renderer:sC,validator:CC};function UC(){Lg(SC),Lg(RC),Lg(HC),Lg(IC),Lg(PC),Lg(_C),Lg(LC),Lg(WC),Lg($m),Lg(zC)}function $C(t,e){GC(t,e),e.add(t)}function GC(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YC(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const KC=new Map([["plugin",Li],["cell-type",Pg],["editor",bn],["renderer",zi],["validator",qi]]),XC="base",qC=new WeakMap,QC=[];let JC=null;var ZC=new WeakSet;class tv{static get PLUGIN_KEY(){return XC}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(t){$C(this,ZC),Ro(this,"hot",t,{writable:!1}),qC.set(this,{hooks:{}}),JC=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",(()=>this.onAfterPluginsInitialized())),this.hot.addHook("afterUpdateSettings",(t=>this.onUpdateSettings(t))),this.hot.addHook("beforeInit",(()=>this.init()))}init(){this.pluginName=this.hot.getPluginName(this);const t=this.constructor.PLUGIN_DEPS,e=Array.isArray(t)?t:[];if(e.length>0){const t=[];if(e.forEach((e=>{const[o,n]=e.split(":");if(!KC.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);KC.get(o)(n)||t.push(` - ${n} (${o})`)})),t.length>0){const e=[`The ${this.pluginName} plugin requires the following modules:\n`,`${t.join("\n")}\n`].join("");QC.push(e)}}JC||(JC=_i()),JC.indexOf("UndoRedo")>=0&&JC.splice(JC.indexOf("UndoRedo"),1),JC.indexOf(this.pluginName)>=0&&JC.splice(JC.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}));const o=0===JC.length;if(o){if(QC.length>0){const t=[`${QC.join("\n")}\n`,"You have to import and register them manually."].join("");throw new Error(t)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}addHook(t,e){qC.get(this).hooks[t]=qC.get(this).hooks[t]||[];const o=qC.get(this).hooks[t];this.hot.addHook(t,e),o.push(e),qC.get(this).hooks[t]=o}removeHooks(t){k(qC.get(this).hooks[t]||[],(e=>{this.hot.removeHook(t,e)}))}clearHooks(){const t=qC.get(this).hooks;Eo(t,((t,e)=>this.removeHooks(e))),t.length=0}callOnPluginsReady(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}onAfterPluginsInitialized(){k(this.pluginsInitializedCallbacks,(t=>t())),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(t){const e=YC(this,ZC,ev).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}updatePlugin(){}destroy(){this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Eo(this,((t,e)=>{"hot"!==e&&(this[e]=null)})),delete this.t,delete this.hot}}function ev(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if("boolean"===typeof e)return e;for(let o=0;o<e.length;o++)if(void 0!==t[e[o]])return!0;return!1}function ov(t,e,o){return e=nv(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function nv(t){var e=iv(t,"string");return"symbol"===typeof e?e:String(e)}function iv(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class sv{constructor(t){ov(this,"hot",null),ov(this,"container",null),ov(this,"injected",!1),ov(this,"rows",[]),ov(this,"columns",[]),ov(this,"samples",null),ov(this,"settings",{useHeaders:!0}),this.hot=t}addRow(t,e){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const o={row:t};this.rows.push(o),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(t)),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}addColumnHeadersRow(t){const e=this.hot.getColHeader(0);if(null!==e&&void 0!==e){const e={row:-1};this.rows.push(e),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),e.table=this.table.table}}addColumn(t,e){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const o={col:t};this.columns.push(o),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}getHeights(t){this.injected||this.injectTable(),k(this.rows,(e=>{t(e.row,Oe(e.table)-1)}))}getWidths(t){this.injected||this.injectTable(),k(this.columns,(e=>{const{width:o}=e.table.getBoundingClientRect();t(e.col,Math.ceil(o))}))}setSettings(t){this.settings=t}setSetting(t,e){this.settings||(this.settings={}),this.settings[t]=e}getSettings(){return this.settings}getSetting(t){return this.settings?this.settings[t]:null}createColGroupsCol(t){const e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1,-1)),this.samples.forEach((o=>{k(o.strings,(o=>{e.appendChild(this.createColElement(o.col,t))}))})),e}createRow(t){const{rootDocument:e}=this.hot,o=e.createDocumentFragment(),n=e.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,n),o.appendChild(n)),this.samples.forEach((n=>{k(n.strings,(n=>{const i=n.col,s=this.hot.getCellMeta(t,i);s.col=i,s.row=t;const r=this.hot.getCellRenderer(s),l=e.createElement("td");l.setAttribute("ghost-table",1),r(this.hot,l,t,i,this.hot.colToProp(i),n.value,s),o.appendChild(l)}))})),o}appendColumnHeadersRow(){const{rootDocument:t}=this.hot,e=t.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){const n=t.createElement("th");o.push([-1,n]),e.appendChild(n)}this.samples.forEach((n=>{k(n.strings,(n=>{const i=n.col,s=t.createElement("th");o.push([i,s]),e.appendChild(s)}))})),this.table.tHead.appendChild(e),k(o,(t=>{const[e,o]=t;this.hot.view.appendColHeader(e,o)}))}createCol(t){const{rootDocument:e}=this.hot,o=e.createDocumentFragment();return this.samples.forEach((n=>{k(n.strings,(n=>{const i=n.row,s=this.hot.getCellMeta(i,t);s.col=t,s.row=i;const r=this.hot.getCellRenderer(s),l=e.createElement("td"),a=e.createElement("tr");l.setAttribute("ghost-table",1),r(this.hot,l,i,t,this.hot.colToProp(t),n.value,s),a.appendChild(l),o.appendChild(a)}))})),o}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(t,e){const o=this.hot.rootDocument.createElement("col");let n=0;e>=0&&t>=0&&(n=this.hot.getCellMeta(e,t).colspan);let i=this.hot.view._wt.wtTable.getStretchedColumnWidth(t);if(n>1)for(let s=t+1;s<t+n;s++)i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return o.style.width=`${i}px`,o}createTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,o=e.createDocumentFragment(),n=e.createElement("table"),i=e.createElement("thead"),s=e.createElement("tbody"),r=e.createElement("colgroup"),l=e.createElement("tr"),a=e.createElement("th");return this.isVertical()&&n.appendChild(r),this.isHorizontal()&&(l.appendChild(a),i.appendChild(l),n.style.tableLayout="auto",n.style.width="auto"),n.appendChild(i),this.isVertical()&&s.appendChild(l),n.appendChild(s),de(n,t),o.appendChild(n),{fragment:o,table:n,tHead:i,tBody:s,colGroup:r,tr:l,th:a}}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,o=e.createDocumentFragment(),n=e.createElement("div"),i=`htGhostTable htAutoSize ${t.trim()}`;return de(n,i),o.appendChild(n),{fragment:o,container:n}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}}var rv=sv;function lv(t,e,o){return e=av(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function av(t){var e=hv(t,"string");return"symbol"===typeof e?e:String(e)}function hv(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class cv{static get SAMPLE_COUNT(){return 3}constructor(t){lv(this,"samples",null),lv(this,"dataFactory",null),lv(this,"customSampleCount",null),lv(this,"allowDuplicates",!1),this.dataFactory=t}getSampleCount(){return this.customSampleCount?this.customSampleCount:cv.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,e){return this.generateSamples("row",e,t)}generateColumnSamples(t,e){return this.generateSamples("col",e,t)}generateSamples(t,e,o){const n=new Map,{from:i,to:s}="number"===typeof o?{from:o,to:o}:o;return mi(i,s,(o=>{const i=this.generateSample(t,e,o);n.set(o,i)})),n}generateSample(t,e,o){if("row"!==t&&"col"!==t)throw new Error("Unsupported sample type");const n=new Map,i="row"===t?"col":"row",s=[];return mi(e.from,e.to,(e=>{const r="row"===t?this.dataFactory(o,e):this.dataFactory(e,o);if(!1===r)return;const{value:l,bundleSeed:a}=r,h="string"===typeof a&&a.length>0;let c;c=h?a:bo(l)?`${Object.keys(l).length}`:Array.isArray(l)?`${l.length}`:`${z(l).length}`,n.has(c)||n.set(c,{needed:this.getSampleCount(),strings:[]});const d=n.get(c);if(d.needed){const t=s.indexOf(l)>-1;(!t||this.allowDuplicates||h)&&(d.strings.push({value:l,[i]:e}),s.push(l),d.needed-=1)}})),n}}var dv=cv;pn.getSingleton().register("modifyAutoColumnSizeSeed");const uv="autoColumnSize",gv=10,fv=new WeakMap,mv="autoColumnSize";class pv extends tv{static get PLUGIN_KEY(){return uv}static get PLUGIN_PRIORITY(){return gv}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){super(t),fv.set(this,{cachedColumnHeaders:[]}),this.ghostTable=new rv(this.hot),this.samplesGenerator=new dv(((t,e)=>{const o=this.hot.getCellMeta(t,e);let n="";o.spanned||(n=this.hot.getDataAtCell(t,e));let i="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(i=this.hot.runHooks("modifyAutoColumnSizeSeed",i,o,n)),{value:n,bundleSeed:i}})),this.firstCalculation=!0,this.inProgress=!1,this.measuredColumns=0,this.columnWidthsMap=new ph,this.hot.columnIndexMapper.registerMap(mv,this.columnWidthsMap),this.addHook("beforeColumnResize",((t,e,o)=>this.onBeforeColumnResize(t,e,o)))}isEnabled(){return!1!==this.hot.getSettings()[uv]&&!this.hot.getSettings().colWidths}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[uv];e&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return t.onAfterLoadData(...arguments)})),this.addHook("beforeChangeRender",(t=>this.onBeforeChange(t))),this.addHook("afterFormulasValuesUpdate",(t=>this.onAfterFormulasValuesUpdate(t))),this.addHook("beforeViewRender",(t=>this.onBeforeViewRender(t))),this.addHook("modifyColWidth",((t,e)=>this.getColumnWidth(e,t))),this.addHook("afterInit",(()=>this.onAfterInit())),super.enablePlugin()}updatePlugin(){const t=this.findColumnsWhereHeaderWasChanged();t.length&&(this.clearCache(t),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",((t,e,o)=>this.onBeforeColumnResize(t,e,o)))}calculateVisibleColumnsWidth(){const t=this.hot.countRows();if(!t)return;const e=this.hot.renderCall,o=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();-1!==o&&-1!==n&&this.calculateColumnsWidth({from:o,to:n},void 0,e)}calculateColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n="number"===typeof t?{from:t,to:t}:t,i="number"===typeof e?{from:e,to:e}:e;mi(n.from,n.to,(t=>{let e=this.hot.toPhysicalColumn(t);if(null===e&&(e=t),o||null===this.columnWidthsMap.getValueAtIndex(e)&&!this.hot._getColWidthFromSettings(e)){const e=this.samplesGenerator.generateColumnSamples(t,i);k(e,(t=>{let[e,o]=t;return this.ghostTable.addColumn(e,o)}))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((t,e)=>{const o=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(o,e)}))}),!0),this.measuredColumns=n.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=0;const o=this.hot.countCols()-1;let n=null;this.inProgress=!0;const i=()=>{if(!this.hot)return os(n),void(this.inProgress=!1);this.calculateColumnsWidth({from:e,to:Math.min(e+pv.CALCULATION_STEP,o)},t),e=e+pv.CALCULATION_STEP+1,e<o?n=es(i):(os(n),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},t),this.firstCalculation=!1,e=s+1),e<o?i():this.inProgress=!1}setSamplingOptions(){const t=this.hot.getSettings()[uv],e=t&&Io(t,"samplingRatio")?t.samplingRatio:void 0,o=t&&Io(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const t=this.hot.getSettings()[uv];let e=pv.SYNC_CALCULATION_LIMIT;const o=this.hot.countCols()-1;return bo(t)&&(e=t.syncLimit,ct(e)?e=wi(o,e):e>>=0),Math.min(e,o)}getColumnWidth(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e;return void 0===n&&(n=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),o&&"number"===typeof n&&(n=Math.max(n,Ll.DEFAULT_WIDTH))),n}getFirstVisibleColumn(){const t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){const e=t.wtTable.getFirstVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){const e=t.wtTable.getFirstRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return-1}getLastVisibleColumn(){const t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){const e=t.wtTable.getLastVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){const e=t.wtTable.getLastRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return-1}findColumnsWhereHeaderWasChanged(){const t=this.hot.getColHeader(),{cachedColumnHeaders:e}=fv.get(this),o=x(t,((t,o,n)=>{const i=e.length;return(i-1<n||e[n]!==o)&&t.push(n),i-1<n?e.push(o):e[n]=o,t}),[]);return o}clearCache(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.batchExecution((()=>{k(t,(t=>{this.columnWidthsMap.setValueAtIndex(t,null)}))}),!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!I(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(t=>null===t)).length}onBeforeViewRender(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}onAfterLoadData(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout((()=>{this.hot&&this.recalculateAllColumnsWidth()}),0)}onBeforeChange(t){const e=A(t,(t=>{let[,e]=t;return this.hot.toPhysicalColumn(this.hot.propToCol(e))}));this.clearCache(Array.from(new Set(e)))}onBeforeColumnResize(t,e,o){let n=t;return o&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}onAfterInit(){fv.get(this).cachedColumnHeaders=this.hot.getColHeader()}onAfterFormulasValuesUpdate(t){const e=I(t,(t=>{var e;return U(null===(e=t.address)||void 0===e?void 0:e.col)})),o=A(e,(t=>t.address.col));this.clearCache(Array.from(new Set(o)))}destroy(){this.ghostTable.clean(),super.destroy()}}const wv={horizontal:"horizontal",vertical:"vertical"};function Cv(t,e,o){let n,i,s;return e[0]===t[0]&&e[1]<t[1]?(s="left",n=o(e[0],e[1]),i=o(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(s="right",n=o(e[0],t[3]+1),i=o(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",n=o(e[0],e[1]),i=o(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",n=o(t[2]+1,e[1]),i=o(e[2],e[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:n,endOfDragCoords:i}}function vv(t){const e={};return!0===t?(e.directions=Object.keys(wv),e.autoInsertRow=!0):bo(t)?(U(t.autoInsertRow)?t.direction===wv.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,U(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(wv)):"string"===typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}pn.getSingleton().register("modifyAutofillRange"),pn.getSingleton().register("beforeAutofill"),pn.getSingleton().register("afterAutofill");const yv="autofill",Sv=20,bv=["fillHandle"],Rv="insert_row_below",Ev=200;class Mv extends tv{static get PLUGIN_KEY(){return yv}static get PLUGIN_PRIORITY(){return Sv}static get SETTING_KEYS(){return[yv,...bv]}constructor(t){super(t),this.eventManager=new On(this),this.addingStarted=!1,this.mouseDownOnCellCorner=!1,this.mouseDragOutside=!1,this.handleDraggedCells=0,this.directions=[],this.autoInsertRow=!1}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(t=>this.onAfterCellCornerMouseDown(t))),this.addHook("afterOnCellCornerDblClick",(t=>this.onCellCornerDblClick(t))),this.addHook("beforeOnCellMouseOver",((t,e)=>this.onBeforeCellMouseOver(e))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const t=this.hot.getSelectedRangeLast(),{row:e,col:o}=t.getTopStartCorner(),{row:n,col:i}=t.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:e,startCol:o,endRow:n,endCol:i}]),r=[],l=[],a=[];return k(s,(t=>{for(let e=t.startRow;e<=t.endRow;e+=1)-1===r.indexOf(e)&&r.push(e);for(let e=t.startCol;e<=t.endCol;e+=1)-1===l.indexOf(e)&&l.push(e)})),k(r,(t=>{const e=[];k(l,(o=>{e.push(this.hot.getCopyableData(t,o))})),a.push(e)})),a}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[t,e,o,n]=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.getSelectedRangeLast(),s=i.getTopStartCorner(),r=i.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,r.row,r.col],a=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,t),Math.min(s.col,e),Math.max(r.row,o),Math.max(r.col,n)],l),{directionOfDrag:h,startOfDragCoords:c,endOfDragCoords:d}=Cv(l,a,((t,e)=>this.hot._createCellCoords(t,e)));if(c&&c.row>-1&&c.col>-1){const t=this.getSelectionData(),e=i.clone(),o=this.hot._createCellRange(c,c,d),n=this.hot.runHooks("beforeAutofill",t,e,o,h);if(!1===n)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let s=n;const r=n;if(["up","left"].indexOf(h)>-1&&(1!==r.length||0!==r[0].length))if(s=[],"up"===h){const t=d.row-c.row+1,e=t%r.length;for(let o=0;o<t;o++)s.push(r[(o+(r.length-e))%r.length])}else{const t=d.col-c.col+1,e=t%r[0].length;for(let o=0;o<r.length;o++){s.push([]);for(let n=0;n<t;n++)s[o].push(r[o][(n+(r[o].length-e))%r[o].length])}}this.hot.populateFromArray(c.row,c.col,s,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(a),this.hot.runHooks("afterAutofill",s,e,o,h),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}getCoordsOfDragAndDropBorders(t){const e=this.hot.getSelectedRangeLast(),o=e.getBottomEndCorner();let n=t;if(this.directions.includes(wv.vertical)&&this.directions.includes(wv.horizontal)){const i=e.getTopStartCorner();(o.col<=t.col||i.col>=t.col)&&(n=this.hot._createCellCoords(o.row,t.col)),(o.row<t.row||i.row>t.row)&&(n=this.hot._createCellCoords(t.row,o.col))}else if(this.directions.includes(wv.vertical))n=this.hot._createCellCoords(t.row,o.col);else{if(!this.directions.includes(wv.horizontal))return;n=this.hot._createCellCoords(o.row,t.col)}return this.reduceSelectionAreaIfNeeded(n)}showBorder(t){const e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}addRow(){this.hot._registerTimeout((()=>{this.hot.alter(Rv,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1}),Ev)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.countRows();t[2]<o-1&&e[2]===o-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(t){const e=this.hot.getData(),o=this.hot.countRows();let n;for(let i=t[2]+1;i<o;i++){for(let n=t[1];n<=t[3];n++){const t=e[i][n];if(t)return-1}const o=e[i][t[1]-1],s=e[i][t[3]+1];(o||s)&&(n=i)}return n}addSelectionFromStartAreaToSpecificRowIndex(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}setSelection(t){this.hot.selectCell(...A(t,(t=>Math.max(t,0))),!1,!1)}selectAdjacent(){const t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(t){const{documentElement:e}=this.hot.rootDocument,o=Se(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+Oe(this.hot.table),n=Se(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+ke(this.hot.table);return t.clientY>o&&t.clientX<=n}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp())),this.eventManager.addEventListener(t,"mousemove",(t=>this.onMouseMove(t)))}onCellCornerDblClick(){const t=this.selectAdjacent();t&&this.fillIn()}onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}onBeforeCellMouseOver(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}onMouseUp(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}onMouseMove(t){const e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const t=vv(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}destroy(){super.destroy()}}const Tv="autoRowSize",Hv=40,xv="autoRowSize";class Iv extends tv{static get PLUGIN_KEY(){return Tv}static get PLUGIN_PRIORITY(){return Hv}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(t){super(t),this.rowHeightsMap=void 0,this.headerHeight=null,this.ghostTable=new rv(this.hot),this.samplesGenerator=new dv(((t,e)=>{if(t>=0&&e>=0){const o=this.hot.getCellMeta(t,e);if(o.hidden)return!1}let o;return t>=0?o=this.hot.getDataAtCell(t,e):-1===t&&(o=this.hot.getColHeader(e)),{value:o}})),this.firstCalculation=!0,this.inProgress=!1,this.measuredRows=0,this.rowHeightsMap=new ph,this.hot.rowIndexMapper.registerMap(xv,this.rowHeightsMap),this.addHook("beforeRowResize",((t,e,o)=>this.onBeforeRowResize(t,e,o)))}isEnabled(){const t=this.hot.getSettings()[Tv];return!0===t||bo(t)}enablePlugin(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return t.onAfterLoadData(...arguments)})),this.addHook("beforeChangeRender",(t=>this.onBeforeChange(t))),this.addHook("beforeColumnResize",(()=>this.recalculateAllRowsHeight())),this.addHook("beforeViewRender",(t=>this.onBeforeViewRender(t))),this.addHook("modifyRowHeight",((t,e)=>this.getRowHeight(e,t))),this.addHook("modifyColumnHeaderHeight",(()=>this.getColumnHeaderHeight())),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",((t,e,o)=>this.onBeforeRowResize(t,e,o)))}calculateRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n="number"===typeof t?{from:t,to:t}:t,i="number"===typeof e?{from:e,to:e}:e;if(null!==this.hot.getColHeader(0)){const t=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(t.get(-1))}mi(n.from,n.to,(t=>{if(o||null===this.rowHeightsMap.getValueAtIndex(t)){const e=this.samplesGenerator.generateRowSamples(t,i);k(e,(t=>{let[e,o]=t;return this.ghostTable.addRow(e,o)}))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((t,e)=>{t<0?this.headerHeight=e:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(t),e)}))}),!0),this.measuredRows=n.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=0;const o=this.hot.countRows()-1;let n=null;this.inProgress=!0;const i=()=>{if(!this.hot)return os(n),void(this.inProgress=!1);this.calculateRowsHeight({from:e,to:Math.min(e+Iv.CALCULATION_STEP,o)},t),e=e+Iv.CALCULATION_STEP+1,e<o?n=es(i):(os(n),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},t),this.firstCalculation=!1,e=s+1),e<o?i():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const t=this.hot.getSettings()[Tv],e=t&&Io(t,"samplingRatio")?t.samplingRatio:void 0,o=t&&Io(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}recalculateAllRowsHeight(){ye(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const t=this.hot.getSettings()[Tv];let e=Iv.SYNC_CALCULATION_LIMIT;const o=this.hot.countRows()-1;return bo(t)&&(e=t.syncLimit,ct(e)?e=wi(o,e):e>>=0),Math.min(e,o)}getRowHeight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;const o=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t));let n=e;return null!==o&&o>(e||0)&&(n=o),n}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(t){const{from:e,to:o}="number"===typeof t?{from:t,to:t}:t;this.hot.batchExecution((()=>{mi(Math.min(e,o),Math.max(e,o),(t=>{this.rowHeightsMap.setValueAtIndex(t,null)}))}),!0)}isNeedRecalculate(){return!!I(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(t=>null===t)).length}onBeforeViewRender(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,o=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(-1!==o&&-1!==n){if(this.calculateRowsHeight({from:o,to:n},void 0,t),e){const t=this.hot.countRows()-1;this.calculateRowsHeight({from:t-e,to:t})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}onBeforeRowMove(t,e){this.clearCacheByRange({from:t,to:e}),this.calculateAllRowsHeight()}onBeforeRowResize(t,e,o){let n=t;return o&&(this.calculateRowsHeight(e,void 0,!0),n=this.getRowHeight(e)),n}onAfterLoadData(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout((()=>{this.hot&&this.recalculateAllRowsHeight()}))}onBeforeChange(t){let e=null;1===t.length?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}destroy(){this.ghostTable.clean(),super.destroy()}}const Av=new Map([["indexesSequence",{getListWithInsertedItems:hh,getListWithRemovedItems:ch}],["physicallyIndexed",{getListWithInsertedItems:fh,getListWithRemovedItems:mh}]]),kv=t=>{if(!1===Av.has(t))throw new Error(`Alter strategy with ID '${t}' does not exist.`);return Av.get(t)},{getListWithInsertedItems:Ov,getListWithRemovedItems:Pv}=kv("physicallyIndexed");class Nv extends ah{constructor(){super((t=>t))}insert(t,e){const o=uh(this.indexedValues,e);this.indexedValues=Ov(o,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){const e=Pv(this.indexedValues,t);this.indexedValues=dh(e,t),super.remove(t)}}var _v=Nv;const{getListWithInsertedItems:Dv,getListWithRemovedItems:Lv}=kv("physicallyIndexed");class Vv extends ah{constructor(){super((t=>t))}insert(t,e){this.indexedValues=Dv(this.indexedValues,t,e,((t,e)=>this.getNextValue(e))),super.insert(t,e)}remove(t){this.indexedValues=Lv(this.indexedValues,t),super.remove(t)}getNextValue(t){return Math.max(...this.getValues())+1+t}}var Bv=Vv;const Fv="bindRowsWithHeaders",Wv=210,jv="loose",zv=new Map([["loose",_v],["strict",Bv]]);class Uv extends tv{static get PLUGIN_KEY(){return Fv}static get PLUGIN_PRIORITY(){return Wv}constructor(t){super(t),this.headerIndexes=null}isEnabled(){return!!this.hot.getSettings()[Fv]}enablePlugin(){if(this.enabled)return;let t=this.hot.getSettings()[Fv];"string"!==typeof t&&(t=jv);const e=zv.get(t);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new e),this.addHook("modifyRowHeader",(t=>this.onModifyRowHeader(t))),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}onModifyRowHeader(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}destroy(){super.destroy()}}function $v(t,e,o){Gv(t,e),e.set(t,o)}function Gv(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yv(t,e,o){return e=Kv(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Kv(t){var e=Xv(t,"string");return"symbol"===typeof e?e:String(e)}function Xv(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function qv(t,e){var o=Zv(t,e,"get");return Qv(t,o)}function Qv(t,e){return e.get?e.get.call(t):e.value}function Jv(t,e,o){var n=Zv(t,e,"set");return ty(t,n,o),o}function Zv(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function ty(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}const ey="collapsibleColumns",oy=290,ny=["nestedHeaders"],iy="collapsibleIndicator",sy=ey,ry=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var ly=new WeakMap;class ay extends tv{constructor(){super(...arguments),Yv(this,"nestedHeadersPlugin",null),Yv(this,"eventManager",new On(this)),Yv(this,"headerStateManager",null),$v(this,ly,{writable:!0,value:null})}static get PLUGIN_KEY(){return ey}static get PLUGIN_PRIORITY(){return oy}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[ey,...ny]}isEnabled(){return!!this.hot.getSettings()[ey]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();e||ln("You need to configure the Nested Headers plugin in order to use collapsible headers."),Jv(this,ly,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(()=>this.onInit())),this.addHook("afterLoadData",(function(){return t.onAfterLoadData(...arguments)})),this.addHook("afterGetColHeader",(function(){return t.onAfterGetColHeader(...arguments)})),this.addHook("beforeOnCellMouseDown",((t,e,o)=>this.onBeforeOnCellMouseDown(t,e,o))),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:t}=this.hot.getSettings();"boolean"===typeof t?this.headerStateManager.mapState((t=>({collapsible:t.origColspan>1}))):Array.isArray(t)&&(this.headerStateManager.mapState((()=>({collapsible:!1}))),this.headerStateManager.mergeStateWith(t))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Jv(this,ly,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var t;const{row:e,col:o}=this.hot.getSelectedRangeLast().highlight,{collapsible:n,isCollapsed:i,columnIndex:s}=null!==(t=this.headerStateManager.getHeaderTreeNodeData(e,o))&&void 0!==t?t:{};n&&(i?this.expandSection({row:e,col:s}):this.collapseSection({row:e,col:s}))},runOnlyIf:()=>{var t;return null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},group:sy})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sy)}clearButtons(){if(!this.hot.view)return;const t=this.hot.view._wt.getSetting("columnHeaders").length,e=this.hot.view._wt.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=function(t){t&&t.parentNode.removeChild(t)};mi(0,t-1,(t=>{const s=e.childNodes[t],r=o.childNodes[t],l=n?n.childNodes[t]:null;mi(0,s.childNodes.length-1,(t=>{let e=s.childNodes[t].querySelector(`.${iy}`);i(e),r&&r.childNodes[t]&&(e=r.childNodes[t].querySelector(`.${iy}`),i(e)),n&&l&&l.childNodes[t]&&(e=l.childNodes[t].querySelector(`.${iy}`),i(e))}))}),!0)}expandSection(t){this.toggleCollapsibleSection([t],"expand")}collapseSection(t){this.toggleCollapsibleSection([t],"collapse")}toggleAllCollapsibleSections(t){const e=this.headerStateManager.mapNodes((e=>{const{collapsible:o,origColspan:n,headerLevel:i,columnIndex:s,isCollapsed:r}=e;if(!0===o&&n>1&&(r&&"expand"===t||!r&&"collapse"===t))return{row:this.headerStateManager.levelToRowCoords(i),col:s}}));this.toggleCollapsibleSection(e,t)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(t,e){if(!ry.has(e))throw new Error(`Unsupported action is passed (${e}).`);if(!Array.isArray(t))return;const o=I(t,(t=>{let{row:e}=t;return e<0}));let n=o.length>0;k(o,(t=>{var o;let{row:i,col:s}=t;const{collapsible:r,isCollapsed:l}=null!==(o=this.headerStateManager.getHeaderSettings(i,s))&&void 0!==o?o:{};if(!r||l&&"collapse"===e||!l&&"expand"===e)return n=!1,!1}));const i=[],s=[];n&&k(o,(t=>{let{row:o,col:n}=t;const{colspanCompensation:r,affectedColumns:l,rollbackModification:a}=this.headerStateManager.triggerNodeModification(e,o,n);r>0&&(s.push(...l),i.push(a))}));const r=this.getCollapsedColumns();let l=[];"collapse"===e?l=L([...r,...s]):"expand"===e&&(l=I(r,(t=>!s.includes(t))));const a=ry.get(e),h=this.hot.runHooks(a.beforeHook,r,l,n);if(!1===h)return void k(i,(t=>{t()}));this.hot.batchExecution((()=>{k(s,(t=>{qv(this,ly).setValueAtIndex(this.hot.toPhysicalColumn(t),a.hideColumn)}))}),!0);const c=this.getCollapsedColumns().length!==r.length;this.hot.runHooks(a.afterHook,r,l,n,c),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return qv(this,ly).getHiddenIndexes()}onAfterGetColHeader(t,e,o){var n;const{collapsible:i,origColspan:s,isCollapsed:r}=null!==(n=this.headerStateManager.getHeaderSettings(o,t))&&void 0!==n?n:{},l=i&&s>1&&t>=this.hot.getSettings().fixedColumnsStart,a=this.hot.getSettings().ariaTags;let h=e.querySelector(`.${iy}`);var c;(fe(e,[Bt("")[0]]),l)?(h||(h=this.hot.rootDocument.createElement("div"),de(h,iy),e.querySelector("div:first-child").appendChild(h)),ue(h,["collapsed","expanded"]),r?(de(h,"collapsed"),ve(h,"+"),a&&ge(e,...Bt(!1))):(de(h,"expanded"),ve(h,"-"),a&&ge(e,...Bt(!0))),a&&ge(h,...kt())):null===(c=h)||void 0===c||c.remove()}onBeforeOnCellMouseDown(t,e){ce(t.target,iy)&&(ce(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ce(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),en(t))}onInit(){this.updatePlugin()}onAfterLoadData(t,e){e||this.updatePlugin()}destroy(){Jv(this,ly,null),super.destroy()}}const hy=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],cy=!1,dy=!0,uy=!0;class gy{constructor(t,e){this.hot=t,this.sortingStates=new Sh,this.sortEmptyCells=cy,this.indicator=dy,this.headerAction=uy,this.compareFunctionFactory=void 0,this.mapName=e,this.hot.columnIndexMapper.registerMap(e,this.sortingStates)}updateAllColumnsProperties(t){bo(t)&&Eo(t,((t,e)=>{hy.includes(e)&&(this[e]=t)}))}getAllColumnsProperties(){const t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"===typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}getSortOrderOfColumn(t){var e;return null===(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))||void 0===e?void 0:e.sortOrder}getIndexOfColumnInSortQueue(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex((e=>{let[o]=e;return o===t}))}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(t){return bo(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))}getSortStates(){if(null===this.sortingStates)return[];const t=this.sortingStates.getEntries();return t.map((t=>{let[e,o]=t;return{column:this.hot.toVisualColumn(e),...o}}))}getColumnSortState(t){const e=this.getSortOrderOfColumn(t);if(U(e))return{column:t,sortOrder:e}}setSortStates(t){this.sortingStates.clear();for(let e=0;e<t.length;e+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[e].column),{sortOrder:t[e].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const fy="asc",my="desc",py="colHeader";function wy(t){if(!1===bo(t))return!1;const{column:e,sortOrder:o}=t;return Number.isInteger(e)&&[fy,my].includes(o)}function Cy(t){if(t.some((t=>!1===wy(t))))return!1;const e=t.map((t=>{let{column:e}=t;return e}));return new Set(e).size===e.length}function vy(t){if(t!==my)return t===fy?my:fy}function yy(t){const e=t.querySelector(`.${py}`);return e}function Sy(t,e){if(t<0||!e.parentNode)return!1;const o=e.parentNode.parentNode.childNodes,n=Array.from(o).indexOf(e.parentNode)-o.length;return-1===n}function by(t,e,o){return-1===t&&e>=0&&!1===nn(o)}const Ry="ascending",Ey="descending",My="indicatorDisabled",Ty="columnSorting",Hy="sortAction",xy=new Map([[fy,Ry],[my,Ey]]);function Iy(t,e,o,n){const i=[Ty];if(n&&i.push(Hy),!1===o)return i.push(My),i;const s=t.getSortOrderOfColumn(e);return U(s)&&i.push(xy.get(s)),i}function Ay(){return Array.from(xy.values()).concat(Hy,My,Ty)}const ky=0,Oy=-1,Py=1;function Ny(t,e){const o=Yy(e);for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];t.sort(o(...i))}function _y(t,e,o){const n=e.locale;return function(e,i){const{sortEmptyCells:s}=o;return"string"===typeof e&&(e=e.toLocaleLowerCase(n)),"string"===typeof i&&(i=i.toLocaleLowerCase(n)),e===i?ky:G(e)?G(i)?ky:s&&"asc"===t?Oy:Py:G(i)?s&&"asc"===t?Py:Oy:isNaN(e)&&!isNaN(i)?"asc"===t?Py:Oy:!isNaN(e)&&isNaN(i)?"asc"===t?Oy:Py:(isNaN(e)||isNaN(i)||(e=parseFloat(e),i=parseFloat(i)),e<i?"asc"===t?Oy:Py:e>i?"asc"===t?Py:Oy:ky)}}const Dy="default";function Ly(t,e,o){return function(e,n){const i=parseFloat(e),s=parseFloat(n),{sortEmptyCells:r}=o;if(i===s||isNaN(i)&&isNaN(s))return ky;if(r){if(G(e))return"asc"===t?Oy:Py;if(G(n))return"asc"===t?Py:Oy}return isNaN(i)?Py:isNaN(s)?Oy:i<s?"asc"===t?Oy:Py:i>s?"asc"===t?Py:Oy:ky}}const Vy="numeric";function By(t,e,o){const n=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:s}=o;return function(r,l){const a=G(r),h=G(l),c=a?i:r,d=h?i:l,u=c===i||c===n,g=d===i||d===n;if(!1===s){if(a&&!1===h)return Py;if(!1===a&&h)return Oy}return!1===u&&g?"asc"===t?Oy:Py:u&&!1===g?"asc"===t?Py:Oy:!1===u&&!1===g?_y(t,e,o)(r,l):c===i&&d===n?"asc"===t?Oy:Py:c===n&&d===i?"asc"===t?Py:Oy:ky}}const Fy="checkbox";function Wy(t,e,o){return function(n,i){const{sortEmptyCells:s}=o;if(n===i)return ky;if(G(n))return G(i)?ky:s&&"asc"===t?Oy:Py;if(G(i))return s&&"asc"===t?Py:Oy;const r=e.dateFormat,l=E(n,r),a=E(i,r);return l.isValid()?a.isValid()?a.isAfter(l)?"asc"===t?Oy:Py:a.isBefore(l)?"asc"===t?Py:Oy:ky:Oy:Py}}const jy="date",{register:zy,getItem:Uy,hasItem:$y}=Cn("sorting.compareFunctionFactory"),{register:Gy,getItem:Yy}=Cn("sorting.mainSortComparator");function Ky(t){return $y(t)?Uy(t):Uy(Dy)}function Xy(t,e){return function(o,n){const[,...i]=o,[,...s]=n;return function(o){const n=t[o],r=e[o],l=i[o],a=s[o],h=r.columnSorting,c=h.compareFunctionFactory?h.compareFunctionFactory:Ky(r.type),d=c(n,r,h)(l,a);return d}(0)}}zy(Vy,Ly),zy(Fy,By),zy(jy,Wy),zy(Dy,_y);const qy="columnSorting",Qy=50,Jy="append",Zy="replace",tS=qy;Gy(qy,Xy),pn.getSingleton().register("beforeColumnSort"),pn.getSingleton().register("afterColumnSort");class eS extends tv{static get PLUGIN_KEY(){return qy}static get PLUGIN_PRIORITY(){return Qy}constructor(t){super(t),this.columnStatesManager=null,this.columnMetaCache=null,this.pluginKey=qy,this.indexesSequenceCache=null}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var t=this;this.enabled||(this.columnStatesManager=new gy(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new ph((t=>{let e=this.hot.toVisualColumn(t);return null===e&&(e=t),this.getMergedPluginSettings(e)})),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",((t,e)=>this.onAfterGetColHeader(t,e))),this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown(...arguments)})),this.addHook("afterOnCellMouseDown",((t,e)=>this.onAfterOnCellMouseDown(t,e))),this.addHook("afterInit",(()=>this.loadOrSortBySettings())),this.addHook("afterLoadData",(function(){return t.onAfterLoadData(...arguments)})),this.hot.view&&this.loadOrSortBySettings(),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const t=(t,e)=>{const o=yy(e);!1!==Sy(t,e)&&null!==o&&this.updateHeaderClasses(o)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("afterGetColHeader",t)})),this.hot.batchExecution((()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))}),!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();-1===t.row&&t.col>=0&&this.sort(this.getColumnNextConfig(t.col))},runOnlyIf:()=>{var t;return null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},group:tS})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tS)}sort(t){const e=this.getSortConfig(),o=this.getNormalizedSortConfigs(t),n=this.areValidSortConfigs(o),i=this.hot.runHooks("beforeColumnSort",e,o,n);!1!==i&&(0===e.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new gh),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),n&&(this.columnStatesManager.setSortStates(o),this.sortByPresetSortStates(o),this.saveAllSortSettings(o)),this.hot.runHooks("afterColumnSort",e,n?o:e,n),n&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(t){return U(t)?this.columnStatesManager.getColumnSortState(t):this.columnStatesManager.getSortStates()}setSortConfig(t){const e=this.getNormalizedSortConfigs(t);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t]}areValidSortConfigs(t){const e=this.hot.countCols();return Cy(t)&&t.every((t=>{let{column:o}=t;return o<=e&&o>=0}))}saveAllSortSettings(t){const e=this.columnStatesManager.getAllColumnsProperties(),o=t=>{let{column:e,...o}=t;return{column:this.hot.toPhysicalColumn(e),...o}};e.initialConfig=A(t,o),this.hot.runHooks("persistentStateSave","columnSorting",e)}getAllSavedSortSettings(){const t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);const e=t.value,o=t=>{let{column:e,...o}=t;return{column:this.hot.toVisualColumn(e),...o}};return U(e)&&Array.isArray(e.initialConfig)&&(e.initialConfig=A(e.initialConfig,o)),e}getColumnNextConfig(t){const e=this.columnStatesManager.getSortOrderOfColumn(t);if(U(e)){const o=vy(e);return U(o)?{column:t,sortOrder:o}:void 0}const o=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<o)return{column:t,sortOrder:vy()}}getNextSortConfig(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jy;const o=this.columnStatesManager.getIndexOfColumnInSortQueue(t),n=-1!==o,i=this.getSortConfig(),s=this.getColumnNextConfig(t);if(n){if($(s))return[...i.slice(0,o),...i.slice(o+1)];if(e===Jy)return[...i.slice(0,o),...i.slice(o+1),s];if(e===Zy)return[...i.slice(0,o),s,...i.slice(o+1)]}return U(s)?i.concat(s):i}getPluginColumnConfig(t){if(bo(t)){const e=t[this.pluginKey];if(bo(e))return e}return{}}getMergedPluginSettings(t){const e=this.hot.getSettings()[this.pluginKey],o=this.columnStatesManager.getAllColumnsProperties(),n=this.hot.getCellMeta(0,t),i=Object.getPrototypeOf(n);return Array.isArray(i.columns)?Object.assign(o,e,this.getPluginColumnConfig(i.columns[t])):io(i.columns)?Object.assign(o,e,this.getPluginColumnConfig(i.columns(t))):Object.assign(o,e)}getFirstCellSettings(t){const e=this.hot.getCellMeta(0,t),o=Object.create(e);return o[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(t)),o}getNumberOfRowsToSort(t){const e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}sortByPresetSortStates(t){if(0===t.length)return void this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());const e=[],o=this.hot.countRows(),n=e=>A(t,(t=>this.hot.getDataAtCell(e,t.column)));for(let a=0;a<this.getNumberOfRowsToSort(o);a+=1)e.push([this.hot.toPhysicalRow(a)].concat(n(a)));const i=A(e,(t=>t[0]));Ny(e,this.pluginKey,A(t,(t=>t.sortOrder)),A(t,(t=>this.getFirstCellSettings(t.column))));for(let a=e.length;a<o;a+=1)e.push([a].concat(n(a)));const s=A(e,(t=>t[0])),r=new Map(A(i,((t,e)=>[t,s[e]]))),l=A(this.hot.rowIndexMapper.getIndexesSequence(),(t=>r.has(t)?r.get(t):t));this.hot.rowIndexMapper.setIndexesSequence(l)}loadOrSortBySettings(){const t=this.getAllSavedSortSettings();if(bo(t))this.sortBySettings(t);else{const t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}sortBySettings(t){if(bo(t)){this.columnStatesManager.updateAllColumnsProperties(t);const e=t.initialConfig;(Array.isArray(e)||bo(e))&&this.sort(e)}else this.hot.render()}onAfterGetColHeader(t,e){const o=yy(e);if(!1===Sy(t,e)||null===o)return;const n=this.getFirstCellSettings(t)[this.pluginKey],i=n.indicator,s=n.headerAction;if(this.updateHeaderClasses(o,this.columnStatesManager,t,i,s),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(t);ge(e,...Ft(o?`${o}ending`:"none"))}}updateHeaderClasses(t){if(ue(t,Ay(t)),!1!==this.enabled){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];de(t,Iy(...o))}}onUpdateSettings(t){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),U(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}onAfterLoadData(t){!0===t&&this.hot.view&&this.loadOrSortBySettings()}wasClickableHeaderClicked(t,e){const o=this.getFirstCellSettings(e)[this.pluginKey],n=o.headerAction;return n&&"SPAN"===t.target.nodeName}onBeforeOnCellMouseDown(t,e,o,n){!1!==by(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(n.column=!0)}onAfterOnCellMouseDown(t,e){!1!==by(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col)),this.sort(this.getColumnNextConfig(e.col)))}destroy(){var t;null===(t=this.columnStatesManager)||void 0===t||t.destroy(),super.destroy()}}class oS{constructor(t,e){this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=e,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}getEndpoint(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(t){return this.parseSettings(t.call(this))}parseSettings(t){const e=[];let o=t;if(o||"function"!==typeof this.settings)return o||(o=this.settings),k(o,(t=>{const o={};this.assignSetting(t,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(t,o,"reversedRowCoords",!1),this.assignSetting(t,o,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,o,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,o,"sourceColumn",t.destinationColumn),this.assignSetting(t,o,"type","sum"),this.assignSetting(t,o,"forceNumeric",!1),this.assignSetting(t,o,"suppressDataTypeErrors",!0),this.assignSetting(t,o,"suppressDataTypeErrors",!0),this.assignSetting(t,o,"customFunction",null),this.assignSetting(t,o,"readOnly",!0),this.assignSetting(t,o,"roundFloat",!1),e.push(o)})),e;this.settingsType="function"}assignSetting(t,e,o,n){if("ranges"!==o||void 0!==t[o]){if("ranges"!==o||0!==t[o].length)if(void 0===t[o]){if(n instanceof Error)throw n;e[o]=n}else"destinationRow"===o&&e.reversedRowCoords?e[o]=this.hot.countRows()-t[o]-1:e[o]=t[o]}else e[o]=n}resetSetupBeforeStructureAlteration(t,e,o){if("function"!==this.settingsType)return;const n=t.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();k(i,(i=>{"row"===n&&i.destinationRow>=e&&("insert_row"===t?i.alterRowOffset=o:"remove_row"===t&&(i.alterRowOffset=-1*o)),"col"===n&&i.destinationColumn>=e&&("insert_col"===t?i.alterColumnOffset=o:"remove_col"===t&&(i.alterColumnOffset=-1*o))})),this.resetAllEndpoints(i,!1)}resetSetupAfterStructureAlteration(t,e,o,n,i){let s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const t=()=>(this.hot.removeHook("beforeViewRender",t),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",t)}const r=t.indexOf("row")>-1?"row":"col",l=t.indexOf("remove")>-1?-1:1,a=this.getAllEndpoints(),h=0===t.indexOf("move_row"),c=e;k(a,(t=>{"row"===r&&t.destinationRow>=c&&(t.alterRowOffset=l*o),"col"===r&&t.destinationColumn>=c&&(t.alterColumnOffset=l*o)})),this.resetAllEndpoints(a,!h),k(a,h?t=>{this.extendEndpointRanges(t,c,n[0],n.length),this.recreatePhysicalRanges(t),this.clearOffsetInformation(t)}:t=>{this.shiftEndpointCoordinates(t,c)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}extendEndpointRanges(t,e,o,n){k(t.ranges,(t=>{t[1]&&(e>=t[0]&&e<=t[1]?o>t[1]?t[1]+=n:o<t[0]&&(t[0]-=n):o>=t[0]&&o<=t[1]&&(t[1]-=n,e<=t[0]&&(t[0]+=1,t[1]+=1)))}))}recreatePhysicalRanges(t){const e=t.ranges,o=[],n=[];k(e,(t=>{const e=[];if(t[1])for(let o=t[0];o<=t[1];o++)e.push(this.hot.toPhysicalRow(o));else e.push(this.hot.toPhysicalRow(t[0]));n.push(e)})),k(n,(t=>{let e=[];k(t,((n,i)=>{0===i?e.push(n):t[i]!==t[i-1]+1&&(e.push(t[i-1]),o.push(e),e=[],e.push(n)),i===t.length-1&&(e.push(n),o.push(e))}))})),t.ranges=o}shiftEndpointCoordinates(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,k(t.ranges,(o=>{k(o,((n,i)=>{n>=e&&(o[i]+=t.alterRowOffset||0)}))}))):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}resetAllEndpoints(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const o=t.some((t=>{const e=t.alterRowOffset||0,o=t.alterColumnOffset||0;return t.destinationRow+e>=this.hot.countRows()||t.destinationColumn+o>=this.hot.countCols()}));o||(this.cellsToSetCache=[],k(t,(t=>{this.resetEndpointValue(t,e)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],k(this.getAllEndpoints(),(t=>{this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(t){const e=[];this.cellsToSetCache=[],k(t,((t,o,n)=>{`${t[2]||""}`!==`${t[3]}`&&k(this.getAllEndpoints(),((t,i)=>{this.hot.propToCol(n[o][1])===t.sourceColumn&&-1===e.indexOf(i)&&e.push(i)}))})),k(e,(t=>{this.refreshEndpoint(this.getEndpoint(t))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}resetEndpointValue(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const o=t.alterRowOffset||0,n=t.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(t.destinationRow+(e?o:0)),this.hot.toVisualColumn(t.destinationColumn+(e?n:0)),""])}setEndpointValue(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const i=this.hot.toVisualRow(t.destinationRow);if(null!==i){const o=this.hot.getCellMeta(i,t.destinationColumn);"init"!==e&&o.readOnly===t.readOnly||(o.readOnly=t.readOnly,o.className="columnSummaryResult")}t.roundFloat&&!isNaN(t.result)&&(t.result=t.result.toFixed(t.roundFloat)),o?this.hot.setDataAtCell(n,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([n,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}throwOutOfBoundsWarning(){ln("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}var nS=oS;function iS(t){return null===t||void 0===t||isNaN(t)}const sS="columnSummary",rS=220;class lS extends tv{static get PLUGIN_KEY(){return sS}static get PLUGIN_PRIORITY(){return rS}constructor(t){super(t),this.endpoints=null}isEnabled(){return!!this.hot.getSettings()[sS]}enablePlugin(){var t=this;this.enabled||(this.settings=this.hot.getSettings()[sS],this.endpoints=new nS(this,this.settings),this.addHook("afterInit",(function(){return t.onAfterInit(...arguments)})),this.addHook("afterChange",(function(){return t.onAfterChange(...arguments)})),this.addHook("beforeCreateRow",((t,e,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,e,null,o))),this.addHook("beforeCreateCol",((t,e,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,e,null,o))),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupBeforeStructureAlteration("remove_row",...o)})),this.addHook("beforeRemoveCol",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupBeforeStructureAlteration("remove_col",...o)})),this.addHook("afterCreateRow",((t,e,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,e,null,o))),this.addHook("afterCreateCol",((t,e,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,e,null,o))),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupAfterStructureAlteration("remove_row",...o)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupAfterStructureAlteration("remove_col",...o)})),this.addHook("afterRowMove",(function(){return t.onAfterRowMove(...arguments)})),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":t.result=this.calculateMinMax(t,t.type);break;case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t);break;default:break}}calculateSum(t){let e=0;return Eo(t.ranges,(o=>{e+=this.getPartialSum(o,t.sourceColumn)})),e}getPartialSum(t,e){let o=0,n=t[1]||t[0],i=null,s=0;do{if(i=this.getCellValue(n,e),i=iS(i)?null:i,null!==i){const t=(`${i}`.split(".")[1]||[]).length||1;t>s&&(s=t)}o+=i||0,n-=1}while(n>=t[0]);return Math.round(o*10**s)/10**s}calculateMinMax(t,e){let o=null;return Eo(t.ranges,(n=>{const i=this.getPartialMinMax(n,t.sourceColumn,e);if(null===o&&null!==i&&(o=i),null!==i)switch(e){case"min":o=Math.min(o,i);break;case"max":o=Math.max(o,i);break;default:break}})),null===o?"Not enough data":o}getPartialMinMax(t,e,o){let n,i=null,s=t[1]||t[0];do{if(n=this.getCellValue(s,e),n=iS(n)?null:n,null===i)i=n;else if(null!==n)switch(o){case"min":i=Math.min(i,n);break;case"max":i=Math.max(i,n);break;default:break}s-=1}while(s>=t[0]);return i}countEmpty(t,e){let o,n=0,i=t[1]||t[0];do{o=this.getCellValue(i,e),o=iS(o)?null:o,null===o&&(n+=1),i-=1}while(i>=t[0]);return n}countEntries(t){let e=0;const o=t.ranges;return Eo(o,(o=>{const n=void 0===o[1]?1:o[1]-o[0]+1,i=this.countEmpty(o,t.sourceColumn);e+=n,e-=i})),e}calculateAverage(t){const e=this.calculateSum(t),o=this.countEntries(t);return e/o}getCellValue(t,e){const o=this.hot.toVisualRow(t),n=this.hot.toVisualColumn(e);let i=this.hot.getSourceDataAtCell(t,e),s="";if(null!==o&&null!==n&&(s=this.hot.getCellMeta(o,n).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"===typeof i&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(j`ColumnSummary plugin: cell at (${t}, ${e}) is not in a\x20
          numeric format. Cannot do the calculation.`);return i}onAfterInit(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}onAfterChange(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}onAfterRowMove(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}}class aS{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(t,e){this.rootDocument=t,this.isRtl=e,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}setPosition(t,e){this.editorStyle.left=`${t}px`,this.editorStyle.top=`${e}px`}setSize(t,e){if(t&&e){const o=this.getInputElement();o.style.width=`${t}px`,o.style.height=`${e}px`}}getSize(){return{width:ke(this.getInputElement()),height:Oe(this.getInputElement())}}resetSize(){const t=this.getInputElement();t.style.width="",t.style.height=""}setReadOnlyState(t){const e=this.getInputElement();e.readOnly=t}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return"block"===this.editorStyle.display}setValue(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const e=t||"";this.getInputElement().value=e}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const t=this.rootDocument.createElement("div"),e=this.rootDocument.createElement("textarea");return t.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),de(this.container,aS.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),de(t,aS.CLASS_EDITOR),de(e,aS.CLASS_INPUT),e.setAttribute("data-hot-input",!0),t.appendChild(e),this.container.appendChild(t),t}getInputElement(){return this.editor.querySelector(`.${aS.CLASS_INPUT}`)}destroy(){const t=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,t&&t.removeChild(this.container)}}var hS=aS;const cS=250,dS=250;class uS{constructor(t){this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout((()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")}),dS)}show(t){this.wasLastActionShow=!0,this.showDebounced(t)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cS;this.showDebounced=lo((t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)}),t)}destroy(){this.clearLocalHooks()}}yo(uS,lh);var gS=uS;const fS="---------";function mS(){return{name:fS}}function pS(t){return{key:"commentsAddEdit",name(){var e;const o=null===(e=this.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return null!==o&&void 0!==o&&o.isCell()&&t.getCommentAtCell(o.row,o.col)?this.getTranslatedPhrase(Ac):this.getTranslatedPhrase(Ic)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const t=this.getSelectedRangeLast();return!t||(!!t.highlight.isHeader()||(0===this.countRenderedRows()||0===this.countRenderedCols()))}}}function wS(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(kc)},callback(){const e=this.getSelectedRangeLast();e.forAll(((e,o)=>{e>=0&&o>=0&&t.removeCommentAtCell(e,o,!1)})),this.render()},disabled(){const t=this.getSelectedRangeLast();return!t||(!!t.highlight.isHeader()||(0===this.countRenderedRows()||0===this.countRenderedCols()))}}}function CS(t,e){if(-1!==t.indexOf(e))return t;const o=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return`${o} ${e}`}function vS(t,e){if(-1!==t.indexOf(e))return t;const o=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return`${o} ${e}`}function yS(t,e){const o={};return k(t,(t=>{t.forAll(((t,n)=>{t>=0&&n>=0&&(o[t]||(o[t]=[]),o[t][n]=e(t,n))}))})),o}function SS(t,e,o,n,i){k(t,(t=>{t.forAll(((t,s)=>{t>=0&&s>=0&&bS(t,s,e,o,n,i)}))}))}function bS(t,e,o,n,i,s){const r=i(t,e);let l=n;r.className&&(l="vertical"===o?CS(r.className,n):vS(r.className,n)),s(t,e,"className",l)}function RS(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function ES(t,e){let o=!1;return Array.isArray(t)&&k(t,(t=>(t.forAll(((t,n)=>{if(t>=0&&n>=0&&e(t,n))return o=!0,!1})),o))),o}function MS(t,e){const o={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:t}=e.defaultView,{top:n,left:i}=t.getBoundingClientRect();o.top=n,o.left=i}return o}function TS(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(Oc),o=ES(this.getSelectedRange(),((e,o)=>t.getCommentMeta(e,o,jS)));return o?RS(e):e},callback(){const e=this.getSelectedRangeLast();e.forAll(((e,o)=>{if(e>=0&&o>=0){const n=!!t.getCommentMeta(e,o,jS);t.updateCommentMeta(e,o,{[jS]:!n})}}))},disabled(){const e=this.getSelectedRangeLast();return!e||(!!e.highlight.isHeader()||(!t.getCommentAtCell(e.highlight.row,e.highlight.col)||(0===this.countRenderedRows()||0===this.countRenderedCols())))}}}function HS(t,e,o){xS(t,e),e.set(t,o)}function xS(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IS(t,e,o){return e=AS(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function AS(t){var e=kS(t,"string");return"symbol"===typeof e?e:String(e)}function kS(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function OS(t,e,o){var n=_S(t,e,"set");return PS(t,n,o),o}function PS(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function NS(t,e){var o=_S(t,e,"get");return DS(t,o)}function _S(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function DS(t,e){return e.get?e.get.call(t):e.value}const LS="comments",VS=60,BS="comment",FS="value",WS="style",jS="readOnly",zS=LS,US=`plugin:${LS}`;var $S=new WeakMap,GS=new WeakMap,YS=new WeakMap,KS=new WeakMap,XS=new WeakMap,qS=new WeakMap,QS=new WeakMap;class JS extends tv{constructor(){super(...arguments),IS(this,"range",{}),IS(this,"eventManager",null),HS(this,$S,{writable:!0,value:null}),HS(this,GS,{writable:!0,value:null}),HS(this,YS,{writable:!0,value:!1}),HS(this,KS,{writable:!0,value:!1}),HS(this,XS,{writable:!0,value:{}}),HS(this,qS,{writable:!0,value:null}),HS(this,QS,{writable:!0,value:""})}static get PLUGIN_KEY(){return LS}static get PLUGIN_PRIORITY(){return VS}isEnabled(){return!!this.hot.getSettings()[LS]}enablePlugin(){this.enabled||(NS(this,$S)||OS(this,$S,new hS(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new On(this)),NS(this,GS)||OS(this,GS,new gS(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(t=>this.addToContextMenu(t))),this.addHook("afterRenderer",((t,e,o,n,i,s)=>this.onAfterRenderer(t,s))),this.addHook("afterScroll",(()=>this.onAfterScroll())),this.addHook("afterBeginEditing",(()=>this.hide())),this.addHook("afterDocumentKeyDown",(t=>this.onAfterDocumentKeyDown(t))),NS(this,GS).addLocalHook("hide",(()=>this.hide())),NS(this,GS).addLocalHook("show",((t,e)=>this.showAtCell(t,e))),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){NS(this,GS).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid"),o=t.addContext(US);e.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const e=this.hot.getSelectedRangeLast();OS(this,KS,!0),this.hot.scrollToFocusedCell((()=>{this.setRange(e),this.show(),this.focusEditor(),t.setActiveContextName(US),this.hot._registerTimeout((()=>{OS(this,KS,!1)}))}))},stopPropagation:!0,runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&!NS(this,$S).isVisible()},group:zS}),o.addShortcut({keys:[["Escape"]],callback:()=>{NS(this,$S).setValue(NS(this,QS)),this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&NS(this,$S).isVisible()},group:zS}),o.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&NS(this,$S).isVisible()},group:zS})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(zS)}registerListeners(){const{rootDocument:t}=this.hot,e=this.getEditorInputElement();this.eventManager.addEventListener(t,"mouseover",(t=>this.onMouseOver(t))),this.eventManager.addEventListener(t,"mousedown",(t=>this.onMouseDown(t))),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp())),this.eventManager.addEventListener(e,"focus",(()=>this.onEditorFocus())),this.eventManager.addEventListener(e,"blur",(()=>this.onEditorBlur())),this.eventManager.addEventListener(e,"mousedown",(t=>this.onEditorMouseDown(t))),this.eventManager.addEventListener(e,"mouseup",(t=>this.onEditorMouseUp(t)))}setRange(t){this.range=t}clearRange(){this.range={}}targetIsCellWithComment(t){const e=ne(t.target,"TD","TBODY");return!!(e&&ce(e,"htCommentCell")&&ne(e,[this.hot.rootElement]))}targetIsCommentTextArea(t){return this.getEditorInputElement()===t.target}setComment(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const e=NS(this,$S).getValue();let o="";null!==t&&void 0!==t?o=t:null!==e&&void 0!==e&&(o=e);const n=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(n,i,{[FS]:o}),this.hot.render()}setCommentAtCell(t,e,o){this.setRange({from:this.hot._createCellCoords(t,e)}),this.setComment(o)}removeComment(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,BS),t&&this.hot.render(),this.hide()}removeCommentAtCell(t,e){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(t,e)}),this.removeComment(o)}getComment(){const t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,FS)}getCommentAtCell(t,e){return this.getCommentMeta(t,e,FS)}show(){var t;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:e,col:o}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||o<0||o>this.hot.countSourceCols()-1)return!1;const n=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return NS(this,GS).cancelHiding(),NS(this,$S).setValue(null!==(t=n[BS]?n[BS][FS]:null)&&void 0!==t?t:""),NS(this,$S).show(),this.refreshEditor(!0),!0}showAtCell(t,e){return this.setRange({from:this.hot._createCellCoords(t,e)}),this.show()}hide(){NS(this,$S).hide()}refreshEditor(){var t,e;let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!o&&(!this.range.from||!NS(this,$S).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{row:s,col:r}=this.range.from;let l=n.getRenderableFromVisualIndex(s),a=i.getRenderableFromVisualIndex(r);const h=null===l;NS(this,$S).setPosition(0,0),null===l&&(l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(s,-1))),null===a&&(a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1)));const c=null===l,d=null===a;l=null!==(t=l)&&void 0!==t?t:0,a=null!==(e=a)&&void 0!==e?e:0;const{rootWindow:u,view:{_wt:g}}=this.hot,{wtTable:f}=g,m=g.getCell({row:l,col:a},!0),p=this.getCommentMeta(s,r,WS);p?NS(this,$S).setSize(p.width,p.height):NS(this,$S).resetSize();const w=d?0:f.getStretchedColumnWidth(a),C=h&&!c?Oe(m):0,{left:v,top:y,width:S,height:b}=m.getBoundingClientRect(),{width:R,height:E}=NS(this,$S).getSize(),{innerWidth:M,innerHeight:T}=this.hot.rootWindow,H=this.hot.rootDocument.documentElement;let x=v+u.scrollX+w,I=y+u.scrollY+C;this.hot.isRtl()&&(x-=R+w),this.hot.isLtr()&&v+S+R>M?x=v+u.scrollX-R-1:this.hot.isRtl()&&x<-(H.scrollWidth-H.clientWidth)&&(x=v+u.scrollX+w+1),y+E>T&&(I-=E-b+1),NS(this,$S).setPosition(x,I),NS(this,$S).setReadOnlyState(this.getCommentMeta(s,r,jS))}focusEditor(){NS(this,$S).focus()}updateCommentMeta(t,e,o){const n=this.hot.getCellMeta(t,e)[BS];let i;n?(i=Co(n),wo(i,o)):i=o,this.hot.setCellMeta(t,e,BS,i)}getCommentMeta(t,e,o){const n=this.hot.getCellMeta(t,e);if(n[BS])return n[BS][o]}onMouseDown(t){if(this.hot.view&&this.hot.view._wt&&!NS(this,YS)&&!this.targetIsCommentTextArea(t)){const e=ne(t.target,"TD","TBODY");let o=null;e&&(o=this.hot.getCoords(e)),(!e||this.range.from&&o&&(this.range.from.row!==o.row||this.range.from.col!==o.col))&&this.hide()}}onMouseOver(t){const{rootDocument:e}=this.hot;if(!(NS(this,YS)||NS(this,$S).isFocused()||ce(t.target,"wtBorder")||NS(this,qS)===t.target)&&NS(this,$S))if(OS(this,qS,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const e=this.hot._createCellRange(this.hot.getCoords(t.target));NS(this,GS).show(e)}else se(t.target,e)&&!this.targetIsCommentTextArea(t)&&NS(this,GS).hide()}onMouseUp(){OS(this,YS,!1)}onAfterRenderer(t,e){e[BS]&&e[BS][FS]&&de(t,e.commentedCellClassName)}onEditorBlur(){OS(this,QS,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}onEditorFocus(){OS(this,QS,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(US)}onEditorMouseDown(t){OS(this,XS,{width:ke(t.target),height:Oe(t.target)})}onEditorMouseUp(t){const e=ke(t.target),o=Oe(t.target);e===NS(this,XS).width+1&&o===NS(this,XS).height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,{[WS]:{width:e,height:o}})}onAfterDocumentKeyDown(t){NS(this,$S).isVisible()&&en(t)}onAfterScroll(){NS(this,KS)||this.hide()}addToContextMenu(t){t.items.push({name:fS},pS(this),wS(this),TS(this))}getDisplayDelaySetting(){const t=this.hot.getSettings()[LS];if(bo(t))return t.displayDelay}getEditorInputElement(){return NS(this,$S).getInputElement()}destroy(){NS(this,$S)&&NS(this,$S).destroy(),NS(this,GS)&&NS(this,GS).destroy(),super.destroy()}}o(7754);class ZS{constructor(t){this.hot=t,this.commands={},this.commonCallback=null}registerCommand(t,e){this.commands[t]=e}setCommonCallback(t){this.commonCallback=t}execute(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];const i=t.split(":"),s=i[0],r=2===i.length?i[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(r&&l.submenu&&(l=tb(r,l.submenu.items)),!0===l.disabled)return;if("function"===typeof l.disabled&&!0===l.disabled.call(this.hot))return;if(Io(l,"submenu"))return;const a=[];"function"===typeof l.callback&&a.push(l.callback),"function"===typeof this.commonCallback&&a.push(this.commonCallback),o.unshift(i.join(":")),k(a,(t=>t.apply(this.hot,o)))}}function tb(t,e){let o;return k(e,(e=>{const n=e.key?e.key.split(":"):null;if(Array.isArray(n)&&n[1]===t)return o=e,!1})),o}const eb="alignment";function ob(){return{key:eb,name(){return this.getTranslatedPhrase(Pc)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner()))},submenu:{items:[{key:`${eb}:left`,name(){let t=this.getTranslatedPhrase(Nc);const e=ES(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htLeft"))return!0}));return e&&(t=RS(t)),t},callback(){const t=this.getSelectedRange(),e=yS(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,o,n),SS(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${eb}:center`,name(){let t=this.getTranslatedPhrase(_c);const e=ES(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htCenter"))return!0}));return e&&(t=RS(t)),t},callback(){const t=this.getSelectedRange(),e=yS(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,o,n),SS(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${eb}:right`,name(){let t=this.getTranslatedPhrase(Dc);const e=ES(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htRight"))return!0}));return e&&(t=RS(t)),t},callback(){const t=this.getSelectedRange(),e=yS(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,o,n),SS(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${eb}:justify`,name(){let t=this.getTranslatedPhrase(Lc);const e=ES(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htJustify"))return!0}));return e&&(t=RS(t)),t},callback(){const t=this.getSelectedRange(),e=yS(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,o,n),SS(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{name:fS},{key:`${eb}:top`,name(){let t=this.getTranslatedPhrase(Vc);const e=ES(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htTop"))return!0}));return e&&(t=RS(t)),t},callback(){const t=this.getSelectedRange(),e=yS(t,((t,e)=>this.getCellMeta(t,e).className)),o="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,o,n),SS(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${eb}:middle`,name(){let t=this.getTranslatedPhrase(Bc);const e=ES(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htMiddle"))return!0}));return e&&(t=RS(t)),t},callback(){const t=this.getSelectedRange(),e=yS(t,((t,e)=>this.getCellMeta(t,e).className)),o="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,o,n),SS(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${eb}:bottom`,name(){let t=this.getTranslatedPhrase(Fc);const e=ES(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htBottom"))return!0}));return e&&(t=RS(t)),t},callback(){const t=this.getSelectedRange(),e=yS(t,((t,e)=>this.getCellMeta(t,e).className)),o="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,o,n),SS(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1}]}}}const nb="clear_column";function ib(){return{key:nb,name(){return this.getTranslatedPhrase(vc)},callback(t,e){const o=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,o,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByColumnHeader())}}}const sb="col_left";function rb(){return{key:sb,name(){return this.getTranslatedPhrase(uc)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.col<0)return!0;if(this.selection.isSelectedByCorner()){const t=this.countCols();return 0===t}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const lb="col_right";function ab(){return{key:lb,name(){return this.getTranslatedPhrase(gc)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden(){return!this.getSettings().allowInsertColumn}}}const hb="make_read_only";function cb(){return{key:hb,name(){let t=this.getTranslatedPhrase(Cc);const e=ES(this.getSelectedRange(),((t,e)=>this.getCellMeta(t,e).readOnly));return e&&(t=RS(t)),t},callback(){const t=this.getSelectedRange(),e=ES(t,((t,e)=>this.getCellMeta(t,e).readOnly));k(t,(t=>{t.forAll(((t,o)=>{t>=0&&o>=0&&this.setCellMeta(t,o,"readOnly",!e)}))})),this.render()},disabled(){const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||(!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))))}}}const db="redo";function ub(){return{key:db,name(){return this.getTranslatedPhrase(wc)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const gb="remove_col";function fb(){return{key:gb,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,o,,n]=t[0];o-n!==0&&(e=1)}return this.getTranslatedPhrase(mc,e)},callback(){this.alter("remove_col",pg(this.getSelected()),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}}const mb="remove_row";function pb(){return{key:mb,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[o,,n]=t[0];o-n!==0&&(e=1)}return this.getTranslatedPhrase(fc,e)},callback(){this.alter("remove_row",wg(this.getSelected()),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden(){return!this.getSettings().allowRemoveRow}}}const wb="row_above";function Cb(){return{key:wb,name(){return this.getTranslatedPhrase(cc)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.row<0)return!0;if(this.selection.isSelectedByCorner()){const t=this.countRows();return 0===t}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const vb="row_below";function yb(){return{key:vb,name(){return this.getTranslatedPhrase(dc)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.row<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows))},hidden(){return!this.getSettings().allowInsertRow}}}const Sb="no_items";function bb(){return{key:Sb,name(){return this.getTranslatedPhrase(hc)},disabled:!0,isCommand:!1}}const Rb="undo";function Eb(){return{key:Rb,name(){return this.getTranslatedPhrase(pc)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Mb=[wb,vb,sb,lb,nb,mb,gb,Rb,db,hb,eb,fS,Sb],Tb={[fS]:mS,[Sb]:bb,[wb]:Cb,[vb]:yb,[sb]:rb,[lb]:ab,[nb]:ib,[mb]:pb,[gb]:fb,[Rb]:Eb,[db]:ub,[hb]:cb,[eb]:ob};function Hb(){const t={};return Eo(Tb,((e,o)=>{t[o]=e()})),t}class xb{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.hot=t,this.predefinedItems=Hb(),this.defaultOrderPattern=e}setPredefinedItems(t){const e={};this.defaultOrderPattern.length=0,Eo(t,((t,o)=>{let n="";t.name===fS?(e[fS]=t,n=fS):isNaN(parseInt(o,10))?(t.key=void 0===t.key?o:t.key,e[o]=t,n=t.key):(e[t.key]=t,n=t.key),this.defaultOrderPattern.push(n)})),this.predefinedItems=e}getItems(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Ib(t,this.defaultOrderPattern,this.predefinedItems)}}function Ib(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),bo(i)?Eo(i,((t,e)=>{let i=o["string"===typeof t?t:e];i||(i=t),bo(t)?po(i,t):"string"===typeof i&&(i={name:i}),void 0===i.key&&(i.key=e),n.push(i)})):k(i,((t,e)=>{let i=o[t];!i&&Mb.indexOf(t)>=0||(i||(i={name:t,key:`${e}`}),bo(t)&&po(i,t),void 0===i.key&&(i.key=e),n.push(i))})),n}class Ab{constructor(t,e){const o=e.scrollY,n=e.scrollX;let i,s,r,l,a,h;this.rootWindow=e,this.type=this.getSourceType(t),"literal"===this.type?(i=parseInt(t.top,10),r=parseInt(t.left,10),a=t.height||0,h=t.width||0,s=i,l=r,i+=o,r+=n):"event"===this.type&&(i=parseInt(t.pageY,10),r=parseInt(t.pageX,10),a=t.target.clientHeight,h=t.target.clientWidth,s=i-o,l=r-n),this.top=i,this.topRelative=s,this.left=r,this.leftRelative=l,this.scrollTop=o,this.scrollLeft=n,this.cellHeight=a,this.cellWidth=h}getSourceType(t){let e="literal";return t instanceof Event&&(e="event"),e}fitsAbove(t){return this.topRelative>=t.offsetHeight}fitsBelow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}fitsOnRight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}fitsOnLeft(t){return this.leftRelative>=t.offsetWidth}}function kb(t,e,o){Ob(t,e),e.set(t,o)}function Ob(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pb(t,e){var o=Db(t,e,"get");return Nb(t,o)}function Nb(t,e){return e.get?e.get.call(t):e.value}function _b(t,e,o){var n=Db(t,e,"set");return Lb(t,n,o),o}function Db(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Lb(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var Vb=new WeakMap,Bb=new WeakMap,Fb=new WeakMap,Wb=new WeakMap,jb=new WeakMap;class zb{constructor(t){kb(this,Vb,{writable:!0,value:void 0}),kb(this,Bb,{writable:!0,value:void 0}),kb(this,Fb,{writable:!0,value:void 0}),kb(this,Wb,{writable:!0,value:!1}),kb(this,jb,{writable:!0,value:{above:0,below:0,left:0,right:0}}),_b(this,Wb,t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Pb(this,jb)[t]=e,this}setElement(t){return _b(this,Vb,t),this}setParentElement(t){return _b(this,Bb,t),this}updatePosition(t){_b(this,Fb,new Ab(t,Pb(this,Vb).ownerDocument.defaultView)),Pb(this,Wb)?(Pb(this,Fb).fitsBelow(Pb(this,Vb))?this.setPositionBelowCursor():Pb(this,Fb).fitsAbove(Pb(this,Vb))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===Pb(this,Vb).dir?Pb(this,Fb).fitsOnLeft(Pb(this,Vb))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Pb(this,Fb).fitsOnRight(Pb(this,Vb))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let t=Pb(this,jb).above+Pb(this,Fb).top-Pb(this,Vb).offsetHeight;Pb(this,Bb)&&(t=Pb(this,Fb).top+Pb(this,Fb).cellHeight-Pb(this,Vb).offsetHeight+3),Pb(this,Vb).style.top=`${t}px`}setPositionBelowCursor(){let t=Pb(this,jb).below+Pb(this,Fb).top+1;Pb(this,Bb)&&(t=Pb(this,Fb).top-1),Pb(this,Vb).style.top=`${t}px`}setPositionOnRightOfCursor(){let t=Pb(this,Fb).left;if(Pb(this,Bb)){const{right:e}=Pb(this,Bb).getBoundingClientRect();t+=Pb(this,Fb).cellWidth+e-(Pb(this,Fb).left+Pb(this,Fb).cellWidth)}else t+=Pb(this,jb).right;Pb(this,Vb).style.left=`${t}px`}setPositionOnLeftOfCursor(){let t=Pb(this,jb).left+Pb(this,Fb).left-Pb(this,Vb).offsetWidth;if(Pb(this,Bb)){const{left:e}=Pb(this,Bb).getBoundingClientRect();t-=Pb(this,Fb).left-e}Pb(this,Vb).style.left=`${t}px`}}function Ub(t){let{initialPage:e=-1,size:o=(()=>0),onItemSelect:n=(()=>{}),onClear:i=(()=>{})}=t;const s=new Set;let r=Ci(e,-1,f()-1);function l(t,e){const o=f()-1;if(t<0&&(t=o),t>o&&(t=0),s.has(t))return-1;s.add(t);const i=n(t,!1);return!1===i&&(t=l(1===e?++t:--t,e)),t}function a(t){t>-1&&t<f()&&!1!==n(t,!0)&&(r=t)}function h(){return r}function c(){f()>0&&(s.clear(),r=l(0,1))}function d(){f()>0&&(s.clear(),r=l(f()-1,-1))}function u(){f()>0&&(s.clear(),r=l(++r,1))}function g(){f()>0&&(s.clear(),r=l(--r,-1))}function f(){return Math.max(o(),0)}function m(){s.clear(),r=e,i()}return{setCurrentPage:a,getCurrentPage:h,toFirstItem:c,toLastItem:d,toNextItem:u,toPreviousItem:g,getSize:f,clear:m}}function $b(t){return A(t,(t=>({start:t.getTopStartCorner(),end:t.getBottomEndCorner()})))}function Gb(t){return Io(t,"submenu")}function Yb(t){return new RegExp(fS,"i").test(t.name)}function Kb(t,e){return!0===t.disabled||"function"===typeof t.disabled&&!0===t.disabled.call(e)}function Xb(t){return Io(t,"disableSelection")}function qb(t){return ce(t,"htSeparator")}function Qb(t){return ce(t,"htSubmenu")}function Jb(t){return ce(t,"htDisabled")}function Zb(t){return ce(t,"htSelectionDisabled")}function tR(t,e){return!t.hidden||!("function"===typeof t.hidden&&t.hidden.call(e))}function eR(t,e){const o=t.slice(0);for(let n=0;n<o.length;){if(o[n].name!==e)break;o.shift()}return o}function oR(t,e){let o=t.slice(0);return o.reverse(),o=eR(o,e),o.reverse(),o}function nR(t){const e=[];return k(t,((t,o)=>{o>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)})),e}function iR(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fS,o=t.slice(0);return o=eR(o,e),o=oR(o,e),o=nR(o),o}function sR(t){return Ub({size:()=>t.countRows(),onItemSelect(e,o){const n=t.getCell(e,0);if(!n||qb(n)||Jb(n)||Zb(n))return!1;t.selectCell(e,0,...o?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function rR(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const o=t.openSubMenu(e[0]);o&&o.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{const e=t.hotMenu.getSelectedLast();e&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const o=t.hotMenu.getSelectedLast();o&&(t.hotMenu.getSourceDataAtRow(o[0]).submenu?t.openSubMenu(o[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{const e=t.hotMenu.getSelectedLast();e?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{const e=t.hotMenu.getSelectedLast();e?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const lR="menu",aR=lR;function hR(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=[];function n(t,e){l(e).addShortcuts(t,{group:lR})}function i(t,e){const i=l(e);t.forEach((t=>{let{keys:e}=t;e.forEach((t=>i.removeShortcutsByKeys(t)))})),o.push({shortcuts:t,contextName:e}),n(t,e)}function s(){return[...o]}function r(t){return t?`${aR}:${t}`:aR}function l(e){var o;const n=t.hotMenu.getShortcutManager(),i=r(e);return null!==(o=n.getContext(i))&&void 0!==o?o:n.addContext(i)}function a(e){t.hotMenu.getShortcutManager().setActiveContextName(r(e))}return n(rR(t)),e.forEach((t=>{let{shortcuts:e,contextName:o}=t;i(e,o)})),{addCustomShortcuts:i,getCustomShortcuts:s,getContext:l,listen:a}}function cR(t){return(e,o,n,i,s,r)=>{if(o.hasAttribute("ghost-table"))return;const l=e.getSourceDataAtRow(n),a=t.rootDocument.createElement("div"),h="function"===typeof r?r.call(t):r;if(pe(o),de(a,"htItemWrapper"),t.getSettings().ariaTags){const e=!Kb(l,t)&&!Xb(l)&&!Yb(l);ge(o,[bt(),At(h),...e?[ft(-1)]:[],...Kb(l,t)?[Ot()]:[],...Gb(l)?[Bt(!1)]:[]])}o.className="",o.appendChild(a),Yb(l)?de(o,"htSeparator"):"function"===typeof l.renderer?(de(o,"htCustomMenuRenderer"),o.appendChild(l.renderer(e,a,n,i,s,h))):Ce(a,h),Kb(l,t)?de(o,"htDisabled"):Xb(l)?de(o,"htSelectionDisabled"):Gb(l)&&de(o,"htSubmenu")}}function dR(t,e,o){uR(t,e),e.set(t,o)}function uR(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gR(t,e,o){var n=pR(t,e,"set");return fR(t,n,o),o}function fR(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function mR(t,e){var o=pR(t,e,"get");return wR(t,o)}function pR(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function wR(t,e){return e.get?e.get.call(t):e.value}const CR=215;var vR=new WeakMap,yR=new WeakMap;class SR{constructor(t,e){var o=this;dR(this,vR,{writable:!0,value:void 0}),dR(this,yR,{writable:!0,value:void 0}),this.hot=t,this.options=e||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:CR,container:this.hot.rootDocument.documentElement},this.eventManager=new On(this),this.container=this.createContainer(this.options.name),this.positioner=new zb(this.options.keepInViewport),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.parentMenu.runLocalHooks("afterSelectionChange",...e)}))}registerEvents(){let t=this.hot.rootWindow;while(t)this.eventManager.addEventListener(t.document,"mousedown",(t=>this.onDocumentMouseDown(t))),this.eventManager.addEventListener(t.document,"contextmenu",(t=>this.onDocumentContextMenu(t))),t=ee(t)}setMenuItems(t){this.menuItems=t}getNavigator(){return mR(this,vR)}getKeyboardShortcutsCtrl(){return mR(this,yR)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const t=lo((t=>this.openSubMenu(t)),300),e=this.options.minWidth||CR;let o=!1,n=I(this.menuItems,(t=>(t.key===Sb&&(o=!0),tR(t,this.hot))));if(n.length<1&&!o)n.push(Hb()[Sb]);else if(0===n.length)return;n=iR(n,fS);let i=!1;const s={data:n,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(t){return U(t)&&t<e?e:t},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:cR(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(t,e)=>{mR(this,vR).setCurrentPage(e.row)},afterOnCellMouseOver:(e,o)=>{this.isAllSubMenusClosed()?t(o.row):this.openSubMenu(o.row)},rowHeights:t=>n[t].name===fS?1:23,afterOnCellContextMenu:t=>{t.preventDefault(),$o()&&i&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(t,e,o,n,i)=>{this.hotMenu.view.isMouseDown()&&(i.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:t=>{this.hasSelectedItem()&&(i=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(t))},afterOnCellMouseUp:t=>{$o()&&nn(t)||!i||!this.hasSelectedItem()||(jo()||Uo()?this.hot._registerTimeout((()=>this.close(!0)),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",(()=>this.onAfterInit())),this.hotMenu.init(),gR(this,vR,sR(this.hotMenu)),gR(this,yR,hR(this)),mR(this,yR).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",(()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this))),this.runLocalHooks("afterOpen",this)}close(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened())if(t&&this.isSubMenu())this.parentMenu.close();else if(mR(this,vR).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){const e=this.parentMenu.hotMenu.getCell(t[0],0);ge(e,[Bt(!1)])}}this.parentMenu.hotMenu.listen()}}openSubMenu(t){if(!this.hotMenu)return!1;const e=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!e||!Qb(e))return!1;const o=this.hotMenu.getSourceDataAtRow(t),n=new SR(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return n.setMenuItems(o.submenu.items),n.open(),n.setPosition(e.getBoundingClientRect()),this.hotSubMenus[o.key]=n,this.hot.getSettings().ariaTags&&ge(e,[Bt(!0)]),n}closeSubMenu(t){const e=this.hotMenu.getSourceDataAtRow(t),o=this.hotSubMenus[e.key];if(o){o.destroy(),delete this.hotSubMenus[e.key];const n=this.hotMenu.getCell(t,0);this.hot.getSettings().ariaTags&&ge(n,[Bt(!1)])}}closeAllSubMenus(){k(this.hotMenu.getData(),((t,e)=>this.closeSubMenu(e)))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(t){if(!this.isOpened()||!this.hasSelectedItem())return;const e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),this.isCommandPassive(e))return;const o=this.hot.getSelectedRange(),n=o?$b(o):[];this.runLocalHooks("executeCommand",e.key,n,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,n,t)}isCommandPassive(t){return!1===t.isCommand||Yb(t)||Kb(t,this.hot)||Gb(t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(t,e)}setPosition(t){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(t)}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.options.container.ownerDocument;let o,n=t;return n&&(io(n)&&(n=n.call(this.hot),n=null===n||$(n)?"":n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,o=e.querySelector(`.${this.options.className}.${n}`)),o||(o=e.createElement("div"),de(o,`htMenu ${this.options.className}`),n&&de(o,n),this.options.container.appendChild(o)),o}onAfterInit(){const{wtTable:t}=this.hotMenu.view._wt,e=this.hotMenu.getSettings().data,o=t.hider.style,n=t.holder.style,i=parseInt(o.width,10),s=x(e,((t,e)=>t+(e.name===fS?1:26)),0);n.width=`${i+3}px`,n.height=`${s+3}px`,o.height=n.height,this.hot.getSettings().ariaTags&&ge(this.hotMenu.rootElement,[St(),ft(-1)])}onDocumentMouseDown(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!se(t.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||se(t.target,".htMenu")||this.close(!0))}onDocumentContextMenu(t){this.isOpened()&&ce(t.target,"htCore")&&se(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}yo(SR,lh);const bR="contextMenu",RR=70,ER=bR;pn.getSingleton().register("afterContextMenuDefaultOptions"),pn.getSingleton().register("beforeContextMenuShow"),pn.getSingleton().register("afterContextMenuShow"),pn.getSingleton().register("afterContextMenuHide"),pn.getSingleton().register("afterContextMenuExecute");class MR extends tv{static get PLUGIN_KEY(){return bR}static get PLUGIN_PRIORITY(){return RR}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[wb,vb,fS,sb,lb,fS,mb,gb,fS,Rb,db,fS,hb,fS,eb]}constructor(t){super(t),this.eventManager=new On(this),this.commandExecutor=new ZS(this.hot),this.itemsFactory=null,this.menu=null}isEnabled(){return!!this.hot.getSettings()[bR]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[bR];"function"===typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new SR(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(()=>this.onMenuBeforeOpen())),this.menu.addLocalHook("afterOpen",(()=>this.onMenuAfterOpen())),this.menu.addLocalHook("afterClose",(()=>this.onMenuAfterClose())),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.executeCommand.call(t,...o)})),this.addHook("afterOnCellContextMenu",(t=>this.onAfterOnCellContextMenu(t))),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.unregisterShortcuts(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","\\"],["Shift","F10"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const e=this.hot.getCell(t.row,t.col,!0).getBoundingClientRect(),o=MS(this.menu.container,this.hot.rootDocument);this.open({left:e.left+o.left,top:e.top+o.top-1+e.height},{left:e.width,above:-e.height})},runOnlyIf:()=>this.hot.getSelectedRangeLast()&&!this.menu.isOpened(),group:ER})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ER)}open(t){var e;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.prepareMenuItems(),this.menu.open(),Eo(o,((t,e)=>{this.menu.setOffset(e,t)})),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close(),this.itemsFactory=null}executeCommand(t){null===this.itemsFactory&&this.prepareMenuItems();for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];this.commandExecutor.execute(t,...o)}prepareMenuItems(){this.itemsFactory=new xb(this.hot,MR.DEFAULT_ITEMS);const t=this.hot.getSettings()[bR],e={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",e),this.itemsFactory.setPredefinedItems(e.items);const o=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",o),this.menu.setMenuItems(o),k(o,(t=>this.commandExecutor.registerCommand(t.key,t)))}onAfterOnCellContextMenu(t){const e=this.hot.getSettings(),o=e.rowHeaders,n=e.colHeaders;function i(t){return"TD"===t.nodeName||"TD"===t.parentNode.nodeName}const s=t.target;if(this.close(),ce(s,"handsontableInput"))return;if(t.preventDefault(),t.stopPropagation(),!o&&!n&&!i(s)&&(!ce(s,"current")||!ce(s,"wtBorder")))return;const r=MS(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+r.top,left:t.clientX+r.left})}onMenuBeforeOpen(){this.hot.runHooks("beforeContextMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterContextMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function TR(t){return{key:"copy",name(){return this.getTranslatedPhrase(yc)},callback(){t.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function HR(t){return{key:"copy_column_headers_only",name(){const t=this.getSelectedRangeLast(),e=t?Ci(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Rc,e)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function xR(t){return{key:"copy_with_column_group_headers",name(){const t=this.getSelectedRangeLast(),e=t?Ci(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(bc,e)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function IR(t){return{key:"copy_with_column_headers",name(){const t=this.getSelectedRangeLast(),e=t?Ci(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Sc,e)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function AR(t){return{key:"cut",name(){return this.getTranslatedPhrase(Ec)},callback(){t.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}MR.SEPARATOR={name:fS};class kR{constructor(){this.data={}}setData(t,e){this.data[t]=e}getData(t){return this.data[t]||void 0}}class OR{constructor(){this.clipboardData=new kR}}function PR(t,e){_R(t,e),e.add(t)}function NR(t,e,o){_R(t,e),e.set(t,o)}function _R(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DR(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function LR(t,e){var o=FR(t,e,"get");return VR(t,o)}function VR(t,e){return e.get?e.get.call(t):e.value}function BR(t,e,o){var n=FR(t,e,"set");return WR(t,n,o),o}function FR(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function WR(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var jR=new WeakMap,zR=new WeakMap,UR=new WeakMap,$R=new WeakMap,GR=new WeakMap,YR=new WeakMap,KR=new WeakSet,XR=new WeakSet;class qR{constructor(t){let{countRows:e,countColumns:o,rowsLimit:n,columnsLimit:i,countColumnHeaders:s}=t;PR(this,XR),PR(this,KR),NR(this,jR,{writable:!0,value:void 0}),NR(this,zR,{writable:!0,value:void 0}),NR(this,UR,{writable:!0,value:void 0}),NR(this,$R,{writable:!0,value:void 0}),NR(this,GR,{writable:!0,value:void 0}),NR(this,YR,{writable:!0,value:void 0}),BR(this,zR,e),BR(this,UR,o),BR(this,$R,n),BR(this,GR,i),BR(this,YR,s)}setSelectedRange(t){BR(this,jR,t)}getCellsRange(){if(0===LR(this,zR).call(this)||0===LR(this,UR).call(this))return null;const{row:t,col:e}=LR(this,jR).getTopStartCorner(),{row:o,col:n}=LR(this,jR).getBottomEndCorner(),i=DR(this,XR,JR).call(this,t,o),s=DR(this,KR,QR).call(this,e,n),r=o!==i||n!==s;return{isRangeTrimmed:r,startRow:t,startCol:e,endRow:i,endCol:s}}getMostBottomColumnHeadersRange(){if(0===LR(this,UR).call(this)||0===LR(this,YR).call(this))return null;const{col:t}=LR(this,jR).getTopStartCorner(),{col:e}=LR(this,jR).getBottomEndCorner(),o=DR(this,KR,QR).call(this,t,e),n=e!==o;return{isRangeTrimmed:n,startRow:-1,startCol:t,endRow:-1,endCol:o}}getAllColumnHeadersRange(){if(0===LR(this,UR).call(this)||0===LR(this,YR).call(this))return null;const{col:t}=LR(this,jR).getTopStartCorner(),{col:e}=LR(this,jR).getBottomEndCorner(),o=DR(this,KR,QR).call(this,t,e),n=e!==o;return{isRangeTrimmed:n,startRow:-LR(this,YR).call(this),startCol:t,endRow:-1,endCol:o}}}function QR(t,e){return Math.min(e,Math.max(t+LR(this,GR).call(this)-1,t))}function JR(t,e){return Math.min(e,Math.max(t+LR(this,$R).call(this)-1,t))}function ZR(t){const e=[],o=[];return k(t,(t=>{const n=Math.min(t.startRow,t.endRow),i=Math.max(t.startRow,t.endRow);mi(n,i,(t=>{-1===e.indexOf(t)&&e.push(t)}));const s=Math.min(t.startCol,t.endCol),r=Math.max(t.startCol,t.endCol);mi(s,r,(t=>{-1===o.indexOf(t)&&o.push(t)}))})),{rows:e,columns:o}}function tE(t,e){oE(t,e),e.add(t)}function eE(t,e,o){oE(t,e),e.set(t,o)}function oE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nE(t,e,o){return e=iE(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function iE(t){var e=sE(t,"string");return"symbol"===typeof e?e:String(e)}function sE(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function rE(t,e){var o=cE(t,e,"get");return lE(t,o)}function lE(t,e){return e.get?e.get.call(t):e.value}function aE(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function hE(t,e,o){var n=cE(t,e,"set");return dE(t,n,o),o}function cE(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function dE(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}pn.getSingleton().register("afterCopyLimit"),pn.getSingleton().register("modifyCopyableRange"),pn.getSingleton().register("beforeCut"),pn.getSingleton().register("afterCut"),pn.getSingleton().register("beforePaste"),pn.getSingleton().register("afterPaste"),pn.getSingleton().register("beforeCopy"),pn.getSingleton().register("afterCopy");const uE="copyPaste",gE=80,fE=["fragmentSelection"],mE=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var pE=new WeakMap,wE=new WeakMap,CE=new WeakMap,vE=new WeakMap,yE=new WeakMap,SE=new WeakMap,bE=new WeakMap,RE=new WeakSet,EE=new WeakSet,ME=new WeakSet,TE=new WeakSet;class HE extends tv{constructor(){super(...arguments),tE(this,TE),tE(this,ME),tE(this,EE),tE(this,RE),nE(this,"columnsLimit",1/0),nE(this,"rowsLimit",1/0),nE(this,"pasteMode","overwrite"),nE(this,"uiContainer",this.hot.rootDocument.body),eE(this,pE,{writable:!0,value:!1}),eE(this,wE,{writable:!0,value:!1}),eE(this,CE,{writable:!0,value:!1}),eE(this,vE,{writable:!0,value:"cells-only"}),eE(this,yE,{writable:!0,value:!1}),eE(this,SE,{writable:!0,value:!1}),eE(this,bE,{writable:!0,value:new qR({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),nE(this,"copyableRanges",[])}static get PLUGIN_KEY(){return uE}static get SETTING_KEYS(){return[uE,...fE]}static get PLUGIN_PRIORITY(){return gE}isEnabled(){return!!this.hot.getSettings()[uE]}enablePlugin(){var t=this;if(this.enabled)return;const{[uE]:e}=this.hot.getSettings();var o,n;"object"===typeof e&&(this.pasteMode=null!==(o=e.pasteMode)&&void 0!==o?o:this.pasteMode,this.rowsLimit=isNaN(e.rowsLimit)?this.rowsLimit:e.rowsLimit,this.columnsLimit=isNaN(e.columnsLimit)?this.columnsLimit:e.columnsLimit,hE(this,pE,!!e.copyColumnHeaders),hE(this,wE,!!e.copyColumnGroupHeaders),hE(this,CE,!!e.copyColumnHeadersOnly),this.uiContainer=null!==(n=e.uiContainer)&&void 0!==n?n:this.uiContainer);this.addHook("afterContextMenuDefaultOptions",(t=>this.onAfterContextMenuDefaultOptions(t))),this.addHook("afterSelectionEnd",(()=>this.onAfterSelectionEnd())),this.eventManager=new On(this),this.eventManager.addEventListener(this.hot.rootDocument,"copy",(function(){return t.onCopy(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"cut",(function(){return t.onCut(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"paste",(function(){return t.onPaste(...arguments)})),Bo()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",(function(){return t.onSafariMouseEnter(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",(function(){return t.onSafariMouseLeave(...arguments)})),this.addHook("afterSelection",(()=>this.onSafariAfterSelection()))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only";hE(this,vE,t),hE(this,yE,!0),aE(this,RE,xE).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){hE(this,SE,!0),aE(this,RE,xE).call(this,"cut")}getRangedCopyableData(t){return rf(this.getRangedData(t))}getRangedData(t){const e=[],{rows:o,columns:n}=ZR(t);return k(o,(t=>{const o=[];k(n,(e=>{t<0?o.push(this.hot.getColHeader(e,t)):o.push(this.hot.getCopyableData(t,e))})),e.push(o)})),e}paste(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t&&!e)return;const o=new OR;t&&o.clipboardData.setData("text/plain",t),e&&o.clipboardData.setData("text/html",e),this.onPaste(o)}setCopyableText(){const t=this.hot.getSelectedRangeLast();if(!t)return;if(t.isSingleHeader())return void(this.copyableRanges=[]);rE(this,bE).setSelectedRange(t);const e=new Map([["headers",null],["cells",null]]);"column-headers-only"===rE(this,vE)?e.set("headers",rE(this,bE).getMostBottomColumnHeadersRange()):("with-column-headers"===rE(this,vE)?e.set("headers",rE(this,bE).getMostBottomColumnHeadersRange()):"with-column-group-headers"===rE(this,vE)&&e.set("headers",rE(this,bE).getAllColumnHeadersRange()),e.set("cells",rE(this,bE).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter((t=>null!==t)).map((t=>{let{startRow:e,startCol:o,endRow:n,endCol:i}=t;return{startRow:e,startCol:o,endRow:n,endCol:i}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const o=e.get("cells");if(null!==o&&o.isRangeTrimmed){const{startRow:t,startCol:e,endRow:n,endCol:i}=o;this.hot.runHooks("afterCopyLimit",n-t+1,i-e+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}populateValues(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!t.length)return;const o=t.length,n=t[0].length,i=[],{row:s,col:r}=e.getTopStartCorner(),{row:l,col:a}=e.getBottomEndCorner();let h=s,c=r,d=s,u=r;while(i.length<o||h<=l){const{skipRowOnPaste:e,visualRow:l}=this.hot.getCellMeta(h,r);if(h=l+1,!0===e)continue;d=l,c=r;const g=[],f=i.length%o;while(g.length<n||c<=a){const{skipColumnOnPaste:e,visualCol:o}=this.hot.getCellMeta(s,c);if(c=o+1,!0===e)continue;u=o;const i=g.length%n;g.push(t[f][i])}i.push(g)}return this.hot.populateFromArray(s,r,i,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,r,d,u]}onCopy(t){if(!this.hot.isListening()&&!rE(this,yE)||this.isEditorOpened())return;this.setCopyableText(),hE(this,yE,!1);const e=this.getRangedData(this.copyableRanges),o=aE(this,EE,IE).call(this,this.copyableRanges),n=!!this.hot.runHooks("beforeCopy",e,this.copyableRanges,o);if(n){const n=rf(e);if(t&&t.clipboardData){const o=di(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",n),t.clipboardData.setData("text/html",[mE,o].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n);this.hot.runHooks("afterCopy",e,this.copyableRanges,o)}hE(this,vE,"cells-only"),t.preventDefault()}onCut(t){if(!this.hot.isListening()&&!rE(this,SE)||this.isEditorOpened())return;this.setCopyableText(),hE(this,SE,!1);const e=this.getRangedData(this.copyableRanges),o=!!this.hot.runHooks("beforeCut",e,this.copyableRanges);if(o){const o=rf(e);if(t&&t.clipboardData){const n=di(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",o),t.clipboardData.setData("text/html",[mE,n].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",e,this.copyableRanges)}t.preventDefault()}onPaste(t){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;let e;if(t&&t.preventDefault&&t.preventDefault(),t&&"undefined"!==typeof t.clipboardData){const o=gt(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(o&&/(<table)|(<TABLE)/g.test(o)){const t=ui(o,this.hot.rootDocument);e=t.data}else e=t.clipboardData.getData("text/plain")}else"undefined"===typeof ClipboardEvent&&"undefined"!==typeof this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));if("string"===typeof e&&(e=sf(e)),void 0===e||e&&0===e.length)return;if(!1===this.hot.runHooks("beforePaste",e,this.copyableRanges))return;const[o,n,i,s]=this.populateValues(e);this.hot.selectCell(o,n,Math.min(this.hot.countRows()-1,i),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",e,this.copyableRanges)}onAfterContextMenuDefaultOptions(t){t.items.push({name:"---------"},TR(this)),rE(this,pE)&&t.items.push(IR(this)),rE(this,wE)&&t.items.push(xR(this)),rE(this,CE)&&t.items.push(HR(this)),t.items.push(AR(this))}onAfterSelectionEnd(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}onSafariMouseEnter(){aE(this,TE,kE).call(this)}onSafariMouseLeave(){aE(this,ME,AE).call(this)}onSafariAfterSelection(){aE(this,TE,kE).call(this)}destroy(){super.destroy()}}function xE(t){if(Bo()){const e=this.hot.getSelectedRangeLast();if(e){const{row:o,col:n}=e.highlight,i=this.hot.getCell(o,n,!0);i&&no(i,(()=>{this.hot.rootDocument.execCommand(t)}))}}else this.hot.rootDocument.execCommand(t)}function IE(t){const{rows:e}=ZR(t);let o=0;for(let n=0;n<e.length;n++){if(e[n]>=0)break;o+=1}return{columnHeadersCount:o}}function AE(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:o}=t.highlight,n=this.hot.getCell(e,o,!0);n&&eo(n)}}}function kE(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:o}=t.highlight,n=this.hot.getCell(e,o,!0);null!==n&&void 0!==n&&n.hasAttribute("contenteditable")&&oo(n)}}}function OE(t,e){return`border_row${t}col${e}`}function PE(){return{width:1,color:"#000"}}function NE(){return{hide:!0}}function _E(){return{width:1,color:"#000",cornerVisible:!1}}function DE(t){var e,o;(U(t.start)||U(t.left))&&(t.start=null!==(e=t.start)&&void 0!==e?e:t.left);(U(t.end)||U(t.right))&&(t.end=null!==(o=t.end)&&void 0!==o?o:t.right);return delete t.left,delete t.right,t}function LE(t){return U(t.start)&&(t.left=t.start),U(t.end)&&(t.right=t.end),t}function VE(t,e){return{id:OE(t,e),border:_E(),row:t,col:e,top:NE(),bottom:NE(),start:NE(),end:NE()}}function BE(t,e){return Io(e,"border")&&e.border&&(t.border=e.border),Io(e,"top")&&U(e.top)&&(e.top?(bo(e.top)||(e.top=PE()),t.top=e.top):(e.top=NE(),t.top=e.top)),Io(e,"bottom")&&U(e.bottom)&&(e.bottom?(bo(e.bottom)||(e.bottom=PE()),t.bottom=e.bottom):(e.bottom=NE(),t.bottom=e.bottom)),Io(e,"start")&&U(e.start)&&(e.start?(bo(e.start)||(e.start=PE()),t.start=e.start):(e.start=NE(),t.start=e.start)),Io(e,"end")&&U(e.end)&&(e.end?(bo(e.end)||(e.end=PE()),t.end=e.end):(e.end=NE(),t.end=e.end)),t}function FE(t,e){let o=!1;return k(t.getSelectedRange(),(n=>{n.forAll(((n,i)=>{if(n<0||i<0)return;const s=t.getCellMeta(n,i).borders;if(s){if(!e)return o=!0,!1;if(!Io(s[e],"hide")||!1===s[e].hide)return o=!0,!1}}))})),o}function WE(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function jE(t){return t.some((t=>U(t.left)||U(t.right)))}function zE(t){return t.some((t=>U(t.start)||U(t.end)))}const UE=new Map([["left","start"],["right","end"]]);function $E(t){var e;return null!==(e=UE.get(t))&&void 0!==e?e:t}function GE(t){return{key:"borders:top",name(){let t=this.getTranslatedPhrase(jc);const e=FE(this,"top");return e&&(t=WE(t)),t},callback(e,o){const n=FE(this,"top");t.prepareBorder(o,"top",n)}}}function YE(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(zc);const o=FE(this,e);return o&&(t=WE(t)),t},callback(o,n){const i=FE(this,e);t.prepareBorder(n,e,i)}}}function KE(t){return{key:"borders:bottom",name(){let t=this.getTranslatedPhrase(Uc);const e=FE(this,"bottom");return e&&(t=WE(t)),t},callback(e,o){const n=FE(this,"bottom");t.prepareBorder(o,"bottom",n)}}}function XE(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase($c);const o=FE(this,e);return o&&(t=WE(t)),t},callback(o,n){const i=FE(this,e);t.prepareBorder(n,e,i)}}}function qE(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Gc)},callback(e,o){t.prepareBorder(o,"noBorders")},disabled(){return!FE(this)}}}function QE(t,e,o){return e=JE(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function JE(t){var e=ZE(t,"string");return"symbol"===typeof e?e:String(e)}function ZE(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const tM="customBorders",eM=90;class oM extends tv{constructor(){super(...arguments),QE(this,"savedBorders",[])}static get PLUGIN_KEY(){return tM}static get PLUGIN_PRIORITY(){return eM}isEnabled(){return!!this.hot.getSettings()[tM]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(t=>this.onAfterContextMenuDefaultOptions(t))),this.addHook("init",(()=>this.onAfterInit())),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(t,e){let o=["top","bottom","start","end"],n=null;e&&(this.checkSettingsCohesion([e]),o=Object.keys(e),n=DE(e));const i=fg(t),s=mg(i);k(t,(t=>{s(t).forAll(((t,e)=>{k(o,(o=>{this.prepareBorderFromCustomAdded(t,e,n,$E(o))}))}))})),this.hot.view.render()}getBorders(t){if(!Array.isArray(t))return this.savedBorders;const e=fg(t),o=mg(e),n=[];return k(t,(t=>{o(t).forAll(((t,e)=>{k(this.savedBorders,(o=>{o.row===t&&o.col===e&&n.push(LE(o))}))}))})),n}clearBorders(t){t?this.setBorders(t):(k(this.savedBorders,(t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")})),this.savedBorders.length=0)}insertBorderIntoSettings(t,e){const o=this.checkSavedBorders(t);o||this.savedBorders.push(t);const n=this.hot._createCellRange(this.hot._createCellCoords(t.row,t.col)),i=this.checkCustomSelections(t,n,e);i||this.hot.selection.highlight.addCustomSelection({border:t,visualCellRange:n})}prepareBorderFromCustomAdded(t,e,o,n){const i=this.hot.countRows(),s=this.hot.countCols();if(t>=i||e>=s)return;let r=VE(t,e);o&&(r=BE(r,o),k(this.hot.selection.highlight.customSelections,(t=>{if(r.id===t.settings.id)return Object.assign(t.settings,o),r.id=t.settings.id,r.top=t.settings.top,r.bottom=t.settings.bottom,r.start=t.settings.start,r.end=t.settings.end,!1}))),this.hot.setCellMeta(t,e,"borders",LE(r)),this.insertBorderIntoSettings(r,n)}prepareBorderFromCustomAddedRange(t,e){const o=Math.min(t.to.row,this.hot.countRows()-1),n=Math.min(t.to.col,this.hot.countCols()-1);mi(t.from.row,o,(o=>{mi(t.from.col,n,(n=>{const i=VE(o,n);let s=0;o===t.from.row&&Io(e,"top")&&(s+=1,i.top=e.top),o===t.to.row&&Io(e,"bottom")&&(s+=1,i.bottom=e.bottom),n===t.from.col&&Io(e,"start")&&(s+=1,i.start=e.start),n===t.to.col&&Io(e,"end")&&(s+=1,i.end=e.end),s>0&&(this.hot.setCellMeta(o,n,"borders",LE(i)),this.insertBorderIntoSettings(i))}))}))}removeAllBorders(t,e){const o=OE(t,e);this.spliceBorder(o),this.clearBordersFromSelectionSettings(o),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}setBorder(t,e,o,n){let i=this.hot.getCellMeta(t,e).borders;if(i=i&&void 0!==i.border?DE(i):VE(t,e),n){i[o]=NE();const s=this.countHide(i);if(4===s)this.removeAllBorders(t,e);else{const s=this.checkCustomSelectionsFromContextMenu(i,o,n);s||this.insertBorderIntoSettings(i),this.hot.setCellMeta(t,e,"borders",LE(i))}}else{i[o]=PE();const s=this.checkCustomSelectionsFromContextMenu(i,o,n);s||this.insertBorderIntoSettings(i),this.hot.setCellMeta(t,e,"borders",LE(i))}}prepareBorder(t,e,o){k(t,(t=>{let{start:n,end:i}=t;if(n.row===i.row&&n.col===i.col)"noBorders"===e?this.removeAllBorders(n.row,n.col):this.setBorder(n.row,n.col,e,o);else switch(e){case"noBorders":mi(n.col,i.col,(t=>{mi(n.row,i.row,(e=>{this.removeAllBorders(e,t)}))}));break;case"top":mi(n.col,i.col,(t=>{this.setBorder(n.row,t,e,o)}));break;case"bottom":mi(n.col,i.col,(t=>{this.setBorder(i.row,t,e,o)}));break;case"start":mi(n.row,i.row,(t=>{this.setBorder(t,n.col,e,o)}));break;case"end":mi(n.row,i.row,(t=>{this.setBorder(t,i.col,e,o)}));break;default:break}}))}createCustomBorders(t){k(t,(t=>{const e=DE(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,e):this.prepareBorderFromCustomAdded(t.row,t.col,e)}))}countHide(t){const{top:e,bottom:o,start:n,end:i}=t,s=[e,o,n,i];return x(s,((t,e)=>{let o=t;return e&&e.hide&&(o+=1),o}),0)}clearBordersFromSelectionSettings(t){const e=A(this.hot.selection.highlight.customSelections,(t=>t.settings.id)).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear()}clearNullCellRange(){k(this.hot.selection.highlight.customSelections,((t,e)=>{if(null===t.cellRange)return this.hot.selection.highlight.customSelections[e].destroy(),this.hot.selection.highlight.customSelections.splice(e,1),!1}))}hideBorders(){k(this.savedBorders,(t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange()}))}spliceBorder(t){const e=A(this.savedBorders,(t=>t.id)).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}checkSavedBorders(t){let e=!1;const o=this.countHide(t);return 4===o?(this.spliceBorder(t.id),e=!0):k(this.savedBorders,((o,n)=>{if(t.id===o.id)return this.savedBorders[n]=t,e=!0,!1})),e}checkCustomSelectionsFromContextMenu(t,e,o){let n=!1;return k(this.hot.selection.highlight.customSelections,(i=>{if(t.id===i.settings.id){const t=this.hot.view._wt.selectionManager.getBorderInstances(i);return k(t,(t=>{t.toggleHiddenClass(e,o)})),n=!0,!1}})),n}checkCustomSelections(t,e,o){const n=this.countHide(t);let i=!1;return 4===n?(this.removeAllBorders(t.row,t.col),i=!0):k(this.hot.selection.highlight.customSelections,(n=>{if(t.id===n.settings.id){if(n.visualCellRange=e,n.commit(),o){const e=this.hot.view._wt.selectionManager.getBorderInstances(n);k(e,(e=>{e.changeBorderStyle(o,t)}))}return i=!0,!1}})),i}changeBorderSettings(){const t=this.hot.getSettings()[tM];if(Array.isArray(t)){const e=Co(t);this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)}else void 0!==t&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(t){const e=jE(t),o=zE(t);if(e&&o)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&e)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}onAfterContextMenuDefaultOptions(t){this.hot.getSettings()[tM]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(Wc)},disabled(){const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||this.selection.isSelectedByCorner())},submenu:{items:[GE(this),YE(this),KE(this),XE(this),qE(this)]}})}onAfterInit(){this.changeBorderSettings()}destroy(){super.destroy()}}const nM="dragToScroll",iM=100;class sM extends tv{static get PLUGIN_KEY(){return nM}static get PLUGIN_PRIORITY(){return iM}constructor(t){super(t),this.eventManager=new On(this),this.boundaries=null,this.callback=null,this.listening=!1}isEnabled(){return!!this.hot.getSettings()[nM]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",(t=>this.setupListening(t))),this.addHook("afterOnCellCornerMouseDown",(t=>this.setupListening(t))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(t){this.boundaries=t}setCallback(t){this.callback=t}check(t,e){let o=0,n=0;e<this.boundaries.top?n=e-this.boundaries.top:e>this.boundaries.bottom&&(n=e-this.boundaries.bottom),t<this.boundaries.left?o=t-this.boundaries.left:t>this.boundaries.right&&(o=t-this.boundaries.right),this.callback(o,n)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:t}=this.hot;let e=t;while(e)this.eventManager.addEventListener(e.document,"contextmenu",(()=>this.unlisten())),this.eventManager.addEventListener(e.document,"mouseup",(()=>this.unlisten())),this.eventManager.addEventListener(e.document,"mousemove",(t=>this.onMouseMove(t))),e=ee(e)}unregisterEvents(){this.eventManager.clear()}setupListening(t){if(nn(t))return;const e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback(((t,o)=>{t<0?e.scrollLeft-=50:t>0&&(e.scrollLeft+=50),o<0?e.scrollTop-=20:o>0&&(e.scrollTop+=20)})),this.listen())}onMouseMove(t){this.isListening()&&this.check(t.clientX,t.clientY)}destroy(){super.destroy()}}function rM(t,e){lM(t,e),e.add(t)}function lM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aM(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}pn.getSingleton().register("afterDropdownMenuDefaultOptions"),pn.getSingleton().register("beforeDropdownMenuShow"),pn.getSingleton().register("afterDropdownMenuShow"),pn.getSingleton().register("afterDropdownMenuHide"),pn.getSingleton().register("afterDropdownMenuExecute");const hM="dropdownMenu",cM=230,dM="changeType",uM=hM;var gM=new WeakSet;class fM extends tv{static get PLUGIN_KEY(){return hM}static get PLUGIN_PRIORITY(){return cM}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[sb,lb,fS,gb,fS,nb,fS,hb,fS,eb]}constructor(t){super(t),rM(this,gM),this.eventManager=new On(this),this.commandExecutor=new ZS(this.hot),this.itemsFactory=null,this.menu=null,this.hot.addHook("afterGetColHeader",((t,e)=>this.onAfterGetColHeader(t,e)))}isEnabled(){return this.hot.getSettings()[hM]}enablePlugin(){var t=this;if(this.enabled)return;this.itemsFactory=new xb(this.hot,fM.DEFAULT_ITEMS);const e=this.hot.getSettings()[hM],o={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"===typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady((()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",o),this.itemsFactory.setPredefinedItems(o.items);const n=this.itemsFactory.getItems(e);this.menu&&this.menu.destroy(),this.menu=new SR(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",n),this.menu.setMenuItems(n),this.menu.addLocalHook("beforeOpen",(()=>this.onMenuBeforeOpen())),this.menu.addLocalHook("afterOpen",(()=>this.onMenuAfterOpen())),this.menu.addLocalHook("afterSubmenuOpen",(t=>this.onSubMenuAfterOpen(t))),this.menu.addLocalHook("afterClose",(()=>this.onMenuAfterClose())),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.executeCommand.call(t,...o)})),k(n,(t=>this.commandExecutor.registerCommand(t.key,t)))}))}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("grid"),e=()=>{const{highlight:t}=this.hot.getSelectedRangeLast();if((t.isHeader()&&-1===t.row||t.isCell())&&t.col>=0){this.hot.selectColumns(t.col,t.col,-1);const{from:e}=this.hot.getSelectedRangeLast(),o=MS(this.menu.container,this.hot.rootDocument),n=this.hot.getCell(-1,e.col,!0),i=n.getBoundingClientRect();this.open({left:i.left+o.left,top:i.top+n.offsetHeight+o.top},{left:i.width})}};t.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:e,runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader())&&!this.menu.isOpened()},captureCtrl:!0,group:uM},{keys:[["Shift","Alt","ArrowDown"]],callback:e,runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&!this.menu.isOpened()},group:uM}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uM)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",(t=>this.onTableClick(t)))}open(t){var e;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.menu.open(),Eo(o,((t,e)=>{this.menu.setOffset(e,t)})),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close()}executeCommand(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];this.commandExecutor.execute(t,...o)}setListening(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}onTableClick(t){if(t.stopPropagation(),ce(t.target,dM)){const e=MS(this.menu.container,this.hot.rootDocument),o=t.target.getBoundingClientRect();this.open({left:o.left+e.left,top:o.top+t.target.offsetHeight+3+e.top},{left:o.width})}}onAfterGetColHeader(t,e){const o=e.parentNode;if(!o)return;const n=o.parentNode.childNodes,i=Array.prototype.indexOf.call(n,o);if(t<0||i!==n.length-1)return;const s=e.querySelector(`.${dM}`);if(this.enabled&&s)return;if(!this.enabled)return void(s&&s.parentNode.removeChild(s));const r=this.hot.rootDocument.createElement("button");r.className=dM,r.type="button",r.tabIndex=-1,this.hot.getSettings().ariaTags&&(ge(r,[kt()]),ge(e,[Nt("menu")])),r.onclick=function(){return!1},e.firstChild.insertBefore(r,e.firstChild.firstChild)}onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this),aM(this,gM,mM).call(this,this.menu)}onSubMenuAfterOpen(t){aM(this,gM,mM).call(this,t)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function mM(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}fM.SEPARATOR={name:fS};class pM{constructor(t){this.hot=t,this.options={}}setOptions(t){this.options=t}getData(){const{startRow:t,startCol:e,endRow:o,endCol:n}=this._getDataRange(),i=this.options,s=[];return mi(t,o,(t=>{const o=[];!i.exportHiddenRows&&this._isHiddenRow(t)||(mi(e,n,(e=>{!i.exportHiddenColumns&&this._isHiddenColumn(e)||o.push(this.hot.getDataAtCell(t,e))})),s.push(o))})),s}getRowHeaders(){const t=[];if(this.options.rowHeaders){const{startRow:e,endRow:o}=this._getDataRange(),n=this.hot.getRowHeader();mi(e,o,(e=>{!this.options.exportHiddenRows&&this._isHiddenRow(e)||t.push(n[e])}))}return t}getColumnHeaders(){const t=[];if(this.options.columnHeaders){const{startCol:e,endCol:o}=this._getDataRange(),n=this.hot.getColHeader();mi(e,o,(e=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(e)||t.push(n[e])}))}return t}_getDataRange(){const t=this.hot.countCols()-1,e=this.hot.countRows()-1;let[o=0,n=0,i=e,s=t]=this.options.range;return o=Math.max(o,0),n=Math.max(n,0),i=Math.min(i,e),s=Math.min(s,t),{startRow:o,startCol:n,endRow:i,endCol:s}}_isHiddenRow(t){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(t))}_isHiddenColumn(t){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(t))}}var wM=pM;class CM{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(t,e){this.dataProvider=t,this.options=this._mergeOptions(e),this.dataProvider.setOptions(this.options)}_mergeOptions(t){let e=vo(this.constructor.DEFAULT_OPTIONS);const o=new Date;return e=po(vo(CM.DEFAULT_OPTIONS),e),e=po(e,t),e.filename=dt(e.filename,{YYYY:o.getFullYear(),MM:`${o.getMonth()+1}`.padStart(2,"0"),DD:`${o.getDate()}`.padStart(2,"0")}),e}}var vM=CM;const yM=String.fromCharCode(13),SM=String.fromCharCode(34),bM=String.fromCharCode(10);class RM extends vM{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const t=this.options,e=this.dataProvider.getData();let o=this.dataProvider.getColumnHeaders();const n=o.length>0,i=this.dataProvider.getRowHeaders(),s=i.length>0;let r=t.bom?String.fromCharCode(65279):"";return n&&(o=A(o,(t=>this._escapeCell(t,!0))),s&&(r+=t.columnDelimiter),r+=o.join(t.columnDelimiter),r+=t.rowDelimiter),k(e,((e,o)=>{o>0&&(r+=t.rowDelimiter),s&&(r+=this._escapeCell(i[o])+t.columnDelimiter),r+=e.map((t=>this._escapeCell(t))).join(t.columnDelimiter)})),r}_escapeCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=z(t);return""!==o&&(e||o.indexOf(yM)>=0||o.indexOf(SM)>=0||o.indexOf(bM)>=0||o.indexOf(this.options.columnDelimiter)>=0)&&(o=o.replace(new RegExp('"',"g"),'""'),o=`"${o}"`),o}}var EM=RM;const MM="csv",TM={[MM]:EM};function HM(t,e,o){return"function"===typeof TM[t]?new TM[t](e,o):null}const xM="exportFile",IM=240;class AM extends tv{static get PLUGIN_KEY(){return xM}static get PLUGIN_PRIORITY(){return IM}isEnabled(){return!0}exportAsString(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}exportAsBlob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}downloadFile(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument:o,rootWindow:n}=this.hot,i=this._createTypeFormatter(t,e),s=this._createBlob(i),r=n.URL||n.webkitURL,l=o.createElement("a"),a=`${i.options.filename}.${i.options.fileExtension}`;if(void 0!==l.download){const t=r.createObjectURL(s);l.style.display="none",l.setAttribute("href",t),l.setAttribute("download",a),o.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),o.body.removeChild(l),setTimeout((()=>{r.revokeObjectURL(t)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,a)}_createTypeFormatter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!TM[t])throw new Error(`Export format type "${t}" is not supported.`);return HM(t,new wM(this.hot),e)}_createBlob(t){let e=null;return"undefined"!==typeof Blob&&(e=new Blob([t.export()],{type:`${t.options.mimeType};charset=${t.options.encoding}`})),e}}function kM(t,e,o){return e=OM(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function OM(t){var e=PM(t,"string");return"symbol"===typeof e?e:String(e)}function PM(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class NM{constructor(t,e){let{id:o,stateless:n=!0}=e;kM(this,"hot",void 0),kM(this,"id",void 0),kM(this,"elements",[]),kM(this,"hidden",!1),kM(this,"stateId",""),kM(this,"state",void 0),this.hot=t,this.id=o,this.stateId=`Filters.component.${this.id}`,this.state=n?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Sh)}getElements(){return this.elements}reset(){k(this.elements,(t=>t.reset()))}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(t){this.state&&this.setState(this.state.getValueAtIndex(t))}setState(){throw new Error("The state setting logic is not implemented")}saveState(t){this.state&&this.state.setValueAtIndex(t,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),k(this.elements,(t=>t.destroy())),this.state=null,this.elements=null,this.hot=null}}yo(NM,lh);const _M={};function DM(t,e){if(!_M[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:o,descriptor:n}=_M[t];let i=e;return n.inputValuesDecorator&&(i=n.inputValuesDecorator(i)),function(t){return o.apply(t.meta.instance,[].concat([t],[i]))}}function LM(t){if(!_M[t])throw Error(`Filter condition "${t}" does not exist.`);return _M[t].descriptor}function VM(t,e,o){o.key=t,_M[t]={condition:e,descriptor:o}}const BM="none";function FM(){return!0}VM(BM,FM,{name:ed,inputsCount:0,showOperators:!1});const WM="empty";function jM(t){return G(t.value)}VM(WM,jM,{name:od,inputsCount:0,showOperators:!0});const zM="not_empty";function UM(t,e){return!DM(WM,e)(t)}VM(zM,UM,{name:nd,inputsCount:0,showOperators:!0});const $M="eq";function GM(t,e){let[o]=e;return z(t.value).toLocaleLowerCase(t.meta.locale)===z(o)}VM($M,GM,{name:id,inputsCount:1,showOperators:!0});const YM="neq";function KM(t,e){return!DM($M,e)(t)}VM(YM,KM,{name:sd,inputsCount:1,showOperators:!0});const XM="gt";function qM(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>n}VM(XM,qM,{name:dd,inputsCount:1,showOperators:!0});const QM="gte";function JM(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>=n}VM(QM,JM,{name:ud,inputsCount:1,showOperators:!0});const ZM="lt";function tT(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<n}VM(ZM,tT,{name:gd,inputsCount:1,showOperators:!0});const eT="lte";function oT(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<=n}VM(eT,oT,{name:fd,inputsCount:1,showOperators:!0});const nT="date_after";function iT(t,e){let[o]=e;const n=E(t.value,t.meta.dateFormat),i=E(o,t.meta.dateFormat);return!(!n.isValid()||!i.isValid())&&n.diff(i)>=0}VM(nT,iT,{name:wd,inputsCount:1,showOperators:!0});const sT="date_before";function rT(t,e){let[o]=e;const n=E(t.value,t.meta.dateFormat),i=E(o,t.meta.dateFormat);return!(!n.isValid()||!i.isValid())&&n.diff(i)<=0}VM(sT,rT,{name:Cd,inputsCount:1,showOperators:!0});const lT="between";function aT(t,e){let[o,n]=e,i=o,s=n;if("numeric"===t.meta.type){const t=parseFloat(i,10),e=parseFloat(s,10);i=Math.min(t,e),s=Math.max(t,e)}else if("date"===t.meta.type){const e=DM(sT,[s]),o=DM(nT,[i]);return e(t)&&o(t)}return t.value>=i&&t.value<=s}VM(lT,aT,{name:md,inputsCount:2,showOperators:!0});const hT="not_between";function cT(t,e){return!DM(lT,e)(t)}VM(hT,cT,{name:pd,inputsCount:2,showOperators:!0});const dT="begins_with";function uT(t,e){let[o]=e;return z(t.value).toLocaleLowerCase(t.meta.locale).startsWith(z(o))}VM(dT,uT,{name:rd,inputsCount:1,showOperators:!0});const gT="ends_with";function fT(t,e){let[o]=e;return z(t.value).toLocaleLowerCase(t.meta.locale).endsWith(z(o))}VM(gT,fT,{name:ld,inputsCount:1,showOperators:!0});const mT="contains";function pT(t,e){let[o]=e;return z(t.value).toLocaleLowerCase(t.meta.locale).indexOf(z(o))>=0}VM(mT,pT,{name:ad,inputsCount:1,showOperators:!0});const wT="not_contains";function CT(t,e){return!DM(mT,e)(t)}VM(wT,CT,{name:hd,inputsCount:1,showOperators:!0});const vT="date_tomorrow";function yT(t){const e=E(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(E().subtract(-1,"days").startOf("day"),"d")}VM(vT,yT,{name:yd,inputsCount:0});const ST="date_today";function bT(t){const e=E(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(E().startOf("day"),"d")}VM(ST,bT,{name:vd,inputsCount:0});const RT="date_yesterday";function ET(t){const e=E(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(E().subtract(1,"days").startOf("day"),"d")}VM(RT,ET,{name:Sd,inputsCount:0});const MT="numeric",TT="text",HT="date",xT={[MT]:[BM,fS,WM,zM,fS,$M,YM,fS,XM,QM,ZM,eT,lT,hT],[TT]:[BM,fS,WM,zM,fS,$M,YM,fS,dT,gT,fS,mT,wT],[HT]:[BM,fS,WM,zM,fS,$M,YM,fS,sT,nT,lT,fS,vT,ST,RT]};function IT(t){const e=[];let o=t;return xT[o]||(o=TT),k(xT[o],(t=>{let o;o=t===fS?{name:fS}:vo(LM(t)),e.push(o)})),e}function AT(t,e,o){return e=kT(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function kT(t){var e=OT(t,"string");return"symbol"===typeof e?e:String(e)}function OT(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const PT="built",NT="building",_T=["click","input","keydown","keypress","keyup","focus","blur","change"];class DT{static get DEFAULTS(){return vo({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(t,e){AT(this,"hot",void 0),AT(this,"eventManager",new On(this)),AT(this,"options",void 0),AT(this,"_element",void 0),AT(this,"buildState",void 0),this.hot=t,this.options=po(DT.DEFAULTS,e),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(t){this.options.value=t,this.update()}getValue(){return this.options.value}get element(){return this.buildState===NT?this._element:this.buildState===PT?(this.update(),this._element):(this.buildState=NT,this.build(),this.buildState=PT,this._element)}isBuilt(){return this.buildState===PT}translateIfPossible(t){return"string"===typeof t&&t.startsWith(Zc)?this.hot.getTranslatedPhrase(t):t}build(){const t=(t,e)=>{this.eventManager.addEventListener(t,e,(t=>this.runLocalHooks(e,t,this)))};if(this.buildState||(this.buildState=NT),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&de(this._element,this.options.className),this.options.children.length)k(this.options.children,(t=>this._element.appendChild(t.element)));else if(this.options.wrapIt){const e=this.hot.rootDocument.createElement(this.options.tagName);e.setAttribute("data-hot-input",!0),Eo(this.options,((t,o)=>{void 0!==e[o]&&"className"!==o&&"tagName"!==o&&"children"!==o&&(e[o]=this.translateIfPossible(t))})),this._element.appendChild(e),k(_T,(o=>t(e,o)))}else k(_T,(e=>t(this._element,e)))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}function LT(t,e){BT(t,e),e.add(t)}function VT(t,e,o){BT(t,e),e.set(t,o)}function BT(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FT(t,e){var o=zT(t,e,"get");return WT(t,o)}function WT(t,e){return e.get?e.get.call(t):e.value}function jT(t,e,o){var n=zT(t,e,"set");return UT(t,n,o),o}function zT(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function UT(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function $T(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}yo(DT,lh);var GT=new WeakMap,YT=new WeakSet;class KT extends DT{static get DEFAULTS(){return vo({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(t,e){super(t,po(KT.DEFAULTS,e)),LT(this,YT),VT(this,GT,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",(t=>$T(this,YT,XT).call(this,t)))}build(){super.build();const t=this.hot.rootDocument.createElement("div");jT(this,GT,this._element.firstChild),de(this._element,"htUIInput"),de(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(FT(this,GT).type=this.options.type,FT(this,GT).placeholder=this.translateIfPossible(this.options.placeholder),FT(this,GT).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&FT(this,GT).focus()}}function XT(t){this.options.value=t.target.value}function qT(t,e){JT(t,e),e.add(t)}function QT(t,e,o){JT(t,e),e.set(t,o)}function JT(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZT(t,e,o){var n=nH(t,e,"set");return tH(t,n,o),o}function tH(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function eH(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function oH(t,e){var o=nH(t,e,"get");return iH(t,o)}function nH(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function iH(t,e){return e.get?e.get.call(t):e.value}var sH=new WeakMap,rH=new WeakMap,lH=new WeakMap,aH=new WeakMap,hH=new WeakMap,cH=new WeakSet,dH=new WeakSet,uH=new WeakSet;class gH extends DT{static get DEFAULTS(){return vo({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(t,e){super(t,po(gH.DEFAULTS,e)),qT(this,uH),qT(this,dH),qT(this,cH),QT(this,sH,{writable:!0,value:null}),QT(this,rH,{writable:!0,value:[]}),QT(this,lH,{writable:!0,value:void 0}),QT(this,aH,{writable:!0,value:void 0}),QT(this,hH,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return oH(this,sH)}registerHooks(){this.addLocalHook("click",(()=>eH(this,uH,pH).call(this)))}setItems(t){ZT(this,rH,this.translateNames(t)),oH(this,sH)&&oH(this,sH).setMenuItems(oH(this,rH))}translateNames(t){return k(t,(t=>{t.name=this.translateIfPossible(t.name)})),t}build(){super.build(),ZT(this,sH,new SR(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),oH(this,sH).setMenuItems(oH(this,rH));const t=new DT(this.hot,{className:"htUISelectCaption"}),e=new DT(this.hot,{className:"htUISelectDropdown"});ZT(this,lH,t),ZT(this,aH,t.element),ZT(this,hH,e),k([t,e],(t=>this._element.appendChild(t.element))),oH(this,sH).addLocalHook("select",(t=>eH(this,cH,fH).call(this,t))),oH(this,sH).addLocalHook("afterClose",(()=>eH(this,dH,mH).call(this))),this.update()}update(){if(!this.isBuilt())return;let t;t=this.options.value?this.options.value.name:oH(this,sH).hot.getTranslatedPhrase(ed),oH(this,aH).textContent=t,super.update()}openOptions(){const t=this.element.getBoundingClientRect();oH(this,sH)&&(oH(this,sH).open(),oH(this,sH).setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}),oH(this,sH).getNavigator().toFirstItem(),oH(this,sH).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){oH(this,sH)&&oH(this,sH).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){oH(this,sH)&&(oH(this,sH).destroy(),ZT(this,sH,null)),oH(this,lH)&&oH(this,lH).destroy(),oH(this,hH)&&oH(this,hH).destroy(),super.destroy()}}function fH(t){t.name!==fS&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function mH(){this.runLocalHooks("afterClose")}function pH(){this.openOptions()}function wH(t,e){CH(t,e),e.add(t)}function CH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vH(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}var yH=new WeakSet,SH=new WeakSet;class bH extends NM{constructor(t,e){super(t,{id:e.id,stateless:!1}),wH(this,SH),wH(this,yH),this.name=e.name,this.addSeparator=e.addSeparator,this.elements.push(new gH(this.hot,{menuContainer:e.menuContainer})),this.elements.push(new KT(this.hot,{placeholder:Od})),this.elements.push(new KT(this.hot,{placeholder:Pd})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",(t=>vH(this,yH,RH).call(this,t))).addLocalHook("afterClose",(()=>this.runLocalHooks("afterClose"))).addLocalHook("tabKeydown",(t=>this.runLocalHooks("selectTabKeydown",t))),k(this.getInputElements(),(t=>{t.addLocalHook("keydown",(t=>vH(this,SH,EH).call(this,t)))}))}setState(t){if(this.reset(),!t)return;const e=vo(t.command);e.name.startsWith(td)&&(e.name=this.hot.getTranslatedPhrase(e.name)),this.getSelectElement().setValue(e),k(t.args,((t,o)=>{if(o>e.inputsCount-1)return!1;const n=this.getInputElement(o);n.setValue(t),n[e.inputsCount>o?"show":"hide"](),o||this.hot._registerTimeout((()=>n.focus()),10)}))}getState(){const t=this.getSelectElement().getValue()||LM(BM),e=[];return k(this.getInputElements(),((o,n)=>{t.inputsCount>n&&e.push(o.getValue())})),{command:t,args:e}}updateState(t,e){const o=LM(t?t.name:BM);this.state.setValueAtIndex(e,{command:o,args:t?t.args:[]}),t||k(this.getInputElements(),(t=>t.setValue(null)))}getSelectElement(){return this.elements.filter((t=>t instanceof gH))[0]}getInputElement(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}getInputElements(){return this.elements.filter((t=>t instanceof KT))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,o,n,i,s)=>{de(e.parentNode,"htFiltersMenuCondition"),this.addSeparator&&de(e.parentNode,"border");const r=this.hot.rootDocument.createElement("div");return de(r,"htFiltersMenuLabel"),r.textContent=s,e.appendChild(r),k(this.elements,(t=>e.appendChild(t.element))),e}}}reset(){const t=this.hot.getPlugin("filters").getSelectedColumn();let e=[LM(BM)];if(null!==t){const{visualIndex:o}=t;e=IT(this.hot.getDataType(0,o,this.hot.countRows(),o))}k(this.getInputElements(),(t=>t.hide())),this.getSelectElement().setItems(e),super.reset(),this.getSelectElement().setValue(e[0])}}function RH(t){k(this.getInputElements(),((e,o)=>{e[t.inputsCount>o?"show":"hide"](),0===o&&this.hot._registerTimeout((()=>e.focus()),10)})),this.runLocalHooks("change",t)}function EH(t){tn(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),en(t))}const MH={};function TH(t){if(!MH[t])throw Error(`Operation with id "${t}" does not exist.`);const e=MH[t].func;return function(t,o){return e(t,o)}}function HH(t){return MH[t].name}function xH(t,e,o){MH[t]={name:e,func:o}}const IH="conjunction",AH=Ed;function kH(t,e){return t.every((t=>t.func(e)))}xH(IH,AH,kH);const OH="disjunction",PH=Md;function NH(t,e){return t.some((t=>t.func(e)))}xH(OH,PH,NH);const _H="disjunctionWithExtraCondition",DH=Md;function LH(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some((t=>t.func(e)))&&t[t.length-1].func(e)}function VH(t,e,o){BH(t,e),e.set(t,o)}function BH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FH(t,e){var o=zH(t,e,"get");return WH(t,o)}function WH(t,e){return e.get?e.get.call(t):e.value}function jH(t,e,o){var n=zH(t,e,"set");return UH(t,n,o),o}function zH(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function UH(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}xH(_H,DH,LH);var $H=new WeakMap,GH=new WeakMap;class YH extends DT{static get DEFAULTS(){return vo({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(t,e){super(t,po(YH.DEFAULTS,e)),VH(this,$H,{writable:!0,value:void 0}),VH(this,GH,{writable:!0,value:void 0})}build(){super.build();const t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),jH(this,GH,t),jH(this,$H,this._element.firstChild),FH(this,$H).checked=this.options.checked,this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(FH(this,GH).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return FH(this,$H).checked}setChecked(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isBuilt()&&(FH(this,$H).checked=t)}focus(){this.isBuilt()&&FH(this,$H).focus()}}function KH(t,e){XH(t,e),e.add(t)}function XH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qH(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const QH=0;var JH=new WeakSet;class ZH extends NM{constructor(t,e){super(t,{id:e.id,stateless:!1}),KH(this,JH),this.name=e.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(de(e.parentNode,"htFiltersMenuOperators"),k(this.elements,(t=>e.appendChild(t.element))),e)}}buildOperatorsElement(){const t=[IH,OH];k(t,(e=>{const o=new YH(this.hot,{name:"operator",label:{htmlFor:e,textContent:HH(e)},value:e,checked:e===t[QH],id:e});o.addLocalHook("change",(t=>qH(this,JH,tx).call(this,t))),this.elements.push(o)}))}setChecked(t){if(this.elements.length<t)throw Error(j`Radio button with index ${t} doesn't exist.`);k(this.elements,((e,o)=>{e.setChecked(o===t)}))}getActiveOperationId(){const t=this.elements.find((t=>t instanceof YH&&t.isChecked()));return t?t.getValue():IH}getState(){return this.getActiveOperationId()}setState(t){this.reset(),t&&this.getActiveOperationId()!==t&&k(this.elements,(e=>{e.setChecked(e.getValue()===t)}))}updateState(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:IH,e=arguments.length>1?arguments[1]:void 0,o=t;o===_H&&(o=OH),this.state.setValueAtIndex(e,o)}reset(){this.setChecked(QH)}}function tx(t){this.setState(t.target.value)}ss();function ex(t,e){let o=t;return""===o&&(o=`(${e})`),o}const ox=new Set([1]).has(1),nx=ox&&"function"===typeof Array.from;function ix(t){let e=t;return ox&&(e=new Set(e)),function(t){let o;return o=ox?e.has(t):!!~e.indexOf(t),o}}function sx(t){return null===t||void 0===t?"":t}function rx(t){let e=t;return e=nx?Array.from(new Set(e)):L(e),e=e.sort(((t,e)=>"number"===typeof t&&"number"===typeof e?t-e:t===e?0:t>e?1:-1)),e}function lx(t,e,o,n){const i=[],s=t===e;let r;return s||(r=ix(e)),k(t,(t=>{let e=!1;(s||r(t))&&(e=!0);const l={checked:e,value:t,visualValue:ex(t,o)};n&&n(l),i.push(l)})),i}function ax(t,e,o){hx(t,e),e.set(t,o)}function hx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cx(t,e){var o=gx(t,e,"get");return dx(t,o)}function dx(t,e){return e.get?e.get.call(t):e.value}function ux(t,e,o){var n=gx(t,e,"set");return fx(t,n,o),o}function gx(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function fx(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var mx=new WeakMap;class px extends DT{static get DEFAULTS(){return vo({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(t,e){super(t,po(px.DEFAULTS,e)),ax(this,mx,{writable:!0,value:void 0})}build(){super.build(),ux(this,mx,this._element.firstChild)}update(){this.isBuilt()&&(cx(this,mx).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&cx(this,mx).focus()}activate(){cx(this,mx).click()}}function wx(t,e){vx(t,e),e.add(t)}function Cx(t,e,o){vx(t,e),e.set(t,o)}function vx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yx(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function Sx(t,e){var o=Ex(t,e,"get");return bx(t,o)}function bx(t,e){return e.get?e.get.call(t):e.value}function Rx(t,e,o){var n=Ex(t,e,"set");return Mx(t,n,o),o}function Ex(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Mx(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}const Tx="multipleSelect.itemBox";var Hx=new WeakMap,xx=new WeakMap,Ix=new WeakMap,Ax=new WeakMap,kx=new WeakMap,Ox=new WeakMap,Px=new WeakSet,Nx=new WeakSet,_x=new WeakSet,Dx=new WeakSet;class Lx extends DT{static get DEFAULTS(){return vo({className:"htUIMultipleSelect",value:[]})}constructor(t,e){super(t,po(Lx.DEFAULTS,e)),wx(this,Dx),wx(this,_x),wx(this,Nx),wx(this,Px),Cx(this,Hx,{writable:!0,value:[]}),Cx(this,xx,{writable:!0,value:void 0}),Cx(this,Ix,{writable:!0,value:void 0}),Cx(this,Ax,{writable:!0,value:void 0}),Cx(this,kx,{writable:!0,value:void 0}),Cx(this,Ox,{writable:!0,value:void 0}),Rx(this,Ax,new KT(this.hot,{placeholder:kd,className:"htUIMultipleSelectSearch"})),Rx(this,kx,new px(this.hot,{textContent:Hd,className:"htUISelectAll"})),Rx(this,Ox,new px(this.hot,{textContent:xd,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Sx(this,xx)}registerHooks(){Sx(this,Ax).addLocalHook("keydown",(t=>yx(this,Nx,Bx).call(this,t))),Sx(this,Ax).addLocalHook("input",(t=>yx(this,Px,Vx).call(this,t))),Sx(this,kx).addLocalHook("click",(t=>yx(this,_x,Fx).call(this,t))),Sx(this,Ox).addLocalHook("click",(t=>yx(this,Dx,Wx).call(this,t)))}setItems(t){Rx(this,Hx,t),Sx(this,xx)&&Sx(this,xx).loadData(Sx(this,Hx))}setLocale(t){Rx(this,Ix,t)}getLocale(){return Sx(this,Ix)}getItems(){return[...Sx(this,Hx)]}getValue(){return zx(Sx(this,Hx))}getSearchInputElement(){return Sx(this,Ax)}getSelectAllElement(){return Sx(this,kx)}getClearAllElement(){return Sx(this,Ox)}isSelectedAllValues(){return Sx(this,Hx).length===this.getValue().length}build(){super.build();const{rootDocument:t}=this.hot,e=t.createElement("div"),o=new DT(this.hot,{className:"htUISelectionControls",children:[Sx(this,kx),Sx(this,Ox)]});this._element.appendChild(Sx(this,Ax).element),this._element.appendChild(o.element),this._element.appendChild(e);const n=e=>{if(!this._element)return;Sx(this,xx)&&Sx(this,xx).destroy(),de(e,"htUIMultipleSelectHot"),Rx(this,xx,new this.hot.constructor(e,{data:Sx(this,Hx),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(t,e,o,n,i,s)=>{t.title=s.instance.getDataAtRowProp(e,s.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Sx(this,xx).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>Sx(this,xx).container.scrollWidth-Ue(t),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Sx(this,xx).init();const o=Sx(this,xx).getShortcutManager(),n=o.getContext("grid");n.removeShortcutsByKeys(["Tab"]),n.removeShortcutsByKeys(["Shift","Tab"]),n.addShortcut({keys:[["Escape"]],callback:t=>{this.runLocalHooks("keydown",t,this)},group:Tx}),n.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:t=>{Sx(this,xx).deselectCell(),this.runLocalHooks("keydown",t,this),this.runLocalHooks("listTabKeydown",t,this)},group:Tx})};n(e),this.hot._registerTimeout((()=>n(e)),100)}focus(){this.isBuilt()&&Sx(this,xx).listen()}reset(){Sx(this,Ax).reset(),Sx(this,kx).reset(),Sx(this,Ox).reset()}update(){this.isBuilt()&&(Sx(this,xx).loadData(jx(Sx(this,Hx),this.options.value)),super.update())}destroy(){Sx(this,xx)&&Sx(this,xx).destroy(),Sx(this,Ax).destroy(),Sx(this,Ox).destroy(),Sx(this,kx).destroy(),Rx(this,Ax,null),Rx(this,Ox,null),Rx(this,kx,null),Rx(this,xx,null),Rx(this,Hx,null),super.destroy()}}function Vx(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let o;o=""===e?[...Sx(this,Hx)]:I(Sx(this,Hx),(t=>`${t.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0)),Sx(this,xx).loadData(o)}function Bx(t){this.runLocalHooks("keydown",t,this);const e=ho(tn,t.keyCode);e("ARROW_DOWN")&&(t.preventDefault(),en(t),Sx(this,xx).listen(),Sx(this,xx).selectCell(0,0))}function Fx(t){const e=[];t.preventDefault(),k(Sx(this,xx).getSourceData(),((t,o)=>{t.checked=!0,e.push(Za(t,o)[0])})),Sx(this,xx).setSourceDataAtCell(e)}function Wx(t){const e=[];t.preventDefault(),k(Sx(this,xx).getSourceData(),((t,o)=>{t.checked=!1,e.push(Za(t,o)[0])})),Sx(this,xx).setSourceDataAtCell(e)}function jx(t,e){const o=ix(e);return A(t,(t=>(t.checked=o(t.value),t)))}function zx(t){const e=[];return k(t,(t=>{t.checked&&e.push(t.value)})),e}const Ux="by_value";function $x(t,e){let[o]=e;return o(t.value)}function Gx(t,e){Yx(t,e),e.add(t)}function Yx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kx(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}VM(Ux,$x,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[ix(e)]},showOperators:!1});var Xx,qx=new WeakSet;class Qx extends NM{constructor(t,e){super(t,{id:e.id,stateless:!1}),Gx(this,qx),this.name=e.name,this.elements.push(new Lx(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",(t=>Kx(this,qx,Jx).call(this,t))).addLocalHook("listTabKeydown",(t=>this.runLocalHooks("listTabKeydown",t)))}getElements(){const t=this.getMultipleSelectElement();return[t.getSearchInputElement(),t.getSelectAllElement(),t.getClearAllElement(),this.getMultipleSelectElement()]}setState(t){if(this.reset(),t&&t.command.key===Ux){const e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0]),e.setLocale(t.locale)}}getState(){const t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?BM:Ux},args:[t.getValue()],itemsSnapshot:e}}updateState(t){const e=(e,o,n,i,s)=>{const[r]=I(o,(t=>t.name===Ux)),l={},a=this.hot.getTranslatedPhrase(Td);if(r){const o=rx(A(i(e,s),(t=>t.value)));n&&(r.args[0]=n);const h=[],c=lx(o,r.args[0],a,(t=>{t.checked&&h.push(t.value)})),d=t.editedConditionStack.column;l.locale=this.hot.getCellMeta(0,d).locale,l.args=[h],l.command=LM(Ux),l.itemsSnapshot=c}else l.args=[],l.command=LM(BM);this.state.setValueAtIndex(e,l)};e(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&e(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter((t=>t instanceof Lx))[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,o,n,i,s)=>{de(e.parentNode,"htFiltersMenuValue");const r=this.hot.rootDocument.createElement("div");return de(r,"htFiltersMenuLabel"),r.textContent=s,e.appendChild(r),k(this.elements,(t=>e.appendChild(t.element))),e}}}reset(){const t=this.hot.getTranslatedPhrase(Td),e=rx(this._getColumnVisibleValues()),o=lx(e,e,t);this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(e);const n=this.hot.getPlugin("filters").getSelectedColumn();null!==n&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,n.visualIndex).locale)}_getColumnVisibleValues(){const t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:A(this.hot.getDataAtCol(t.visualIndex),(t=>sx(t)))}}function Jx(t){tn(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),en(t))}function Zx(t,e){tI(t,e),e.add(t)}function tI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eI(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}var oI=new WeakSet;class nI extends NM{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(t,e){super(t,{id:e.id,stateless:!0}),Zx(this,oI),this.name=e.name,this.elements.push(new KT(this.hot,{type:"button",value:Id,className:"htUIButton htUIButtonOK",identifier:nI.BUTTON_OK})),this.elements.push(new KT(this.hot,{type:"button",value:Ad,className:"htUIButton htUIButtonCancel",identifier:nI.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){k(this.elements,(t=>{t.addLocalHook("click",((t,e)=>eI(this,oI,iI).call(this,t,e)))}))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(de(e.parentNode,"htFiltersMenuActionBar"),k(this.elements,(t=>e.appendChild(t.element))),e)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function iI(t,e){e.options.identifier===Xx.BUTTON_OK?this.accept():this.cancel()}Xx=nI;const sI="ConditionCollection.filteringStates";class rI{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.hot=t,this.isMapRegistrable=e,this.filteringStates=new Sh,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(sI,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(t,e){var o;const n=this.filteringStates.getValueAtIndex(e),i=null!==(o=null===n||void 0===n?void 0:n.conditions)&&void 0!==o?o:[],s=null===n||void 0===n?void 0:n.operation;return this.isMatchInConditions(i,t,s)}isMatchInConditions(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:IH;return!t.length||TH(o)(t,e)}addCondition(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:IH,n=arguments.length>3?arguments[3]:void 0;const i=this.hot.getCellMeta(0,t).locale,s=A(e.args,(t=>"string"===typeof t?t.toLocaleLowerCase(i):t)),r=e.name||e.command.key;this.runLocalHooks("beforeAdd",t);const l=this.getOperation(t);if(l){if(l!==o)throw Error(j`The column of index ${t} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if($(MH[o]))throw new Error(j`Unexpected operation named \`${o}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const a=this.getConditions(t);0===a.length?this.filteringStates.setValueAtIndex(t,{operation:o,conditions:[{name:r,args:s,func:DM(r,s)}]},n):a.push({name:r,args:s,func:DM(r,s)}),this.runLocalHooks("afterAdd",t)}getConditions(t){var e,o;return null!==(e=null===(o=this.filteringStates.getValueAtIndex(t))||void 0===o?void 0:o.conditions)&&void 0!==e?e:[]}getOperation(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}getFilteredColumns(){return this.filteringStates.getEntries().map((t=>{let[e]=t;return e}))}getColumnStackPosition(t){return this.getFilteredColumns().indexOf(t)}exportAllConditions(){return x(this.filteringStates.getEntries(),((t,e)=>{let[o,{operation:n,conditions:i}]=e;return t.push({column:o,operation:n,conditions:A(i,(t=>{let{name:e,args:o}=t;return{name:e,args:o}}))}),t}),[])}importAllConditions(t){this.clean(),k(t,(t=>{k(t.conditions,(e=>this.addCondition(t.column,e)))}))}removeConditions(t){this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(t,e){const o=this.getConditions(t);return e?o.some((t=>t.name===e)):o.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(sI),this.filteringStates=null,this.clearLocalHooks()}}yo(rI,lh);var lI=rI;class aI{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];this.conditionCollection=t,this.columnDataFactory=e}filter(){let t=[];return k(this.conditionCollection.getFilteredColumns(),((e,o)=>{let n=this.columnDataFactory(e);o&&(n=this._getIntersectData(n,t)),t=this.filterByColumn(e,n)})),t}filterByColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=[];return k(e,(e=>{void 0!==e&&this.conditionCollection.isMatch(e,t)&&o.push(e)})),o}_getIntersectData(t,e){const o=[];return k(e,(e=>{const n=e.meta.visualRow;void 0!==t[n]&&(o[n]=t[n])})),o}}var hI=aI;class cI{constructor(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];this.hot=t,this.conditionCollection=e,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",(t=>this._onConditionBeforeModify(t))),this.conditionCollection.addLocalHook("afterRemove",(t=>this.updateStatesAtColumn(t))),this.conditionCollection.addLocalHook("afterAdd",(t=>this.updateStatesAtColumn(t))),this.conditionCollection.addLocalHook("beforeClean",(()=>this._onConditionBeforeClean())),this.conditionCollection.addLocalHook("afterClean",(()=>this._onConditionAfterClean()))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,k(this.changes,(t=>{this.updateStatesAtColumn(t)})),this.changes.length=0}_onConditionBeforeModify(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}updateStatesAtColumn(t,e){var o=this;if(this.grouping)return void(-1===this.changes.indexOf(t)&&this.changes.push(t));const n=this.conditionCollection.exportAllConditions();let i=this.conditionCollection.getColumnStackPosition(t);-1===i&&(i=this.latestEditedColumnPosition);const s=n.slice(0,i),r=n.slice(i);r.length&&r[0].column===t&&r.shift();const l=co((function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=new lI(o.hot,!1),s=[].concat(t,n);i.importAllConditions(s);const r=o.columnDataFactory(e);let l;l=i.isEmpty()?r:new hI(i,(t=>o.columnDataFactory(t))).filter(),l=A(l,(t=>t.meta.visualRow));const a=ix(l);return i.destroy(),I(r,(t=>a(t.meta.visualRow)))}))(s),a=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:a},dependentConditionStacks:r,filteredRowsFactory:l,conditionArgsChange:e})}_onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}_onConditionAfterClean(){k(this.latestOrderStack,(t=>{this.updateStatesAtColumn(t)}))}destroy(){this.clearLocalHooks(),Eo(this,((t,e)=>{this[e]=null}))}}yo(cI,lh);var dI=cI;function uI(t){const e=Ub({initialPage:0,size:()=>t.length,onItemSelect:(e,o)=>{const n=t[e];return n instanceof Lx?o:!(n.element&&!ye(n.element))&&void n.focus()}});return e}const gI="filters";function fI(t,e){const o=uI(e),n=n=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(gI),o.setCurrentPage(e.indexOf(n))};function i(n){const i=t.getKeyboardShortcutsCtrl(),s=n.getKeyboardShortcutsCtrl();o.clear(),s.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:i.getContext(gI),callback:()=>{n.isSubMenu()&&n.close(),i.listen(gI)}}]),n.isSubMenu()||i.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{t.getNavigator().clear(),e.shiftKey?o.toPreviousItem():o.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:t=>{const n=e[o.getCurrentPage()];n instanceof gH&&(n.openOptions(),t.preventDefault()),n instanceof px&&(n.activate(),t.preventDefault()),n instanceof DT||t.preventDefault()}}],gI)}function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen(gI)}return e.forEach((t=>{t instanceof DT&&(t.addLocalHook("click",n(t)),t.addLocalHook("focus",n(t)),t.addLocalHook("afterClose",n(t)))})),t.addLocalHook("afterSelectionChange",(t=>{t.key.startsWith("filter_")||o.clear()})),t.addLocalHook("afterSubmenuOpen",i),t.addLocalHook("afterOpen",i),{...o,listen:s}}function mI(t,e,o){pI(t,e),e.set(t,o)}function pI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wI(t,e,o){return e=CI(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function CI(t){var e=vI(t,"string");return"symbol"===typeof e?e:String(e)}function vI(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function yI(t,e,o){var n=RI(t,e,"set");return SI(t,n,o),o}function SI(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function bI(t,e){var o=RI(t,e,"get");return EI(t,o)}function RI(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function EI(t,e){return e.get?e.get.call(t):e.value}const MI="filters",TI=250,HI=MI;var xI=new WeakMap;class II extends tv{static get PLUGIN_KEY(){return MI}static get PLUGIN_PRIORITY(){return TI}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(t){super(t),wI(this,"dropdownMenuPlugin",null),wI(this,"conditionCollection",null),wI(this,"conditionUpdateObserver",null),wI(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),wI(this,"filtersRowsMap",null),mI(this,xI,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",((t,e)=>this.onAfterGetColHeader(t,e)))}isEnabled(){return!!this.hot.getSettings()[MI]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new bh),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,e=t&&t.uiContainer||this.hot.rootDocument.body,o=t=>(t.addLocalHook("accept",(()=>this.onActionBarSubmit("accept"))),t.addLocalHook("cancel",(()=>this.onActionBarSubmit("cancel"))),t.addLocalHook("change",(e=>this.onComponentChange(t,e))),t),n=()=>`${this.hot.getTranslatedPhrase(bd)}:`,i=()=>`${this.hot.getTranslatedPhrase(Rd)}:`;if(!this.components.get("filter_by_condition")){const t=new bH(this.hot,{id:"filter_by_condition",name:n,addSeparator:!1,menuContainer:e});t.addLocalHook("afterClose",(()=>this.onSelectUIClosed())),this.components.set("filter_by_condition",o(t))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new ZH(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const t=new bH(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:e});t.addLocalHook("afterClose",(()=>this.onSelectUIClosed())),this.components.set("filter_by_condition2",o(t))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",o(new Qx(this.hot,{id:"filter_by_value",name:i}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",o(new nI(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new lI(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new dI(this.hot,this.conditionCollection,(t=>this.getDataMapAtColumn(t))),this.conditionUpdateObserver.addLocalHook("update",(t=>this.updateComponents(t)))),this.components.forEach((t=>t.show())),this.addHook("afterDropdownMenuDefaultOptions",(t=>this.onAfterDropdownMenuDefaultOptions(t))),this.addHook("afterDropdownMenuShow",(()=>this.onAfterDropdownMenuShow())),this.addHook("afterDropdownMenuHide",(()=>this.onAfterDropdownMenuHide())),this.addHook("afterChange",(t=>this.onAfterChange(t))),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!bI(this,xI)&&this.dropdownMenuPlugin.enabled){const t=this.dropdownMenuPlugin.menu,e=[{focus:()=>t.focus()},...Array.from(this.components).map((t=>{let[,e]=t;return e.getElements()})).flat()];yI(this,xI,fI(t,e));const o=t=>{bI(this,xI).listen(),t.preventDefault(),tn(t.keyCode,"TAB")&&(t.shiftKey?bI(this,xI).toPreviousItem():bI(this,xI).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",o),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",o)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){var t;this.enabled&&(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(((t,e)=>{t.destroy(),this.components.set(e,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{this.clearConditions(),this.filter()},group:HI})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(HI)}addCondition(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:IH;const i=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(i,{command:{key:e},args:o},n)}removeConditions(t){const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}clearConditions(t){if(void 0===t)this.conditionCollection.clean();else{const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}filter(){const t=this._createDataFilter(),e=!this.conditionCollection.isEmpty();let o=[];const n=this.conditionCollection.exportAllConditions(),i=this.hot.runHooks("beforeFilter",n);if(!1!==i)if(e){const e=[];this.hot.batchExecution((()=>{this.filtersRowsMap.clear(),o=A(t.filter(),(t=>t.meta.visualRow));const n=ix(o);mi(this.hot.countSourceRows()-1,(t=>{n(t)||e.push(t)})),k(e,(t=>{this.filtersRowsMap.setValueAtIndex(t,!0)}))}),!0),o.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",n),this.hot.view.adjustElementsSize(!0),this.hot.render()}getSelectedColumn(){var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}getDataMapAtColumn(t){const e=this.hot.toVisualColumn(t),o=[];return k(this.hot.getSourceDataAtCol(e),((t,n)=>{var i;const{row:s,col:r,visualCol:l,visualRow:a,type:h,instance:c,dateFormat:d,locale:u}=this.hot.getCellMeta(n,e),g=null!==(i=this.hot.getDataAtCell(this.hot.toVisualRow(n),e))&&void 0!==i?i:t;o.push({meta:{row:s,col:r,visualCol:l,visualRow:a,type:h,instance:c,dateFormat:d,locale:u},value:sx(g)})})),o}onAfterChange(t){t&&k(t,(t=>{const[,e]=t,o=this.hot.propToCol(e);this.conditionCollection.hasConditions(o)&&this.updateValueComponentCondition(o)}))}updateValueComponentCondition(t){const e=this.hot.getDataAtCol(t),o=rx(e);this.conditionUpdateObserver.updateStatesAtColumn(t,o)}restoreComponents(t){var e;const o=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach((t=>{t.isHidden()||t.restoreState(o)})),this.updateDependentComponentsVisibility()}onAfterDropdownMenuShow(){this.restoreComponents(Array.from(this.components.values()))}onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}onAfterDropdownMenuDefaultOptions(t){t.items.push({name:fS}),this.components.forEach((e=>{t.items.push(e.getMenuItemDescriptor())}))}getOperationBasedOnArguments(t,e,o,n){let i=t;return i===OH&&e.command.key!==BM&&o.command.key!==BM&&n.command.key!==BM?i=_H:n.command.key!==BM&&(e.command.key!==BM&&o.command.key!==BM||(i=IH)),i}onActionBarSubmit(t){var e;if("accept"===t){const t=this.getSelectedColumn();var o;if(null===t)return void(null===(o=this.dropdownMenuPlugin)||void 0===o||o.close());const{physicalIndex:e}=t,n=this.components.get("filter_by_condition").getState(),i=this.components.get("filter_by_condition2").getState(),s=this.components.get("filter_by_value").getState(),r=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),n,i,s);this.conditionUpdateObserver.groupChanges();let l=this.conditionCollection.getColumnStackPosition(e);-1===l&&(l=void 0),this.conditionCollection.removeConditions(e),n.command.key!==BM&&(this.conditionCollection.addCondition(e,n,r,l),i.command.key!==BM&&this.conditionCollection.addCondition(e,i,r,l)),s.command.key!==BM&&this.conditionCollection.addCondition(e,s,r,l),this.conditionUpdateObserver.flush(),this.components.forEach((t=>t.saveState(e))),this.filtersRowsMap.clear(),this.filter(),this.hot.selectCell(0,t.visualIndex)}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}onComponentChange(t,e){this.updateDependentComponentsVisibility(),t.constructor!==bH||e.inputsCount||this.setListeningDropdownMenu()}onSelectUIClosed(){this.setListeningDropdownMenu()}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const t=this.components.get("filter_by_condition"),{command:e}=t.getState(),o=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents(...o):this.hideComponents(...o)}onAfterGetColHeader(t,e){const o=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(o)?de(e,"htFiltersActive"):ue(e,"htFiltersActive")}_createDataFilter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new hI(t,(t=>this.getDataMapAtColumn(t)))}updateComponents(t){var e;if(null===(e=this.dropdownMenuPlugin)||void 0===e||!e.enabled)return;const{editedConditionStack:{conditions:o,column:n}}=t,i=o.filter((t=>t.name===Ux)),s=o.filter((t=>t.name!==Ux));if(i.length>=2||s.length>=3)ln(j`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const e=this.conditionCollection.getOperation(n);this.components.get("filter_by_condition").updateState(s[0],n),this.components.get("filter_by_condition2").updateState(s[1],n),this.components.get("filter_operators").updateState(e,n),this.components.get("filter_by_value").updateState(t)}}getIndexesOfComponents(){const t=[];if(!this.dropdownMenuPlugin)return t;const e=this.dropdownMenuPlugin.menu;for(var o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return k(n,(o=>{k(e.menuItems,((e,n)=>{e.key===o.getMenuItemDescriptor().key&&t.push(n)}))})),t}changeComponentsVisibility(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const e=this.dropdownMenuPlugin.menu,o=e.hotMenu,n=o.getPlugin("hiddenRows");for(var i=arguments.length,s=new Array(i>1?i-1:0),r=1;r<i;r++)s[r-1]=arguments[r];const l=this.getIndexesOfComponents(...s);t?n.showRows(l):n.hideRows(l),o.render()}hideComponents(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.changeComponentsVisibility(!1,...e)}showComponents(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.changeComponentsVisibility(!0,...e)}destroy(){this.enabled&&(this.components.forEach(((t,e)=>{null!==t&&(t.destroy(),this.components.set(e,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}const AI="internal-use-in-handsontable",kI={licenseKey:AI,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function OI(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:null===(e=t[UA])||void 0===e||null===(e=e.language)||void 0===e?void 0:e.langCode}}function PI(t){return Object.keys(t).reduce(((e,o)=>("hyperformula"!==o&&(e[o]=t[o]),e)),{})}function NI(t){var e;const o=t[UA],n=PI(null!==o&&void 0!==o&&null!==(e=o.engine)&&void 0!==e&&e.hyperformula?o.engine:{}),i=OI(t);return{...kI,...n,...i}}function _I(t){var e;const o=t[UA],n=PI(null!==o&&void 0!==o&&null!==(e=o.engine)&&void 0!==e&&e.hyperformula?o.engine:{}),i=OI(t);return{...n,...i}}function DI(t,e){return Object.keys(e).some((o=>void 0!==e[o]&&e[o]!==t[o]))}function LI(){const t="engine_relationship",e=Cn(UA);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function VI(){const t="shared_engine_usage",e=Cn(UA);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function BI(t){const e=t.getSettings(),o=e[UA],n=null===o||void 0===o?void 0:o.engine;if(!0===o)return null;if($(n))return null;var i;if("function"===typeof n.hyperformula||"function"===typeof n)return FI(null!==(i=n.hyperformula)&&void 0!==i?i:n,e,t);if("object"===typeof n&&$(n.hyperformula)){const e=LI(),o=VI().get(n);return e.has(n)||e.set(n,[]),e.get(n).push(t),o&&o.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:AI}),n.getConfig().leapYear1900===kI.leapYear1900&&!1!==So(n.getConfig().nullDate,kI.nullDate)||ln(j`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}function FI(t,e,o){const n=e[UA],i=NI(e),s=LI(),r=VI();zI(t,n.functions),UI(t,n.language);const l=t.buildEmpty(i);return s.set(l,[o]),r.set(l,[o.guid]),$I(l,n.namedExpressions),l.on("sheetAdded",(()=>{l.rebuildAndRecalculate()})),l.on("sheetRemoved",(()=>{l.rebuildAndRecalculate()})),l}function WI(t){var e;const o=LI(),n=0===o.size?[]:Array.from(null!==(e=o.get(t))&&void 0!==e?e:[]);return new Map(n.map((t=>[t.getPlugin("formulas").sheetId,t])))}function jI(t,e){if(t){const o=LI(),n=o.get(t),i=VI(),s=i.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),0===n.length&&o.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),0===s.length&&(i.delete(t),t.destroy()))}}function zI(t,e){e&&e.forEach((e=>{const{name:o,plugin:n,translations:i}=e;try{t.registerFunction(o,n,i)}catch(s){ln(s.message)}}))}function UI(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(o){ln(o.message)}}}function $I(t,e){e&&(t.suspendEvaluation(),e.forEach((e=>{const{name:o,expression:n,scope:i,options:s}=e;try{t.addNamedExpression(o,n,i,s)}catch(r){ln(r.message)}})),t.resumeEvaluation())}function GI(t,e){return!$(e)&&t.doesSheetExist(e)||(e=t.addSheet(e)),e}const YI="DD/MM/YYYY";function KI(t){return"string"===typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function XI(t){return KI(t)?t.substr(1):t}function qI(t){return"string"===typeof t&&t.startsWith("=")}function QI(t,e){return"string"===typeof t&&"date"===e}function JI(t,e){return E(t,e,!0).isValid()}function ZI(t,e){return E(t,e,!0).format(YI)}function tA(t,e){return E(t,YI,!0).format(e)}function eA(t,e){const o=-1,n=new Date(Date.UTC(0,0,t+o));return E(n).format(e)}function oA(t,e,o){nA(t,e),e.set(t,o)}function nA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iA(t,e){var o=lA(t,e,"get");return sA(t,o)}function sA(t,e){return e.get?e.get.call(t):e.value}function rA(t,e,o){var n=lA(t,e,"set");return aA(t,n,o),o}function lA(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function aA(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var hA=new WeakMap,cA=new WeakMap,dA=new WeakMap,uA=new WeakMap,gA=new WeakMap,fA=new WeakMap,mA=new WeakMap;class pA{constructor(t,e,o){oA(this,hA,{writable:!0,value:void 0}),oA(this,cA,{writable:!0,value:void 0}),oA(this,dA,{writable:!0,value:void 0}),oA(this,uA,{writable:!0,value:[]}),oA(this,gA,{writable:!0,value:[]}),oA(this,fA,{writable:!0,value:void 0}),oA(this,mA,{writable:!0,value:[]}),rA(this,hA,t),rA(this,cA,e),rA(this,dA,o)}setRemovedHfIndexes(t){return rA(this,mA,t.map((t=>{const e=iA(this,cA).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(e)}))),iA(this,mA)}getRemovedHfIndexes(){return iA(this,mA)}getHfIndexFromVisualIndex(t){const e=iA(this,cA).getIndexesSequence(),o=iA(this,cA).getNotTrimmedIndexes();return e.indexOf(o[t])}syncMoves(t){const e=1,o=`move${lt(iA(this,hA))}s`;iA(this,dA).getEngine().batch((()=>{t.forEach((t=>{const n=t.from!==t.to,i=t.from+1!==t.to;n&&i&&iA(this,dA).getEngine()[o](iA(this,dA).getSheetId(),t.from,e,t.to)}))}))}storeMovesInformation(t,e,o){!1!==o&&(rA(this,gA,t.map((t=>this.getHfIndexFromVisualIndex(t)))),rA(this,fA,this.getHfIndexFromVisualIndex(e)))}getMoveLine(t,e){const o=iA(this,cA).getNumberOfIndexes(),n=Array.from(Array(o).keys()).filter((e=>!1===t.includes(e)));var i;return 0===e?null!==(i=n[e])&&void 0!==i?i:0:n[e-1]+1}getInitiallyCalculatedMoves(t,e){let o=this.getMoveLine(t,e);const n=[];return t.forEach((t=>{const e={from:t,to:o};n.forEach((t=>{const o=t.from>t.to,n=t.to<=e.from,i=t.from>e.from;i&&n&&o&&(e.from+=1)})),e.from>=o&&(o+=1),n.push(e)})),n}adjustedCalculatedMoves(t){return t.forEach(((e,o)=>{const n=t.slice(o+1);n.forEach((t=>{const o=t.from<t.to;t.from>e.from&&o&&(t.from-=1)}))})),t}calculateAndSyncMoves(t,e){if(iA(this,dA).isPerformingUndoRedo())return;if(!1===t||!1===e)return;const o=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(iA(this,gA),iA(this,fA)));null===iA(this,dA).getSheetId()?iA(this,dA).getPostponeAction((()=>this.syncMoves(o))):this.syncMoves(o)}getIndexesChangeSyncMethod(){const t=`set${lt(iA(this,hA))}Order`;return e=>{if(iA(this,dA).isPerformingUndoRedo())return;const o=iA(this,cA).getIndexesSequence();if("update"===e){const e=iA(this,uA).map((t=>o.indexOf(t))),n=iA(this,dA).getEngine().getSheetDimensions(iA(this,dA).getSheetId());let i;i="row"===iA(this,hA)?n.height:n.width;const s=e.length;for(let t=s;t<i;t+=1)e.push(t);iA(this,dA).getEngine()[t](iA(this,dA).getSheetId(),e)}rA(this,uA,o)}}init(){rA(this,uA,iA(this,cA).getIndexesSequence())}}var wA=pA;function CA(t,e,o){vA(t,e),e.set(t,o)}function vA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yA(t,e){var o=RA(t,e,"get");return SA(t,o)}function SA(t,e){return e.get?e.get.call(t):e.value}function bA(t,e,o){var n=RA(t,e,"set");return EA(t,n,o),o}function RA(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function EA(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var MA=new WeakMap,TA=new WeakMap,HA=new WeakMap,xA=new WeakMap,IA=new WeakMap,AA=new WeakMap,kA=new WeakMap;class OA{constructor(t,e,o){CA(this,MA,{writable:!0,value:void 0}),CA(this,TA,{writable:!0,value:void 0}),CA(this,HA,{writable:!0,value:void 0}),CA(this,xA,{writable:!0,value:!1}),CA(this,IA,{writable:!0,value:!1}),CA(this,AA,{writable:!0,value:null}),CA(this,kA,{writable:!0,value:null}),bA(this,MA,new wA("row",t,this)),bA(this,TA,new wA("column",e,this)),bA(this,HA,o)}getForAxis(t){return yA(this,"row"===t?MA:TA)}setPerformUndo(t){bA(this,xA,t)}setPerformRedo(t){bA(this,IA,t)}isPerformingUndoRedo(){return yA(this,xA)||yA(this,IA)}getSheetId(){return yA(this,kA)}getEngine(){return yA(this,AA)}getPostponeAction(){return yA(this,HA)}setupSyncEndpoint(t,e){bA(this,AA,t),bA(this,kA,e),yA(this,MA).init(),yA(this,TA).init()}}var PA=OA;function NA(t,e,o){return e=_A(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function _A(t){var e=DA(t,"string");return"symbol"===typeof e?e:String(e)}function DA(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function LA(t,e,o){VA(t,e),e.set(t,o)}function VA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BA(t,e,o){var n=jA(t,e,"set");return FA(t,n,o),o}function FA(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function WA(t,e){var o=jA(t,e,"get");return zA(t,o)}function jA(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function zA(t,e){return e.get?e.get.call(t):e.value}const UA="formulas",$A=["maxRows","maxColumns","language"],GA=260;pn.getSingleton().register("afterNamedExpressionAdded"),pn.getSingleton().register("afterNamedExpressionRemoved"),pn.getSingleton().register("afterSheetAdded"),pn.getSingleton().register("afterSheetRemoved"),pn.getSingleton().register("afterSheetRenamed"),pn.getSingleton().register("afterFormulasValuesUpdate");const YA=t=>"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t;var KA=new WeakMap,XA=new WeakMap,qA=new WeakMap;class QA extends tv{constructor(){var t;super(...arguments),t=this,LA(this,KA,{writable:!0,value:!1}),LA(this,XA,{writable:!0,value:!1}),LA(this,qA,{writable:!0,value:[["valuesUpdated",function(){return t.onEngineValuesUpdated(...arguments)}],["namedExpressionAdded",function(){return t.onEngineNamedExpressionsAdded(...arguments)}],["namedExpressionRemoved",function(){return t.onEngineNamedExpressionsRemoved(...arguments)}],["sheetAdded",function(){return t.onEngineSheetAdded(...arguments)}],["sheetRenamed",function(){return t.onEngineSheetRenamed(...arguments)}],["sheetRemoved",function(){return t.onEngineSheetRemoved(...arguments)}]]}),NA(this,"staticRegister",Cn("formulas")),NA(this,"engine",null),NA(this,"sheetName",null),NA(this,"indexSyncer",null),NA(this,"rowAxisSyncer",null),NA(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return UA}static get PLUGIN_PRIORITY(){return GA}static get SETTING_KEYS(){return[UA,...$A]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[UA]}enablePlugin(){var t,e=this;if(!this.enabled)if(this.engine=null!==(t=BI(this.hot))&&void 0!==t?t:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const t=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==t&&(this.sheetName=t)}this.addHook("beforeLoadData",(function(){return e.onBeforeLoadData(...arguments)})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData(...arguments)})),this.addHook("beforeUpdateData",(function(){return e.onBeforeLoadData(...arguments)})),this.addHook("afterUpdateData",(function(){return e.onAfterLoadData(...arguments)})),this.addHook("modifyData",(function(){return e.onModifyData(...arguments)})),this.addHook("modifySourceData",(function(){return e.onModifySourceData(...arguments)})),this.addHook("beforeValidate",(function(){return e.onBeforeValidate(...arguments)})),this.addHook("afterSetSourceDataAtCell",(function(){return e.onAfterSetSourceDataAtCell(...arguments)})),this.addHook("afterSetDataAtCell",(function(){return e.onAfterSetDataAtCell(...arguments)})),this.addHook("afterSetDataAtRowProp",(function(){return e.onAfterSetDataAtCell(...arguments)})),this.addHook("beforeCreateRow",(function(){return e.onBeforeCreateRow(...arguments)})),this.addHook("beforeCreateCol",(function(){return e.onBeforeCreateCol(...arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow(...arguments)})),this.addHook("afterCreateCol",(function(){return e.onAfterCreateCol(...arguments)})),this.addHook("beforeRemoveRow",(function(){return e.onBeforeRemoveRow(...arguments)})),this.addHook("beforeRemoveCol",(function(){return e.onBeforeRemoveCol(...arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow(...arguments)})),this.addHook("afterRemoveCol",(function(){return e.onAfterRemoveCol(...arguments)})),this.indexSyncer=new PA(this.hot.rowIndexMapper,this.hot.columnIndexMapper,(t=>{this.hot.addHookOnce("init",(()=>{t()}))})),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",((t,e,o,n)=>{this.rowAxisSyncer.storeMovesInformation(t,e,n)})),this.hot.addHook("beforeColumnMove",((t,e,o,n)=>{this.columnAxisSyncer.storeMovesInformation(t,e,n)})),this.hot.addHook("afterRowMove",((t,e,o,n,i)=>{this.rowAxisSyncer.calculateAndSyncMoves(n,i)})),this.hot.addHook("afterColumnMove",((t,e,o,n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(n,i)})),this.hot.addHook("beforeColumnFreeze",((t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart,e)})),this.hot.addHook("afterColumnFreeze",((t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)})),this.hot.addHook("beforeColumnUnfreeze",((t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart-1,e)})),this.hot.addHook("afterColumnUnfreeze",((t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)})),this.addHook("afterCellMetaReset",(function(){return e.onAfterCellMetaReset(...arguments)})),this.addHook("beforeUndo",(()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()})),this.addHook("beforeRedo",(()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformUndo(!1)})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformRedo(!1)})),this.addHook("afterDetachChild",(function(){return e.onAfterDetachChild(...arguments)})),this.addHook("beforeAutofill",(function(){return e.onBeforeAutofill(...arguments)})),WA(this,qA).forEach((t=>{let[e,o]=t;return this.engine.on(e,o)})),super.enablePlugin()}else ln("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}disablePlugin(){WA(this,qA).forEach((t=>{let[e,o]=t;return this.engine.off(e,o)})),jI(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(t){const e=_I(this.hot.getSettings());DI(this.engine.getConfig(),e)&&this.engine.updateConfig(e);const o=this.hot.getSettings()[UA];if(U(o)&&U(o.sheetName)&&o.sheetName!==this.sheetName&&this.switchSheet(o.sheetName),!t.data&&null===this.sheetName){const t=this.hot.getSettings()[UA].sheetName;t&&this.engine.doesSheetExist(t)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!==t&&void 0!==t?t:void 0,this.hot.getSourceDataArray())}super.updatePlugin(t)}destroy(){WA(this,qA).forEach((t=>{var e;let[o,n]=t;return null===(e=this.engine)||void 0===e?void 0:e.off(o,n)})),BA(this,qA,null),jI(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(t,e){if(U(e)&&!eh(e))return ln("The provided data should be an array of arrays."),!1;if(void 0!==t&&null!==t&&this.engine.doesSheetExist(t))return ln("Sheet with the provided name already exists."),!1;try{const o=this.engine.addSheet(null!==t&&void 0!==t?t:void 0);return e&&this.engine.setSheetContent(this.engine.getSheetId(o),e),o}catch(o){return ln(o.message),!1}}switchSheet(t){if(!this.engine.doesSheetExist(t))return void an(`The sheet named \`${t}\` does not exist, switch aborted.`);this.sheetName=t;const e=this.engine.getSheetSerialized(this.sheetId);e.length>0&&this.hot.loadData(e,`${lt(UA)}.switchSheet`)}getCellType(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const n=this.hot.toPhysicalRow(t),i=this.hot.toPhysicalColumn(e);return null!==n&&null!==i?this.engine.getCellType({sheet:o,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)}):"EMPTY"}isFormulaCellType(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:o,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)})}renderDependentSheets(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=new Set;t.forEach((t=>{var e;const n=null===t||void 0===t||null===(e=t.address)||void 0===e?void 0:e.sheet;void 0!==n&&(o.has(n)||o.add(n))})),WI(this.engine).forEach(((t,n)=>{var i;(e||n!==this.sheetId)&&o.has(n)&&(t.render(),null===(i=t.view)||void 0===i||i.adjustElementsSize())}))}validateDependentCells(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=t=>{var e;const{row:o,col:n,sheet:i}=null!==(e=null===t||void 0===t?void 0:t.address)&&void 0!==e?e:{};return U(i)?`${i}:${o}x${n}`:""},n=new Set(e.map((t=>o(t))));t.forEach((t=>{var e,i;const{row:s,col:r}=null!==(e=t.address)&&void 0!==e?e:{};if(!1===U(s)||!1===U(r)||s>=this.hot.countRows()||r>=this.hot.countCols())return;const l=null===t||void 0===t||null===(i=t.address)||void 0===i?void 0:i.sheet,a=o(t);if(void 0!==l&&!n.has(a)){const t=WI(this.engine).get(l);if(!t)return;t.validateCell(t.getDataAtCell(s,r),t.getCellMeta(s,r),(()=>{}))}}))}syncChangeWithEngine(t,e,o){const n={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(n))return void ln(`Not possible to set cell data at ${JSON.stringify(n)}`);const i=this.hot.getCellMeta(t,e);return QI(o,i.type)&&(JI(o,i.dateFormat)?o=ZI(o,i.dateFormat):!1===qI(o)&&(o=`'${o}`)),this.engine.setCellContents(n,o)}onBeforeValidate(t,e,o){const n=this.hot.propToCol(o);if(this.isFormulaCellType(e,n)){const t={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},o=this.hot.getCellMeta(e,n);let i=this.engine.getCellValue(t);return"date"===o.type&&gi(i)&&(i=eA(i,o.dateFormat)),"object"===typeof i&&null!==i?i.value:i}return t}onBeforeAutofill(t,e,o){const{row:n,col:i}=e.getTopStartCorner(),{row:s,col:r}=e.getBottomEndCorner(),{row:l,col:a}=o.getTopStartCorner(),{row:h,col:c}=o.getBottomEndCorner(),d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId}},u={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(u))return!1;const g=this.engine.getFillRangeData(d,u),{row:f,col:m}=d.start,{row:p,col:w}=d.end,C=p-f+1,v=w-m+1;for(let y=0;y<g.length;y+=1)for(let t=0;t<g[y].length;t+=1){const e=g[y][t],o=y%C,n=t%v,i=this.hot.getCellMeta(o,n);QI(e,i.type)&&(e.startsWith("'")?g[y][t]=e.slice(1):!1===this.isFormulaCellType(o,n,this.sheetId)&&(g[y][t]=tA(e,i.dateFormat)))}return g}onBeforeLoadData(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";o.includes(lt(UA))||BA(this,XA,$(this.hot.getSettings().data))}onAfterCellMetaReset(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach(((o,n)=>{o.forEach(((o,i)=>{const s=this.hot.getCellMeta(n,i),r=s.dateFormat;QI(o,s.type)&&(e=!0,JI(o,r)?t[n][i]=ZI(o,r):!1===this.isFormulaCellType(n,i)&&(t[n][i]=`'${o}`))}))})),!0===e&&(BA(this,KA,!0),this.engine.setSheetContent(this.sheetId,t),BA(this,KA,!1))}onAfterLoadData(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!o.includes(lt(UA)))if(this.sheetName=GI(this.engine,this.hot.getSettings()[UA].sheetName),WA(this,XA))this.switchSheet(this.sheetName);else{const t=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,t)){BA(this,KA,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),BA(this,KA,!1)}}}onModifyData(t,e,o,n){if("get"!==n||WA(this,KA)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(null===i||null===e)return;const s=this.isFormulaCellType(i,e);if(!s){const t=this.getCellType(i,e);if("ARRAY"!==t)return void(KI(o.value)&&(o.value=XI(o.value)))}const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let l=this.engine.getCellValue(r);const a=this.hot.getCellMeta(i,e);"date"===a.type&&gi(l)&&(l=eA(l,a.dateFormat));const h="object"===typeof l&&null!==l?l.value:l;o.value=h}onModifySourceData(t,e,o,n){if("get"!==n||WA(this,KA)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),s=this.hot.propToCol(e);if(null===i||null===s)return;const r=this.isFormulaCellType(i,s);if(!r){const t=this.getCellType(i,s);if("ARRAY"!==t)return}const l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===l.width&&0===l.height)return;const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};o.value=this.engine.getCellSerialized(a)}onAfterSetDataAtCell(t,e){if(YA(e))return;const o=[],n=[],i=this.engine.batch((()=>{t.forEach((t=>{let[e,i,,s]=t;const r=this.hot.propToCol(i),l=this.hot.toPhysicalRow(e),a=this.hot.toPhysicalColumn(r),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};null!==l&&null!==a?this.syncChangeWithEngine(e,r,s):o.push([e,r,s]),n.push({address:h})}))}));o.length&&this.hot.addHookOnce("afterChange",(()=>{const t=this.engine.batch((()=>{o.forEach((t=>{let[e,o,n]=t;this.syncChangeWithEngine(e,o,n)}))}));this.renderDependentSheets(t,!0)})),this.renderDependentSheets(i),this.validateDependentCells(i,n)}onAfterSetSourceDataAtCell(t,e){if(YA(e))return;const o=[],n=[];t.forEach((t=>{let[e,i,,s]=t;const r=this.hot.propToCol(i);if(!gi(r))return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(l)?(n.push({address:l}),o.push(...this.engine.setCellContents(l,s))):ln(`Not possible to set source cell data at ${JSON.stringify(l)}`)})),this.renderDependentSheets(o),this.validateDependentCells(o,n)}onBeforeCreateRow(t,e){let o=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(o=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[o,e]))return!1}onBeforeCreateCol(t,e){let o=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(o=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[o,e]))return!1}onBeforeRemoveRow(t,e,o){const n=this.rowAxisSyncer.setRemovedHfIndexes(o),i=n.every((t=>this.engine.isItPossibleToRemoveRows(this.sheetId,[t,1])));return!1!==i&&void 0}onBeforeRemoveCol(t,e,o){const n=this.columnAxisSyncer.setRemovedHfIndexes(o),i=n.every((t=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[t,1])));return!1!==i&&void 0}onAfterCreateRow(t,e,o){if(YA(o))return;const n=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}onAfterCreateCol(t,e,o){if(YA(o))return;const n=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}onAfterRemoveRow(t,e,o,n){if(YA(n))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),s=this.engine.batch((()=>{i.forEach((t=>{this.engine.removeRows(this.sheetId,[t,1])}))}));this.renderDependentSheets(s)}onAfterRemoveCol(t,e,o,n){if(YA(n))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),s=this.engine.batch((()=>{i.forEach((t=>{this.engine.removeColumns(this.sheetId,[t,1])}))}));this.renderDependentSheets(s)}onAfterDetachChild(t,e,o){var n;BA(this,KA,!0);const i=this.hot.getSourceDataArray(o,0,o+((null===(n=e.__children)||void 0===n?void 0:n.length)||0),this.hot.countSourceCols());BA(this,KA,!1),i.forEach(((t,e)=>{t.forEach(((t,n)=>{this.engine.setCellContents({col:n,row:o+e,sheet:this.sheetId},[[t]])}))}))}onEngineValuesUpdated(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}onEngineNamedExpressionsAdded(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}onEngineNamedExpressionsRemoved(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}onEngineSheetAdded(t){this.hot.runHooks("afterSheetAdded",t)}onEngineSheetRenamed(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}onEngineSheetRemoved(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}}function JA(t){return{key:"hidden_columns_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[,o,,n]=t;o-n!==0&&(e=1)}return this.getTranslatedPhrase(Xc,e)},callback(){const{from:e,to:o}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.col,o.col),0),i=Math.max(e.col,o.col),s=[];for(let t=n;t<=i;t+=1)s.push(t);t.hideColumns(s);const r=s[s.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(r,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function ZA(t){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(qc,t)},callback(){var o,n;if(0===e.length)return;let i=e[0],s=e[e.length-1];i=null!==(o=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==o?o:0,s=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))&&void 0!==n?n:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0);const r=s-i+1===this.countCols();r||this.selectColumns(i,s)},disabled:!1,hidden(){const o=A(t.getHiddenColumns(),(t=>this.toPhysicalColumn(t)));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||o.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().col,s=n.getBottomEndCorner().col,r=this.columnIndexMapper,l=r.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(s),h=r.getNotTrimmedIndexes(),c=[];if(i!==s){const t=s-i+1,e=a-l+1;if(t>e){const t=h.slice(i,s+1);c.push(...t.filter((t=>o.includes(t))))}}else if(0===l&&l<i)c.push(...h.slice(0,i));else if(null===l)c.push(...h.slice(0,this.countCols()));else{const t=this.countCols()-1,e=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(t,-1));a===e&&t>s&&c.push(...h.slice(s+1))}return k(c,(t=>{e.push(this.toVisualColumn(t))})),0===e.length}}}function tk(t,e,o){ek(t,e),e.set(t,o)}function ek(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ok(t,e){var o=sk(t,e,"get");return nk(t,o)}function nk(t,e){return e.get?e.get.call(t):e.value}function ik(t,e,o){var n=sk(t,e,"set");return rk(t,n,o),o}function sk(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function rk(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}pn.getSingleton().register("beforeHideColumns"),pn.getSingleton().register("afterHideColumns"),pn.getSingleton().register("beforeUnhideColumns"),pn.getSingleton().register("afterUnhideColumns");const lk="hiddenColumns",ak=310;var hk=new WeakMap,ck=new WeakMap;class dk extends tv{constructor(){super(...arguments),tk(this,hk,{writable:!0,value:{}}),tk(this,ck,{writable:!0,value:null})}static get PLUGIN_KEY(){return lk}static get PLUGIN_PRIORITY(){return ak}isEnabled(){return!!this.hot.getSettings()[lk]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[lk];bo(e)&&(ik(this,hk,e),$(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),ik(this,ck,new wh),ok(this,ck).addLocalHook("init",(()=>this.onMapInit())),this.hot.columnIndexMapper.registerMap(this.pluginName,ok(this,ck)),this.addHook("afterContextMenuDefaultOptions",(function(){return t.onAfterContextMenuDefaultOptions(...arguments)})),this.addHook("afterGetCellMeta",((t,e,o)=>this.onAfterGetCellMeta(t,e,o))),this.addHook("modifyColWidth",((t,e)=>this.onModifyColWidth(t,e))),this.addHook("afterGetColHeader",(function(){return t.onAfterGetColHeader(...arguments)})),this.addHook("modifyCopyableRange",(t=>this.onModifyCopyableRange(t))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),ik(this,hk,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(t){const e=this.getHiddenColumns(),o=this.isValidConfig(t);let n=e;const i=ok(this,ck).getValues().slice(),s=t.length>0;if(o&&s){const e=t.map((t=>this.hot.toPhysicalColumn(t)));k(e,(t=>{i[t]=!1})),n=x(i,((t,e,o)=>(e&&t.push(this.hot.toVisualColumn(o)),t)),[])}const r=this.hot.runHooks("beforeUnhideColumns",e,n,o&&s);!1!==r&&(o&&s&&ok(this,ck).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",e,n,o&&s,o&&n.length<e.length))}showColumn(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.showColumns(e)}hideColumns(t){const e=this.getHiddenColumns(),o=this.isValidConfig(t);let n=e;o&&(n=Array.from(new Set(e.concat(t))));const i=this.hot.runHooks("beforeHideColumns",e,n,o);!1!==i&&(o&&this.hot.batchExecution((()=>{k(t,(t=>{ok(this,ck).setValueAtIndex(this.hot.toPhysicalColumn(t),!0)}))}),!0),this.hot.runHooks("afterHideColumns",e,n,o,o&&n.length>e.length))}hideColumn(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.hideColumns(e)}getHiddenColumns(){return A(ok(this,ck).getHiddenIndexes(),(t=>this.hot.toVisualColumn(t)))}isHidden(t){return ok(this,ck).getValueAtIndex(this.hot.toPhysicalColumn(t))||!1}isValidConfig(t){const e=this.hot.countCols();return!!(Array.isArray(t)&&t.length>0)&&t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}resetCellsMeta(){k(this.hot.getCellsMeta(),(t=>{t&&(t.skipColumnOnPaste=!1)}))}onModifyColWidth(t,e){return this.isHidden(e)?0:ok(this,hk).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&"number"===typeof t&&this.hot.hasColHeaders()?t+15:void 0}onAfterGetCellMeta(t,e,o){if(!1===ok(this,hk).copyPasteEnabled&&this.isHidden(e)&&(o.skipColumnOnPaste=!0),this.isHidden(e-1))o.className=o.className||"",-1===o.className.indexOf("afterHiddenColumn")&&(o.className+=" afterHiddenColumn");else if(o.className){const t=o.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenColumn");e>-1&&t.splice(e,1),o.className=t.join(" ")}}}onModifyCopyableRange(t){if(ok(this,hk).copyPasteEnabled)return t;const e=[],o=(t,o,n,i)=>{e.push({startRow:t,endRow:o,startCol:n,endCol:i})};return k(t,(t=>{let e=!0,n=0;mi(t.startCol,t.endCol,(i=>{this.isHidden(i)?(e||o(t.startRow,t.endRow,n,i-1),e=!0):(e&&(n=i),i===t.endCol&&o(t.startRow,t.endRow,n,i),e=!1)}))})),e}onAfterGetColHeader(t,e){if(!ok(this,hk).indicators||t<0)return;const o=[];t>=1&&this.isHidden(t-1)&&o.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&o.push("beforeHiddenColumn"),de(e,o)}onAfterContextMenuDefaultOptions(t){t.items.push({name:fS},JA(this),ZA(this))}onMapInit(){Array.isArray(ok(this,hk).columns)&&this.hideColumns(ok(this,hk).columns)}destroy(){ik(this,hk,null),ik(this,ck,null),super.destroy()}}function uk(t){return{key:"hidden_rows_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[o,,n]=t;o-n!==0&&(e=1)}return this.getTranslatedPhrase(Qc,e)},callback(){const{from:e,to:o}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.row,o.row),0),i=Math.max(e.row,o.row),s=[];for(let t=n;t<=i;t+=1)s.push(t);t.hideRows(s);const r=s[s.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(r,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function gk(t){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(Jc,t)},callback(){var o,n;if(0===e.length)return;let i=e[0],s=e[e.length-1];i=null!==(o=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==o?o:0,s=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))&&void 0!==n?n:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0);const r=s-i+1===this.countRows();r||this.selectRows(i,s)},disabled:!1,hidden(){const o=A(t.getHiddenRows(),(t=>this.toPhysicalRow(t)));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||o.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().row,s=n.getBottomEndCorner().row,r=this.rowIndexMapper,l=r.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(s),h=r.getNotTrimmedIndexes(),c=[];if(i!==s){const t=s-i+1,e=a-l+1;if(t>e){const t=h.slice(i,s+1);c.push(...t.filter((t=>o.includes(t))))}}else if(0===l&&l<i)c.push(...h.slice(0,i));else if(null===l)c.push(...h.slice(0,this.countRows()));else{const t=this.countRows()-1,e=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(t,-1));a===e&&t>s&&c.push(...h.slice(s+1))}return k(c,(t=>{e.push(this.toVisualRow(t))})),0===e.length}}}function fk(t,e,o){mk(t,e),e.set(t,o)}function mk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pk(t,e){var o=vk(t,e,"get");return wk(t,o)}function wk(t,e){return e.get?e.get.call(t):e.value}function Ck(t,e,o){var n=vk(t,e,"set");return yk(t,n,o),o}function vk(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function yk(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}pn.getSingleton().register("beforeHideRows"),pn.getSingleton().register("afterHideRows"),pn.getSingleton().register("beforeUnhideRows"),pn.getSingleton().register("afterUnhideRows");const Sk="hiddenRows",bk=320;var Rk=new WeakMap,Ek=new WeakMap;class Mk extends tv{constructor(){super(...arguments),fk(this,Rk,{writable:!0,value:{}}),fk(this,Ek,{writable:!0,value:null})}static get PLUGIN_KEY(){return Sk}static get PLUGIN_PRIORITY(){return bk}isEnabled(){return!!this.hot.getSettings()[Sk]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[Sk];bo(e)&&(Ck(this,Rk,e),$(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),Ck(this,Ek,new wh),pk(this,Ek).addLocalHook("init",(()=>this.onMapInit())),this.hot.rowIndexMapper.registerMap(this.pluginName,pk(this,Ek)),this.addHook("afterContextMenuDefaultOptions",(function(){return t.onAfterContextMenuDefaultOptions(...arguments)})),this.addHook("afterGetCellMeta",((t,e,o)=>this.onAfterGetCellMeta(t,e,o))),this.addHook("modifyRowHeight",((t,e)=>this.onModifyRowHeight(t,e))),this.addHook("afterGetRowHeader",(function(){return t.onAfterGetRowHeader(...arguments)})),this.addHook("modifyCopyableRange",(t=>this.onModifyCopyableRange(t))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Ck(this,Rk,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(t){const e=this.getHiddenRows(),o=this.isValidConfig(t);let n=e;const i=pk(this,Ek).getValues().slice(),s=t.length>0;if(o&&s){const e=t.map((t=>this.hot.toPhysicalRow(t)));k(e,(t=>{i[t]=!1})),n=x(i,((t,e,o)=>(e&&t.push(this.hot.toVisualRow(o)),t)),[])}const r=this.hot.runHooks("beforeUnhideRows",e,n,o&&s);!1!==r&&(o&&s&&pk(this,Ek).setValues(i),this.hot.runHooks("afterUnhideRows",e,n,o&&s,o&&n.length<e.length))}showRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.showRows(e)}hideRows(t){const e=this.getHiddenRows(),o=this.isValidConfig(t);let n=e;o&&(n=Array.from(new Set(e.concat(t))));const i=this.hot.runHooks("beforeHideRows",e,n,o);!1!==i&&(o&&this.hot.batchExecution((()=>{k(t,(t=>{pk(this,Ek).setValueAtIndex(this.hot.toPhysicalRow(t),!0)}))}),!0),this.hot.runHooks("afterHideRows",e,n,o,o&&n.length>e.length))}hideRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.hideRows(e)}getHiddenRows(){return A(pk(this,Ek).getHiddenIndexes(),(t=>this.hot.toVisualRow(t)))}isHidden(t){return pk(this,Ek).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}isValidConfig(t){const e=this.hot.countRows();return!!(Array.isArray(t)&&t.length>0)&&t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}resetCellsMeta(){k(this.hot.getCellsMeta(),(t=>{t&&(t.skipRowOnPaste=!1)}))}onModifyRowHeight(t,e){return this.isHidden(e)?0:t}onAfterGetCellMeta(t,e,o){if(!1===pk(this,Rk).copyPasteEnabled&&this.isHidden(t)&&(o.skipRowOnPaste=!0),this.isHidden(t-1))o.className=o.className||"",-1===o.className.indexOf("afterHiddenRow")&&(o.className+=" afterHiddenRow");else if(o.className){const t=o.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenRow");e>-1&&t.splice(e,1),o.className=t.join(" ")}}}onModifyCopyableRange(t){if(pk(this,Rk).copyPasteEnabled)return t;const e=[],o=(t,o,n,i)=>{e.push({startRow:t,endRow:o,startCol:n,endCol:i})};return k(t,(t=>{let e=!0,n=0;mi(t.startRow,t.endRow,(i=>{this.isHidden(i)?(e||o(n,i-1,t.startCol,t.endCol),e=!0):(e&&(n=i),i===t.endRow&&o(n,i,t.startCol,t.endCol),e=!1)}))})),e}onAfterGetRowHeader(t,e){if(!pk(this,Rk).indicators||t<0)return;const o=[];t>=1&&this.isHidden(t-1)&&o.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&o.push("beforeHiddenRow"),de(e,o)}onAfterContextMenuDefaultOptions(t){t.items.push({name:fS},uk(this),gk(this))}onMapInit(){Array.isArray(pk(this,Rk).rows)&&this.hideRows(pk(this,Rk).rows)}destroy(){Ck(this,Rk,null),Ck(this,Ek,null),super.destroy()}}function Tk(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(Mc)},callback(e,o){const[{start:{col:n}}]=o;t.freezeColumn(n),this.render(),this.view.adjustElementsSize(!0)},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(e=!0),e}}}function Hk(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(Tc)},callback(e,o){const[{start:{col:n}}]=o;t.unfreezeColumn(n),this.render(),this.view.adjustElementsSize(!0)},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(e=!0),e}}}pn.getSingleton().register("beforeColumnFreeze"),pn.getSingleton().register("afterColumnFreeze"),pn.getSingleton().register("beforeColumnUnfreeze"),pn.getSingleton().register("afterColumnUnfreeze");const xk="manualColumnFreeze",Ik=110,Ak=new WeakMap;class kk extends tv{static get PLUGIN_KEY(){return xk}static get PLUGIN_PRIORITY(){return Ik}constructor(t){super(t),Ak.set(this,{afterFirstUse:!1})}isEnabled(){return!!this.hot.getSettings()[xk]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(t=>this.addContextMenuEntry(t))),this.addHook("beforeColumnMove",((t,e)=>this.onBeforeColumnMove(t,e))),super.enablePlugin())}disablePlugin(){const t=Ak.get(this);t.afterFirstUse=!1,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(t){const e=Ak.get(this),o=this.hot.getSettings(),n=o.fixedColumnsStart<this.hot.countCols()&&t>o.fixedColumnsStart-1;e.afterFirstUse||(e.afterFirstUse=!0);const i=this.hot.runHooks("beforeColumnFreeze",t,n);!1!==i&&(n&&(this.hot.columnIndexMapper.moveIndexes(t,o.fixedColumnsStart),o._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",t,n))}unfreezeColumn(t){const e=Ak.get(this),o=this.hot.getSettings(),n=o.fixedColumnsStart>0&&t<=o.fixedColumnsStart-1;e.afterFirstUse||(e.afterFirstUse=!0);const i=this.hot.runHooks("beforeColumnUnfreeze",t,n);!1!==i&&(n&&(o._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(t,o.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",t,n))}addContextMenuEntry(t){t.items.push({name:"---------"},Tk(this),Hk(this))}onBeforeColumnMove(t,e){const o=Ak.get(this);if(o.afterFirstUse){const o=this.hot.getSettings().fixedColumnsStart;if(e<o)return!1;if(t.some((t=>t<o)))return!1}}}const Ok=0,Pk=1,Nk=2,_k="px";class Dk{constructor(t){this.hot=t,this._element=null,this.state=Ok,this.inlineProperty=t.isRtl()?"right":"left"}appendTo(t){t.appendChild(this._element),this.state=Nk}build(){this.state===Ok&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Pk)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Ok}isAppended(){return this.state===Nk}isBuilt(){return this.state>=Pk}setPosition(t,e){gi(t)&&(this._element.style.top=t+_k),gi(e)&&(this._element.style[this.inlineProperty]=e+_k)}getPosition(){const t=this._element.style;return{top:t.top?parseInt(t.top,10):0,start:t[this.inlineProperty]?parseInt(t[this.inlineProperty],10):0}}setSize(t,e){gi(t)&&(this._element.style.width=t+_k),gi(e)&&(this._element.style.height=e+_k)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){gi(t)&&(this._element.style.marginTop=t+_k),gi(e)&&(this._element.style[`margin${lt(this.inlineProperty)}`]=e+_k)}getOffset(){const t=this._element.style,e=`margin${lt(this.inlineProperty)}`;return{top:t.marginTop?parseInt(t.marginTop,10):0,start:t[e]?parseInt(t[e],10):0}}}var Lk=Dk;const Vk="ht__manualColumnMove--backlight";class Bk extends Lk{build(){super.build(),de(this._element,Vk)}}var Fk=Bk;const Wk="ht__manualColumnMove--guideline";class jk extends Lk{build(){super.build(),de(this._element,Wk)}}var zk=jk;pn.getSingleton().register("beforeColumnMove"),pn.getSingleton().register("afterColumnMove");const Uk="manualColumnMove",$k=120,Gk=new WeakMap,Yk="ht__manualColumnMove",Kk="show-ui",Xk="on-moving--columns",qk="after-selection--columns";class Qk extends tv{static get PLUGIN_KEY(){return Uk}static get PLUGIN_PRIORITY(){return $k}constructor(t){super(t),Gk.set(this,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),this.eventManager=new On(this),this.backlight=new Fk(t),this.guideline=new zk(t)}isEnabled(){return!!this.hot.getSettings()[Uk]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown(...arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return t.onBeforeOnCellMouseOver(...arguments)})),this.addHook("afterScrollVertically",(()=>this.onAfterScrollVertically())),this.addHook("afterLoadData",(function(){return t.onAfterLoadData(...arguments)})),this.buildPluginUI(),this.registerEvents(),de(this.hot.rootElement,Yk),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ue(this.hot.rootElement,Yk),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(t,e){return this.moveColumns([t],e)}moveColumns(t,e){const o=Gk.get(this),n=o.cachedDropIndex,i=this.isMovePossible(t,e),s=this.hot.runHooks("beforeColumnMove",t,e,n,i);if(o.cachedDropIndex=void 0,!1===s)return;i&&this.hot.columnIndexMapper.moveIndexes(t,e);const r=i&&this.isColumnOrderChanged(t,e);return this.hot.runHooks("afterColumnMove",t,e,n,i,r),r}dragColumn(t,e){return this.dragColumns([t],e)}dragColumns(t,e){const o=this.countFinalIndex(t,e),n=Gk.get(this);return n.cachedDropIndex=e,this.moveColumns(t,o)}isMovePossible(t,e){const o=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),n=t.length+e>o,i=e<0,s=t.some((t=>t<0)),r=t.some((t=>t>=o));return!(n||i||s||r)}isColumnOrderChanged(t,e){return t.some(((t,o)=>t-o!==e))}countFinalIndex(t,e){const o=x(t,((t,o)=>(o<e&&(t+=1),t)),0);return e-o}getColumnsWidth(t,e){const o=this.hot.columnIndexMapper;let n=0;for(let i=t;i<=e;i+=1){const t=o.getRenderableFromVisualIndex(i);i<0?n+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==t&&(n+=this.hot.view._wt.wtTable.getStretchedColumnWidth(t)||0)}return n}moveBySettingsOrLoad(){const t=this.hot.getSettings()[Uk];if(Array.isArray(t))this.moveColumns(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(t){return t<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value?t.value:[]}prepareColumnsToMoving(t,e){const o=[];return mi(t,e,(t=>{o.push(t)})),o}refreshPositions(){const t=Gk.get(this),e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(t.hoveredColumn)&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const o=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,i="number"===typeof n.scrollX?n.scrollX:n.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,t.hoveredColumn-1);const r=o.hider.offsetWidth,l=o.TBODY.offsetLeft,a=this.backlight.getOffset().start,h=this.backlight.getSize().width;let c=0,d=0;if(this.hot.isRtl()){const e=this.hot.rootWindow,o=ke(this.hot.rootElement),s=e.innerWidth-t.rootElementOffset-o;d=e.innerWidth-t.target.eventPageX-s-(void 0===n.scrollX?i:0)}else d=t.target.eventPageX-(t.rootElementOffset-(void 0===n.scrollX?i:0));if(t.hasRowHeaders&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(t.hoveredColumn)&&(s+=i),s+=c,t.hoveredColumn<0)t.fixedColumnsStart>0?t.target.col=0:t.target.col=e>0?e-1:e;else if(t.target.TD.offsetWidth/2+s<=d){const e=t.hoveredColumn>=t.countCols?t.countCols-1:t.hoveredColumn;t.target.col=e+1,s+=t.target.TD.offsetWidth}else t.target.col=t.hoveredColumn;let u=d,g=s;d+h+a>=r?u=r-h-a:d+a<l+c&&(u=l+c+Math.abs(a)),s>=r-1?g=r-1:0===g?g=1:void 0!==n.scrollX&&t.hoveredColumn<t.fixedColumnsStart&&(g-=t.rootElementOffset<=n.scrollX?t.rootElementOffset:0),this.backlight.setPosition(null,u),this.guideline.setPosition(null,g)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",(t=>this.onMouseMove(t))),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp()))}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(t,e,o,n){const i=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),r=this.hot.getSelectedRangeLast(),l=Gk.get(this),a=ce(t.target,"sortAction");if(!r||!s||l.pressed||0!==t.button||a)return l.pressed=!1,l.columnsToMove.length=0,void ue(this.hot.rootElement,[Xk,Kk]);const h=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();h&&c&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:d,to:u}=r,g=Math.min(d.col,u.col),f=Math.max(d.col,u.col);if(e.row<0&&e.col>=g&&e.col<=f){n.column=!0,l.pressed=!0;const s=o.firstChild?rn(t,o.firstChild).x:t.offsetX;l.target.eventPageX=t.pageX,l.hoveredColumn=e.col,l.target.TD=o,l.target.col=e.col,l.columnsToMove=this.prepareColumnsToMoving(g,f),l.hasRowHeaders=!!this.hot.getSettings().rowHeaders,l.countCols=this.hot.countCols(),l.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,l.rootElementOffset=Se(this.hot.rootElement).left;const r=l.hasRowHeaders?-1:0,a=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,h=e.col<l.fixedColumnsStart,c=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),d=Math.abs(s-(this.hot.isRtl()?o.offsetWidth:0)),u=this.getColumnsWidth(g,e.col-1)+d,m=this.getColumnsWidth(r,g-1)+(h?c:0)+u;this.backlight.setPosition(a,m),this.backlight.setSize(this.getColumnsWidth(g,f),i.hider.offsetHeight-a),this.backlight.setOffset(null,-u),de(this.hot.rootElement,Xk)}else ue(this.hot.rootElement,qk),l.pressed=!1,l.columnsToMove.length=0}onMouseMove(t){const e=Gk.get(this);e.pressed&&(e.target.eventPageX=t.pageX,this.refreshPositions())}onBeforeOnCellMouseOver(t,e,o,n){const i=this.hot.getSelectedRangeLast(),s=Gk.get(this);i&&s.pressed&&(s.columnsToMove.indexOf(e.col)>-1?ue(this.hot.rootElement,Kk):de(this.hot.rootElement,Kk),n.row=!0,n.column=!0,n.cell=!0,s.hoveredColumn=e.col,s.target.TD=o)}onMouseUp(){const t=Gk.get(this),e=t.target.col,o=t.columnsToMove.length;if(t.hoveredColumn=void 0,t.pressed=!1,t.backlightWidth=0,ue(this.hot.rootElement,[Xk,Kk,qk]),this.hot.selection.isSelectedByColumnHeader()&&de(this.hot.rootElement,qk),o<1||void 0===e)return;const n=t.columnsToMove[0],i=this.hot.toPhysicalColumn(n),s=this.dragColumns(t.columnsToMove,e);if(t.columnsToMove.length=0,!0===s){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const t=this.hot.toVisualColumn(i),e=t+o-1;this.hot.selectColumns(t,e)}}onAfterScrollVertically(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,o=t.holder.scrollTop,n=e+o;this.backlight.setPosition(n),this.backlight.setSize(null,t.hider.offsetHeight-n)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const Jk="manualColumnResize",Zk=130,tO="manualColumnWidths",eO=new WeakMap;class oO extends tv{static get PLUGIN_KEY(){return Jk}static get PLUGIN_PRIORITY(){return Zk}constructor(t){super(t);const{rootDocument:e}=this.hot;this.currentTH=null,this.currentCol=null,this.selectedCols=[],this.currentWidth=null,this.newSize=null,this.startY=null,this.startWidth=null,this.startOffset=null,this.handle=e.createElement("DIV"),this.guide=e.createElement("DIV"),this.eventManager=new On(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.columnWidthsMap=void 0,eO.set(this,{config:void 0}),de(this.handle,"manualColumnResizer"),de(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Jk]}enablePlugin(){this.enabled||(this.columnWidthsMap=new ph,this.columnWidthsMap.addLocalHook("init",(()=>this.onMapInit())),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",((t,e)=>this.onModifyColWidth(t,e))),this.addHook("beforeStretchingColumnWidth",((t,e)=>this.onBeforeStretchingColumnWidth(t,e))),this.addHook("beforeColumnResize",((t,e,o)=>this.onBeforeColumnResize(t,e,o))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const t=eO.get(this);t.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",tO,this.columnWidthsMap.getValues())}loadManualColumnWidths(){const t={};return this.hot.runHooks("persistentStateLoad",tO,t),t.value}setManualSize(t,e){const o=Math.max(e,20),n=this.hot.toPhysicalColumn(t);return this.columnWidthsMap.setValueAtIndex(n,o),o}clearManualSize(t){const e=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(e,null)}onMapInit(){const t=eO.get(this),e=this.hot.getSettings()[Jk],o=this.loadManualColumnWidths();"undefined"!==typeof o?this.hot.batchExecution((()=>{o.forEach(((t,e)=>{this.columnWidthsMap.setValueAtIndex(e,t)}))}),!0):Array.isArray(e)?(this.hot.batchExecution((()=>{e.forEach(((t,e)=>{this.columnWidthsMap.setValueAtIndex(e,t)}))}),!0),t.config=e):!0===e&&Array.isArray(t.config)&&this.hot.batchExecution((()=>{t.config.forEach(((t,e)=>{this.columnWidthsMap.setValueAtIndex(e,t)}))}),!0)}setupHandlePosition(t){if(!t.parentNode)return;this.currentTH=t;const{_wt:e}=this.hot.view,o=e.wtTable.getCoords(this.currentTH),n=o.col;if(n<0)return;const i=Oe(this.currentTH),s=this.currentTH.getBoundingClientRect(),r=n<e.getSetting("fixedColumnsStart");let l;r&&(l=e.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),l||(l=e.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),this.selectedCols=[];const a=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&a){const t=this.hot.getSelectedRange();k(t,(t=>{const e=t.getTopStartCorner().col,o=t.getBottomEndCorner().col;mi(e,o,(t=>{this.selectedCols.includes(t)||this.selectedCols.push(t)}))}))}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=l.start-6,this.startWidth=parseInt(s.width,10),this.handle.style.top=`${l.top}px`,this.handle.style[this.inlineDir]=`${this.startOffset+this.startWidth}px`,this.handle.style.height=`${i}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style[this.inlineDir]=`${this.startOffset+this.currentWidth}px`}setupGuidePosition(){const t=parseInt(Oe(this.handle),10),e=parseInt(this.handle.style.top,10)+t,o=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);de(this.handle,"active"),de(this.guide,"active"),this.guide.style.top=`${e}px`,this.refreshGuidePosition(),this.guide.style.height=o-t+"px",this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){ue(this.handle,"active"),ue(this.guide,"active")}checkIfColumnHeader(t){return!!ne(t,["THEAD"],this.hot.rootElement)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}onMouseOver(t){if(!Ze(t.target)&&!0!==this.isTriggeredByRMB&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const o=e.getAttribute("colspan");!e||null!==o&&"1"!==o||this.pressed||this.setupHandlePosition(e)}}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{const n=this.hot.runHooks("beforeColumnResize",this.newSize,e,!0);void 0!==n&&(this.newSize=n),"all"===this.hot.getSettings().stretchH?this.clearManualSize(e):this.setManualSize(e,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,e,!0),o&&t()};if(this.dblclick>=2){const o=this.selectedCols.length;o>1?(k(this.selectedCols,(t=>{e(t)})),t()):k(this.selectedCols,(t=>{e(t,!0)}))}this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(t){ce(t.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((()=>this.afterMouseDownTimeout()),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=t.pageX,this.newSize=this.startWidth)}onMouseMove(t){if(this.pressed){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+e,k(this.selectedCols,(t=>{this.newSize=this.setManualSize(t,this.currentWidth)})),this.refreshHandlePosition(),this.refreshGuidePosition()}}onMouseUp(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{this.hot.runHooks("beforeColumnResize",this.newSize,e,!1),o&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,e,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){const o=this.selectedCols.length;o>1?(k(this.selectedCols,(t=>{e(t)})),t()):k(this.selectedCols,(t=>{e(t,!0)}))}this.setupHandlePosition(this.currentTH)}}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate((()=>{this.isTriggeredByRMB=!1}))}bindEvents(){const{rootWindow:t,rootElement:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",(t=>this.onMouseOver(t))),this.eventManager.addEventListener(e,"mousedown",(t=>this.onMouseDown(t))),this.eventManager.addEventListener(t,"mousemove",(t=>this.onMouseMove(t))),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp())),this.eventManager.addEventListener(this.handle,"contextmenu",(()=>this.onContextMenu()))}onModifyColWidth(t,e){let o=t;if(this.enabled){const t=this.hot.toPhysicalColumn(e),n=this.columnWidthsMap.getValueAtIndex(t);this.hot.getSettings()[Jk]&&n&&(o=n)}return o}onBeforeStretchingColumnWidth(t,e){let o=this.columnWidthsMap.getValueAtIndex(e);return null===o&&(o=t),o}onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}destroy(){super.destroy()}}const nO=0,iO=1,sO=2,rO="px";class lO{constructor(t){this.hot=t,this._element=null,this.state=nO}appendTo(t){t.appendChild(this._element),this.state=sO}build(){this.state===nO&&(this._element=this.hot.rootDocument.createElement("div"),this.state=iO)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=nO}isAppended(){return this.state===sO}isBuilt(){return this.state>=iO}setPosition(t,e){void 0!==t&&(this._element.style.top=t+rO),void 0!==e&&(this._element.style.left=e+rO)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(t,e){t&&(this._element.style.width=t+rO),e&&(this._element.style.height=e+rO)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){t&&(this._element.style.marginTop=t+rO),e&&(this._element.style.marginLeft=e+rO)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}var aO=lO;const hO="ht__manualRowMove--backlight";class cO extends aO{build(){super.build(),de(this._element,hO)}}var dO=cO;const uO="ht__manualRowMove--guideline";class gO extends aO{build(){super.build(),de(this._element,uO)}}var fO=gO;pn.getSingleton().register("beforeRowMove"),pn.getSingleton().register("afterRowMove");const mO="manualRowMove",pO=140,wO=new WeakMap,CO="ht__manualRowMove",vO="show-ui",yO="on-moving--rows",SO="after-selection--rows";class bO extends tv{static get PLUGIN_KEY(){return mO}static get PLUGIN_PRIORITY(){return pO}constructor(t){super(t),wO.set(this,{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),this.eventManager=new On(this),this.backlight=new dO(t),this.guideline=new fO(t)}isEnabled(){return!!this.hot.getSettings()[mO]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown(...arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return t.onBeforeOnCellMouseOver(...arguments)})),this.addHook("afterScrollHorizontally",(()=>this.onAfterScrollHorizontally())),this.addHook("afterLoadData",(function(){return t.onAfterLoadData(...arguments)})),this.buildPluginUI(),this.registerEvents(),de(this.hot.rootElement,CO),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ue(this.hot.rootElement,CO),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(t,e){return this.moveRows([t],e)}moveRows(t,e){const o=wO.get(this),n=o.cachedDropIndex,i=this.isMovePossible(t,e),s=this.hot.runHooks("beforeRowMove",t,e,n,i);if(o.cachedDropIndex=void 0,!1===s)return;i&&this.hot.rowIndexMapper.moveIndexes(t,e);const r=i&&this.isRowOrderChanged(t,e);return this.hot.runHooks("afterRowMove",t,e,n,i,r),r}dragRow(t,e){return this.dragRows([t],e)}dragRows(t,e){const o=this.countFinalIndex(t,e),n=wO.get(this);return n.cachedDropIndex=e,this.moveRows(t,o)}isMovePossible(t,e){const o=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),n=t.length+e>o,i=e<0,s=t.some((t=>t<0)),r=t.some((t=>t>=o));return!(n||i||s||r)}isRowOrderChanged(t,e){return t.some(((t,o)=>t-o!==e))}countFinalIndex(t,e){const o=x(t,((t,o)=>(o<e&&(t+=1),t)),0);return e-o}getRowsHeight(t,e){const o=this.hot.rowIndexMapper;let n=0;for(let i=t;i<=e;i++){const t=o.getRenderableFromVisualIndex(i);null!==t&&(n+=this.hot.view._wt.wtTable.getRowHeight(t)||23)}return n}moveBySettingsOrLoad(){const t=this.hot.getSettings()[mO];if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(t){return t<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(t){return t>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}prepareRowsToMoving(){const t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;const{from:o,to:n}=t,i=Math.min(o.row,n.row),s=Math.max(o.row,n.row);return mi(i,s,(t=>{e.push(t)})),e}refreshPositions(){const t=wO.get(this),e=t.target.coords,o=this.hot.view.getFirstFullyVisibleRow(),n=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&o>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1)),this.isFixedRowBottom(e.row)&&n<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,r=t.target.TD,l=this.hot.rootElement,a=Se(l),h=He(l),c=s.holder.scrollTop,d=this.hot.rootWindow!==h?h.scrollTop:0,u=a.top-d,g=t.target.eventPageY-u+c,f=s.hider.offsetHeight,m=s.TBODY.offsetTop,p=this.backlight.getOffset().top,w=this.backlight.getSize().height,C=r.offsetHeight/2,v=r.offsetHeight;let y=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const S=g>=y+C;this.isFixedRowTop(e.row)&&(y+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?t.target.row=o>0?o-1:o:S?(t.target.row=e.row+1,y+=0===e.row?v-1:v):t.target.row=e.row;let b=g,R=y;g+w+p>=f?b=f-w-p:g+p<m&&(b=m+Math.abs(p)),y>=f-1&&(R=f-1),this.backlight.setPosition(b),this.guideline.setPosition(R)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",(t=>this.onMouseMove(t))),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp()))}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(t,e,o,n){const{wtTable:i,wtViewport:s}=this.hot.view._wt,r=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast(),a=wO.get(this);if(!l||!r||a.pressed||0!==t.button)return a.pressed=!1,a.rowsToMove.length=0,void ue(this.hot.rootElement,[yO,vO]);const h=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();h&&c&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:d,to:u}=l,g=Math.min(d.row,u.row),f=Math.max(d.row,u.row);if(e.col<0&&e.row>=g&&e.row<=f){n.row=!0,a.pressed=!0,a.target.eventPageY=t.pageY,a.target.coords=e,a.target.TD=o,a.rowsToMove=this.prepareRowsToMoving();const r=i.holder.scrollLeft+s.getRowHeaderWidth(),l=this.getRowsHeight(g,e.row-1)+t.offsetY;this.backlight.setPosition(null,r),this.backlight.setSize(i.hider.offsetWidth-r,this.getRowsHeight(g,f)),this.backlight.setOffset(-l,null),de(this.hot.rootElement,yO),this.refreshPositions()}else ue(this.hot.rootElement,SO),a.pressed=!1,a.rowsToMove.length=0}onMouseMove(t){const e=wO.get(this);e.pressed&&(e.target.eventPageY=t.pageY,this.refreshPositions())}onBeforeOnCellMouseOver(t,e,o,n){const i=this.hot.getSelectedRangeLast(),s=wO.get(this);i&&s.pressed&&(s.rowsToMove.indexOf(e.row)>-1?ue(this.hot.rootElement,vO):de(this.hot.rootElement,vO),n.row=!0,n.column=!0,n.cell=!0,s.target.coords=e,s.target.TD=o)}onMouseUp(){const t=wO.get(this),e=t.target.row,o=t.rowsToMove.length;if(t.pressed=!1,t.backlightHeight=0,ue(this.hot.rootElement,[yO,vO,SO]),this.hot.selection.isSelectedByRowHeader()&&de(this.hot.rootElement,SO),o<1||void 0===e)return;const n=t.rowsToMove[0],i=this.hot.toPhysicalRow(n),s=this.dragRows(t.rowsToMove,e);if(t.rowsToMove.length=0,!0===s){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const t=this.hot.toVisualRow(i),e=t+o-1;this.hot.selectRows(t,e)}}onAfterScrollHorizontally(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),o=t.holder.scrollLeft,n=e+o;this.backlight.setPosition(null,n),this.backlight.setSize(t.hider.offsetWidth-n)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const RO="manualRowResize",EO=30,MO="manualRowHeights",TO=new WeakMap;class HO extends tv{static get PLUGIN_KEY(){return RO}static get PLUGIN_PRIORITY(){return EO}constructor(t){super(t);const{rootDocument:e}=this.hot;this.currentTH=null,this.currentRow=null,this.selectedRows=[],this.currentHeight=null,this.newSize=null,this.startY=null,this.startHeight=null,this.startOffset=null,this.handle=e.createElement("DIV"),this.guide=e.createElement("DIV"),this.eventManager=new On(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.rowHeightsMap=void 0,TO.set(this,{config:void 0}),de(this.handle,"manualRowResizer"),de(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[RO]}enablePlugin(){this.enabled||(this.rowHeightsMap=new ph,this.rowHeightsMap.addLocalHook("init",(()=>this.onMapInit())),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",((t,e)=>this.onModifyRowHeight(t,e))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const t=TO.get(this);t.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",MO,this.rowHeightsMap.getValues())}loadManualRowHeights(){const t={};return this.hot.runHooks("persistentStateLoad",MO,t),t.value}setManualSize(t,e){const o=this.hot.toPhysicalRow(t),n=Math.max(e,Nl.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(o,n),n}setupHandlePosition(t){this.currentTH=t;const{view:e}=this.hot,{_wt:o}=e,n=o.wtTable.getCoords(this.currentTH),i=n.row;if(i<0)return;const s=ke(this.currentTH),r=this.currentTH.getBoundingClientRect(),l=i<o.getSetting("fixedRowsTop"),a=i>=e.countNotHiddenRowIndexes(0,1)-o.getSetting("fixedRowsBottom");let h;l?h=o.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col):a&&(h=o.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col)),h||(h=o.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.selectedRows=[];const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&c){const t=this.hot.getSelectedRange();k(t,(t=>{const e=t.getTopStartCorner().row,o=t.getBottomStartCorner().row;mi(e,o,(t=>{this.selectedRows.includes(t)||this.selectedRows.push(t)}))}))}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=h.top-6,this.startHeight=parseInt(r.height,10),this.handle.style.top=`${this.startOffset+this.startHeight}px`,this.handle.style[this.inlineDir]=`${h.start}px`,this.handle.style.width=`${s}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style.top=`${this.startOffset+this.currentHeight}px`}setupGuidePosition(){const t=parseInt(ke(this.handle),10),e=parseInt(this.handle.style[this.inlineDir],10)+t,o=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);de(this.handle,"active"),de(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=`${e}px`,this.guide.style.width=o-t+"px",this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){ue(this.handle,"active"),ue(this.guide,"active")}checkIfRowHeader(t){var e;const o=ne(t,["TH"],this.hot.rootElement);return o&&"TBODY"===(null===(e=t.parentNode)||void 0===e||null===(e=e.parentNode)||void 0===e?void 0:e.tagName)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}getActualRowHeight(t){const e=this.hot.view._wt.wtTable.getRowHeight(t);return void 0!==e&&this.newSize<e?e:this.newSize}onMouseOver(t){if(!Ze(t.target)&&!0!==this.isTriggeredByRMB&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(this.pressed||this.setupHandlePosition(e))}}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{const n=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!0);void 0!==n&&(this.newSize=n),this.setManualSize(e,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!0),o&&t()};if(this.dblclick>=2){const o=this.selectedRows.length;o>1?(k(this.selectedRows,(t=>{e(t)})),t()):k(this.selectedRows,(t=>{e(t,!0)}))}this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(t){ce(t.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((()=>this.afterMouseDownTimeout()),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=t.pageY,this.newSize=this.startHeight)}onMouseMove(t){this.pressed&&(this.currentHeight=this.startHeight+(t.pageY-this.startY),k(this.selectedRows,(t=>{this.newSize=this.setManualSize(t,this.currentHeight)})),this.refreshHandlePosition(),this.refreshGuidePosition())}onMouseUp(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!1),o&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){const o=this.selectedRows.length;o>1?(k(this.selectedRows,(t=>{e(t)})),t()):k(this.selectedRows,(t=>{e(t,!0)}))}this.setupHandlePosition(this.currentTH)}}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate((()=>{this.isTriggeredByRMB=!1}))}bindEvents(){const{rootElement:t,rootWindow:e}=this.hot;this.eventManager.addEventListener(t,"mouseover",(t=>this.onMouseOver(t))),this.eventManager.addEventListener(t,"mousedown",(t=>this.onMouseDown(t))),this.eventManager.addEventListener(e,"mousemove",(t=>this.onMouseMove(t))),this.eventManager.addEventListener(e,"mouseup",(()=>this.onMouseUp())),this.eventManager.addEventListener(this.handle,"contextmenu",(()=>this.onContextMenu()))}onModifyRowHeight(t,e){let o=t;if(this.enabled){const t=this.hot.toPhysicalRow(e),n=this.rowHeightsMap.getValueAtIndex(t);this.hot.getSettings()[RO]&&n&&(o=n)}return o}onMapInit(){const t=TO.get(this),e=this.hot.getSettings()[RO],o=this.loadManualRowHeights();this.hot.batchExecution((()=>{"undefined"!==typeof o?o.forEach(((t,e)=>{this.rowHeightsMap.setValueAtIndex(e,t)})):Array.isArray(e)?(e.forEach(((t,e)=>{this.rowHeightsMap.setValueAtIndex(e,t)})),t.config=e):!0===e&&Array.isArray(t.config)&&t.config.forEach(((t,e)=>{this.rowHeightsMap.setValueAtIndex(e,t)}))}),!0)}destroy(){super.destroy()}}class xO{constructor(t,e,o,n,i,s){this.row=t,this.col=e,this.rowspan=o,this.colspan=n,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(t){return j`The merged cell declared with {row: ${t.row}, col: ${t.col},\x20
      rowspan: ${t.rowspan}, colspan: ${t.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(t){return j`The merged cell declared at [${t.row}, ${t.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(t){return j`The merged cell declared at [${t.row}, ${t.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(t){return j`The merged cell declared at [${t.row}, ${t.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}static isSingleCell(t){return 1===t.colspan&&1===t.rowspan}static containsZeroSpan(t){return 0===t.colspan||0===t.rowspan}static isOutOfBounds(t,e,o){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=o||t.col+t.colspan-1>=o}normalize(t){const e=t.countRows(),o=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}includes(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}includesHorizontally(t){return this.col<=t&&this.col+this.colspan-1>=t}includesVertically(t){return this.row<=t&&this.row+this.rowspan-1>=t}shift(t,e){const o=t[0]||t[1],n=e+Math.abs(t[0]||t[1])-1,i=t[0]?"colspan":"rowspan",s=t[0]?"col":"row",r=Math.min(e,n),l=Math.max(e,n),a=this[s],h=this[s]+this[i]-1;if(a>=e&&(this[s]+=o),o>0)e<=h&&e>a&&(this[i]+=o);else if(o<0){if(r<=a&&l>=h)return this.removed=!0,!1;if(a>=r&&a<=l){const t=l-a+1,e=Math.abs(o)-t;this[s]-=e+o,this[i]-=t}else if(a<=r&&h>=l)this[i]+=o;else if(a<=r&&h>=r&&h<l){const t=h-r+1;this[i]-=t}}return!0}isFarther(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}var IO=xO;function AO(t,e,o,n){e?e.row===o&&e.col===n?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}class kO{constructor(t){this.plugin=t,this.mergedCells=[],this.hot=t.hot}static IS_OVERLAPPING_WARNING(t){return j`The merged cell declared at [${t.row}, ${t.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(t,e){const o=this.mergedCells;let n=!1;return k(o,(o=>!(o.row<=t&&o.row+o.rowspan-1>=t&&o.col<=e&&o.col+o.colspan-1>=e)||(n=o,!1))),n}getByRange(t){const e=this.mergedCells;let o=!1;return k(e,(e=>!(e.row<=t.from.row&&e.row+e.rowspan-1>=t.to.row&&e.col<=t.from.col&&e.col+e.colspan-1>=t.to.col)||(o=e,o))),o}getWithinRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.mergedCells,n=[];let i=t;if(!i.includesRange){const t=this.hot._createCellCoords(i.from.row,i.from.col),e=this.hot._createCellCoords(i.to.row,i.to.col);i=this.hot._createCellRange(t,t,e)}return k(o,(t=>{const o=this.hot._createCellCoords(t.row,t.col),s=this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),r=this.hot._createCellRange(o,o,s);e?i.overlaps(r)&&n.push(t):i.includesRange(r)&&n.push(t)})),!!n.length&&n}add(t){const e=this.mergedCells,o=t.row,n=t.col,i=t.rowspan,s=t.colspan,r=new IO(o,n,i,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(o,n),a=this.isOverlapping(r);return l||a?(ln(kO.IS_OVERLAPPING_WARNING(r)),!1):(this.hot&&r.normalize(this.hot),e.push(r),r)}remove(t,e){const o=this.mergedCells,n=this.get(t,e),i=n?this.mergedCells.indexOf(n):-1;return!(!n||-1===i)&&(o.splice(i,1),n)}clear(){const t=this.mergedCells,e=[],o=[];k(t,(t=>{const o=this.hot.getCell(t.row,t.col);o&&e.push([o,this.get(t.row,t.col),t.row,t.col])})),this.mergedCells.length=0,k(e,((t,n)=>{mi(0,t.rowspan-1,(e=>{mi(0,t.colspan-1,(n=>{if(0!==n||0!==e){const i=this.hot.getCell(t.row+e,t.col+n);i&&o.push([i,null,null,null])}}))})),e[n][1]=null})),k(e,(t=>{AO(...t)})),k(o,(t=>{AO(...t)}))}isOverlapping(t){const e=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1));let o=!1;return k(this.mergedCells,(t=>{const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1));return!n.overlaps(e)||(o=!0,!1)})),o}isFirstRenderableMergedCell(t,e){const o=this.get(t,e);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===e}getFirstRenderableCoords(t,e){const o=this.get(t,e);if(!o||this.isFirstRenderableMergedCell(t,e))return this.hot._createCellCoords(t,e);const n=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(n,i)}shiftCollections(t,e,o){const n=[0,0];switch(t){case"right":n[0]+=o;break;case"left":n[0]-=o;break;case"down":n[1]+=o;break;case"up":n[1]-=o;break;default:}k(this.mergedCells,(t=>{t.shift(n,e)})),pi(this.mergedCells.length-1,0,(t=>{const e=this.mergedCells[t];e&&e.removed&&this.mergedCells.splice(this.mergedCells.indexOf(e),1)}))}}var OO=kO;class PO{constructor(t){this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}correctSelectionAreaSize(t){if(t[0]===t[2]&&t[1]===t[3]){const e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}getDirection(t,e){let o=null;return o=e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left",o}snapDragArea(t,e,o,n){const i=e.slice(0),s=this.getAutofillSize(t,e,o),[r,l,a,h]=t,c=["up","down"].indexOf(o)>-1,d=c?a-r+1:h-l+1,u=Math.floor(s/d)*d,g=s-u,f=this.getFarthestCollection(t,e,o,n);if(f)if("down"===o){const t=f.row+f.rowspan-r-g,e=i[2]+t;e>=this.plugin.hot.countRows()?i[2]-=g:i[2]+=g?t:0}else if("right"===o){const t=f.col+f.colspan-l-g,e=i[3]+t;e>=this.plugin.hot.countCols()?i[3]-=g:i[3]+=g?t:0}else if("up"===o){const t=a-g-f.row+1,e=i[0]+t;e<0?i[0]+=g:i[0]-=g?t:0}else if("left"===o){const t=h-g-f.col+1,e=i[1]+t;e<0?i[1]+=g:i[1]-=g?t:0}return this.updateCurrentFillCache({baseArea:t,dragDirection:o,foundMergedCells:n,fillSize:s,dragArea:i,cycleLength:d}),i}updateCurrentFillCache(t){this.currentFillData||(this.currentFillData={}),po(this.currentFillData,t)}getAutofillSize(t,e,o){const[n,i,s,r]=t,[l,a,h,c]=e;switch(o){case"up":return n-l;case"down":return h-s;case"left":return i-a;case"right":return c-r;default:return null}}getDragArea(t,e,o){const[n,i,s,r]=t,[l,a,h,c]=e;switch(o){case"up":return[l,a,n-1,r];case"down":return[s+1,i,h,r];case"left":return[l,a,s,i-1];case"right":return[n,r+1,h,c];default:return null}}getFarthestCollection(t,e,o,n){const[i,s,r,l]=t,a=["up","down"].indexOf(o)>-1,h=a?r:l,c=a?i:s,d=this.getAutofillSize(t,e,o),u=a?r-i+1:l-s+1,g=Math.floor(d/u)*u,f=d-g;let m=null,p=null,w=null;switch(o){case"up":m="includesVertically",w=h-f+1;break;case"left":m="includesHorizontally",w=h-f+1;break;case"down":m="includesVertically",w=c+f-1;break;case"right":m="includesHorizontally",w=c+f-1;break;default:}return k(n,(t=>{t[m](w)&&t.isFarther(p,o)&&(p=t)})),p}recreateAfterDataPopulation(t){if(!this.currentFillData)return;const e=this.getRangeFromChanges(t),o=this.currentFillData.foundMergedCells,n=this.currentFillData.dragDirection,i=(t,o)=>{switch(n){case"up":return t.row-o>=e.from.row;case"down":return t.row+t.rowspan-1+o<=e.to.row;case"left":return t.col-o>=e.from.column;case"right":return t.col+t.colspan-1+o<=e.to.column;default:return null}};let s=0,r=null,l=1;do{for(let t=0;t<o.length;t+=1){if(r=o[t],s=l*this.currentFillData.cycleLength,i(r,s))switch(n){case"up":this.plugin.mergedCellsCollection.add({row:r.row-s,rowspan:r.rowspan,col:r.col,colspan:r.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:r.row+s,rowspan:r.rowspan,col:r.col,colspan:r.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:r.row,rowspan:r.rowspan,col:r.col-s,colspan:r.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:r.row,rowspan:r.rowspan,col:r.col+s,colspan:r.colspan});break;default:}t===o.length-1&&(l+=1)}}while(i(r,s));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(t){const e={min:null,max:null},o={min:null,max:null};return k(t,(t=>{const n=t[0],i=this.plugin.hot.propToCol(t[1]);(null===e.min||n<e.min)&&(e.min=n),(null===e.max||n>e.max)&&(e.max=n),(null===o.min||i<o.min)&&(o.min=i),(null===o.max||i>o.max)&&(o.max=i)})),{from:{row:e.min,column:o.min},to:{row:e.max,column:o.max}}}dragAreaOverlapsCollections(t,e,o){const n=this.getDragArea(t,e,o),[i,s,r,l]=n,a=this.plugin.hot._createCellCoords(i,s),h=this.plugin.hot._createCellCoords(r,l),c=this.plugin.hot._createCellRange(a,a,h);return!!this.mergedCellsCollection.getWithinRange(c,!0)}}var NO=PO;class _O{constructor(t){this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}snapDelta(t,e,o){const n=e.to,i=n.row+t.row,s=n.col+t.col;t.row?this.jumpOverMergedCell(t,o,i):t.col&&this.jumpOverMergedCell(t,o,s)}jumpOverMergedCell(t,e,o){let n=t.row||t.col,i=null,s=null,r=null;t.row?(i=e.includesVertically(o),s=e.row,r=e.getLastRow()):t.col&&(i=e.includesHorizontally(o),s=e.col,r=e.getLastColumn()),0!==n&&(n>0?i&&o!==s&&(n+=r-o+1):i&&o!==r&&(n-=o-s+1),t.row?t.row=n:t.col&&(t.col=n))}getUpdatedSelectionRange(t,e){return this.hot._createCellRange(t.highlight,t.from,this.hot._createCellCoords(t.to.row+e.row,t.to.col+e.col))}getSelectedMergedCellClassName(t,e,o,n){const i=Math.min(o[0],o[2]),s=Math.min(o[1],o[3]),r=Math.max(o[0],o[2]),l=Math.max(o[1],o[3]);if(void 0===n)return;const a=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(t,e);if(!a)return;const h=this.plugin.mergedCellsCollection.get(t,e);if(!h)return;const c=h.getLastRow(),d=h.getLastColumn(),u=i<=h.row&&s<=h.col&&r>=c&&l>=d;return u?`${this.fullySelectedMergedCellClassName}-${n}`:this.plugin.selectionCalculations.isMergeCellFullySelected(h,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(t,e){const o=[];if(!e||!t)return!1;for(let n=0;n<t.rowspan;n+=1)for(let e=0;e<t.colspan;e+=1)o.push(this.hot._createCellCoords(t.row+n,t.col+e));for(let n=0;n<o.length;n+=1){const t=[];for(let i=0;i<e.length;i+=1)t[i]=e[i].includes(o[n]);if(!t.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const t=[];for(let e=0;e<=7;e+=1)t.push(`${this.fullySelectedMergedCellClassName}-${e}`);return t.push(`${this.fullySelectedMergedCellClassName}-multiple`),t}}var DO=_O;function LO(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const o=t.mergedCellsCollection.get(e[0],e[1]);if(o.row===e[0]&&o.col===e[1]&&o.row+o.rowspan-1===e[2]&&o.col+o.colspan-1===e[3])return this.getTranslatedPhrase(xc)}return this.getTranslatedPhrase(Hc)},callback(){t.toggleMergeOnSelection()},disabled(){const t=this.getSelectedLast();if(!t)return!0;const e=IO.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1});return e||this.selection.isSelectedByCorner()},hidden:!1}}pn.getSingleton().register("beforeMergeCells"),pn.getSingleton().register("afterMergeCells"),pn.getSingleton().register("beforeUnmergeCells"),pn.getSingleton().register("afterUnmergeCells");const VO="mergeCells",BO=150,FO=new WeakMap,WO=VO;class jO extends tv{static get PLUGIN_KEY(){return VO}static get PLUGIN_PRIORITY(){return BO}constructor(t){super(t),FO.set(this,{lastDesiredCoords:null}),this.mergedCellsCollection=null,this.autofillCalculations=null,this.selectionCalculations=null}isEnabled(){return!!this.hot.getSettings()[VO]}enablePlugin(){var t=this;this.enabled||(this.mergedCellsCollection=new OO(this),this.autofillCalculations=new NO(this),this.selectionCalculations=new DO(this),this.addHook("afterInit",(function(){return t.onAfterInit(...arguments)})),this.addHook("modifyTransformStart",(function(){return t.onModifyTransformStart(...arguments)})),this.addHook("afterModifyTransformStart",(function(){return t.onAfterModifyTransformStart(...arguments)})),this.addHook("modifyTransformEnd",(function(){return t.onModifyTransformEnd(...arguments)})),this.addHook("modifyGetCellCoords",(function(){return t.onModifyGetCellCoords(...arguments)})),this.addHook("beforeSetRangeStart",(function(){return t.onBeforeSetRangeStart(...arguments)})),this.addHook("beforeSetRangeStartOnly",(function(){return t.onBeforeSetRangeStart(...arguments)})),this.addHook("beforeSetRangeEnd",(function(){return t.onBeforeSetRangeEnd(...arguments)})),this.addHook("afterIsMultipleSelection",(function(){return t.onAfterIsMultipleSelection(...arguments)})),this.addHook("afterRenderer",(function(){return t.onAfterRenderer(...arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return t.addMergeActionsToContextMenu(...arguments)})),this.addHook("afterGetCellMeta",(function(){return t.onAfterGetCellMeta(...arguments)})),this.addHook("afterViewportRowCalculatorOverride",(function(){return t.onAfterViewportRowCalculatorOverride(...arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return t.onAfterViewportColumnCalculatorOverride(...arguments)})),this.addHook("modifyAutofillRange",(function(){return t.onModifyAutofillRange(...arguments)})),this.addHook("afterCreateCol",(function(){return t.onAfterCreateCol(...arguments)})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol(...arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow(...arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow(...arguments)})),this.addHook("afterChange",(function(){return t.onAfterChange(...arguments)})),this.addHook("beforeDrawBorders",(function(){return t.onBeforeDrawAreaBorders(...arguments)})),this.addHook("afterDrawSelection",(function(){return t.onAfterDrawSelection(...arguments)})),this.addHook("beforeUndoStackChange",((t,e)=>{if("MergeCells"===e)return!1})),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const t=this.hot.getSettings()[VO];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),super.updatePlugin()}ifChromeForceRepaint(){if(!_o())return;const t=[];let e=[];this.mergedCellsCollection.mergedCells.forEach((t=>{const{row:o,rowspan:n}=t;for(let i=o+1;i<o+n;i++)e.push(i)})),e=[...new Set(e)],e.forEach((e=>{const o=this.hot.rowIndexMapper.getRenderableFromVisualIndex(e);this.hot.view._wt.wtOverlays.getOverlays(!0).map((t=>"master"===(null===t||void 0===t?void 0:t.name)?t:t.clone.wtTable)).forEach((e=>{const n=e.getRow(o);n&&(n.style.background=xe(n,"backgroundColor").replace(")",", 0.99)"),t.push(n))}))})),this.hot._registerTimeout((()=>{t.forEach((t=>{t.style.background=xe(t,"backgroundColor").replace(", 0.99)",")")}))}),1)}validateSetting(t){let e=!0;return!!t&&(IO.containsNegativeValues(t)?(ln(IO.NEGATIVE_VALUES_WARNING(t)),e=!1):IO.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?(ln(IO.IS_OUT_OF_BOUNDS_WARNING(t)),e=!1):IO.isSingleCell(t)?(ln(IO.IS_SINGLE_CELL(t)),e=!1):IO.containsZeroSpan(t)&&(ln(IO.ZERO_SPAN_WARNING(t)),e=!1),e)}generateFromSettings(t){if(Array.isArray(t)){const e=[];if(k(t,(t=>{if(!this.validateSetting(t))return;const o=this.hot._createCellCoords(t.row,t.col),n=this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),i=this.hot._createCellRange(o,o,n);this.mergeRange(i,!0,!0),mi(t.row,t.row+t.rowspan-1,(o=>{mi(t.col,t.col+t.colspan-1,(n=>{!1===(o===t.row&&n===t.col)&&e.push([o,n,null])}))}))})),0===e.length)return;this.hot.setDataAtCell(e)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!e||this.validateSetting(t)}toggleMergeOnSelection(){const t=this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:e,to:o}=t;this.toggleMerge(t),this.hot.selectCell(e.row,e.col,o.row,o.col,!1)}mergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:e,to:o}=t;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,o.row,o.col,!1)}unmergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;const{from:e,to:o}=t;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,o.row,o.col,!1)}mergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=t.getTopStartCorner(),i=t.getBottomEndCorner(),s={row:n.row,col:n.col,rowspan:i.row-n.row+1,colspan:i.col-n.col+1},r=[];let l=null;if(!this.canMergeRange(s,e))return!1;this.hot.runHooks("beforeMergeCells",t,e),mi(0,s.rowspan-1,(t=>{mi(0,s.colspan-1,(e=>{let o=null;r[t]||(r[t]=[]),0===t&&0===e?o=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+t,s.col+e,"hidden",!0),r[t][e]=o}))})),this.hot.setCellMeta(s.row,s.col,"spanned",!0);const a=this.mergedCellsCollection.add(s);return!a||(o?l=[s.row,s.col,r]:this.hot.populateFromArray(s.row,s.col,r,void 0,void 0,this.pluginName),e||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",t,s,e),l)}unmergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.mergedCellsCollection.getWithinRange(t);o&&(this.hot.runHooks("beforeUnmergeCells",t,e),k(o,(t=>{this.mergedCellsCollection.remove(t.row,t.col),mi(0,t.rowspan-1,(e=>{mi(0,t.colspan-1,(o=>{this.hot.removeCellMeta(t.row+e,t.col+o,"hidden"),this.hot.removeCellMeta(t.row+e,t.col+o,"copyable")}))})),this.hot.removeCellMeta(t.row,t.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",t,e),this.hot.render())}toggleMerge(t){const e=this.mergedCellsCollection.get(t.from.row,t.from.col),o=e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col;o?this.unmergeRange(t):this.mergeSelection(t)}merge(t,e,o,n){const i=this.hot._createCellCoords(t,e),s=this.hot._createCellCoords(o,n);this.mergeRange(this.hot._createCellRange(i,i,s))}unmerge(t,e,o,n){const i=this.hot._createCellCoords(t,e),s=this.hot._createCellCoords(o,n);this.unmergeRange(this.hot._createCellRange(i,i,s))}onAfterInit(){this.generateFromSettings(this.hot.getSettings()[VO]),this.hot.render()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid");e.addShortcut({keys:[["Control","m"]],callback:()=>{const t=this.hot.getSelectedRangeLast();t&&!t.isSingleHeader()&&(this.toggleMerge(t),this.hot.render())},runOnlyIf:t=>!t.altKey,group:WO})}unregisterShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(WO)}onAfterIsMultipleSelection(t){if(t){const t=this.mergedCellsCollection.mergedCells,e=this.hot.getSelectedRangeLast();for(let o=0;o<t.length;o+=1)if(e.from.row===t[o].row&&e.from.col===t[o].col&&e.to.row===t[o].row+t[o].rowspan-1&&e.to.col===t[o].col+t[o].colspan-1)return!1}return t}onModifyTransformStart(t){const e=FO.get(this),o=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},i=null;const s=this.hot._createCellCoords(o.highlight.row,o.highlight.col),r=this.mergedCellsCollection.get(s.row,s.col);if(e.lastDesiredCoords||(e.lastDesiredCoords=this.hot._createCellCoords(null,null)),r){const o=this.hot._createCellCoords(r.row,r.col),i=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),l=this.hot._createCellRange(o,o,i);l.includes(e.lastDesiredCoords)||(e.lastDesiredCoords=this.hot._createCellCoords(null,null)),n.row=e.lastDesiredCoords.row?e.lastDesiredCoords.row-s.row:n.row,n.col=e.lastDesiredCoords.col?e.lastDesiredCoords.col-s.col:n.col,t.row>0?n.row=r.row+r.rowspan-1-s.row+t.row:t.row<0&&(n.row=s.row-r.row+t.row),t.col>0?n.col=r.col+r.colspan-1-s.col+t.col:t.col<0&&(n.col=s.col-r.col+t.col)}i=this.hot._createCellCoords(o.highlight.row+n.row,o.highlight.col+n.col);const l=this.mergedCellsCollection.get(i.row,i.col);if(l){const t=this.mergedCellsCollection.getFirstRenderableCoords(l.row,l.col);e.lastDesiredCoords=i,n={row:t.row-s.row,col:t.col-s.col}}0!==n.row&&(t.row=n.row),0!==n.col&&(t.col=n.col)}onModifyTransformEnd(t){const e=this.hot.getSelectedRangeLast(),o=vo(t),n=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=vo(o);const s=this.mergedCellsCollection.getWithinRange(n,!0);do{i=vo(o),this.selectionCalculations.getUpdatedSelectionRange(e,o),k(s,(t=>{this.selectionCalculations.snapDelta(o,e,t)}))}while(o.row!==i.row||o.col!==i.col);t.row=o.row,t.col=o.col}onModifyGetCellCoords(t,e){if(t<0||e<0)return;const o=this.mergedCellsCollection.get(t,e);if(!o)return;const{row:n,col:i,colspan:s,rowspan:r}=o;return[n,i,n+r-1,i+s-1]}addMergeActionsToContextMenu(t){t.items.push({name:"---------"},LO(this))}onAfterRenderer(t,e,o){const n=this.mergedCellsCollection.get(e,o),i=bo(n)?vo(n):void 0;if(bo(i)){const{rowIndexMapper:t,columnIndexMapper:n}=this.hot,{row:s,col:r,colspan:l,rowspan:a}=i,[h,c]=this.translateMergedCellToRenderable(s,a,r,l),d=t.getRenderableFromVisualIndex(e),u=n.getRenderableFromVisualIndex(o),g=h-d+1,f=c-u+1;i.row=t.getNearestNotHiddenIndex(i.row,1),i.col=n.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,g),i.colspan=Math.min(i.colspan,f)}AO(t,i,e,o)}onBeforeSetRangeStart(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}onBeforeSetRangeEnd(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let o=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{o=!1;for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1){const i=this.mergedCellsCollection.mergedCells[n],s=i.getRange();e.expandByRange(s)&&(t.row=e.to.row,t.col=e.to.col,o=!0)}}while(o)}onAfterGetCellMeta(t,e,o){const n=this.mergedCellsCollection.get(t,e);n&&(n.row!==t||n.col!==e?o.copyable=!1:(o.rowspan=n.rowspan,o.colspan=n.colspan))}onAfterViewportRowCalculatorOverride(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}modifyViewportRowStart(t,e){const o=this.hot.rowIndexMapper,n=o.getVisualFromRenderableIndex(t.startRow);for(let i=0;i<e;i+=1){const s=this.mergedCellsCollection.get(n,i);if(bo(s)){const n=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s.row,1));if(n<t.startRow)return t.startRow=n,void this.modifyViewportRowStart(t,e)}}}modifyViewportRowEnd(t,e){const o=this.hot.rowIndexMapper,n=o.getVisualFromRenderableIndex(t.endRow);for(let i=0;i<e;i+=1){const s=this.mergedCellsCollection.get(n,i);if(bo(s)){const n=s.row+s.rowspan-1,i=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1));if(i>t.endRow)return t.endRow=i,void this.modifyViewportRowEnd(t,e)}}}onAfterViewportColumnCalculatorOverride(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}modifyViewportColumnStart(t,e){const o=this.hot.columnIndexMapper,n=o.getVisualFromRenderableIndex(t.startColumn);for(let i=0;i<e;i+=1){const s=this.mergedCellsCollection.get(i,n);if(bo(s)){const n=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s.col,1));if(n<t.startColumn)return t.startColumn=n,void this.modifyViewportColumnStart(t,e)}}}modifyViewportColumnEnd(t,e){const o=this.hot.columnIndexMapper,n=o.getVisualFromRenderableIndex(t.endColumn);for(let i=0;i<e;i+=1){const s=this.mergedCellsCollection.get(i,n);if(bo(s)){const n=s.col+s.colspan-1,i=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1));if(i>t.endColumn)return t.endColumn=i,void this.modifyViewportColumnEnd(t,e)}}}translateMergedCellToRenderable(t,e,o,n){const{rowIndexMapper:i,columnIndexMapper:s}=this.hot;let r,l;r=0===e?i.getNearestNotHiddenIndex(t,1):i.getNearestNotHiddenIndex(t+e-1,-1),l=0===n?s.getNearestNotHiddenIndex(o,1):s.getNearestNotHiddenIndex(o+n-1,-1);const a=t>=0?i.getRenderableFromVisualIndex(r):t,h=o>=0?s.getRenderableFromVisualIndex(l):o;return[a,h]}onModifyAutofillRange(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const o=this.autofillCalculations.getDirection(e,t);let n=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,n,o))return n=e,n;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i?(n=this.autofillCalculations.snapDragArea(e,n,o,i),n):n}onAfterCreateCol(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}onAfterRemoveCol(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}onAfterCreateRow(t,e,o){"auto"!==o&&this.mergedCellsCollection.shiftCollections("down",t,e)}onAfterRemoveRow(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}onAfterChange(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}onBeforeDrawAreaBorders(t,e){if(e&&"area"===e){const e=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getWithinRange(e);k(o,(o=>{e.getBottomEndCorner().row===o.getLastRow()&&e.getBottomEndCorner().col===o.getLastColumn()&&(t[2]=o.row,t[3]=o.col)}))}}onAfterModifyTransformStart(t,e,o){if(!this.enabled)return;const n=this.mergedCellsCollection.get(t.row,t.col);if(!n)return;const i=e>0,s=e<0,r=o<0,l=o>0,a=n.row+n.rowspan-1===this.hot.countRows()-1,h=0===n.row,c=n.col+n.colspan-1===this.hot.countCols()-1,d=0===n.col;(i&&a||s&&h||l&&c||r&&d)&&(t.row=n.row,t.col=n.col)}onAfterDrawSelection(t,e,o,n){if(o)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,o,n)}}function zO(t,e){return function(o,n){const[,...i]=o,[,...s]=n;return function o(n){const r=t[n],l=e[n],a=i[n],h=s[n],c=l.multiColumnSorting,d=c.compareFunctionFactory?c.compareFunctionFactory:Ky(l.type),u=d(r,l,c)(a,h);if(u===ky){const t=n+1;if("undefined"!==typeof e[t])return o(t)}return u}(0)}}function UO(){ln(j`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const $O="sort";function GO(t,e,o){const n=[];return!1===o||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push(`${$O}-${t.getIndexOfColumnInSortQueue(e)+1}`),n}function YO(t){const e=t.className.split(" "),o=new RegExp(`^${$O}-[0-9]{1,2}$`);return e.filter((t=>o.test(t)))}const KO="multiColumnSorting",XO=170,qO="columnSorting",QO=KO;Gy(KO,zO);class JO extends eS{static get PLUGIN_KEY(){return KO}static get PLUGIN_PRIORITY(){return XO}constructor(t){super(t),this.pluginKey=KO}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[qO]&&UO(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();-1===t.row&&t.col>=0&&this.sort(this.getNextSortConfig(t.col,Jy))},runOnlyIf:()=>{var t;return null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},group:QO})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(QO)}sort(t){super.sort(t)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(t){return super.getSortConfig(t)}setSortConfig(t){super.setSortConfig(t)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}updateHeaderClasses(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];super.updateHeaderClasses(t,...o),ue(t,YO(t)),!1!==this.enabled&&de(t,GO(...o))}onUpdateSettings(t){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[qO]&&UO(),super.onUpdateSettings(t)}onAfterOnCellMouseDown(t,e){!1!==by(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,Jy))):this.sort(this.getColumnNextConfig(e.col)))}}const ZO="multipleSelectionHandles",tP=160;class eP extends tv{static get PLUGIN_KEY(){return ZO}static get PLUGIN_PRIORITY(){return tP}constructor(t){super(t),this.dragged=[],this.eventManager=null,this.lastSetCell=null}isEnabled(){return jo()}enablePlugin(){this.enabled||(this.eventManager||(this.eventManager=new On(this)),this.registerListeners(),super.enablePlugin())}registerListeners(){const t=this,{rootElement:e}=this.hot;function o(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;const o=t.dragged.indexOf(e);if(-1===o)return!1;0===o?t.dragged=t.dragged.slice(0,1):1===o&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(e,"touchstart",(e=>{let o;return ce(e.target,"topSelectionHandle-HitArea")?(o=t.hot.getSelectedRangeLast(),t.dragged.push("top"),t.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},e.preventDefault(),!1):ce(e.target,"bottomSelectionHandle-HitArea")?(o=t.hot.getSelectedRangeLast(),t.dragged.push("bottom"),t.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(e,"touchend",(e=>ce(e.target,"topSelectionHandle-HitArea")?(o.call(t,"top"),t.touchStartRange=void 0,e.preventDefault(),!1):ce(e.target,"bottomSelectionHandle-HitArea")?(o.call(t,"bottom"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0)),this.eventManager.addEventListener(e,"touchmove",(e=>{const{rootDocument:o}=this.hot;let n,i,s,r,l,a;if(0===t.dragged.length)return;const h=o.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY);h&&h!==t.lastSetCell&&("TD"!==h.nodeName&&"TH"!==h.nodeName||(n=t.hot.getCoords(h),-1===n.col&&(n.col=0),i=t.hot.getSelectedRangeLast(),s=i.getWidth(),r=i.getHeight(),l=i.getDirection(),1===s&&1===r&&t.hot.selection.setRangeEnd(n),a=t.getCurrentRangeCoords(i,n,t.touchStartRange.direction,l,t.dragged[0]),null!==a.start&&t.hot.selection.setRangeStart(a.start),t.hot.selection.setRangeEnd(a.end),t.lastSetCell=h),e.preventDefault())}))}getCurrentRangeCoords(t,e,o,n,i){const s=t.getTopStartCorner(),r=t.getBottomEndCorner(),l=t.getBottomStartCorner(),a=t.getTopEndCorner();let h={start:null,end:null};switch(o){case"NE-SW":switch(n){case"NE-SW":case"NW-SE":h="top"===i?{start:this.hot._createCellCoords(e.row,t.highlight.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,s.col)};break;case"SE-NW":"bottom"===i&&(h={start:this.hot._createCellCoords(r.row,e.col),end:this.hot._createCellCoords(e.row,s.col)});break;default:break}break;case"NW-SE":switch(n){case"NE-SW":"top"===i?h={start:e,end:l}:h.end=e;break;case"NW-SE":"top"===i?h={start:e,end:r}:h.end=e;break;case"SE-NW":"top"===i?h={start:e,end:s}:h.end=e;break;case"SW-NE":"top"===i?h={start:e,end:a}:h.end=e;break;default:break}break;case"SW-NE":switch(n){case"NW-SE":h="bottom"===i?{start:this.hot._createCellCoords(e.row,s.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(s.row,e.col),end:this.hot._createCellCoords(e.row,r.col)};break;case"SW-NE":h="top"===i?{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,r.col)}:{start:this.hot._createCellCoords(e.row,s.col),end:this.hot._createCellCoords(s.row,e.col)};break;case"SE-NW":"bottom"===i?h={start:this.hot._createCellCoords(e.row,a.col),end:this.hot._createCellCoords(s.row,e.col)}:"top"===i&&(h={start:l,end:e});break;default:break}break;case"SE-NW":switch(n){case"NW-SE":case"NE-SW":case"SW-NE":"top"===i&&(h.end=e);break;case"SE-NW":"top"===i?h.end=e:h={start:e,end:s};break;default:break}break;default:break}return h}isDragged(){return this.dragged.length>0}}function oP(){let{label:t="",colspan:e=1,origColspan:o=1,collapsible:n=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:r=!1,isRoot:l=!1,isPlaceholder:a=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:t,colspan:e,origColspan:o,collapsible:n,isCollapsed:s,crossHiddenColumns:i,isHidden:r,isRoot:l,isPlaceholder:a}}function nP(){return{label:"",isPlaceholder:!0}}function iP(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const o=[];if(0===e)return o;k(t,(t=>{const n=[];let i=0;o.push(n),k(t,(t=>{const o=oP();if(bo(t)){const{label:e,colspan:n}=t;o.label=z(e),"number"===typeof n&&n>1&&(o.colspan=n,o.origColspan=n)}else o.label=z(t);i+=o.origColspan;let s=!1;if(i>=e&&(o.colspan=o.origColspan-(i-e),o.origColspan=o.colspan,s=!0),n.push(o),o.colspan>1)for(let e=0;e<o.colspan-1;e++)n.push(nP());return!s}))}));const n=Math.max(...A(o,(t=>t.length)));return k(o,(t=>{if(t.length<n){const e=A(new Array(n-t.length),(()=>oP()));t.splice(t.length,0,...e)}})),o}function sP(t,e,o){rP(t,e),e.set(t,o)}function rP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lP(t,e){var o=cP(t,e,"get");return aP(t,o)}function aP(t,e){return e.get?e.get.call(t):e.value}function hP(t,e,o){var n=cP(t,e,"set");return dP(t,n,o),o}function cP(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function dP(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}const uP=["label","collapsible"];var gP=new WeakMap,fP=new WeakMap,mP=new WeakMap;class pP{constructor(){sP(this,gP,{writable:!0,value:[]}),sP(this,fP,{writable:!0,value:0}),sP(this,mP,{writable:!0,value:1/0})}setColumnsLimit(t){hP(this,mP,t)}setData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];hP(this,gP,iP(t,lP(this,mP))),hP(this,fP,lP(this,gP).length)}getData(){return lP(this,gP)}mergeWith(t){k(t,(t=>{let{row:e,col:o,...n}=t;const i=this.getHeaderSettings(e,o);null!==i&&po(i,n,uP)}))}map(t){k(lP(this,gP),(e=>{k(e,(e=>{const o=t({...e});bo(o)&&po(e,o,uP)}))}))}getHeaderSettings(t,e){var o;if(t>=lP(this,fP)||t<0)return null;const n=lP(this,gP)[t];return e>=n.length?null:null!==(o=n[e])&&void 0!==o?o:null}getHeadersSettings(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const n=[];if(t>=lP(this,fP)||t<0)return n;const i=lP(this,gP)[t];let s=0;for(let r=e;r<i.length;r++){const t=i[r];if(t.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=t.colspan,n.push(t),t.colspan>1&&(r+=t.colspan-1),s===o)break;if(s>o)throw new Error("The last column settings cannot overlap the other header layers")}return n}getLayersCount(){return lP(this,fP)}getColumnsCount(){return lP(this,fP)>0?lP(this,gP)[0].length:0}clear(){hP(this,gP,[]),hP(this,fP,0)}}function wP(t,e,o){return e=CP(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function CP(t){var e=vP(t,"string");return"symbol"===typeof e?e:String(e)}function vP(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const yP="DF-pre-order";function SP(t,e){let o=t.call(e,this);for(let n=0;n<this.childs.length;n++){if(!1===o)return!1;o=SP.call(this.childs[n],t,e)}return o}const bP="DF-post-order";function RP(t,e){for(let o=0;o<this.childs.length;o++){const n=RP.call(this.childs[o],t,e);if(!1===n)return!1}return t.call(e,this)}const EP="BF";function MP(t,e){const o=[this];function n(){if(0===o.length)return;const i=o.shift();o.push(...i.childs),!1!==t.call(e,i)&&n()}n()}const TP=EP,HP=new Map([[yP,SP],[bP,RP],[EP,MP]]);class xP{constructor(t){wP(this,"data",{}),wP(this,"parent",null),wP(this,"childs",[]),this.data=t}addChild(t){t.parent=this,this.childs.push(t)}cloneTree(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const e=new xP({...t.data});for(let o=0;o<t.childs.length;o++)e.addChild(this.cloneTree(t.childs[o]));return e}replaceTreeWith(t){this.data={...t.data},this.childs=[];for(let e=0;e<t.childs.length;e++)this.addChild(t.childs[e])}walkDown(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:TP;if(!HP.has(e))throw new Error(`Traversal strategy "${e}" does not exist`);HP.get(e).call(this,t,this)}walkUp(t){const e=this,o=n=>{const i=t.call(e,n);!1!==i&&null!==n.parent&&o(n.parent)};o(this)}}function IP(t,e,o){AP(t,e),e.set(t,o)}function AP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kP(t,e){var o=NP(t,e,"get");return OP(t,o)}function OP(t,e){return e.get?e.get.call(t):e.value}function PP(t,e,o){var n=NP(t,e,"set");return _P(t,n,o),o}function NP(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function _P(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var DP=new WeakMap,LP=new WeakMap,VP=new WeakMap;class BP{constructor(t){IP(this,DP,{writable:!0,value:new Map}),IP(this,LP,{writable:!0,value:new Map}),IP(this,VP,{writable:!0,value:null}),PP(this,VP,t)}getRoots(){return Array.from(kP(this,DP).values())}getRootByColumn(t){let e;return kP(this,LP).has(t)&&(e=kP(this,DP).get(kP(this,LP).get(t))),e}getNode(t,e){const o=this.getRootByColumn(e);if(!o)return;const n=e-kP(this,LP).get(e);let i,s=0;return o.walkDown((o=>{const{data:{origColspan:r,headerLevel:l}}=o;if(t===l){if(n>=s&&n<=s+r-1)return i=o,i.data.isRoot=e===i.data.columnIndex,!1;s+=r}})),i}rebuildTreeIndex(){let t=0;kP(this,LP).clear(),k(kP(this,DP),(e=>{let[,{data:{colspan:o}}]=e;for(let n=t;n<t+o;n++)kP(this,LP).set(n,t);t+=o}))}buildTree(){this.clear();const t=kP(this,VP).getColumnsCount();let e=0;while(e<t){const t=kP(this,VP).getHeaderSettings(0,e),o=new xP;kP(this,DP).set(e,o),this.buildLeaves(o,e,0,t.origColspan),e+=t.origColspan}this.rebuildTreeIndex()}buildLeaves(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=kP(this,VP).getHeadersSettings(o,e,n);o+=1,k(i,(n=>{const i={...n,headerLevel:o-1,columnIndex:e};let s;1===o?(t.data=i,s=t):(s=new xP(i),t.addChild(s)),o<kP(this,VP).getLayersCount()&&this.buildLeaves(s,e,o,n.origColspan),e+=n.origColspan}))}clear(){kP(this,DP).clear(),kP(this,LP).clear()}}function FP(t,e){t.walkDown((t=>{let{data:o,childs:n}=t;if(!o.isHidden&&(e(o.columnIndex),0===n.length))for(let i=1;i<o.colspan;i++)e(o.columnIndex+i)}))}function WP(t,e){let{childs:o}=t;if(0!==o.length)return o[0].data[e]}function jP(t){return WP(t,"origColspan")===t.data.origColspan}function zP(t){const{data:e,childs:o}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};const n=jP(t);if(n)return zP(o[0]);e.isCollapsed=!1;const i=o.slice(1),s=new Set;let r=0;if(i.length>0)k(i,(t=>{t.replaceTreeWith(t.data.clonedTree),t.data.clonedTree=null;const e=t.data;r+=e.colspan,FP(t,(t=>{s.add(t)}))}));else{const{colspan:t,origColspan:o,columnIndex:n}=e;r=o-t;for(let e=1;e<o;e++)s.add(n+e)}return t.walkUp((t=>{const{data:e}=t;e.colspan+=r,e.colspan>=e.origColspan?(e.colspan=e.origColspan,e.isCollapsed=!1):jP(t)&&(e.isCollapsed=WP(t,"isCollapsed"))})),{rollbackModification:()=>UP(t),affectedColumns:Array.from(s),colspanCompensation:r}}function UP(t){var e;const{data:o,childs:n}=t;if(o.isCollapsed||o.isHidden||o.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};const i=jP(t);if(i)return UP(n[0]);o.isCollapsed=!0;const s=n.slice(1),r=new Set;if(s.length>0)k(s,(t=>{FP(t,(t=>{r.add(t)})),t.data.clonedTree=t.cloneTree(),t.walkDown((t=>{let{data:e}=t;e.isHidden=!0}))}));else{const{origColspan:t,columnIndex:e}=o;for(let o=1;o<t;o++){const t=e+o;r.add(t)}}const l=o.colspan-(null!==(e=WP(t,"colspan"))&&void 0!==e?e:1);return t.walkUp((t=>{const{data:e}=t;e.colspan-=l,e.colspan<=1?(e.colspan=1,e.isCollapsed=!0):jP(t)&&(e.isCollapsed=WP(t,"isCollapsed"))})),{rollbackModification:()=>zP(t),affectedColumns:Array.from(r),colspanCompensation:l}}function $P(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(j`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:o}=t.data;if(o.includes(e))return;let n=!1;t.walkUp((t=>{const{data:{collapsible:e}}=t;if(e)return n=!0,!1})),n||t.walkUp((t=>{const{data:o}=t;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0}))}function GP(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(j`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:o}=t.data;if(!o.includes(e))return;let n=!1;t.walkUp((t=>{const{data:{collapsible:e}}=t;if(e)return n=!0,!1})),n||t.walkUp((t=>{const{data:o}=t;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1}))}const YP=new Map([["collapse",UP],["expand",zP],["hide-column",$P],["show-column",GP]]);function KP(t,e,o){if(!YP.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return YP.get(t)(e,o)}function XP(t){const e=[];return k(t,(t=>{t.walkDown((t=>{const o=t.data,{origColspan:n,columnIndex:i,headerLevel:s,crossHiddenColumns:r}=o,l=QP(e,s);let a=!1;for(let e=i;e<i+n;e++){const t=r.includes(e);if(t||a)l.push(nP(o));else{const t=qP(o);t.isRoot=!0,l.push(t),a=!0}}}))})),e}function qP(t){const{crossHiddenColumns:e,...o}=oP(t);return o}function QP(t,e){let o;return Array.isArray(t[e])?o=t[e]:(o=[],t[e]=o),o}function JP(t,e,o){ZP(t,e),e.set(t,o)}function ZP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tN(t,e,o){var n=nN(t,e,"set");return eN(t,n,o),o}function eN(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function oN(t,e){var o=nN(t,e,"get");return iN(t,o)}function nN(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function iN(t,e){return e.get?e.get.call(t):e.value}var sN=new WeakMap,rN=new WeakMap,lN=new WeakMap;class aN{constructor(){JP(this,sN,{writable:!0,value:new pP}),JP(this,rN,{writable:!0,value:new BP(oN(this,sN))}),JP(this,lN,{writable:!0,value:[[]]})}setState(t){oN(this,sN).setData(t);let e=!1;try{oN(this,rN).buildTree()}catch(o){oN(this,rN).clear(),oN(this,sN).clear(),e=!0}return tN(this,lN,XP(oN(this,rN).getRoots())),e}setColumnsLimit(t){oN(this,sN).setColumnsLimit(t)}mergeStateWith(t){const e=A(t,(t=>{let{row:e,...o}=t;return{row:e<0?this.rowCoordsToLevel(e):e,...o}}));oN(this,sN).mergeWith(e),oN(this,rN).buildTree(),tN(this,lN,XP(oN(this,rN).getRoots()))}mapState(t){oN(this,sN).map(t),oN(this,rN).buildTree(),tN(this,lN,XP(oN(this,rN).getRoots()))}mapNodes(t){return x(oN(this,rN).getRoots(),((e,o)=>(o.walkDown((o=>{const n=t(o.data);void 0!==n&&e.push(n)})),e)),[])}triggerNodeModification(t,e,o){e<0&&(e=this.rowCoordsToLevel(e));const n=oN(this,rN).getNode(e,o);let i;return n&&(i=KP(t,n,o),tN(this,lN,XP(oN(this,rN).getRoots()))),i}triggerColumnModification(t,e){return this.triggerNodeModification(t,-1,e)}rowCoordsToLevel(t){if(t>=0)return null;const e=t+Math.max(this.getLayersCount(),1);return e<0?null:e}levelToRowCoords(t){if(t<0)return null;const e=t-Math.max(this.getLayersCount(),1);return e>=0?null:e}getHeaderSettings(t,e){var o,n;return t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount()?null:null!==(o=null===(n=oN(this,lN)[t])||void 0===n?void 0:n[e])&&void 0!==o?o:null}getHeaderTreeNodeData(t,e){const o=this.getHeaderTreeNode(t,e);return o?{...o.data}:null}getHeaderTreeNode(t,e){if(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())return null;const o=oN(this,rN).getNode(t,e);return o||null}findTopMostEntireHeaderLevel(t){var e;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;const n=o-t+1;let i=!1,s=null;for(let r=t;r<=o;r++){const e=oN(this,rN).getRootByColumn(r);if(!e)break;i=!0,e.walkDown((e=>{const{columnIndex:i,headerLevel:r,origColspan:l,isHidden:a}=e.data;a||l<=n&&i>=t&&i+l-1<=o&&(null===s||r<s)&&(s=r)}),yP)}return i&&null===s?-1:this.levelToRowCoords(null!==(e=s)&&void 0!==e?e:0)}findLeftMostColumnIndex(t,e){var o;const{isRoot:n}=null!==(o=this.getHeaderSettings(t,e))&&void 0!==o?o:{isRoot:!0};if(n)return e;let i=e-1;while(i>=0){var s;const{isRoot:e}=null!==(s=this.getHeaderSettings(t,i))&&void 0!==s?s:{isRoot:!0};if(e)break;i-=1}return i}findRightMostColumnIndex(t,e){var o;const{isRoot:n,origColspan:i}=null!==(o=this.getHeaderSettings(t,e))&&void 0!==o?o:{isRoot:!0,origColspan:1};if(n)return e+i-1;let s=e+1;while(s<this.getColumnsCount()){var r;const{isRoot:e}=null!==(r=this.getHeaderSettings(t,s))&&void 0!==r?r:{isRoot:!0};if(e)break;s+=1}return s-1}getLayersCount(){return oN(this,sN).getLayersCount()}getColumnsCount(){return oN(this,sN).getColumnsCount()}clear(){tN(this,lN,[]),oN(this,sN).clear(),oN(this,rN).clear()}}function hN(t,e,o){return e=cN(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function cN(t){var e=dN(t,"string");return"symbol"===typeof e?e:String(e)}function dN(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class uN{constructor(t,e){hN(this,"hot",void 0),hN(this,"nestedHeaderSettingsGetter",void 0),hN(this,"layersCount",0),hN(this,"container",void 0),hN(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=e,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(t){return this.layersCount=t,this}getWidth(t){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length;this.widthsMap.clear();for(let o=0;o<e;o++){const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),n=this.hot.toPhysicalColumn(e);this.widthsMap.setValueAtIndex(n,t[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(t){const{rootDocument:e,columnIndexMapper:o}=this.hot,n=e.createDocumentFragment(),i=e.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,r=o.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const t=e.createElement("tr");for(let n=0;n<r;n++){let i=o.getVisualFromRenderableIndex(n);null===i&&(i=n);const r=e.createElement("th"),a=this.nestedHeaderSettingsGetter(l,i);if(a&&(!a.isPlaceholder||a.isHidden)){let e=a.label;s&&(e+='<button class="changeType"></button>'),Ce(r,e),r.colSpan=a.colspan,t.appendChild(r)}}i.appendChild(t)}n.appendChild(i),t.appendChild(n)}clear(){this.widthsMap.clear(),this.container=null}}var gN=uN;function fN(t,e,o){return e=mN(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function mN(t){var e=pN(t,"string");return"symbol"===typeof e?e:String(e)}function pN(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function wN(t,e,o){CN(t,e),e.set(t,o)}function CN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vN(t,e,o){var n=bN(t,e,"set");return yN(t,n,o),o}function yN(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function SN(t,e){var o=bN(t,e,"get");return RN(t,o)}function bN(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function RN(t,e){return e.get?e.get.call(t):e.value}const EN="nestedHeaders",MN=280;var TN=new WeakMap,HN=new WeakMap,xN=new WeakMap,IN=new WeakMap;class AN extends tv{constructor(){super(...arguments),wN(this,TN,{writable:!0,value:new aN}),wN(this,HN,{writable:!0,value:null}),wN(this,xN,{writable:!0,value:null}),wN(this,IN,{writable:!0,value:!1}),fN(this,"ghostTable",new gN(this.hot,((t,e)=>this.getHeaderSettings(t,e)))),fN(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return EN}static get PLUGIN_PRIORITY(){return MN}isEnabled(){return!!this.hot.getSettings()[EN]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();Array.isArray(e)&&Array.isArray(e[0])||ln(j`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",(()=>this.onInit())),this.addHook("afterLoadData",(function(){return t.onAfterLoadData(...arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown(...arguments)})),this.addHook("afterOnCellMouseDown",(function(){return t.onAfterOnCellMouseDown(...arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return t.onBeforeOnCellMouseOver(...arguments)})),this.addHook("beforeOnCellMouseUp",(function(){return t.onBeforeOnCellMouseUp(...arguments)})),this.addHook("beforeSelectionHighlightSet",(function(){return t.onBeforeSelectionHighlightSet(...arguments)})),this.addHook("modifyTransformStart",(function(){return t.onModifyTransformStart(...arguments)})),this.addHook("afterSelection",(()=>this.updateFocusHighlightPosition())),this.addHook("beforeViewportScrollHorizontally",(function(){return t.onBeforeViewportScrollHorizontally(...arguments)})),this.addHook("afterGetColumnHeaderRenderers",(t=>this.onAfterGetColumnHeaderRenderers(t))),this.addHook("modifyColWidth",(function(){return t.onModifyColWidth(...arguments)})),this.addHook("modifyColumnHeaderValue",(function(){return t.onModifyColumnHeaderValue(...arguments)})),this.addHook("beforeHighlightingColumnHeader",(function(){return t.onBeforeHighlightingColumnHeader(...arguments)})),this.addHook("beforeCopy",(function(){return t.onBeforeCopy(...arguments)})),this.addHook("beforeSelectColumns",(function(){return t.onBeforeSelectColumns(...arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return t.onAfterViewportColumnCalculatorOverride(...arguments)})),this.addHook("modifyFocusedElement",(function(){return t.onModifyFocusedElement(...arguments)})),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",(()=>this.updateFocusHighlightPosition())),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",(()=>this.updateFocusHighlightPosition())),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:t}=this.hot.getSettings();SN(this,TN).setColumnsLimit(this.hot.countCols()),Array.isArray(t)&&(this.detectedOverlappedHeaders=SN(this,TN).setState(t)),this.detectedOverlappedHeaders&&ln(j`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(((t,e)=>{const o=!0===t?"hide-column":"show-column";SN(this,TN).triggerColumnModification(o,e)})),!SN(this,HN)&&this.enabled&&vN(this,HN,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((t=>{t.forEach((t=>{let{op:e,index:o,newValue:n}=t;if("replace"===e){const t=!0===n?"hide-column":"show-column";SN(this,TN).triggerColumnModification(t,o)}})),this.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),SN(this,TN).clear(),SN(this,HN).unsubscribe(),vN(this,HN,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return SN(this,TN)}getLayersCount(){return SN(this,TN).getLayersCount()}getHeaderSettings(t,e){return SN(this,TN).getHeaderSettings(t,e)}clearColspans(){if(!this.hot.view)return;const{_wt:t}=this.hot.view,e=t.getSetting("columnHeaders").length,o=t.wtTable.THEAD,n=t.wtOverlays.topOverlay.clone.wtTable.THEAD,i=t.wtOverlays.topInlineStartCornerOverlay?t.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<e;s++){const t=o.childNodes[s];if(!t)break;const e=n.childNodes[s],r=i?i.childNodes[s]:null;for(let o=0,n=t.childNodes.length;o<n;o++)t.childNodes[o].removeAttribute("colspan"),ue(t.childNodes[o],"hiddenHeader"),e&&e.childNodes[o]&&(e.childNodes[o].removeAttribute("colspan"),ue(e.childNodes[o],"hiddenHeader")),i&&r&&r.childNodes[o]&&(r.childNodes[o].removeAttribute("colspan"),ue(r.childNodes[o],"hiddenHeader"))}}headerRendererFactory(t){var e=this;const o=this.hot.view._wt.getSetting("fixedColumnsStart");return(n,i)=>{var s;const{columnIndexMapper:r,view:l}=this.hot;let a=r.getVisualFromRenderableIndex(n);null===a&&(a=n),i.removeAttribute("colspan"),ue(i,"hiddenHeader");const{colspan:h,isHidden:c,isPlaceholder:d}=null!==(s=SN(this,TN).getHeaderSettings(t,a))&&void 0!==s?s:{label:""};if(d||c)de(i,"hiddenHeader");else if(h>1){var u,g;const{wtOverlays:t}=l._wt,e=null===(u=t.topInlineStartCornerOverlay)||void 0===u?void 0:u.clone.wtTable.THEAD.contains(i),s=null===(g=t.inlineStartOverlay)||void 0===g?void 0:g.clone.wtTable.THEAD.contains(i),r=e||s?Math.min(h,o-n):h;r>1&&i.setAttribute("colspan",r)}this.hot.view.appendColHeader(a,i,(function(){return e.getColumnHeaderValue(...arguments)}),t)}}getColumnHeaderValue(t,e){var o;const{isHidden:n,isPlaceholder:i}=null!==(o=SN(this,TN).getHeaderSettings(e,t))&&void 0!==o?o:{};return i||n?"":this.hot.getColHeader(t,e)}updateFocusHighlightPosition(){var t;const e=null===(t=this.hot)||void 0===t?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:o}=e,n=o.isHeader()&&o.col>=0;if(n){const t=SN(this,TN).findLeftMostColumnIndex(o.row,o.col),e=this.hot.selection.highlight.getFocus();e.visualCellRange.highlight.col=t,e.visualCellRange.from.col=t,e.visualCellRange.to.col=t,e.commit()}}onBeforeViewportScrollHorizontally(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:o}=e,n=o.isHeader()&&o.col>=0;if(!n)return t;const i=this.hot.view.getFirstFullyVisibleColumn(),s=this.hot.view.getLastFullyVisibleColumn(),r=SN(this,TN).findLeftMostColumnIndex(o.row,o.col),l=SN(this,TN).findRightMostColumnIndex(o.row,o.col);return r<i&&l>s?t:r<i?r:l}onBeforeHighlightingColumnHeader(t,e,o){const n=SN(this,TN).getHeaderTreeNodeData(e,t);if(!n)return t;const{columnCursor:i,selectionType:s,selectionWidth:r}=o,{isRoot:l,colspan:a}=SN(this,TN).getHeaderSettings(e,t);if(s===tu){if(!l)return n.columnIndex}else if(s===Zd&&(a>r-i||!l))return null;return t}onBeforeCopy(t,e,o){let{columnHeadersCount:n}=o;if(0!==n)for(let s=0;s<e.length;s++){const{startRow:o,startCol:n,endRow:r,endCol:l}=e[s],a=r-o+1,h=n-l+1;if(o>=0||1===h)break;for(let e=n;e<=l;e++)for(let s=o;s<=r;s++){var i;const o=a+s,r=e-n;if(0===r)continue;const l=null===(i=SN(this,TN).getHeaderTreeNodeData(s,e))||void 0===i?void 0:i.isRoot;!1===l&&(t[o][r]="")}}}onBeforeOnCellMouseDown(t,e,o,n){const i=this._getHeaderTreeNodeDataByCoords(e);i&&(n.column=!0)}onAfterOnCellMouseDown(t,e){const o=this._getHeaderTreeNodeDataByCoords(e);if(!o)return;vN(this,xN,e.clone()),vN(this,IN,!0);const{selection:n}=this.hot,i=n.isSelected()?n.getSelectedRange().current():null,s=[],{columnIndex:r,origColspan:l}=o,a=!n.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?s.push(i.getTopEndCorner().col,r,e.row):e.col>i.from.col?s.push(i.getTopStartCorner().col,r+l-1,e.row):s.push(r,r+l-1,e.row):(sn(t)||nn(t)&&a)&&s.push(r,r+l-1,e.row),n.selectColumns(...s)}onBeforeOnCellMouseOver(t,e,o,n){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:s,origColspan:r}=i,l=this.hot.getSelectedRangeLast(),a=l.getTopStartCorner(),h=l.getBottomEndCorner(),{from:c}=l;n.column=!0,n.cell=!0;const d=[],u=Ci(e.row,-1/0,-1);e.col<c.col?d.push(h.col,s,u):e.col>c.col?d.push(a.col,s+r-1,u):d.push(s,s+r-1,u),this.hot.selection.selectColumns(...d)}onBeforeOnCellMouseUp(){vN(this,IN,!1)}onBeforeSelectionHighlightSet(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!SN(this,IN)||!t)return;const e=this.hot.getSelectedRangeLast(),o=e.getTopStartCorner().col,n=e.getBottomEndCorner().col,{columnIndex:i,origColspan:s}=SN(this,TN).getHeaderTreeNodeData(SN(this,xN).row,SN(this,xN).col);if(e.setHighlight(SN(this,xN)),s>e.getWidth()||i<o||i+s-1>n){const t=SN(this,TN).findTopMostEntireHeaderLevel(Ci(o,i,i+s-1),Ci(n,i,i+s-1));e.highlight.row=t,e.highlight.col=e.from.col}}onModifyTransformStart(t){const{highlight:e}=this.hot.getSelectedRangeLast(),o=this.hot._createCellCoords(e.row+t.row,e.col+t.col),n=o.isHeader()&&o.col>=0;if(!n)return;const i=SN(this,TN).findLeftMostColumnIndex(o.row,o.col),s=SN(this,TN).findRightMostColumnIndex(o.row,o.col);if(t.col<0){const o=e.col>=i&&e.col<=s?i-1:s,n=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);t.col=null===n?-this.hot.view.countRenderableColumnsInRange(0,e.col):-Math.max(this.hot.view.countRenderableColumnsInRange(n,e.col)-1,1)}else if(t.col>0){const o=e.col>=i&&e.col<=s?s+1:i,n=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);t.col=null===n?this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(e.col,n)-1,1)}}onBeforeSelectColumns(t,e){const o=t.row,n=this._getHeaderTreeNodeDataByCoords({row:o,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:o,col:e.col});e.col<t.col?(n&&(t.col=n.columnIndex+n.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(n&&(t.col=n.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}onAfterGetColumnHeaderRenderers(t){t.length=0;for(let e=0;e<SN(this,TN).getLayersCount();e++)t.push(this.headerRendererFactory(e))}onAfterViewportColumnCalculatorOverride(t){const e=SN(this,TN).getLayersCount();let o=t.startColumn,n=!!e;for(let i=0;i<e;i++){const e=SN(this,TN).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(e);if(e>=0&&(n=!1),gi(s)&&s<t.startColumn){o=s;break}}t.startColumn=n?SN(this,TN).getHeaderTreeNodeData(0,o).columnIndex:o}onModifyColWidth(t,e){const o=this.ghostTable.getWidth(e);return t>o?t:o}onModifyColumnHeaderValue(t,e,o){var n;const{label:i}=null!==(n=SN(this,TN).getHeaderTreeNodeData(o,e))&&void 0!==n?n:{label:""};return i}onModifyFocusedElement(t,e){if(t<0)return this.hot.getCell(t,SN(this,TN).findLeftMostColumnIndex(t,e),!0)}onInit(){this.updatePlugin()}onAfterLoadData(t,e){e||this.updatePlugin()}destroy(){vN(this,TN,null),null!==SN(this,HN)&&(SN(this,HN).unsubscribe(),vN(this,HN,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(t){if(!(t.row>=0||t.col<0))return SN(this,TN).getHeaderTreeNodeData(t.row,t.col)}}class kN{constructor(t,e){this.hot=e,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}setData(t){this.data=t}getData(){return this.data}getRawSourceData(){let t=null;return this.plugin.disableCoreAPIModifiers(),t=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),t}updateWithData(t){this.setData(t),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},mi(0,this.data.length-1,(t=>{this.cacheNode(this.data[t],0,null)}))}cacheNode(t,e,o){this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:o,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&k(t.__children,(o=>{this.cacheNode(o,e+1,t)}))}getDataObject(t){return null===t||void 0===t?null:this.cache.rows[t]}readTreeNodes(t,e,o,n){let i=!1,s=e;if(isNaN(s)&&s.end)return s;let r=t;return r||(r={__children:this.data},i=!0,s-=1),null!==o&&void 0!==o&&s===o?{result:r,end:!0}:null!==n&&void 0!==n&&r===n?{result:s,end:!0}:(s+=1,r.__children&&k(r.__children,(t=>{if(this.parentReference.set(t,i?null:r),s=this.readTreeNodes(t,s,o,n),isNaN(s)&&s.end)return!1})),s)}mockParent(){const t=this.mockNode();return t.__children=this.data,t}mockNode(){const t={};return Eo(this.data[0],((e,o)=>{t[o]=null})),t}getRowIndex(t){return null===t||void 0===t?null:this.cache.nodeInfo.get(t).row}getRowIndexWithinParent(t){let e=null;e=isNaN(t)?t:this.getDataObject(t);const o=this.getRowParent(t);return null===o||void 0===o?this.data.indexOf(e):o.__children.indexOf(e)}countAllRows(){const t={__children:this.data};return this.countChildren(t)}countChildren(t){let e=0,o=t;return isNaN(o)||(o=this.getDataObject(o)),o&&o.__children?(k(o.__children,(t=>{e+=1,t.__children&&(e+=this.countChildren(t))})),e):0}getRowParent(t){let e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}getRowObjectParent(t){return t&&"object"===typeof t?this.cache.nodeInfo.get(t).parent:null}getRowLevel(t){let e=null;return e=isNaN(t)?t:this.getDataObject(t),e?this.getRowObjectLevel(e):null}getRowObjectLevel(t){return null===t||void 0===t?null:this.cache.nodeInfo.get(t).level}hasChildren(t){let e=t;return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)}isChild(t){return null!==this.getRowParent(t)}getChild(t,e){var o;return(null===(o=t.__children)||void 0===o?void 0:o[e])||null}isRowHighestLevel(t){return!this.isChild(t)}isParent(t){var e;let o=t;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&0!==(null===(e=o.__children)||void 0===e?void 0:e.length)}addChild(t,e){let o=e;this.hot.runHooks("beforeAddChild",t,o);let n=null;t&&(n=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",n+this.countChildren(t)+1,1);let i=t;t||(i=this.mockParent()),i.__children||(i.__children=[]),o||(o=this.mockNode()),i.__children.push(o),this.rewriteCache();const s=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",t,o)}addChildAtIndex(t,e,o){let n,i=o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",t,i,e),t){const o=this.getRowIndex(t),s=o+e+1;this.hot.runHooks("beforeCreateRow",s,1),t.__children.splice(e,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(s,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",s,1),n=s}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",e,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),n=this.getRowIndex(this.data[e]);i=this.getDataObject(n),this.hot.runHooks("afterAddChild",t,i,e)}addSibling(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const o=this.translateTrimmedRow(t),n=this.getRowParent(o),i=this.getRowIndexWithinParent(o);switch(e){case"below":this.addChildAtIndex(n,i+1,null);break;case"above":this.addChildAtIndex(n,i,null);break;default:break}}detachFromParent(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=null;const n=[];Array.isArray(t)?(mi(t[0],t[2],(t=>{const e=this.translateTrimmedRow(t);n.push(this.getDataObject(e))})),mi(0,n.length-2,(t=>{this.detachFromParent(n[t],!1)})),o=n[n.length-1]):o=t;const i=this.getRowIndex(o),s=this.countChildren(o),r=this.getRowIndexWithinParent(o),l=this.getRowParent(o),a=this.getRowParent(l),h=this.getRowIndex(a);let c=null;if(this.hot.runHooks("beforeDetachChild",l,o),null!==r&&void 0!==r){const t=Array.from(new Array(i+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",i,s+1,t,this.plugin.pluginName),l.__children.splice(r,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,s+1,t,this.plugin.pluginName),a){c=h+this.countChildren(a);const t=this.getChild(a,this.countChildren(a)-1),e=this.getRowIndex(t);this.hot.runHooks("beforeCreateRow",e+1,s+1,this.plugin.pluginName),a.__children.push(o)}else c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c-2,s+1,this.plugin.pluginName),this.data.push(o)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",c-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,o,this.getRowIndex(o)),e&&this.hot.render()}filterData(t,e,o){const n=[];k(o,(t=>{n.push(this.getDataObject(t))})),k(n,(t=>{const e=this.getRowIndexWithinParent(t),o=this.getRowParent(t);null===o?this.data.splice(e,1):o.__children.splice(e,1)})),this.rewriteCache()}spliceData(t,e,o){const n=this.getDataObject(t-1);let i=null,s=t;n&&n.__children&&0===n.__children.length?(i=n,s=0):t<this.countAllRows()&&(i=this.getRowParent(t),s=this.getRowIndexWithinParent(t)),i?o?i.__children.splice(s,e,...o):i.__children.splice(s,e):o?this.data.splice(s,e,...o):this.data.splice(s,e),this.rewriteCache()}syncRowWithRawSource(t){let e=t,o=null;do{o=this.getRowParent(o),null!==o&&(e=o)}while(null!==o);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(e),"__children",e.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(t,e,o,n){const i=e===this.hot.countRows(),s=this.getRowParent(t),r=this.getRowIndexWithinParent(t),l=s.__children.slice(r,r+1),a=t>e;let h=i?this.getRowParent(e-1):this.getRowParent(e);null!==h&&void 0!==h||(h=this.getRowParent(e-1)),null!==h&&void 0!==h||(h=this.getDataObject(e-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(e),h.__children=[]);const c=i||o||n?h.__children.length:this.getRowIndexWithinParent(e),d=s===h;h.__children.splice(c,0,l[0]),s.__children.splice(r+(a&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(h)}translateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}untranslateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(t):t}}var ON=kN;class PN{constructor(t,e){this.hot=e,this.plugin=t}}var NN=PN;class _N extends NN{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(t,e){super(t,e),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(t,e){const o=this.hot.toPhysicalRow(t),n=this.dataManager.getRowLevel(o),i=this.dataManager.getDataObject(o),s=e.getElementsByTagName("DIV")[0],r=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),a=this.hot.getSettings().ariaTags;if(k(l,(t=>{t&&s.removeChild(t)})),de(e,_N.CSS_CLASSES.indicatorContainer),n){const{rootDocument:t}=this.hot,e=r.cloneNode(!0);s.innerHTML="",mi(0,n-1,(()=>{const e=t.createElement("SPAN");de(e,_N.CSS_CLASSES.emptyIndicator),s.appendChild(e)})),s.appendChild(e)}if(this.dataManager.hasChildren(i)){const t=this.hot.rootDocument.createElement("DIV");a&&ge(t,[kt()]),de(e,_N.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(o)?(de(t,`${_N.CSS_CLASSES.button} ${_N.CSS_CLASSES.expandButton}`),a&&ge(e,[Bt(!1)])):(de(t,`${_N.CSS_CLASSES.button} ${_N.CSS_CLASSES.collapseButton}`),a&&ge(e,[Bt(!0)])),s.appendChild(t)}}updateRowHeaderWidth(t){let e=t;e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}var DN=_N;class LN extends NN{constructor(t,e){var o;super(t,e),o=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,t)},shiftStash:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null!==e&&void 0!==e||(e=1/0),k(o.lastCollapsedRows,((i,s)=>{i>=t&&i<e&&(o.lastCollapsedRows[s]=i+n)}))},applyStash:function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];o.collapseMultipleChildren(o.lastCollapsedRows,t),o.lastCollapsedRows=void 0},trimStash:(t,e)=>{mi(t,t+e-1,(t=>{const e=this.lastCollapsedRows.indexOf(t);e>-1&&this.lastCollapsedRows.splice(e,1)}))}}}collapseChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];let i=null,s=null,r=null;return isNaN(t)?(i=t,s=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(t),s=t),this.dataManager.hasChildren(i)&&k(i.__children,(t=>{n.push(this.dataManager.getRowIndex(t))})),r=this.collapseRows(n,!0,!1),o&&this.trimRows(r),e&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(s)&&this.collapsedRows.push(s),r}collapseMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];k(t,(t=>{n.push(...this.collapseChildren(t,!1,!1))})),o&&this.trimRows(n),e&&this.renderAndAdjust()}collapseRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([t],e)}collapseRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=[];return k(t,(t=>{n.push(t),e&&this.collapseChildRows(t,n)})),o&&this.trimRows(n),n}collapseChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){const o=this.dataManager.getDataObject(t);k(o.__children,(t=>{const o=this.dataManager.getRowIndex(t);e.push(o),this.collapseChildRows(o,e)}))}o&&this.trimRows(e)}expandRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([t],e)}expandRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=[];return k(t,(t=>{n.push(t),e&&this.expandChildRows(t,n)})),o&&this.untrimRows(n),n}expandChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){const o=this.dataManager.getDataObject(t);k(o.__children,(t=>{if(!this.isAnyParentCollapsed(t)){const o=this.dataManager.getRowIndex(t);e.push(o),this.expandChildRows(o,e)}}))}o&&this.untrimRows(e)}expandChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];let i=null,s=null,r=null;return isNaN(t)?(i=t,s=this.dataManager.getRowIndex(t)):(i=this.dataManager.getDataObject(t),s=t),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(i)&&k(i.__children,(t=>{const e=this.dataManager.getRowIndex(t);n.push(e)})),r=this.expandRows(n,!0,!1),o&&this.untrimRows(r),e&&this.renderAndAdjust(),r}expandMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];k(t,(t=>{n.push(...this.expandChildren(t,!1,!1))})),o&&this.untrimRows(n),e&&this.renderAndAdjust()}collapseAll(){const t=this.dataManager.getData(),e=[];k(t,(t=>{this.dataManager.hasChildren(t)&&e.push(t)})),this.collapseMultipleChildren(e),this.renderAndAdjust()}expandAll(){const t=this.dataManager.getData(),e=[];k(t,(t=>{this.dataManager.hasChildren(t)&&e.push(t)})),this.expandMultipleChildren(e),this.renderAndAdjust()}trimRows(t){this.hot.batchExecution((()=>{k(t,(t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)}))}),!0)}untrimRows(t){this.hot.batchExecution((()=>{k(t,(t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)}))}),!0)}areChildrenCollapsed(t){let e=isNaN(t)?t:this.dataManager.getDataObject(t),o=!0;return null===e&&(e={__children:this.dataManager.data}),this.dataManager.hasChildren(e)&&k(e.__children,(t=>{const e=this.dataManager.getRowIndex(t);if(!this.plugin.collapsedRowsMap.getValueAtIndex(e))return o=!1,!1})),o}isAnyParentCollapsed(t){let e=t;while(null!==e){e=this.dataManager.getRowParent(e);const t=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(t)>-1)return!0}return!1}toggleState(t,e){if(e.col>=0)return;const o=this.translateTrimmedRow(e.row);ce(t.target,DN.CSS_CLASSES.button)&&(this.areChildrenCollapsed(o)?this.expandChildren(o):this.collapseChildren(o),en(t))}translateTrimmedRow(t){return this.hot.toPhysicalRow(t)}untranslateTrimmedRow(t){return this.hot.toVisualRow(t)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}var VN=LN;const BN=new WeakMap;class FN extends NN{constructor(t,e){super(t,e),BN.set(this,{row_above:(t,e)=>{const o=e[e.length-1];this.dataManager.addSibling(o.start.row,"above")},row_below:(t,e)=>{const o=e[e.length-1];this.dataManager.addSibling(o.start.row,"below")}}),this.dataManager=this.plugin.dataManager}appendOptions(t){const e=[{key:"add_child",name(){return this.getTranslatedPhrase(Yc)},callback:()=>{const t=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),e=this.dataManager.getDataObject(t);this.dataManager.addChild(e)},disabled:()=>{const t=this.hot.getSelectedLast();return!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Kc)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const t=this.hot.getSelectedLast(),e=this.dataManager.translateTrimmedRow(t[0]),o=this.dataManager.getRowParent(e);return!o||!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return mi(0,t.items.length-1,(o=>{if(0===o)return k(e,((e,n)=>{t.items.splice(o+n,0,e)})),!1})),this.modifyRowInsertingOptions(t)}modifyRowInsertingOptions(t){const e=BN.get(this);return mi(0,t.items.length-1,(o=>{const n=e[t.items[o].key];null!==n&&void 0!==n&&(t.items[o].callback=n)})),t}}var WN=FN;class jN{constructor(t){this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}onBeforeRowMove(t,e,o,n){const i=this.displayAPICompatibilityWarning({rows:t,finalIndex:e,dropIndex:o,movePossible:n});if(i)return!1;this.movedToCollapsed=!1;const s=o===this.hot.countRows(),r=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o);let l=!0;const a=t.map((t=>{if(!l)return!1;const e=this.dataManager.translateTrimmedRow(t);return l=this.shouldAllowMoving(e,r),e})),h=-1===a.indexOf(r);if(!l||!h)return!1;const c=this.getBaseParent(a),d=this.getTargetParent(s,r),u=c===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(a,r,u),this.moveRows(a,r,d),this.dataManager.rewriteCache(),this.moveCellsMeta(a,r),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",t,e,o,n,n&&this.isRowOrderChanged(t,e)),this.hot.render(),this.selectCells(t,o),!1}displayAPICompatibilityWarning(t){const{rows:e,finalIndex:o,dropIndex:n,movePossible:i}=t;let s=!1;return $(n)&&(ln(j`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",e,o,n,i,!1),s=!0),s}shouldAllowMoving(t,e){return!(this.dataManager.isParent(t)||this.dataManager.isRowHighestLevel(t)||t===e||0===e)}getBaseParent(t){return this.dataManager.getRowParent(t[0])}getTargetParent(t,e){let o=this.dataManager.getRowParent(t?e-1:e);return null!==o&&void 0!==o||(o=this.dataManager.getRowParent(e-1)),o}shiftCollapsibleParentsLocations(t,e,o){o||(Math.max(...t)<=e?this.collapsingUI.collapsedRowsStash.shiftStash(t[0],e,-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(e,t[0],t.length))}moveRows(t,e,o){const n=e===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender((()=>{t.forEach((t=>{this.dataManager.moveRow(t,e,this.movedToCollapsed,n)}))}))}moveCellsMeta(t,e){const o=[],n=Math.max(...t)<e;t.forEach((t=>{o.push(this.hot.getCellMetaAtRow(t))})),this.hot.spliceCellsMeta(t[0],t.length),this.hot.spliceCellsMeta(e-(n?o.length:0),0,...o)}selectCells(t,e){const o=t.length;let n=0,i=0,s=null,r=null;if(this.movedToCollapsed){let s=null;s=t[o-1]<e?this.dataManager.translateTrimmedRow(e-o):this.dataManager.translateTrimmedRow(e);const r=this.dataManager.getRowParent(null===s?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(r);n=this.dataManager.untranslateTrimmedRow(l),i=n}else t[o-1]<e?(i=e-1,n=i-o+1):(n=e,i=n+o-1);s=this.hot.selection,r=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(n,0)),s.setRangeEnd(this.hot._createCellCoords(i,r),!0)}isRowOrderChanged(t,e){return t.some(((t,o)=>t-o!==e))}}const zN="nestedRows",UN=300,$N=zN,GN=new WeakMap,YN="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";class KN extends tv{static get PLUGIN_KEY(){return zN}static get PLUGIN_PRIORITY(){return UN}constructor(t){super(t),this.dataManager=null,this.headersUI=null,this.collapsedRowsMap=null,GN.set(this,{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1})}isEnabled(){return!!this.hot.getSettings()[zN]}enablePlugin(){var t=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new bh),this.dataManager=new ON(this,this.hot),this.collapsingUI=new VN(this,this.hot),this.headersUI=new DN(this,this.hot),this.contextMenuUI=new WN(this,this.hot),this.rowMoveController=new jN(this),this.addHook("afterInit",(function(){return t.onAfterInit(...arguments)})),this.addHook("beforeViewRender",(function(){return t.onBeforeViewRender(...arguments)})),this.addHook("modifyRowData",(function(){return t.onModifyRowData(...arguments)})),this.addHook("modifySourceLength",(function(){return t.onModifySourceLength(...arguments)})),this.addHook("beforeDataSplice",(function(){return t.onBeforeDataSplice(...arguments)})),this.addHook("filterData",(function(){return t.onFilterData(...arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return t.onAfterContextMenuDefaultOptions(...arguments)})),this.addHook("afterGetRowHeader",(function(){return t.onAfterGetRowHeader(...arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown(...arguments)})),this.addHook("beforeRemoveRow",(function(){return t.onBeforeRemoveRow(...arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow(...arguments)})),this.addHook("beforeAddChild",(function(){return t.onBeforeAddChild(...arguments)})),this.addHook("afterAddChild",(function(){return t.onAfterAddChild(...arguments)})),this.addHook("beforeDetachChild",(function(){return t.onBeforeDetachChild(...arguments)})),this.addHook("afterDetachChild",(function(){return t.onAfterDetachChild(...arguments)})),this.addHook("modifyRowHeaderWidth",(function(){return t.onModifyRowHeaderWidth(...arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow(...arguments)})),this.addHook("beforeRowMove",(function(){return t.onBeforeRowMove(...arguments)})),this.addHook("beforeLoadData",(t=>this.onBeforeLoadData(t))),this.addHook("beforeUpdateData",(t=>this.onBeforeLoadData(t))),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const t=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(t),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();if(-1===t.col&&t.row>=0){const e=this.collapsingUI.translateTrimmedRow(t.row);this.collapsingUI.areChildrenCollapsed(e)?this.collapsingUI.expandChildren(e):this.collapsingUI.collapseChildren(e)}},runOnlyIf:()=>{var t;return null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},group:$N})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup($N)}onBeforeRowMove(t,e,o,n){return this.rowMoveController.onBeforeRowMove(t,e,o,n)}disableCoreAPIModifiers(){const t=GN.get(this);t.skipCoreAPIModifiers=!0}enableCoreAPIModifiers(){const t=GN.get(this);t.skipCoreAPIModifiers=!1}onBeforeOnCellMouseDown(t,e,o){this.collapsingUI.toggleState(t,e,o)}onModifyRowData(t){const e=GN.get(this);if(!e.skipCoreAPIModifiers)return this.dataManager.getDataObject(t)}onModifySourceLength(){const t=GN.get(this);if(!t.skipCoreAPIModifiers)return this.dataManager.countAllRows()}onBeforeDataSplice(t,e,o){const n=GN.get(this);return!(!n.skipCoreAPIModifiers&&!this.dataManager.isRowHighestLevel(t))||(this.dataManager.spliceData(t,e,o),!1)}onFilterData(t,e,o){const n=GN.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(o[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(o[0],null,-1*e),this.dataManager.filterData(t,e,o),n.skipRender=!0,this.dataManager.getData().slice()}onAfterContextMenuDefaultOptions(t){return this.contextMenuUI.appendOptions(t)}onAfterGetRowHeader(t,e){this.headersUI.appendLevelIndicators(t,e)}onModifyRowHeaderWidth(t){return this.headersUI.rowHeaderWidthCache||t}onAfterRemoveRow(t,e,o,n){if(n===this.pluginName)return;const i=GN.get(this);setTimeout((()=>{i.skipRender=null,this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()}),0)}onBeforeRemoveRow(t,e,o){const n=Array.from(o.reduce(((t,e)=>{if(this.dataManager.isParent(e)){const o=this.dataManager.getDataObject(e).__children;return t.add(e),Array.isArray(o)&&o.forEach((e=>t.add(this.dataManager.getRowIndex(e)))),t}return t.add(e)}),new Set));o.length=0,o.push(...n)}onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterAddChild(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterDetachChild(t,e,o){this.collapsingUI.collapsedRowsStash.shiftStash(o,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onAfterCreateRow(){this.dataManager.rewriteCache()}onAfterInit(){this.headersUI.updateRowHeaderWidth()}onBeforeViewRender(t,e){const o=GN.get(this);o.skipRender&&(e.skipRender=!0)}destroy(){super.destroy()}onBeforeLoadData(t){if(!oh(t))return an(YN),this.hot.getSettings()[zN]=!1,void this.disablePlugin();this.dataManager.setData(t),this.dataManager.rewriteCache()}}class XN{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;this.rootWindow=e,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}saveValue(t,e){this.rootWindow.localStorage.setItem(`${this.prefix}_${t}`,JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}loadValue(t,e){const o="undefined"===typeof t?e:t,n=this.rootWindow.localStorage.getItem(`${this.prefix}_${o}`);return null===n?void 0:JSON.parse(n)}reset(t){this.rootWindow.localStorage.removeItem(`${this.prefix}_${t}`)}resetAll(){k(this.savedKeys,((t,e)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[e]}`)})),this.clearSavedKeys()}loadSavedKeys(){const t=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),e="string"===typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}var qN=XN;pn.getSingleton().register("persistentStateSave"),pn.getSingleton().register("persistentStateLoad"),pn.getSingleton().register("persistentStateReset");const QN="persistentState",JN=0;class ZN extends tv{static get PLUGIN_KEY(){return QN}static get PLUGIN_PRIORITY(){return JN}constructor(t){super(t),this.storage=void 0}isEnabled(){return!!this.hot.getSettings()[QN]}enablePlugin(){this.enabled||(this.storage||(this.storage=new qN(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",((t,e)=>this.saveValue(t,e))),this.addHook("persistentStateLoad",((t,e)=>this.loadValue(t,e))),this.addHook("persistentStateReset",(()=>this.resetValue())),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(t,e){e.value=this.storage.loadValue(t)}saveValue(t,e){this.storage.saveValue(t,e)}resetValue(t){"undefined"===typeof t?this.storage.resetAll():this.storage.reset(t)}destroy(){super.destroy()}}const t_="search",e_=190,o_="htSearchResult",n_=function(t,e,o,n,i){t.getCellMeta(e,o).isSearchResult=i},i_=function(t,e,o){return!($(t)||null===t||!t.toLocaleLowerCase||0===t.length)&&(!$(e)&&null!==e&&-1!==e.toString().toLocaleLowerCase(o.locale).indexOf(t.toLocaleLowerCase(o.locale)))};class s_ extends tv{static get PLUGIN_KEY(){return t_}static get PLUGIN_PRIORITY(){return e_}constructor(t){super(t),this.callback=n_,this.queryMethod=i_,this.searchResultClass=o_}isEnabled(){return this.hot.getSettings()[t_]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[t_];this.updatePluginSettings(e),this.addHook("beforeRenderer",(function(){return t.onBeforeRenderer(...arguments)})),super.enablePlugin()}disablePlugin(){var t=this;const e=function(){return t.onBeforeRenderer(...arguments)};this.hot.addHook("beforeRenderer",e),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("beforeRenderer",e)})),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const n=this.hot.countRows(),i=this.hot.countCols(),s=[],r=this.hot;return mi(0,n-1,(n=>{mi(0,i-1,(i=>{const l=this.hot.getDataAtCell(n,i),a=this.hot.getCellMeta(n,i),h=a.search.callback||e,c=a.search.queryMethod||o,d=c(t,l,a);if(d){const t={row:n,col:i,data:l};s.push(t)}h&&h(r,n,i,l,d)}))})),s}getCallback(){return this.callback}setCallback(t){this.callback=t}getQueryMethod(){return this.queryMethod}setQueryMethod(t){this.queryMethod=t}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(t){this.searchResultClass=t}updatePluginSettings(t){bo(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}onBeforeRenderer(t,e,o,n,i,s){const r=s.className||[];let l=[];"string"===typeof r?l=r.split(" "):l.push(...r),this.isEnabled()&&s.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),s.className=l.join(" ")}destroy(){super.destroy()}}const r_="touchScroll",l_=200;class a_ extends tv{static get PLUGIN_KEY(){return r_}static get PLUGIN_PRIORITY(){return l_}static get SETTING_KEYS(){return!0}constructor(t){super(t),this.scrollbars=[],this.clones=[],this.lockedCollection=!1,this.freezeOverlays=!1}isEnabled(){return ns()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",(()=>this.onAfterViewRender())),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",(()=>this.onBeforeTouchScroll())),this.addHook("afterMomentumScroll",(()=>this.onAfterMomentumScroll()))}onAfterViewRender(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:o,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(o),n&&this.scrollbars.push(n),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),n&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}onBeforeTouchScroll(){this.freezeOverlays=!0,k(this.clones,(t=>{de(t,"hide-tween")}))}onAfterMomentumScroll(){this.freezeOverlays=!1,k(this.clones,(t=>{ue(t,"hide-tween"),de(t,"show-tween")})),this.hot._registerTimeout((()=>{k(this.clones,(t=>{ue(t,"show-tween")}))}),400),k(this.scrollbars,(t=>{t.refresh(),t.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}const h_="trimRows",c_=330;class d_ extends tv{static get PLUGIN_KEY(){return h_}static get PLUGIN_PRIORITY(){return c_}constructor(t){super(t),this.trimmedRowsMap=null}isEnabled(){return!!this.hot.getSettings()[h_]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new bh),this.trimmedRowsMap.addLocalHook("init",(()=>this.onMapInit())),super.enablePlugin())}updatePlugin(){const t=this.hot.getSettings()[h_];Array.isArray(t)&&this.hot.batchExecution((()=>{this.trimmedRowsMap.clear(),k(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(t){const e=this.getTrimmedRows(),o=this.isValidConfig(t);let n=e;o&&(n=Array.from(new Set(e.concat(t))));const i=this.hot.runHooks("beforeTrimRow",e,n,o);!1!==i&&(o&&this.hot.batchExecution((()=>{k(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),this.hot.runHooks("afterTrimRow",e,n,o,o&&n.length>e.length))}trimRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.trimRows(e)}untrimRows(t){const e=this.getTrimmedRows(),o=this.isValidConfig(t);let n=e;const i=this.trimmedRowsMap.getValues().slice(),s=t.length>0;o&&s&&(k(t,(t=>{i[t]=!1})),n=x(i,((t,e,o)=>(e&&t.push(o),t)),[]));const r=this.hot.runHooks("beforeUntrimRow",e,n,o&&s);!1!==r&&(o&&s&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",e,n,o&&s,o&&n.length<e.length))}untrimRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.untrimRows(e)}isTrimmed(t){return this.trimmedRowsMap.getValueAtIndex(t)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(t){const e=this.hot.countSourceRows();return t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}onMapInit(){const t=this.hot.getSettings()[h_];Array.isArray(t)&&this.hot.batchExecution((()=>{k(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0)}destroy(){super.destroy()}}const u_="undoRedo",g_="undoRedo";function f_(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",(function(o,n){const i=o&&o.length;if(!i)return;const s=o.find((t=>{const[,,e,o]=t;return e!==o}));if(!s)return;const r=()=>{const e=o.reduce(((t,e)=>(t.push([...e]),t)),[]);k(e,(e=>{e[1]=t.propToCol(e[1])}));const n=i>1?this.getSelected():[[e[0][0],e[0][1]]];return new f_.ChangeAction(e,n)};e.done(r,n)})),t.addHook("afterCreateRow",((t,o,n)=>{e.done((()=>new f_.CreateRowAction(t,o)),n)})),t.addHook("beforeRemoveRow",((o,n,i,s)=>{const r=()=>{const i=t.toPhysicalRow(o),s=Co(e.instance.getSourceData(i,0,i+n-1,e.instance.countSourceCols()-1));return new f_.RemoveRowAction(i,s,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(r,s)})),t.addHook("afterCreateCol",((t,o,n)=>{e.done((()=>new f_.CreateColumnAction(t,o)),n)})),t.addHook("beforeRemoveCol",((o,n,i,s)=>{const r=()=>{const i=e.instance.getSourceDataArray(),s=(e.instance.countCols()+o)%e.instance.countCols(),r=[],l=[],a=[];mi(i.length-1,(e=>{const o=[],l=i[e];mi(s,s+(n-1),(e=>{o.push(l[t.toPhysicalColumn(e)])})),r.push(o)})),mi(n-1,(e=>{a.push(t.toPhysicalColumn(s+e))})),Array.isArray(t.getSettings().colHeaders)&&mi(n-1,(e=>{l.push(t.getSettings().colHeaders[t.toPhysicalColumn(s+e)]||null)}));const h=t.columnIndexMapper.getIndexesSequence(),c=t.rowIndexMapper.getIndexesSequence();return new f_.RemoveColumnAction(s,a,r,l,h,c,t.getSettings().fixedColumnsStart)};e.done(r,s)})),t.addHook("beforeCellAlignment",((t,o,n,i)=>{e.done((()=>new f_.CellAlignmentAction(t,o,n,i)))})),t.addHook("beforeFilter",(t=>{e.done((()=>new f_.FiltersAction(t)))})),t.addHook("beforeRowMove",((t,o)=>{!1!==t&&e.done((()=>new f_.RowMoveAction(t,o)))})),t.addHook("beforeMergeCells",((o,n)=>{n||e.done((()=>new f_.MergeCellsAction(t,o)))})),t.addHook("afterUnmergeCells",((o,n)=>{n||e.done((()=>new f_.UnmergeCellsAction(t,o)))})),t.addHook("afterInit",(()=>{e.init()}))}f_.prototype.done=function(t,e){if(this.ignoreNewActions)return;const o="UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e;if(o)return;const n=this.doneActions.slice(),i=this.instance.runHooks("beforeUndoStackChange",n,e);if(!1===i)return;const s=t(),r=this.undoneActions.slice();this.doneActions.push(s),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",r),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice())},f_.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const o=Co(e),n=this.instance.runHooks("beforeUndo",o);if(!1===n)return;this.ignoreNewActions=!0;const i=this,s=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",s),e.undo(this.instance,(()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)})),this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.instance.runHooks("afterUndo",o)}},f_.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const o=Co(e),n=this.instance.runHooks("beforeRedo",o);if(!1===n)return;this.ignoreNewActions=!0;const i=this,s=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",s),e.redo(this.instance,(()=>{i.ignoreNewActions=!1,i.doneActions.push(e)})),this.instance.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.instance.runHooks("afterRedo",o)}},f_.prototype.isUndoAvailable=function(){return this.doneActions.length>0},f_.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},f_.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},f_.prototype.isEnabled=function(){return this.enabled},f_.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,C_(t),this.registerShortcuts(),t.addHook("afterChange",w_)},f_.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,v_(t),this.unregisterShortcuts(),t.removeHook("afterChange",w_)},f_.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},f_.Action=function(){},f_.Action.prototype.undo=function(){},f_.Action.prototype.redo=function(){},f_.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"},mo(f_.ChangeAction,f_.Action),f_.ChangeAction.prototype.undo=function(t,e){const o=Co(this.changes),n=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let s=0,r=o.length;s<r;s++)o[s].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(o,null,null,"UndoRedo.undo");for(let s=0,r=o.length;s<r;s++){const[e,r]=o[s];t.getSettings().minSpareRows&&e+1+t.getSettings().minSpareRows===t.countRows()&&n===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(e+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&r+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(r+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)},f_.ChangeAction.prototype.redo=function(t,e){const o=Co(this.changes);for(let n=0,i=o.length;n<i;n++)o[n].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(o,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)},f_.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},mo(f_.CreateRowAction,f_.Action),f_.CreateRowAction.prototype.undo=function(t,e){const o=t.countRows(),n=t.getSettings().minSpareRows;this.index>=o&&this.index-n<o&&(this.index-=n),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},f_.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},f_.RemoveRowAction=function(t,e,o,n,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=o,this.fixedRowsTop=n,this.rowIndexesSequence=i},mo(f_.RemoveRowAction,f_.Action),f_.RemoveRowAction.prototype.undo=function(t,e){const o=t.getSettings(),n=[];o.fixedRowsBottom=this.fixedRowsBottom,o.fixedRowsTop=this.fixedRowsTop,this.data.forEach(((t,e)=>{Object.keys(t).forEach((o=>{const i=parseInt(o,10);n.push([this.index+e,isNaN(i)?o:i,t[o]])}))})),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(n,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},f_.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},f_.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},mo(f_.CreateColumnAction,f_.Action),f_.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},f_.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},f_.RemoveColumnAction=function(t,e,o,n,i,s,r){this.index=t,this.indexes=e,this.data=o,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=s.slice(0),this.actionType="remove_col",this.fixedColumnsStart=r},mo(f_.RemoveColumnAction,f_.Action),f_.RemoveColumnAction.prototype.undo=function(t,e){const o=t.getSettings();o.fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),i=(t,e,o)=>o[this.indexes.indexOf(n[e])],s=this.data.length,r=[];for(let h=0;h<s;h++)r.push(A(this.data[h],i));const l=A(this.headers,i),a=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),k(t.getSourceDataArray(),((t,e)=>{k(n,((o,n)=>{t[o]=r[e][n],a.push([e,o,t[o]])}))})),t.setSourceDataAtCell(a,void 0,void 0,"UndoRedo.undo"),"undefined"!==typeof this.headers&&k(l,((e,o)=>{t.getSettings().colHeaders[n[o]]=e})),t.batchExecution((()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)}),!0),t.addHookOnce("afterViewRender",e),t.render()},f_.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},f_.CellAlignmentAction=function(t,e,o,n){this.stateBefore=t,this.range=e,this.type=o,this.alignment=n},f_.CellAlignmentAction.prototype.undo=function(t,e){k(this.range,(e=>{e.forAll(((e,o)=>{e>=0&&o>=0&&t.setCellMeta(e,o,"className",this.stateBefore[e][o]||" htLeft")}))})),t.addHookOnce("afterViewRender",e),t.render()},f_.CellAlignmentAction.prototype.redo=function(t,e){SS(this.range,this.type,this.alignment,((e,o)=>t.getCellMeta(e,o)),((e,o,n,i)=>t.setCellMeta(e,o,n,i))),t.addHookOnce("afterViewRender",e),t.render()},f_.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},mo(f_.FiltersAction,f_.Action),f_.FiltersAction.prototype.undo=function(t,e){const o=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),o.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),o.filter()},f_.FiltersAction.prototype.redo=function(t,e){const o=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),o.conditionCollection.importAllConditions(this.conditionsStack),o.filter()};class m_ extends f_.Action{constructor(t,e){super(),this.cellRange=e;const o=this.cellRange.getTopStartCorner(),n=this.cellRange.getBottomEndCorner();this.rangeData=t.getData(o.row,o.col,n.row,n.col)}undo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.unmergeRange(this.cellRange,!0);const n=this.cellRange.getTopStartCorner();t.populateFromArray(n.row,n.col,this.rangeData,void 0,void 0,"MergeCells")}redo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.mergeRange(this.cellRange)}}f_.MergeCellsAction=m_;class p_ extends f_.Action{constructor(t,e){super(),this.cellRange=e}undo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.mergeRange(this.cellRange,!0)}redo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.unmergeRange(this.cellRange,!0),t.render()}}function w_(t,e){const o=this;if("loadData"===e)return o.undoRedo.clear()}function C_(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function v_(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}f_.UnmergeCellsAction=p_,f_.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"},mo(f_.RowMoveAction,f_.Action),f_.RowMoveAction.prototype.undo=function(t,e){const o=t.getPlugin("manualRowMove"),n=[].concat(this.rows),i=n.filter((t=>t>this.finalIndex)),s=n.filter((t=>t<=this.finalIndex)),r=i.sort(((t,e)=>e-t)).concat(s.sort(((t,e)=>t-e)));t.addHookOnce("afterViewRender",e);for(let l=0;l<r.length;l+=1){const e=t.toVisualRow(r[l]);o.moveRow(e,r[l])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},f_.RowMoveAction.prototype.redo=function(t,e){const o=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),o.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},f_.prototype.init=function(){const t=this.instance.getSettings().undo,e="undefined"===typeof t||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},f_.prototype.registerShortcuts=function(){const t=this.instance.getShortcutManager(),e=t.getContext("grid"),o=t=>!t.altKey,n={runOnlyIf:o,group:u_};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],n)},f_.prototype.unregisterShortcuts=function(){const t=this.instance.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(u_)};const y_=pn.getSingleton();y_.add("afterUpdateSettings",(function(){var t;null===(t=this.getPlugin("undoRedo"))||void 0===t||t.init()})),y_.register("beforeUndo"),y_.register("afterUndo"),y_.register("beforeRedo"),y_.register("afterRedo"),f_.PLUGIN_KEY=g_,f_.SETTING_KEYS=!0;var S_,b_,R_,E_,M_,T_=f_;function H_(){Vi(pv),Vi(Mv),Vi(Iv),Vi(Uv),Vi(ay),Vi(eS),Vi(lS),Vi(JS),Vi(MR),Vi(HE),Vi(oM),Vi(sM),Vi(fM),Vi(AM),Vi(II),Vi(QA),Vi(dk),Vi(Mk),Vi(kk),Vi(Qk),Vi(oO),Vi(bO),Vi(HO),Vi(jO),Vi(JO),Vi(eP),Vi(AN),Vi(KN),Vi(ZN),Vi(s_),Vi(a_),Vi(d_),Vi(T_)}function x_(){Pw(),rC(),vC(),UC(),H_()}function I_(t){const e="undefined"!==typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){const o=this.first();let n,i=o.data("handsontable");if("string"!==typeof e){const n=e||{};return i?i.updateSettings(n):(i=new t.Core(o[0],n),o.data("handsontable",i),i.init()),o}if(i){if("undefined"===typeof i[e])throw new Error(`Handsontable do not provide action: ${e}`);for(var s=arguments.length,r=new Array(s>1?s-1:0),l=1;l<s;l++)r[l-1]=arguments[l];n=i[e].call(i,...r),"destroy"===e&&o.removeData()}return n})}x_(),I_(Ym),Ym.__GhostTable=rv,Ym._getListenersCounter=Pn,Ym._getRegisteredMapsCounter=Hh,Ym.EventManager=On;const A_=[n,h,m,w,f,l,i,g,a,s,c,u],k_=[r,d];Ym.helper={},Ym.dom={},k(A_,(t=>{k(Object.getOwnPropertyNames(t),(e=>{"_"!==e.charAt(0)&&(Ym.helper[e]=t[e])}))})),k(k_,(t=>{k(Object.getOwnPropertyNames(t),(e=>{"_"!==e.charAt(0)&&(Ym.dom[e]=t[e])}))})),Ym.cellTypes=null!==(S_=Ym.cellTypes)&&void 0!==S_?S_:{},k(Ng(),(t=>{Ym.cellTypes[t]=Dg(t)})),Ym.cellTypes.registerCellType=Lg,Ym.cellTypes.getCellType=Dg,Ym.editors=null!==(b_=Ym.editors)&&void 0!==b_?b_:{},k(Rn(),(t=>{Ym.editors[`${lt(t)}Editor`]=Hn(t)})),Ym.editors.registerEditor=xn,Ym.editors.getEditor=Hn,Ym.renderers=null!==(R_=Ym.renderers)&&void 0!==R_?R_:{},k(Ui(),(t=>{const e=Gi(t);"base"===t&&(Ym.renderers.cellDecorator=e),Ym.renderers[`${lt(t)}Renderer`]=e})),Ym.renderers.registerRenderer=Yi,Ym.renderers.getRenderer=Gi,Ym.validators=null!==(E_=Ym.validators)&&void 0!==E_?E_:{},k(Qi(),(t=>{Ym.validators[`${lt(t)}Validator`]=Zi(t)})),Ym.validators.registerValidator=ts,Ym.validators.getValidator=Zi,Ym.plugins=null!==(M_=Ym.plugins)&&void 0!==M_?M_:{},k(_i(),(t=>{Ym.plugins[t]=Di(t)})),Ym.plugins[`${lt(tv.PLUGIN_KEY)}Plugin`]=tv,Ym.plugins.registerPlugin=Vi,Ym.plugins.getPlugin=Di;var O_=Ym,P_=function(t,e){var o=e.className;void 0!==o&&O_.dom.addClass(t,o)},N_=function(t,e,o,n,i,s,r){var l=document.createElement("div");l.style.width="".concat(10*s,"px"),P_(e,r),O_.dom.addClass(l,"progressBar"),O_.dom.empty(e),e.appendChild(l)},__=function(t,e,o,n,i,s,r){O_.renderers.TextRenderer.apply(this,[t,e,o,n,i,"★".repeat(s),r])},D_=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]),L_=function(t,e,o,n,i,s){if(0===o){var r=t.parentElement;null!==r&&(s.instance.getDataAtRowProp(e,"0")?O_.dom.addClass(r,nw):O_.dom.removeClass(r,nw),e%2===0?O_.dom.addClass(r,iw):O_.dom.removeClass(r,iw))}},V_=function(t,e){var o=document.createElement("input");o.type="checkbox",t>=0&&this.getDataAtRowProp(t,"0")&&(o.checked=!0),O_.dom.empty(e),e.appendChild(o)};function B_(t,e){if(!(t<0)){var o=this.isRtl()?"htRight":"htLeft";e.firstChild&&(D_.has(t.toString())?(O_.dom.removeClass(e.firstChild,o),O_.dom.addClass(e.firstChild,D_.get(t.toString()))):O_.dom.addClass(e.firstChild,o))}}var F_=function(t,e){var o=t.target;-1===e.col&&t.target&&"INPUT"===o.nodeName&&(t.preventDefault(),this.setDataAtRowProp(e.row,"0",!o.checked))},W_={name:"DataGrid",data:function(){return{hotSettings:{height:450,dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,afterOnCellMouseDown:F_,afterGetColHeader:B_,afterGetRowHeader:V_,beforeRenderer:L_,colWidths:[140,192,100,90,90,110,97,100,126],colHeaders:["Company name","Name","Sell date","In stock","Qty","Progress","Rating","Order ID","Country"],columns:[{data:1,type:"text"},{data:3,type:"text"},{data:4,type:"date",allowInvalid:!1},{data:6,type:"checkbox",className:"htCenter"},{data:7,type:"numeric"},{data:8,renderer:N_,readOnly:!0,className:"htMiddle"},{data:9,renderer:__,readOnly:!0,className:"star htCenter"},{data:5,type:"text"},{data:2,type:"text"}],licenseKey:"non-commercial-and-evaluation"},data:sw()}},components:{HotTable:_p}},j_=W_,z_=o(9917),U_=(0,z_.Z)(j_,S,b,!1,null,null,null),$_=U_.exports,G_={name:"App",components:{DataGrid:$_}},Y_=G_,K_=(0,z_.Z)(Y_,v,y,!1,null,null,null),X_=K_.exports;console.log("Handsontable: v".concat(O_.version," (").concat(O_.buildDate,") Wrapper: v").concat(_p.version," Vue: v").concat(C.ZP.version)),C.ZP.config.silent=!0,new C.ZP({render:function(t){return t(X_)}}).$mount("#app")},5131:function(t,e,o){var n={"./af":4466,"./af.js":4466,"./ar":9252,"./ar-dz":6520,"./ar-dz.js":6520,"./ar-kw":2358,"./ar-kw.js":2358,"./ar-ly":3229,"./ar-ly.js":3229,"./ar-ma":1707,"./ar-ma.js":1707,"./ar-sa":3237,"./ar-sa.js":3237,"./ar-tn":8206,"./ar-tn.js":8206,"./ar.js":9252,"./az":9665,"./az.js":9665,"./be":2888,"./be.js":2888,"./bg":5945,"./bg.js":5945,"./bm":6375,"./bm.js":6375,"./bn":758,"./bn-bd":533,"./bn-bd.js":533,"./bn.js":758,"./bo":5502,"./bo.js":5502,"./br":70,"./br.js":70,"./bs":295,"./bs.js":295,"./ca":6647,"./ca.js":6647,"./cs":4343,"./cs.js":4343,"./cv":9886,"./cv.js":9886,"./cy":2985,"./cy.js":2985,"./da":139,"./da.js":139,"./de":472,"./de-at":994,"./de-at.js":994,"./de-ch":4824,"./de-ch.js":4824,"./de.js":472,"./dv":9271,"./dv.js":9271,"./el":5195,"./el.js":5195,"./en-au":8847,"./en-au.js":8847,"./en-ca":1348,"./en-ca.js":1348,"./en-gb":9053,"./en-gb.js":9053,"./en-ie":1853,"./en-ie.js":1853,"./en-il":4135,"./en-il.js":4135,"./en-in":7122,"./en-in.js":7122,"./en-nz":3011,"./en-nz.js":3011,"./en-sg":6714,"./en-sg.js":6714,"./eo":197,"./eo.js":197,"./es":4293,"./es-do":8029,"./es-do.js":8029,"./es-mx":1154,"./es-mx.js":1154,"./es-us":8357,"./es-us.js":8357,"./es.js":4293,"./et":6720,"./et.js":6720,"./eu":5808,"./eu.js":5808,"./fa":4924,"./fa.js":4924,"./fi":5949,"./fi.js":5949,"./fil":6108,"./fil.js":6108,"./fo":2687,"./fo.js":2687,"./fr":6724,"./fr-ca":9466,"./fr-ca.js":9466,"./fr-ch":867,"./fr-ch.js":867,"./fr.js":6724,"./fy":9550,"./fy.js":9550,"./ga":4735,"./ga.js":4735,"./gd":9878,"./gd.js":9878,"./gl":9787,"./gl.js":9787,"./gom-deva":6492,"./gom-deva.js":6492,"./gom-latn":5339,"./gom-latn.js":5339,"./gu":836,"./gu.js":836,"./he":9315,"./he.js":9315,"./hi":3724,"./hi.js":3724,"./hr":3730,"./hr.js":3730,"./hu":7657,"./hu.js":7657,"./hy-am":1918,"./hy-am.js":1918,"./id":2215,"./id.js":2215,"./is":4095,"./is.js":4095,"./it":2446,"./it-ch":1947,"./it-ch.js":1947,"./it.js":2446,"./ja":9545,"./ja.js":9545,"./jv":1437,"./jv.js":1437,"./ka":1330,"./ka.js":1330,"./kk":8900,"./kk.js":8900,"./km":5620,"./km.js":5620,"./kn":7081,"./kn.js":7081,"./ko":8130,"./ko.js":8130,"./ku":5295,"./ku.js":5295,"./ky":8578,"./ky.js":8578,"./lb":8773,"./lb.js":8773,"./lo":6366,"./lo.js":6366,"./lt":2532,"./lt.js":2532,"./lv":3902,"./lv.js":3902,"./me":3636,"./me.js":3636,"./mi":4059,"./mi.js":4059,"./mk":6005,"./mk.js":6005,"./ml":2982,"./ml.js":2982,"./mn":5543,"./mn.js":5543,"./mr":4898,"./mr.js":4898,"./ms":4145,"./ms-my":8766,"./ms-my.js":8766,"./ms.js":4145,"./mt":4780,"./mt.js":4780,"./my":3445,"./my.js":3445,"./nb":4372,"./nb.js":4372,"./ne":2862,"./ne.js":2862,"./nl":2254,"./nl-be":3293,"./nl-be.js":3293,"./nl.js":2254,"./nn":6986,"./nn.js":6986,"./oc-lnc":6623,"./oc-lnc.js":6623,"./pa-in":3802,"./pa-in.js":3802,"./pl":2560,"./pl.js":2560,"./pt":6467,"./pt-br":3595,"./pt-br.js":3595,"./pt.js":6467,"./ro":5092,"./ro.js":5092,"./ru":2238,"./ru.js":2238,"./sd":5555,"./sd.js":5555,"./se":7291,"./se.js":7291,"./si":3013,"./si.js":3013,"./sk":7005,"./sk.js":7005,"./sl":284,"./sl.js":284,"./sq":7274,"./sq.js":7274,"./sr":1344,"./sr-cyrl":1521,"./sr-cyrl.js":1521,"./sr.js":1344,"./ss":9573,"./ss.js":9573,"./sv":8865,"./sv.js":8865,"./sw":1769,"./sw.js":1769,"./ta":1108,"./ta.js":1108,"./te":2002,"./te.js":2002,"./tet":3164,"./tet.js":3164,"./tg":6599,"./tg.js":6599,"./th":1806,"./th.js":1806,"./tk":2315,"./tk.js":2315,"./tl-ph":3296,"./tl-ph.js":3296,"./tlh":3102,"./tlh.js":3102,"./tr":5886,"./tr.js":5886,"./tzl":6963,"./tzl.js":6963,"./tzm":1203,"./tzm-latn":4676,"./tzm-latn.js":4676,"./tzm.js":1203,"./ug-cn":1444,"./ug-cn.js":1444,"./uk":2676,"./uk.js":2676,"./ur":5026,"./ur.js":5026,"./uz":9895,"./uz-latn":1873,"./uz-latn.js":1873,"./uz.js":9895,"./vi":5646,"./vi.js":5646,"./x-pseudo":7377,"./x-pseudo.js":7377,"./yo":9632,"./yo.js":9632,"./zh-cn":5665,"./zh-cn.js":5665,"./zh-hk":627,"./zh-hk.js":627,"./zh-mo":7922,"./zh-mo.js":7922,"./zh-tw":8973,"./zh-tw.js":8973};function i(t){var e=s(t);return o(e)}function s(t){if(!o.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}i.keys=function(){return Object.keys(n)},i.resolve=s,t.exports=i,i.id=5131}},e={};function o(n){var i=e[n];if(void 0!==i)return i.exports;var s=e[n]={id:n,loaded:!1,exports:{}};return t[n].call(s.exports,s,s.exports,o),s.loaded=!0,s.exports}o.m=t,function(){var t=[];o.O=function(e,n,i,s){if(!n){var r=1/0;for(c=0;c<t.length;c++){n=t[c][0],i=t[c][1],s=t[c][2];for(var l=!0,a=0;a<n.length;a++)(!1&s||r>=s)&&Object.keys(o.O).every((function(t){return o.O[t](n[a])}))?n.splice(a--,1):(l=!1,s<r&&(r=s));if(l){t.splice(c--,1);var h=i();void 0!==h&&(e=h)}}return e}s=s||0;for(var c=t.length;c>0&&t[c-1][2]>s;c--)t[c]=t[c-1];t[c]=[n,i,s]}}(),function(){o.d=function(t,e){for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){o.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={143:0};o.O.j=function(e){return 0===t[e]};var e=function(e,n){var i,s,r=n[0],l=n[1],a=n[2],h=0;if(r.some((function(e){return 0!==t[e]}))){for(i in l)o.o(l,i)&&(o.m[i]=l[i]);if(a)var c=a(o)}for(e&&e(n);h<r.length;h++)s=r[h],o.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return o.O(c)},n=self["webpackChunkvue_template"]=self["webpackChunkvue_template"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(4877)}));n=o.O(n)})();
//# sourceMappingURL=app.1b07f8bf.js.map