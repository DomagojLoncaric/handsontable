(function(){var t={1093:function(t,e,n){"use strict";var r={};n.r(r),n.d(r,{cancelAnimationFrame:function(){return M},getComparisonFunction:function(){return H},hasCaptionProblem:function(){return _},isClassListSupported:function(){return T},isGetComputedStyleSupported:function(){return A},isPassiveEventSupported:function(){return N},isTextContentSupported:function(){return j},isTouchSupported:function(){return I},requestAnimationFrame:function(){return P}});var o={};n.r(o),n.d(o,{arrayAvg:function(){return K},arrayEach:function(){return U},arrayFilter:function(){return F},arrayFlatten:function(){return X},arrayMap:function(){return W},arrayMax:function(){return G},arrayMin:function(){return Y},arrayReduce:function(){return V},arraySum:function(){return z},arrayUnique:function(){return $},extendArray:function(){return L},getDifferenceOfArrays:function(){return q},getIntersectionOfArrays:function(){return Q},getUnionOfArrays:function(){return J},pivot:function(){return B},stringToArray:function(){return Z},to2dArray:function(){return D}});var i={};n.r(i),n.d(i,{clone:function(){return ut},createObjectPropListener:function(){return gt},deepClone:function(){return st},deepExtend:function(){return lt},deepObjectSize:function(){return mt},defineGetter:function(){return dt},duckSchema:function(){return ot},extend:function(){return at},getProperty:function(){return yt},hasOwnProperty:function(){return bt},inherit:function(){return it},isObject:function(){return ht},isObjectEqual:function(){return ft},mixin:function(){return ct},objectEach:function(){return pt},setProperty:function(){return vt}});var a={};n.r(a),n.d(a,{isChrome:function(){return Rt},isChromeWebKit:function(){return Et},isEdge:function(){return At},isEdgeWebKit:function(){return Mt},isFirefox:function(){return Pt},isFirefoxWebKit:function(){return Tt},isIE:function(){return It},isIE9:function(){return xt},isIOS:function(){return Nt},isIpadOS:function(){return Dt},isLinuxOS:function(){return Vt},isMSBrowser:function(){return _t},isMacOS:function(){return Bt},isMobileBrowser:function(){return Ht},isSafari:function(){return jt},isWindowsOS:function(){return Lt},setBrowserMeta:function(){return Ot},setPlatformMeta:function(){return kt}});var l={};n.r(l),n.d(l,{_injectProductInfo:function(){return me},isDefined:function(){return Zt},isEmpty:function(){return ee},isRegExp:function(){return ne},isUndefined:function(){return te},stringify:function(){return Jt}});var s={};n.r(s),n.d(s,{equalsIgnoreCase:function(){return we},isPercentValue:function(){return Ce},randomString:function(){return Se},sanitize:function(){return Re},stripTags:function(){return ke},substitute:function(){return Oe},toUpperCaseFirst:function(){return be}});var u={};n.r(u),n.d(u,{HTML_CHARACTERS:function(){return qe},addClass:function(){return Ge},addEvent:function(){return yn},clearTextSelection:function(){return wn},closest:function(){return Ne},closestDown:function(){return De},empty:function(){return Xe},fastInnerHTML:function(){return Qe},fastInnerText:function(){return Je},getCaretPosition:function(){return mn},getComputedStyle:function(){return cn},getCssTransform:function(){return Pn},getFrameElement:function(){return xe},getParent:function(){return Ie},getParentWindow:function(){return _e},getScrollLeft:function(){return on},getScrollTop:function(){return rn},getScrollableElement:function(){return an},getScrollbarWidth:function(){return On},getSelectionEndPosition:function(){return gn},getSelectionText:function(){return bn},getStyle:function(){return sn},getTrimmingContainer:function(){return ln},getWindowScrollLeft:function(){return nn},getWindowScrollTop:function(){return en},hasAccessToParentWindow:function(){return He},hasClass:function(){return ze},hasHorizontalScrollbar:function(){return Rn},hasVerticalScrollbar:function(){return kn},index:function(){return Be},innerHeight:function(){return dn},innerWidth:function(){return pn},isChildOf:function(){return Le},isDetached:function(){return In},isInput:function(){return jn},isOutsideInput:function(){return An},isVisible:function(){return Ze},matchesCSSRules:function(){return un},observeVisibilityChangeOnce:function(){return xn},offset:function(){return tn},outerHeight:function(){return hn},outerWidth:function(){return fn},overlayContainsElement:function(){return Ve},removeClass:function(){return Ye},removeEvent:function(){return vn},removeTextNodes:function(){return Ke},resetCssTransform:function(){return Tn},selectElementIfAllowed:function(){return Mn},setCaretPosition:function(){return Sn},setOverlayPosition:function(){return En}});var c={};n.r(c),n.d(c,{curry:function(){return Vn},curryRight:function(){return Fn},debounce:function(){return Dn},fastCall:function(){return Wn},isFunction:function(){return _n},partial:function(){return Bn},pipe:function(){return Ln},throttle:function(){return Hn},throttleAfterHits:function(){return Nn}});var f={};n.r(f),n.d(f,{KEY_CODES:function(){return Yn},isCtrlKey:function(){return qn},isCtrlMetaKey:function(){return Qn},isFunctionKey:function(){return $n},isKey:function(){return Jn},isPrintableChar:function(){return Xn}});var h={};n.r(h),n.d(h,{isImmediatePropagationStopped:function(){return tr},isLeftClick:function(){return nr},isRightClick:function(){return er},stopImmediatePropagation:function(){return Zn}});var d={};n.r(d),n.d(d,{_dataToHTML:function(){return So},htmlToGridSettings:function(){return Co},instanceToHTML:function(){return wo}});var p={};n.r(p),n.d(p,{isNumeric:function(){return Ao},isNumericLike:function(){return Mo},rangeEach:function(){return Io},rangeEachReverse:function(){return xo},valueAccordingPercent:function(){return _o}});var y={};n.r(y),n.d(y,{countFirstRowKeys:function(){return Dv},createEmptySpreadsheetData:function(){return Hv},createSpreadsheetData:function(){return xv},createSpreadsheetObjectData:function(){return _v},dataRowToChangesArray:function(){return Nv},isArrayOfArrays:function(){return Lv},isArrayOfObjects:function(){return Bv},spreadsheetColumnIndex:function(){return Iv},spreadsheetColumnLabel:function(){return Mv}});var v={};n.r(v),n.d(v,{CONTEXTMENU_ITEMS_ADD_COMMENT:function(){return Zw},CONTEXTMENU_ITEMS_ALIGNMENT:function(){return rS},CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:function(){return cS},CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:function(){return iS},CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:function(){return lS},CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:function(){return oS},CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:function(){return uS},CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:function(){return aS},CONTEXTMENU_ITEMS_ALIGNMENT_TOP:function(){return sS},CONTEXTMENU_ITEMS_BORDERS:function(){return fS},CONTEXTMENU_ITEMS_BORDERS_BOTTOM:function(){return pS},CONTEXTMENU_ITEMS_BORDERS_LEFT:function(){return yS},CONTEXTMENU_ITEMS_BORDERS_RIGHT:function(){return dS},CONTEXTMENU_ITEMS_BORDERS_TOP:function(){return hS},CONTEXTMENU_ITEMS_CLEAR_COLUMN:function(){return Uw},CONTEXTMENU_ITEMS_COPY:function(){return zw},CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:function(){return Kw},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:function(){return Yw},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:function(){return Gw},CONTEXTMENU_ITEMS_CUT:function(){return Xw},CONTEXTMENU_ITEMS_EDIT_COMMENT:function(){return tS},CONTEXTMENU_ITEMS_FREEZE_COLUMN:function(){return $w},CONTEXTMENU_ITEMS_HIDE_COLUMN:function(){return bS},CONTEXTMENU_ITEMS_HIDE_ROW:function(){return SS},CONTEXTMENU_ITEMS_INSERT_LEFT:function(){return Nw},CONTEXTMENU_ITEMS_INSERT_RIGHT:function(){return Dw},CONTEXTMENU_ITEMS_MERGE_CELLS:function(){return Qw},CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:function(){return gS},CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:function(){return mS},CONTEXTMENU_ITEMS_NO_ITEMS:function(){return xw},CONTEXTMENU_ITEMS_READ_ONLY:function(){return Ww},CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:function(){return nS},CONTEXTMENU_ITEMS_REDO:function(){return Fw},CONTEXTMENU_ITEMS_REMOVE_BORDERS:function(){return vS},CONTEXTMENU_ITEMS_REMOVE_COLUMN:function(){return Bw},CONTEXTMENU_ITEMS_REMOVE_COMMENT:function(){return eS},CONTEXTMENU_ITEMS_REMOVE_ROW:function(){return Lw},CONTEXTMENU_ITEMS_ROW_ABOVE:function(){return _w},CONTEXTMENU_ITEMS_ROW_BELOW:function(){return Hw},CONTEXTMENU_ITEMS_SHOW_COLUMN:function(){return wS},CONTEXTMENU_ITEMS_SHOW_ROW:function(){return CS},CONTEXTMENU_ITEMS_UNDO:function(){return Vw},CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:function(){return qw},CONTEXTMENU_ITEMS_UNMERGE_CELLS:function(){return Jw},CONTEXT_MENU_ITEMS_NAMESPACE:function(){return Mw},FILTERS_BUTTONS_CANCEL:function(){return tC},FILTERS_BUTTONS_CLEAR:function(){return JS},FILTERS_BUTTONS_OK:function(){return ZS},FILTERS_BUTTONS_PLACEHOLDER_SEARCH:function(){return eC},FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:function(){return rC},FILTERS_BUTTONS_PLACEHOLDER_VALUE:function(){return nC},FILTERS_BUTTONS_SELECT_ALL:function(){return QS},FILTERS_CONDITIONS_AFTER:function(){return FS},FILTERS_CONDITIONS_BEFORE:function(){return WS},FILTERS_CONDITIONS_BEGINS_WITH:function(){return AS},FILTERS_CONDITIONS_BETWEEN:function(){return BS},FILTERS_CONDITIONS_BY_VALUE:function(){return _S},FILTERS_CONDITIONS_CONTAINS:function(){return IS},FILTERS_CONDITIONS_EMPTY:function(){return ES},FILTERS_CONDITIONS_ENDS_WITH:function(){return MS},FILTERS_CONDITIONS_EQUAL:function(){return TS},FILTERS_CONDITIONS_GREATER_THAN:function(){return HS},FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:function(){return NS},FILTERS_CONDITIONS_LESS_THAN:function(){return DS},FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:function(){return LS},FILTERS_CONDITIONS_NAMESPACE:function(){return kS},FILTERS_CONDITIONS_NONE:function(){return RS},FILTERS_CONDITIONS_NOT_BETWEEN:function(){return VS},FILTERS_CONDITIONS_NOT_CONTAIN:function(){return xS},FILTERS_CONDITIONS_NOT_EMPTY:function(){return PS},FILTERS_CONDITIONS_NOT_EQUAL:function(){return jS},FILTERS_CONDITIONS_TODAY:function(){return US},FILTERS_CONDITIONS_TOMORROW:function(){return zS},FILTERS_CONDITIONS_YESTERDAY:function(){return GS},FILTERS_DIVS_FILTER_BY_CONDITION:function(){return YS},FILTERS_DIVS_FILTER_BY_VALUE:function(){return KS},FILTERS_LABELS_CONJUNCTION:function(){return XS},FILTERS_LABELS_DISJUNCTION:function(){return $S},FILTERS_NAMESPACE:function(){return OS},FILTERS_VALUES_BLANK_CELLS:function(){return qS}});var m={};n.r(m),n.d(m,{getNormalizedDate:function(){return H_}});var g,b,w,S=n(6427),C=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("DataGrid")],1)},O=[],k=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"example"}},[e("hot-table",{ref:"hotTableComponent",attrs:{data:t.data,settings:t.hotSettings}})],1)},R=[];n(3696),n(4423),n(4182),n(1965),n(8323),n(520),n(5006),n(6925),n(4453),n(1021),n(8669),n(757),n(9821),n(5270),n(8127),n(3671),n(3953),n(3460),n(9455),n(5477),n(2966),n(7786),n(809),n(3251),n(2996),n(1634),n(4750),n(9028),n(1330),n(5867),n(2329),n(957),n(8786),n(924),n(6565);function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function P(t){return window.requestAnimationFrame(t)}function T(){return!!document.documentElement.classList}function j(){return!!document.createTextNode("test").textContent}function A(){return!!window.getComputedStyle}function M(t){window.cancelAnimationFrame(t)}function I(){return"ontouchstart"in window}function x(){var t=document.createElement("TABLE");t.style.borderSpacing="0",t.style.borderWidth="0",t.style.padding="0";var e=document.createElement("TBODY");t.appendChild(e),e.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding="0",n.style.margin="0",t.insertBefore(n,e),document.body.appendChild(t),g=t.offsetHeight<2*t.lastChild.offsetHeight,document.body.removeChild(t)}function _(){return void 0===g&&x(),g}function H(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return b||(b="object"===("undefined"===typeof Intl?"undefined":E(Intl))?new Intl.Collator(t,e).compare:"function"===typeof String.prototype.localeCompare?function(t,e){return"".concat(t).localeCompare(e)}:function(t,e){return t===e?0:t>e?-1:1},b)}function N(){if(void 0!==w)return w;try{var t={get passive(){w=!0}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(e){w=!1}return w}n(7682),n(6139),n(3455),n(3378);function D(t){var e=t.length,n=0;while(n<e)t[n]=[t[n]],n+=1}function L(t,e){var n=e.length,r=0;while(r<n)t.push(e[r]),r+=1}function B(t){var e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;for(var n=t.length,r=t[0].length,o=0;o<n;o++)for(var i=0;i<r;i++)e[i]||(e[i]=[]),e[i][o]=t[o][i];return e}function V(t,e,n,r){var o=-1,i=t,a=n;Array.isArray(t)||(i=Array.from(t));var l=i.length;r&&l&&(o+=1,a=i[o]),o+=1;while(o<l)a=e(a,i[o],o,i),o+=1;return a}function F(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));var o=r.length,i=[],a=-1;while(n<o){var l=r[n];e(l,n,r)&&(a+=1,i[a]=l),n+=1}return i}function W(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));var o=r.length,i=[],a=-1;while(n<o){var l=r[n];a+=1,i[a]=e(l,n,r),n+=1}return i}function U(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));var o=r.length;while(n<o){if(!1===e(r[n],n,r))break;n+=1}return t}function z(t){return V(t,(function(t,e){return t+e}),0)}function G(t){return V(t,(function(t,e){return t>e?t:e}),Array.isArray(t)?t[0]:void 0)}function Y(t){return V(t,(function(t,e){return t<e?t:e}),Array.isArray(t)?t[0]:void 0)}function K(t){return t.length?z(t)/t.length:0}function X(t){return V(t,(function(t,e){return t.concat(Array.isArray(e)?X(e):e)}),[])}function $(t){var e=[];return U(t,(function(t){-1===e.indexOf(t)&&e.push(t)})),e}function q(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=[].concat(e),o=r[0],i=r.slice(1),a=o;return U(i,(function(t){a=a.filter((function(e){return!t.includes(e)}))})),a}function Q(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=[].concat(e),o=r[0],i=r.slice(1),a=o;return U(i,(function(t){a=a.filter((function(e){return t.includes(e)}))})),a}function J(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=[].concat(e),o=r[0],i=r.slice(1),a=new Set(o);return U(i,(function(t){U(t,(function(t){a.has(t)||a.add(t)}))})),Array.from(a)}function Z(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}function tt(t,e,n){return e=et(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function et(t){var e=nt(t,"string");return"symbol"===rt(e)?e:String(e)}function nt(t,e){if("object"!==rt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function ot(t){var e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},pt(t,(function(t,n){"__children"!==n&&(t&&"object"===rt(t)&&!Array.isArray(t)?e[n]=ot(t):Array.isArray(t)?t.length&&"object"===rt(t[0])&&!Array.isArray(t[0])?e[n]=[ot(t[0])]:e[n]=[]:e[n]=null)}))),e}function it(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function at(t,e,n){var r=Array.isArray(n);return pt(e,(function(e,o){(!1===r||n.includes(o))&&(t[o]=e)})),t}function lt(t,e){pt(e,(function(n,r){e[r]&&"object"===rt(e[r])?(t[r]||(Array.isArray(e[r])?t[r]=[]:"[object Date]"===Object.prototype.toString.call(e[r])?t[r]=e[r]:t[r]={}),lt(t[r],e[r])):t[r]=e[r]}))}function st(t){return"object"===rt(t)?JSON.parse(JSON.stringify(t)):t}function ut(t){var e={};return pt(t,(function(t,n){e[n]=t})),e}function ct(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return U(n,(function(e){t.MIXINS.push(e.MIXIN_NAME),pt(e,(function(e,n){if(void 0!==t.prototype[n])throw new Error("Mixin conflict. Property '".concat(n,"' already exist and cannot be overwritten."));if("function"===typeof e)t.prototype[n]=e;else{var r=function(t,e){var n="_".concat(t),r=function(t){var e=t;return(Array.isArray(e)||ht(e))&&(e=st(e)),e};return function(){return void 0===this[n]&&(this[n]=r(e)),this[n]}},o=function(t){var e="_".concat(t);return function(t){this[e]=t}};Object.defineProperty(t.prototype,n,{get:r(n,e),set:o(n),configurable:!0})}}))})),t}function ft(t,e){return JSON.stringify(t)===JSON.stringify(e)}function ht(t){return"[object Object]"===Object.prototype.toString.call(t)}function dt(t,e,n,r){r.value=n,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(t,e,r)}function pt(t,e){for(var n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&!1===e(t[n],n,t))break;return t}function yt(t,e){var n=e.split("."),r=t;return pt(n,(function(t){if(r=r[t],void 0===r)return r=void 0,!1})),r}function vt(t,e,n){var r=e.split("."),o=t;r.forEach((function(t,e){e!==r.length-1?(bt(o,t)||(o[t]={}),o=o[t]):o[t]=n}))}function mt(t){if(!ht(t))return 0;var e=function t(e){var n=0;return ht(e)?pt(e,(function(e,r){"__children"!==r&&(n+=t(e))})):n+=1,n};return e(t)}function gt(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",r="_".concat(n),o=(e={_touched:!1},tt(e,r,t),tt(e,"isTouched",(function(){return this._touched})),e);return Object.defineProperty(o,n,{get:function(){return this[r]},set:function(t){this._touched=!0,this[r]=t},enumerable:!0,configurable:!0}),o}function bt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var wt=function(t){var e={value:!1,test:function(n,r){e.value=t(n,r)}};return e},St={chrome:wt((function(t,e){return/Chrome/.test(t)&&/Google/.test(e)})),chromeWebKit:wt((function(t){return/CriOS/.test(t)})),edge:wt((function(t){return/Edge/.test(t)})),edgeWebKit:wt((function(t){return/EdgiOS/.test(t)})),firefox:wt((function(t){return/Firefox/.test(t)})),firefoxWebKit:wt((function(t){return/FxiOS/.test(t)})),ie:wt((function(t){return/Trident/.test(t)})),ie9:wt((function(){return!!document.documentMode})),mobile:wt((function(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)})),safari:wt((function(t,e){return/Safari/.test(t)&&/Apple Computer/.test(e)}))},Ct={mac:wt((function(t){return/^Mac/.test(t)})),win:wt((function(t){return/^Win/.test(t)})),linux:wt((function(t){return/^Linux/.test(t)})),ios:wt((function(t){return/iPhone|iPad|iPod/i.test(t)}))};function Ot(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.userAgent,n=void 0===e?navigator.userAgent:e,r=t.vendor,o=void 0===r?navigator.vendor:r;pt(St,(function(t){var e=t.test;e(n,o)}))}function kt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.platform,n=void 0===e?navigator.platform:e;pt(Ct,(function(t){var e=t.test;e(n)}))}function Rt(){return St.chrome.value}function Et(){return St.chromeWebKit.value}function Pt(){return St.firefox.value}function Tt(){return St.firefoxWebKit.value}function jt(){return St.safari.value}function At(){return St.edge.value}function Mt(){return St.edgeWebKit.value}function It(){return St.ie.value}function xt(){return St.ie9.value}function _t(){return St.ie.value||St.edge.value}function Ht(){return St.mobile.value}function Nt(){return Ct.ios.value}function Dt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator,e=t.maxTouchPoints;return e>2&&Ct.mac.value}function Lt(){return Ct.win.value}function Bt(){return Ct.mac.value}function Vt(){return Ct.linux.value}Ot(),kt();var Ft,Wt,Ut,zt,Gt,Yt,Kt=n(9757),Xt=(n(9981),n(2168),n(8289));function $t(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var o=V(t,(function(t,e,r){var o=e.replace(/\r?\n\s*/g,""),i=n[r]?n[r]:"";return t+o+i}),"");return o.trim()}function qt(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Qt(t){return Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qt(t)}function Jt(t){var e;switch(Qt(t)){case"string":case"number":e="".concat(t);break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Zt(t){return"undefined"!==typeof t}function te(t){return"undefined"===typeof t}function ee(t){return null===t||""===t||te(t)}function ne(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var re,oe,ie,ae="length",le=function(t){return parseInt(t,16)},se=function(t){return parseInt(t,10)},ue=function(t,e,n){return t["substr"](e,n)},ce=function(t){return t["codePointAt"](0)-65},fe=function(t){return"".concat(t).replace(/\-/g,"")},he=function(t){return le(ue(fe(t),le("12"),ce("F")))/(le(ue(fe(t),ce("B"),~~![][ae]))||9)},de=function(){return"undefined"!==typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},pe=!1,ye={invalid:function(){return $t(Ft||(Ft=qt(["\n    The license key for Handsontable is invalid. \n    If you need any help, contact us at support@handsontable.com."],["\n    The license key for Handsontable is invalid.\\x20\n    If you need any help, contact us at support@handsontable.com."])))},expired:function(t){var e=t.keyValidityDate,n=t.hotVersion;return $t(Wt||(Wt=qt(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior \n    to ",". If you need any help, contact us at sales@handsontable.com."],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior\\x20\n    to ",". If you need any help, contact us at sales@handsontable.com."])),e,n,e)},missing:function(){return $t(Ut||(Ut=qt(["\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact \n    us at support@handsontable.com."],["\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20\n    us at support@handsontable.com."])))},non_commercial:function(){return""}},ve={invalid:function(){return $t(zt||(zt=qt(['\n    The license key for Handsontable is invalid. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to \n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is invalid.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20\n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},expired:function(t){var e=t.keyValidityDate,n=t.hotVersion;return $t(Gt||(Gt=qt(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your \n    license key or downgrade to a version released prior to ','. If you need any \n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20\n    license key or downgrade to a version released prior to ','. If you need any\\x20\n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'])),e,n,e)},missing:function(){return $t(Yt||(Yt=qt(['\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: \'non-commercial-and-evaluation\'. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in \n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: \'non-commercial-and-evaluation\'.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20\n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},non_commercial:function(){return""}};function me(t,e){var n,r=!ee(t),o="string"===typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),i="12.4.0",a="invalid",l="invalid";t=fe(t||"");var s=ge(t);if(r||o||s)if(s){var u=Xt("23/05/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),f=he(t);n=Xt(864e5*(f+1),"x").format("MMMM DD, YYYY"),c>f?(a="expired",l="expired"):(a="valid",l="valid")}else o?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(de()&&(a="valid",l="valid"),!pe&&"valid"!==a){var h=ye[a]({keyValidityDate:n,hotVersion:i});h&&console["non_commercial"===a?"info":"warn"](ye[a]({keyValidityDate:n,hotVersion:i})),pe=!0}if("valid"!==l&&e.parentNode){var d=ve[l]({keyValidityDate:n,hotVersion:i});if(d){var p=document.createElement("div");p.className="hot-display-license-info",p.innerHTML=ve[l]({keyValidityDate:n,hotVersion:i}),e.parentNode.insertBefore(p,e.nextSibling)}}}function ge(t){var e=[][ae],n=e;if(t[ae]!==ce("Z"))return!1;for(var r="",o="B<H4P+".split(""),i=ce(o.shift());i;i=ce(o.shift()||"A"))--i<""[ae]?n|=(se("".concat(se(le(r)+(le(ue(t,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:r=ue(t,i,i?1===o[ae]?9:8:6);return n===e}function be(t){return t[0].toUpperCase()+t.substr(1)}function we(){for(var t=[],e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=n.length;while(o){o-=1;var i=Jt(n[o]).toLowerCase();-1===t.indexOf(i)&&t.push(i)}return 1===t.length}function Se(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function Ce(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function Oe(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(t).replace(/(?:\\)?\[([^[\]]+)]/g,(function(t,n){return"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[n]?"":e[n]}))}function ke(t){return Re("".concat(t),{ALLOWED_TAGS:[]})}function Re(t,e){return Kt.sanitize(t,e)}function Ee(t){return Ae(t)||je(t)||Te(t)||Pe()}function Pe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Te(t,e){if(t){if("string"===typeof t)return Me(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Me(t,e):void 0}}function je(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Ae(t){if(Array.isArray(t))return Me(t)}function Me(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ie(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null,o=t;while(null!==o){if(n===e){r=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(n+=1,o=o.parentNode)}return r}function xe(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function _e(t){return xe(t)&&t.parent}function He(t){return!!Object.getPrototypeOf(t.parent)}function Ne(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=Node,o=r.ELEMENT_NODE,i=r.DOCUMENT_FRAGMENT_NODE,a=t;while(null!==a&&void 0!==a&&a!==n){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(e.includes(u)||e.includes(a)))return a;var c=a,f=c.host;a=f&&s===i?f:a.parentNode}return null}function De(t,e,n){var r=[],o=t;while(o){if(o=Ne(o,e,n),!o||n&&!n.contains(o))break;r.push(o),o=o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o.parentNode}var i=r.length;return i?r[i-1]:null}function Le(t,e){var n=t.parentNode,r=[];"string"===typeof e?r=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);while(null!==n){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Be(t){var e=0,n=t;if(n.previousSibling)while(n=n.previousSibling)e+=1;return e}function Ve(t,e,n){var r=n.parentElement.querySelector(".ht_clone_".concat(t));return r?r.contains(e):null}function Fe(t){return t&&t.length?t.filter((function(t){return!!t})):[]}if(T()){var We=function(t){var e=t.createElement("div");return e.classList.add("test","test2"),e.classList.contains("test2")};re=function(t,e){return void 0!==t.classList&&"string"===typeof e&&""!==e&&t.classList.contains(e)},oe=function(t,e){var n=t.ownerDocument,r=e;if("string"===typeof r&&(r=r.split(" ")),r=Fe(r),r.length>0)if(We(n)){var o;(o=t.classList).add.apply(o,Ee(r))}else{var i=0;while(r[i])t.classList.add(r[i]),i+=1}},ie=function(t,e){var n=t.ownerDocument,r=e;if("string"===typeof r&&(r=r.split(" ")),r=Fe(r),r.length>0)if(We(n)){var o;(o=t.classList).remove.apply(o,Ee(r))}else{var i=0;while(r[i])t.classList.remove(r[i]),i+=1}}}else{var Ue=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};re=function(t,e){return void 0!==t.className&&Ue(e).test(t.className)},oe=function(t,e){var n=t.className,r=e;if("string"===typeof r&&(r=r.split(" ")),r=Fe(r),""===n)n=r.join(" ");else for(var o=0;o<r.length;o++)r[o]&&!Ue(r[o]).test(n)&&(n+=" ".concat(r[o]));t.className=n},ie=function(t,e){var n=0,r=t.className,o=e;"string"===typeof o&&(o=o.split(" ")),o=Fe(o);while(o[n])r=r.replace(Ue(o[n])," ").trim(),n+=1;t.className!==r&&(t.className=r)}}function ze(t,e){return re(t,e)}function Ge(t,e){oe(t,e)}function Ye(t,e){ie(t,e)}function Ke(t){if(3===t.nodeType)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1)for(var e=t.childNodes,n=e.length-1;n>=0;n--)Ke(e[n])}function Xe(t){var e;while(e=t.lastChild)t.removeChild(e)}var $e,qe=/(<(.*)>|&(.*);)/;function Qe(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];qe.test(e)?t.innerHTML=n?Re(e):e:Je(t,e)}function Je(t,e){var n=t.firstChild;n&&3===n.nodeType&&null===n.nextSibling?j?n.textContent=e:n.data=e:(Xe(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Ze(t){var e=t.ownerDocument.documentElement,n=t;while(n!==e){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return Ze(n.host.impl);if(n.host)return Ze(n.host);throw new Error("Lost in Web Components world")}return!1}if(n.style&&"none"===n.style.display)return!1;n=n.parentNode}return!0}function tn(t){var e,n,r,o,i=t.ownerDocument,a=i.defaultView,l=i.documentElement,s=t;if(_()&&s.firstChild&&"CAPTION"===s.firstChild.nodeName)return o=s.getBoundingClientRect(),{top:o.top+(a.pageYOffset||l.scrollTop)-(l.clientTop||0),left:o.left+(a.pageXOffset||l.scrollLeft)-(l.clientLeft||0)};e=s.offsetLeft,n=s.offsetTop,r=s;while(s=s.offsetParent){if(s===i.body)break;e+=s.offsetLeft,n+=s.offsetTop,r=s}return r&&"fixed"===r.style.position&&(e+=a.pageXOffset||l.scrollLeft,n+=a.pageYOffset||l.scrollTop),{left:e,top:n}}function en(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.scrollY;return void 0===e&&(e=t.document.documentElement.scrollTop),e}function nn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.scrollX;return void 0===e&&(e=t.document.documentElement.scrollLeft),e}function rn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?en(e):t.scrollTop}function on(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?nn(e):t.scrollLeft}function an(t){var e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);var r=["auto","scroll"],o=A(),i=t.parentNode;while(i&&i.style&&e.body!==i){var a=i.style,l=a.overflow,s=a.overflowX,u=a.overflowY;if([l,s,u].includes("scroll"))return i;if(o){var c=n.getComputedStyle(i);if(l=c.overflow,s=c.overflowX,u=c.overflowY,r.includes(l)||r.includes(s)||r.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(r.includes(u)||r.includes(l)))return i;if(i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(l)))return i;i=i.parentNode}return n}function ln(t){var e=t.ownerDocument,n=e.defaultView,r=t.parentNode;while(r&&r.style&&e.body!==r){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;var o=cn(r,n),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return r;r=r.parentNode}return n}function sn(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(t){if(t===n)return"width"===e?"".concat(n.innerWidth,"px"):"height"===e?"".concat(n.innerHeight,"px"):void 0;var r=t.style[e];if(""!==r&&void 0!==r)return r;var o=cn(t,n);return""!==o[e]&&void 0!==o[e]?o[e]:void 0}}function un(t,e){var n=e.selectorText,r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function cn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function fn(t){return t.offsetWidth}function hn(t){return _()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName?t.offsetHeight+t.firstChild.offsetHeight:t.offsetHeight}function dn(t){return t.clientHeight||t.innerHeight}function pn(t){return t.clientWidth||t.innerWidth}function yn(t,e,n){t.addEventListener(e,n,!1)}function vn(t,e,n){t.removeEventListener(e,n,!1)}function mn(t){var e=t.ownerDocument;if(t.selectionStart)return t.selectionStart;if(e.selection){t.focus();var n=e.selection.createRange();if(null===n)return 0;var r=t.createTextRange(),o=r.duplicate();return r.moveToBookmark(n.getBookmark()),o.setEndPoint("EndToStart",r),o.text.length}return 0}function gn(t){var e=t.ownerDocument;if(t.selectionEnd)return t.selectionEnd;if(e.selection){var n=e.selection.createRange();if(null===n)return 0;var r=t.createTextRange();return r.text.indexOf(n.text)+n.text.length}return 0}function bn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.document,n="";return t.getSelection?n=t.getSelection().toString():e.selection&&"Control"!==e.selection.type&&(n=e.selection.createRange().text),n}function wn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.document;t.getSelection?t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges():e.selection&&e.selection.empty()}function Sn(t,e,n){if(void 0===n&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch(i){var r=t.parentNode,o=r.style.display;r.style.display="block",t.setSelectionRange(e,n),r.style.display=o}}}function Cn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";var n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);var r=e.offsetWidth;n.style.overflow="scroll";var o=e.offsetWidth;return r===o&&(o=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-o}function On(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===$e&&($e=Cn(t)),$e}function kn(t){return t.offsetWidth!==t.clientWidth}function Rn(t){return t.offsetHeight!==t.clientHeight}function En(t,e,n){xt()?(t.style.top=n,t.style.left=e):jt()?t.style["-webkit-transform"]="translate3d(".concat(e,",").concat(n,",0)"):t.style.transform="translate3d(".concat(e,",").concat(n,",0)")}function Pn(t){var e;return t.style.transform&&""!==(e=t.style.transform)?["transform",e]:t.style["-webkit-transform"]&&""!==(e=t.style["-webkit-transform"])?["-webkit-transform",e]:-1}function Tn(t){t.style.transform&&""!==t.style.transform?t.style.transform="":t.style["-webkit-transform"]&&""!==t.style["-webkit-transform"]&&(t.style["-webkit-transform"]="")}function jn(t){var e=["INPUT","SELECT","TEXTAREA"];return t&&(e.indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function An(t){return jn(t)&&!1===t.hasAttribute("data-hot-input")}function Mn(t){var e=t.ownerDocument.activeElement;An(e)||t.select()}function In(t){return!t.parentNode}function xn(t,e){var n=new IntersectionObserver((function(n,r){n.forEach((function(n){n.isIntersecting&&null!==t.offsetParent&&(e(),r.unobserve(t))}))}),{root:t.ownerDocument.body});n.observe(t)}function _n(t){return"function"===typeof t}function Hn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0,r={lastCallThrottled:!0},o=null;function i(){for(var i=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];var u=Date.now(),c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);var f=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,l)):(o&&clearTimeout(o),o=setTimeout((function(){r.lastCallThrottled=!1,t.apply(i,l),n=0,o=void 0}),f)),r}return i}function Nn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=Hn(t,e),o=n;function i(){o=n}function a(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return o?(o-=1,t.apply(this,n)):r.apply(this,n)}return a.clearHits=i,a}function Dn(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;function o(){for(var o=this,i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout((function(){e=t.apply(o,a)}),n),e}return o}function Ln(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],o=e.slice(1);return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return V(o,(function(t,e){return e(t)}),r.apply(this,e))}}function Bn(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t.apply(this,n.concat(r))}}function Vn(t){var e=t.length;function n(r){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var l,s=r.concat(i);return l=s.length>=e?t.apply(this,s):n(s),l}}return n([])}function Fn(t){var e=t.length;function n(r){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var l,s=r.concat(i.reverse());return l=s.length>=e?t.apply(this,s):n(s),l}}return n([])}function Wn(t,e,n,r,o,i,a,l){return Zt(l)?t.call(e,n,r,o,i,a,l):Zt(a)?t.call(e,n,r,o,i,a):Zt(i)?t.call(e,n,r,o,i):Zt(o)?t.call(e,n,r,o):Zt(r)?t.call(e,n,r):Zt(n)?t.call(e,n):t.call(e)}function Un(){var t;Zt(console)&&(t=console).warn.apply(t,arguments)}function zn(){var t;Zt(console)&&(t=console).error.apply(t,arguments)}n(682);var Gn,Yn={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Pt()?182:174,AUDIO_MUTE:Pt()?181:173,AUDIO_UP:Pt()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Kn=[Yn.ALT,Yn.ARROW_DOWN,Yn.ARROW_LEFT,Yn.ARROW_RIGHT,Yn.ARROW_UP,Yn.AUDIO_DOWN,Yn.AUDIO_MUTE,Yn.AUDIO_UP,Yn.BACKSPACE,Yn.CAPS_LOCK,Yn.DELETE,Yn.END,Yn.ENTER,Yn.ESCAPE,Yn.F1,Yn.F2,Yn.F3,Yn.F4,Yn.F5,Yn.F6,Yn.F7,Yn.F8,Yn.F9,Yn.F10,Yn.F11,Yn.F12,Yn.F13,Yn.F14,Yn.F15,Yn.F16,Yn.F17,Yn.F18,Yn.F19,Yn.HOME,Yn.INSERT,Yn.MEDIA_NEXT,Yn.MEDIA_PLAY_PAUSE,Yn.MEDIA_PREV,Yn.MEDIA_STOP,Yn.NULL,Yn.NUM_LOCK,Yn.PAGE_DOWN,Yn.PAGE_UP,Yn.PAUSE,Yn.SCROLL_LOCK,Yn.SHIFT,Yn.TAB];function Xn(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function $n(t){return Kn.includes(t)}function qn(t){var e=[];return Bt()?e.push(Yn.COMMAND_LEFT,Yn.COMMAND_RIGHT,Yn.COMMAND_FIREFOX):e.push(Yn.CONTROL),e.includes(t)}function Qn(t){return[Yn.CONTROL,Yn.COMMAND_LEFT,Yn.COMMAND_RIGHT,Yn.COMMAND_FIREFOX].includes(t)}function Jn(t,e){var n=e.split("|"),r=!1;return U(n,(function(e){if(t===Yn[e])return r=!0,!1})),r}function Zn(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function tr(t){return!1===t.isImmediatePropagationEnabled}function er(t){return 2===t.button}function nr(t){return 0===t.button}function rr(t){return rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rr(t)}function or(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ir(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lr(r.key),r)}}function ar(t,e,n){return e&&ir(t.prototype,e),n&&ir(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function lr(t){var e=sr(t,"string");return"symbol"===rr(e)?e:String(e)}function sr(t,e){if("object"!==rr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==rr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ur(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var cr=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],fr=$t(Gn||(Gn=ur(['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. \n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to \n  learn about the migration path.'],['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20\n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20\n  learn about the migration path.']))),hr=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),dr=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),pr=function(){function t(){or(this,t),this.globalBucket=this.createEmptyBucket()}return ar(t,[{key:"createEmptyBucket",value:function(){var t=Object.create(null);return U(cr,(function(e){return t[e]=[]})),t}},{key:"getBucket",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}},{key:"add",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))U(e,(function(e){return n.add(t,e,r)}));else{hr.has(t)&&Un(Oe(fr,{hookName:t,removedInVersion:hr.get(t)})),dr.has(t)&&Un(dr.get(t));var o=this.getBucket(r);if("undefined"===typeof o[t]&&(this.register(t),o[t]=[]),e.skip=!1,-1===o[t].indexOf(e)){var i=!1;e.initialHook&&U(o[t],(function(n,r){if(n.initialHook)return o[t][r]=e,i=!0,!1})),i||o[t].push(e)}}return this}},{key:"once",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?U(e,(function(e){return n.once(t,e,r)})):(e.runOnce=!0,this.add(t,e,r))}},{key:"remove",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(n);return"undefined"!==typeof r[t]&&r[t].indexOf(e)>=0&&(e.skip=!0,!0)}},{key:"has",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(e);return!(void 0===n[t]||!n[t].length)}},{key:"run",value:function(t,e,n,r,o,i,a,l){var s=this.globalBucket[e],u=s?s.length:0,c=0;if(u)while(c<u)if(s[c]&&!s[c].skip){var f=Wn(s[c],t,n,r,o,i,a,l);void 0!==f&&(n=f),s[c]&&s[c].runOnce&&this.remove(e,s[c]),c+=1}else c+=1;var h=this.getBucket(t)[e],d=h?h.length:0,p=0;if(d)while(p<d)if(h[p]&&!h[p].skip){var y=Wn(h[p],t,n,r,o,i,a,l);void 0!==y&&(n=y),h[p]&&h[p].runOnce&&this.remove(e,h[p],t),p+=1}else p+=1;return n}},{key:"destroy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;pt(this.getBucket(t),(function(t,e,n){return n[e].length=0}))}},{key:"register",value:function(t){this.isRegistered(t)||cr.push(t)}},{key:"deregister",value:function(t){this.isRegistered(t)&&cr.splice(cr.indexOf(t),1)}},{key:"isDeprecated",value:function(t){return dr.has(t)||hr.has(t)}},{key:"isRegistered",value:function(t){return cr.indexOf(t)>=0}},{key:"getRegistered",value:function(){return cr}}],[{key:"getSingleton",value:function(){return vr()}}]),t}(),yr=new pr;function vr(){return yr}var mr=pr;function gr(t){return Cr(t)||Sr(t)||wr(t)||br()}function br(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function wr(t,e){if(t){if("string"===typeof t)return Or(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Or(t,e):void 0}}function Sr(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Cr(t){if(Array.isArray(t))return Or(t)}function Or(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var kr=new Map;function Rr(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";kr.has(t)||kr.set(t,new Map);var e=kr.get(t);function n(t,n){e.set(t,n)}function r(t){return e.get(t)}function o(t){return e.has(t)}function i(){return gr(e.keys())}function a(){return gr(e.values())}return{register:n,getItem:r,hasItem:o,getNames:i,getValues:a}}var Er=new WeakMap,Pr=Rr("editors"),Tr=Pr.register,jr=Pr.getItem,Ar=Pr.hasItem,Mr=Pr.getNames;Pr.getValues;function Ir(t){var e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new n(t)),e[t.guid]},mr.getSingleton().add("afterDestroy",(function(){e[this.guid]=null}))}function xr(t,e){var n;if("function"===typeof t)Er.get(t)||Hr(null,t),n=Er.get(t);else{if("string"!==typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');n=jr(t)}if(!n)throw Error('No editor registered under name "'.concat(t,'"'));return n.getInstance(e)}function _r(t){if("function"===typeof t)return t;if(!Ar(t))throw Error('No registered editor found under "'.concat(t,'" name'));return jr(t).getConstructor()}function Hr(t,e){t&&"string"!==typeof t&&(e=t,t=e.EDITOR_TYPE);var n=new Ir(e);"string"===typeof t&&Tr(t,n),Er.set(e,n)}function Nr(t){return Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nr(t)}function Dr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vr(r.key),r)}}function Br(t,e,n){return e&&Lr(t.prototype,e),n&&Lr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Vr(t){var e=Fr(t,"string");return"symbol"===Nr(e)?e:String(e)}function Fr(t,e){if("object"!==Nr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Nr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Wr=0,Ur=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Dr(this,t),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}return Br(t,[{key:"addEventListener",value:function(t,e,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(t){n.call(this,zr(t))}return"boolean"===typeof o||N()||(o=!1),this.context.eventListeners.push({element:t,event:e,callback:n,callbackProxy:i,options:o,eventManager:this}),t.addEventListener(e,i,o),Wr+=1,function(){r.removeEventListener(t,e,n)}}},{key:"removeEventListener",value:function(t,e,n){var r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.context.eventListeners.length;while(i)if(i-=1,r=this.context.eventListeners[i],r.event===e&&r.element===t){if(n&&n!==r.callback)continue;if(o&&r.eventManager!==this)continue;this.context.eventListeners.splice(i,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Wr-=1}}},{key:"clearEvents",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.context){var e=this.context.eventListeners.length;while(e){e-=1;var n=this.context.eventListeners[e];t&&n.eventManager!==this||(this.context.eventListeners.splice(e,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),Wr-=1)}}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(t,e){var n=t.document,r=t;n||(n=t.ownerDocument?t.ownerDocument:t,r=n.defaultView);var o,i={bubbles:!0,cancelable:"mousemove"!==e,view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(e,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||n.body.parentNode)):o=n.createEventObject(),t.dispatchEvent?t.dispatchEvent(o):t.fireEvent("on".concat(e),o)}}]),t}();function zr(t){var e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Zn(this)},t}var Gr=Ur;function Yr(){return Wr}function Kr(t){return Kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kr(t)}function Xr(t,e){return Zr(t)||Jr(t,e)||qr(t,e)||$r()}function $r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function qr(t,e){if(t){if("string"===typeof t)return Qr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qr(t,e):void 0}}function Qr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Jr(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Zr(t){if(Array.isArray(t))return t}function to(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ro(r.key),r)}}function no(t,e,n){return e&&eo(t.prototype,e),n&&eo(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ro(t){var e=oo(t,"string");return"symbol"===Kr(e)?e:String(e)}function oo(t,e){if("object"!==Kr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Kr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var io="editorManager.navigation",ao="editorManager.handlingEditor",lo=function(){function t(e,n,r){var o=this;to(this,t),this.instance=e,this.tableMeta=n,this.selection=r,this.eventManager=new Gr(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",(function(t){return o.onAfterDocumentKeyDown(t)})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(function(t){!o.destroyed&&o.instance.isListening()&&o.openEditor("",t)})),this.instance.view._wt.update("onCellDblClick",(function(t,e,n){return o.onCellDblClick(t,e,n)}))}return no(t,[{key:"registerShortcuts",value:function(){var t=this,e=this.instance.getShortcutManager(),n=e.getContext("grid"),r=e.getContext("editor"),o={group:ao};r.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(n,r){t.closeEditorAndSaveChanges(e.isCtrlPressed()),t.moveSelectionAfterEnter(r.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){t.closeEditorAndRestoreOriginalValue(e.isCtrlPressed()),t.activeEditor.focus()}}],o),n.addShortcuts([{keys:[["F2"]],callback:function(e){t.openEditor(null,e,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){t.instance.emptySelectedCells(),t.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(e,n){t.instance.getSettings().enterBeginsEditing?t.cellProperties.readOnly?t.moveSelectionAfterEnter():t.openEditor(null,e,!0):t.moveSelectionAfterEnter(n.includes("shift")),Zn(e)}}],o)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(t){this.lock||this.closeEditor(t)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var t=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,(function(e){e&&t.prepareEditor()}));else{var e=this.instance.getSelectedRangeLast().highlight,n=e.row,r=e.col,o=this.instance.runHooks("modifyGetCellCoords",n,r),i=n,a=r;if(Array.isArray(o)){var l=Xr(o,2);i=l[0],a=l[1]}this.cellProperties=this.instance.getCellMeta(i,a);var s=this.instance.rootDocument.activeElement;if(s&&An(s)&&s.blur(),this.isCellEditable()){var u=this.instance.getCell(n,r,!0);if(u){var c=this.instance.getCellEditor(this.cellProperties),f=this.instance.colToProp(a),h=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(i),a);this.activeEditor=xr(c,this.instance),this.activeEditor.prepare(n,r,f,u,h,this.cellProperties)}}else this.clearActiveEditor()}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.isCellEditable()){if(!this.activeEditor){var r=this.instance.getSelectedRangeLast().highlight,o=r.row,i=r.col,a=this.instance.rowIndexMapper.getRenderableFromVisualIndex(o),l=this.instance.columnIndexMapper.getRenderableFromVisualIndex(i);this.instance.view.scrollViewport(this.instance._createCellCoords(a,l)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))}else this.clearActiveEditor()}},{key:"closeEditor",value:function(t,e,n){this.activeEditor?this.activeEditor.finishEditing(t,e,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(t){this.closeEditor(!1,t)}},{key:"closeEditorAndRestoreOriginalValue",value:function(t){this.closeEditor(!0,t)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var t=this.instance.getCellEditor(this.cellProperties),e=this.instance.getSelectedRangeLast().highlight,n=e.row,r=e.col,o=this.instance,i=o.rowIndexMapper,a=o.columnIndexMapper,l=i.isHidden(this.instance.toPhysicalRow(n))||a.isHidden(this.instance.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!t||l)}},{key:"moveSelectionAfterEnter",value:function(t){var e="function"===typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;t?this.selection.transformStart(-e.row,-e.col):this.selection.transformStart(e.row,e.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(t){var e=this;if(this.instance.isListening()){var n=t.keyCode;if(this.selection.isSelected()){var r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!$n(n)&&!Qn(n)&&!r&&!this.isEditorOpened()){var o=this.instance.getShortcutManager(),i=o.getContext("editor"),a={runOnlyIf:function(){return Zt(e.instance.getSelected())},group:io};i.addShortcuts([{keys:[["ArrowUp"]],callback:function(){e.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){e.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){e.instance.selection.transformStart(0,-1*e.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){e.instance.selection.transformStart(0,e.instance.getDirectionFactor())}}],a),this.openEditor("",t)}}}}},{key:"onCellDblClick",value:function(t,e,n){"TD"===n.nodeName&&this.openEditor(null,t,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),t}(),so=new WeakMap;lo.getInstance=function(t,e,n){var r=so.get(t);return r||(r=new lo(t,e,n),so.set(t,r)),r};var uo=lo;n(2104),n(891),n(538),n(4945),n(3101);function co(t){return yo(t)||po(t)||ho(t)||fo()}function fo(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ho(t,e){if(t){if("string"===typeof t)return vo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vo(t,e):void 0}}function po(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function yo(t){if(Array.isArray(t))return vo(t)}function vo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var mo={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},go=new RegExp(Object.keys(mo).map((function(t){return"(".concat(t,")")})).join("|"),"gi");function bo(t){return"TABLE"===(t&&t.nodeName||"")}function wo(t){for(var e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],o=t.getData.apply(t,r),i=o.length,a=i>0?o[0].length:0,l=["<table>","</table>"],s=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,f=e?1:0,h=0;h<i;h+=1){for(var d=e&&0===h,p=[],y=0;y<a;y+=1){var v=!d&&n&&0===y,m="";if(d)m="<th>".concat(t.getColHeader(y-c),"</th>");else if(v)m="<th>".concat(t.getRowHeader(h-f),"</th>");else{var g=o[h][y],b=t.getCellMeta(h-f,y-c),w=b.hidden,S=b.rowspan,C=b.colspan;if(!w){var O=[];if(S&&O.push('rowspan="'.concat(S,'"')),C&&O.push('colspan="'.concat(C,'"')),ee(g))m="<td ".concat(O.join(" "),"></td>");else{var k=g.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");m="<td ".concat(O.join(" "),">").concat(k,"</td>")}}}p.push(m)}var R=["<tr>"].concat(p,["</tr>"]).join("");d?s.splice(1,0,R):u.splice(-1,0,R)}return l.splice(1,0,s.join(""),u.join("")),l.join("")}function So(t){for(var e=t.length,n=["<table>"],r=0;r<e;r+=1){var o=t[r],i=o.length,a=[];0===r&&n.push("<tbody>");for(var l=0;l<i;l+=1){var s=o[l],u=ee(s)?"":s.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,(function(t){return'<span style="mso-spacerun: yes">'.concat("&nbsp;".repeat(t.length-1)," </span>")})).replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}n.push.apply(n,["<tr>"].concat(a,["</tr>"])),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function Co(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n={},r=e.createDocumentFragment(),o=e.createElement("div");r.appendChild(o);var i=t;if("string"===typeof i){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(function(t){var e=t.match(/<td\b[^>]*?>/g)[0],n=t.substring(e.length,t.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),r="</td>";return"".concat(e).concat(n).concat(r)}));o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(i&&bo(i)){var l=o.querySelector('meta[name$="enerator"]'),s=null!==i.querySelector("tbody th"),u=i.querySelector("tr"),c=u?Array.from(u.cells).reduce((function(t,e){return t+e.colSpan}),0)-(s?1:0):0,f=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],d=!1,p=0,y=0;if(i.tHead){var v=Array.from(i.tHead.rows).filter((function(t){var e=null!==t.querySelector("td");return e&&h.push(t),!e}));p=v.length,d=p>0,p>1?n.nestedHeaders=Array.from(v).reduce((function(t,e){var n=Array.from(e.cells).reduce((function(t,e,n){if(s&&0===n)return t;var r=e.colSpan,o=e.innerHTML,i=r>1?{label:o,colspan:r}:o;return t.push(i),t}),[]);return t.push(n),t}),[]):d&&(n.colHeaders=Array.from(v[0].children).reduce((function(t,e,n){return s&&0===n||t.push(e.innerHTML),t}),[]))}h.length&&(n.fixedRowsTop=h.length),f.length&&(n.fixedRowsBottom=f.length);var m=[].concat(h,co(Array.from(i.tBodies).reduce((function(t,e){return t.push.apply(t,co(Array.from(e.rows))),t}),[])),co(f));y=m.length;for(var g=new Array(y),b=0;b<y;b++)g[b]=new Array(c);for(var w=[],S=[],C=0;C<y;C++)for(var O=m[C],k=Array.from(O.cells),R=k.length,E=0;E<R;E++){var P=k[E],T=P.nodeName,j=P.innerHTML,A=P.rowSpan,M=P.colSpan,I=g[C].findIndex((function(t){return void 0===t}));if("TD"===T){if(A>1||M>1){for(var x=C;x<C+A;x++)if(x<y)for(var _=I;_<I+M;_++)g[x][_]=null;var H=P.getAttribute("style"),N=H&&H.includes("mso-ignore:colspan");N||w.push({col:I,row:C,rowspan:A,colspan:M})}var D="";D=l&&/excel/gi.test(l.content)?j.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):j.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),g[C][I]=D.replace(go,(function(t){return mo[t]}))}else S.push(j)}return w.length&&(n.mergeCells=w),S.length&&(n.rowHeaders=S),g.length&&(n.data=g),n}}function Oo(t){return Po(t)||Eo(t)||Ro(t)||ko()}function ko(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ro(t,e){if(t){if("string"===typeof t)return To(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?To(t,e):void 0}}function Eo(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Po(t){if(Array.isArray(t))return To(t)}function To(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function jo(t){return jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jo(t)}function Ao(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=jo(t);if("number"===n)return!isNaN(t)&&isFinite(t);if("string"===n){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);var r=Array.from(new Set(["."].concat(Oo(e)))).map((function(t){return"\\".concat(t)})).join("|");return new RegExp("^[+-]?\\s*(((".concat(r,")?\\d+((").concat(r,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(t.trim())}return"object"===n&&(!!t&&"number"===typeof t.valueOf()&&!(t instanceof Date))}function Mo(t){return Ao(t,[","])}function Io(t,e,n){var r=-1;"function"===typeof e?(n=e,e=t):r=t-1;while(++r<=e)if(!1===n(r))break}function xo(t,e,n){var r=t+1;"function"===typeof e&&(n=e,e=0);while(--r>=e)if(!1===n(r))break}function _o(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ho(t){return Lo(t)||Do(t)||Fo(t)||No()}function No(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Do(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Lo(t){if(Array.isArray(t))return Wo(t)}function Bo(t,e){return zo(t)||Uo(t,e)||Fo(t,e)||Vo()}function Vo(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Fo(t,e){if(t){if("string"===typeof t)return Wo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wo(t,e):void 0}}function Wo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Uo(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function zo(t){if(Array.isArray(t))return t}var Go="asc",Yo="desc",Ko=new Map([[Go,[-1,1]],[Yo,[1,-1]]]),Xo=function(t){return"The priority '".concat(t,"' is already declared in a map.")},$o=function(t){return"The priority '".concat(t,"' is not a number.")};function qo(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.errorPriorityExists,n=t.errorPriorityNaN,r=new Map;function o(t,o){if(!Ao(t))throw new Error(n(t));if(r.has(t))throw new Error(e(t));r.set(t,o)}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Go,e=Ko.get(t)||Ko.get(Go),n=Bo(e,2),o=n[0],i=n[1];return Ho(r).sort((function(t,e){return t[0]<e[0]?o:i})).map((function(t){return t[1]}))}return e=_n(e)?e:Xo,n=_n(n)?n:$o,{addItem:o,getItems:i}}n(5565);function Qo(t){return ti(t)||Zo(t)||ri(t)||Jo()}function Jo(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Zo(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function ti(t){if(Array.isArray(t))return oi(t)}function ei(t,e){return ai(t)||ii(t,e)||ri(t,e)||ni()}function ni(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ri(t,e){if(t){if("string"===typeof t)return oi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oi(t,e):void 0}}function oi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ii(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ai(t){if(Array.isArray(t))return t}var li=function(t){return"The id '".concat(t,"' is already declared in a map.")};function si(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.errorIdExists,n=new Map;function r(t,r){if(u(t))throw new Error(e(t));n.set(t,r)}function o(t){return n.delete(t)}function i(){n.clear()}function a(t){var e=s().find((function(e){var n=ei(e,2),r=n[0],o=n[1];return t===o&&r}))||[null],n=ei(e,1),r=n[0];return r}function l(t){return n.get(t)}function s(){return Qo(n)}function u(t){return n.has(t)}return e=_n(e)?e:li,{addItem:r,clear:i,getId:a,getItem:l,getItems:s,hasItem:u,removeItem:o}}function ui(t){return di(t)||hi(t)||fi(t)||ci()}function ci(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fi(t,e){if(t){if("string"===typeof t)return pi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pi(t,e):void 0}}function hi(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function di(t){if(Array.isArray(t))return pi(t)}function pi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var yi=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function vi(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.errorItemExists,n=new Set;function r(t){if(n.has(t))throw new Error(e(t));n.add(t)}function o(){return ui(n)}function i(){n.clear()}return e=_n(e)?e:yi,{addItem:r,clear:i,getItems:o}}function mi(t,e){return wi(t)||bi(t,e)||Oi(t,e)||gi()}function gi(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function bi(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function wi(t){if(Array.isArray(t))return t}function Si(t){return Ri(t)||ki(t)||Oi(t)||Ci()}function Ci(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Oi(t,e){if(t){if("string"===typeof t)return Ei(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ei(t,e):void 0}}function ki(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Ri(t){if(Array.isArray(t))return Ei(t)}function Ei(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Pi=function(t){return'There is already registered "'.concat(t,'" plugin.')},Ti=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},ji=function(t){return'The priority "'.concat(t,'" is not a number.')},Ai=qo({errorPriorityExists:Ti,errorPriorityNaN:ji}),Mi=vi({errorItemExists:Pi}),Ii=si({errorIdExists:Pi});function xi(){return[].concat(Si(Ai.getItems()),Si(Mi.getItems()))}function _i(t){var e=be(t);return Ii.getItem(e)}function Hi(t){return!!_i(t)}function Ni(t,e,n){var r=Li(t,e,n),o=mi(r,3);t=o[0],e=o[1],n=o[2],void 0===_i(t)&&Di(t,e,n)}function Di(t,e,n){var r=be(t);if(Ii.hasItem(r))throw new Error(Pi(r));void 0===n?Mi.addItem(r):Ai.addItem(n,r),Ii.addItem(r,e)}function Li(t,e,n){return"function"===typeof t&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}var Bi=Rr("renderers"),Vi=Bi.register,Fi=Bi.getItem,Wi=Bi.hasItem,Ui=Bi.getNames;Bi.getValues;function zi(t){if("function"===typeof t)return t;if(!Wi(t))throw Error('No registered renderer found under "'.concat(t,'" name'));return Fi(t)}function Gi(t,e){"string"!==typeof t&&(e=t,t=e.RENDERER_TYPE),Vi(t,e)}var Yi=Rr("validators"),Ki=Yi.register,Xi=Yi.getItem,$i=Yi.hasItem,qi=Yi.getNames;Yi.getValues;function Qi(t){if("function"===typeof t)return t;if(!$i(t))throw Error('No registered validator found under "'.concat(t,'" name'));return Xi(t)}function Ji(t,e){"string"!==typeof t&&(e=t,t=e.VALIDATOR_TYPE),Ki(t,e)}n(3462),n(4038);function Zi(t){return Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zi(t)}function ta(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ea(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ra(r.key),r)}}function na(t,e,n){return e&&ea(t.prototype,e),n&&ea(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ra(t){var e=oa(t,"string");return"symbol"===Zi(e)?e:String(e)}function oa(t,e){if("object"!==Zi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Zi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ia=new WeakMap,aa=function(){function t(e,n,r,o,i,a){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;ta(this,t),this.wtSettings=r,this.domBindings=n,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=e,ia.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return na(t,[{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",(function(e){return t.onContextMenu(e)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",(function(e){return t.onMouseOut(e)}));var e=function(){t.eventManager.addEventListener(t.wtTable.holder,"touchstart",(function(e){return t.onTouchStart(e)})),t.eventManager.addEventListener(t.wtTable.holder,"touchend",(function(e){return t.onTouchEnd(e)})),t.momentumScrolling||(t.momentumScrolling={}),t.eventManager.addEventListener(t.wtTable.holder,"scroll",(function(){clearTimeout(t.momentumScrolling._timeout),t.momentumScrolling.ongoing||t.wtSettings.getSetting("onBeforeTouchScroll"),t.momentumScrolling.ongoing=!0,t.momentumScrolling._timeout=setTimeout((function(){t.touchApplied||(t.momentumScrolling.ongoing=!1,t.wtSettings.getSetting("onAfterMomentumScroll"))}),200)}))},n=function(){t.eventManager.addEventListener(t.wtTable.holder,"mouseup",(function(e){return t.onMouseUp(e)})),t.eventManager.addEventListener(t.wtTable.holder,"mousedown",(function(e){return t.onMouseDown(e)}))};Ht()?e():(I()&&e(),n())}},{key:"selectedCellWasTouched",value:function(t){var e=ia.get(this),n=this.parentCell(t),r=n.coords;if(e.selectedCellBeforeTouchEnd&&r){var o=[r.row,e.selectedCellBeforeTouchEnd.from.row],i=o[0],a=o[1],l=[r.col,e.selectedCellBeforeTouchEnd.from.col],s=l[0],u=l[1];return i===a&&s===u}return!1}},{key:"parentCell",value:function(t){var e={},n=this.wtTable.TABLE,r=De(t,["TD","TH"],n);return r?(e.coords=this.wtTable.getCoords(r),e.TD=r):ze(t,"wtBorder")&&ze(t,"current")?(e.coords=this.selections.getCell().cellRange.highlight,e.TD=this.wtTable.getCell(e.coords)):ze(t,"wtBorder")&&ze(t,"area")&&this.selections.createOrGetArea().cellRange&&(e.coords=this.selections.createOrGetArea().cellRange.to,e.TD=this.wtTable.getCell(e.coords)),e}},{key:"onMouseDown",value:function(t){var e=ia.get(this),n=this.domBindings.rootDocument.activeElement,r=Bn(Ie,t.target),o=t.target;if(o!==n&&r(0)!==n&&r(1)!==n){var i=this.parentCell(o);ze(o,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",t,o):i.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,i.coords,i.TD),(0===t.button||this.touchApplied)&&i.TD&&(e.dblClickOrigin[0]=i.TD,clearTimeout(e.dblClickTimeout[0]),e.dblClickTimeout[0]=setTimeout((function(){e.dblClickOrigin[0]=null}),1e3))}}},{key:"onContextMenu",value:function(t){if(this.wtSettings.has("onCellContextMenu")){var e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}},{key:"onMouseOver",value:function(t){if(this.wtSettings.has("onCellMouseOver")){var e=this.wtTable.TABLE,n=De(t.target,["TD","TH"],e),r=this.parent||this;n&&n!==r.lastMouseOver&&Le(n,e)&&(r.lastMouseOver=n,this.callListener("onCellMouseOver",t,this.wtTable.getCoords(n),n))}}},{key:"onMouseOut",value:function(t){if(this.wtSettings.has("onCellMouseOut")){var e=this.wtTable.TABLE,n=De(t.target,["TD","TH"],e),r=De(t.relatedTarget,["TD","TH"],e),o=this.parent||this;n&&n!==r&&Le(n,e)&&(this.callListener("onCellMouseOut",t,this.wtTable.getCoords(n),n),null===r&&(o.lastMouseOver=null))}}},{key:"onMouseUp",value:function(t){var e=ia.get(this),n=this.parentCell(t.target);n.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,n.coords,n.TD),(0===t.button||this.touchApplied)&&(n.TD===e.dblClickOrigin[0]&&n.TD===e.dblClickOrigin[1]?(ze(t.target,"corner")?this.callListener("onCellCornerDblClick",t,n.coords,n.TD):this.callListener("onCellDblClick",t,n.coords,n.TD),e.dblClickOrigin[0]=null,e.dblClickOrigin[1]=null):n.TD===e.dblClickOrigin[0]&&(e.dblClickOrigin[1]=n.TD,clearTimeout(e.dblClickTimeout[1]),e.dblClickTimeout[1]=setTimeout((function(){e.dblClickOrigin[1]=null}),500)))}},{key:"onTouchStart",value:function(t){var e=ia.get(this);e.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(t)}},{key:"onTouchEnd",value:function(t){var e,n=t.target,r=null===(e=this.parentCell(n))||void 0===e?void 0:e.coords,o=Zt(r)&&r.row>=0&&r.col>=0,i=t.cancelable&&o&&this.wtSettings.getSetting("isDataViewInstance");if(i){var a=["A","BUTTON","INPUT"];Nt()&&(Et()||Tt())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?t.preventDefault():this.selectedCellWasTouched(n)||t.preventDefault()}this.onMouseUp(t),this.touchApplied=!1}},{key:"callListener",value:function(t,e,n,r){var o=this.wtSettings.getSettingPure(t);o&&o(e,n,r,this.facadeGetter())}},{key:"destroy",value:function(){var t=ia.get(this);clearTimeout(t.dblClickTimeout[0]),clearTimeout(t.dblClickTimeout[1]),this.eventManager.destroy()}}]),t}(),la=aa;function sa(t){return sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sa(t)}function ua(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ca(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ha(r.key),r)}}function fa(t,e,n){return e&&ca(t.prototype,e),n&&ca(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ha(t){var e=da(t,"string");return"symbol"===sa(e)?e:String(e)}function da(t,e){if("object"!==sa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==sa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var pa=function(){function t(e,n,r){ua(this,t),this.offset=e,this.total=n,this.countTH=r}return fa(t,[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]),t}(),ya=pa;function va(t){return va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},va(t)}function ma(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ga(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wa(r.key),r)}}function ba(t,e,n){return e&&ga(t.prototype,e),n&&ga(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function wa(t){var e=Sa(t,"string");return"symbol"===va(e)?e:String(e)}function Sa(t,e){if("object"!==va(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==va(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Ca=function(){function t(e,n,r){ma(this,t),this.offset=e,this.total=n,this.countTH=r}return ba(t,[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceRowToVisibleColHeadedRow",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]),t}(),Oa=Ca,ka=0,Ra=1,Ea=2;function Pa(t){return Pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pa(t)}function Ta(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ja(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ma(r.key),r)}}function Aa(t,e,n){return e&&ja(t.prototype,e),n&&ja(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ma(t){var e=Ia(t,"string");return"symbol"===Pa(e)?e:String(e)}function Ia(t,e){if("object"!==Pa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Pa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var xa=function(){function t(){Ta(this,t),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return Aa(t,[{key:"setSize",value:function(t){this.currentSize=this.nextSize,this.nextSize=t}},{key:"setOffset",value:function(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}]),t}();function _a(t){return _a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_a(t)}function Ha(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Na(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,La(r.key),r)}}function Da(t,e,n){return e&&Na(t.prototype,e),n&&Na(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function La(t){var e=Ba(t,"string");return"symbol"===_a(e)?e:String(e)}function Ba(t,e){if("object"!==_a(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==_a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Va=function(){function t(){Ha(this,t),this.size=new xa,this.workingSpace=ka,this.sharedSize=null}return Da(t,[{key:"setSize",value:function(t){this.size.setSize(t)}},{key:"setOffset",value:function(t){this.size.setOffset(t)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof xa}},{key:"isPlaceOn",value:function(t){return this.workingSpace===t}},{key:"append",value:function(t){this.workingSpace=Ra,t.workingSpace=Ea,this.sharedSize=t.getViewSize()}},{key:"prepend",value:function(t){this.workingSpace=Ea,t.workingSpace=Ra,this.sharedSize=t.getViewSize()}}]),t}();function Fa(t){return Fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fa(t)}function Wa(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ua(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ga(r.key),r)}}function za(t,e,n){return e&&Ua(t.prototype,e),n&&Ua(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ga(t){var e=Ya(t,"string");return"symbol"===Fa(e)?e:String(e)}function Ya(t,e){if("object"!==Fa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Fa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Ka=function(){function t(e,n,r){Wa(this,t),this.rootNode=e,this.nodesPool=n,this.sizeSet=new Va,this.childNodeType=r.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return za(t,[{key:"setSize",value:function(t){return this.sizeSet.setSize(t),this}},{key:"setOffset",value:function(t){return this.sizeSet.setOffset(t),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}},{key:"getCurrentNode",value:function(){var t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}},{key:"getRenderedChildCount",value:function(){var t=this.rootNode,e=this.sizeSet,n=0;if(this.isSharedViewSet()){var r=t.firstElementChild;while(r){if(r.tagName===this.childNodeType)n+=1;else if(e.isPlaceOn(Ra))break;r=r.nextElementSibling}}else n=t.childElementCount;return n}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;var t=this.rootNode,e=this.sizeSet,n=this.isSharedViewSet(),r=e.getViewSize(),o=r.nextSize,i=this.getRenderedChildCount();while(i<o){var a=this.nodesPool();!n||n&&e.isPlaceOn(Ea)?t.appendChild(a):t.insertBefore(a,t.firstChild),i+=1}var l=n&&e.isPlaceOn(Ra);while(i>o)t.removeChild(l?t.firstChild:t.lastChild),i-=1}},{key:"render",value:function(){var t=this.rootNode,e=this.sizeSet,n=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(Ea)&&(n+=e.sharedSize.nextSize);var r=t.childNodes[n];if(r.tagName!==this.childNodeType){var o=this.nodesPool();t.replaceChild(o,r),r=o}this.collectedNodes.push(r),this.visualIndex+=1}},{key:"end",value:function(){}}]),t}();function Xa(t){return Xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xa(t)}function $a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ja(r.key),r)}}function Qa(t,e,n){return e&&qa(t.prototype,e),n&&qa(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ja(t){var e=Za(t,"string");return"symbol"===Xa(e)?e:String(e)}function Za(t,e){if("object"!==Xa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Xa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function tl(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&el(t,e)}function el(t,e){return el=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},el(t,e)}function nl(t){var e=il();return function(){var n,r=al(t);if(e){var o=al(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rl(this,n)}}function rl(t,e){if(e&&("object"===Xa(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ol(t)}function ol(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function il(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function al(t){return al=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},al(t)}var ll=function(t){tl(n,t);var e=nl(n);function n(){return $a(this,n),e.apply(this,arguments)}return Qa(n,[{key:"prependView",value:function(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}]),n}(Ka);function sl(t){return sl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sl(t)}function ul(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,hl(r.key),r)}}function fl(t,e,n){return e&&cl(t.prototype,e),n&&cl(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function hl(t){var e=dl(t,"string");return"symbol"===sl(e)?e:String(e)}function dl(t,e){if("object"!==sl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==sl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var pl=function(){function t(e){ul(this,t),this.nodeType=e.toUpperCase()}return fl(t,[{key:"setRootDocument",value:function(t){this.rootDocument=t}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),t}();function yl(t){return yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yl(t)}function vl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ml(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bl(r.key),r)}}function gl(t,e,n){return e&&ml(t.prototype,e),n&&ml(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function bl(t){var e=wl(t,"string");return"symbol"===yl(e)?e:String(e)}function wl(t,e){if("object"!==yl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==yl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Sl=function(){function t(e,n){vl(this,t),this.nodesPool="string"===typeof e?new pl(e):null,this.nodeType=e,this.rootNode=n,this.table=null,this.renderedNodes=0}return gl(t,[{key:"setTable",value:function(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),t}();function Cl(t){return Cl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cl(t)}function Ol(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,El(r.key),r)}}function Rl(t,e,n){return e&&kl(t.prototype,e),n&&kl(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function El(t){var e=Pl(t,"string");return"symbol"===Cl(e)?e:String(e)}function Pl(t,e){if("object"!==Cl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Cl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Tl(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jl(t,e)}function jl(t,e){return jl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},jl(t,e)}function Al(t){var e=xl();return function(){var n,r=_l(t);if(e){var o=_l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ml(this,n)}}function Ml(t,e){if(e&&("object"===Cl(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Il(t)}function Il(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xl(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function _l(t){return _l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_l(t)}var Hl=function(t){Tl(n,t);var e=Al(n);function n(){var t;return Ol(this,n),t=e.call(this,"TH"),t.orderViews=new WeakMap,t.sourceRowIndex=0,t}return Rl(n,[{key:"obtainOrderView",value:function(t){var e,n=this;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new ll(t,(function(t){return n.nodesPool.obtain(n.sourceRowIndex,t)}),this.nodeType),this.orderViews.set(t,e)),e}},{key:"render",value:function(){for(var t=this.table,e=t.rowsToRender,n=t.rowHeaderFunctions,r=t.rowHeadersCount,o=t.rows,i=t.cells,a=0;a<e;a++){var l=this.table.renderedRowToSource(a),s=o.getRenderedNode(a);this.sourceRowIndex=l;var u=this.obtainOrderView(s),c=i.obtainOrderView(s);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(var f=0;f<r;f++){u.render();var h=u.getCurrentNode();h.className="",h.removeAttribute("style"),n[f](l,h,f)}u.end()}}}]),n}(Sl);function Nl(t){return Nl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nl(t)}function Dl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ll(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vl(r.key),r)}}function Bl(t,e,n){return e&&Ll(t.prototype,e),n&&Ll(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Vl(t){var e=Fl(t,"string");return"symbol"===Nl(e)?e:String(e)}function Fl(t,e){if("object"!==Nl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Nl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Wl(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ul(t,e)}function Ul(t,e){return Ul=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ul(t,e)}function zl(t){var e=Kl();return function(){var n,r=Xl(t);if(e){var o=Xl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Gl(this,n)}}function Gl(t,e){if(e&&("object"===Nl(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Yl(t)}function Yl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Kl(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Xl(t){return Xl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xl(t)}var $l=function(t){Wl(n,t);var e=zl(n);function n(t){return Dl(this,n),e.call(this,null,t)}return Bl(n,[{key:"adjust",value:function(){var t=this.table,e=t.columnHeadersCount,n=t.rowHeadersCount,r=this.rootNode.firstChild;if(e){for(var o=this.table.columnsToRender,i=o+n,a=0,l=e;a<l;a++){r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;while(this.renderedNodes<i)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;while(this.renderedNodes>i)r.removeChild(r.lastChild),this.renderedNodes-=1}var s=this.rootNode.childNodes.length;if(s>e)for(var u=e;u<s;u++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Xe(r)}},{key:"render",value:function(){for(var t=this.table.columnHeadersCount,e=0;e<t;e+=1)for(var n=this.table,r=n.columnHeaderFunctions,o=n.columnsToRender,i=n.rowHeadersCount,a=this.rootNode.childNodes[e],l=-1*i;l<o;l+=1){var s=this.table.renderedColumnToSource(l),u=a.childNodes[l+i];u.className="",u.removeAttribute("style"),r[e](s,u,e)}}}]),n}(Sl);function ql(t){return ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ql(t)}function Ql(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ts(r.key),r)}}function Zl(t,e,n){return e&&Jl(t.prototype,e),n&&Jl(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ts(t){var e=es(t,"string");return"symbol"===ql(e)?e:String(e)}function es(t,e){if("object"!==ql(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ql(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ns(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rs(t,e)}function rs(t,e){return rs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},rs(t,e)}function os(t){var e=ls();return function(){var n,r=ss(t);if(e){var o=ss(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return is(this,n)}}function is(t,e){if(e&&("object"===ql(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return as(t)}function as(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ls(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function ss(t){return ss=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ss(t)}var us,cs=function(t){ns(n,t);var e=os(n);function n(t){return Ql(this,n),e.call(this,null,t)}return Zl(n,[{key:"adjust",value:function(){var t=this.table,e=t.columnsToRender,n=t.rowHeadersCount,r=e+n;while(this.renderedNodes<r)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;while(this.renderedNodes>r)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var t=this.table,e=t.columnsToRender,n=t.rowHeadersCount,r=0;r<n;r++){var o=this.table.renderedColumnToSource(r),i=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[r].style.width="".concat(i,"px")}for(var a=0;a<e;a++){var l=this.table.renderedColumnToSource(a),s=this.table.columnUtils.getStretchedColumnWidth(l);this.rootNode.childNodes[a+n].style.width="".concat(s,"px")}var u=this.rootNode.firstChild;u&&Ge(u,"rowHeader")}}]),n}(Sl);function fs(t){return fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fs(t)}function hs(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function ds(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ps(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vs(r.key),r)}}function ys(t,e,n){return e&&ps(t.prototype,e),n&&ps(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function vs(t){var e=ms(t,"string");return"symbol"===fs(e)?e:String(e)}function ms(t,e){if("object"!==fs(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==fs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function gs(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bs(t,e)}function bs(t,e){return bs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},bs(t,e)}function ws(t){var e=Os();return function(){var n,r=ks(t);if(e){var o=ks(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ss(this,n)}}function Ss(t,e){if(e&&("object"===fs(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Cs(t)}function Cs(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Os(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function ks(t){return ks=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ks(t)}var Rs=!1,Es=function(t){gs(n,t);var e=ws(n);function n(t){var r;return ds(this,n),r=e.call(this,"TR",t),r.orderView=new Ka(t,(function(t){return r.nodesPool.obtain(t)}),r.nodeType),r}return ys(n,[{key:"getRenderedNode",value:function(t){return this.orderView.getNode(t)}},{key:"render",value:function(){var t=this.table.rowsToRender;!Rs&&t>1e3&&(Rs=!0,Un($t(us||(us=hs(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting \n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20\n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.']))))),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(var e=0;e<t;e++)this.orderView.render();this.orderView.end()}}]),n}(Sl);function Ps(t){return Ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ps(t)}function Ts(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function js(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ms(r.key),r)}}function As(t,e,n){return e&&js(t.prototype,e),n&&js(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ms(t){var e=Is(t,"string");return"symbol"===Ps(e)?e:String(e)}function Is(t,e){if("object"!==Ps(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ps(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function xs(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_s(t,e)}function _s(t,e){return _s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_s(t,e)}function Hs(t){var e=Ls();return function(){var n,r=Bs(t);if(e){var o=Bs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ns(this,n)}}function Ns(t,e){if(e&&("object"===Ps(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ds(t)}function Ds(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ls(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Bs(t){return Bs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Bs(t)}var Vs=function(t){xs(n,t);var e=Hs(n);function n(){var t;return Ts(this,n),t=e.call(this,"TD"),t.orderViews=new WeakMap,t.sourceRowIndex=0,t}return As(n,[{key:"obtainOrderView",value:function(t){var e,n=this;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new ll(t,(function(t){return n.nodesPool.obtain(n.sourceRowIndex,t)}),this.nodeType),this.orderViews.set(t,e)),e}},{key:"render",value:function(){for(var t=this.table,e=t.rowsToRender,n=t.columnsToRender,r=t.rows,o=t.rowHeaders,i=0;i<e;i++){var a=this.table.renderedRowToSource(i),l=r.getRenderedNode(i);this.sourceRowIndex=a;var s=this.obtainOrderView(l),u=o.obtainOrderView(l);s.prependView(u).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var c=0;c<n;c++){s.render();var f=s.getCurrentNode(),h=this.table.renderedColumnToSource(c);ze(f,"hide")||(f.className=""),f.removeAttribute("style"),f.removeAttribute("dir"),this.table.cellRenderer(a,h,f)}s.end()}}}]),n}(Sl);function Fs(t){return Fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fs(t)}function Ws(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Us(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Gs(r.key),r)}}function zs(t,e,n){return e&&Us(t.prototype,e),n&&Us(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gs(t){var e=Ys(t,"string");return"symbol"===Fs(e)?e:String(e)}function Ys(t,e){if("object"!==Fs(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Fs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Ks=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.cellRenderer;Ws(this,t),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=r}return zs(t,[{key:"setAxisUtils",value:function(t,e){this.rowUtils=t,this.columnUtils=e}},{key:"setViewportSize",value:function(t,e){this.rowsToRender=t,this.columnsToRender=e}},{key:"setFilters",value:function(t,e){this.rowFilter=t,this.columnFilter=e}},{key:"setHeaderContentRenderers",value:function(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}},{key:"setRenderers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.rowHeaders,n=t.columnHeaders,r=t.colGroup,o=t.rows,i=t.cells;e.setTable(this),n.setTable(this),r.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=o,this.cells=i}},{key:"renderedRowToSource",value:function(t){return this.rowFilter.renderedToSource(t)}},{key:"renderedColumnToSource",value:function(t){return this.columnFilter.renderedToSource(t)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var t=this.rowsToRender,e=this.rows,n=0;n<t;n++){var r=e.getRenderedNode(n);if(r.firstChild){var o=this.renderedRowToSource(n),i=this.rowUtils.getHeight(o);r.firstChild.style.height=i?"".concat(i-1,"px"):""}}}}]),t}();function Xs(t){return Xs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xs(t)}function $s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Js(r.key),r)}}function Qs(t,e,n){return e&&qs(t.prototype,e),n&&qs(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Js(t){var e=Zs(t,"string");return"symbol"===Xs(e)?e:String(e)}function Zs(t,e){if("object"!==Xs(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Xs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var tu=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.TABLE,r=e.THEAD,o=e.COLGROUP,i=e.TBODY,a=e.rowUtils,l=e.columnUtils,s=e.cellRenderer;$s(this,t),this.renderer=new Ks(n,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new Hl,columnHeaders:new $l(r),colGroup:new cs(o),rows:new Es(i),cells:new Vs}),this.renderer.setAxisUtils(a,l)}return Qs(t,[{key:"setFilters",value:function(t,e){return this.renderer.setFilters(t,e),this}},{key:"setViewportSize",value:function(t,e){return this.renderer.setViewportSize(t,e),this}},{key:"setHeaderContentRenderers",value:function(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),t}();function eu(t){return eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eu(t)}function nu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ru(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,iu(r.key),r)}}function ou(t,e,n){return e&&ru(t.prototype,e),n&&ru(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function iu(t){var e=au(t,"string");return"symbol"===eu(e)?e:String(e)}function au(t,e){if("object"!==eu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==eu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var lu=function(){function t(e,n){nu(this,t),this.dataAccessObject=e,this.wtSettings=n,this.headerWidths=new Map}return ou(t,[{key:"getWidth",value:function(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(t){var e=this.dataAccessObject.wtViewport.columnsRenderCalculator,n=this.getWidth(t);if(e){var r=e.getStretchedColumnWidth(t,n);r&&(n=r)}return n}},{key:"getHeaderHeight",value:function(t){var e=this.wtSettings.getSetting("defaultRowHeight"),n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==n&&(e=e?Math.max(e,n):n),e}},{key:"getHeaderWidth",value:function(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}},{key:"calculateWidths",value:function(){var t=this.wtSettings,e=this.dataAccessObject,n=e.wtTable,r=e.wtViewport,o=e.cloneSource,i=o?o.wtTable.holder:n.holder,a=i.offsetHeight<i.scrollHeight?On():0,l=t.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-a),l=t.getSetting("onModifyRowHeaderWidth",l),null!==l&&void 0!==l)for(var s=t.getSetting("rowHeaders").length,u=t.getSetting("defaultColumnWidth"),c=0;c<s;c++){var f=Array.isArray(l)?l[c]:l;f=null===f||void 0===f?u:f,this.headerWidths.set(c,f)}}}]),t}();function su(t){return su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},su(t)}function uu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,hu(r.key),r)}}function fu(t,e,n){return e&&cu(t.prototype,e),n&&cu(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function hu(t){var e=du(t,"string");return"symbol"===su(e)?e:String(e)}function du(t,e){if("object"!==su(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==su(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var pu=function(){function t(e,n){uu(this,t),this.dataAccessObject=e,this.wtSettings=n}return fu(t,[{key:"getHeight",value:function(t){var e=this.wtSettings.getSetting("rowHeight",t),n=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==n&&(e=void 0===e?n:Math.max(e,n)),e}}]),t}(),yu="top",vu="bottom",mu="inline_start",gu="top_inline_start_corner",bu="bottom_inline_start_corner",wu=[yu,vu,mu,gu,bu],Su=new Map([[yu,"ht_clone_".concat(yu)],[vu,"ht_clone_".concat(vu)],[mu,"ht_clone_".concat(mu," ht_clone_left")],[gu,"ht_clone_".concat(gu," ht_clone_top_left_corner")],[bu,"ht_clone_".concat(bu," ht_clone_bottom_left_corner")]]);function Cu(t){return Cu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cu(t)}function Ou(t){return Eu(t)||Ru(t)||ju(t)||ku()}function ku(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ru(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Eu(t){if(Array.isArray(t))return Au(t)}function Pu(t,e){return Iu(t)||Mu(t,e)||ju(t,e)||Tu()}function Tu(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ju(t,e){if(t){if("string"===typeof t)return Au(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Au(t,e):void 0}}function Au(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Mu(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Iu(t){if(Array.isArray(t))return t}function xu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Du(r.key),r)}}function Hu(t,e,n){return e&&_u(t.prototype,e),n&&_u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Nu(t,e,n){return e=Du(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Du(t){var e=Lu(t,"string");return"symbol"===Cu(e)?e:String(e)}function Lu(t,e){if("object"!==Cu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Cu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Bu=function(){function t(e,n,r,o,i){var a=this;xu(this,t),Nu(this,"wtSettings",null),Nu(this,"domBindings",void 0),Nu(this,"TBODY",null),Nu(this,"THEAD",null),Nu(this,"COLGROUP",null),Nu(this,"hasTableHeight",!0),Nu(this,"hasTableWidth",!0),Nu(this,"isTableVisible",!1),Nu(this,"tableOffset",0),Nu(this,"holderOffset",0),this.domBindings=r,this.isMaster="master"===i,this.name=i,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,Ke(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var l=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(function(){return a._modifyRowHeaderWidth(l)})),this.rowUtils=new pu(this.dataAccessObject,this.wtSettings),this.columnUtils=new lu(this.dataAccessObject,this.wtSettings),this.tableRenderer=new tu({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return Hu(t,[{key:"is",value:function(t){return this.name===t}},{key:"fixTableDomTree",value:function(){var t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(t){var e,n=t.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&ze(n,"wtHolder")||(e=this.domBindings.rootDocument.createElement("div"),e.className="wtSpreader",n&&n.insertBefore(e,t),e.appendChild(t)),e.style.position="relative",e}},{key:"createHider",value:function(t){var e,n=t.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&ze(n,"wtHolder")||(e=this.domBindings.rootDocument.createElement("div"),e.className="wtHider",n&&n.insertBefore(e,t),e.appendChild(t)),e}},{key:"createHolder",value:function(t){var e,n=t.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&ze(n,"wtHolder")||(e=this.domBindings.rootDocument.createElement("div"),e.style.position="relative",e.className="wtHolder",n&&n.insertBefore(e,t),this.isMaster&&(e.parentNode.className+="ht_master handsontable",e.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),e.appendChild(t)),e}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.wtSettings,n=this.dataAccessObject,r=n.wtOverlays,o=n.wtViewport,i=e.getSetting("totalRows"),a=e.getSetting("totalColumns"),l=e.getSetting("rowHeaders"),s=l.length,u=e.getSetting("columnHeaders"),c=u.length,f=!1,h=t;if(this.isMaster&&(this.holderOffset=tn(this.holder),h=o.createRenderCalculators(h),s&&!e.getSetting("fixedColumnsStart"))){var d=r.inlineStartOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=0!==d,p!==this.correctHeaderWidth&&(h=!1)}if(this.isMaster&&(f=r.updateStateOfRendering()),h)this.isMaster&&o.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=tn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var y=i>0?this.getFirstRenderedRow():0,v=a>0?this.getFirstRenderedColumn():0;this.rowFilter=new Oa(y,i,c),this.columnFilter=new ya(v,a,s);var m,g=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var b={};this.wtSettings.getSetting("beforeDraw",!0,b),g=!0!==b.skipRender}if(g)if(this.tableRenderer.setHeaderContentRenderers(l,u),(this.is(vu)||this.is(bu))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(m=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(vu))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var w=fn(this.hider),S=fn(this.TABLE);0!==w&&S!==w&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),m!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(vu)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}var C=!1;return this.isMaster&&(C=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(C=r.bottomOverlay.resetFixedPosition()||C),C=r.inlineStartOverlay.resetFixedPosition()||C,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),C?(r.refreshAll(),r.adjustElementsSize()):this.refreshSelections(h),f&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(t){var e,n,r,o=this.columnFilter.renderedToSource(t),i=this.wtSettings.getSetting("columnHeaders").length,a=this.wtSettings.getSetting("defaultRowHeight"),l=this.wtSettings.getSetting("columnHeaderHeight")||[];while(i)i-=1,e=this.getColumnHeaderHeight(i),n=this.getColumnHeader(o,i),n&&(r=dn(n),(!e&&a<r||e<r)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=r),Array.isArray(l)?null!==l[i]&&void 0!==l[i]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(l[i]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]||l))}},{key:"adjustColumnHeaderHeights",value:function(){for(var t=this.wtSettings,e=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=t.getSetting("columnHeaders"),o=0,i=r.length;o<i;o++)if(n[o]){if(!e[o]||0===e[o].childNodes.length)return;e[o].childNodes[0].style.height="".concat(n[o],"px")}}},{key:"resetOversizedRows",value:function(){var t=this.wtSettings,e=this.dataAccessObject.wtViewport;if((this.isMaster||this.is(vu))&&!t.getSetting("externalRowCalculator"))for(var n=this.getRenderedRowsCount(),r=0;r<n;r++){var o=this.rowFilter.renderedToSource(r);e.oversizedRows&&e.oversizedRows[o]&&(e.oversizedRows[o]=void 0)}}},{key:"removeClassFromCells",value:function(t){for(var e=this.TABLE.querySelectorAll(".".concat(t)),n=0,r=e.length;n<r;n++)Ye(e[n],t)}},{key:"refreshSelections",value:function(t){var e=this.wtSettings,n=this.dataAccessObject.selections;if(n){var r=Array.from(n),o=r.length;if(t){for(var i=[],a=0;a<o;a++){for(var l=r[a].settings,s=l.highlightHeaderClassName,u=l.highlightRowClassName,c=l.highlightColumnClassName,f=r[a].classNames,h=f.length,d=0;d<h;d++)i.includes(f[d])||i.push(f[d]);s&&!i.includes(s)&&i.push(s),u&&!i.includes(u)&&i.push(u),c&&!i.includes(c)&&i.push(c)}var p=e.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(p))for(var y=0;y<p.length;y++)i.push(p[y]);for(var v=i.length,m=0;m<v;m++)this.removeClassFromCells(i[m])}for(var g=0;g<o;g++)r[g].draw(this.facadeGetter(),t)}}},{key:"getCell",value:function(t){var e=t.row,n=t.col,r=this.wtSettings.getSetting("onModifyGetCellCoords",e,n);if(r&&Array.isArray(r)){var o=Pu(r,2);e=o[0],n=o[1]}if(this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;var i=this.getRow(e);if(!i&&e>=0)throw new Error("TR was expected to be rendered but is not");var a=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!a&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}},{key:"getRow",value:function(t){var e,n,r=null,o=null;t<0?(r=null===(e=this.rowFilter)||void 0===e?void 0:e.sourceRowToVisibleColHeadedRow(t),o=this.THEAD):(r=null===(n=this.rowFilter)||void 0===n?void 0:n.sourceToRendered(t),o=this.TBODY);return void 0!==r&&void 0!==o&&(!(o.childNodes.length<r+1)&&o.childNodes[r])}},{key:"getColumnHeader",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.THEAD.childNodes[e];return null===n||void 0===n?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}},{key:"getColumnHeaders",value:function(t){var e=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach((function(t){var r=t.childNodes[n];r&&e.push(r)})),e}},{key:"getRowHeader",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0!==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)){var n=this.wtSettings.getSetting("rowHeaders").length;if(!(e>=n)){var r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)];return null===r||void 0===r?void 0:r.childNodes[e]}}}},{key:"getRowHeaders",value:function(t){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return[];for(var e=[],n=this.wtSettings.getSetting("rowHeaders").length,r=0;r<n;r++){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],i=null===o||void 0===o?void 0:o.childNodes[r];i&&e.push(i)}return e}},{key:"getCoords",value:function(t){var e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=Ne(e,["TD","TH"])),null===e)return null;var n=e.parentNode,r=n.parentNode,o=Be(n),i=e.cellIndex;if(Ve(gu,e,this.wtRootElement)||Ve(yu,e,this.wtRootElement))"THEAD"===r.nodeName&&(o-=r.childNodes.length);else if(Ve(bu,e,this.wtRootElement)||Ve(vu,e,this.wtRootElement)){var a=this.wtSettings.getSetting("totalRows");o=a-r.childNodes.length+o}else o=r===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter.renderedToSource(o);return i=Ve(gu,e,this.wtRootElement)||Ve(mu,e,this.wtRootElement)||Ve(bu,e,this.wtRootElement)?this.columnFilter.offsettedTH(i):this.columnFilter.visibleRowHeadedColumnToSourceColumn(i),this.wot.createCellCoords(o,i)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var t,e,n,r,o,i=this.TBODY.childNodes.length,a=i*this.wtSettings.getSetting("defaultRowHeight"),l=dn(this.TBODY)-1;if(a!==l||this.wtSettings.getSetting("fixedRowsBottom"))while(i)i-=1,n=this.rowFilter.renderedToSource(i),t=this.getRowHeight(n),r=this.getTrForRow(n),o=r.querySelector("th"),e=o?dn(o):dn(r)-1,(!t&&this.wtSettings.getSetting("defaultRowHeight")<e||t<e)&&(e+=1,this.dataAccessObject.wtViewport.oversizedRows[n]=e)}}},{key:"getTrForRow",value:function(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}},{key:"isColumnHeaderRendered",value:function(t){if(t>=0)return!1;var e=this.wtSettings.getSetting("rowHeaders"),n=e.length;return Math.abs(t)<=n}},{key:"isRowHeaderRendered",value:function(t){if(t>=0)return!1;var e=this.wtSettings.getSetting("columnHeaders"),n=e.length;return Math.abs(t)<=n}},{key:"isRowBeforeRenderedRows",value:function(t){var e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}},{key:"isRowAfterRenderedRows",value:function(t){return t>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(t){var e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}},{key:"isColumnAfterRenderedColumns",value:function(t){return this.columnFilter&&t>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(t){return this.columnFilter&&t>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(t){return this.rowFilter&&t>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(t){return this.rowUtils.getHeight(t)}},{key:"getColumnHeaderHeight",value:function(t){return this.columnUtils.getHeaderHeight(t)}},{key:"getColumnWidth",value:function(t){return this.columnUtils.getWidth(t)}},{key:"getStretchedColumnWidth",value:function(t){return this.columnUtils.getStretchedColumnWidth(t)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return fn(this.TABLE)}},{key:"getHeight",value:function(){return hn(this.TABLE)}},{key:"getTotalWidth",value:function(){var t=fn(this.hider);return 0!==t?t:this.getWidth()}},{key:"getTotalHeight",value:function(){var t=hn(this.hider);return 0!==t?t:this.getHeight()}},{key:"isVisible",value:function(){return Ze(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(t){var e=_n(t)?t():null;return Array.isArray(e)?(e=Ou(e),e[e.length-1]=this._correctRowHeaderWidth(e[e.length-1])):e=this._correctRowHeaderWidth(e),e}},{key:"_correctRowHeaderWidth",value:function(t){var e=t;return"number"!==typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}]),t}(),Vu=Bu,Fu="stickyRowsTop",Wu={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return 0===t?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};dt(Wu,"MIXIN_NAME",Fu,{writable:!1,enumerable:!1});var Uu=Wu,zu="calculatedColumns",Gu={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};dt(Gu,"MIXIN_NAME",zu,{writable:!1,enumerable:!1});var Yu=Gu;function Ku(t){return Ku="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ku(t)}function Xu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qu(r.key),r)}}function $u(t,e,n){return e&&Xu(t.prototype,e),n&&Xu(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function qu(t){var e=Qu(t,"string");return"symbol"===Ku(e)?e:String(e)}function Qu(t,e){if("object"!==Ku(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ku(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ju(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zu(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tc(t,e)}function tc(t,e){return tc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},tc(t,e)}function ec(t){var e=oc();return function(){var n,r=ic(t);if(e){var o=ic(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nc(this,n)}}function nc(t,e){if(e&&("object"===Ku(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return rc(t)}function rc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oc(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function ic(t){return ic=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ic(t)}var ac=function(t){Zu(n,t);var e=ec(n);function n(t,r,o,i){return Ju(this,n),e.call(this,t,r,o,i,yu)}return $u(n)}(Vu);ct(ac,Uu),ct(ac,Yu);var lc=ac;function sc(t){return sc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sc(t)}function uc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dc(r.key),r)}}function fc(t,e,n){return e&&cc(t.prototype,e),n&&cc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function hc(t,e,n){return e=dc(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dc(t){var e=pc(t,"string");return"symbol"===sc(e)?e:String(e)}function pc(t,e){if("object"!==sc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==sc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var yc=function(){function t(e){uc(this,t),hc(this,"dataAccessObject",void 0),hc(this,"lastScrolledColumnPos",-1),hc(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}return fc(t,[{key:"scrollViewport",value:function(t,e,n,r,o){var i=this.scrollViewportHorizontally(t.col,n,o),a=this.scrollViewportVertically(t.row,e,r);return i||a}},{key:"scrollViewportHorizontally",value:function(t,e,n){var r=this.dataAccessObject,o=r.drawn,i=r.totalColumns;if(!o||!Number.isInteger(t)||t<0||t>i)return!1;var a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn(),s=void 0===e&&void 0===n,u=this.dataAccessObject,c=u.fixedColumnsStart,f=u.inlineStartOverlay;if(s&&t<c)return!1;var h=!1;return-1===a?h=f.scrollTo(t,s?t>this.lastScrolledColumnPos:e):(s&&(t<a||t>l)||!s)&&(h=f.scrollTo(t,s?t>l:e)),h&&(this.lastScrolledColumnPos=t),h}},{key:"scrollViewportVertically",value:function(t,e,n){var r=this.dataAccessObject,o=r.drawn,i=r.totalRows;if(!o||!Number.isInteger(t)||t<0||t>i)return!1;var a=this.getFirstVisibleRow(),l=this.getLastVisibleRow(),s=void 0===e&&void 0===n,u=this.dataAccessObject,c=u.fixedRowsBottom,f=u.fixedRowsTop,h=u.topOverlay;if(s&&(t<f||t>i-c-1))return!1;var d=!1;return-1===a?d=h.scrollTo(t,s?t>this.lastScrolledRowPos:n):(s&&(t<a||t>l)||!s)&&(d=h.scrollTo(t,s?t>l:n)),d&&(this.lastScrolledRowPos=t),d}},{key:"getFirstVisibleRow",value:function(){var t=this.dataAccessObject,e=t.topOverlay,n=t.wtTable,r=t.wtViewport,o=t.totalRows,i=t.fixedRowsTop,a=t.rootWindow,l=n.getFirstVisibleRow();if(e.mainTableScrollableElement===a){var s=tn(n.wtRootElement),u=dn(n.hider),c=dn(a),f=rn(a,a);if(s.top+u-c<=f){var h=r.getColumnHeaderHeight();h+=e.sumCellSizes(0,i);for(var d=o;d>0;d--)if(h+=e.sumCellSizes(d-1,d),s.top+u-h<=f){l=d;break}}}return l}},{key:"getLastVisibleRow",value:function(){var t=this.dataAccessObject,e=t.topOverlay,n=t.wtTable,r=t.wtViewport,o=t.totalRows,i=t.rootWindow,a=n.getLastVisibleRow();if(e.mainTableScrollableElement===i){var l=tn(n.wtRootElement),s=rn(i,i);if(l.top>s)for(var u=dn(i),c=r.getColumnHeaderHeight(),f=1;f<=o;f++)if(c+=e.sumCellSizes(f-1,f),l.top+c-s>=u){a=f-2;break}}return a}},{key:"getFirstVisibleColumn",value:function(){var t=this.dataAccessObject,e=t.inlineStartOverlay,n=t.wtTable,r=t.wtViewport,o=t.totalColumns,i=t.rootWindow,a=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===i){var l=tn(n.wtRootElement),s=pn(n.hider),u=pn(i),c=Math.abs(on(i,i));if(l.left+s-u<=c)for(var f=r.getRowHeaderWidth(),h=o;h>0;h--)if(f+=e.sumCellSizes(h-1,h),l.left+s-f<=c){a=h;break}}return a}},{key:"getLastVisibleColumn",value:function(){var t=this.dataAccessObject,e=t.wtSettings,n=t.inlineStartOverlay,r=t.wtTable,o=t.wtViewport,i=t.totalColumns,a=t.rootWindow,l=r.getLastVisibleColumn();if(n.mainTableScrollableElement===a){var s=e.getSetting("rtlMode"),u=null;if(s){var c=r.TABLE.getBoundingClientRect(),f=this.dataAccessObject.rootWindow.document,h=f.documentElement.offsetWidth;u=Math.abs(c.right-h)}else{var d=tn(r.wtRootElement);u=d.left}var p=Math.abs(on(a,a));if(u>p)for(var y=pn(a),v=o.getRowHeaderWidth(),m=1;m<=i;m++)if(v+=n.sumCellSizes(m-1,m),u+v-p>=y){l=m-2;break}}return l}}]),t}(),vc=yc;function mc(t){return mc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mc(t)}function gc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kc(r.key),r)}}function wc(t,e,n){return e&&bc(t.prototype,e),n&&bc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Sc(t,e,n){Cc(t,e),e.set(t,n)}function Cc(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oc(t,e,n){return e=kc(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kc(t){var e=Rc(t,"string");return"symbol"===mc(e)?e:String(e)}function Rc(t,e){if("object"!==mc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==mc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ec(t,e){var n=jc(t,e,"get");return Pc(t,n)}function Pc(t,e){return e.get?e.get.call(t):e.value}function Tc(t,e,n){var r=jc(t,e,"set");return Ac(t,r,n),n}function jc(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ac(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Mc=new WeakMap,Ic=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];gc(this,t),Oc(this,"row",null),Oc(this,"col",null),Sc(this,Mc,{writable:!0,value:!1}),Tc(this,Mc,r),"undefined"!==typeof e&&"undefined"!==typeof n&&(this.row=e,this.col=n)}return wc(t,[{key:"isValid",value:function(t){return!(this.row<0||this.col<0)&&!(this.row>=t.getSetting("totalRows")||this.col>=t.getSetting("totalColumns"))}},{key:"isEqual",value:function(t){return t===this||this.row===t.row&&this.col===t.col}},{key:"isSouthEastOf",value:function(t){return this.row>=t.row&&(Ec(this,Mc)?this.col<=t.col:this.col>=t.col)}},{key:"isNorthWestOf",value:function(t){return this.row<=t.row&&(Ec(this,Mc)?this.col>=t.col:this.col<=t.col)}},{key:"isSouthWestOf",value:function(t){return this.row>=t.row&&(Ec(this,Mc)?this.col>=t.col:this.col<=t.col)}},{key:"isNorthEastOf",value:function(t){return this.row<=t.row&&(Ec(this,Mc)?this.col<=t.col:this.col>=t.col)}},{key:"normalize",value:function(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new t(this.row,this.col,Ec(this,Mc))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),t}(),xc=Ic;function _c(t){return _c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_c(t)}function Hc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Fc(r.key),r)}}function Dc(t,e,n){return e&&Nc(t.prototype,e),n&&Nc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Lc(t,e,n){Bc(t,e),e.set(t,n)}function Bc(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vc(t,e,n){return e=Fc(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fc(t){var e=Wc(t,"string");return"symbol"===_c(e)?e:String(e)}function Wc(t,e){if("object"!==_c(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==_c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Uc(t,e){var n=Yc(t,e,"get");return zc(t,n)}function zc(t,e){return e.get?e.get.call(t):e.value}function Gc(t,e,n){var r=Yc(t,e,"set");return Kc(t,r,n),n}function Yc(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Kc(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Xc=new WeakMap,$c=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Hc(this,t),Vc(this,"highlight",null),Vc(this,"from",null),Vc(this,"to",null),Lc(this,Xc,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=n.clone(),this.to=r.clone(),Gc(this,Xc,o)}return Dc(t,[{key:"setHighlight",value:function(t){return this.highlight=t.clone().normalize(),this}},{key:"setFrom",value:function(t){return this.from=t.clone(),this}},{key:"setTo",value:function(t){return this.to=t.clone(),this}},{key:"isValid",value:function(t){return this.from.isValid(t)&&this.to.isValid(t)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(t){var e=t.row,n=t.col,r=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<=e&&o.row>=e&&r.col<=n&&o.col>=n}},{key:"includesRange",value:function(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}},{key:"isEqual",value:function(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}},{key:"overlaps",value:function(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}},{key:"isNorthWestOf",value:function(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}},{key:"isOverlappingHorizontally",value:function(t){return this.getOuterTopRightCorner().col>=t.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=t.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=t.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=t.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(t){return this.getOuterBottomRightCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=t.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=t.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=t.getOuterTopRightCorner().row}},{key:"expand",value:function(t){var e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>n.row||t.col>n.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(n.row,t.row),Math.max(n.col,t.col)),!0)}},{key:"expandByRange",value:function(t){if(this.includesRange(t)||!this.overlaps(t))return!1;var e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=this.getDirection(),o=t.getOuterTopStartCorner(),i=t.getOuterBottomEndCorner(),a=Math.min(e.row,o.row),l=Math.min(e.col,o.col),s=Math.max(n.row,i.row),u=Math.max(n.col,i.col),c=this._createCellCoords(a,l),f=this._createCellCoords(s,u);return this.from=c,this.to=f,this.setDirection(r),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(t){switch(t){case"NW-SE":var e=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=e[0],this.to=e[1];break;case"NE-SW":var n=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var r=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=r[0],this.to=r[1];break;case"SW-NE":var o=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=o[0],this.to=o[1];break;default:break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var t=this.getDirection();switch(t){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}},{key:"flipDirectionHorizontally",value:function(){var t=this.getDirection();switch(t){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Uc(this,Xc)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Uc(this,Xc)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Uc(this,Xc)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Uc(this,Xc)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Uc(this,Xc)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Uc(this,Xc)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Uc(this,Xc)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Uc(this,Xc)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(t,e){return!!(e&&e.includes(t)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(e.from.row,e.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(e.from.row,e.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(e.to.row,e.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(e.to.row,e.to.col))))||(t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner()))}},{key:"getOppositeCorner",value:function(t,e){if(!(t instanceof xc))return!1;if(e){var n=e.from,r=e.to;if(e.includes(t)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(n.row,r.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(r.row,n.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterTopStartCorner()}}return t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0}},{key:"getBordersSharedWith",value:function(t){if(!this.includesRange(t))return[];var e={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},r=[];return e.top===n.top&&r.push("top"),e.right===n.right&&r.push("right"),e.bottom===n.bottom&&r.push("bottom"),e.left===n.left&&r.push("left"),r}},{key:"getInner",value:function(){for(var t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),n=[],r=t.row;r<=e.row;r++)for(var o=t.col;o<=e.col;o++)this.from.row===r&&this.from.col===o||this.to.row===r&&this.to.col===o||n.push(this._createCellCoords(r,o));return n}},{key:"getAll",value:function(){for(var t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),n=[],r=t.row;r<=e.row;r++)for(var o=t.col;o<=e.col;o++)t.row===r&&t.col===o?n.push(t):e.row===r&&e.col===o?n.push(e):n.push(this._createCellCoords(r,o));return n}},{key:"forAll",value:function(t){for(var e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=e.row;r<=n.row;r++)for(var o=e.col;o<=n.col;o++){var i=t(r,o);if(!1===i)return}}},{key:"clone",value:function(){return new t(this.highlight,this.from,this.to,Uc(this,Xc))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(t,e){return new xc(t,e,Uc(this,Xc))}}]),t}(),qc=$c;function Qc(t){return Qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qc(t)}function Jc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,nf(r.key),r)}}function tf(t,e,n){return e&&Zc(t.prototype,e),n&&Zc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ef(t,e,n){return e=nf(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nf(t){var e=rf(t,"string");return"symbol"===Qc(e)?e:String(e)}function rf(t,e){if("object"!==Qc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Qc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var of=function(){function t(e,n){Jc(this,t),ef(this,"wtTable",void 0),ef(this,"wtScroll",void 0),ef(this,"wtViewport",void 0),ef(this,"wtOverlays",void 0),ef(this,"selections",void 0),ef(this,"wtEvent",void 0),ef(this,"guid","wt_".concat(Se())),ef(this,"drawInterrupted",!1),ef(this,"drawn",!1),ef(this,"domBindings",void 0),ef(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new vc(this.createScrollDao())}return tf(t,[{key:"eventManager",get:function(){return new Gr(this)}},{key:"findOriginalHeaders",value:function(){var t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var e=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;e<n;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,n){Je(n,t[e])}])}}},{key:"createCellCoords",value:function(t,e){return new xc(t,e,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(t,e,n){return new qc(t,e,n,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}},{key:"getCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return this.wtTable.getCell(t);var n=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<r&&t.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<i&&t.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);if(t.row<n&&t.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}},{key:"scrollViewport",value:function(t,e,n,r,o){return!(t.col<0||t.row<0)&&this.wtScroll.scrollViewport(t,e,n,r,o)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selections(){return t.selections},get drawn(){return t.drawn},set drawn(e){t.drawn=e},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count}}}}]),t}();function af(t){return af="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},af(t)}function lf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,gf(r.key),r)}}function sf(t,e,n){return e&&lf(t.prototype,e),n&&lf(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function uf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cf(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ff(t,e)}function ff(t,e){return ff=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ff(t,e)}function hf(t){var e=yf();return function(){var n,r=vf(t);if(e){var o=vf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return df(this,n)}}function df(t,e){if(e&&("object"===af(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return pf(t)}function pf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yf(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function vf(t){return vf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vf(t)}function mf(t,e,n){return e=gf(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gf(t){var e=bf(t,"string");return"symbol"===af(e)?e:String(e)}function bf(t,e){if("object"!==af(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==af(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var wf=function(t){cf(n,t);var e=hf(n);function n(t,r,o){var i;uf(this,n),i=e.call(this,t,r),mf(pf(i),"cloneSource",void 0),mf(pf(i),"cloneOverlay",void 0);var a=i.wtSettings.getSetting("facade",pf(i));return i.cloneSource=o.source,i.cloneOverlay=o.overlay,i.wtTable=i.cloneOverlay.createTable(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=o.viewport,i.selections=o.selections,i.wtEvent=new la(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections,o.event),i.findOriginalHeaders(),i}return sf(n)}(of);function Sf(t){return Sf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(t)}function Cf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Of(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ef(r.key),r)}}function kf(t,e,n){return e&&Of(t.prototype,e),n&&Of(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Rf(t,e,n){return e=Ef(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ef(t){var e=Pf(t,"string");return"symbol"===Sf(e)?e:String(e)}function Pf(t,e){if("object"!==Sf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Sf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Tf=function(){function t(e,n,r,o,i){Cf(this,t),Rf(this,"wtSettings",null),dt(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=n,this.wtSettings=o;var a=this.wot.wtTable,l=a.TABLE,s=a.hider,u=a.spreader,c=a.holder,f=a.wtRootElement;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=l,this.hider=s,this.spreader=u,this.holder=c,this.wtRootElement=f,this.trimmingContainer=ln(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return kf(t,[{key:"updateStateOfRendering",value:function(){var t=this.needFullRender;this.needFullRender=this.shouldBeRendered();var e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=ln(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var t=this.wot.wtTable,e=this.domBindings.rootWindow;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=an(t.TABLE)}},{key:"getRelativeCellPosition",value:function(t,e,n){if(!1!==this.clone.wtTable.holder.contains(t)){var r=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),i=e<this.wtSettings.getSetting("fixedRowsTop"),a=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,s={start:this.getRelativeStartPosition(l),top:l.offsetTop},u={start:this.getRelativeStartPosition(t),top:t.offsetTop},c=null;return c=r?this.getRelativeCellPositionWithinWindow(i,o,u,s):this.getRelativeCellPositionWithinHolder(i,a,o,u,s),c}Un("The provided element is not a child of the ".concat(this.type," overlay"))}},{key:"getRelativeStartPosition",value:function(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(t,e,n,r){var o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),i=0,a=0;if(e){var l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+On())),i=l<=0?-1*l:0}else i=r.start;if(t){var s=this.clone.wtTable.TABLE.getBoundingClientRect();a=s.top-o.top}else a=r.top;return{start:n.start+i,top:n.top+a}}},{key:"getRelativeCellPositionWithinHolder",value:function(t,e,n,r,o){var i={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},a=0,l=0;if(n||(a=i.horizontal-o.start),e){var s=this.wot.wtTable.wtRootElement.getBoundingClientRect(),u=this.clone.wtTable.TABLE.getBoundingClientRect();l=-1*u.top+s.top}else t||(l=i.vertical-o.top);return{start:r.start-a,top:r.top-l}}},{key:"makeClone",value:function(){if(-1===wu.indexOf(this.type))throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var t=this.wot.wtTable,e=this.domBindings,n=e.rootDocument,r=e.rootWindow,o=n.createElement("DIV"),i=n.createElement("TABLE"),a=t.wtRootElement.parentNode;o.className="".concat(Su.get(this.type)," handsontable"),o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,i.className=t.TABLE.className,o.appendChild(i),a.appendChild(o);var l=this.wtSettings.getSetting("preventOverflow");return!0===l||"horizontal"===l&&this.type===yu||"vertical"===l&&this.type===mu?this.mainTableScrollableElement=r:"hidden"===r.getComputedStyle(a).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=an(t.TABLE),new wf(i,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}},{key:"reset",value:function(){if(this.clone){var t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,n=t.style,r=e.style,o=t.parentNode.style;U([n,r,o],(function(t){t.width="",t.height=""}))}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),t}();function jf(t){return jf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jf(t)}function Af(t,e,n){return Af=Bf()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=Function.bind.apply(t,r),i=new o;return n&&Hf(i,n.prototype),i},Af.apply(null,arguments)}function Mf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function If(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Wf(r.key),r)}}function xf(t,e,n){return e&&If(t.prototype,e),n&&If(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _f(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hf(t,e)}function Hf(t,e){return Hf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Hf(t,e)}function Nf(t){var e=Bf();return function(){var n,r=Vf(t);if(e){var o=Vf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Df(this,n)}}function Df(t,e){if(e&&("object"===jf(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Lf(t)}function Lf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bf(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Vf(t){return Vf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Vf(t)}function Ff(t,e,n){return e=Wf(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wf(t){var e=Uf(t,"string");return"symbol"===jf(e)?e:String(e)}function Uf(t,e){if("object"!==jf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==jf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var zf=function(t){_f(n,t);var e=Nf(n);function n(t,r,o,i){var a;return Mf(this,n),a=e.call(this,t,r,yu,o,i),Ff(Lf(a),"cachedFixedRowsTop",-1),a.cachedFixedRowsTop=a.wtSettings.getSetting("fixedRowsTop"),a}return xf(n,[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Af(lc,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var t=this.clone.wtTable.holder.parentNode,e=this.domBindings.rootWindow,n=this.wtSettings.getSetting("preventOverflow"),r=0,o=!1;if(this.trimmingContainer!==e||n&&"vertical"===n)r=this.getScrollPosition(),Tn(t);else{var i=this.wot.wtTable,a=i.hider.getBoundingClientRect(),l=Math.ceil(a.bottom),s=t.offsetHeight;o=l===s,r=this.getOverlayOffset(),En(t,"0px","".concat(r,"px"))}var u=this.adjustHeaderBordersPosition(r,o);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(t){var e=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo(nn(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(t,e){var n=this.wtSettings.getSetting("defaultRowHeight"),r=t,o=0;while(r<e){var i=this.wot.wtTable.getRowHeight(r);o+=void 0===i?n:i,r+=1}return o}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable,e=this.domBindings,n=e.rootDocument,r=e.rootWindow,o=On(n),i=this.clone.wtTable.holder.parentNode,a=i.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===l){var s=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(s-=o),s=Math.min(s,t.wtRootElement.scrollWidth),a.width="".concat(s,"px")}else a.width="";this.clone.wtTable.holder.style.width=a.width;var u=hn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height="".concat(u,"px")}},{key:"adjustRootChildrenSize",value:function(){var t,e=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(t=null===n||void 0===n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==t?t:0);this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height="".concat(parseInt(e.parentNode.style.height,10)+o,"px")}},{key:"applyToDOM",value:function(){var t=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var t=this.isRtl()?"right":"left",e=this.clone.wtTable.spreader;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):e.style[t]=""}},{key:"scrollTo",value:function(t,e){var n=this.wot,r=this.wtSettings,o=n.cloneSource?n.cloneSource:n,i=o.wtTable.holder,a=this.getTableParentOffset(),l=0;if(e){var s=this.wot.wtTable.getRowHeight(t),u=this.wot.wtViewport.getViewportHeight();s>u&&(e=!1)}if(e&&i.offsetHeight!==i.clientHeight&&(l=On(this.domBindings.rootDocument)),e){var c=r.getSetting("fixedRowsBottom"),f=r.getSetting("totalRows");a+=this.sumCellSizes(0,t+1),a-=n.wtViewport.getViewportHeight()-this.sumCellSizes(f-c,f),a+=1}else a+=this.sumCellSizes(r.getSetting("fixedRowsTop"),t);return a+=l,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return rn(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var t=this.domBindings.rootWindow,e=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){var r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),i=r-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>i&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("totalColumns");r?Ye(n,"emptyColumns"):Ge(n,"emptyColumns");var o=!1;if(!e){var i=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==i,l=this.wtSettings.getSetting("columnHeaders");if((a||0===i)&&l.length>0){var s=ze(n,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),t||0===this.wtSettings.getSetting("totalRows")?(Ge(n,"innerBorderTop"),o=!s):(Ye(n,"innerBorderTop"),o=s)}}return o}}]),n}(Tf),Gf="stickyRowsBottom",Yf={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return 0===t||0===e?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};dt(Yf,"MIXIN_NAME",Gf,{writable:!1,enumerable:!1});var Kf=Yf;function Xf(t){return Xf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xf(t)}function $f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Qf(r.key),r)}}function qf(t,e,n){return e&&$f(t.prototype,e),n&&$f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qf(t){var e=Jf(t,"string");return"symbol"===Xf(e)?e:String(e)}function Jf(t,e){if("object"!==Xf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Xf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Zf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function th(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eh(t,e)}function eh(t,e){return eh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},eh(t,e)}function nh(t){var e=ih();return function(){var n,r=ah(t);if(e){var o=ah(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rh(this,n)}}function rh(t,e){if(e&&("object"===Xf(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return oh(t)}function oh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ih(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function ah(t){return ah=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ah(t)}var lh=function(t){th(n,t);var e=nh(n);function n(t,r,o,i){return Zf(this,n),e.call(this,t,r,o,i,vu)}return qf(n)}(Vu);ct(lh,Kf),ct(lh,Yu);var sh=lh;function uh(t){return uh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uh(t)}function ch(t,e,n){return ch=bh()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=Function.bind.apply(t,r),i=new o;return n&&yh(i,n.prototype),i},ch.apply(null,arguments)}function fh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ch(r.key),r)}}function dh(t,e,n){return e&&hh(t.prototype,e),n&&hh(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ph(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yh(t,e)}function yh(t,e){return yh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},yh(t,e)}function vh(t){var e=bh();return function(){var n,r=wh(t);if(e){var o=wh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mh(this,n)}}function mh(t,e){if(e&&("object"===uh(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return gh(t)}function gh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bh(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function wh(t){return wh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wh(t)}function Sh(t,e,n){return e=Ch(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ch(t){var e=Oh(t,"string");return"symbol"===uh(e)?e:String(e)}function Oh(t,e){if("object"!==uh(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==uh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var kh=function(t){ph(n,t);var e=vh(n);function n(t,r,o,i){var a;return fh(this,n),a=e.call(this,t,r,vu,o,i),Sh(gh(a),"cachedFixedRowsBottom",-1),a.cachedFixedRowsBottom=a.wtSettings.getSetting("fixedRowsBottom"),a}return dh(n,[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return ch(sh,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var t=this.domBindings.rootWindow,e=this.clone.wtTable.holder.parentNode;e.style.top="";var n=0,r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||r&&"vertical"===r?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),e.style.bottom="".concat(n,"px"));var o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}},{key:"repositionOverlay",value:function(){var t=this.wot,e=t.wtTable,n=t.wtViewport,r=this.domBindings.rootDocument,o=this.clone.wtTable.holder.parentNode,i=0;n.hasVerticalScroll()||(i+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(i+=On(r)),o.style.bottom="".concat(i,"px")}},{key:"setScrollPosition",value:function(t){var e=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===e?(e.scrollTo(nn(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(t,e){var n=this.wot,r=n.wtTable,o=n.wtSettings,i=o.getSetting("defaultRowHeight"),a=t,l=0;while(a<e){var s=r.getRowHeight(a);l+=void 0===s?i:s,a+=1}return l}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var t=this.wot,e=t.wtTable,n=t.wtViewport,r=this.domBindings,o=r.rootDocument,i=r.rootWindow,a=On(o),l=this.clone.wtTable.holder.parentNode,s=l.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||"horizontal"===u){var c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=a),c=Math.min(c,e.wtRootElement.scrollWidth),s.width="".concat(c,"px")}else s.width="";this.clone.wtTable.holder.style.width=s.width;var f=hn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(f=0),s.height="".concat(f,"px")}},{key:"adjustRootChildrenSize",value:function(){var t=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}},{key:"applyToDOM",value:function(){var t=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var t=this.isRtl()?"right":"left",e=this.clone.wtTable.spreader;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):e.style[t]=""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),r=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=r.wtTable.holder,i=0;e&&o.offsetHeight!==o.clientHeight&&(i=On(this.domBindings.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return rn(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var t=this.domBindings.rootWindow,e=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){var r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),i=r-o,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+r,0),n>i&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==e,r=this.wtSettings.getSetting("columnHeaders"),o=!1;if((n||0===e)&&r.length>0){var i=this.wot.wtTable.holder.parentNode,a=ze(i,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?(Ge(i,"innerBorderBottom"),o=!a):(Ye(i,"innerBorderBottom"),o=a)}return o}}]),n}(Tf),Rh="calculatedRows",Eh={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};dt(Eh,"MIXIN_NAME",Rh,{writable:!1,enumerable:!1});var Ph=Eh,Th="stickyColumnsStart",jh={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return 0===t?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};dt(jh,"MIXIN_NAME",Th,{writable:!1,enumerable:!1});var Ah=jh;function Mh(t){return Mh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mh(t)}function Ih(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_h(r.key),r)}}function xh(t,e,n){return e&&Ih(t.prototype,e),n&&Ih(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _h(t){var e=Hh(t,"string");return"symbol"===Mh(e)?e:String(e)}function Hh(t,e){if("object"!==Mh(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Mh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Nh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dh(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lh(t,e)}function Lh(t,e){return Lh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Lh(t,e)}function Bh(t){var e=Wh();return function(){var n,r=Uh(t);if(e){var o=Uh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Vh(this,n)}}function Vh(t,e){if(e&&("object"===Mh(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Fh(t)}function Fh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Wh(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Uh(t){return Uh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Uh(t)}var zh=function(t){Dh(n,t);var e=Bh(n);function n(t,r,o,i){return Nh(this,n),e.call(this,t,r,o,i,mu)}return xh(n)}(Vu);ct(zh,Ph),ct(zh,Ah);var Gh=zh;function Yh(t){return Yh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yh(t)}function Kh(t,e,n){return Kh=od()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=Function.bind.apply(t,r),i=new o;return n&&td(i,n.prototype),i},Kh.apply(null,arguments)}function Xh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Qh(r.key),r)}}function qh(t,e,n){return e&&$h(t.prototype,e),n&&$h(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qh(t){var e=Jh(t,"string");return"symbol"===Yh(e)?e:String(e)}function Jh(t,e){if("object"!==Yh(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Yh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Zh(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&td(t,e)}function td(t,e){return td=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},td(t,e)}function ed(t){var e=od();return function(){var n,r=id(t);if(e){var o=id(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nd(this,n)}}function nd(t,e){if(e&&("object"===Yh(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return rd(t)}function rd(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function od(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function id(t){return id=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},id(t)}var ad=function(t){Zh(n,t);var e=ed(n);function n(t,r,o,i){return Xh(this,n),e.call(this,t,r,mu,o,i)}return qh(n,[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Kh(Gh,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var t=this.wot.wtTable;if(!this.needFullRender||!t.holder.parentNode)return!1;var e=this.domBindings.rootWindow,n=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow"),o=0;this.trimmingContainer!==e||r&&"horizontal"===r?(o=this.getScrollPosition(),Tn(n)):(o=this.getOverlayOffset()*(this.isRtl()?-1:1),En(n,"".concat(o,"px"),"0px"));var i=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),i}},{key:"setScrollPosition",value:function(t){var e=this.domBindings.rootWindow,n=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,en(e)),n=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(t,e){var n=this.wtSettings.getSetting("defaultColumnWidth"),r=t,o=0;while(r<e)o+=this.wot.wtTable.getStretchedColumnWidth(r)||n,r+=1;return o}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable,e=this.domBindings,n=e.rootDocument,r=e.rootWindow,o=On(n),i=this.clone.wtTable.holder.parentNode,a=i.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"vertical"===l){var s=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(s-=o),s=Math.min(s,t.wtRootElement.scrollHeight),a.height="".concat(s,"px")}else a.height="";this.clone.wtTable.holder.style.height=a.height;var u=fn(this.clone.wtTable.TABLE);a.width="".concat(u,"px")}},{key:"adjustRootChildrenSize",value:function(){var t,e=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(t=null===n||void 0===n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==t?t:0);this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width="".concat(parseInt(e.parentNode.style.width,10)+o,"px")}},{key:"applyToDOM",value:function(){var t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[e]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),r=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=r.wtTable.holder,i=0;if(e){var a=this.wot.wtTable.getColumnWidth(t),l=this.wot.wtViewport.getViewportWidth();a>l&&(e=!1)}return e&&o.offsetWidth!==o.clientWidth&&(i=On(this.domBindings.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var t=this.wtSettings.getSetting("preventOverflow"),e=0;return t||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}},{key:"getScrollPosition",value:function(){return Math.abs(on(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var t=this.domBindings.rootWindow,e=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===t&&(!e||"horizontal"!==e)){n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var r=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),i=r-o;n>i&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),r=this.wtSettings.getSetting("fixedColumnsStart"),o=this.wtSettings.getSetting("totalRows");o?Ye(e,"emptyRows"):Ge(e,"emptyRows");var i=!1;if(r&&!n.length)Ge(e,"innerBorderLeft innerBorderInlineStart");else if(!r&&n.length){var a=ze(e,"innerBorderInlineStart");t?(Ge(e,"innerBorderLeft innerBorderInlineStart"),i=!a):(Ye(e,"innerBorderLeft innerBorderInlineStart"),i=a)}return i}}]),n}(Tf);function ld(t){return ld="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ld(t)}function sd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,cd(r.key),r)}}function ud(t,e,n){return e&&sd(t.prototype,e),n&&sd(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function cd(t){var e=fd(t,"string");return"symbol"===ld(e)?e:String(e)}function fd(t,e){if("object"!==ld(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ld(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function hd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dd(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pd(t,e)}function pd(t,e){return pd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},pd(t,e)}function yd(t){var e=gd();return function(){var n,r=bd(t);if(e){var o=bd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vd(this,n)}}function vd(t,e){if(e&&("object"===ld(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return md(t)}function md(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gd(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function bd(t){return bd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bd(t)}var wd=function(t){dd(n,t);var e=yd(n);function n(t,r,o,i){return hd(this,n),e.call(this,t,r,o,i,gu)}return ud(n)}(Vu);ct(wd,Uu),ct(wd,Ah);var Sd=wd;function Cd(t){return Cd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cd(t)}function Od(t,e,n){return Od=Id()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=Function.bind.apply(t,r),i=new o;return n&&Td(i,n.prototype),i},Od.apply(null,arguments)}function kd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Hd(r.key),r)}}function Ed(t,e,n){return e&&Rd(t.prototype,e),n&&Rd(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Pd(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Td(t,e)}function Td(t,e){return Td=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Td(t,e)}function jd(t){var e=Id();return function(){var n,r=xd(t);if(e){var o=xd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ad(this,n)}}function Ad(t,e){if(e&&("object"===Cd(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Md(t)}function Md(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Id(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function xd(t){return xd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xd(t)}function _d(t,e,n){return e=Hd(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hd(t){var e=Nd(t,"string");return"symbol"===Cd(e)?e:String(e)}function Nd(t,e){if("object"!==Cd(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Cd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Dd=function(t){Pd(n,t);var e=jd(n);function n(t,r,o,i,a,l){var s;return kd(this,n),s=e.call(this,t,r,gu,o,i),_d(Md(s),"topOverlay",void 0),_d(Md(s),"inlineStartOverlay",void 0),s.topOverlay=a,s.inlineStartOverlay=l,s}return Ed(n,[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Od(Sd,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var e=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),n=this.topOverlay.getOverlayOffset();En(t,"".concat(e,"px"),"".concat(n,"px"))}else Tn(t);var r=hn(this.clone.wtTable.TABLE),o=fn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),t.style.height="".concat(r,"px"),t.style.width="".concat(o,"px"),!1}}]),n}(Tf);function Ld(t){return Ld="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ld(t)}function Bd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Fd(r.key),r)}}function Vd(t,e,n){return e&&Bd(t.prototype,e),n&&Bd(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fd(t){var e=Wd(t,"string");return"symbol"===Ld(e)?e:String(e)}function Wd(t,e){if("object"!==Ld(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ld(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ud(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zd(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gd(t,e)}function Gd(t,e){return Gd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Gd(t,e)}function Yd(t){var e=$d();return function(){var n,r=qd(t);if(e){var o=qd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Kd(this,n)}}function Kd(t,e){if(e&&("object"===Ld(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Xd(t)}function Xd(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $d(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function qd(t){return qd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qd(t)}var Qd=function(t){zd(n,t);var e=Yd(n);function n(t,r,o,i){return Ud(this,n),e.call(this,t,r,o,i,bu)}return Vd(n)}(Vu);ct(Qd,Kf),ct(Qd,Ah);var Jd=Qd;function Zd(t){return Zd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zd(t)}function tp(t,e,n){return tp=fp()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=Function.bind.apply(t,r),i=new o;return n&&lp(i,n.prototype),i},tp.apply(null,arguments)}function ep(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function np(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,op(r.key),r)}}function rp(t,e,n){return e&&np(t.prototype,e),n&&np(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function op(t){var e=ip(t,"string");return"symbol"===Zd(e)?e:String(e)}function ip(t,e){if("object"!==Zd(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Zd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ap(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lp(t,e)}function lp(t,e){return lp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lp(t,e)}function sp(t){var e=fp();return function(){var n,r=hp(t);if(e){var o=hp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return up(this,n)}}function up(t,e){if(e&&("object"===Zd(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return cp(t)}function cp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fp(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function hp(t){return hp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hp(t)}var dp=function(t){ap(n,t);var e=sp(n);function n(t,r,o,i,a,l){var s;return ep(this,n),s=e.call(this,t,r,bu,o,i),s.bottomOverlay=a,s.inlineStartOverlay=l,s}return rp(n,[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return tp(Jd,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var t=this.wot;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var n=this.inlineStartOverlay.getOverlayOffset(),r=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]="".concat(n,"px"),e.style.bottom="".concat(r,"px")}else Tn(e),this.repositionOverlay();var o=hn(this.clone.wtTable.TABLE),i=fn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(o=0),e.style.height="".concat(o,"px"),e.style.width="".concat(i,"px"),!1}},{key:"repositionOverlay",value:function(){var t=this.wot,e=t.wtTable,n=t.wtViewport,r=this.domBindings.rootDocument,o=this.clone.wtTable.holder.parentNode,i=0;n.hasVerticalScroll()||(i+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(i+=On(r)),o.style.bottom="".concat(i,"px")}}]),n}(Tf);function pp(t){return pp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pp(t)}function yp(t,e,n){return yp=vp()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=Function.bind.apply(t,r),i=new o;return n&&mp(i,n.prototype),i},yp.apply(null,arguments)}function vp(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function mp(t,e){return mp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},mp(t,e)}function gp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Cp(r.key),r)}}function wp(t,e,n){return e&&bp(t.prototype,e),n&&bp(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Sp(t,e,n){return e=Cp(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cp(t){var e=Op(t,"string");return"symbol"===pp(e)?e:String(e)}function Op(t,e){if("object"!==pp(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==pp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var kp=function(){function t(e,n,r,o,i,a){var l=this;gp(this,t),Sp(this,"wot",null),Sp(this,"topOverlay",null),Sp(this,"bottomOverlay",null),Sp(this,"inlineStartOverlay",null),Sp(this,"topInlineStartCornerOverlay",null),Sp(this,"bottomInlineStartCornerOverlay",null),Sp(this,"browserLineHeight",void 0),Sp(this,"wtSettings",null),Sp(this,"resizeObserver",new ResizeObserver((function(t){P((function(){Array.isArray(t)&&t.length&&l.wtSettings.getSetting("onContainerElementResize")}))}))),this.wot=e,this.wtSettings=o,this.domBindings=r,this.facadeGetter=n,this.wtTable=a;var s=this.domBindings,u=s.rootDocument,c=s.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=On(u);var f="hidden"===c.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=f?a.holder:an(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}return wp(t,[{key:"getOverlays",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return t&&e.push(this.wtTable),e}},{key:"initBrowserLineHeight",value:function(){var t=this.domBindings,e=t.rootWindow,n=t.rootDocument,r=e.getComputedStyle(n.body),o=parseInt(r.lineHeight,10),i=1.2*parseInt(r.fontSize,10);this.browserLineHeight=o||i}},{key:"initOverlays",value:function(){var t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=yp(zf,t),this.bottomOverlay=yp(kh,t),this.inlineStartOverlay=yp(ad,t),this.topInlineStartCornerOverlay=yp(Dd,t.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=yp(dp,t.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var t=this.topOverlay.updateStateOfRendering();return t=this.bottomOverlay.updateStateOfRendering()||t,t=this.inlineStartOverlay.updateStateOfRendering()||t,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(t=this.topInlineStartCornerOverlay.updateStateOfRendering()||t),this.bottomOverlay.needFullRender&&(t=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||t)),t}},{key:"refreshAll",value:function(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var t=this,e=this.domBindings,n=e.rootDocument,r=e.rootWindow,o=this.topOverlay.mainTableScrollableElement,i=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",(function(e){return t.onKeyDown(e)})),this.eventManager.addEventListener(n.documentElement,"keyup",(function(){return t.onKeyUp()})),this.eventManager.addEventListener(n,"visibilitychange",(function(){return t.onKeyUp()})),this.eventManager.addEventListener(o,"scroll",(function(e){return t.onTableScroll(e)}),{passive:!0}),o!==i&&this.eventManager.addEventListener(i,"scroll",(function(e){return t.onTableScroll(e)}),{passive:!0});var a=r.devicePixelRatio&&r.devicePixelRatio>1,l=this.scrollableElement===r,s=this.wtSettings.getSetting("preventWheel"),u={passive:l};(s||a||!Rt())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(function(e){return t.onCloneWheel(e,s)}),u);var c,f=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];f.forEach((function(e){if(e&&e.needFullRender){var n=e.clone.wtTable.holder;t.eventManager.addEventListener(n,"wheel",(function(e){return t.onCloneWheel(e,s)}),u)}})),this.eventManager.addEventListener(r,"resize",(function(){clearTimeout(c),c=setTimeout((function(){t.wtSettings.getSetting("onWindowResize")}),200)})),l||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(t){var e=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=t.target;this.keyPressed&&(r!==e&&o!==e&&!t.target.contains(r)||n!==e&&o!==e&&!t.target.contains(n))||this.syncScrollPositions(t)}},{key:"onCloneWheel",value:function(t,e){var n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=t.target,a=o!==n&&i!==n&&!i.contains(o),l=r!==n&&i!==n&&!i.contains(r);if(!this.keyPressed||!a&&!l){var s=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==n&&s)&&t.preventDefault()}}},{key:"onKeyDown",value:function(t){this.keyPressed=Jn(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(t){var e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,n=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(n+=n*this.browserLineHeight,e+=e*this.browserLineHeight);var r=this.scrollVertically(e),o=this.scrollHorizontally(n);return r||o}},{key:"scrollVertically",value:function(t){var e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(t){var e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var t=this.domBindings.rootWindow,e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,r=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=r[0],i=r[1];if(this.horizontalScrolling=e.scrollLeft!==o||this.lastScrollX!==t.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=o;var a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var t=this.topOverlay.mainTableScrollableElement,e=t.scrollLeft,n=t.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var t=this.wtTable,e=this.domBindings.rootWindow;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=an(t.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.updateLastSpreaderSize();e&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}},{key:"updateLastSpreaderSize",value:function(){var t=this.wtTable.spreader,e=t.clientWidth,n=t.clientHeight,r=e!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=n),r}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.wot.wtViewport,n=this.wtTable,r=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),i=e.getRowHeaderWidth(),a=e.getColumnHeaderHeight(),l=n.hider.style;if(l.width="".concat(i+this.inlineStartOverlay.sumCellSizes(0,r),"px"),l.height="".concat(a+this.topOverlay.sumCellSizes(0,o)+1,"px"),this.scrollbarSize>0){var s=n.wtRootElement,u=s.scrollHeight,c=s.scrollWidth,f=n.holder,h=f.scrollHeight,d=f.scrollWidth;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<d,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.inlineStartOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(t){if(!t)return null;var e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],n=null;return U(e,(function(e){e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(n=e.clone)})),n}},{key:"syncOverlayTableClassNames",value:function(){var t=this.wtTable.TABLE,e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];U(e,(function(e){e&&(e.clone.wtTable.TABLE.className=t.className)}))}}]),t}(),Rp=kp;function Ep(t){return Ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ep(t)}function Pp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Mp(r.key),r)}}function jp(t,e,n){return e&&Tp(t.prototype,e),n&&Tp(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ap(t,e,n){return e=Mp(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mp(t){var e=Ip(t,"string");return"symbol"===Ep(e)?e:String(e)}function Ip(t,e){if("object"!==Ep(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ep(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var xp=function(){function t(e){var n=this;Pp(this,t),Ap(this,"settings",{}),Ap(this,"defaults",Object.freeze(this.getDefaults())),pt(this.defaults,(function(t,r){if(void 0!==e[r])n.settings[r]=e[r];else{if(void 0===t)throw new Error('A required setting "'.concat(r,'" was not provided'));n.settings[r]=t}}))}return jp(t,[{key:"getDefaults",value:function(){var t=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return t.getSetting("fixedColumnsStart")>0||t.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return t.getSetting("fixedRowsTop")>0||t.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return t.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,n,r){var o=t.getSetting("data",e,n);Je(r,void 0===o||null===o?"":o)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(t){return t},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(t){return t},onBeforeHighlightingColumnHeader:function(t){return t},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(t,e){var n=this;return void 0===e?pt(t,(function(t,e){n.settings[e]=t})):this.settings[t]=e,this}},{key:"getSetting",value:function(t,e,n,r,o){return"function"===typeof this.settings[t]?this.settings[t](e,n,r,o):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}},{key:"getSettingPure",value:function(t){return this.settings[t]}},{key:"has",value:function(t){return!!this.settings[t]}}]),t}();function _p(t){return _p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_p(t)}function Hp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Np(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Lp(r.key),r)}}function Dp(t,e,n){return e&&Np(t.prototype,e),n&&Np(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Lp(t){var e=Bp(t,"string");return"symbol"===_p(e)?e:String(e)}function Bp(t,e){if("object"!==_p(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==_p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Vp(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fp(t,e)}function Fp(t,e){return Fp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Fp(t,e)}function Wp(t){var e=Gp();return function(){var n,r=Yp(t);if(e){var o=Yp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Up(this,n)}}function Up(t,e){if(e&&("object"===_p(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return zp(t)}function zp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gp(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Yp(t){return Yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yp(t)}var Kp=function(t){Vp(n,t);var e=Wp(n);function n(t,r,o,i){return Hp(this,n),e.call(this,t,r,o,i,"master")}return Dp(n,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var t=ln(this.wtRootElement),e=this.domBindings.rootWindow;if(t===e){var n=this.wtSettings.getSetting("preventOverflow");n||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var r=t.parentElement,o=sn(t,"height",e),i=sn(t,"overflow",e),a=this.holder.style,l=t.scrollWidth,s=t.scrollHeight,u=t.getBoundingClientRect(),c=u.width,f=u.height,h=["auto","hidden","scroll"];if(r&&h.includes(i)){var d=t.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",t.nextElementSibling?r.insertBefore(d,t.nextElementSibling):r.appendChild(d);var p=parseInt(cn(d,e).height,10);r.removeChild(d),0===p&&(f=0)}f=Math.min(f,s),a.height="auto"===o?"auto":"".concat(f,"px"),c=Math.min(c,l),a.width="".concat(c,"px"),a.overflow="",this.hasTableHeight="auto"===a.height||f>0,this.hasTableWidth=c>0}this.isTableVisible=Ze(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var t=this.wtSettings,e=this.dataAccessObject.wtViewport,n="master",r=t.getSetting("columnHeaders"),o=r.length;if(o&&!e.hasOversizedColumnHeadersMarked[n]){for(var i=t.getSetting("rowHeaders"),a=i.length,l=this.getRenderedColumnsCount(),s=0;s<o;s++)for(var u=-1*a;u<l;u++)this.markIfOversizedColumnHeader(u);e.hasOversizedColumnHeadersMarked[n]=!0}}}]),n}(Vu);ct(Kp,Ph),ct(Kp,Yu);var Xp=Kp,$p=1,qp=2;function Qp(t){return Qp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qp(t)}function Jp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ey(r.key),r)}}function ty(t,e,n){return e&&Zp(t.prototype,e),n&&Zp(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ey(t){var e=ny(t,"string");return"symbol"===Qp(e)?e:String(e)}function ny(t,e){if("object"!==Qp(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Qp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ry=new WeakMap,oy=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.viewportSize,r=e.scrollOffset,o=e.totalItems,i=e.itemSizeFn,a=e.overrideFn,l=e.calculationType,s=e.scrollbarHeight;Jp(this,t),ry.set(this,{viewportHeight:n,scrollOffset:r,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:l,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return ty(t,[{key:"calculate",value:function(){for(var e,n=ry.get(this),r=n.calculationType,o=n.overrideFn,i=n.rowHeightFn,a=n.scrollOffset,l=Math.max(n.scrollOffset,0),s=n.totalRows,u=n.viewportHeight,c=n.horizontalScrollbarHeight||0,f=0,h=!0,d=[],p=0,y=0,v=0;v<s;v++)if(e=i(v),isNaN(e)&&(e=t.DEFAULT_HEIGHT),f<=l&&r!==qp&&(this.startRow=v,p=e),f>=l&&f+(r===qp?e:0)<=l+u-c&&(null===this.startRow&&(this.startRow=v,p=e),this.endRow=v),d.push(f),f+=e,y=e,r!==qp&&(this.endRow=v),f>=l+u-c){h=!1;break}var m=a+u-c,g=r===qp?p:0,b=r===qp?0:y;if(m<g||a>d.at(-1)+b?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===s-1&&h){this.startRow=this.endRow;while(this.startRow>0){var w=d[this.endRow]+e-d[this.startRow-1];if((w<=u-c||r!==qp)&&(this.startRow-=1),w>=u-c)break}}r===$p&&null!==this.startRow&&o&&o(this),this.startPosition=d[this.startRow],void 0===this.startPosition&&(this.startPosition=null),s<this.endRow&&(this.endRow=s-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),t}(),iy=oy;function ay(t){return ay="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ay(t)}function ly(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,cy(r.key),r)}}function uy(t,e,n){return e&&sy(t.prototype,e),n&&sy(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function cy(t){var e=fy(t,"string");return"symbol"===ay(e)?e:String(e)}function fy(t,e){if("object"!==ay(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ay(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var hy=new WeakMap,dy=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.viewportSize,r=e.scrollOffset,o=e.totalItems,i=e.itemSizeFn,a=e.overrideFn,l=e.calculationType,s=e.stretchMode,u=e.stretchingItemWidthFn,c=void 0===u?function(t){return t}:u,f=e.inlineStartOffset;ly(this,t),hy.set(this,{viewportWidth:n,scrollOffset:r,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:l,stretchingColumnWidthFn:c,inlineStartOffset:f}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return uy(t,[{key:"calculate",value:function(){for(var t,e=0,n=!0,r=[],o=0,i=0,a=hy.get(this),l=a.calculationType,s=a.overrideFn,u=a.scrollOffset,c=Math.max(a.scrollOffset,0),f=a.totalColumns,h=a.viewportWidth,d=c>0?h+1:h,p=0;p<f;p++)if(t=this._getColumnWidth(p),e<=c&&l!==qp&&(this.startColumn=p,o=t),e>=c&&e+(l===qp?t:0)<=c+d&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=p,o=t),this.endColumn=p),r.push(e),e+=t,i=t,l!==qp&&(this.endColumn=p),e>=c+h){n=!1;break}var y=u+h-d,v=l===qp?0:i,m=l===qp?o:0;if(y<-1*a.inlineStartOffset||u>r.at(-1)+v||-1*a.scrollOffset-a.viewportWidth>-1*m?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===f-1&&n){this.startColumn=this.endColumn;while(this.startColumn>0){var g=r[this.endColumn]+t-r[this.startColumn-1];if((g<=h||l!==qp)&&(this.startColumn-=1),g>h)break}}l===$p&&null!==this.startColumn&&s&&s(this),this.startPosition=r[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),f<this.endColumn&&(this.endColumn=f-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(t){if("none"!==this.stretch){var e=t;this.totalTargetWidth=e;for(var n=hy.get(this),r=n.totalColumns,o=0,i=0;i<r;i++){var a=this._getColumnWidth(i),l=n.stretchingColumnWidthFn(void 0,i);"number"===typeof l?e-=l:o+=a}var s=e-o;if("all"===this.stretch&&s>0)this.stretchAllRatio=e/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&e!==1/0){var u=this._getColumnWidth(r-1),c=s+u;this.stretchLastWidth=c>=0?c:u}}}},{key:"getStretchedColumnWidth",value:function(t,e){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(t,e):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(t)),n}},{key:"_getStretchedAllColumnWidth",value:function(t,e){var n=0,r=hy.get(this),o=r.totalColumns;if(!this.stretchAllColumnsWidth[t]){var i=Math.round(e*this.stretchAllRatio),a=r.stretchingColumnWidthFn(i,t);this.stretchAllColumnsWidth[t]=void 0===a?i:isNaN(a)?this._getColumnWidth(t):a}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var l=0;l<this.stretchAllColumnsWidth.length;l++)n+=this.stretchAllColumnsWidth[l];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[t]}},{key:"_getStretchedLastColumnWidth",value:function(t){var e=hy.get(this),n=e.totalColumns;return t===n-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(e){var n=hy.get(this).columnWidthFn(e);return isNaN(n)&&(n=t.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),t}(),py=dy;function yy(t){return yy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yy(t)}function vy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function my(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,by(r.key),r)}}function gy(t,e,n){return e&&my(t.prototype,e),n&&my(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function by(t){var e=wy(t,"string");return"symbol"===yy(e)?e:String(e)}function wy(t,e){if("object"!==yy(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==yy(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Sy=function(){function t(e,n,r,o,i){var a=this;vy(this,t),this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(function(){a.clientHeight=a.getWorkspaceHeight()}))}return gy(t,[{key:"getWorkspaceHeight",value:function(){var t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer,n=0;if(e===this.domBindings.rootWindow)n=t.documentElement.clientHeight;else{var r=hn(e);n=r>0&&e.clientHeight>0?e.clientHeight:1/0}return n}},{key:"getWorkspaceWidth",value:function(){var t,e,n=this.wtSettings,r=this.domBindings,o=r.rootDocument,i=r.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=o.documentElement.offsetWidth,s=n.getSetting("totalColumns"),u=n.getSetting("preventOverflow"),c=n.getSetting("rtlMode"),f=this.wtTable.TABLE.getBoundingClientRect(),h=c?f.right-l:f.left,d=l-h;if(u)return fn(this.wtTable.wtRootElement);if(t=n.getSetting("freezeOverlays")?Math.min(d,l):Math.min(this.getContainerFillWidth(),d,l),a===i&&s>0&&this.sumColumnWidths(0,s-1)>t)return o.documentElement.clientWidth;if(a!==i&&(e=sn(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),"scroll"===e||"hidden"===e||"auto"===e))return Math.max(t,a.clientWidth);var p=n.getSetting("stretchH");return"none"!==p&&p?t:Math.max(t,fn(this.wtTable.TABLE))}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(t,e){var n=0,r=t;while(r<e)n+=this.wtTable.getColumnWidth(r),r+=1;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);var n=e.offsetWidth;return this.containerWidth=n,t.removeChild(e),n}},{key:"getWorkspaceOffset",value:function(){return tn(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var t=this.wtSettings.getSetting("columnHeaders");return t.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=hn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var t=this.getWorkspaceHeight();if(t===1/0)return t;var e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}},{key:"getRowHeaderWidth",value:function(){var t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(var n=0,r=e.length;n<r;n++)this.rowHeaderWidth+=t[n]||t}if(isNaN(this.rowHeaderWidth))if(e.length){var o=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var i=0,a=e.length;i<a;i++)o?(this.rowHeaderWidth+=fn(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var t=this.getWorkspaceWidth();if(t===1/0)return t;var e=this.getRowHeaderWidth();return e>0?t-e:t}},{key:"createRowsCalculator",value:function(){var t,e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$p,o=this.wtSettings,i=this.wtTable;this.rowHeaderWidth=NaN,t=o.getSetting("renderAllRows")&&r===$p?1/0:this.getViewportHeight();var a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,l=o.getSetting("fixedRowsTop"),s=o.getSetting("fixedRowsBottom"),u=o.getSetting("totalRows");return l&&a>=0&&(n=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=n,t-=n),s&&this.dataAccessObject.bottomOverlay.clone&&(n=this.dataAccessObject.bottomOverlay.sumCellSizes(u-s,u),t-=n),e=i.holder.clientHeight===i.holder.offsetHeight?0:On(this.domBindings.rootDocument),new iy({viewportSize:t,scrollOffset:a,totalItems:o.getSetting("totalRows"),itemSizeFn:function(t){return i.getRowHeight(t)},overrideFn:o.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:e})}},{key:"createColumnsCalculator",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$p,e=this.wtSettings,n=this.wtTable,r=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var i=e.getSetting("fixedColumnsStart");if(i&&o>=0){var a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,i);o+=a,r-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(r-=On(this.domBindings.rootDocument)),new py({viewportSize:r,scrollOffset:o,totalItems:e.getSetting("totalColumns"),itemSizeFn:function(t){return n.getColumnWidth(t)},overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),calculationType:t,stretchMode:e.getSetting("stretchH"),stretchingItemWidthFn:function(t,n){return e.getSetting("onBeforeStretchingColumnWidth",t,n)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=t;if(e){var n=this.createRowsCalculator(qp),r=this.createColumnsCalculator(qp);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(r)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator($p),this.columnsRenderCalculator=this.createColumnsCalculator($p)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(qp),this.columnsVisibleCalculator=this.createColumnsCalculator(qp)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(t){if(!this.rowsVisibleCalculator)return!1;var e=t.startRow,n=t.endRow,r=t.isVisibleInTrimmingContainer;if(null===e&&null===n)return!r;var o=this.rowsRenderCalculator,i=o.startRow,a=o.endRow;return!(e<i||e===i&&e>0)&&!(n>a||n===a&&n<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(t){if(!this.columnsVisibleCalculator)return!1;var e=t.startColumn,n=t.endColumn,r=t.isVisibleInTrimmingContainer;if(null===e&&null===n)return!r;var o=this.columnsRenderCalculator,i=o.startColumn,a=o.endColumn;return!(e<i||e===i&&e>0)&&!(n>a||n===a&&n<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){pt(this.hasOversizedColumnHeadersMarked,(function(t,e,n){n[e]=void 0}))}}]),t}(),Cy=Sy;function Oy(t){return Oy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oy(t)}function ky(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ry(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Py(r.key),r)}}function Ey(t,e,n){return e&&Ry(t.prototype,e),n&&Ry(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Py(t){var e=Ty(t,"string");return"symbol"===Oy(e)?e:String(e)}function Ty(t,e){if("object"!==Oy(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Oy(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function jy(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ay(t,e)}function Ay(t,e){return Ay=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ay(t,e)}function My(t){var e=_y();return function(){var n,r=Hy(t);if(e){var o=Hy(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Iy(this,n)}}function Iy(t,e){if(e&&("object"===Oy(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return xy(t)}function xy(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _y(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Hy(t){return Hy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Hy(t)}var Ny=function(t){jy(n,t);var e=My(n);function n(t,r){var o;ky(this,n),o=e.call(this,t,new xp(r));var i=o.wtSettings.getSetting("facade",xy(o));return o.wtTable=new Xp(o.getTableDao(),i,o.domBindings,o.wtSettings),o.wtViewport=new Cy(o.getViewportDao(),o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.selections=o.wtSettings.getSetting("selections"),o.wtEvent=new la(i,o.domBindings,o.wtSettings,o.eventManager,o.wtTable,o.selections),o.wtOverlays=new Rp(xy(o),i,o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.exportSettingsAsClassNames(),o.findOriginalHeaders(),o}return Ey(n,[{key:"exportSettingsAsClassNames",value:function(){var t=this,e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];pt(e,(function(e,o){t.wtSettings.getSetting(o).length&&r.push(e),n.push(e)})),Ye(this.wtTable.wtRootElement.parentNode,n),Ge(this.wtTable.wtRootElement.parentNode,r)}},{key:"getViewportDao",value:function(){var t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}]),n}(of);function Dy(t){return Dy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dy(t)}function Ly(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function By(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Fy(r.key),r)}}function Vy(t,e,n){return e&&By(t.prototype,e),n&&By(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fy(t){var e=Wy(t,"string");return"symbol"===Dy(e)?e:String(e)}function Wy(t,e){if("object"!==Dy(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Dy(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Uy=function(){function t(e){Ly(this,t),e instanceof of?this._wot=e:this._initFromSettings(e)}return Vy(t,[{key:"_initFromSettings",value:function(e){e.facade=function(e){var n=new t(e);return function(){return n}},this._wot=new Ny(e.table,e)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(t){this._wot.drawn=t}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(t){this._wot.drawInterrupted=t}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(t){this._wot.lastMouseOver=t}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(t){this._wot.momentumScrolling=t}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(t){this._wot.touchApplied=t}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(t){this._wot.eventListeners=t}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(t,e){return this._wot.createCellCoords(t,e)}},{key:"createCellRange",value:function(t,e,n){return this._wot.createCellRange(t,e,n)}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}},{key:"getCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}},{key:"scrollViewport",value:function(t,e,n,r,o){return this._wot.scrollViewport(t,e,n,r,o)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return this._wot.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return this._wot.scrollViewportVertically(t,e,n)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(t,e){return this._wot.wtSettings.update(t,e),this}},{key:"getSetting",value:function(t,e,n,r,o){return this._wot.wtSettings.getSetting(t,e,n,r,o)}},{key:"hasSetting",value:function(t){return this._wot.wtSettings.hasSetting(t)}},{key:"destroy",value:function(){this._wot.destroy()}}]),t}();function zy(t){var e=t.isShiftKey,n=t.isLeftClick,r=t.isRightClick,o=t.coords,i=t.selection,a=t.controller,l=t.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),c=i.isSelectedByRowHeader();if(e&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||c)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):c&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!c&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!c&&o.row<0||c&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var f=!i.inInSelection(o),h=n||r&&f;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function Gy(t){var e=t.isLeftClick,n=t.coords,r=t.selection,o=t.controller,i=t.cellCoordsFactory;if(e){var a=r.isSelectedByRowHeader(),l=r.isSelectedByColumnHeader(),s=r.tableProps.countCols(),u=r.tableProps.countRows();l&&!o.column?r.setRangeEnd(i(u-1,n.col)):a&&!o.row?r.setRangeEnd(i(n.row,s-1)):o.cell||r.setRangeEnd(n)}}var Yy=new Map([["mousedown",zy],["mouseover",Gy],["touchstart",zy]]);function Ky(t,e){var n=e.coords,r=e.selection,o=e.controller,i=e.cellCoordsFactory;Yy.get(t.type)({coords:n,selection:r,controller:o,cellCoordsFactory:i,isShiftKey:t.shiftKey,isLeftClick:nr(t)||"touchstart"===t.type,isRightClick:er(t)})}var Xy=new WeakMap,$y=Symbol("rootInstance");function qy(t){Xy.set(t,!0)}function Qy(t){return t===$y}function Jy(t){return Xy.has(t)}function Zy(t){return Zy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zy(t)}function tv(t,e){return rv(t)||nv(t,e)||av(t,e)||ev()}function ev(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function nv(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function rv(t){if(Array.isArray(t))return t}function ov(t){return sv(t)||lv(t)||av(t)||iv()}function iv(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function av(t,e){if(t){if("string"===typeof t)return uv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uv(t,e):void 0}}function lv(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function sv(t){if(Array.isArray(t))return uv(t)}function uv(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function cv(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vv(r.key),r)}}function hv(t,e,n){return e&&fv(t.prototype,e),n&&fv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function dv(t,e,n){pv(t,e),e.set(t,n)}function pv(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yv(t,e,n){return e=vv(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vv(t){var e=mv(t,"string");return"symbol"===Zy(e)?e:String(e)}function mv(t,e){if("object"!==Zy(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Zy(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function gv(t,e){var n=Sv(t,e,"get");return bv(t,n)}function bv(t,e){return e.get?e.get.call(t):e.value}function wv(t,e,n){var r=Sv(t,e,"set");return Cv(t,r,n),n}function Sv(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Cv(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ov=new WeakMap,kv=new WeakMap,Rv=new WeakMap,Ev=function(){function t(e){cv(this,t),yv(this,"instance",void 0),yv(this,"eventManager",void 0),yv(this,"settings",void 0),yv(this,"THEAD",void 0),yv(this,"TBODY",void 0),yv(this,"_wt",void 0),yv(this,"activeWt",void 0),dv(this,kv,{writable:!0,value:0}),dv(this,Rv,{writable:!0,value:0}),yv(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new Gr(this.instance),this.settings=this.instance.getSettings(),Ov.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return hv(t,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(t)}},{key:"getCellAtCoords",value:function(t,e){var n=this._wt.getCell(t,e);return n<0?null:n}},{key:"scrollViewport",value:function(t,e,n,r,o){return this._wt.scrollViewport(t,e,n,r,o)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return this._wt.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return this._wt.scrollViewportVertically(t,e,n)}},{key:"createElements",value:function(){var t=Ov.get(this),e=this.instance,n=e.rootElement,r=e.rootDocument,o=n.getAttribute("style");o&&n.setAttribute("data-originalstyle",o),Ge(n,"handsontable"),t.table=r.createElement("TABLE"),Ge(t.table,"htCore"),this.instance.getSettings().tableClassName&&Ge(t.table,this.instance.getSettings().tableClassName),this.THEAD=r.createElement("THEAD"),t.table.appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),t.table.appendChild(this.TBODY),this.instance.table=t.table,this.instance.container.insertBefore(t.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var t=this,e=Ov.get(this),n=this.instance,r=n.rootElement,o=n.rootDocument,i=n.selection,a=o.documentElement;this.eventManager.addEventListener(r,"mousedown",(function(n){if(e.selectionMouseDown=!0,!t.isTextSelectionAllowed(n.target)){var r=t.instance.rootWindow;wn(r),n.preventDefault(),r.focus()}})),this.eventManager.addEventListener(r,"mouseup",(function(){e.selectionMouseDown=!1})),this.eventManager.addEventListener(r,"mousemove",(function(n){e.selectionMouseDown&&!t.isTextSelectionAllowed(n.target)&&(t.settings.fragmentSelection&&wn(t.instance.rootWindow),n.preventDefault())})),this.eventManager.addEventListener(a,"keyup",(function(t){i.isInProgress()&&!t.shiftKey&&i.finish()})),this.eventManager.addEventListener(a,"mouseup",(function(n){i.isInProgress()&&nr(n)&&i.finish(),e.mouseDown=!1,!An(o.activeElement)&&(i.isSelected()||i.isSelectedByAnyHeader()||r.contains(n.target)||er(n))||t.instance.unlisten()})),this.eventManager.addEventListener(a,"contextmenu",(function(t){i.isInProgress()&&er(t)&&(i.finish(),e.mouseDown=!1)})),this.eventManager.addEventListener(a,"touchend",(function(){i.isInProgress()&&i.finish(),e.mouseDown=!1})),this.eventManager.addEventListener(a,"mousedown",(function(n){var i=n.target,l=n.x||n.clientX,s=n.y||n.clientY,u=n.target;if(!e.mouseDown&&r&&t.instance.view){var c=t.instance.view._wt.wtTable.holder;if(u===c){var f=On(o);if(o.elementFromPoint(l+f,s)!==c||o.elementFromPoint(l,s+f)!==c)return}else while(u!==a){if(null===u){if(n.isTargetWebComponent)break;return}if(u===r)return;u=u.parentNode}var h="function"===typeof t.settings.outsideClickDeselects?t.settings.outsideClickDeselects(i):t.settings.outsideClickDeselects;h?t.instance.deselectCell():t.instance.destroyEditor(!1,!1)}})),this.eventManager.addEventListener(e.table,"selectstart",(function(e){t.settings.fragmentSelection||jn(e.target)||e.preventDefault()}))}},{key:"translateFromRenderableToVisualCoords",value:function(t){var e,n=t.row,r=t.col;return(e=this.instance)._createCellCoords.apply(e,ov(this.translateFromRenderableToVisualIndex(n,r)))}},{key:"translateFromRenderableToVisualIndex",value:function(t,e){var n=t>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t,r=e>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===n&&(n=t),null===r&&(r=e),[n,r]}},{key:"countRenderableIndexes",value:function(t,e){var n=Math.min(t.getNotTrimmedIndexesLength(),e),r=t.getNearestNotHiddenIndex(n-1,-1);return null===r?0:t.getRenderableFromVisualIndex(r)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(t,e){return this.countNotHiddenIndexes(t,e,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(t,e){return this.countNotHiddenIndexes(t,e,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(t,e,n,r){if(isNaN(t)||t<0)return 0;var o=n.getNearestNotHiddenIndex(t,e),i=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(i))return 0;var a=0;return e<0?a=i+1:e>0&&(a=r-i),a}},{key:"countNotHiddenFixedColumnsStart",value:function(){var t=this.instance.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var t=this.instance.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var t=this.instance.countRows(),e=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>t&&this.instance.countRenderedCols()>e}},{key:"initializeWalkontable",value:function(){var t=this,e=Ov.get(this),n={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e.table,isDataViewInstance:function(){return Jy(t.instance)},preventOverflow:function(){return t.settings.preventOverflow},preventWheel:function(){return t.settings.preventWheel},stretchH:function(){return t.settings.stretchH},data:function(e,n){var r;return(r=t.instance).getDataAtCell.apply(r,ov(t.translateFromRenderableToVisualIndex(e,n)))},totalRows:function(){return t.countRenderableRows()},totalColumns:function(){return t.countRenderableColumns()},fixedColumnsStart:function(){return t.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return t.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return t.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return t.settings.fixedColumnsStart>0||n.rowHeaders().length>0},shouldRenderTopOverlay:function(){return t.settings.fixedRowsTop>0||n.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return t.settings.fixedRowsBottom>0},minSpareRows:function(){return t.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var e=[];return t.instance.hasRowHeaders()&&e.push((function(e,n){var r=e>=0?t.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e;t.appendRowHeader(r,n)})),t.instance.runHooks("afterGetRowHeaderRenderers",e),wv(t,Rv,e.length),e},columnHeaders:function(){var e=[];return t.instance.hasColHeaders()&&e.push((function(e,n){var r=e>=0?t.instance.columnIndexMapper.getVisualFromRenderableIndex(e):e;t.appendColHeader(r,n)})),t.instance.runHooks("afterGetColumnHeaderRenderers",e),wv(t,kv,e.length),e},columnWidth:function(e){var n=t.instance.columnIndexMapper.getVisualFromRenderableIndex(e);return t.instance.getColWidth(null===n?e:n)},rowHeight:function(e){var n=t.instance.rowIndexMapper.getVisualFromRenderableIndex(e);return t.instance.getRowHeight(null===n?e:n)},cellRenderer:function(e,n,r){var o=t.translateFromRenderableToVisualIndex(e,n),i=tv(o,2),a=i[0],l=i[1],s=t.instance.runHooks("modifyGetCellCoords",a,l),u=a,c=l;if(Array.isArray(s)){var f=tv(s,2);u=f[0],c=f[1]}var h=t.instance.getCellMeta(u,c),d=t.instance.colToProp(c),p=t.instance.getDataAtRowProp(u,d);t.instance.hasHook("beforeValueRender")&&(p=t.instance.runHooks("beforeValueRender",p,h)),t.instance.runHooks("beforeRenderer",r,a,l,d,p,h),t.instance.getCellRenderer(h)(t.instance,r,a,l,d,p,h),t.instance.runHooks("afterRenderer",r,a,l,d,p,h)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return t.settings.fragmentSelection},onWindowResize:function(){t.instance&&!t.instance.isDestroyed&&t.instance.refreshDimensions()},onContainerElementResize:function(){t.instance&&!t.instance.isDestroyed&&t.instance.refreshDimensions()},onCellMouseDown:function(n,r,o,i){var a=t.translateFromRenderableToVisualCoords(r),l={row:!1,column:!1,cell:!1};t.instance.listen(),t.activeWt=i,e.mouseDown=!0,t.instance.runHooks("beforeOnCellMouseDown",n,a,o,l),tr(n)||(Ky(n,{coords:a,selection:t.instance.selection,controller:l,cellCoordsFactory:function(e,n){return t.instance._createCellCoords(e,n)}}),t.instance.runHooks("afterOnCellMouseDown",n,a,o),t.activeWt=t._wt)},onCellContextMenu:function(n,r,o,i){var a=t.translateFromRenderableToVisualCoords(r);t.activeWt=i,e.mouseDown=!1,t.instance.selection.isInProgress()&&t.instance.selection.finish(),t.instance.runHooks("beforeOnCellContextMenu",n,a,o),tr(n)||(t.instance.runHooks("afterOnCellContextMenu",n,a,o),t.activeWt=t._wt)},onCellMouseOut:function(e,n,r,o){var i=t.translateFromRenderableToVisualCoords(n);t.activeWt=o,t.instance.runHooks("beforeOnCellMouseOut",e,i,r),tr(e)||(t.instance.runHooks("afterOnCellMouseOut",e,i,r),t.activeWt=t._wt)},onCellMouseOver:function(n,r,o,i){var a=t.translateFromRenderableToVisualCoords(r),l={row:!1,column:!1,cell:!1};t.activeWt=i,t.instance.runHooks("beforeOnCellMouseOver",n,a,o,l),tr(n)||(e.mouseDown&&Ky(n,{coords:a,selection:t.instance.selection,controller:l,cellCoordsFactory:function(e,n){return t.instance._createCellCoords(e,n)}}),t.instance.runHooks("afterOnCellMouseOver",n,a,o),t.activeWt=t._wt)},onCellMouseUp:function(e,n,r,o){var i=t.translateFromRenderableToVisualCoords(n);t.activeWt=o,t.instance.runHooks("beforeOnCellMouseUp",e,i,r),tr(e)||t.instance.isDestroyed||(t.instance.runHooks("afterOnCellMouseUp",e,i,r),t.activeWt=t._wt)},onCellCornerMouseDown:function(e){e.preventDefault(),t.instance.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:function(e){e.preventDefault(),t.instance.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:function(e,n){return t.beforeRender(e,n)},onDraw:function(e){return t.afterRender(e)},onScrollVertically:function(){return t.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return t.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return t.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(e,n,r){var o=t.instance.rowIndexMapper,i=o.getVisualFromRenderableIndex(e),a=t.instance.runHooks("beforeHighlightingRowHeader",i,n,r);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,1))},onBeforeHighlightingColumnHeader:function(e,n,r){var o=t.instance.columnIndexMapper,i=o.getVisualFromRenderableIndex(e),a=t.instance.runHooks("beforeHighlightingColumnHeader",i,n,r);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,1))},onAfterDrawSelection:function(e,n,r){var o,i=t.translateFromRenderableToVisualIndex(e,n),a=tv(i,2),l=a[0],s=a[1],u=t.instance.selection.getSelectedRange(),c=u.size();if(c>0){var f=(null!==r&&void 0!==r?r:0)+1-c,h=u.peekByIndex(f);o=[h.from.row,h.from.col,h.to.row,h.to.col]}return t.instance.runHooks("afterDrawSelection",l,s,o,r)},onBeforeDrawBorders:function(e,n){var r=tv(e,4),o=r[0],i=r[1],a=r[2],l=r[3],s=[t.instance.rowIndexMapper.getVisualFromRenderableIndex(o),t.instance.columnIndexMapper.getVisualFromRenderableIndex(i),t.instance.rowIndexMapper.getVisualFromRenderableIndex(a),t.instance.columnIndexMapper.getVisualFromRenderableIndex(l)];return t.instance.runHooks("beforeDrawBorders",s,n)},onBeforeTouchScroll:function(){return t.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return t.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(e,n){var r=t.instance.columnIndexMapper.getVisualFromRenderableIndex(n);return t.instance.runHooks("beforeStretchingColumnWidth",e,r)},onModifyRowHeaderWidth:function(e){return t.instance.runHooks("modifyRowHeaderWidth",e)},onModifyGetCellCoords:function(e,n,r){var o=t.instance.rowIndexMapper,i=t.instance.columnIndexMapper,a=n>=0?i.getVisualFromRenderableIndex(n):n,l=e>=0?o.getVisualFromRenderableIndex(e):e,s=t.instance.runHooks("modifyGetCellCoords",l,a,r);if(Array.isArray(s)){var u=tv(s,4),c=u[0],f=u[1],h=u[2],d=u[3];return[c>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,1)):c,f>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(f,1)):f,h>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1)):h,d>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(d,-1)):d]}},viewportRowCalculatorOverride:function(e){var n=t.settings.viewportRowRenderingOffset;if("auto"===n&&t.settings.fixedRowsTop&&(n=10),n>0||"auto"===n){var r=t.countRenderableRows(),o=e.startRow,i=e.endRow;if("number"===typeof n)e.startRow=Math.max(o-n,0),e.endRow=Math.min(i+n,r-1);else if("auto"===n){var a=Math.ceil(i/r*12);e.startRow=Math.max(o-a,0),e.endRow=Math.min(i+a,r-1)}}t.instance.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:function(e){var n=t.settings.viewportColumnRenderingOffset;if("auto"===n&&t.settings.fixedColumnsStart&&(n=10),n>0||"auto"===n){var r=t.countRenderableColumns(),o=e.startColumn,i=e.endColumn;if("number"===typeof n&&(e.startColumn=Math.max(o-n,0),e.endColumn=Math.min(i+n,r-1)),"auto"===n){var a=Math.ceil(i/r*6);e.startColumn=Math.max(o-a,0),e.endColumn=Math.min(i+a,r-1)}}t.instance.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:function(){return t.settings.rowHeaderWidth},columnHeaderHeight:function(){var e=t.instance.runHooks("modifyColumnHeaderHeight");return t.settings.columnHeaderHeight||e}};this.instance.runHooks("beforeInitWalkontable",n),this._wt=new Uy(n),this.activeWt=this._wt;var r=this._wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),i=o.width,a=o.height;this.setLastSize(i,a),this.eventManager.addEventListener(r,"mousedown",(function(t){t.target===r&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(r,"contextmenu",(function(t){t.target===r&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(function(){t.settings.observeDOMVisibility&&t._wt.drawInterrupted&&(t.instance.forceFullRender=!0,t.render())}))}},{key:"isTextSelectionAllowed",value:function(t){if(jn(t))return!0;var e=Le(t,this.instance.view._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}},{key:"isMouseDown",value:function(){return Ov.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var t,e;return null!==(t=null===(e=this.instance.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&void 0!==t&&t}},{key:"isCellEdited",value:function(){var t=this.instance.getActiveEditor();return t&&t.isOpened()}},{key:"beforeRender",value:function(t,e){t&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,e)}},{key:"afterRender",value:function(t){t&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(t,e){if(e.firstChild){var n=e.firstChild;if(!ze(n,"relative"))return Xe(e),void this.appendRowHeader(t,e);this.updateCellHeader(n.querySelector(".rowHeader"),t,this.instance.getRowHeader)}else{var r=this.instance,o=r.rootDocument,i=r.getRowHeader,a=o.createElement("div"),l=o.createElement("span");a.className="relative",l.className="rowHeader",this.updateCellHeader(l,t,i),a.appendChild(l),e.appendChild(a)}this.instance.runHooks("afterGetRowHeader",t,e)}},{key:"appendColHeader",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.instance.getColHeader,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e.firstChild){var o=e.firstChild;ze(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),t,n,r):(Xe(e),this.appendColHeader(t,e,n,r))}else{var i=this.instance.rootDocument,a=i.createElement("div"),l=i.createElement("span");a.className="relative",l.className="colHeader",this.updateCellHeader(l,t,n,r),a.appendChild(l),e.appendChild(a)}this.instance.runHooks("afterGetColHeader",t,e,r)}},{key:"updateCellHeader",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e,i=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&(ze(t,"colHeader")?o=i.wtTable.columnFilter.sourceToRendered(e):ze(t,"rowHeader")&&(o=i.wtTable.rowFilter.sourceToRendered(e))),o>-1?Qe(t,n(e,r)):(Je(t,String.fromCharCode(160)),Ge(t,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(t){var e=this._wt.wtViewport.getWorkspaceWidth(),n=e-t;return n>0?n:0}},{key:"maximumVisibleElementHeight",value:function(t){var e=this._wt.wtViewport.getWorkspaceHeight(),n=e-t;return n>0?n:0}},{key:"setLastSize",value:function(t,e){var n=Ov.get(this),r=[t,e];n.lastWidth=r[0],n.lastHeight=r[1]}},{key:"getLastSize",value:function(){var t=Ov.get(this);return{width:t.lastWidth,height:t.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return gv(this,kv)}},{key:"getRowHeadersCount",value:function(){return gv(this,Rv)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),t}(),Pv=Ev;function Tv(t){return Tv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tv(t)}var jv="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Av=jv.length;function Mv(t){var e,n=t+1,r="";while(n>0)e=(n-1)%Av,r=String.fromCharCode(65+e)+r,n=parseInt((n-e)/Av,10);return r}function Iv(t){var e=0;if(t)for(var n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=Math.pow(Av,r)*(jv.indexOf(t[n])+1);return e-=1,e}function xv(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(t=0;t<n;t++){var i=[];for(e=0;e<r;e++)i.push(Mv(e)+(t+1));o.push(i)}return o}function _v(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(t=0;t<n;t++){var i={};for(e=0;e<r;e++)i["prop".concat(e)]=Mv(e)+(t+1);o.push(i)}return o}function Hv(t,e){for(var n,r=[],o=0;o<t;o++){n=[];for(var i=0;i<e;i++)n.push("");r.push(n)}return r}function Nv(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t,r=[];return Array.isArray(t)&&Array.isArray(t[0])||(n=[t]),n.forEach((function(t,n){Array.isArray(t)?t.forEach((function(t,o){r.push([n+e,o,t])})):Object.keys(t).forEach((function(o){r.push([n+e,o,t[o]])}))})),r}function Dv(t){var e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&ht(t[0])&&(e=mt(t[0]))),e}function Lv(t){return!!(Array.isArray(t)&&t.length&&t.every((function(t){return Array.isArray(t)})))}function Bv(t){return!!(Array.isArray(t)&&t.length&&t.every((function(t){return"object"===Tv(t)&&!Array.isArray(t)&&null!==t})))}function Vv(t){return Vv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vv(t)}function Fv(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zv(r.key),r)}}function Uv(t,e,n){return e&&Wv(t.prototype,e),n&&Wv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function zv(t){var e=Gv(t,"string");return"symbol"===Vv(e)?e:String(e)}function Gv(t,e){if("object"!==Vv(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Vv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Yv=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Fv(this,t),this.hot=e,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return Uv(t,[{key:"modifyRowData",value:function(t){var e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}},{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}},{key:"setData",value:function(t){this.data=t}},{key:"getAtColumn",value:function(t){var e=this,n=[];return U(this.data,(function(r,o){var i=e.getAtCell(o,t);n.push(i)})),n}},{key:"getAtRow",value:function(t,e,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=void 0===e&&void 0===n,a=null,l=null;if(a=this.modifyRowData(t),Array.isArray(a))l=[],i?a.forEach((function(e,n){l[n]=r.getAtPhysicalCell(t,n,a)})):Io(e,n,(function(n){l[n-e]=r.getAtPhysicalCell(t,n,a)}));else if(ht(a)||_n(a))if(l=o?[]:{},!i||o){var s=0,u=this.countFirstRowKeys()-1;Io(s,u,(function(i){var c=r.colToProp(i);if(i>=(e||s)&&i<=(n||u)&&!Number.isInteger(c)){var f=r.getAtPhysicalCell(t,c,a);o?l.push(f):vt(l,c,f)}}))}else pt(a,(function(e,n){vt(l,n,r.getAtPhysicalCell(t,n,a))}));return l}},{key:"setAtCell",value:function(t,e,n){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var r=gt(n);this.hot.runHooks("modifySourceData",t,e,r,"set"),r.isTouched()&&(n=r.value)}Number.isInteger(e)?this.data[t][e]=n:vt(this.data[t],e,n)}}},{key:"getAtPhysicalCell",value:function(t,e,n){var r=null;if(n&&(r="string"===typeof e?yt(n,e):"function"===typeof e?e(n):n[e]),this.hot.hasHook("modifySourceData")){var o=gt(r);this.hot.runHooks("modifySourceData",t,e,o,"get"),o.isTouched()&&(r=o.value)}return r}},{key:"getAtCell",value:function(t,e){var n=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),n)}},{key:"getByRange",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,i=null,a=null,l=null,s=null;null===e||null===n?(o=!0,i=0,l=this.countRows()-1):(i=Math.min(e.row,n.row),a=Math.min(e.col,n.col),l=Math.max(e.row,n.row),s=Math.max(e.col,n.col));var u=[];return Io(i,l,(function(e){u.push(o?t.getAtRow(e,void 0,void 0,r):t.getAtRow(e,a,s,r))})),u}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}},{key:"countFirstRowKeys",value:function(){return Dv(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),t}(),Kv=Yv,Xv=(n(8529),n(2783),"localHooks"),$v={_localHooks:Object.create(null),addLocalHook:function(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks:function(t,e,n,r,o,i,a){if(this._localHooks[t])for(var l=this._localHooks[t].length,s=0;s<l;s++)Wn(this._localHooks[t][s],this,e,n,r,o,i,a)},clearLocalHooks:function(){return this._localHooks={},this}};dt($v,"MIXIN_NAME",Xv,{writable:!1,enumerable:!1});var qv=$v;function Qv(t){return Qv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qv(t)}function Jv(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,em(r.key),r)}}function tm(t,e,n){return e&&Zv(t.prototype,e),n&&Zv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function em(t){var e=nm(t,"string");return"symbol"===Qv(e)?e:String(e)}function nm(t,e){if("object"!==Qv(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Qv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var rm=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Jv(this,t),this.indexedValues=[],this.initValueOrFn=e}return tm(t,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(t){var e=this.indexedValues;if(t<e.length)return e[t]}},{key:"setValues",value:function(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,_n(this.initValueOrFn)?Io(e-1,(function(e){return t.indexedValues.push(t.initValueOrFn(e))})):Io(e-1,(function(){return t.indexedValues.push(t.initValueOrFn)})),this.runLocalHooks("change")}},{key:"init",value:function(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),t}();function om(t){return sm(t)||lm(t)||am(t)||im()}function im(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function am(t,e){if(t){if("string"===typeof t)return um(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?um(t,e):void 0}}function lm(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function sm(t){if(Array.isArray(t))return um(t)}function um(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function cm(t,e,n){return[].concat(om(t.slice(0,e)),om(n),om(t.slice(e)))}function fm(t,e){return F(t,(function(t){return!1===e.includes(t)}))}function hm(t,e){return W(t,(function(t){return t-e.filter((function(e){return e<t})).length}))}function dm(t,e){var n=e[0],r=e.length;return W(t,(function(t){return t>=n?t+r:t}))}function pm(t){return pm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pm(t)}function ym(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vm(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,gm(r.key),r)}}function mm(t,e,n){return e&&vm(t.prototype,e),n&&vm(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function gm(t){var e=bm(t,"string");return"symbol"===pm(e)?e:String(e)}function bm(t,e){if("object"!==pm(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==pm(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function wm(){return wm="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Sm(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},wm.apply(this,arguments)}function Sm(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Tm(t),null===t)break;return t}function Cm(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Om(t,e)}function Om(t,e){return Om=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Om(t,e)}function km(t){var e=Pm();return function(){var n,r=Tm(t);if(e){var o=Tm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Rm(this,n)}}function Rm(t,e){if(e&&("object"===pm(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Em(t)}function Em(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Pm(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Tm(t){return Tm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Tm(t)}ct(rm,qv);var jm=function(t){Cm(n,t);var e=km(n);function n(){return ym(this,n),e.call(this,(function(t){return t}))}return mm(n,[{key:"insert",value:function(t,e){var r=dm(this.indexedValues,e);this.indexedValues=cm(r,t,e),wm(Tm(n.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){var e=fm(this.indexedValues,t);this.indexedValues=hm(e,t),wm(Tm(n.prototype),"remove",this).call(this,t)}}]),n}(rm);function Am(t){return _m(t)||xm(t)||Im(t)||Mm()}function Mm(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Im(t,e){if(t){if("string"===typeof t)return Hm(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hm(t,e):void 0}}function xm(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _m(t){if(Array.isArray(t))return Hm(t)}function Hm(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Nm(t,e,n,r){var o=n.length?n[0]:void 0;return[].concat(Am(t.slice(0,o)),Am(n.map((function(t,e){return _n(r)?r(t,e):r}))),Am(void 0===o?[]:t.slice(o)))}function Dm(t,e){return F(t,(function(t,n){return!1===e.includes(n)}))}function Lm(t){return Lm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lm(t)}function Bm(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vm(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Wm(r.key),r)}}function Fm(t,e,n){return e&&Vm(t.prototype,e),n&&Vm(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Wm(t){var e=Um(t,"string");return"symbol"===Lm(e)?e:String(e)}function Um(t,e){if("object"!==Lm(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Lm(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function zm(){return zm="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Gm(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},zm.apply(this,arguments)}function Gm(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Jm(t),null===t)break;return t}function Ym(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Km(t,e)}function Km(t,e){return Km=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Km(t,e)}function Xm(t){var e=Qm();return function(){var n,r=Jm(t);if(e){var o=Jm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $m(this,n)}}function $m(t,e){if(e&&("object"===Lm(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return qm(t)}function qm(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qm(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Jm(t){return Jm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jm(t)}var Zm=function(t){Ym(n,t);var e=Xm(n);function n(){return Bm(this,n),e.apply(this,arguments)}return Fm(n,[{key:"insert",value:function(t,e){this.indexedValues=Nm(this.indexedValues,t,e,this.initValueOrFn),zm(Jm(n.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){this.indexedValues=Dm(this.indexedValues,t),zm(Jm(n.prototype),"remove",this).call(this,t)}}]),n}(rm);function tg(t){return tg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tg(t)}function eg(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ng(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,og(r.key),r)}}function rg(t,e,n){return e&&ng(t.prototype,e),n&&ng(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function og(t){var e=ig(t,"string");return"symbol"===tg(e)?e:String(e)}function ig(t,e){if("object"!==tg(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==tg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ag(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lg(t,e)}function lg(t,e){return lg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lg(t,e)}function sg(t){var e=fg();return function(){var n,r=hg(t);if(e){var o=hg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ug(this,n)}}function ug(t,e){if(e&&("object"===tg(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return cg(t)}function cg(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fg(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function hg(t){return hg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hg(t)}var dg=function(t){ag(n,t);var e=sg(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return eg(this,n),e.call(this,t)}return rg(n,[{key:"getHiddenIndexes",value:function(){return V(this.getValues(),(function(t,e,n){return e&&t.push(n),t}),[])}}]),n}(Zm);function pg(t){return pg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pg(t)}function yg(t){return bg(t)||gg(t)||mg(t)||vg()}function vg(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function mg(t,e){if(t){if("string"===typeof t)return wg(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wg(t,e):void 0}}function gg(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function bg(t){if(Array.isArray(t))return wg(t)}function wg(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Sg(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_g(r.key),r)}}function Og(t,e,n){return e&&Cg(t.prototype,e),n&&Cg(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function kg(){return kg="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Rg(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},kg.apply(this,arguments)}function Rg(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Ig(t),null===t)break;return t}function Eg(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pg(t,e)}function Pg(t,e){return Pg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Pg(t,e)}function Tg(t){var e=Mg();return function(){var n,r=Ig(t);if(e){var o=Ig(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jg(this,n)}}function jg(t,e){if(e&&("object"===pg(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ag(t)}function Ag(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Mg(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Ig(t){return Ig=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ig(t)}function xg(t,e,n){return e=_g(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _g(t){var e=Hg(t,"string");return"symbol"===pg(e)?e:String(e)}function Hg(t,e){if("object"!==pg(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==pg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Ng=function(t){Eg(n,t);var e=Tg(n);function n(){var t;Sg(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),xg(Ag(t),"orderOfIndexes",[]),t}return Og(n,[{key:"getValues",value:function(){var t=this;return this.orderOfIndexes.map((function(e){return t.indexedValues[e]}))}},{key:"setValues",value:function(t){this.orderOfIndexes=yg(Array(t.length).keys()),kg(Ig(n.prototype),"setValues",this).call(this,t)}},{key:"setValueAtIndex",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(n,0,t),this.runLocalHooks("change"),!0)}},{key:"clearValue",value:function(t){this.orderOfIndexes=fm(this.orderOfIndexes,[t]),_n(this.initValueOrFn)?kg(Ig(n.prototype),"setValueAtIndex",this).call(this,t,this.initValueOrFn(t)):kg(Ig(n.prototype),"setValueAtIndex",this).call(this,t,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,kg(Ig(n.prototype),"setDefaultValues",this).call(this,t)}},{key:"insert",value:function(t,e){this.indexedValues=Nm(this.indexedValues,t,e,this.initValueOrFn),this.orderOfIndexes=dm(this.orderOfIndexes,e),kg(Ig(n.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){this.indexedValues=Dm(this.indexedValues,t),this.orderOfIndexes=fm(this.orderOfIndexes,t),this.orderOfIndexes=hm(this.orderOfIndexes,t),kg(Ig(n.prototype),"remove",this).call(this,t)}},{key:"getEntries",value:function(){var t=this;return this.orderOfIndexes.map((function(e){return[e,t.getValueAtIndex(e)]}))}}]),n}(rm);function Dg(t){return Dg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dg(t)}function Lg(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Fg(r.key),r)}}function Vg(t,e,n){return e&&Bg(t.prototype,e),n&&Bg(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fg(t){var e=Wg(t,"string");return"symbol"===Dg(e)?e:String(e)}function Wg(t,e){if("object"!==Dg(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Dg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ug(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zg(t,e)}function zg(t,e){return zg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},zg(t,e)}function Gg(t){var e=Xg();return function(){var n,r=$g(t);if(e){var o=$g(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Yg(this,n)}}function Yg(t,e){if(e&&("object"===Dg(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Kg(t)}function Kg(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xg(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function $g(t){return $g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$g(t)}var qg=function(t){Ug(n,t);var e=Gg(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Lg(this,n),e.call(this,t)}return Vg(n,[{key:"getTrimmedIndexes",value:function(){return V(this.getValues(),(function(t,e,n){return e&&t.push(n),t}),[])}}]),n}(Zm),Qg=new Map([["hiding",dg],["index",rm],["linkedPhysicalIndexToValue",Ng],["physicalIndexToValue",Zm],["trimming",qg]]);function Jg(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Qg.has(t))throw new Error('The provided map type ("'.concat(t,'") does not exist.'));return new(Qg.get(t))(e)}function Zg(t){return Zg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zg(t)}function tb(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,rb(r.key),r)}}function nb(t,e,n){return e&&eb(t.prototype,e),n&&eb(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function rb(t){var e=ob(t,"string");return"symbol"===Zg(e)?e:String(e)}function ob(t,e){if("object"!==Zg(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Zg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ib=0,ab=function(){function t(){tb(this,t),this.collection=new Map}return nb(t,[{key:"register",value:function(t,e){var n=this;!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",(function(){return n.runLocalHooks("change",e)})),ib+=1)}},{key:"unregister",value:function(t){var e=this.collection.get(t);Zt(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),ib-=1)}},{key:"unregisterAll",value:function(){var t=this;this.collection.forEach((function(e,n){return t.unregister(n)})),this.collection.clear()}},{key:"get",value:function(t){return te(t)?Array.from(this.collection.values()):this.collection.get(t)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(t){this.collection.forEach((function(e){e.remove(t)}))}},{key:"insertToEvery",value:function(t,e){this.collection.forEach((function(n){n.insert(t,e)}))}},{key:"initEvery",value:function(t){this.collection.forEach((function(e){e.init(t)}))}}]),t}();function lb(){return ib}function sb(t){return sb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sb(t)}function ub(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,hb(r.key),r)}}function fb(t,e,n){return e&&cb(t.prototype,e),n&&cb(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function hb(t){var e=db(t,"string");return"symbol"===sb(e)?e:String(e)}function db(t,e){if("object"!==sb(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==sb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function pb(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yb(t,e)}function yb(t,e){return yb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},yb(t,e)}function vb(t){var e=bb();return function(){var n,r=wb(t);if(e){var o=wb(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mb(this,n)}}function mb(t,e){if(e&&("object"===sb(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return gb(t)}function gb(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bb(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function wb(t){return wb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wb(t)}ct(ab,qv);var Sb=function(t){pb(n,t);var e=vb(n);function n(t,r){var o;return ub(this,n),o=e.call(this),o.mergedValuesCache=[],o.aggregationFunction=t,o.fallbackValue=r,o}return fb(n,[{key:"getMergedValues",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.mergedValuesCache;if(0===this.getLength())return[];for(var e=W(this.get(),(function(t){return t.getValues()})),n=[],r=Zt(e[0])&&e[0].length||0,o=0;o<r;o+=1){for(var i=[],a=0;a<this.getLength();a+=1)i.push(e[a][o]);n.push(i)}return W(n,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(t,e){var n=this.getMergedValues(e)[t];return Zt(n)?n:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),n}(ab);function Cb(t){return Cb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cb(t)}function Ob(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Eb(r.key),r)}}function Rb(t,e,n){return e&&kb(t.prototype,e),n&&kb(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Eb(t){var e=Pb(t,"string");return"symbol"===Cb(e)?e:String(e)}function Pb(t,e){if("object"!==Cb(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Cb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Tb(t,e,n){jb(t,e),e.set(t,n)}function jb(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ab(t,e,n){var r=xb(t,e,"set");return Mb(t,r,n),n}function Mb(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ib(t,e){var n=xb(t,e,"get");return _b(t,n)}function xb(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function _b(t,e){return e.get?e.get.call(t):e.value}var Hb=new WeakMap,Nb=function(){function t(){Ob(this,t),Tb(this,Hb,{writable:!0,value:[]})}return Rb(t,[{key:"subscribe",value:function(t){return this.addLocalHook("change",t),this._write(Ib(this,Hb)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(t){return t.length>0&&this.runLocalHooks("change",t),this}},{key:"_writeInitialChanges",value:function(t){Ab(this,Hb,t)}}]),t}();function Db(t,e){for(var n=[],r=0,o=0;r<t.length&&o<e.length;r++,o++)t[r]!==e[o]&&n.push({op:"replace",index:o,oldValue:t[r],newValue:e[o]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;o<t.length;o++)n.push({op:"remove",index:o,oldValue:t[o],newValue:void 0});return n}function Lb(t){return Lb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lb(t)}function Bb(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Wb(r.key),r)}}function Fb(t,e,n){return e&&Vb(t.prototype,e),n&&Vb(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Wb(t){var e=Ub(t,"string");return"symbol"===Lb(e)?e:String(e)}function Ub(t,e){if("object"!==Lb(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Lb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function zb(t,e,n){Gb(t,e),e.set(t,n)}function Gb(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yb(t,e){var n=$b(t,e,"get");return Kb(t,n)}function Kb(t,e){return e.get?e.get.call(t):e.value}function Xb(t,e,n){var r=$b(t,e,"set");return qb(t,r,n),n}function $b(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function qb(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}ct(Nb,qv);var Qb,Jb=new WeakMap,Zb=new WeakMap,tw=new WeakMap,ew=new WeakMap,nw=new WeakMap,rw=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.initialIndexValue;Bb(this,t),zb(this,Jb,{writable:!0,value:new Set}),zb(this,Zb,{writable:!0,value:[]}),zb(this,tw,{writable:!0,value:[]}),zb(this,ew,{writable:!0,value:!1}),zb(this,nw,{writable:!0,value:!1}),Xb(this,nw,null!==n&&void 0!==n&&n)}return Fb(t,[{key:"createObserver",value:function(){var t=this,e=new Nb;return Yb(this,Jb).add(e),e.addLocalHook("unsubscribe",(function(){Yb(t,Jb).delete(e)})),e._writeInitialChanges(Db(Yb(this,Zb),Yb(this,tw))),e}},{key:"emit",value:function(t){var e=Yb(this,tw);Yb(this,ew)&&Yb(this,Zb).length===t.length||(0===t.length?t=new Array(e.length).fill(Yb(this,nw)):Xb(this,Zb,new Array(t.length).fill(Yb(this,nw))),Yb(this,ew)||(Xb(this,ew,!0),e=Yb(this,Zb)));var n=Db(e,t);Yb(this,Jb).forEach((function(t){return t._write(n)})),Xb(this,tw,t)}}]),t}();function ow(t){return ow="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ow(t)}function iw(t){return uw(t)||sw(t)||lw(t)||aw()}function aw(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function lw(t,e){if(t){if("string"===typeof t)return cw(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cw(t,e):void 0}}function sw(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function uw(t){if(Array.isArray(t))return cw(t)}function cw(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function fw(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function hw(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dw(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yw(r.key),r)}}function pw(t,e,n){return e&&dw(t.prototype,e),n&&dw(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function yw(t){var e=vw(t,"string");return"symbol"===ow(e)?e:String(e)}function vw(t,e){if("object"!==ow(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ow(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var mw,gw=new Set(["getFirstNotHiddenIndex"]),bw=function(){function t(){var e=this;hw(this,t),this.indexesSequence=new jm,this.trimmingMapsCollection=new Sb((function(t){return t.some((function(t){return!0===t}))}),!1),this.hidingMapsCollection=new Sb((function(t){return t.some((function(t){return!0===t}))}),!1),this.variousMapsCollection=new ab,this.hidingChangesObservable=new rw({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",(function(){e.indexesSequenceChanged=!0,e.updateCache(),e.runLocalHooks("indexesSequenceChange",e.indexesChangeSource),e.runLocalHooks("change",e.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(function(t){e.trimmedIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",t,e.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(function(t){e.hiddenIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",t,e.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(function(t){e.runLocalHooks("change",t,e.variousMapsCollection)}))}return pw(t,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(t){if("hiding"!==t)throw new Error('Unsupported index map type "'.concat(t,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(t,e,n){return this.registerMap(t,Jg(e,n))}},{key:"registerMap",value:function(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error('Map with name "'.concat(t,'" has been already registered.'));e instanceof qg?this.trimmingMapsCollection.register(t,e):e instanceof dg?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);var n=this.getNumberOfIndexes();return n>0&&e.init(n),e}},{key:"unregisterMap",value:function(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(t){var e=this.notTrimmedIndexesCache[t];return Zt(e)?e:null}},{key:"getPhysicalFromRenderableIndex",value:function(t){var e=this.renderablePhysicalIndexesCache[t];return Zt(e)?e:null}},{key:"getVisualFromPhysicalIndex",value:function(t){var e=this.fromPhysicalToVisualIndexesCache.get(t);return Zt(e)?e:null}},{key:"getVisualFromRenderableIndex",value:function(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}},{key:"getRenderableFromVisualIndex",value:function(t){var e=this.fromVisualToRenderableIndexesCache.get(t);return Zt(e)?e:null}},{key:"getFirstNotHiddenIndex",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t-e;gw.has("getFirstNotHiddenIndex")&&(gw.delete("getFirstNotHiddenIndex"),Un($t(Qb||(Qb=fw(['The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next \n                        major release. Please use "getNearestNotHiddenIndex" instead.'],['The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20\n                        major release. Please use "getNearestNotHiddenIndex" instead.'])))));var o=this.getPhysicalFromVisualIndex(t);return null===o?!0===n&&r!==t-e?this.getFirstNotHiddenIndex(r,-e,!1,r):null:!1===this.isHidden(o)?t:this.getFirstNotHiddenIndex(t+e,e,n,r)}},{key:"getNearestNotHiddenIndex",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getPhysicalFromVisualIndex(t);if(null===r)return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;var o=Array.from(this.fromVisualToRenderableIndexesCache.keys()),i=-1;return i=e>0?o.findIndex((function(e){return e>t})):o.reverse().findIndex((function(e){return e<t})),-1===i?n?this.getNearestNotHiddenIndex(t,-e,!1):null:o[i]}},{key:"initToLength",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=iw(new Array(t).keys()),this.notHiddenIndexesCache=iw(new Array(t).keys()),this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(t){var e=this.getNumberOfIndexes();if(t<e){var n=iw(Array(this.getNumberOfIndexes()-t).keys()).map((function(e){return e+t}));this.removeIndexes(n)}else this.insertIndexes(e,t-e)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(t){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(t),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}},{key:"getNotTrimmedIndexes",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e)return this.notTrimmedIndexesCache;var n=this.getIndexesSequence();return n.filter((function(e){return!1===t.isTrimmed(e)}))}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e)return this.notHiddenIndexesCache;var n=this.getIndexesSequence();return n.filter((function(e){return!1===t.isHidden(e)}))}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e)return this.renderablePhysicalIndexesCache;var n=this.getNotTrimmedIndexes();return n.filter((function(e){return!1===t.isHidden(e)}))}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(t,e){var n=this;"number"===typeof t&&(t=[t]);var r=W(t,(function(t){return n.getPhysicalFromVisualIndex(t)})),o=this.getNotTrimmedIndexesLength(),i=t.length,a=fm(this.getIndexesSequence(),r),l=o-i;if(e+i<o){var s=a.filter((function(t){return!1===n.isTrimmed(t)}))[e];l=a.indexOf(s)}this.indexesChangeSource="move",this.setIndexesSequence(cm(a,l,r)),this.indexesChangeSource=void 0}},{key:"isTrimmed",value:function(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}},{key:"isHidden",value:function(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}},{key:"insertIndexes",value:function(t,e){var n=this.getNotTrimmedIndexes()[t],r=Zt(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),i=W(new Array(e).fill(r),(function(t,e){return t+e}));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,i),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,i),this.hidingMapsCollection.insertToEvery(o,i),this.variousMapsCollection.insertToEvery(o,i),this.resumeOperations()}},{key:"removeIndexes",value:function(t){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}},{key:"updateCache",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var e=0;e<t;e+=1){var n=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(n,e)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var e=0;e<t;e+=1){var n=this.getPhysicalFromRenderableIndex(e),r=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(r,e)}}}]),t}();function ww(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Sw(t,e){return pt(e,(function(e,n){te(t[n])&&(t[n]=e)})),t}function Cw(t){var e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,n=e.exec(t);return n?"".concat(n[1].toLowerCase(),"-").concat(n[2].toUpperCase()):t}function Ow(t){Zt(t)&&zn($t(mw||(mw=ww(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],['Language with code "','" was not found. You should register particular language\\x20\n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'])),t))}function kw(t,e){var n=Array.isArray(t)&&Number.isInteger(e);return n?t[e]:t}ct(bw,qv);var Rw=Rr("phraseFormatters"),Ew=Rw.register,Pw=Rw.getValues;function Tw(t,e){Ew(t,e)}function jw(){return Pw()}Tw("pluralize",kw);var Aw,Mw="ContextMenu:items",Iw=Mw,xw="".concat(Iw,".noItems"),_w="".concat(Iw,".insertRowAbove"),Hw="".concat(Iw,".insertRowBelow"),Nw="".concat(Iw,".insertColumnOnTheLeft"),Dw="".concat(Iw,".insertColumnOnTheRight"),Lw="".concat(Iw,".removeRow"),Bw="".concat(Iw,".removeColumn"),Vw="".concat(Iw,".undo"),Fw="".concat(Iw,".redo"),Ww="".concat(Iw,".readOnly"),Uw="".concat(Iw,".clearColumn"),zw="".concat(Iw,".copy"),Gw="".concat(Iw,".copyWithHeaders"),Yw="".concat(Iw,".copyWithGroupHeaders"),Kw="".concat(Iw,".copyHeadersOnly"),Xw="".concat(Iw,".cut"),$w="".concat(Iw,".freezeColumn"),qw="".concat(Iw,".unfreezeColumn"),Qw="".concat(Iw,".mergeCells"),Jw="".concat(Iw,".unmergeCells"),Zw="".concat(Iw,".addComment"),tS="".concat(Iw,".editComment"),eS="".concat(Iw,".removeComment"),nS="".concat(Iw,".readOnlyComment"),rS="".concat(Iw,".align"),oS="".concat(Iw,".align.left"),iS="".concat(Iw,".align.center"),aS="".concat(Iw,".align.right"),lS="".concat(Iw,".align.justify"),sS="".concat(Iw,".align.top"),uS="".concat(Iw,".align.middle"),cS="".concat(Iw,".align.bottom"),fS="".concat(Iw,".borders"),hS="".concat(Iw,".borders.top"),dS="".concat(Iw,".borders.right"),pS="".concat(Iw,".borders.bottom"),yS="".concat(Iw,".borders.left"),vS="".concat(Iw,".borders.remove"),mS="".concat(Iw,".nestedHeaders.insertChildRow"),gS="".concat(Iw,".nestedHeaders.detachFromParent"),bS="".concat(Iw,".hideColumn"),wS="".concat(Iw,".showColumn"),SS="".concat(Iw,".hideRow"),CS="".concat(Iw,".showRow"),OS="Filters:",kS="".concat(OS,"conditions"),RS="".concat(kS,".none"),ES="".concat(kS,".isEmpty"),PS="".concat(kS,".isNotEmpty"),TS="".concat(kS,".isEqualTo"),jS="".concat(kS,".isNotEqualTo"),AS="".concat(kS,".beginsWith"),MS="".concat(kS,".endsWith"),IS="".concat(kS,".contains"),xS="".concat(kS,".doesNotContain"),_S="".concat(kS,".byValue"),HS="".concat(kS,".greaterThan"),NS="".concat(kS,".greaterThanOrEqualTo"),DS="".concat(kS,".lessThan"),LS="".concat(kS,".lessThanOrEqualTo"),BS="".concat(kS,".isBetween"),VS="".concat(kS,".isNotBetween"),FS="".concat(kS,".after"),WS="".concat(kS,".before"),US="".concat(kS,".today"),zS="".concat(kS,".tomorrow"),GS="".concat(kS,".yesterday"),YS="".concat(OS,"labels.filterByCondition"),KS="".concat(OS,"labels.filterByValue"),XS="".concat(OS,"labels.conjunction"),$S="".concat(OS,"labels.disjunction"),qS="".concat(OS,"values.blankCells"),QS="".concat(OS,"buttons.selectAll"),JS="".concat(OS,"buttons.clear"),ZS="".concat(OS,"buttons.ok"),tC="".concat(OS,"buttons.cancel"),eC="".concat(OS,"buttons.placeholder.search"),nC="".concat(OS,"buttons.placeholder.value"),rC="".concat(OS,"buttons.placeholder.secondValue");function oC(t){return oC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oC(t)}function iC(t,e,n){return e=aC(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aC(t){var e=lC(t,"string");return"symbol"===oC(e)?e:String(e)}function lC(t,e){if("object"!==oC(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==oC(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}
/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */var sC=(Aw={languageCode:"en-US"},iC(Aw,xw,"No available options"),iC(Aw,_w,"Insert row above"),iC(Aw,Hw,"Insert row below"),iC(Aw,Nw,"Insert column left"),iC(Aw,Dw,"Insert column right"),iC(Aw,Lw,["Remove row","Remove rows"]),iC(Aw,Bw,["Remove column","Remove columns"]),iC(Aw,Vw,"Undo"),iC(Aw,Fw,"Redo"),iC(Aw,Ww,"Read only"),iC(Aw,Uw,"Clear column"),iC(Aw,rS,"Alignment"),iC(Aw,oS,"Left"),iC(Aw,iS,"Center"),iC(Aw,aS,"Right"),iC(Aw,lS,"Justify"),iC(Aw,sS,"Top"),iC(Aw,uS,"Middle"),iC(Aw,cS,"Bottom"),iC(Aw,$w,"Freeze column"),iC(Aw,qw,"Unfreeze column"),iC(Aw,fS,"Borders"),iC(Aw,hS,"Top"),iC(Aw,dS,"Right"),iC(Aw,pS,"Bottom"),iC(Aw,yS,"Left"),iC(Aw,vS,"Remove border(s)"),iC(Aw,Zw,"Add comment"),iC(Aw,tS,"Edit comment"),iC(Aw,eS,"Delete comment"),iC(Aw,nS,"Read-only comment"),iC(Aw,Qw,"Merge cells"),iC(Aw,Jw,"Unmerge cells"),iC(Aw,zw,"Copy"),iC(Aw,Gw,["Copy with header","Copy with headers"]),iC(Aw,Yw,["Copy with group header","Copy with group headers"]),iC(Aw,Kw,["Copy header only","Copy headers only"]),iC(Aw,Xw,"Cut"),iC(Aw,mS,"Insert child row"),iC(Aw,gS,"Detach from parent"),iC(Aw,bS,["Hide column","Hide columns"]),iC(Aw,wS,["Show column","Show columns"]),iC(Aw,SS,["Hide row","Hide rows"]),iC(Aw,CS,["Show row","Show rows"]),iC(Aw,RS,"None"),iC(Aw,ES,"Is empty"),iC(Aw,PS,"Is not empty"),iC(Aw,TS,"Is equal to"),iC(Aw,jS,"Is not equal to"),iC(Aw,AS,"Begins with"),iC(Aw,MS,"Ends with"),iC(Aw,IS,"Contains"),iC(Aw,xS,"Does not contain"),iC(Aw,HS,"Greater than"),iC(Aw,NS,"Greater than or equal to"),iC(Aw,DS,"Less than"),iC(Aw,LS,"Less than or equal to"),iC(Aw,BS,"Is between"),iC(Aw,VS,"Is not between"),iC(Aw,FS,"After"),iC(Aw,WS,"Before"),iC(Aw,US,"Today"),iC(Aw,zS,"Tomorrow"),iC(Aw,GS,"Yesterday"),iC(Aw,qS,"Blank cells"),iC(Aw,YS,"Filter by condition"),iC(Aw,KS,"Filter by value"),iC(Aw,XS,"And"),iC(Aw,$S,"Or"),iC(Aw,QS,"Select all"),iC(Aw,JS,"Clear"),iC(Aw,ZS,"OK"),iC(Aw,tC,"Cancel"),iC(Aw,eC,"Search"),iC(Aw,nC,"Value"),iC(Aw,rC,"Second value"),Aw),uC=sC,cC=uC.languageCode,fC=Rr("languagesDictionaries"),hC=fC.register,dC=fC.getItem,pC=fC.hasItem,yC=fC.getValues;function vC(t,e){var n=t,r=e;return ht(t)&&(r=t,n=r.languageCode),mC(n,r),hC(n,st(r)),st(r)}function mC(t,e){t!==cC&&Sw(e,dC(cC))}function gC(t){return bC(t)?st(dC(t)):null}function bC(t){return pC(t)}function wC(){return yC()}function SC(t,e,n){var r=gC(t);if(null===r)return null;var o=r[e];if(te(o))return null;var i=CC(o,n);return Array.isArray(i)?i[0]:i}function CC(t,e){var n=t;return U(jw(),(function(r){n=r(t,e)})),n}function OC(t){var e=Cw(t);return bC(e)||(e=cC,Ow(t)),e}vC(uC);n(6268);var kC="active-header",RC="area",EC="cell",PC="fill",TC="header",jC="custom-selection";n(2538);function AC(t){return AC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AC(t)}function MC(t,e){return NC(t)||HC(t,e)||xC(t,e)||IC()}function IC(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xC(t,e){if(t){if("string"===typeof t)return _C(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_C(t,e):void 0}}function _C(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function HC(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function NC(t){if(Array.isArray(t))return t}function DC(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LC(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,VC(r.key),r)}}function BC(t,e,n){return e&&LC(t.prototype,e),n&&LC(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function VC(t){var e=FC(t,"string");return"symbol"===AC(e)?e:String(e)}function FC(t,e){if("object"!==AC(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==AC(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var WC=function(){function t(e,n){DC(this,t),n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}return BC(t,[{key:"registerListeners",value:function(){var t=this,e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",(function(){return t.onMouseDown()})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()}));for(var n=function(e){var n=t.main.childNodes[e];t.eventManager.addEventListener(n,"mouseenter",(function(n){return t.onMouseEnter(n,t.main.childNodes[e])}))},r=0,o=this.main.childNodes.length;r<o;r++)n(r)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(t,e){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){t.preventDefault(),Zn(t);var n=this,r=this.wot.rootDocument.body,o=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(r,"mousemove",a)}function i(t){return t.clientY<Math.floor(o.top)||(t.clientY>Math.ceil(o.top+o.height)||(t.clientX<Math.floor(o.left)||(t.clientX>Math.ceil(o.left+o.width)||void 0)))}function a(t){i(t)&&(n.eventManager.removeEventListener(r,"mousemove",a),e.style.display="block")}}},{key:"createBorders",value:function(t){var e=this.wot.rootDocument;this.main=e.createElement("div");var n=["top","start","bottom","end","corner"],r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(var o=0;o<5;o++){var i=n[o],a=e.createElement("div");a.className="wtBorder ".concat(this.settings.className||""),this.settings[i]&&this.settings[i].hide&&(a.className+=" hidden"),r=a.style,r.backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:t.border.color,r.height=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(t.border.width,"px"),r.width=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(t.border.width,"px"),this.main.appendChild(a)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ht()&&this.createMultipleSelectorHandles(),this.disappear();var l=this.wot.wtTable,s=l.bordersHolder;s||(s=e.createElement("div"),s.className="htBorders",l.bordersHolder=s,l.spreader.appendChild(s)),s.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var t=this,e=this.wot.rootDocument;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};var n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var o={position:"absolute",height:"".concat(r,"px"),width:"".concat(r,"px"),"border-radius":"".concat(parseInt(r/1.5,10),"px")};pt(o,(function(e,n){t.selectionHandles.styles.bottomHitArea[n]=e,t.selectionHandles.styles.topHitArea[n]=e}));var i={position:"absolute",height:"".concat(n,"px"),width:"".concat(n,"px"),"border-radius":"".concat(parseInt(n/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};pt(i,(function(e,n){t.selectionHandles.styles.bottom[n]=e,t.selectionHandles.styles.top[n]=e})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(t,e){var n=this.wot.selections.createOrGetArea();return!(!n.cellRange||t===n.cellRange.to.row&&e===n.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(t,e,n,r,o,i){var a=this.wot.wtSettings.getSetting("rtlMode"),l=a?"right":"left",s=this.selectionHandles.styles,u=s.top,c=s.topHitArea,f=s.bottom,h=s.bottomHitArea,d=parseInt(u.borderWidth,10),p=parseInt(u.width,10),y=parseInt(c.width,10),v=this.wot.wtTable.getWidth(),m=this.wot.wtTable.getHeight();u.top="".concat(parseInt(n-p-1,10),"px"),u[l]="".concat(parseInt(r-p-1,10),"px"),c.top="".concat(parseInt(n-y/4*3,10),"px"),c[l]="".concat(parseInt(r-y/4*3,10),"px");var g=Math.min(parseInt(r+o,10),v-p-2*d),b=Math.min(parseInt(r+o-y/4,10),v-y-2*d);f[l]="".concat(g,"px"),h[l]="".concat(b,"px");var w=Math.min(parseInt(n+i,10),m-p-2*d),S=Math.min(parseInt(n+i-y/4,10),m-y-2*d);f.top="".concat(w,"px"),h.top="".concat(S,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(t,e)?(f.display="none",h.display="none"):(f.display="block",h.display="block")):(u.display="none",f.display="none",c.display="none",h.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}},{key:"appear",value:function(t){if(!this.disabled){for(var e,n,r,o,i,a,l=this.wot,s=l.wtTable,u=l.rootDocument,c=l.rootWindow,f=s.getRenderedRowsCount(),h=0;h<f;h+=1){var d=s.rowFilter.renderedToSource(h);if(d>=t[0]&&d<=t[2]){e=d,i=t[0];break}}for(var p=f-1;p>=0;p-=1){var y=s.rowFilter.renderedToSource(p);if(y>=t[0]&&y<=t[2]){n=y;break}}for(var v=s.getRenderedColumnsCount(),m=0;m<v;m+=1){var g=s.columnFilter.renderedToSource(m);if(g>=t[1]&&g<=t[3]){r=g,a=t[1];break}}for(var b=v-1;b>=0;b-=1){var w=s.columnFilter.renderedToSource(b);if(w>=t[1]&&w<=t[3]){o=w;break}}if(void 0!==e&&void 0!==r){var S=s.getCell(this.wot.createCellCoords(e,r)),C=e!==n||r!==o,O=C?s.getCell(this.wot.createCellCoords(n,o)):S,k=tn(S),R=C?tn(O):k,E=tn(s.TABLE),P=fn(s.TABLE),T=k.top,j=k.left,A=this.wot.wtSettings.getSetting("rtlMode"),M=0,I=0;if(A){var x=fn(S),_=c.innerWidth-E.left-P;I=j+x-R.left,M=c.innerWidth-j-x-_-1}else I=R.left+fn(O)-j,M=j-E.left-1;if(this.isEntireColumnSelected(e,n)){var H=this.getDimensionsFromHeader("columns",r,o,i,E),N=null;if(H){var D=MC(H,3);N=D[0],M=D[1],I=D[2]}N&&(S=N)}var L=T-E.top-1,B=R.top+hn(O)-T;if(this.isEntireRowSelected(r,o)){var V=this.getDimensionsFromHeader("rows",e,n,a,E),F=null;if(V){var W=MC(V,3);F=W[0],L=W[1],B=W[2]}F&&(S=F)}var U=cn(S,c);parseInt(U.borderTopWidth,10)>0&&(L+=1,B=B>0?B-1:0),parseInt(U[A?"borderRightWidth":"borderLeftWidth"],10)>0&&(M+=1,I=I>0?I-1:0);var z=A?"right":"left";this.topStyle.top="".concat(L,"px"),this.topStyle[z]="".concat(M,"px"),this.topStyle.width="".concat(I,"px"),this.topStyle.display="block",this.startStyle.top="".concat(L,"px"),this.startStyle[z]="".concat(M,"px"),this.startStyle.height="".concat(B,"px"),this.startStyle.display="block";var G=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(L+B-G,"px"),this.bottomStyle[z]="".concat(M,"px"),this.bottomStyle.width="".concat(I,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(L,"px"),this.endStyle[z]="".concat(M+I-G,"px"),this.endStyle.height="".concat(B+1,"px"),this.endStyle.display="block";var Y=this.settings.border.cornerVisible;Y="function"===typeof Y?Y(this.settings.layerLevel):Y;var K=this.wot.getSetting("onModifyGetCellCoords",n,o),X=n,$=o;if(K&&Array.isArray(K)){var q=MC(K,4);X=q[2],$=q[3]}if(Ht()||!Y||this.isPartRange(X,$))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(L+B+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[z]="".concat(M+I+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var Q=ln(s.TABLE),J=Q===c;J&&(Q=u.documentElement);var Z=parseInt(this.cornerDefaultStyle.width,10)/2,tt=parseInt(this.cornerDefaultStyle.height,10)/2;if(o===this.wot.getSetting("totalColumns")-1){var et=J?O.getBoundingClientRect().left:O.offsetLeft,nt=!1,rt=0;A?(rt=et-parseInt(this.cornerDefaultStyle.width,10)/2,nt=rt<0):(rt=et+fn(O)+parseInt(this.cornerDefaultStyle.width,10)/2,nt=rt>=pn(Q)),nt&&(this.cornerStyle[z]="".concat(Math.floor(M+I+this.cornerCenterPointOffset-Z),"px"),this.cornerStyle[A?"borderLeftWidth":"borderRightWidth"]=0)}if(n===this.wot.getSetting("totalRows")-1){var ot=J?O.getBoundingClientRect().top:O.offsetTop,it=ot+hn(O)+parseInt(this.cornerDefaultStyle.height,10)/2,at=it>=dn(Q);at&&(this.cornerStyle.top="".concat(Math.floor(L+B+this.cornerCenterPointOffset-tt),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}Ht()&&this.updateMultipleSelectionHandlesPosition(n,o,L,M,I,B)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(t,e,n,r,o){var i=this.wot.wtTable,a=i.wtRootElement.parentNode,l=null,s=null,u=null,c=null,f=null,h=null,d=null,p=null;switch(t){case"rows":l=function(){return i.getRowHeader.apply(i,arguments)},s=function(){return hn.apply(void 0,arguments)},u="ht__selection--rows",h="top";break;case"columns":l=function(){return i.getColumnHeader.apply(i,arguments)},s=function(){return fn.apply(void 0,arguments)},u="ht__selection--columns",h="left";break;default:}if(a.classList.contains(u)){var y=this.wot.getSetting("columnHeaders").length;if(d=l(e,y-r),p=l(n,y-r),!d||!p)return!1;var v=tn(d),m=tn(p);return d&&p&&(c=v[h]-o[h]-1,f=m[h]+s(p)-v[h]),[d,c,f]}return!1}},{key:"changeBorderStyle",value:function(t,e){var n=this[t].style,r=e[t];!r||r.hide?Ge(this[t],"hidden"):(ze(this[t],"hidden")&&Ye(this[t],"hidden"),n.backgroundColor=r.color,"top"!==t&&"bottom"!==t||(n.height="".concat(r.width,"px")),"start"!==t&&"end"!==t||(n.width="".concat(r.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(t){var e={width:1,color:"#000"},n=this[t].style;n.backgroundColor=e.color,n.width="".concat(e.width,"px"),n.height="".concat(e.width,"px")}},{key:"toggleHiddenClass",value:function(t,e){this.changeBorderToDefaultStyle(t),e?Ge(this[t],"hidden"):Ye(this[t],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ht()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),t}(),UC=WC;function zC(t,e){return $C(t)||XC(t,e)||YC(t,e)||GC()}function GC(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function YC(t,e){if(t){if("string"===typeof t)return KC(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?KC(t,e):void 0}}function KC(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function XC(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function $C(t){if(Array.isArray(t))return t}function qC(t){return qC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qC(t)}function QC(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function JC(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,tO(r.key),r)}}function ZC(t,e,n){return e&&JC(t.prototype,e),n&&JC(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function tO(t){var e=eO(t,"string");return"symbol"===qC(e)?e:String(e)}function eO(t,e){if("object"!==qC(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==qC(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var nO=function(){function t(e,n){QC(this,t),this.settings=e,this.cellRange=n||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return ZC(t,[{key:"getBorder",value:function(t){return this.instanceBorders[t.guid]||(this.instanceBorders[t.guid]=new UC(t,this.settings)),this.instanceBorders[t.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}},{key:"replace",value:function(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}},{key:"addClassAtCoords",value:function(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=t.wtTable.getCell(this.settings.createCellCoords(e,n));if("object"===qC(i)){var a=r;o&&(a=this.classNameGenerator(i),this.classNames.includes(a)||this.classNames.push(a)),Ge(i,a)}return this}},{key:"linearClassNameGenerator",value:function(t,e){return function n(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===e||0===o)return t;var i=o>=0?o:e,a=t;i-=1;var l=0===i?t:"".concat(t,"-").concat(i);if(ze(r,l)){var s=i+1;a="".concat(t,"-").concat(s)}else a=n(r,i);return a}}},{key:"draw",value:function(t){if(this.isEmpty())this.settings.border&&this.getBorder(t).disappear();else{var e=t.wtTable.getRenderedRowsCount(),n=t.wtTable.getRenderedColumnsCount(),r=this.getCorners(),o=zC(r,4),i=o[0],a=o[1],l=o[2],s=o[3],u=this.settings,c=u.highlightHeaderClassName,f=u.highlightColumnClassName,h=u.highlightRowClassName,d=u.highlightOnlyClosestHeader,p=u.selectionType,y=void 0===p||["active-header","header"].includes(p);if(y&&null!==a&&null!==s)for(var v=0,m=0;m<n;m+=1){var g=t.wtTable.columnFilter.renderedToSource(m);if(g>=a&&g<=s){var b=t.wtTable.getColumnHeaders(g),w=b.length-1;d&&b.length>1&&(b=[b[w]]);for(var S=0;S<b.length;S+=1){var C=[],O=b[S];c&&C.push(c),f&&C.push(f),S=d?w:S;var k=t.getSetting("onBeforeHighlightingColumnHeader",g,S,{selectionType:p,columnCursor:v,selectionWidth:s-a+1,classNames:C});k!==g&&(O=t.wtTable.getColumnHeader(k,S)),Ge(O,C)}v+=1}}if(null!==i&&null!==l)for(var R=0,E=0;E<e;E+=1){var P=t.wtTable.rowFilter.renderedToSource(E);if(y&&P>=i&&P<=l){var T=t.wtTable.getRowHeaders(P),j=T.length-1;d&&T.length>1&&(T=[T[j]]);for(var A=0;A<T.length;A+=1){var M=[],I=T[A];c&&M.push(c),h&&M.push(h),A=d?j:A;var x=t.getSetting("onBeforeHighlightingRowHeader",P,A,{selectionType:p,rowCursor:R,selectionHeight:l-i+1,classNames:M});x!==P&&(I=t.wtTable.getRowHeader(x,A)),Ge(I,M)}R+=1}if(null!==a&&null!==s)for(var _=0;_<n;_+=1){var H=t.wtTable.columnFilter.renderedToSource(_);P>=i&&P<=l&&H>=a&&H<=s?this.settings.className&&this.addClassAtCoords(t,P,H,this.settings.className,this.settings.markIntersections):P>=i&&P<=l?h&&this.addClassAtCoords(t,P,H,h):H>=a&&H<=s&&f&&this.addClassAtCoords(t,P,H,f);var N=t.getSetting("onAfterDrawSelection",P,H,this.settings.layerLevel);"string"===typeof N&&this.addClassAtCoords(t,P,H,N)}}t.getSetting("onBeforeDrawBorders",r,this.settings.className),this.settings.border&&this.getBorder(t).appear(r)}}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach((function(t){return t.destroy()}))}}]),t}(),rO=nO;function oO(t){return oO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oO(t)}function iO(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aO(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,gO(r.key),r)}}function lO(t,e,n){return e&&aO(t.prototype,e),n&&aO(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function sO(){return sO="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=uO(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},sO.apply(this,arguments)}function uO(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=vO(t),null===t)break;return t}function cO(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fO(t,e)}function fO(t,e){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},fO(t,e)}function hO(t){var e=yO();return function(){var n,r=vO(t);if(e){var o=vO(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dO(this,n)}}function dO(t,e){if(e&&("object"===oO(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return pO(t)}function pO(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yO(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function vO(t){return vO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vO(t)}function mO(t,e,n){return e=gO(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gO(t){var e=bO(t,"string");return"symbol"===oO(e)?e:String(e)}function bO(t,e){if("object"!==oO(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==oO(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var wO=function(t){cO(n,t);var e=hO(n);function n(t,r){var o;return iO(this,n),o=e.call(this,t,null),mO(pO(o),"visualCellRange",null),o.visualCellRange=r||null,o.commit(),o}return lO(n,[{key:"add",value:function(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}},{key:"clear",value:function(){return this.visualCellRange=null,sO(vO(n.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(t){var e=t.from,n=t.to,r=this.getNearestNotHiddenCoords(e,1),o=this.getNearestNotHiddenCoords(n,-1);if(null===r||null===o)return null;if(r.row>o.row||r.col>o.col){var i="header"===this.settings.type||"active-header"===this.settings.type;if(!i)return null;r=e,o=n}return this.settings.createCellRange(r,r,o)}},{key:"getNearestNotHiddenCoords",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),t.row,e);if(null===r)return null;var o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),t.col,n);return null===o?null:this.settings.createCellCoords(r,o)}},{key:"getNearestNotHiddenIndex",value:function(t,e,n){if(e<0)return e;var r=t.getNearestNotHiddenIndex(e,n),o="header"===this.settings.type||"active-header"===this.settings.type;return o&&null===r?-1:r}},{key:"commit",value:function(){if(null===this.visualCellRange)return this;var t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===t?null:this.createRenderableCellRange(t.from,t.to),this}},{key:"syncWith",value:function(t){var e="N-S"===t.getVerticalDirection()?1:-1,n="W-E"===t.getHorizontalDirection()?1:-1,r=this.getNearestNotHiddenCoords(t.from.clone().normalize(),e,n);if(null!==r&&t.overlaps(r)){if(null===this.cellRange){var o=this.settings.visualToRenderableCoords(r);this.cellRange=this.settings.createCellRange(o)}return t.setHighlight(r),this}return t.setHighlight(t.from),this}},{key:"getCorners",value:function(){var t=this.cellRange,e=t.from,n=t.to,r=null===e.row||null===n.row,o=null===e.col||null===n.col,i=this.settings.createCellCoords(r?null:Math.min(e.row,n.row),o?null:Math.min(e.col,n.col)),a=this.settings.createCellCoords(r?null:Math.max(e.row,n.row),o?null:Math.max(e.col,n.col));return[i.row,i.col,a.row,a.col]}},{key:"getVisualCorners",value:function(){var t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}},{key:"createRenderableCellRange",value:function(t,e){var n=this.settings.visualToRenderableCoords(t),r=this.settings.visualToRenderableCoords(e);return this.settings.createCellRange(n,n,r)}}]),n}(rO),SO=wO;function CO(t){return CO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},CO(t)}var OO=["activeHeaderClassName"];function kO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function RO(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?kO(Object(n),!0).forEach((function(e){EO(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kO(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function EO(t,e,n){return e=PO(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PO(t){var e=TO(t,"string");return"symbol"===CO(e)?e:String(e)}function TO(t,e){if("object"!==CO(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==CO(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function jO(t,e){if(null==t)return{};var n,r,o=AO(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function AO(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function MO(t){var e=t.activeHeaderClassName,n=jO(t,OO),r=new SO(RO(RO({highlightHeaderClassName:e},n),{},{selectionType:kC}));return r}var IO=MO;function xO(t){return xO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xO(t)}var _O=["layerLevel","areaCornerVisible"];function HO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function NO(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?HO(Object(n),!0).forEach((function(e){DO(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):HO(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function DO(t,e,n){return e=LO(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LO(t){var e=BO(t,"string");return"symbol"===xO(e)?e:String(e)}function BO(t,e){if("object"!==xO(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==xO(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function VO(t,e){if(null==t)return{};var n,r,o=FO(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function FO(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function WO(t){var e=t.layerLevel,n=t.areaCornerVisible,r=VO(t,_O),o=new SO(NO(NO({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:n}},r),{},{selectionType:RC}));return o}var UO=WO;function zO(t){return zO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zO(t)}var GO=["cellCornerVisible"];function YO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function KO(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?YO(Object(n),!0).forEach((function(e){XO(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):YO(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function XO(t,e,n){return e=$O(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $O(t){var e=qO(t,"string");return"symbol"===zO(e)?e:String(e)}function qO(t,e){if("object"!==zO(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==zO(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function QO(t,e){if(null==t)return{};var n,r,o=JO(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function JO(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function ZO(t){var e=t.cellCornerVisible,n=QO(t,GO),r=new SO(KO(KO({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e}},n),{},{selectionType:EC}));return r}var tk=ZO;function ek(t){return ek="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ek(t)}var nk=["border","visualCellRange"];function rk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ok(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rk(Object(n),!0).forEach((function(e){ik(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rk(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ik(t,e,n){return e=ak(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ak(t){var e=lk(t,"string");return"symbol"===ek(e)?e:String(e)}function lk(t,e){if("object"!==ek(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ek(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function sk(t,e){if(null==t)return{};var n,r,o=uk(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function uk(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function ck(t){var e=t.border,n=t.visualCellRange,r=sk(t,nk),o=new SO(ok(ok(ok({},e),r),{},{selectionType:jC}),n);return o}var fk=ck;n(9988);function hk(t){return hk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hk(t)}function dk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function pk(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?dk(Object(n),!0).forEach((function(e){yk(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dk(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function yk(t,e,n){return e=vk(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vk(t){var e=mk(t,"string");return"symbol"===hk(e)?e:String(e)}function mk(t,e){if("object"!==hk(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==hk(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function gk(t){if(null==t)throw new TypeError("Cannot destructure "+t)}function bk(t){var e=Object.assign({},(gk(t),t)),n=new SO(pk(pk({className:"fill",border:{width:1,color:"#ff0000"}},e),{},{selectionType:PC}));return n}var wk=bk;function Sk(t){return Sk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sk(t)}var Ck=["headerClassName","rowClassName","columnClassName"];function Ok(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function kk(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ok(Object(n),!0).forEach((function(e){Rk(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ok(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Rk(t,e,n){return e=Ek(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ek(t){var e=Pk(t,"string");return"symbol"===Sk(e)?e:String(e)}function Pk(t,e){if("object"!==Sk(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Sk(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Tk(t,e){if(null==t)return{};var n,r,o=jk(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function jk(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function Ak(t){var e=t.headerClassName,n=t.rowClassName,r=t.columnClassName,o=Tk(t,Ck),i=new SO(kk(kk({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:n,highlightColumnClassName:r},o),{},{highlightOnlyClosestHeader:!0,selectionType:TC}));return i}var Mk=Ak;function Ik(t){return Ik="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ik(t)}function xk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xk(Object(n),!0).forEach((function(e){Hk(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xk(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Hk(t,e,n){return e=Nk(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nk(t){var e=Dk(t,"string");return"symbol"===Ik(e)?e:String(e)}function Dk(t,e){if("object"!==Ik(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ik(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Lk=Rr("highlight/types"),Bk=Lk.register,Vk=Lk.getItem;function Fk(t,e){return Vk(t)(_k({type:t},e))}function Wk(t){return Wk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wk(t)}function Uk(t){return Kk(t)||Yk(t)||Gk(t)||zk()}function zk(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Gk(t,e){if(t){if("string"===typeof t)return Xk(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xk(t,e):void 0}}function Yk(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Kk(t){if(Array.isArray(t))return Xk(t)}function Xk(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function qk(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$k(Object(n),!0).forEach((function(e){Qk(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Qk(t,e,n){return e=eR(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jk(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zk(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,eR(r.key),r)}}function tR(t,e,n){return e&&Zk(t.prototype,e),n&&Zk(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function eR(t){var e=nR(t,"string");return"symbol"===Wk(e)?e:String(e)}function nR(t,e){if("object"!==Wk(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Wk(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Bk(kC,IO),Bk(RC,UO),Bk(EC,tk),Bk(jC,fk),Bk(PC,wk),Bk(TC,Mk);var rR=function(t){function e(t){Jk(this,e),this.options=t,this.layerLevel=0,this.cell=Fk(EC,t),this.fill=Fk(PC,t),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return tR(e,[{key:"isEnabledFor",value:function(t,e){var n=t;t===EC&&(n="current");var r=this.options.disabledCellSelection(e.row,e.col);return"string"===typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(n)}},{key:"useLayerLevel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var t,e=this.layerLevel;return this.areas.has(e)?t=this.areas.get(e):(t=Fk(RC,qk({layerLevel:e},this.options)),this.areas.set(e,t)),t}},{key:"getAreas",value:function(){return Uk(this.areas.values())}},{key:"createOrGetHeader",value:function(){var t,e=this.layerLevel;return this.headers.has(e)?t=this.headers.get(e):(t=Fk(TC,qk({},this.options)),this.headers.set(e,t)),t}},{key:"getHeaders",value:function(){return Uk(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var t,e=this.layerLevel;return this.activeHeaders.has(e)?t=this.activeHeaders.get(e):(t=Fk(kC,qk({},this.options)),this.activeHeaders.set(e,t)),t}},{key:"getActiveHeaders",value:function(){return Uk(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Uk(this.customSelections.values())}},{key:"addCustomSelection",value:function(t){this.customSelections.push(Fk(jC,qk(qk({},this.options),t)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),U(this.areas.values(),(function(t){t.clear()})),U(this.headers.values(),(function(t){t.clear()})),U(this.activeHeaders.values(),(function(t){t.clear()}))}},{key:t,value:function(){return[this.cell,this.fill].concat(Uk(this.areas.values()),Uk(this.headers.values()),Uk(this.activeHeaders.values()),Uk(this.customSelections))[Symbol.iterator]()}}]),e}(Symbol.iterator),oR=rR;function iR(t){return iR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iR(t)}function aR(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lR(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,uR(r.key),r)}}function sR(t,e,n){return e&&lR(t.prototype,e),n&&lR(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function uR(t){var e=cR(t,"string");return"symbol"===iR(e)?e:String(e)}function cR(t,e){if("object"!==iR(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==iR(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var fR=function(t){function e(t){aR(this,e),this.ranges=[],this.createCellRange=t}return sR(e,[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}},{key:"add",value:function(t){return this.ranges.push(this.createCellRange(t)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(t){return this.ranges.some((function(e){return e.includes(t)}))}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.size()+e-1;return n>=0&&(t=this.ranges[n]),t}},{key:t,value:function(){return this.ranges[Symbol.iterator]()}}]),e}(Symbol.iterator),hR=fR;function dR(t){return dR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dR(t)}function pR(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yR(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mR(r.key),r)}}function vR(t,e,n){return e&&yR(t.prototype,e),n&&yR(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function mR(t){var e=gR(t,"string");return"symbol"===dR(e)?e:String(e)}function gR(t,e){if("object"!==dR(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==dR(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var bR=function(){function t(e,n){pR(this,t),this.range=e,this.options=n}return vR(t,[{key:"transformStart",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.options.createCellCoords(t,e),o=this.range.current().highlight,i=this.options.visualToRenderableCoords(o),a=i.row,l=i.col,s=o,u=0,c=0;if(this.runLocalHooks("beforeTransformStart",r),null!==a&&null!==l){var f=this.options.countRows(),h=this.options.countCols(),d=this.options.fixedRowsBottom(),p=this.options.minSpareRows(),y=this.options.minSpareCols(),v=this.options.autoWrapRow(),m=this.options.autoWrapCol();a+t>f-1?n&&p>0&&!(d&&a>=f-d-1)?(this.runLocalHooks("insertRowRequire",f),f=this.options.countRows()):m&&(r.row=1-f,r.col=l+r.col===h-1?1-h:1):m&&a+r.row<0&&l+r.col>=0&&(r.row=f-1,r.col=l+r.col===0?h-1:-1),l+r.col>h-1?n&&y>0?(this.runLocalHooks("insertColRequire",h),h=this.options.countCols()):v&&(r.row=a+r.row===f-1?1-f:1,r.col=1-h):v&&l+r.col<0&&a+r.row>=0&&(r.row=a+r.row===0?f-1:-1,r.col=h-1);var g=this.options.createCellCoords(a+r.row,l+r.col);u=0,c=0,g.row<0?(u=-1,g.row=0):g.row>0&&g.row>=f&&(u=1,g.row=f-1),g.col<0?(c=-1,g.col=0):g.col>0&&g.col>=h&&(c=1,g.col=h-1),s=this.options.renderableToVisualCoords(g)}return this.runLocalHooks("afterTransformStart",s,u,c),s}},{key:"transformEnd",value:function(t,e){var n=this.options.createCellCoords(t,e),r=this.range.current(),o=r.to,i=0,a=0;this.runLocalHooks("beforeTransformEnd",n);var l=this.options.visualToRenderableCoords(r.highlight),s=l.row,u=l.col;if(null!==s&&null!==u){var c=this.options.countRows(),f=this.options.countCols(),h=this.options.visualToRenderableCoords(r.to),d=h.row,p=h.col,y=this.options.createCellCoords(d+n.row,p+n.col);i=0,a=0,y.row<0?(i=-1,y.row=0):y.row>0&&y.row>=c&&(i=1,y.row=c-1),y.col<0?(a=-1,y.col=0):y.col>0&&y.col>=f&&(a=1,y.col=f-1),o=this.options.renderableToVisualCoords(y)}return this.runLocalHooks("afterTransformEnd",o,i,a),o}}]),t}();ct(bR,qv);var wR=bR;function SR(t,e){return ER(t)||RR(t,e)||OR(t,e)||CR()}function CR(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function OR(t,e){if(t){if("string"===typeof t)return kR(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kR(t,e):void 0}}function kR(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function RR(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ER(t){if(Array.isArray(t))return t}function PR(t){return PR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},PR(t)}var TR,jR=0,AR=1,MR=2,IR=3,xR=[IR,MR],_R=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],HR=Symbol("root"),NR=Symbol("child");function DR(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:HR;if(e!==HR&&e!==NR)throw new Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(t),r=e===HR,o=jR;if(n){var i=t[0];if(0===t.length)o=AR;else if(r&&i instanceof qc)o=IR;else if(r&&Array.isArray(i))o=DR(i,NR);else if(t.length>=2&&t.length<=4){var a=!t.some((function(t,e){return!_R[e].includes(PR(t))}));a&&(o=MR)}}return o}function LR(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.keepDirection,r=void 0!==n&&n,o=e.propToCol;if(!xR.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(e){var n=t===IR,i=n?e.from.row:e[0],a=n?e.from.col:e[1],l=n?e.to.row:e[2],s=n?e.to.col:e[3];if("function"===typeof o&&("string"===typeof a&&(a=o(a)),"string"===typeof s&&(s=o(s))),te(l)&&(l=i),te(s)&&(s=a),!r){var u=i,c=a,f=l,h=s;i=Math.min(u,f),a=Math.min(c,h),l=Math.max(u,f),s=Math.max(c,h)}return[i,a,l,s]}}function BR(t){var e=DR(t);if(e===jR||e===AR)return[];var n=LR(e),r=new Set;U(t,(function(t){var e=n(t),o=SR(e,4),i=o[1],a=o[3],l=Math.max(i,0),s=a-l+1;U(Array.from(new Array(s),(function(t,e){return l+e})),(function(t){r.has(t)||r.add(t)}))}));var o=Array.from(r).sort((function(t,e){return t-e})),i=V(o,(function(t,e,n,r){return 0!==n&&e===r[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t}),[]);return i}function VR(t){var e=DR(t);if(e===jR||e===AR)return[];var n=LR(e),r=new Set;U(t,(function(t){var e=n(t),o=SR(e,3),i=o[0],a=o[2],l=Math.max(i,0),s=a-l+1;U(Array.from(new Array(s),(function(t,e){return l+e})),(function(t){r.has(t)||r.add(t)}))}));var o=Array.from(r).sort((function(t,e){return t-e})),i=V(o,(function(t,e,n,r){return 0!==n&&e===r[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t}),[]);return i}function FR(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return"number"===typeof t&&t>=0&&t<e}function WR(t){return WR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},WR(t)}function UR(t,e){return XR(t)||KR(t,e)||GR(t,e)||zR()}function zR(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function GR(t,e){if(t){if("string"===typeof t)return YR(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?YR(t,e):void 0}}function YR(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function KR(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function XR(t){if(Array.isArray(t))return t}function $R(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function qR(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QR(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ZR(r.key),r)}}function JR(t,e,n){return e&&QR(t.prototype,e),n&&QR(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZR(t){var e=tE(t,"string");return"symbol"===WR(e)?e:String(e)}function tE(t,e){if("object"!==WR(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==WR(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var eE=function(){function t(e,n){var r=this;qR(this,t),this.settings=e,this.tableProps=n,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new hR((function(t,e,n){return r.tableProps.createCellRange(t,e,n)})),this.highlight=new oR({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:function(t,e){return r.tableProps.isDisabledCellSelection(t,e)},cellCornerVisible:function(){return r.isCellCornerVisible.apply(r,arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible.apply(r,arguments)},visualToRenderableCoords:function(t){return r.tableProps.visualToRenderableCoords(t)},renderableToVisualCoords:function(t){return r.tableProps.renderableToVisualCoords(t)},createCellCoords:function(t,e){return r.tableProps.createCellCoords(t,e)},createCellRange:function(t,e,n){return r.tableProps.createCellRange(t,e,n)},rowIndexMapper:function(){return r.tableProps.rowIndexMapper()},columnIndexMapper:function(){return r.tableProps.columnIndexMapper()}}),this.transformation=new wR(this.selectedRange,{countRows:function(){return r.tableProps.countRowsTranslated()},countCols:function(){return r.tableProps.countColsTranslated()},visualToRenderableCoords:function(t){return r.tableProps.visualToRenderableCoords(t)},renderableToVisualCoords:function(t){return r.tableProps.renderableToVisualCoords(t)},createCellCoords:function(t,e){return r.tableProps.createCellCoords(t,e)},fixedRowsBottom:function(){return e.fixedRowsBottom},minSpareRows:function(){return e.minSpareRows},minSpareCols:function(){return e.minSpareCols},autoWrapRow:function(){return e.autoWrapRow},autoWrapCol:function(){return e.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformStart"].concat(e))})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformStart"].concat(e))})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformEnd"].concat(e))})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformEnd"].concat(e))})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["insertRowRequire"].concat(e))})),this.transformation.addLocalHook("insertColRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["insertColRequire"].concat(e))}))}return JR(t,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="multiple"===this.settings.selectionMode,o=te(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,i=t.row<0,a=t.col<0,l=i&&a,s=t.clone();this.selectedByCorner=l,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),s),(!r||r&&!o&&te(e))&&this.selectedRange.clear(),this.selectedRange.add(s),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!l&&a&&this.selectedByRowHeader.add(this.getLayerLevel()),!l&&i&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(t)}},{key:"setRangeStartOnly",value:function(t,e){this.setRangeStart(t,e,!0)}},{key:"setRangeEnd",value:function(t){if(!this.selectedRange.isEmpty()){var e=t.clone();this.runLocalHooks("beforeSetRangeEnd",e),this.begin();var n=this.selectedRange.current();"single"!==this.settings.selectionMode&&n.setTo(this.tableProps.createCellCoords(e.row,e.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(EC,n.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(n);var r=this.getLayerLevel();r<this.highlight.layerLevel&&(U(this.highlight.getAreas(),(function(t){t.clear()})),U(this.highlight.getHeaders(),(function(t){t.clear()})),U(this.highlight.getActiveHeaders(),(function(t){t.clear()}))),this.highlight.useLayerLevel(r);var o=this.highlight.createOrGetArea(),i=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();if(o.clear(),i.clear(),a.clear(),this.highlight.isEnabledFor(RC,n.highlight)&&(this.isMultiple()||r>=1)&&(o.add(n.from).add(n.to).commit(),1===r)){var l=this.selectedRange.previous();this.highlight.useLayerLevel(r-1).createOrGetArea().add(l.from).commit().syncWith(l),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(TC,n.highlight)){var s=0===this.tableProps.countRowsTranslated(),u=0===this.tableProps.countColsTranslated(),c=n;if((s||u)&&(c=n.clone()),s&&(c.from.row=-1),u&&(c.from.col=-1),"single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&c.from.normalize(),i.add(c.from).commit()):i.add(c.from).add(c.to).commit(),this.isEntireRowSelected()){var f=this.tableProps.countCols()===n.getWidth();f&&a.add(this.tableProps.createCellCoords(n.from.row,-1)).add(this.tableProps.createCellCoords(n.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var h=this.tableProps.countRows()===n.getHeight();h&&a.add(this.tableProps.createCellCoords(-1,n.from.col)).add(this.tableProps.createCellCoords(-1,n.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",t)}}},{key:"isMultiple",value:function(){var t=gt(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}},{key:"transformStart",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(t,e,n))}},{key:"transformEnd",value:function(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&this.isEntireRowSelected(t)}},{key:"isEntireRowSelected",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t)}},{key:"isSelectedByColumnHeader",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(t)}},{key:"isEntireColumnSelected",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(t){return this.selectedRange.includes(t)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.tableProps.countRows(),r=this.tableProps.countCols();if(t||e||0!==n&&0!==r){var o=this.tableProps.createCellCoords(e?-1:0,t?-1:0),i=this.tableProps.createCellCoords(n-1,r-1);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(i),this.finish()}}},{key:"selectCells",value:function(t){var e=this,n=DR(t);if(n===AR)return!1;if(n===jR)throw new Error($t(TR||(TR=$R(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, \n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."],["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20\n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."]))));var r=LR(n,{propToCol:function(t){return e.tableProps.propToCol(t)},keepDirection:!0}),o=this.tableProps.countRows(),i=this.tableProps.countCols(),a=!t.some((function(t){var e=r(t),n=UR(e,4),a=n[0],l=n[1],s=n[2],u=n[3],c=FR(a,o)&&FR(l,i)&&FR(s,o)&&FR(u,i);return!c}));return a&&(this.clear(),U(t,(function(t){var n=r(t),o=UR(n,4),i=o[0],a=o[1],l=o[2],s=o[3];e.setRangeStartOnly(e.tableProps.createCellCoords(i,a),!1),e.setRangeEnd(e.tableProps.createCellCoords(l,s)),e.finish()}))),a}},{key:"selectColumns",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r="string"===typeof t?this.tableProps.propToCol(t):t,o="string"===typeof e?this.tableProps.propToCol(e):e,i=this.tableProps.countCols(),a=this.tableProps.countRows(),l=FR(r,i)&&FR(o,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(n,r)),this.setRangeEnd(this.tableProps.createCellCoords(a-1,o)),this.finish()),l}},{key:"selectRows",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this.tableProps.countRows(),o=this.tableProps.countCols(),i=FR(t,r)&&FR(e,r);return i&&(this.setRangeStartOnly(this.tableProps.createCellCoords(t,n)),this.setRangeEnd(this.tableProps.createCellCoords(e,o-1)),this.finish()),i}},{key:"refresh",value:function(){var t=this.highlight.getCustomSelections();if(t.forEach((function(t){t.commit()})),this.isSelected()){var e=this.highlight.getCell(),n=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(var r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);var o=this.highlight.createOrGetArea(),i=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();o.commit(),i.commit(),a.commit()}this.highlight.useLayerLevel(n)}}}]),t}();ct(eE,qv);var nE=eE,rE=Rr("cellTypes"),oE=rE.register,iE=rE.getItem,aE=rE.hasItem,lE=rE.getNames;rE.getValues;function sE(t){if(!aE(t))throw Error('You declared cell type "'.concat(t,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method'));return iE(t)}function uE(t,e){"string"!==typeof t&&(e=t,t=e.CELL_TYPE);var n=e,r=n.editor,o=n.renderer,i=n.validator;r&&Hr(t,r),o&&Gi(t,o),i&&Ji(t,i),oE(t,e)}function cE(t,e){var n;return"CELL_TYPE"!==t&&((null===(n=e._automaticallyAssignedMetaProps)||void 0===n?void 0:n.has(t))||!bt(e,t))}function fE(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r="string"===typeof e.type?sE(e.type):e.type;if(t._automaticallyAssignedMetaProps&&pt(e,(function(e,n){t._automaticallyAssignedMetaProps.delete(n)})),ht(r)){n!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);var o={};pt(r,(function(e,r){var i;cE(r,n)&&(o[r]=e,null===(i=t._automaticallyAssignedMetaProps)||void 0===i||i.add(r))})),at(t,o)}}function hE(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}it(n,t);for(var r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function dE(t){return Number.isInteger(t)&&t>=0}function pE(t,e){if(!t())throw new Error("Assertion failed: ".concat(e))}function yE(t){return null===t||void 0===t}function vE(t){return vE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vE(t)}var mE=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),!1===ee(r))return!1;return!0},isEmptyRow:function(t){var e,n,r,o;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),!1===ee(r))return"object"===vE(r)&&(o=this.getCellMeta(t,e),ft(this.getSchema()[o.prop],r));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function gE(t){return gE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gE(t)}function bE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function wE(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bE(Object(n),!0).forEach((function(e){SE(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bE(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function SE(t,e,n){return e=kE(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kE(r.key),r)}}function OE(t,e,n){return e&&CE(t.prototype,e),n&&CE(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function kE(t){var e=RE(t,"string");return"symbol"===gE(e)?e:String(e)}function RE(t,e){if("object"!==gE(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==gE(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function EE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PE(){return OE((function t(){EE(this,t)}))}var TE=function(){function t(e){EE(this,t),this.metaCtor=PE(),this.meta=this.metaCtor.prototype,at(this.meta,mE()),this.meta.instance=e}return OE(t,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(t){var e;at(this.meta,t),fE(this.meta,wE(wE({},t),{},{type:null!==(e=t.type)&&void 0!==e?e:this.meta.type}),t)}}]),t}();function jE(t){return jE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jE(t)}function AE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ME(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,xE(r.key),r)}}function IE(t,e,n){return e&&ME(t.prototype,e),n&&ME(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function xE(t){var e=_E(t,"string");return"symbol"===jE(e)?e:String(e)}function _E(t,e){if("object"!==jE(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==jE(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var HE=function(){function t(e){AE(this,t);var n=e.getMetaConstructor();this.meta=new n}return IE(t,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(t){at(this.meta,t),fE(this.meta,t,t)}}]),t}();function NE(t){return NE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NE(t)}function DE(t){return FE(t)||VE(t)||BE(t)||LE()}function LE(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function BE(t,e){if(t){if("string"===typeof t)return WE(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?WE(t,e):void 0}}function VE(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function FE(t){if(Array.isArray(t))return WE(t)}function WE(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function UE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,YE(r.key),r)}}function GE(t,e,n){return e&&zE(t.prototype,e),n&&zE(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function YE(t){var e=KE(t,"string");return"symbol"===NE(e)?e:String(e)}function KE(t,e){if("object"!==NE(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==NE(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var XE=function(t){function e(t){UE(this,e),this.valueFactory=t,this.data=[],this.index=[],this.holes=new Set}return GE(e,[{key:"obtain",value:function(t){pE((function(){return dE(t)}),"Expecting an unsigned number.");var e,n=this._getStorageIndexByKey(t);if(n>=0)e=this.data[n],void 0===e&&(e=this.valueFactory(t),this.data[n]=e);else if(e=this.valueFactory(t),this.holes.size>0){var r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=e,this.index[t]=r}else this.data.push(e),this.index[t]=this.data.length-1;return e}},{key:"insert",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;pE((function(){return dE(t)||yE(t)}),"Expecting an unsigned number or null/undefined argument.");for(var n=[],r=this.data.length,o=0;o<e;o++)n.push(r+o),this.data.push(void 0);var i=yE(t)?this.index.length:t;this.index=[].concat(DE(this.index.slice(0,i)),n,DE(this.index.slice(i)))}},{key:"remove",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;pE((function(){return dE(t)||yE(t)}),"Expecting an unsigned number or null/undefined argument.");for(var n=this.index.splice(yE(t)?this.index.length-e:t,e),r=0;r<n.length;r++){var o=n[r];"number"===typeof o&&this.holes.add(o)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var t=this;return F(this.data,(function(e,n){return!t.holes.has(n)}))[Symbol.iterator]()}},{key:"entries",value:function(){for(var t=[],e=0;e<this.data.length;e++){var n=this._getKeyByStorageIndex(e);-1!==n&&t.push([n,this.data[e]])}var r=0;return{next:function(){if(r<t.length){var e=t[r];return r+=1,{value:e,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(t){return this.index.length>t?this.index[t]:-1}},{key:"_getKeyByStorageIndex",value:function(t){return this.index.indexOf(t)}},{key:t,value:function(){return this.entries()}}]),e}(Symbol.iterator);function $E(t){return $E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$E(t)}function qE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ZE(r.key),r)}}function JE(t,e,n){return e&&QE(t.prototype,e),n&&QE(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZE(t){var e=tP(t,"string");return"symbol"===$E(e)?e:String(e)}function tP(t,e){if("object"!==$E(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==$E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var eP=["data","width"],nP=function(){function t(e){var n=this;qE(this,t),this.globalMeta=e,this.metas=new XE((function(){return n._createMeta()}))}return JE(t,[{key:"updateMeta",value:function(t,e){var n=this.getMeta(t);at(n,e),fE(n,e)}},{key:"createColumn",value:function(t,e){this.metas.insert(t,e)}},{key:"removeColumn",value:function(t,e){this.metas.remove(t,e)}},{key:"getMeta",value:function(t){return this.metas.obtain(t)}},{key:"getMetaConstructor",value:function(t){return this.metas.obtain(t).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return hE(this.globalMeta.getMetaConstructor(),eP).prototype}}]),t}();function rP(t){return rP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rP(t)}function oP(t){return sP(t)||lP(t)||aP(t)||iP()}function iP(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function aP(t,e){if(t){if("string"===typeof t)return uP(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uP(t,e):void 0}}function lP(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function sP(t){if(Array.isArray(t))return uP(t)}function uP(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function cP(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dP(r.key),r)}}function hP(t,e,n){return e&&fP(t.prototype,e),n&&fP(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function dP(t){var e=pP(t,"string");return"symbol"===rP(e)?e:String(e)}function pP(t,e){if("object"!==rP(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==rP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var yP=function(){function t(e){var n=this;cP(this,t),this.columnMeta=e,this.metas=new XE((function(){return n._createRow()}))}return hP(t,[{key:"updateMeta",value:function(t,e,n){var r=this.getMeta(t,e);at(r,n),fE(r,n)}},{key:"createRow",value:function(t,e){this.metas.insert(t,e)}},{key:"createColumn",value:function(t,e){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(t,e)}},{key:"removeRow",value:function(t,e){this.metas.remove(t,e)}},{key:"removeColumn",value:function(t,e){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(t,e)}},{key:"getMeta",value:function(t,e,n){var r=this.metas.obtain(t).obtain(e);return void 0===n?r:r[n]}},{key:"setMeta",value:function(t,e,n,r){var o,i=this.metas.obtain(t).obtain(e);null===(o=i._automaticallyAssignedMetaProps)||void 0===o||o.delete(n),i[n]=r}},{key:"removeMeta",value:function(t,e,n){var r=this.metas.obtain(t).obtain(e);delete r[n]}},{key:"getMetas",value:function(){for(var t=[],e=Array.from(this.metas.values()),n=0;n<e.length;n++)t.push.apply(t,oP(e[n].values()));return t}},{key:"getMetasAtRow",value:function(t){pE((function(){return dE(t)}),"Expecting an unsigned number.");var e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var t=this;return new XE((function(e){return t._createMeta(e)}))}},{key:"_createMeta",value:function(t){var e=this.columnMeta.getMetaConstructor(t);return new e}}]),t}();function vP(t){return vP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vP(t)}function mP(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wP(r.key),r)}}function bP(t,e,n){return e&&gP(t.prototype,e),n&&gP(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function wP(t){var e=SP(t,"string");return"symbol"===vP(e)?e:String(e)}function SP(t,e){if("object"!==vP(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==vP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var CP=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];mP(this,t),this.hot=e,this.globalMeta=new TE(e),this.tableMeta=new HE(this.globalMeta),this.columnMeta=new nP(this.globalMeta),this.cellMeta=new yP(this.columnMeta),o.forEach((function(t){return new t(n)})),this.globalMeta.updateMeta(r)}return bP(t,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(t){this.globalMeta.updateMeta(t)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(t){this.tableMeta.updateMeta(t)}},{key:"getColumnMeta",value:function(t){return this.columnMeta.getMeta(t)}},{key:"updateColumnMeta",value:function(t,e){this.columnMeta.updateMeta(t,e)}},{key:"getCellMeta",value:function(t,e,n){var r=n.visualRow,o=n.visualColumn,i=this.cellMeta.getMeta(t,e);return i.visualRow=r,i.visualCol=o,i.row=t,i.col=e,this.runLocalHooks("afterGetCellMeta",i),i}},{key:"getCellMetaKeyValue",value:function(t,e,n){if("string"!==typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,n)}},{key:"setCellMeta",value:function(t,e,n,r){this.cellMeta.setMeta(t,e,n,r)}},{key:"updateCellMeta",value:function(t,e,n){this.cellMeta.updateMeta(t,e,n)}},{key:"removeCellMeta",value:function(t,e,n){this.cellMeta.removeMeta(t,e,n)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(t){return this.cellMeta.getMetasAtRow(t)}},{key:"createRow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}},{key:"removeRow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}},{key:"createColumn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}},{key:"removeColumn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),t}();function OP(t){return OP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OP(t)}function kP(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function RP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,PP(r.key),r)}}function EP(t,e,n){return e&&RP(t.prototype,e),n&&RP(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function PP(t){var e=TP(t,"string");return"symbol"===OP(e)?e:String(e)}function TP(t,e){if("object"!==OP(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==OP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}ct(CP,qv);var jP=function(){function t(e){var n=this;kP(this,t),this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",(function(t){return n.extendCellMeta(t)})),mr.getSingleton().add("beforeRender",(function(t){t&&n.metaSyncMemo.clear()}),this.metaManager.hot)}return EP(t,[{key:"extendCellMeta",value:function(t){var e,n=t.row,r=t.col;if(null===(e=this.metaSyncMemo.get(n))||void 0===e||!e.has(r)){var o=t.visualRow,i=t.visualCol,a=this.metaManager.hot,l=a.colToProp(i);t.prop=l,a.runHooks("beforeGetCellMeta",o,i,t);var s,u=bt(t,"type")?t.type:null,c=_n(t.cells)?t.cells(n,r,l):null;if(u)if(c)c.type=null!==(s=c.type)&&void 0!==s?s:u;else c={type:u};c&&this.metaManager.updateCellMeta(n,r,c),a.runHooks("afterGetCellMeta",o,i,t),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(r)}}}]),t}();function AP(t){return AP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AP(t)}function MP(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function IP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_P(r.key),r)}}function xP(t,e,n){return e&&IP(t.prototype,e),n&&IP(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _P(t){var e=HP(t,"string");return"symbol"===AP(e)?e:String(e)}function HP(t,e){if("object"!==AP(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==AP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var NP=function(){function t(e){MP(this,t),this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(t){var e=this.metaManager.hot.isRtl();if(e&&"fixedColumnsLeft"===t)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(t,e,n){if(!n)throw new Error("The `".concat(t,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return xP(t,[{key:"extendMetaProps",value:function(){var t=this;this.propDescriptors.forEach((function(e,n){var r=e.target,o=e.onChange,i=void 0===o?function(){}:o,a="string"===typeof r,l=a?r:n,s="_".concat(l);t.metaManager.globalMeta.meta[s]=t.metaManager.globalMeta.meta[l],t.installPropWatcher(n,s,i),a&&t.installPropWatcher(r,s,i)}))}},{key:"installPropWatcher",value:function(t,e,n){var r=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get:function(){return this[e]},set:function(o){var i=!r.usageTracker.has(t);r.usageTracker.add(t),n.call(r,t,o,i),this[e]=o},enumerable:!0,configurable:!0})}}]),t}(),DP=(n(9714),/^(\r\n|\n\r|\r|\n)/),LP=/^[^\t\r\n]+/,BP=/^\t/;function VP(t){var e=[[""]];if(0===t.length)return e;var n,r=0,o=0;while(t.length>0){if(n===t.length)break;if(n=t.length,t.match(BP))t=t.replace(BP,""),r+=1,e[o][r]="";else if(t.match(DP))t=t.replace(DP,""),r=0,o+=1,e[o]=[""];else{var i="";if(t.startsWith('"')){var a=0,l=!0;while(l){var s=t.slice(0,1);'"'===s&&(a+=1),i+=s,t=t.slice(1),(0===t.length||t.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(function(t){return new Array(Math.floor(t.length/2)).fill('"').join("")}))}else{var u=t.match(LP);i=u?u[0]:"",t=t.slice(i.length)}e[o][r]=i}}return e}function FP(t){var e,n,r,o,i,a="";for(e=0,n=t.length;e<n;e+=1){for(o=t[e].length,r=0;r<o;r+=1)r>0&&(a+="\t"),i=t[e][r],"string"===typeof i?i.indexOf("\n")>-1?a+='"'.concat(i.replace(/"/g,'""'),'"'):a+=i:a+=null===i||void 0===i?"":i;e!==n-1&&(a+="\n")}return a}function WP(t){return YP(t)||GP(t)||zP(t)||UP()}function UP(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function zP(t,e){if(t){if("string"===typeof t)return KP(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?KP(t,e):void 0}}function GP(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function YP(t){if(Array.isArray(t))return KP(t)}function KP(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function XP(t){return XP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},XP(t)}function $P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,JP(r.key),r)}}function QP(t,e,n){return e&&qP(t.prototype,e),n&&qP(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function JP(t){var e=ZP(t,"string");return"symbol"===XP(e)?e:String(e)}function ZP(t,e){if("object"!==XP(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==XP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var tT=function(){function t(e,n,r){$P(this,t),this.instance=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return QP(t,[{key:"createMap",value:function(){var t=this.getSchema();if("undefined"===typeof t)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var e,n=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,n){var r=0,o=0,i=!1;if("function"===typeof n){var a=mt(t);r=a>0?a:this.countFirstRowKeys(),i=!0}else{var l=this.tableMeta.maxCols;r=Math.min(l,n.length)}for(e=0;e<r;e++){var s=i?n(e):n[e];if(ht(s)){if("undefined"!==typeof s.data){var u=i?o:e;this.colToPropCache[u]=s.data,this.propToColCache.set(s.data,u)}o+=1}}}else this.recursiveDuckColumns(t)}},{key:"countFirstRowKeys",value:function(){return Dv(this.dataSource)}},{key:"recursiveDuckColumns",value:function(t,e,n){var r,o=this,i=e,a=n;return"undefined"===typeof i&&(i=0,a=""),"object"!==XP(t)||Array.isArray(t)||pt(t,(function(t,e){null===t?(r=a+e,o.colToPropCache.push(r),o.propToColCache.set(r,i),i+=1):i=o.recursiveDuckColumns(t,i,"".concat(e,"."))})),i}},{key:"colToProp",value:function(t){if(!1===Number.isInteger(t))return t;var e=this.instance.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&Zt(this.colToPropCache[e])?this.colToPropCache[e]:e}},{key:"propToCol",value:function(t){var e=this.propToColCache.get(t);if(Zt(e))return this.instance.toVisualColumn(e);var n=this.instance.toVisualColumn(t);return null===n?t:n}},{key:"getSchema",value:function(){var t=this.tableMeta.dataSchema;return t?"function"===typeof t?t():t:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?ot(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.source,i=r.mode,a=void 0===i?"above":i,l=this.instance.countSourceRows(),s=l,u=0,c=t;("number"!==typeof c||c>=l)&&(c=l),c<this.instance.countRows()&&(s=this.instance.toPhysicalRow(c));var f=this.instance.runHooks("beforeCreateRow",c,n,o);if(!1===f||null===s)return{delta:0};var h=this.tableMeta.maxRows,d=this.getSchema().length,p=[],y=function(){var t=null;"array"===e.instance.dataType?e.tableMeta.dataSchema?t=st(e.getSchema()):(t=[],Io(d-1,(function(){return t.push(null)}))):"function"===e.instance.dataType?t=e.tableMeta.dataSchema(c+u):(t={},lt(t,e.getSchema())),p.push(t),u+=1};while(u<n&&l+u<h)y();this.instance.rowIndexMapper.insertIndexes(c,u),"below"===a&&(s=Math.min(s+1,l)),this.spliceData(s,0,p);var v=this.instance.toVisualRow(s);return this.instance.countSourceRows()===p.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),u>0&&(void 0===t||null===t?this.metaManager.createRow(null,u):"auto"!==o&&this.metaManager.createRow(s,n)),this.instance.runHooks("afterCreateRow",v,u,o),this.instance.forceFullRender=!0,{delta:u,startPhysicalIndex:s}}},{key:"createCol",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.source,o=n.mode,i=void 0===o?"start":o;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var a=this.dataSource,l=this.tableMeta.maxCols,s=this.instance.countSourceCols(),u=t;("number"!==typeof u||u>=s)&&(u=s);var c=this.instance.runHooks("beforeCreateCol",u,e,r);if(!1===c)return{delta:0};var f=s;u<this.instance.countCols()&&(f=this.instance.toPhysicalColumn(u));var h=this.instance.countSourceRows(),d=this.instance.countCols(),p=0,y=f;"end"===i&&(y=Math.min(y+1,s));var v=y;while(p<e&&d<l){if("number"!==typeof u||u>=d)if(h>0)for(var m=0;m<h;m+=1)"undefined"===typeof a[m]&&(a[m]=[]),a[m].push(null);else a.push([null]);else for(var g=0;g<h;g++)a[g].splice(y,0,null);p+=1,y+=1,d+=1}this.instance.columnIndexMapper.insertIndexes(u,p),p>0&&(void 0===t||null===t?this.metaManager.createColumn(null,p):"auto"!==r&&this.metaManager.createColumn(v,e));var b=this.instance.toVisualColumn(v);return this.instance.runHooks("afterCreateCol",b,p,r),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:p,startPhysicalIndex:v}}},{key:"removeRow",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(t)?t:-n,i=this.visualRowsToPhysical(o,n),a=this.instance.countSourceRows();o=(a+o)%a;var l=this.instance.runHooks("beforeRemoveRow",o,i.length,i,r);if(!1===l)return!1;var s=i.length;if(this.filterData(o,s,i),o<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(i);var u=Zt(this.tableMeta.columns)||Zt(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===u&&this.instance.columnIndexMapper.setIndexesSequence([])}var c=i.slice(0).sort((function(t,e){return e-t}));return c.forEach((function(t){e.metaManager.removeRow(t,1)})),this.instance.runHooks("afterRemoveRow",o,s,i,r),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var r="number"!==typeof t?-e:t;r=(this.instance.countCols()+r)%this.instance.countCols();var o=this.visualColumnsToPhysical(r,e),i=o.slice(0).sort((function(t,e){return e-t})),a=this.instance.runHooks("beforeRemoveCol",r,e,o,n);if(!1===a)return!1;for(var l=!0,s=i.length,u=this.dataSource,c=0;c<s;c++)l&&o[0]!==o[c]-c&&(l=!1);if(l)for(var f=0,h=this.instance.countSourceRows();f<h;f++)u[f].splice(o[0],e),0===f&&this.metaManager.removeColumn(o[0],e);else for(var d=0,p=this.instance.countSourceRows();d<p;d++)for(var y=0;y<s;y++)u[d].splice(i[y],1),0===d&&this.metaManager.removeColumn(i[y],1);return r<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(o),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",r,e,o,n),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(t,e,n){for(var r=this.instance.getDataAtCol(t),o=r.slice(e,e+n),i=r.slice(e+n),a=arguments.length,l=new Array(a>3?a-3:0),s=3;s<a;s++)l[s-3]=arguments[s];L(l,i);var u=0;while(u<n)l.push(null),u+=1;return D(l),this.instance.populateFromArray(e,t,l,null,null,"spliceCol"),o}},{key:"spliceRow",value:function(t,e,n){for(var r=this.instance.getSourceDataAtRow(t),o=r.slice(e,e+n),i=r.slice(e+n),a=arguments.length,l=new Array(a>3?a-3:0),s=3;s<a;s++)l[s-3]=arguments[s];L(l,i);var u=0;while(u<n)l.push(null),u+=1;return this.instance.populateFromArray(t,e,[l],null,null,"spliceRow"),o}},{key:"spliceData",value:function(t,e,n){var r=this,o=this.instance.runHooks("beforeDataSplice",t,e,n);if(!1!==o){var i=[].concat(WP(this.dataSource.slice(0,t)),WP(n),WP(this.dataSource.slice(t)));this.dataSource.length=0,i.forEach((function(t){return r.dataSource.push(t)}))}}},{key:"filterData",value:function(t,e,n){var r=this.instance.runHooks("filterData",t,e,n);!1===Array.isArray(r)&&(r=this.dataSource.filter((function(t,e){return-1===n.indexOf(e)}))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}},{key:"get",value:function(t,e){var n=this.instance.toPhysicalRow(t),r=this.dataSource[n],o=this.instance.runHooks("modifyRowData",n);r=isNaN(o)?o:r;var i=null;if(r&&r.hasOwnProperty&&bt(r,e))i=r[e];else if("string"===typeof e&&e.indexOf(".")>-1){var a=e.split("."),l=r;if(!l)return null;for(var s=0,u=a.length;s<u;s++)if(l=l[a[s]],"undefined"===typeof l)return null;i=l}else"function"===typeof e&&(i=e(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var c=gt(i);this.instance.runHooks("modifyData",n,this.propToCol(e),c,"get"),c.isTouched()&&(i=c.value)}return i}},{key:"getCopyable",value:function(t,e){return this.instance.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}},{key:"set",value:function(t,e,n){var r=this.instance.toPhysicalRow(t),o=n,i=this.dataSource[r],a=this.instance.runHooks("modifyRowData",r);if(i=isNaN(a)?a:i,this.instance.hasHook("modifyData")){var l=gt(o);this.instance.runHooks("modifyData",r,this.propToCol(e),l,"set"),l.isTouched()&&(o=l.value)}if(i&&i.hasOwnProperty&&bt(i,e))i[e]=o;else if("string"===typeof e&&e.indexOf(".")>-1){var s,u=e.split("."),c=i,f=0;for(f=0,s=u.length-1;f<s;f++)"undefined"===typeof c[u[f]]&&(c[u[f]]={}),c=c[u[f]];c[u[f]]=o}else"function"===typeof e?e(this.dataSource.slice(r,r+1)[0],o):i[e]=o}},{key:"visualRowsToPhysical",value:function(t,e){var n,r=this.instance.countSourceRows(),o=[],i=(r+t)%r,a=e;while(i<r&&a)n=this.instance.toPhysicalRow(i),o.push(n),a-=1,i+=1;return o}},{key:"visualColumnsToPhysical",value:function(t,e){var n=this.instance.countCols(),r=[],o=(n+t)%n,i=e;while(o<n&&i){var a=this.instance.toPhysicalColumn(o);r.push(a),i-=1,o+=1}return r}},{key:"clear",value:function(){for(var t=0;t<this.instance.countSourceRows();t++)for(var e=0;e<this.instance.countCols();e++)this.set(t,this.colToProp(e),"")}},{key:"getLength",value:function(){var t,e=this.tableMeta.maxRows;t=e<0||0===e?0:e||1/0;var n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,t)}},{key:"getAll",value:function(){var e={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-n.row!==0||this.instance.countSourceRows()?this.getRange(e,n,t.DESTINATION_RENDERER):[]}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(e,n,r){var o,i,a,l=[],s=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(0===s||0===u)return[];var c=r===t.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(s-1,0),Math.max(e.row,n.row)),h=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=f;o++){a=[];var d=o>=0?this.instance.toPhysicalRow(o):o;for(i=Math.min(e.col,n.col);i<=h;i++){if(null===d)break;a.push(c.call(this,o,this.colToProp(i)))}null!==d&&l.push(a)}return l}},{key:"getText",value:function(e,n){return FP(this.getRange(e,n,t.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(e,n){return FP(this.getRange(e,n,t.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),t}(),eT=tT;function nT(t){return nT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nT(t)}function rT(t,e,n,r){var o=r.hotInstance,i=r.dataMap,a=r.dataSource,l=r.internalSource,s=r.source,u=r.metaManager,c=r.firstRun,f=be(l),h=o.getSettings();Array.isArray(h.dataSchema)?o.dataType="array":_n(h.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),t=o.runHooks("before".concat(f),t,c,s);var d=new eT(o,t,u);if(e(d),"object"===nT(t)&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error("".concat(l," only accepts array of objects or array of arrays (").concat(nT(t)," given)"));var p,y=d.getSchema();t=[];var v=0,m=0;for(v=0,m=h.startRows;v<m;v++)if("object"!==o.dataType&&"function"!==o.dataType||!h.dataSchema)if("array"===o.dataType)p=st(y[0]),t.push(p);else{p=[];for(var g=0,b=h.startCols;g<b;g++)p.push(null);t.push(p)}else p=st(y),t.push(p)}Array.isArray(t[0])&&(o.dataType="array"),h.data=t,d.dataSource=t,a.data=t,a.dataType=o.dataType,a.colToProp=d.colToProp.bind(d),a.propToCol=d.propToCol.bind(d),a.countCachedColumns=d.countCachedColumns.bind(d),n(d),o.runHooks("after".concat(f),t,c,s),c||(o.runHooks("afterChange",null,l),o.render())}var oT,iT=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),aT=function(t){return t.map((function(t){var e=t.toLowerCase();return iT.has(e)?iT.get(e):e})).sort().join("+")},lT=function(t){return t.split("+")},sT=function(t){return t.toLowerCase()};function uT(t){return hT(t)||fT(t)||yT(t)||cT()}function cT(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fT(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function hT(t){if(Array.isArray(t))return vT(t)}function dT(t,e){return gT(t)||mT(t,e)||yT(t,e)||pT()}function pT(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function yT(t,e){if(t){if("string"===typeof t)return vT(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vT(t,e):void 0}}function vT(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function mT(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function gT(t){if(Array.isArray(t))return t}function bT(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var wT=function(t){var e=si({errorIdExists:function(e){return'The "'.concat(e,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.keys,r=t.callback,o=t.group,i=t.runOnlyIf,a=void 0===i?function(){return!0}:i,l=t.captureCtrl,s=void 0!==l&&l,u=t.preventDefault,c=void 0===u||u,f=t.stopPropagation,h=void 0!==f&&f,d=t.relativeToGroup,p=t.position;if(te(o))throw new Error("You need to define the shortcut's group.");if(!1===_n(r))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(n))throw new Error($t(oT||(oT=bT(["Pass the shortcut's keys as an array of arrays, \n      using the KeyboardEvent.key properties: \n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."],["Pass the shortcut\\'s keys as an array of arrays,\\x20\n      using the KeyboardEvent.key properties:\\x20\n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."]))));var y={callback:r,group:o,runOnlyIf:a,captureCtrl:s,preventDefault:c,stopPropagation:h};if(Zt(d)){var v=[d,p];y.relativeToGroup=v[0],y.position=v[1]}n.forEach((function(t){var n=aT(t),r=e.hasItem(n);if(r){var o=e.getItem(n),i=o.findIndex((function(t){return t.group===d}));-1!==i?"before"===p?i-=1:i+=1:i=o.length,o.splice(i,0,y)}else e.addItem(n,[y])}))},r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach((function(t){pt(e,(function(n,r){!1===Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=e[r])})),n(t)}))},o=function(t){var n=aT(t);e.removeItem(n)},i=function(t){var n=e.getItems();n.forEach((function(e){var n=dT(e,2),r=n[0],i=n[1],a=i.filter((function(e){return e.group!==t}));0===a.length?o(lT(r)):(i.length=0,i.push.apply(i,uT(a)))}))},a=function(t){var n=aT(t),r=e.getItem(n);return Zt(r)?r.slice():[]},l=function(t){var n=aT(t);return e.hasItem(n)};return{addShortcut:n,addShortcuts:r,getShortcuts:a,hasShortcut:l,removeShortcutsByKeys:o,removeShortcutsByGroup:i}};function ST(){var t=new Set;return{press:function(e){t.add(e)},release:function(e){t.delete(e)},releaseAll:function(){t.clear()},isPressed:function(e){return t.has(e)}}}var CT=["meta","alt","shift","control"],OT=ST();function kT(t,e,n,r,o){var i=function(t){return CT.includes(t)},a=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return t.altKey&&n.push("alt"),e&&(t.ctrlKey||t.metaKey)?n.push("control/meta"):(t.ctrlKey&&n.push("control"),t.metaKey&&n.push("meta")),t.shiftKey&&n.push("shift"),n},l=function(t){if(!1!==e(t)){var l=n(t);if(229!==t.keyCode&&!1!==l&&!tr(t)){var s=sT(t.key),u=[];i(s)?OT.press(s):u=a(t);var c=[s].concat(u),f=o(t,c);!f&&(Bt()&&u.includes("meta")||!Bt()&&u.includes("control"))&&o(t,[s].concat(a(t,!0))),r(t)}}},s=function(t){if(!1!==e(t)){var n=sT(t.key);!1!==i(n)&&OT.release(n)}},u=function(){OT.releaseAll()},c=function(){var e=t;while(e)e.document.documentElement.addEventListener("keydown",l),e.document.documentElement.addEventListener("keyup",s),e.document.documentElement.addEventListener("blur",u),e=_e(e)},f=function(){var e=t;while(e)e.document.documentElement.removeEventListener("keydown",l),e.document.documentElement.removeEventListener("keyup",s),e.document.documentElement.removeEventListener("blur",u),e=_e(e)};return{mount:c,unmount:f,isPressed:function(t){return OT.isPressed(t)},releasePressedKeys:function(){return OT.releaseAll()}}}var RT,ET,PT=function(t){var e=t.ownerWindow,n=t.handleEvent,r=t.beforeKeyDown,o=t.afterKeyDown,i=si({errorIdExists:function(t){return'The "'.concat(t,'" context name is already registered.')}}),a="grid",l=function(t){var e=wT(t);return i.addItem(t,e),e},s=function(){return a},u=function(t){return i.getItem(t)},c=function(t){a=t},f=!1,h=kT(e,n,r,o,(function(t,e){var n=u(s()),r=!1;if(!n.hasShortcut(e))return r;for(var o=n.getShortcuts(e),i=0;i<o.length;i++){var a=o[i],l=a.callback,c=a.runOnlyIf,h=a.preventDefault,d=a.stopPropagation,p=a.captureCtrl;if(!1!==c(t)&&(f=p,r=!1===l(t,e),f=!1,h&&t.preventDefault(),d&&t.stopPropagation(),r))break}return r}));return h.mount(),{addContext:l,getActiveContextName:s,getContext:u,setActiveContextName:c,isCtrlPressed:function(){return!f&&(h.isPressed("control")||h.isPressed("meta"))},releasePressedKeys:function(){return h.releasePressedKeys()},destroy:function(){return h.unmount()}}};function TT(t){return TT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TT(t)}function jT(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function AT(t,e){return xT(t)||IT(t,e)||NT(t,e)||MT()}function MT(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function IT(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function xT(t){if(Array.isArray(t))return t}function _T(t){return LT(t)||DT(t)||NT(t)||HT()}function HT(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function NT(t,e){if(t){if("string"===typeof t)return BT(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?BT(t,e):void 0}}function DT(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function LT(t){if(Array.isArray(t))return BT(t)}function BT(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var VT="gridDefault",FT=null,WT=new Set;function UT(t,e){var n,r,o,i,a,l=this,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=!1,c=this,f=new Gr(c),h=!0;Qy(s)&&qy(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=null!==(n=null===e||void 0===e?void 0:e.layoutDirection)&&void 0!==n?n:"inherit",p=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",p),this.isRtl=function(){return"rtl"===p},this.isLtr=function(){return!c.isRtl()},this.getDirectionFactor=function(){return c.isLtr()?1:-1},e.language=OC(e.language);var y=new CP(c,e,[jP,NP]),v=y.getTableMeta(),m=y.getGlobalMeta(),g=si();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Jy(this)&&me(e.licenseKey,t),this.guid="ht_".concat(Se()),this.columnIndexMapper=new bw,this.rowIndexMapper=new bw,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(function(t){c.runHooks("afterColumnSequenceChange",t)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(function(t){c.runHooks("afterRowSequenceChange",t)})),o=new Kv(c),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);var b=function(t){var e=t.row,n=t.col;return c._createCellCoords(e>=0?c.rowIndexMapper.getRenderableFromVisualIndex(e):e,n>=0?c.columnIndexMapper.getRenderableFromVisualIndex(n):n)},w=function(t){var e=t.row,n=t.col;return c._createCellCoords(e>=0?c.rowIndexMapper.getVisualFromRenderableIndex(e):e,n>=0?c.columnIndexMapper.getVisualFromRenderableIndex(n):n)},S=new nE(v,{rowIndexMapper:function(){return c.rowIndexMapper},columnIndexMapper:function(){return c.columnIndexMapper},countCols:function(){return c.countCols()},countRows:function(){return c.countRows()},propToCol:function(t){return r.propToCol(t)},isEditorOpened:function(){return!!c.getActiveEditor()&&c.getActiveEditor().isOpened()},countColsTranslated:function(){return l.view.countRenderableColumns()},countRowsTranslated:function(){return l.view.countRenderableRows()},getShortcutManager:function(){return c.getShortcutManager()},createCellCoords:function(t,e){return c._createCellCoords(t,e)},createCellRange:function(t,e,n){return c._createCellRange(t,e,n)},visualToRenderableCoords:b,renderableToVisualCoords:w,isDisabledCellSelection:function(t,e){return c.getCellMeta(t,e).disableVisualSelection}});this.selection=S;var C=function(t){var e=t.hiddenIndexesChanged;e&&l.selection.refresh()};function O(t){var e=Cw(t);bC(e)?(c.runHooks("beforeLanguageChange",e),m.language=e,c.runHooks("afterLanguageChange",e)):Ow(t)}function k(t,e){var n="className"===t?c.rootElement:c.table;if(h)Ge(n,e);else{var r=[],o=[];m[t]&&(r=Array.isArray(m[t])?m[t]:Z(m[t])),e&&(o=Array.isArray(e)?e:Z(e));var i=q(r,o),a=q(o,r);i.length&&Ye(n,i),a.length&&Ge(n,a)}m[t]=e}function R(){var t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function E(t){var e=t.replace(",",".");return!1===isNaN(parseFloat(e))?parseFloat(e):t}function P(t,e,n){if(t.length){var o=c.getActiveEditor(),i=c.runHooks("beforeChange",t,e||"edit"),a=!0;if(!1!==i){var l=new R;l.onQueueEmpty=function(t){o&&a&&o.cancelChanges(),n(t)};for(var s=t.length-1;s>=0;s--)if(null===t[s])t.splice(s,1);else{var u=AT(t[s],4),f=u[0],h=u[1],d=u[3],p=r.propToCol(h),y=c.getCellMeta(f,p);"numeric"===y.type&&"string"===typeof d&&Mo(d)&&(t[s][3]=E(d)),c.getCellValidator(y)&&(l.addValidatorToQueue(),c.validateCell(t[s][3],y,function(e,n){return function(r){if("boolean"!==typeof r)throw new Error("Validation error: result is not boolean");if(!1===r&&!1===n.allowInvalid){a=!1,t.splice(e,1),n.valid=!0;var o=c.getCell(n.visualRow,n.visualCol);null!==o&&Ye(o,v.invalidCellClassName)}l.removeValidatorFormQueue()}}(s,y),e))}l.checkIfQueueIsEmpty()}else o&&o.cancelChanges()}}function T(t,e){var n=t.length-1;if(!(n<0)){for(;n>=0;n--){var o=!1;if(null!==t[n]){if(null!==t[n][2]&&void 0!==t[n][2]||null!==t[n][3]&&void 0!==t[n][3]){if(v.allowInsertRow)while(t[n][0]>c.countRows()-1){var l=r.createRow(void 0,void 0,{source:e}),s=l.delta;if(0===s){o=!0;break}}if("array"===c.dataType&&(!v.columns||0===v.columns.length)&&v.allowInsertColumn)while(r.propToCol(t[n][1])>c.countCols()-1){var u=r.createCol(void 0,void 0,{source:e}),f=u.delta;if(0===f){o=!0;break}}o||r.set(t[n][0],t[n][1],t[n][3])}}else t.splice(n,1)}c.forceFullRender=!0,i.adjustRowsAndCols(),c.runHooks("beforeChangeRender",t,e),a.lockEditor(),c._refreshBorders(null),a.unlockEditor(),c.view.adjustElementsSize(),c.runHooks("afterChange",t,e||"edit");var h=c.getActiveEditor();h&&Zt(h.refreshValue)&&h.refreshValue()}}function j(t,e,n){return Array.isArray(t)?t:[[t,e,n]]}this.columnIndexMapper.addLocalHook("cacheUpdated",C),this.rowIndexMapper.addLocalHook("cacheUpdated",C),this.selection.addLocalHook("beforeSetRangeStart",(function(t){l.runHooks("beforeSetRangeStart",t)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(function(t){l.runHooks("beforeSetRangeStartOnly",t)})),this.selection.addLocalHook("beforeSetRangeEnd",(function(t){l.runHooks("beforeSetRangeEnd",t),t.row<0&&(t.row=l.view._wt.wtTable.getFirstVisibleRow()),t.col<0&&(t.col=l.view._wt.wtTable.getFirstVisibleColumn())})),this.selection.addLocalHook("afterSetRangeEnd",(function(t){var e=gt(!1),n=l.selection.getSelectedRange(),r=n.current(),o=r.from,i=r.to,a=n.size()-1;l.runHooks("afterSelection",o.row,o.col,i.row,i.col,e,a),l.runHooks("afterSelectionByProp",o.row,c.colToProp(o.col),i.row,c.colToProp(i.col),e,a);var s=l.selection.isSelectedByAnyHeader(),f=l.selection.selectedRange.current(),h=!0;u&&(h=!1),e.isTouched()&&(h=!e.value);var d=l.selection.isSelectedByRowHeader(),p=l.selection.isSelectedByColumnHeader();!1!==h&&(s?d?l.view.scrollViewportVertically(c.rowIndexMapper.getRenderableFromVisualIndex(t.row)):p&&l.view.scrollViewportHorizontally(c.columnIndexMapper.getRenderableFromVisualIndex(t.col)):f&&!l.selection.isMultiple()?l.view.scrollViewport(b(f.from)):l.view.scrollViewport(b(t))),d&&p?Ge(l.rootElement,["ht__selection--rows","ht__selection--columns"]):d?(Ye(l.rootElement,"ht__selection--columns"),Ge(l.rootElement,"ht__selection--rows")):p?(Ye(l.rootElement,"ht__selection--rows"),Ge(l.rootElement,"ht__selection--columns")):Ye(l.rootElement,["ht__selection--rows","ht__selection--columns"]),l._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(function(t){var e=t.length-1,n=t[e],r=n.from,o=n.to;l.runHooks("afterSelectionEnd",r.row,r.col,o.row,o.col,e),l.runHooks("afterSelectionEndByProp",r.row,c.colToProp(r.col),o.row,c.colToProp(o.col),e)})),this.selection.addLocalHook("afterIsMultipleSelection",(function(t){var e=l.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)})),this.selection.addLocalHook("beforeModifyTransformStart",(function(t){l.runHooks("modifyTransformStart",t)})),this.selection.addLocalHook("afterModifyTransformStart",(function(t,e,n){l.runHooks("afterModifyTransformStart",t,e,n)})),this.selection.addLocalHook("beforeModifyTransformEnd",(function(t){l.runHooks("modifyTransformEnd",t)})),this.selection.addLocalHook("afterModifyTransformEnd",(function(t,e,n){l.runHooks("afterModifyTransformEnd",t,e,n)})),this.selection.addLocalHook("afterDeselect",(function(){a.destroyEditor(),l._refreshBorders(),Ye(l.rootElement,["ht__selection--rows","ht__selection--columns"]),l.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(function(t){l.alter("insert_row_above",t,1,"auto")})),this.selection.addLocalHook("insertColRequire",(function(t){l.alter("insert_col_start",t,1,"auto")})),i={alter:function(t,e){var n,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,u=function(t){if(0===t.length)return[];var e=_T(t);e.sort((function(t,e){var n=AT(t,1),r=n[0],o=AT(e,1),i=o[0];return r===i?0:r>i?1:-1}));var n=V(e,(function(t,e){var n=AT(e,2),r=n[0],o=n[1],i=t[t.length-1],a=AT(i,2),l=a[0],s=a[1],u=l+s;if(r<=u){var c=Math.max(o-(u-r),0);i[1]+=c}else t.push([r,o]);return t}),[e[0]]);return n};switch(t){case"insert_row":WT.has(t)||(WT.add(t),Un($t(RT||(RT=jT(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),t)));case"insert_row_below":case"insert_row_above":var f=c.countSourceRows();if(v.maxRows===f)return;var h="insert_row_below"===t?"below":"above";e=null!==(n=e)&&void 0!==n?n:"insert_row"===t||"below"===h?f:0;var d=r.createRow(e,a,{source:l,mode:h}),p=d.delta,y=d.startPhysicalIndex;if(p){var m=S.selectedRange.current(),g=null===m||void 0===m?void 0:m.from,b=null===g||void 0===g?void 0:g.row,w=c.toVisualRow(y);if(S.isSelectedByCorner())c.selectAll();else if(Zt(b)&&b>=w){var C=m.to,O=C.row,k=C.col,R=g.col;S.isSelectedByRowHeader()&&(R=-1),S.getSelectedRange().pop(),S.setRangeStartOnly(c._createCellCoords(b+p,R),!0),S.setRangeEnd(c._createCellCoords(O+p,k))}else c._refreshBorders()}break;case"insert_col":WT.has(t)||(WT.add(t),Un($t(ET||(ET=jT(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),t)));case"insert_col_start":case"insert_col_end":var E="insert_col_end"===t?"end":"start";e=null!==(o=e)&&void 0!==o?o:"insert_col"===t||"end"===E?c.countSourceCols():0;var P=r.createCol(e,a,{source:l,mode:E}),T=P.delta,j=P.startPhysicalIndex;if(T){if(Array.isArray(v.colHeaders)){var A=[c.toVisualColumn(j),0];A.length+=T,Array.prototype.splice.apply(v.colHeaders,A)}var M=S.selectedRange.current(),I=null===M||void 0===M?void 0:M.from,x=null===I||void 0===I?void 0:I.col,_=c.toVisualColumn(j);if(S.isSelectedByCorner())c.selectAll();else if(Zt(x)&&x>=_){var H=M.to,N=H.row,D=H.col,L=I.row;S.isSelectedByColumnHeader()&&(L=-1),S.getSelectedRange().pop(),S.setRangeStartOnly(c._createCellCoords(L,x+T),!0),S.setRangeEnd(c._createCellCoords(N,D+T))}else c._refreshBorders()}break;case"remove_row":var B=function(t){var e=0;U(t,(function(t){var n=AT(t,2),o=n[0],i=n[1],a=ee(o)?c.countRows()-1:Math.max(o-e,0);Number.isInteger(o)&&(o=Math.max(o-e,0));var s=r.removeRow(o,i,l);if(s){var u=c.countRows(),f=v.fixedRowsTop;f>=a+1&&(v.fixedRowsTop-=Math.min(i,f-a));var h=v.fixedRowsBottom;h&&a>=u-h&&(v.fixedRowsBottom-=Math.min(i,h)),e+=i}}))};Array.isArray(e)?B(u(e)):B([[e,a]]),i.adjustRowsAndCols(),c._refreshBorders();break;case"remove_col":var F=function(t){var e=0;U(t,(function(t){var n=AT(t,2),o=n[0],i=n[1],a=ee(o)?c.countCols()-1:Math.max(o-e,0),s=c.toPhysicalColumn(a);Number.isInteger(o)&&(o=Math.max(o-e,0));var u=r.removeCol(o,i,l);if(u){var f=v.fixedColumnsStart;f>=a+1&&(v.fixedColumnsStart-=Math.min(i,f-a)),Array.isArray(v.colHeaders)&&("undefined"===typeof s&&(s=-1),v.colHeaders.splice(s,i)),e+=i}}))};Array.isArray(e)?F(u(e)):F([[e,a]]),i.adjustRowsAndCols(),c._refreshBorders();break;default:throw new Error('There is no such action "'.concat(t,'"'))}s||i.adjustRowsAndCols()},adjustRowsAndCols:function(){var t,e=v.minRows,n=v.minSpareRows,o=v.minCols,i=v.minSpareCols;if(0===c.countRows()&&0===c.countCols()&&S.deselect(),e){var a=c.countRows();a<e&&r.createRow(a,e-a,{source:"auto"})}if(n){var l=c.countEmptyRows(!0);if(l<n){var s=n-l,u=Math.min(s,v.maxRows-c.countSourceRows());r.createRow(c.countRows(),u,{source:"auto"})}}(o||i)&&(t=c.countEmptyCols(!0));var f=c.countCols();if(o&&!v.columns&&f<o){var h=o-f;t+=h,r.createCol(f,h,{source:"auto"})}if(i&&!v.columns&&"array"===c.dataType&&t<i){f=c.countCols();var d=i-t,p=Math.min(d,v.maxCols-f);r.createCol(f,p,{source:"auto"})}if(S.isSelected()){var y=c.countRows(),m=c.countCols();U(S.selectedRange,(function(t){var e=!1,n=t.from.row,r=t.from.col,o=t.to.row,i=t.to.col;n>y-1?(n=y-1,e=!0,o>n&&(o=n)):o>y-1&&(o=y-1,e=!0,n>o&&(n=o)),r>m-1?(r=m-1,e=!0,i>r&&(i=r)):i>m-1&&(i=m-1,e=!0,r>i&&(r=i)),e&&c.selectCell(n,r,o,i)}))}c.view&&c.view.adjustElementsSize()},populateFromArray:function(t,e,n,r,o,i,a){var l,s,u,f,h=[],d={},p=[],y=t.row,m=t.col;if(s=e.length,0===s)return!1;var g=0,b=0;switch(ht(n)&&(g=n.col-m+1,b=n.row-y+1),o){case"shift_down":var w=B(e),S=w.length,C=Math.max(S,g),O=c.getData().slice(y),k=B(O).slice(m,m+C);for(u=0;u<C;u+=1)if(u<S){for(l=0,s=w[u].length;l<b-s;l+=1)w[u].push(w[u][l%s]);u<k.length?p.push(w[u].concat(k[u])):p.push(w[u].concat(new Array(O.length).fill(null)))}else p.push(w[u%S].concat(k[u]));c.populateFromArray(y,m,B(p));break;case"shift_right":var R=e.length,E=Math.max(R,b),P=c.getData().slice(y).map((function(t){return t.slice(m)}));for(l=0;l<E;l+=1)if(l<R){for(u=0,f=e[l].length;u<g-f;u+=1)e[l].push(e[l][u%f]);var T;if(l<P.length)for(var j=0;j<P[l].length;j+=1)e[l].push(P[l][j]);else(T=e[l]).push.apply(T,_T(new Array(P[0].length).fill(null)))}else e.push(e[l%s].slice(0,E).concat(P[l]));c.populateFromArray(y,m,e);break;case"overwrite":default:d.row=t.row,d.col=t.col;var A,M={row:n&&t?n.row-t.row+1:1,col:n&&t?n.col-t.col+1:1},I=0,x=0,_=!0,H=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e[t%e.length];return null!==n?r[n%r.length]:r},N=e.length,D=n?n.row-t.row+1:0;for(s=n?D:Math.max(N,D),l=0;l<s;l++){if(n&&d.row>n.row&&D>N||!v.allowInsertRow&&d.row>c.countRows()-1||d.row>=v.maxRows)break;var L=l-I,V=H(L).length,F=n?n.col-t.col+1:0;if(f=n?F:Math.max(V,F),d.col=t.col,A=c.getCellMeta(d.row,d.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!A.skipRowOnPaste){for(x=0,u=0;u<f;u++){if(n&&d.col>n.col&&F>V||!v.allowInsertColumn&&d.col>c.countCols()-1||d.col>=v.maxCols)break;if(A=c.getCellMeta(d.row,d.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!A.skipColumnOnPaste)if(A.readOnly&&"UndoRedo.undo"!==r)d.col+=1;else{var W=u-x,U=H(L,W),z=c.getDataAtCell(d.row,d.col),G={row:L,col:W};if("Autofill.fill"===r){var Y=c.runHooks("beforeAutofillInsidePopulate",G,i,e,a,{},M);Y&&(U=te(Y.value)?U:Y.value)}if(null!==U&&"object"===TT(U))if(Array.isArray(U)&&null===z&&(z=[]),null===z||"object"!==TT(z))_=!1;else{var K=ot(Array.isArray(z)?z:z[0]||z),X=ot(Array.isArray(U)?U:U[0]||U);ft(K,X)||Array.isArray(K)&&Array.isArray(X)?U=st(U):_=!1}else null!==z&&"object"===TT(z)&&(_=!1);_&&h.push([d.row,d.col,U]),_=!0,d.col+=1}else x+=1,d.col+=1,f+=1}d.row+=1}else I+=1,d.row+=1,s+=1}c.setDataAtCell(h,null,null,r||"populateFromArray");break}}},this.init=function(){o.setData(v.data),c.runHooks("beforeInit"),(Ht()||Dt())&&Ge(c.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new Pv(this),a=uo.getInstance(c,v,S),c.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&null===c.rootElement.offsetParent&&xn(c.rootElement,(function(){c.view._wt.wtOverlays.updateLastSpreaderSize(),c.render(),c.view.adjustElementsSize()})),"object"===TT(h)&&(c.runHooks("afterChange",h[0],h[1]),h=!1),c.runHooks("afterInit")},this._createCellCoords=function(t,e){return c.view._wt.createCellCoords(t,e)},this._createCellRange=function(t,e,n){return c.view._wt.createCellRange(t,e,n)},this.validateCell=function(t,e,n,r){var o=c.getCellValidator(e);function i(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(r&&!0!==e.hidden){var o=e.visualCol,i=e.visualRow,a=c.getCell(i,o,!0);if(a&&"TH"!==a.nodeName){var l=c.rowIndexMapper.getRenderableFromVisualIndex(i),s=c.columnIndexMapper.getRenderableFromVisualIndex(o);c.view._wt.getSetting("cellRenderer",l,s,a)}n(t)}else n(t)}ne(o)&&(o=function(t){return function(e,n){n(t.test(e))}}(o)),_n(o)?(t=c.runHooks("beforeValidate",t,e.visualRow,e.prop,r),c._registerImmediate((function(){o.call(e,t,(function(n){c&&(n=c.runHooks("afterValidate",n,t,e.visualRow,e.prop,r),e.valid=n,i(n),c.runHooks("postAfterValidate",n,t,e.visualRow,e.prop,r))}))}))):c._registerImmediate((function(){e.valid=!0,i(e.valid,!1)}))},this.setDataAtCell=function(t,e,n,i){var a,l,s,u=j(t,e,n),f=[],h=i;for(a=0,l=u.length;a<l;a++){if("object"!==TT(u[a]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!==typeof u[a][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");s=u[a][1]>=this.countCols()?u[a][1]:r.colToProp(u[a][1]),f.push([u[a][0],s,o.getAtCell(this.toPhysicalRow(u[a][0]),u[a][1]),u[a][2]])}h||"object"!==TT(t)||(h=e),c.runHooks("afterSetDataAtCell",f,h),P(f,h,(function(){T(f,h)}))},this.setDataAtRowProp=function(t,e,n,r){var i,a,l=j(t,e,n),s=[],u=r;for(i=0,a=l.length;i<a;i++)s.push([l[i][0],l[i][1],o.getAtCell(this.toPhysicalRow(l[i][0]),l[i][1]),l[i][2]]);u||"object"!==TT(t)||(u=e),c.runHooks("afterSetDataAtRowProp",s,u),P(s,u,(function(){T(s,u)}))},this.listen=function(){c&&!c.isListening()&&(FT=c.guid,c.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(FT=null,c.runHooks("afterUnlisten"))},this.isListening=function(){return FT===c.guid},this.destroyEditor=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];c._refreshBorders(t,e)},this.populateFromArray=function(t,e,n,r,o,a,l,s,u){if("object"!==TT(n)||"object"!==TT(n[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");var f="number"===typeof r?c._createCellCoords(r,o):null;return i.populateFromArray(c._createCellCoords(t,e),n,f,a,l,s,u)},this.spliceCol=function(t,e,n){for(var o,i=arguments.length,a=new Array(i>3?i-3:0),l=3;l<i;l++)a[l-3]=arguments[l];return(o=r).spliceCol.apply(o,[t,e,n].concat(a))},this.spliceRow=function(t,e,n){for(var o,i=arguments.length,a=new Array(i>3?i-3:0),l=3;l<i;l++)a[l-3]=arguments[l];return(o=r).spliceRow.apply(o,[t,e,n].concat(a))},this.getSelected=function(){if(S.isSelected())return W(S.getSelectedRange(),(function(t){var e=t.from,n=t.to;return[e.row,e.col,n.row,n.col]}))},this.getSelectedLast=function(){var t,e=this.getSelected();return e&&e.length>0&&(t=e[e.length-1]),t},this.getSelectedRange=function(){if(S.isSelected())return Array.from(S.getSelectedRange())},this.getSelectedRangeLast=function(){var t,e=this.getSelectedRange();return e&&e.length>0&&(t=e[e.length-1]),t},this.emptySelectedCells=function(t){var e=this;if(S.isSelected()&&0!==this.countRows()&&0!==this.countCols()){var n=[];U(S.getSelectedRange(),(function(t){var r=t.getTopStartCorner(),o=t.getBottomEndCorner();Io(r.row,o.row,(function(t){Io(r.col,o.col,(function(r){e.getCellMeta(t,r).readOnly||n.push([t,r,null])}))}))})),n.length>0&&this.setDataAtCell(n,t)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var t=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(t,0),this.isRenderSuspended()||t!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(a.lockEditor(),this._refreshBorders(null),a.unlockEditor()))},this.batchRender=function(t){this.suspendRender();var e=t();return this.resumeRender(),e},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(e,0),(!this.isExecutionSuspended()&&e===this.executionSuspendedCounter||t)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();var n=t();return this.resumeExecution(e),n},this.batch=function(t){this.suspendRender(),this.suspendExecution();var e=t();return this.resumeExecution(),this.resumeRender(),e},this.refreshDimensions=function(){if(c.view){var t=c.view.getLastSize(),e=t.width,n=t.height,r=c.rootElement.getBoundingClientRect(),o=r.width,i=r.height,a=o!==e||i!==n,l=!1===c.runHooks("beforeRefreshDimensions",{width:e,height:n},{width:o,height:i},a);l||((a||c.view._wt.wtOverlays.scrollableElement===c.rootWindow)&&(c.view.setLastSize(o,i),c.render()),c.runHooks("afterRefreshDimensions",{width:e,height:n},{width:o,height:i},a))}},this.updateData=function(t,e){var n=this;rT(t,(function(t){r=t}),(function(t){r=t,c.columnIndexMapper.fitToLength(n.getInitialColumnCount()),c.rowIndexMapper.fitToLength(n.countSourceRows()),i.adjustRowsAndCols()}),{hotInstance:c,dataMap:r,dataSource:o,internalSource:"updateData",source:e,metaManager:y,firstRun:h})},this.loadData=function(t,e){rT(t,(function(t){r=t}),(function(){y.clearCellsCache(),c.initIndexMappers(),i.adjustRowsAndCols(),h&&(h=[null,"loadData"])}),{hotInstance:c,dataMap:r,dataSource:o,internalSource:"loadData",source:e,metaManager:y,firstRun:h})},this.getInitialColumnCount=function(){var t=v.columns,e=0;if(Array.isArray(t))e=t.length;else if(_n(t))if("array"===c.dataType)for(var n=this.countSourceCols(),o=0;o<n;o+=1)t(o)&&(e+=1);else"object"!==c.dataType&&"function"!==c.dataType||(e=r.colToPropCache.length);else if(Zt(v.dataSchema)){var i=r.getSchema();e=Array.isArray(i)?i.length:mt(i)}else e=this.countSourceCols();return e},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(t,e,n,o){return te(t)?r.getAll():r.getRange(c._createCellCoords(t,e),c._createCellCoords(n,o),r.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,n,o){return r.getCopyableText(c._createCellCoords(t,e),c._createCellCoords(n,o))},this.getCopyableData=function(t,e){return r.getCopyable(t,r.colToProp(e))},this.getSchema=function(){return r.getSchema()},this.updateSettings=function(t){var e,n,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=(h?c.loadData:c.updateData).bind(this),s=!1;if(Zt(t.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Zt(t.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Zt(t.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(e in t)"data"===e||("language"===e?O(t.language):"className"===e?k("className",t.className):"tableClassName"===e&&c.table?(k("tableClassName",t.tableClassName),c.view._wt.wtOverlays.syncOverlayTableClassNames()):mr.getSingleton().isRegistered(e)||mr.getSingleton().isDeprecated(e)?(_n(t[e])||Array.isArray(t[e]))&&(t[e].initialHook=!0,c.addHook(e,t[e])):!o&&bt(t,e)&&(m[e]=t[e]));void 0===t.data&&void 0===v.data?l(null,"updateSettings"):void 0!==t.data?l(t.data,"updateSettings"):void 0!==t.columns&&(r.createMap(),c.initIndexMappers());var u=c.countCols(),f=v.columns;if(f&&_n(f)&&(s=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||y.clearCache(),u>0)for(e=0,n=0;e<u;e++){if(f){var d=s?f(e):f[n];d&&y.updateColumnMeta(n,d)}n+=1}Zt(t.cell)&&pt(t.cell,(function(t){c.setCellMetaObject(t.row,t.col,t)})),c.runHooks("afterCellMetaReset");var p=c.rootElement.style.height;""!==p&&(p=parseInt(c.rootElement.style.height,10));var g=t.height;if(_n(g)&&(g=g()),o){var b=c.rootElement.getAttribute("style");b&&c.rootElement.setAttribute("data-initialstyle",c.rootElement.getAttribute("style"))}if(null===g){var w=c.rootElement.getAttribute("data-initialstyle");w&&(w.indexOf("height")>-1||w.indexOf("overflow")>-1)?c.rootElement.setAttribute("style",w):(c.rootElement.style.height="",c.rootElement.style.overflow="")}else void 0!==g&&(c.rootElement.style.height=isNaN(g)?"".concat(g):"".concat(g,"px"),c.rootElement.style.overflow="hidden");if("undefined"!==typeof t.width){var S=t.width;_n(S)&&(S=S()),c.rootElement.style.width=isNaN(S)?"".concat(S):"".concat(S,"px")}o||(c.view&&(c.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),c.view._wt.exportSettingsAsClassNames()),c.runHooks("afterUpdateSettings",t)),i.adjustRowsAndCols(),c.view&&!h&&(c.forceFullRender=!0,a.lockEditor(),c._refreshBorders(null),c.view._wt.wtOverlays.adjustElementsSize(),a.unlockEditor()),o||!c.view||""!==p&&""!==g&&void 0!==g||p===g||c.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var t=c.getSelectedLast();if(v.getValue){if(_n(v.getValue))return v.getValue.call(c);if(t)return c.getData()[t[0][0]][v.getValue]}else if(t)return c.getDataAtCell(t[0],t[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,n,r,o){i.alter(t,e,n,r,o)},this.getCell=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e,o=t;if(e>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(e)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(e)}if(t>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(t)))return null;o=this.rowIndexMapper.getRenderableFromVisualIndex(t)}return null===o||null===r?null:c.view.getCellAtCoords(c._createCellCoords(o,r),n)},this.getCoords=function(t){var e=this.view._wt.wtTable.getCoords(t);if(null===e)return null;var n=e.row,r=e.col,o=n,i=r;return n>=0&&(o=this.rowIndexMapper.getVisualFromRenderableIndex(n)),r>=0&&(i=this.columnIndexMapper.getVisualFromRenderableIndex(r)),c._createCellCoords(o,i)},this.colToProp=function(t){return r.colToProp(t)},this.propToCol=function(t){return r.propToCol(t)},this.toVisualRow=function(t){return l.rowIndexMapper.getVisualFromPhysicalIndex(t)},this.toVisualColumn=function(t){return l.columnIndexMapper.getVisualFromPhysicalIndex(t)},this.toPhysicalRow=function(t){return l.rowIndexMapper.getPhysicalFromVisualIndex(t)},this.toPhysicalColumn=function(t){return l.columnIndexMapper.getPhysicalFromVisualIndex(t)},this.getDataAtCell=function(t,e){return r.get(t,r.colToProp(e))},this.getDataAtRowProp=function(t,e){return r.get(t,e)},this.getDataAtCol=function(t){for(var e=[],n=r.getRange(c._createCellCoords(0,t),c._createCellCoords(v.data.length-1,t),r.DESTINATION_RENDERER),o=0;o<n.length;o+=1)for(var i=0;i<n[o].length;i+=1)e.push(n[o][i]);return e},this.getDataAtProp=function(t){for(var e=[],n=r.getRange(c._createCellCoords(0,r.propToCol(t)),c._createCellCoords(v.data.length-1,r.propToCol(t)),r.DESTINATION_RENDERER),o=0;o<n.length;o+=1)for(var i=0;i<n[o].length;i+=1)e.push(n[o][i]);return e},this.getSourceData=function(t,e,n,r){var i;return i=void 0===t?o.getData():o.getByRange(c._createCellCoords(t,e),c._createCellCoords(n,r)),i},this.getSourceDataArray=function(t,e,n,r){var i;return i=void 0===t?o.getData(!0):o.getByRange(c._createCellCoords(t,e),c._createCellCoords(n,r),!0),i},this.getSourceDataAtCol=function(t){return o.getAtColumn(t)},this.setSourceDataAtCell=function(t,e,n,r){var i=j(t,e,n),a=this.hasHook("afterSetSourceDataAtCell"),l=[];a&&U(i,(function(t){var e=AT(t,3),n=e[0],r=e[1],i=e[2];l.push([n,r,o.getAtCell(n,r),i])})),U(i,(function(t){var e=AT(t,3),n=e[0],r=e[1],i=e[2];o.setAtCell(n,r,i)})),a&&this.runHooks("afterSetSourceDataAtCell",l,r),this.render();var s=c.getActiveEditor();s&&Zt(s.refreshValue)&&s.refreshValue()},this.getSourceDataAtRow=function(t){return o.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return o.getAtCell(t,e)},this.getDataAtRow=function(t){var e=r.getRange(c._createCellCoords(t,0),c._createCellCoords(t,this.countCols()-1),r.DESTINATION_RENDERER);return e[0]||[]},this.getDataType=function(t,e,n,r){var o=this,i=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,n,r],a=i[0],l=i[1],s=i[2],u=i[3],c=null,f=null;void 0===s&&(s=a),void 0===u&&(u=l);var h="mixed";return Io(Math.max(Math.min(a,s),0),Math.max(a,s),(function(t){var e=!0;return Io(Math.max(Math.min(l,u),0),Math.max(l,u),(function(n){var r=o.getCellMeta(t,n);return f=r.type,c?e=c===f:c=f,e})),h=e?f:"mixed",e})),h},this.removeCellMeta=function(t,e,n){var r=[this.toPhysicalRow(t),this.toPhysicalColumn(e)],o=r[0],i=r[1],a=y.getCellMetaKeyValue(o,i,n),l=c.runHooks("beforeRemoveCellMeta",t,e,n,a);!1!==l&&(y.removeCellMeta(o,i,n),c.runHooks("afterRemoveCellMeta",t,e,n,a)),a=null},this.spliceCellsMeta=function(t){for(var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];if(o.length>0&&!Array.isArray(o[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");n>0&&y.removeRow(this.toPhysicalRow(t),n),o.length>0&&U(o.reverse(),(function(n){y.createRow(e.toPhysicalRow(t)),U(n,(function(n,r){return e.setCellMetaObject(t,r,n)}))})),c.render()},this.setCellMetaObject=function(t,e,n){var r=this;"object"===TT(n)&&pt(n,(function(n,o){r.setCellMeta(t,e,o,n)}))},this.setCellMeta=function(t,e,n,r){var o=c.runHooks("beforeSetCellMeta",t,e,n,r);if(!1!==o){var i=t,a=e;t<this.countRows()&&(i=this.toPhysicalRow(t)),e<this.countCols()&&(a=this.toPhysicalColumn(e)),y.setCellMeta(i,a,n,r),c.runHooks("afterSetCellMeta",t,e,n,r)}},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(t,e){var n=this.toPhysicalRow(t),r=this.toPhysicalColumn(e);return null===n&&(n=t),null===r&&(r=e),y.getCellMeta(n,r,{visualRow:t,visualColumn:e})},this.getCellMetaAtRow=function(t){return y.getCellsMetaAtRow(t)},this.isColumnModificationAllowed=function(){return!("object"===c.dataType||v.columns)},this.getCellRenderer=function(t,e){var n="number"===typeof t?c.getCellMeta(t,e).renderer:t.renderer;return"string"===typeof n?zi(n):te(n)?zi("text"):n},this.getCellEditor=function(t,e){var n="number"===typeof t?c.getCellMeta(t,e).editor:t.editor;return"string"===typeof n?_r(n):te(n)?_r("text"):n},this.getCellValidator=function(t,e){var n="number"===typeof t?c.getCellMeta(t,e).validator:t.validator;return"string"===typeof n?Qi(n):n},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,n){var r=new R;t&&(r.onQueueEmpty=t);var o=c.countRows()-1;while(o>=0)if(void 0===e||-1!==e.indexOf(o)){var i=c.countCols()-1;while(i>=0)void 0===n||-1!==n.indexOf(i)?(r.addValidatorToQueue(),c.validateCell(c.getDataAtCell(o,i),c.getCellMeta(o,i),(function(t){if("boolean"!==typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(r.valid=!1),r.removeValidatorFormQueue()}),"validateCells"),i-=1):i-=1;o-=1}else o-=1;r.checkIfQueueIsEmpty()},this.getRowHeader=function(t){var e=v.rowHeaders,n=t;return void 0!==n&&(n=c.runHooks("modifyRowHeader",n)),void 0===n?(e=[],Io(c.countRows()-1,(function(t){e.push(c.getRowHeader(t))}))):Array.isArray(e)&&void 0!==e[n]?e=e[n]:_n(e)?e=e(n):e&&"string"!==typeof e&&"number"!==typeof e&&(e=n+1),e},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(void 0!==v.colHeaders&&null!==v.colHeaders)return!!v.colHeaders;for(var t=0,e=c.countCols();t<e;t++)if(c.getColHeader(t))return!0;return!1},this.getColHeader=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=c.runHooks("modifyColHeader",t);if(void 0===n){for(var r=[],o=c.countCols(),i=0;i<o;i++)r.push(c.getColHeader(i));return r}var a=v.colHeaders,l=function(t){for(var e=[],n=c.countCols(),r=0;r<n;r++)_n(v.columns)&&v.columns(r)&&e.push(r);return e[t]},s=c.toPhysicalColumn(n),u=l(s);return!1===v.colHeaders?a=null:v.columns&&_n(v.columns)&&v.columns(u)&&v.columns(u).title?a=v.columns(u).title:v.columns&&v.columns[s]&&v.columns[s].title?a=v.columns[s].title:Array.isArray(v.colHeaders)&&void 0!==v.colHeaders[s]?a=v.colHeaders[s]:_n(v.colHeaders)?a=v.colHeaders(s):v.colHeaders&&"string"!==typeof v.colHeaders&&"number"!==typeof v.colHeaders&&(a=Mv(n)),a=c.runHooks("modifyColumnHeaderValue",a,t,e),a},this._getColWidthFromSettings=function(t){var e;if(t>=0){var n=c.getCellMeta(0,t);e=n.width}if(void 0!==e&&e!==v.width||(e=v.colWidths),void 0!==e&&null!==e){switch(TT(e)){case"object":e=e[t];break;case"function":e=e(t);break;default:break}"string"===typeof e&&(e=parseInt(e,10))}return e},this.getColWidth=function(t){var e=c._getColWidthFromSettings(t);return e=c.runHooks("modifyColWidth",e,t),void 0===e&&(e=py.DEFAULT_WIDTH),e},this._getRowHeightFromSettings=function(t){var e=v.rowHeights;if(void 0!==e&&null!==e){switch(TT(e)){case"object":e=e[t];break;case"function":e=e(t);break;default:break}"string"===typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){var e=c._getRowHeightFromSettings(t);return e=c.runHooks("modifyRowHeight",e,t),e},this.countSourceRows=function(){return o.countRows()},this.countSourceCols=function(){return o.countFirstRowKeys()},this.countRows=function(){return r.getLength()},this.countCols=function(){var t=v.maxCols,e=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(t,e)},this.countRenderedRows=function(){return c.view._wt.drawn?c.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return c.view._wt.drawn?c.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return c.view._wt.drawn?c.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return c.view._wt.drawn?c.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return xo(c.countRows()-1,(function(n){if(c.isEmptyRow(n))e+=1;else if(!0===t)return!1})),e},this.countEmptyCols=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return xo(c.countCols()-1,(function(n){if(c.isEmptyCol(n))e+=1;else if(!0===t)return!1})),e},this.isEmptyRow=function(t){return v.isEmptyRow.call(c,t)},this.isEmptyCol=function(t){return v.isEmptyCol.call(c,t)},this.selectCell=function(t,e,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!te(t)&&!te(e)&&this.selectCells([[t,e,n,r]],o,i)},this.selectCells=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===e&&(u=!0);var r=S.selectCells(t);return r&&n&&c.listen(),u=!1,r},this.selectColumns=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return S.selectColumns(t,e)},this.selectRows=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return S.selectRows(t,e)},this.deselectCell=function(){S.deselect()},this.selectAll=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=t&&this.hasRowHeaders(),n=t&&this.hasColHeaders();u=!0,S.selectAll(e,n),u=!1};var A=function(t,e){return t.getNearestNotHiddenIndex(e,1,!0)};function M(t){return function(){throw new Error('The "'.concat(t,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.scrollViewportTo=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!n,a=!r,l=t,s=e;if(o){var u=Number.isInteger(t),f=Number.isInteger(e),h=u?A(this.rowIndexMapper,t):void 0,d=f?A(this.columnIndexMapper,e):void 0;if(null===h||null===d)return!1;l=u?c.rowIndexMapper.getRenderableFromVisualIndex(h):void 0,s=f?c.columnIndexMapper.getRenderableFromVisualIndex(d):void 0}var p=Number.isInteger(l),y=Number.isInteger(s);return p&&y?c.view.scrollViewport(c._createCellCoords(l,s),i,r,n,a):p&&!1===y?c.view.scrollViewportVertically(l,i,n):!(!y||!1!==p)&&c.view.scrollViewportHorizontally(s,r,a)},this.destroy=function(){if(c._clearTimeouts(),c._clearImmediates(),c.view&&c.view.destroy(),o&&o.destroy(),o=null,this.getShortcutManager().destroy(),y.clearCache(),Jy(c)){var t=this.rootDocument.querySelector(".hot-display-license-info");t&&t.parentNode.removeChild(t)}Xe(c.rootElement),f.destroy(),a&&a.destroy(),c.batchExecution((function(){c.rowIndexMapper.unregisterAll(),c.columnIndexMapper.unregisterAll(),g.getItems().forEach((function(t){var e=AT(t,2),n=e[1];n.destroy()})),g.clear(),c.runHooks("afterDestroy")}),!0),mr.getSingleton().destroy(c),pt(c,(function(t,e,n){_n(t)?n[e]=M(e):"guid"!==e&&(n[e]=null)})),c.isDestroyed=!0,r&&r.destroy(),r=null,i=null,S=null,a=null,c=null},this.getActiveEditor=function(){return a.getActiveEditor()},this.getPlugin=function(t){var e=be(t);return"UndoRedo"===e?this.undoRedo:g.getItem(e)},this.getPluginName=function(t){return t===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:g.getId(t)},this.getInstance=function(){return c},this.addHook=function(t,e){mr.getSingleton().add(t,e,c)},this.hasHook=function(t){return mr.getSingleton().has(t,c)||mr.getSingleton().has(t)},this.addHookOnce=function(t,e){mr.getSingleton().once(t,e,c)},this.removeHook=function(t,e){mr.getSingleton().remove(t,e,c)},this.runHooks=function(t,e,n,r,o,i,a){return mr.getSingleton().run(c,t,e,n,r,o,i,a)},this.getTranslatedPhrase=function(t,e){return SC(v.language,t,e)},this.toHTML=function(){return wo(l)},this.toTableElement=function(){var t=l.rootDocument.createElement("div");return t.insertAdjacentHTML("afterbegin",wo(l)),t.firstElementChild},this.timeouts=[],this._registerTimeout=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t;"function"===typeof n&&(n=setTimeout(n,e)),this.timeouts.push(n)},this._clearTimeouts=function(){U(this.timeouts,(function(t){clearTimeout(t)}))},this.immediates=[],this._registerImmediate=function(t){this.immediates.push(setImmediate(t))},this._clearImmediates=function(){U(this.immediates,(function(t){clearImmediate(t)}))},this._refreshBorders=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];a.destroyEditor(t),c.view.render(),e&&S.isSelected()&&a.prepareEditor()},this.isRtl=function(){return"rtl"===c.rootWindow.getComputedStyle(c.rootElement).direction},this.isLtr=function(){return!c.isRtl()},this.getDirectionFactor=function(){return c.isLtr()?1:-1};var I=PT({handleEvent:function(t){var e=c.isListening(),n=void 0!==(null===t||void 0===t?void 0:t.key);return e&&n},beforeKeyDown:function(t){return l.runHooks("beforeKeyDown",t)},afterKeyDown:function(t){l.isDestroyed||c.runHooks("afterDocumentKeyDown",t)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",(function(t){!1===t.ctrlKey&&!1===t.metaKey&&I.releasePressedKeys()})),this.getShortcutManager=function(){return I};var x=I.addContext("grid"),_={runOnlyIf:function(){return Zt(c.getSelected())&&c.countRenderedRows()>0&&c.countRenderedCols()>0},group:VT};I.setActiveContextName("grid"),x.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){c.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var t=c.getSelectedRange(),e=t[t.length-1].highlight,n=e.row,r=e.col,o=c.getDataAtCell(n,r),i=new Map,a=0;a<t.length;a++)t[a].forAll((function(t,e){if(t>=0&&e>=0&&(t!==n||e!==r)){var a=c.getCellMeta(t,e),l=a.readOnly;l||i.set("".concat(t,"x").concat(e),[t,e,o])}}));c.setDataAtCell(Array.from(i.values()))},runOnlyIf:function(){return c.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){S.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){S.setRangeStart(c._createCellCoords(c.rowIndexMapper.getNearestNotHiddenIndex(0,1),c.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){S.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var t=c.getSelectedRangeLast(),e=t.from,n=t.to,r=c.rowIndexMapper.getNearestNotHiddenIndex(0,1);S.setRangeStart(e.clone()),S.setRangeEnd(c._createCellCoords(r,n.col))},runOnlyIf:function(){return!(c.selection.isSelectedByCorner()||c.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){S.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){S.setRangeStart(c._createCellCoords(c.rowIndexMapper.getNearestNotHiddenIndex(c.countRows()-1,-1),c.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){S.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var t=c.getSelectedRangeLast(),e=t.from,n=t.to,r=c.rowIndexMapper.getNearestNotHiddenIndex(c.countRows()-1,-1);S.setRangeStart(e.clone()),S.setRangeEnd(c._createCellCoords(r,n.col))},runOnlyIf:function(){return!(c.selection.isSelectedByCorner()||c.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){S.transformStart(0,-1*c.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var t,e=c.getSelectedRangeLast().highlight.row,n=(t=c.columnIndexMapper).getNearestNotHiddenIndex.apply(t,_T(c.isRtl()?[c.countCols()-1,-1]:[0,1]));S.setRangeStart(c._createCellCoords(e,n))}},{keys:[["ArrowLeft","Shift"]],callback:function(){S.transformEnd(0,-1*c.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var t,e=c.getSelectedRangeLast(),n=e.from,r=e.to,o=(t=c.columnIndexMapper).getNearestNotHiddenIndex.apply(t,_T(c.isRtl()?[c.countCols()-1,-1]:[0,1]));S.setRangeStart(n.clone()),S.setRangeEnd(c._createCellCoords(r.row,o))},runOnlyIf:function(){return!(c.selection.isSelectedByCorner()||c.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){S.transformStart(0,c.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var t,e=c.getSelectedRangeLast().highlight.row,n=(t=c.columnIndexMapper).getNearestNotHiddenIndex.apply(t,_T(c.isRtl()?[0,1]:[c.countCols()-1,-1]));S.setRangeStart(c._createCellCoords(e,n))}},{keys:[["ArrowRight","Shift"]],callback:function(){S.transformEnd(0,c.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var t,e=c.getSelectedRangeLast(),n=e.from,r=e.to,o=(t=c.columnIndexMapper).getNearestNotHiddenIndex.apply(t,_T(c.isRtl()?[0,1]:[c.countCols()-1,-1]));S.setRangeStart(n.clone()),S.setRangeEnd(c._createCellCoords(r.row,o))},runOnlyIf:function(){return!(c.selection.isSelectedByCorner()||c.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var t=parseInt(c.getSettings().fixedColumnsStart,10),e=c.getSelectedRangeLast().highlight.row,n=c.columnIndexMapper.getNearestNotHiddenIndex(t,1);S.setRangeStart(c._createCellCoords(e,n))},runOnlyIf:function(){return c.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){S.setRangeEnd(c._createCellCoords(S.selectedRange.current().from.row,c.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var t=parseInt(c.getSettings().fixedRowsTop,10),e=parseInt(c.getSettings().fixedColumnsStart,10),n=c.rowIndexMapper.getNearestNotHiddenIndex(t,1),r=c.columnIndexMapper.getNearestNotHiddenIndex(e,1);S.setRangeStart(c._createCellCoords(n,r))},runOnlyIf:function(){return c.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){S.setRangeStart(c._createCellCoords(c.getSelectedRangeLast().highlight.row,c.columnIndexMapper.getNearestNotHiddenIndex(c.countCols()-1,-1)))},runOnlyIf:function(){return c.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){S.setRangeEnd(c._createCellCoords(S.selectedRange.current().from.row,c.columnIndexMapper.getNearestNotHiddenIndex(c.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var t=parseInt(c.getSettings().fixedRowsBottom,10),e=c.rowIndexMapper.getNearestNotHiddenIndex(c.countRows()-t-1,-1),n=c.columnIndexMapper.getNearestNotHiddenIndex(c.countCols()-1,-1);S.setRangeStart(c._createCellCoords(e,n))},runOnlyIf:function(){return c.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){S.transformStart(-c.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var t=c.getSelectedRangeLast(),e=t.to,n=Math.max(e.row-c.countVisibleRows(),0),r=c.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(null!==r){var o=c._createCellCoords(r,e.col),i=e.row-c.view.getFirstFullyVisibleRow(),a=Math.max(o.row-i,0);S.setRangeEnd(o),c.scrollViewportTo(a)}}},{keys:[["PageDown"]],callback:function(){S.transformStart(c.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var t=c.getSelectedRangeLast(),e=t.to,n=Math.min(e.row+c.countVisibleRows(),c.countRows()-1),r=c.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(null!==r){var o=c._createCellCoords(r,e.col),i=e.row-c.view.getFirstFullyVisibleRow(),a=Math.min(o.row-i,c.countRows()-1);S.setRangeEnd(o),c.scrollViewportTo(a)}}},{keys:[["Tab"]],callback:function(t){var e="function"===typeof v.tabMoves?v.tabMoves(t):v.tabMoves;S.transformStart(e.row,e.col,!0)}},{keys:[["Shift","Tab"]],callback:function(t){var e="function"===typeof v.tabMoves?v.tabMoves(t):v.tabMoves;S.transformStart(-e.row,-e.col)}}],_),xi().forEach((function(t){var e=_i(t);g.addItem(t,new e(l))})),mr.getSingleton().run(c,"construct")}var zT="hooksRefRegisterer",GT={_hooksStorage:Object.create(null),addHook:function(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey:function(t){var e=this;U(this._hooksStorage[t]||[],(function(n){e.hot.removeHook(t,n)}))},clearHooks:function(){var t=this;pt(this._hooksStorage,(function(e,n){return t.removeHooksByKey(n)})),this._hooksStorage={}}};dt(GT,"MIXIN_NAME",zT,{writable:!1,enumerable:!1});var YT=GT;function KT(t){return KT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},KT(t)}function XT(t,e){return ZT(t)||JT(t,e)||qT(t,e)||$T()}function $T(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function qT(t,e){if(t){if("string"===typeof t)return QT(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?QT(t,e):void 0}}function QT(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function JT(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ZT(t){if(Array.isArray(t))return t}function tj(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ej(t,e)}function ej(t,e){return ej=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ej(t,e)}function nj(t){var e=ij();return function(){var n,r=aj(t);if(e){var o=aj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rj(this,n)}}function rj(t,e){if(e&&("object"===KT(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return oj(t)}function oj(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ij(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function aj(t){return aj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},aj(t)}function lj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sj(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,cj(r.key),r)}}function uj(t,e,n){return e&&sj(t.prototype,e),n&&sj(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function cj(t){var e=fj(t,"string");return"symbol"===KT(e)?e:String(e)}function fj(t,e){if("object"!==KT(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==KT(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var hj="base",dj=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),pj="baseEditor",yj=function(){function t(e){lj(this,t),this.hot=e,this.instance=e,this.state=dj.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return uj(t,[{key:"_fireCallbacks",value:function(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(t,e,n,r,o,i){this.TD=r,this.row=t,this.col=e,this.prop=n,this.originalValue=o,this.cellProperties=i,this.state=dj.VIRGIN}},{key:"extend",value:function(){return function(t){tj(n,t);var e=nj(n);function n(){return lj(this,n),e.apply(this,arguments)}return uj(n)}(this.constructor)}},{key:"saveValue",value:function(t,e){var n,r,o,i,a=this;if(e){var l=this.hot.getSelectedLast();n=Math.max(Math.min(l[0],l[2]),0),r=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),i=Math.max(l[1],l[3])}else{var s=[this.row,this.col,null,null];n=s[0],r=s[1],o=s[2],i=s[3]}var u=this.hot.runHooks("modifyGetCellCoords",n,r);if(Array.isArray(u)){var c=XT(u,2);n=c[0],r=c[1]}var f=this.hot.getShortcutManager(),h=f.getContext("editor"),d={runOnlyIf:function(){return Zt(a.hot.getSelected())},group:pj};this.isInFullEditMode()&&h.addShortcuts([{keys:[["ArrowUp"]],callback:function(){a.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){a.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){a.hot.selection.transformStart(0,-1*a.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){a.hot.selection.transformStart(0,a.hot.getDirectionFactor())}}],d),this.hot.populateFromArray(n,r,t,o,i,"edit")}},{key:"beginEditing",value:function(t,e){if(this.state===dj.VIRGIN){var n=this.hot,r=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(r,o)),this.state=dj.EDITING,this.isInFullEditMode()){var i="string"===typeof t?t:Jt(this.originalValue);this.setValue(i)}this.open(e),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(t,e,n){var r,o=this;if(n){var i=this._closeCallback;this._closeCallback=function(t){i&&i(t),n(t),o.hot.view.render()}}if(!this.isWaiting()){var a=this.hot.getShortcutManager(),l=a.getContext("editor");if(l.removeShortcutsByGroup(pj),l.removeShortcutsByGroup(io),this.state!==dj.VIRGIN){if(this.state===dj.EDITING){if(t)return this.cancelChanges(),void this.hot.view.render();var s=this.getValue();r=this.cellProperties.trimWhitespace?[["string"===typeof s?String.prototype.trim.call(s||""):s]]:[[s]],this.state=dj.WAITING,this.saveValue(r,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(function(t){o.state=dj.FINISHED,o.discardEditor(t)})):(this.state=dj.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((function(){o._fireCallbacks(!0)}))}}},{key:"cancelChanges",value:function(){this.state=dj.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(t){if(this.state===dj.FINISHED)if(!1===t&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=dj.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=dj.VIRGIN,this._fireCallbacks(!0);var e=this.hot.getShortcutManager();e.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===dj.WAITING}},{key:"getEditedCellRect",value:function(){var t,e=this.getEditedCell();if(e){var n=this.hot.view._wt,r=n.wtOverlays,o=n.wtViewport,i=this.hot.rootWindow,a=tn(e),l=fn(e),s=tn(this.hot.rootElement),u=fn(this.hot.rootElement),c=r.topOverlay.holder,f=r.inlineStartOverlay.holder,h=c!==i?c.scrollTop:0,d=f!==i?f.scrollLeft:0,p=i.innerWidth-s.left-u,y=null!==(t=r.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt,v=y.wtTable,m=v.name,g=["master","inline_start"].includes(m)?h:0,b=["master","top","bottom"].includes(m)?d:0,w=a.top===s.top?0:1,S=a.top-s.top-w-g,C=0;C=this.hot.isRtl()?i.innerWidth-a.left-l-p-1+b:a.left-s.left-1-b,["top","top_inline_start_corner"].includes(m)&&(S+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(C+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));var O=this.hot.hasColHeaders(),k=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),R=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),E=this.hot.rowIndexMapper.getRenderableIndexesLength(),P=E-this.hot.view._wt.getSetting("fixedRowsBottom");(O&&k<=0||k===P)&&(S+=1),R<=0&&(C+=1);var T=o.rowsRenderCalculator.startPosition,j=o.columnsRenderCalculator.startPosition,A=Math.abs(r.inlineStartOverlay.getScrollPosition()),M=r.topOverlay.getScrollPosition(),I=On(this.hot.rootDocument),x=e.offsetTop+T-M,_=0;if(this.hot.isRtl()){var H=e.offsetLeft;_=H>=0?v.getWidth()-e.offsetLeft:Math.abs(H),_+=j-A-l}else _=e.offsetLeft+j-A;var N=cn(this.TD,this.hot.rootWindow),D=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",L=parseInt(N[D],10)>0?0:1,B=parseInt(N.borderTopWidth,10)>0?0:1,V=fn(e)+L,F=hn(e)+B,W=kn(c)?I:0,U=Rn(f)?I:0,z=this.hot.view.maximumVisibleElementWidth(_)-W+L,G=Math.max(this.hot.view.maximumVisibleElementHeight(x)-U+B,23);return{top:S,start:C,height:F,maxHeight:G,width:V,maxWidth:z}}}},{key:"getEditedCellsLayerClass",value:function(){var t=this.checkEditorSection();switch(t){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var t=this.hot.countRows(),e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}],[{key:"EDITOR_TYPE",get:function(){return hj}}]),t}();function vj(){var t,e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=document.body,r=document.createTextNode(""),o=document.createElement("SPAN"),i=function(t,e,n){t.addEventListener(e,n,!1)},a=function(t,e,n){t.removeEventListener(e,n,!1)},l=function(i){var a,l;i?/^[a-zA-Z \.,\\\/\|0-9]$/.test(i)||(i="."):i="",void 0!==r.textContent?r.textContent=t.value+i:r.data=t.value+i,o.style.position="absolute",o.style.fontSize=f(t).fontSize,o.style.fontFamily=f(t).fontFamily,o.style.whiteSpace="pre",n.appendChild(o),a=o.clientWidth+2,n.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>a?t.style.width=e.minWidth+"px":a>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=a+"px",l=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>l?t.style.height=e.minHeight+"px":e.maxHeight<l?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=l+"px"},s=function(){window.setTimeout(l,0)},u=function(n){if(n&&n.minHeight)if("inherit"==n.minHeight)e.minHeight=t.clientHeight;else{var i=parseInt(n.minHeight);isNaN(i)||(e.minHeight=i)}if(n&&n.maxHeight)if("inherit"==n.maxHeight)e.maxHeight=t.clientHeight;else{var a=parseInt(n.maxHeight);isNaN(a)||(e.maxHeight=a)}if(n&&n.minWidth)if("inherit"==n.minWidth)e.minWidth=t.clientWidth;else{var l=parseInt(n.minWidth);isNaN(l)||(e.minWidth=l)}if(n&&n.maxWidth)if("inherit"==n.maxWidth)e.maxWidth=t.clientWidth;else{var s=parseInt(n.maxWidth);isNaN(s)||(e.maxWidth=s)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))},c=function(n,r,o){t=n,u(r),"TEXTAREA"==t.nodeName&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),o&&(i(t,"change",l),i(t,"cut",s),i(t,"paste",s),i(t,"drop",s),i(t,"keydown",s),i(t,"focus",l),i(t,"compositionstart",s),i(t,"compositionupdate",s),i(t,"compositionend",s)),l()};function f(t){return t.currentStyle||document.defaultView.getComputedStyle(t)}return{init:function(t,e,n){c(t,e,n)},unObserve:function(){a(t,"change",l),a(t,"cut",s),a(t,"paste",s),a(t,"drop",s),a(t,"keydown",s),a(t,"focus",l),a(t,"compositionstart",s),a(t,"compositionupdate",s),a(t,"compositionend",s)},resize:l}}function mj(t,e){for(var n=mn(e),r=e.value.split("\n"),o=n,i=0,a=0;a<r.length;a++){var l=r[a];0!==a&&(i+=r[a-1].length+1);var s=i+l.length;if("home"===t?o=i:"end"===t&&(o=s),n<=s)break}Sn(e,o)}function gj(t){return gj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gj(t)}function bj(t,e){return kj(t)||Oj(t,e)||Sj(t,e)||wj()}function wj(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Sj(t,e){if(t){if("string"===typeof t)return Cj(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cj(t,e):void 0}}function Cj(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Oj(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function kj(t){if(Array.isArray(t))return t}function Rj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ej(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Tj(r.key),r)}}function Pj(t,e,n){return e&&Ej(t.prototype,e),n&&Ej(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tj(t){var e=jj(t,"string");return"symbol"===gj(e)?e:String(e)}function jj(t,e){if("object"!==gj(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==gj(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Aj(){return Aj="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Mj(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Aj.apply(this,arguments)}function Mj(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Lj(t),null===t)break;return t}function Ij(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xj(t,e)}function xj(t,e){return xj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},xj(t,e)}function _j(t){var e=Dj();return function(){var n,r=Lj(t);if(e){var o=Lj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Hj(this,n)}}function Hj(t,e){if(e&&("object"===gj(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Nj(t)}function Nj(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Dj(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Lj(t){return Lj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Lj(t)}ct(yj,YT);var Bj="ht_editor_visible",Vj="ht_editor_hidden",Fj="textEditor",Wj="text",Uj=function(t){Ij(n,t);var e=_j(n);function n(t){var r;return Rj(this,n),r=e.call(this,t),r.eventManager=new Gr(Nj(r)),r.autoResize=vj(),r.TEXTAREA=void 0,r.textareaStyle=void 0,r.TEXTAREA_PARENT=void 0,r.textareaParentStyle=void 0,r.layerClass=void 0,r.createElements(),r.bindEvents(),r.hot.addHookOnce("afterDestroy",(function(){return r.destroy()})),r}return Pj(n,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(t){this.TEXTAREA.value=t}},{key:"open",value:function(){var t=this;this.refreshDimensions(),this.showEditableElement();var e=this.hot.getShortcutManager();e.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",(function(e){return t.onAfterDocumentKeyDown(e)})),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(t,e,r,o,i,a){var l=this.state;if(Aj(Lj(n.prototype),"prepare",this).call(this,t,e,r,o,i,a),!a.readOnly){this.refreshDimensions(!0);var s=a.allowInvalid,u=a.fragmentSelection;s&&(this.TEXTAREA.value=""),l!==dj.FINISHED&&this.hideEditableElement();var c=!u;c&&!Ht()&&this.focus()}}},{key:"beginEditing",value:function(t,e){this.state===dj.VIRGIN&&(this.TEXTAREA.value="",Aj(Lj(n.prototype),"beginEditing",this).call(this,t,e))}},{key:"focus",value:function(){this.TEXTAREA.select(),Sn(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var t=this.hot.rootDocument;this.TEXTAREA=t.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Ge(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),Ge(this.TEXTAREA_PARENT,"handsontableInputHolder"),ze(this.TEXTAREA_PARENT,this.layerClass)&&Ye(this.TEXTAREA_PARENT,this.layerClass),Ge(this.TEXTAREA_PARENT,Vj),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(It()||At())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ye(this.TEXTAREA_PARENT,this.layerClass),Ge(this.TEXTAREA_PARENT,Vj)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var t=this.TEXTAREA_PARENT.childNodes,e=!1;Io(t.length-1,(function(n){var r=t[n];if(ze(r,"handsontableEditor"))return e=!0,!1})),ze(this.TEXTAREA_PARENT,Vj)&&Ye(this.TEXTAREA_PARENT,Vj),e?(this.layerClass=Bj,Ge(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Ge(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===dj.EDITING||t)if(this.TD=this.getEditedCell(),this.TD){var e=this.getEditedCellRect(),n=e.top,r=e.start,o=e.width,i=e.maxWidth,a=e.height,l=e.maxHeight;this.textareaParentStyle.top="".concat(n,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(r,"px"),this.showEditableElement();var s=cn(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=s.fontSize,this.TEXTAREA.style.fontFamily=s.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var u=cn(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),f=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),h=o-c,d=a-f,p=i-c,y=l-f;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(h,p),minHeight:Math.min(d,y),maxWidth:p,maxHeight:y},!0)}else t||this.close()}},{key:"bindEvents",value:function(){var t=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",(function(t){return t.stopPropagation()})),this.eventManager.addEventListener(this.TEXTAREA,"paste",(function(t){return t.stopPropagation()})),Nt()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(function(){return t.finishEditing(!1)})),this.addHook("afterScrollHorizontally",(function(){return t.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return t.refreshDimensions()})),this.addHook("afterColumnResize",(function(){t.refreshDimensions(),t.focus()})),this.addHook("afterRowResize",(function(){t.refreshDimensions(),t.focus()}))}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var t=this,e=this.hot.getShortcutManager(),n=e.getContext("editor"),r={runOnlyIf:function(){return Zt(t.hot.getSelected())},group:Fj},o=function(){t.hot.rootDocument.execCommand("insertText",!1,"\n")};n.addShortcuts([{keys:[["Tab"]],callback:function(e){var n=t.hot.getSettings(),r="function"===typeof n.tabMoves?n.tabMoves(e):n.tabMoves;t.hot.selection.transformStart(r.row,r.col,!0)}},{keys:[["Shift","Tab"]],callback:function(e){var n=t.hot.getSettings(),r="function"===typeof n.tabMoves?n.tabMoves(e):n.tabMoves;t.hot.selection.transformStart(-r.row,-r.col)}},{keys:[["Control","Enter"]],callback:function(){return o(),!1},runOnlyIf:function(e){return!t.hot.selection.isMultiple()&&!e.altKey},relativeToGroup:ao,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return o(),!1},runOnlyIf:function(){return!t.hot.selection.isMultiple()},relativeToGroup:ao,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return o(),!1},relativeToGroup:ao,position:"before"},{keys:[["PageUp"]],callback:function(){t.hot.selection.transformStart(-t.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){t.hot.selection.transformStart(t.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(e,n){var r=bj(n,1),o=r[0];mj(o,t.TEXTAREA)}},{keys:[["End"]],callback:function(e,n){var r=bj(n,1),o=r[0];mj(o,t.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){t.hot._registerTimeout((function(){t.autoResize.resize()}),10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){t.hot._registerTimeout((function(){t.autoResize.resize()}),10)}}],r)}},{key:"unregisterShortcuts",value:function(){var t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(io),e.removeShortcutsByGroup(Fj),e.removeShortcutsByGroup(pj)}},{key:"onAfterDocumentKeyDown",value:function(t){var e=[Yn.ARROW_UP,Yn.ARROW_RIGHT,Yn.ARROW_DOWN,Yn.ARROW_LEFT];-1===e.indexOf(t.keyCode)&&this.autoResize.resize(String.fromCharCode(t.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return Wj}}]),n}(yj),zj="base";function Gj(t,e,n,r,o,i,a){var l=[],s=[];a.className&&Ge(e,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),!1===a.valid&&a.invalidCellClassName?l.push(a.invalidCellClassName):s.push(a.invalidCellClassName),!1===a.wordWrap&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!i&&a.placeholder&&l.push(a.placeholderCellClassName),Ye(e,s),Ge(e,l)}Gj.RENDERER_TYPE=zj;var Yj="text";function Kj(t,e,n,r,o,i,a){Gj.apply(this,[t,e,n,r,o,i,a]);var l=i;if(!l&&a.placeholder&&(l=a.placeholder),l=Jt(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){Xe(e);var s=t.rootDocument.createElement("TEMPLATE");s.setAttribute("bind","{{}}"),s.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=t.getSourceDataAtRow(n),e.appendChild(s)}else Je(e,l)}Kj.RENDERER_TYPE=Yj;var Xj="text",$j={CELL_TYPE:Xj,editor:Uj,renderer:Kj};function qj(t,e){var n=new UT(t,e||{},$y);return n.init(),n}uE($j),qj.editors={BaseEditor:yj},qj.Core=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new UT(t,e,$y)},qj.DefaultSettings=mE(),qj.hooks=mr.getSingleton(),qj.CellCoords=xc,qj.CellRange=qc,qj.packageName="handsontable",qj.buildDate="12/06/2023 09:29:21",qj.version="12.4.0",qj.languages={dictionaryKeys:v,getLanguageDictionary:gC,getLanguagesDictionaries:wC,registerLanguageDictionary:vC,getTranslatedPhrase:SC};var Qj=qj,Jj=n(1711);function Zj(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function tA(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zj(Object(n),!0).forEach((function(e){iA(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zj(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function eA(t){return eA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eA(t)}function nA(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rA(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pA(r.key),r)}}function oA(t,e,n){return e&&rA(t.prototype,e),n&&rA(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function iA(t,e,n){return e=pA(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aA(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sA(t,e)}function lA(t){return lA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lA(t)}function sA(t,e){return sA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},sA(t,e)}function uA(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function cA(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fA(t,e){if(e&&("object"===typeof e||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return cA(t)}function hA(t){var e=uA();return function(){var n,r=lA(t);if(e){var o=lA(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fA(this,n)}}function dA(t,e){if("object"!==typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function pA(t){var e=dA(t,"string");return"symbol"===typeof e?e:String(e)}var yA=Symbol("unassigned"),vA=null,mA="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function gA(t){t.hotInstance&&(t.hotInstance.addHook("beforeChange",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateCol",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveCol",(function(){t.__internalEdit=!0})))}function bA(t){var e=Qj.hooks.getRegistered(),n={};for(var r in Object.assign(n,Qj.DefaultSettings),n)n[r]={default:yA};for(var o=0;o<e.length;o++)n[e[o]]={default:yA};return n.settings={default:yA},"HotTable"===t&&(n.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},n.wrapperRendererCacheSize={type:Number,default:3e3}),n}function wA(t){var e={},n=t["settings"];if(n!==yA)for(var r in n)n.hasOwnProperty(r)&&n[r]!==yA&&(e[r]=n[r]);for(var o in t)t.hasOwnProperty(o)&&"settings"!==o&&t[o]!==yA&&(e[o]=t[o]);return e}function SA(t,e){var n=wA(t),r=t.settings?t.settings:n,o=t.settings?n:null,i={};for(var a in r)!r.hasOwnProperty(a)||void 0===r[a]||e&&"data"!==a&&RA(e[a],r[a])||(i[a]=r[a]);for(var l in o)!o.hasOwnProperty(l)||"id"===l||"settings"===l||"wrapperRendererCacheSize"===l||void 0===o[l]||e&&"data"!==l&&RA(e[l],o[l])||(i[l]=o[l]);return i}function CA(t,e){var n=null;return t.every((function(t,r){return!t.data||!t.data.attrs||void 0===t.data.attrs[e]||(n=t,!1)})),n}function OA(t){return t.filter((function(t){return"HotColumn"===t.$options.name}))}function kA(t,e,n,r){var o=e.$el?e.$el.ownerDocument:document,i={propsData:n,parent:e,data:r};vA||(vA=o.createElement("DIV"),vA.id="vueHotComponents",o.body.appendChild(vA));var a=o.createElement("DIV");return vA.appendChild(a),new t.componentOptions.Ctor(i).$mount(a)}function RA(t,e){return JSON.stringify(t)===JSON.stringify(e)}var EA="12.4.0";"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self&&self;function PA(t,e){return e={exports:{}},t(e,e.exports),e.exports}var TA=PA((function(t,e){(function(t,n){var r=e;n(r)})(0,(function(t){var e=Symbol("newer"),n=Symbol("older");function r(t,e){"number"!==typeof t&&(e=t,t=0),this.size=0,this.limit=t,this.oldest=this.newest=void 0,this._keymap=new Map,e&&(this.assign(e),t<1&&(this.limit=this.size))}function o(t,r){this.key=t,this.value=r,this[e]=void 0,this[n]=void 0}t.LRUMap=r,r.prototype._markEntryAsUsed=function(t){t!==this.newest&&(t[e]&&(t===this.oldest&&(this.oldest=t[e]),t[e][n]=t[n]),t[n]&&(t[n][e]=t[e]),t[e]=void 0,t[n]=this.newest,this.newest&&(this.newest[e]=t),this.newest=t)},r.prototype.assign=function(t){var r,i=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var a=t[Symbol.iterator](),l=a.next();!l.done;l=a.next()){var s=new o(l.value[0],l.value[1]);if(this._keymap.set(s.key,s),r?(r[e]=s,s[n]=r):this.oldest=s,r=s,0==i--)throw new Error("overflow")}this.newest=r,this.size=this._keymap.size},r.prototype.get=function(t){var e=this._keymap.get(t);if(e)return this._markEntryAsUsed(e),e.value},r.prototype.set=function(t,r){var i=this._keymap.get(t);return i?(i.value=r,this._markEntryAsUsed(i),this):(this._keymap.set(t,i=new o(t,r)),this.newest?(this.newest[e]=i,i[n]=this.newest):this.oldest=i,this.newest=i,++this.size,this.size>this.limit&&this.shift(),this)},r.prototype.shift=function(){var t=this.oldest;if(t)return this.oldest[e]?(this.oldest=this.oldest[e],this.oldest[n]=void 0):(this.oldest=void 0,this.newest=void 0),t[e]=t[n]=void 0,this._keymap["delete"](t.key),--this.size,[t.key,t.value]},r.prototype.has=function(t){return this._keymap.has(t)}}))})),jA=TA.LRUMap,AA={name:"HotTable",props:bA("HotTable"),watch:{mergedHotSettings:function(t){this.hotInstance&&void 0!==t&&(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var t=this,e=new jA(this.wrapperRendererCacheSize);return e.shift=function(){var t=jA.prototype.shift.call(this);return t[1].component.$destroy(),t},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:e,editorCache:new Map,get hotInstance(){return!t.__hotInstance||t.__hotInstance&&!t.__hotInstance.isDestroyed?t.__hotInstance:(console.warn(mA),null)},set hotInstance(e){t.__hotInstance=e}}},computed:{mergedHotSettings:function(){return SA(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var t=this.getGlobalRendererVNode(),e=this.getGlobalEditorVNode(),n=SA(this.$props);n.columns=this.columnSettings?this.columnSettings:n.columns,e&&(n.editor=this.getEditorClass(e,this),e.child.$destroy()),t&&(n.renderer=this.getRendererWrapper(t,this),t.child.$destroy()),this.hotInstance=new Qj.Core(this.$el,n),this.hotInstance.init(),gA(this),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var e,n=this.hotInstance.getSourceData(),r=[],o=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),a=this.hotInstance.isColumnModificationAllowed(),l=0;if(n&&n.length!==i&&n.length<i)for(var s=n.length;s<i;s++)r.push(s);if(a)if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&(null===(e=n[0])||void 0===e?void 0:e.length)!==l&&n[0].length<l)for(var u=n[0].length;u<l;u++)o.push(u);this.hotInstance.batch((function(){r.length>0?t.hotInstance.rowIndexMapper.removeIndexes(r):t.hotInstance.rowIndexMapper.insertIndexes(i-1,n.length-i),a&&0!==n.length&&(o.length>0?t.hotInstance.columnIndexMapper.removeIndexes(o):t.hotInstance.columnIndexMapper.insertIndexes(l-1,n[0].length-l))}))}},getGlobalRendererVNode:function(){var t=this.$slots["default"]||[];return CA(t,"hot-renderer")},getGlobalEditorVNode:function(){var t=this.$slots["default"]||[];return CA(t,"hot-editor")},getColumnSettings:function(){var t=OA(this.$children),e=!1,n=t.map((function(t){return t.usesRendererComponent&&(e=!0),tA({},t.columnSettings)}));return e&&this.settings&&(!1!==this.settings.autoColumnSize||this.settings.autoRowSize)&&(!1!==this.autoColumnSize||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),n.length?n:void 0},getRendererWrapper:function(t,e){var n=this;return function(r,o,i,a,l,s,u){if(o&&!o.getAttribute("ghost-table")){var c=n.rendererCache,f={hotInstance:r,TD:o,row:i,col:a,prop:l,value:s,cellProperties:u,isRenderer:!0};if(c&&!c.has("".concat(i,"-").concat(a))){var h=kA(t,e,t.componentOptions.propsData,f);c.set("".concat(i,"-").concat(a),{component:h,lastUsedTD:null})}var d=c.get("".concat(i,"-").concat(a)),p=d.component,y=d.lastUsedTD;if(Object.assign(p.$data,f),!p.$el.parentElement||y!==o){while(o.firstChild)o.removeChild(o.firstChild);o.appendChild(p.$el),d.lastUsedTD=o}}return o}},getEditorClass:function(t,e){var n=t.key?t.key.toString():null,r=t.componentOptions.Ctor.options.name,o=n?"".concat(r,":").concat(n):r,i=this.editorCache,a=null;return i.has(o)?a=i.get(o):(a=kA(t,e,t.componentOptions.propsData,{isEditor:!0}),i.set(o,a)),a.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:EA};function MA(t,e,n,r,o,i,a,l,s,u){"boolean"!==typeof a&&(s=l,l=a,a=!1);const c="function"===typeof n?n.options:n;let f;if(t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,o&&(c.functional=!0)),r&&(c._scopeId=r),i?(f=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,s(t)),t&&t._registeredComponents&&t._registeredComponents.add(i)},c._ssrRegister=f):e&&(f=a?function(t){e.call(this,u(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,l(t))}),f)if(c.functional){const t=c.render;c.render=function(e,n){return f.call(n),t(e,n)}}else{const t=c.beforeCreate;c.beforeCreate=t?[].concat(t,f):[f]}return n}var IA=AA,xA=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:t.id}},[t._t("default")],2)},_A=[],HA=void 0,NA=void 0,DA=void 0,LA=!1,BA=MA({render:xA,staticRenderFns:_A},HA,IA,NA,LA,DA,!1,void 0,void 0,void 0);bA("HotColumn");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function VA(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}function FA(t){return FA="function"===typeof Symbol&&"symbol"===eA(Symbol.iterator)?function(t){return eA(t)}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":eA(t)},FA(t)}function WA(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UA(t){return zA(t)||GA(t)||YA()}function zA(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function GA(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function YA(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function KA(){return"undefined"!==typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function XA(t,e){$A(t,e),Object.getOwnPropertyNames(e.prototype).forEach((function(n){$A(t.prototype,e.prototype,n)})),Object.getOwnPropertyNames(e).forEach((function(n){$A(t,e,n)}))}function $A(t,e,n){var r=n?Reflect.getOwnMetadataKeys(e,n):Reflect.getOwnMetadataKeys(e);r.forEach((function(r){var o=n?Reflect.getOwnMetadata(r,e,n):Reflect.getOwnMetadata(r,e);n?Reflect.defineMetadata(r,o,t,n):Reflect.defineMetadata(r,o,t)}))}var qA={__proto__:[]},QA=qA instanceof Array;function JA(t){var e=FA(t);return null==t||"object"!==e&&"function"!==e}function ZA(t,e){var n=e.prototype._init;e.prototype._init=function(){var e=this,n=Object.getOwnPropertyNames(t);if(t.$options.props)for(var r in t.$options.props)t.hasOwnProperty(r)||n.push(r);n.forEach((function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){t[n]=e},configurable:!0})}))};var r=new e;e.prototype._init=n;var o={};return Object.keys(r).forEach((function(t){void 0!==r[t]&&(o[t]=r[t])})),o}var tM=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function eM(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.name=e.name||t._componentTag||t.name;var n=t.prototype;Object.getOwnPropertyNames(n).forEach((function(t){if("constructor"!==t)if(tM.indexOf(t)>-1)e[t]=n[t];else{var r=Object.getOwnPropertyDescriptor(n,t);void 0!==r.value?"function"===typeof r.value?(e.methods||(e.methods={}))[t]=r.value:(e.mixins||(e.mixins=[])).push({data:function(){return WA({},t,r.value)}}):(r.get||r.set)&&((e.computed||(e.computed={}))[t]={get:r.get,set:r.set})}})),(e.mixins||(e.mixins=[])).push({data:function(){return ZA(this,t)}});var r=t.__decorators__;r&&(r.forEach((function(t){return t(e)})),delete t.__decorators__);var o=Object.getPrototypeOf(t.prototype),i=o instanceof Jj.Z?o.constructor:Jj.Z,a=i.extend(e);return rM(a,t,i),KA()&&XA(a,t),a}var nM={prototype:!0,arguments:!0,callee:!0,caller:!0};function rM(t,e,n){Object.getOwnPropertyNames(e).forEach((function(r){if(!nM[r]){var o=Object.getOwnPropertyDescriptor(t,r);if(!o||o.configurable){var i=Object.getOwnPropertyDescriptor(e,r);if(!QA){if("cid"===r)return;var a=Object.getOwnPropertyDescriptor(n,r);if(!JA(i.value)&&a&&a.value===i.value)return}Object.defineProperty(t,r,i)}}}))}function oM(t){return"function"===typeof t?eM(t):function(e){return eM(e,t)}}oM.registerHooks=function(t){tM.push.apply(tM,UA(t))};var iM=function(t){aA(n,t);var e=hA(n);function n(){var t;return nA(this,n),t=e.apply(this,arguments),t.name="BaseEditorComponent",t.instance=null,t.row=null,t.col=null,t.prop=null,t.TD=null,t.originalValue=null,t.cellProperties=null,t.state=null,t.hot=null,t}return oA(n,[{key:"mounted",value:function(){var t=this;this.$data.hotCustomEditorClass=function(){var e=function(e){aA(r,e);var n=hA(r);function r(e){var o;return nA(this,r),o=n.call(this,e),t.$data.hotCustomEditorInstance=cA(o),o}return oA(r,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),r}(Qj.editors.BaseEditor);return Object.getOwnPropertyNames(Qj.editors.BaseEditor.prototype).forEach((function(n){"constructor"!==n&&(e.prototype[n]=function(){for(var e,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t[n]).call.apply(e,[this].concat(o))})})),e}()}},{key:"_fireCallbacks",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=Qj.editors.BaseEditor.prototype._fireCallbacks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"beginEditing",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.beginEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"cancelChanges",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.cancelChanges).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"checkEditorSection",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.checkEditorSection).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"close",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.close).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"discardEditor",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.discardEditor).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"enableFullEditMode",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.enableFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"extend",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.extend).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"finishEditing",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.finishEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"focus",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.focus).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getValue",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.getValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"init",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.init).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isInFullEditMode",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.isInFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isOpened",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.isOpened).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isWaiting",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.isWaiting).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"open",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.open).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"prepare",value:function(t,e,n,r,o,i){return this.$data.hotInstance=i.instance,this.$data.row=t,this.$data.col=e,this.$data.prop=n,this.$data.TD=r,this.$data.originalValue=o,this.$data.cellProperties=i,Qj.editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,t,e,n,r,o,i)}},{key:"saveValue",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.saveValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"setValue",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.setValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"addHook",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.addHook).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"removeHooksByKey",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.removeHooksByKey).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"clearHooks",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.clearHooks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCell",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.getEditedCell).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellRect",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.getEditedCellRect).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsZIndex",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsLayerClass",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Qj.editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}}]),n}(Jj.Z);iM=VA([oM({})],iM);var aM=[[!1,"Tagcat","United Kingdom","Classic Vest","11/10/2020","01-2331942",!0,"172",2,2],[!0,"Zoomzone","Indonesia","Cycling Cap","03/05/2020","88-2768633",!0,"188",6,2],[!0,"Meeveo","United States","Full-Finger Gloves","27/03/2020","51-6775945",!0,"162",1,3],[!1,"Buzzdog","Philippines","HL Mountain Frame","29/08/2020","44-4028109",!0,"133",7,1],[!0,"Katz","India","Half-Finger Gloves","02/10/2020","08-2758492",!0,"87",1,3],[!1,"Jaxbean","China","HL Road Frame","28/09/2020","84-3557705",!1,"26",8,1],[!1,"Wikido","Brazil","HL Touring Frame","24/06/2020","20-9397637",!1,"110",4,1],[!1,"Browsedrive","United States","LL Mountain Frame","13/03/2020","36-0079556",!0,"50",4,4],[!1,"Twinder","United Kingdom","LL Road Frame","06/04/2020","41-1489542",!1,"160",6,1],[!1,"Jetwire","China","LL Touring Frame","01/02/2020","37-1531629",!0,"30",8,5],[!1,"Chatterpoint","China","Long-Sleeve Logo Jersey","14/07/2020","25-5083429",!0,"39",7,2],[!1,"Twinder","Egypt","Men's Bib-Shorts","31/08/2020","04-4281278",!1,"96",6,1],[!1,"Midel","United States","Men's Sports Shorts","27/06/2020","55-1711908",!0,"108",10,3],[!1,"Yodo","India","ML Mountain Frame","16/03/2020","58-8360815",!1,"46",1,1],[!1,"Camido","Russia","ML Mountain Frame-W","13/09/2020","10-3786104",!0,"97",8,3],[!1,"Eire","Thailand","ML Road Frame","10/04/2020","45-1186054",!0,"161",1,4],[!1,"Vinte","United Kingdom","ML Road Frame-W","22/01/2020","62-6202742",!0,"58",4,3],[!1,"Twitterlist","China","Mountain Bike Socks","09/11/2020","88-9646223",!0,"92",8,3],[!1,"Eidel","Bangladesh","Mountain-100","19/09/2020","45-5588112",!0,"5",6,5],[!1,"Trunyx","Nigeria","Mountain-200","09/03/2020","66-6271819",!0,"158",4,1],[!1,"Katz","Turkey","Mountain-300","05/03/2020","38-9245023",!1,"121",5,4],[!1,"Kaymbo","United States","Mountain-400-W","24/12/2020","44-5916927",!1,"61",5,4],[!1,"Ozu","Pakistan","Mountain-500","13/06/2020","31-5449914",!0,"155",2,2],[!1,"Rhynyx","India","Racing Socks","05/12/2020","19-9413869",!0,"162",2,4],[!1,"Flashset","Iran","Road-150","14/12/2020","25-9807605",!1,"46",7,1],[!1,"Yata","Congo (Kinshasa)","Road-250","12/06/2020","74-4291983",!0,"47",4,4],[!1,"Brainlounge","Vietnam","Road-350-W","10/03/2020","83-0980643",!0,"104",2,3],[!1,"Babblestorm","United States","Road-450","10/10/2020","19-2878430",!0,"101",6,4],[!1,"Youspan","Brazil","Road-550-W","16/12/2020","19-1838230",!0,"150",10,3],[!1,"Nlounge","China","Road-650","31/10/2020","32-2267938",!0,"42",4,2],[!1,"Twinte","India","Road-750","17/08/2020","79-2821972",!0,"144",9,3],[!1,"Oyonder","United Kingdom","Short-Sleeve Classic Jersey","04/12/2020","46-6597557",!0,"195",4,1],[!1,"Gigabox","Pakistan","Sport-100","03/02/2020","15-1793960",!0,"199",4,4],[!1,"Livetube","France","Touring-1000","16/05/2020","86-0811003",!0,"110",4,5],[!1,"Voomm","United Kingdom","Touring-2000","15/07/2020","95-3068680",!0,"51",4,4],[!1,"Voonyx","China","Touring-3000","27/11/2020","35-3085360",!1,"69",2,5],[!1,"Zoombeat","United States","Women's Mountain Shorts","03/11/2020","56-8673088",!1,"53",2,3],[!1,"Roomm","China","Women's Tights","16/03/2020","76-0085918",!0,"168",1,1],[!1,"Leenti","China","Mountain-400","16/05/2020","03-0893276",!1,"58",1,4],[!1,"Jetpulse","United States","Road-550","08/02/2020","79-9013306",!0,"152",9,3],[!1,"Katz","Peru","Road-350","15/02/2020","55-7799920",!0,"66",4,2],[!1,"Cogidoo","India","LL Mountain Front Wheel","04/06/2020","07-0881122",!1,"112",9,2],[!1,"Divavu","Colombia","Touring Rear Wheel","24/02/2020","58-6157387",!0,"50",10,4],[!1,"Mydeo","China","Touring Front Wheel","07/12/2020","12-2810010",!1,"31",3,5],[!1,"Browsebug","Japan","ML Mountain Front Wheel","14/01/2020","64-9249984",!0,"132",5,5],[!1,"Layo","China","HL Mountain Front Wheel","24/04/2020","45-0739652",!0,"45",1,5],[!1,"Snaptags","United Kingdom","LL Touring Handlebars","06/08/2020","09-5712761",!0,"197",4,2],[!1,"Cogilith","China","HL Touring Handlebars","31/05/2020","01-7345008",!0,"190",4,3],[!1,"Reallinks","United Kingdom","LL Road Front Wheel","14/05/2020","62-1065350",!0,"184",3,4],[!1,"Quaxo","United States","ML Road Front Wheel","23/03/2020","44-7241323",!0,"169",3,4],[!1,"Devify","China","HL Road Front Wheel","12/12/2020","52-0295699",!1,"152",4,4],[!1,"Youopia","Angola","LL Mountain Handlebars","01/04/2020","52-2650922",!1,"182",6,4],[!1,"Ainyx","China","Touring Pedal","27/02/2020","48-3618525",!0,"141",6,1],[!1,"Browsetype","Malaysia","ML Mountain Handlebars","28/04/2020","51-8893923",!0,"169",7,1],[!1,"Muxo","China","HL Mountain Handlebars","22/08/2020","68-5911361",!1,"39",7,1],[!1,"Bubbletube","China","LL Road Handlebars","04/10/2020","41-5880042",!0,"71",8,3],[!1,"Fadeo","Vietnam","ML Road Handlebars","23/04/2020","90-5913983",!0,"148",10,3],[!1,"Yadel","United Kingdom","HL Road Handlebars","18/04/2020","92-0960699",!0,"116",8,1],[!1,"Blognation","China","LL Headset","10/01/2020","06-9493898",!0,"96",10,1],[!1,"Devpoint","China","ML Headset","25/12/2020","69-5878565",!0,"35",4,2],[!1,"Aibox","United Kingdom","HL Headset","18/03/2020","13-1133017",!0,"16",8,2],[!1,"Brightdog","China","LL Mountain Pedal","11/09/2020","39-6530433",!0,"194",2,5],[!1,"Gabcube","Nigeria","ML Mountain Pedal","22/04/2020","96-6860388",!0,"24",1,3],[!1,"Muxo","China","HL Mountain Pedal","05/06/2020","30-0356137",!0,"170",4,4],[!1,"Tambee","China","ML Touring Seat/Saddle","22/02/2020","93-9058255",!0,"184",9,5],[!1,"Cogilith","India","LL Touring Seat/Saddle","06/04/2020","82-9268909",!1,"153",10,4],[!1,"Dynabox","Hong Kong","HL Touring Seat/Saddle","10/01/2020","20-6913815",!1,"88",10,1],[!1,"Shuffledrive","Sudan","LL Road Pedal","16/09/2020","08-8238817",!0,"57",9,2],[!1,"Fivechat","China","ML Road Pedal","26/08/2020","44-7370350",!1,"62",4,1],[!1,"Meembee","United States","HL Road Pedal","27/12/2020","01-3525949",!0,"123",2,4],[!1,"Dynazzy","United Kingdom","LL Mountain Seat/Saddle 1","15/12/2020","04-2414623",!0,"77",10,5],[!1,"Eare","China","ML Mountain Seat/Saddle 1","04/04/2020","15-1917509",!1,"199",9,4],[!1,"Yozio","China","HL Mountain Seat/Saddle 1","15/03/2020","06-2526845",!0,"149",8,2],[!1,"Quinu","Xi'an","425-777-7829","22/02/2020","83-1713558",!1,"191",9,5],[!1,"Jazzy","United Kingdom","ML Road Seat/Saddle 1","07/08/2020","00-8892524",!0,"150",10,2],[!1,"Thoughtsphere","China","HL Road Seat/Saddle 1","28/11/2020","39-5538991",!0,"130",7,3],[!1,"Leenti","China","ML Road Rear Wheel","29/12/2020","06-9002973",!0,"179",1,2],[!1,"Quaxo","United Kingdom","HL Road Rear Wheel","06/09/2020","73-6104901",!0,"98",5,3],[!1,"Tanoodle","Chile","LL Mountain Seat/Saddle 2","24/05/2020","68-7384479",!0,"175",2,3],[!1,"Feednation","China","ML Mountain Seat/Saddle 2","21/11/2020","26-7757763",!0,"11",1,3],[!1,"Kayveo","China","HL Mountain Seat/Saddle 2","21/06/2020","07-4873562",!1,"184",7,4],[!1,"Meevee","Saudi Arabia","LL Road Seat/Saddle 1","16/11/2020","46-5819554",!1,"27",9,3],[!1,"Twitterworks","China","ML Road Seat/Saddle 2","19/04/2020","01-2666826",!0,"186",3,2],[!1,"Wikizz","Tanzania","HL Road Seat/Saddle 2","08/03/2020","54-7090503",!0,"20",3,3],[!1,"Yoveo","United States","LL Mountain Tire","14/10/2020","78-7658520",!1,"153",2,1],[!1,"Yakidoo","China","ML Mountain Tire","12/10/2020","23-9926318",!0,"161",8,5],[!1,"Oyope","China","HL Mountain Tire","20/09/2020","20-0179517",!0,"98",10,5],[!1,"Skipstorm","United States","LL Road Tire","01/10/2020","02-9543343",!0,"30",7,3],[!1,"Minyx","United States","ML Road Tire","07/07/2020","98-3938169",!0,"73",10,2],[!1,"Miboo","China","HL Road Tire","25/07/2020","68-5197934",!0,"158",9,1],[!1,"Realfire","United States","Touring Tire","27/08/2020","39-8260460",!0,"122",5,2],[!1,"Shufflester","China","Mountain Tire Tube","08/06/2020","45-9776170",!0,"33",2,4],[!1,"Ntag","China","Road Tire Tube","06/12/2020","45-0858451",!0,"107",6,2],[!1,"Jabberbean","United States","Touring Tire Tube","26/04/2020","15-4247305",!0,"15",1,2],[!1,"Thoughtblab","China","LL Bottom Bracket","21/05/2020","15-8534931",!0,"168",5,2],[!1,"Jabbertype","China","Classic Vest","25/07/2020","23-1251557",!0,"135",4,2],[!1,"Buzzshare","United Kingdom","Cycling Cap","07/07/2020","86-5920601",!0,"11",1,4],[!1,"Roodel","United States","Full-Finger Gloves","13/01/2020","48-1055459",!0,"41",6,4],[!1,"Zoovu","China","Half-Finger Gloves","03/06/2020","12-7842022",!0,"144",6,1],[!1,"Photofeed","China","HL Mountain Frame","14/07/2020","94-5088099",!0,"106",1,4]],lM="selected",sM="odd";function uM(){return aM}n(3093);function cM(t){return cM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cM(t)}function fM(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hM(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pM(r.key),r)}}function dM(t,e,n){return e&&hM(t.prototype,e),n&&hM(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function pM(t){var e=yM(t,"string");return"symbol"===cM(e)?e:String(e)}function yM(t,e){if("object"!==cM(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==cM(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function vM(){return vM="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=mM(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},vM.apply(this,arguments)}function mM(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=kM(t),null===t)break;return t}function gM(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bM(t,e)}function bM(t,e){return bM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},bM(t,e)}function wM(t){var e=OM();return function(){var n,r=kM(t);if(e){var o=kM(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return SM(this,n)}}function SM(t,e){if(e&&("object"===cM(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return CM(t)}function CM(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function OM(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function kM(t){return kM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},kM(t)}var RM="handsontableEditor",EM="handsontable",PM=function(t){gM(n,t);var e=wM(n);function n(){return fM(this,n),e.apply(this,arguments)}return dM(n,[{key:"open",value:function(){vM(kM(n.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Sn(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),vM(kM(n.prototype),"close",this).call(this)}},{key:"prepare",value:function(t,e,r,o,i,a){vM(kM(n.prototype),"prepare",this).call(this,t,e,r,o,i,a);var l=this,s={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(t,e){var n=this.getSourceData(e.row,e.col);void 0!==n&&l.setValue(n),l.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&at(s,a.handsontable),this.htOptions=s}},{key:"beginEditing",value:function(t,e){var r=this.hot.getSettings().onBeginEditing;r&&!1===r()||vM(kM(n.prototype),"beginEditing",this).call(this,t,e)}},{key:"createElements",value:function(){vM(kM(n.prototype),"createElements",this).call(this);var t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}},{key:"finishEditing",value:function(t,e,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var o=this.htEditor.getInstance().getValue();void 0!==o&&this.setValue(o)}vM(kM(n.prototype),"finishEditing",this).call(this,t,e,r)}},{key:"assignHooks",value:function(){var t=this;this.hot.addHook("afterDestroy",(function(){t.htEditor&&t.htEditor.destroy()}))}},{key:"registerShortcuts",value:function(){var t=this,e=this.hot.getShortcutManager(),r=e.getContext("editor");vM(kM(n.prototype),"registerShortcuts",this).call(this);var o={group:RM,relativeToGroup:io,position:"before"},i=function(e,n){var r=t.htEditor.getInstance();if(void 0!==e&&(e<0||r.flipped&&e>r.countRows()-1?r.deselectCell():r.selectCell(e,0),r.getData().length))return n.preventDefault(),Zn(n),t.hot.listen(),t.TEXTAREA.focus(),!1};r.addShortcuts([{keys:[["ArrowUp"]],callback:function(e){var n,r,o=t.htEditor.getInstance();return!o.getSelectedLast()&&o.flipped?n=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(r=o.getSelectedLast()[0],n=Math.max(0,r-1)):(r=o.getSelectedLast()[0],n=r-1)),i(n,e)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(e){var n,r,o=t.htEditor.getInstance();if(o.getSelectedLast()||o.flipped){if(o.getSelectedLast())if(o.flipped)n=o.getSelectedLast()[0]+1;else if(!o.flipped){var a=o.countRows()-1;r=o.getSelectedLast()[0],n=Math.min(a,r+1)}}else n=0;return i(n,e)},preventDefault:!1}],o)}},{key:"unregisterShortcuts",value:function(){vM(kM(n.prototype),"unregisterShortcuts",this).call(this);var t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(RM)}}],[{key:"EDITOR_TYPE",get:function(){return EM}}]),n}(Uj);function TM(t){return TM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TM(t)}function jM(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AM(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,WM(r.key),r)}}function MM(t,e,n){return e&&AM(t.prototype,e),n&&AM(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function IM(){return IM="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=xM(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},IM.apply(this,arguments)}function xM(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=VM(t),null===t)break;return t}function _M(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&HM(t,e)}function HM(t,e){return HM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},HM(t,e)}function NM(t){var e=BM();return function(){var n,r=VM(t);if(e){var o=VM(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return DM(this,n)}}function DM(t,e){if(e&&("object"===TM(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return LM(t)}function LM(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function BM(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function VM(t){return VM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},VM(t)}function FM(t,e,n){return e=WM(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WM(t){var e=UM(t,"string");return"symbol"===TM(e)?e:String(e)}function UM(t,e){if("object"!==TM(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==TM(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var zM=new WeakMap,GM="autocomplete",YM=function(t){_M(n,t);var e=NM(n);function n(t){var r;return jM(this,n),r=e.call(this,t),FM(LM(r),"sortByRelevance",(function(t,e,n){var r,o,i,a,l=[],s=[],u=t.length,c=e.length;if(0===u){for(i=0;i<c;i++)s.push(i);return s}for(i=0;i<c;i++){if(o=ke(Jt(e[i])),n)a=o.indexOf(t);else{var f=this.cellProperties.locale;a=o.toLocaleLowerCase(f).indexOf(t.toLocaleLowerCase(f))}-1!==a&&(r=o.length-a-u,l.push({baseIndex:i,index:a,charsLeft:r,value:o}))}for(l.sort((function(t,e){if(-1===e.index)return-1;if(-1===t.index)return 1;if(t.index<e.index)return-1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0})),i=0,c=l.length;i<c;i++)s.push(l[i].baseIndex);return s})),r.query=null,r.strippedChoices=[],r.rawChoices=[],zM.set(LM(r),{skipOne:!1,isMacOS:r.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),r}return MM(n,[{key:"getValue",value:function(){var t=this,e=this.rawChoices.find((function(e){var n=t.stripValueIfNeeded(e);return n===t.TEXTAREA.value}));return Zt(e)?e:this.TEXTAREA.value}},{key:"createElements",value:function(){IM(VM(n.prototype),"createElements",this).call(this),Ge(this.htContainer,"autocompleteEditor"),Ge(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}},{key:"open",value:function(){var t=this,e=zM.get(this);IM(VM(n.prototype),"open",this).call(this);var r=this.htEditor.getInstance(),o=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var i=On();0===i&&e.isMacOS&&(i+=15),this.addHook("beforeKeyDown",(function(e){return t.onBeforeKeyDown(e)})),r.updateSettings({colWidths:o?[fn(this.TEXTAREA)-2]:void 0,width:o?fn(this.TEXTAREA)+i:void 0,renderer:function(e,n,r,o,i,a,l){Kj(e,n,r,o,i,a,l);var s,u,c=t.cellProperties,f=c.filteringCaseSensitive,h=c.allowHtml,d=c.locale,p=t.query,y=Jt(a);y&&!h&&(s=!0===f?y.indexOf(p):y.toLocaleLowerCase(d).indexOf(p.toLocaleLowerCase(d)),-1!==s&&(u=y.substr(s,p.length),y=y.replace(u,"<strong>".concat(u,"</strong>")))),n.innerHTML=y},autoColumnSize:!0}),e.skipOne&&(e.skipOne=!1),this.hot._registerTimeout((function(){t.queryChoices(t.TEXTAREA.value)}))}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),IM(VM(n.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(t){IM(VM(n.prototype),"discardEditor",this).call(this,t),this.hot.view.render()}},{key:"queryChoices",value:function(t){var e=this,n=this.cellProperties.source;this.query=t,"function"===typeof n?n.call(this.cellProperties,t,(function(t){e.rawChoices=t,e.updateChoicesList(e.stripValuesIfNeeded(t))})):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(t){var e=mn(this.TEXTAREA),n=gn(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,i=null,a=null,l=t;r&&(i=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));var s=Array.isArray(i)?i.length:0;if(!1===o)s&&(a=i[0]);else{for(var u=[],c=0,f=l.length;c<f;c++){if(r&&s<=c)break;s?u.push(l[i[c]]):u.push(l[c])}a=0,l=u}this.strippedChoices=l,this.htEditor.loadData(B([l])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(a),this.hot.listen(),Sn(this.TEXTAREA,e,e===n?void 0:n)}},{key:"flipDropdownIfNeeded",value:function(){var t=ln(this.hot.view._wt.wtTable.TABLE),e=t===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(e||!e&&(n||"horizontal"===n))return!1;var r=tn(this.TEXTAREA),o=hn(this.TEXTAREA),i=this.getDropdownHeight(),a=t.scrollTop,l=hn(this.hot.view._wt.wtTable.THEAD),s=tn(t),u=r.top-s.top-l+a,c=t.scrollHeight-u-l-o,f=i>c&&u>c;return f?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(f?u:c,i),f}},{key:"limitDropdownIfNeeded",value:function(t,e){if(e>t){var n=0,r=0,o=0,i=null;do{o=this.htEditor.getRowHeight(r)||this.htEditor.view._wt.getSetting("defaultRowHeight"),n+=o,r+=1}while(n<t);i=n-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+e-i,"px")),this.setDropdownHeight(n-o)}}},{key:"flipDropdown",value:function(t){var e=this.htEditor.rootElement.style;e.position="absolute",e.top="".concat(-t,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var t=this.htEditor.rootElement.style;t.position="absolute",t.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var t=this.htEditor.getColWidth(0)+On(this.hot.rootDocument)+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(t){this.htEditor.updateSettings({height:t})}},{key:"highlightBestMatchingChoice",value:function(t){"number"===typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var t=this.htEditor.getInstance().getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8}},{key:"stripValueIfNeeded",value:function(t){return this.stripValuesIfNeeded([t])[0]}},{key:"stripValuesIfNeeded",value:function(t){var e=this.cellProperties.allowHtml,n=W(t,(function(t){return Jt(t)})),r=W(n,(function(t){return e?t:ke(t)}));return r}},{key:"allowKeyEventPropagation",value:function(t){var e=this.htEditor.getSelectedRangeLast(),n={row:e?e.from.row:-1},r=!1;return t===Yn.ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(r=!0),t===Yn.ARROW_UP&&n.row>-1&&(r=!0),r}},{key:"onBeforeKeyDown",value:function(t){var e=this,n=zM.get(this);if(n.skipOne=!1,Xn(t.keyCode)||t.keyCode===Yn.BACKSPACE||t.keyCode===Yn.DELETE||t.keyCode===Yn.INSERT){var r=10;if(t.keyCode===Yn.C&&(t.ctrlKey||t.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout((function(){e.queryChoices(e.TEXTAREA.value),n.skipOne=!0}),r)}}}],[{key:"EDITOR_TYPE",get:function(){return GM}}]),n}(PM);function KM(t){return KM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},KM(t)}function XM(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,QM(r.key),r)}}function qM(t,e,n){return e&&$M(t.prototype,e),n&&$M(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function QM(t){var e=JM(t,"string");return"symbol"===KM(e)?e:String(e)}function JM(t,e){if("object"!==KM(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==KM(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ZM(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tI(t,e)}function tI(t,e){return tI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},tI(t,e)}function eI(t){var e=oI();return function(){var n,r=iI(t);if(e){var o=iI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nI(this,n)}}function nI(t,e){if(e&&("object"===KM(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return rI(t)}function rI(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oI(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function iI(t){return iI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},iI(t)}var aI="checkbox",lI=function(t){ZM(n,t);var e=eI(n);function n(){return XM(this,n),e.apply(this,arguments)}return qM(n,[{key:"beginEditing",value:function(t,e){if(e&&"mouseup"===e.type){var n=this.TD.querySelector('input[type="checkbox"]');ze(n,"htBadValue")||n.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return aI}}]),n}(yj),sI=n(1077);function uI(t){return uI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uI(t)}function cI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dI(r.key),r)}}function hI(t,e,n){return e&&fI(t.prototype,e),n&&fI(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function dI(t){var e=pI(t,"string");return"symbol"===uI(e)?e:String(e)}function pI(t,e){if("object"!==uI(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==uI(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function yI(){return yI="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=vI(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},yI.apply(this,arguments)}function vI(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=OI(t),null===t)break;return t}function mI(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gI(t,e)}function gI(t,e){return gI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},gI(t,e)}function bI(t){var e=CI();return function(){var n,r=OI(t);if(e){var o=OI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wI(this,n)}}function wI(t,e){if(e&&("object"===uI(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return SI(t)}function SI(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function CI(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function OI(t){return OI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},OI(t)}var kI="date",RI="dateEditor",EI=function(t){mI(n,t);var e=bI(n);function n(t){var r;return cI(this,n),r=e.call(this,t),r.defaultDateFormat="DD/MM/YYYY",r.isCellEdited=!1,r.parentDestroyed=!1,r.$datePicker=null,r}return hI(n,[{key:"init",value:function(){var t=this;if("function"!==typeof Xt)throw new Error("You need to include moment.js to your project.");if("function"!==typeof sI)throw new Error("You need to include Pikaday to your project.");yI(OI(n.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",(function(){t.parentDestroyed=!0,t.destroyElements()}))}},{key:"createElements",value:function(){yI(OI(n.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Ge(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var t=new Gr(this);t.addEventListener(this.datePicker,"mousedown",(function(t){return t.stopPropagation()}))}},{key:"destroyElements",value:function(){var t=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}},{key:"prepare",value:function(t,e,r,o,i,a){yI(OI(n.prototype),"prepare",this).call(this,t,e,r,o,i,a)}},{key:"open",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.hot.getShortcutManager(),r=e.getContext("editor");yI(OI(n.prototype),"open",this).call(this),this.showDatepicker(t),r.addShortcut({keys:[["Enter"]],callback:function(t){t.stopPropagation()},group:RI})}},{key:"close",value:function(){var t,e=this;this._opened=!1,null!==(t=this.$datePicker)&&void 0!==t&&t.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout((function(){e.instance._refreshBorders()}));var r=this.hot.getShortcutManager(),o=r.getContext("editor");o.removeShortcutsByGroup(RI),yI(OI(n.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){var r=this.originalValue;void 0!==r&&this.setValue(r)}yI(OI(n.prototype),"finishEditing",this).call(this,t,e)}},{key:"showDatepicker",value:function(t){var e,n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.instance.view.isMouseDown(),i=!!t&&$n(t.keyCode);this.datePicker.style.display="block",this.$datePicker=new sI(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+n.top+hn(this.TD),"px");var a=this.hot.rootWindow.pageXOffset;a=this.hot.isRtl()?n.right-fn(this.datePicker):n.left,this.datePickerStyle.left="".concat(a,"px"),this.originalValue?(e=this.originalValue,Xt(e,r,!0).isValid()&&this.$datePicker.setMoment(Xt(e,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),i||o||this.setValue("")):this.cellProperties.defaultDate?(e=this.cellProperties.defaultDate,Xt(e,r,!0).isValid()&&this.$datePicker.setMoment(Xt(e,r),!0),i||o||this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var t=this,e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&lt(n,this.cellProperties.datePickerConfig);var r=n.onSelect,o=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=function(e){var n=e;isNaN(n.getTime())||(n=Xt(n).format(t.cellProperties.dateFormat||t.defaultDateFormat)),t.setValue(n),t.hideDatepicker(),r&&r()},n.onClose=function(){t.parentDestroyed||t.finishEditing(!1),o&&o()},n}}],[{key:"EDITOR_TYPE",get:function(){return kI}}]),n}(Uj);function PI(t){return PI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},PI(t)}function TI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,MI(r.key),r)}}function AI(t,e,n){return e&&jI(t.prototype,e),n&&jI(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function MI(t){var e=II(t,"string");return"symbol"===PI(e)?e:String(e)}function II(t,e){if("object"!==PI(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==PI(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function xI(){return xI="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=_I(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},xI.apply(this,arguments)}function _I(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=FI(t),null===t)break;return t}function HI(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&NI(t,e)}function NI(t,e){return NI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},NI(t,e)}function DI(t){var e=VI();return function(){var n,r=FI(t);if(e){var o=FI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return LI(this,n)}}function LI(t,e){if(e&&("object"===PI(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return BI(t)}function BI(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function VI(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function FI(t){return FI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},FI(t)}var WI="dropdown",UI=function(t){HI(n,t);var e=DI(n);function n(){return TI(this,n),e.apply(this,arguments)}return AI(n,[{key:"prepare",value:function(t,e,r,o,i,a){xI(FI(n.prototype),"prepare",this).call(this,t,e,r,o,i,a),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return WI}}]),n}(YM);function zI(t){return zI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zI(t)}function GI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function YI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,XI(r.key),r)}}function KI(t,e,n){return e&&YI(t.prototype,e),n&&YI(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function XI(t){var e=$I(t,"string");return"symbol"===zI(e)?e:String(e)}function $I(t,e){if("object"!==zI(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==zI(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function qI(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&QI(t,e)}function QI(t,e){return QI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},QI(t,e)}function JI(t){var e=ex();return function(){var n,r=nx(t);if(e){var o=nx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ZI(this,n)}}function ZI(t,e){if(e&&("object"===zI(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return tx(t)}function tx(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ex(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function nx(t){return nx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},nx(t)}mr.getSingleton().add("beforeValidate",(function(t,e,n){var r=this.getCellMeta(e,this.propToCol(n));r.editor===UI&&void 0===r.strict&&(r.filter=!1,r.strict=!0)}));var rx="numeric",ox=function(t){qI(n,t);var e=JI(n);function n(){return GI(this,n),e.apply(this,arguments)}return KI(n,null,[{key:"EDITOR_TYPE",get:function(){return rx}}]),n}(Uj);function ix(t){return ix="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ix(t)}function ax(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ux(r.key),r)}}function sx(t,e,n){return e&&lx(t.prototype,e),n&&lx(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ux(t){var e=cx(t,"string");return"symbol"===ix(e)?e:String(e)}function cx(t,e){if("object"!==ix(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ix(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function fx(){return fx="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=hx(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},fx.apply(this,arguments)}function hx(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=bx(t),null===t)break;return t}function dx(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&px(t,e)}function px(t,e){return px=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},px(t,e)}function yx(t){var e=gx();return function(){var n,r=bx(t);if(e){var o=bx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vx(this,n)}}function vx(t,e){if(e&&("object"===ix(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return mx(t)}function mx(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gx(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function bx(t){return bx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bx(t)}var wx="password",Sx=function(t){dx(n,t);var e=yx(n);function n(){return ax(this,n),e.apply(this,arguments)}return sx(n,[{key:"createElements",value:function(){fx(bx(n.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Xe(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return wx}}]),n}(Uj);function Cx(t){return Cx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cx(t)}function Ox(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ex(r.key),r)}}function Rx(t,e,n){return e&&kx(t.prototype,e),n&&kx(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ex(t){var e=Px(t,"string");return"symbol"===Cx(e)?e:String(e)}function Px(t,e){if("object"!==Cx(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Cx(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Tx(){return Tx="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=jx(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Tx.apply(this,arguments)}function jx(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Nx(t),null===t)break;return t}function Ax(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mx(t,e)}function Mx(t,e){return Mx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Mx(t,e)}function Ix(t){var e=Hx();return function(){var n,r=Nx(t);if(e){var o=Nx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xx(this,n)}}function xx(t,e){if(e&&("object"===Cx(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _x(t)}function _x(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Hx(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Nx(t){return Nx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Nx(t)}var Dx="ht_editor_visible",Lx="selectEditor",Bx="select",Vx=function(t){Ax(n,t);var e=Ix(n);function n(){return Ox(this,n),e.apply(this,arguments)}return Rx(n,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Ge(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(t){this.select.value=t}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var t=this.hot.getShortcutManager();t.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",ze(this.select,Dx)&&Ye(this.select,Dx),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var t=this;this.addHook("afterScrollHorizontally",(function(){return t.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return t.refreshDimensions()})),this.addHook("afterColumnResize",(function(){return t.refreshDimensions()})),this.addHook("afterRowResize",(function(){return t.refreshDimensions()}))}},{key:"prepare",value:function(t,e,r,o,i,a){var l=this;Tx(Nx(n.prototype),"prepare",this).call(this,t,e,r,o,i,a);var s,u=this.cellProperties.selectOptions;s="function"===typeof u?this.prepareOptions(u(this.row,this.col,this.prop)):this.prepareOptions(u),Xe(this.select),pt(s,(function(t,e){var n=l.hot.rootDocument.createElement("OPTION");n.value=e,Qe(n,t),l.select.appendChild(n)}))}},{key:"prepareOptions",value:function(t){var e={};if(Array.isArray(t))for(var n=0,r=t.length;n<r;n++)e[t[n]]=t[n];else"object"===Cx(t)&&(e=t);return e}},{key:"refreshValue",value:function(){var t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===dj.EDITING)if(this.TD=this.getEditedCell(),this.TD){var t=this.getEditedCellRect(),e=t.top,n=t.start,r=t.width,o=t.height,i=this.select.style;i.height="".concat(o,"px"),i.width="".concat(r,"px"),i.top="".concat(e,"px"),i[this.hot.isRtl()?"right":"left"]="".concat(n,"px"),i.margin="0px",Ge(this.select,Dx)}else this.close()}},{key:"registerShortcuts",value:function(){var t=this,e=this.hot.getShortcutManager(),n=e.getContext("editor"),r={group:Lx};!1!==this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var e=t.select.selectedIndex-1;e>=0&&(t.select[e].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var e=t.select.selectedIndex+1;e<=t.select.length-1&&(t.select[e].selected=!0)}}],r)}},{key:"unregisterShortcuts",value:function(){var t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(Lx)}}],[{key:"EDITOR_TYPE",get:function(){return Bx}}]),n}(yj);function Fx(t){return Fx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fx(t)}function Wx(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ux(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Gx(r.key),r)}}function zx(t,e,n){return e&&Ux(t.prototype,e),n&&Ux(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gx(t){var e=Yx(t,"string");return"symbol"===Fx(e)?e:String(e)}function Yx(t,e){if("object"!==Fx(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Fx(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Kx(){return Kx="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Xx(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Kx.apply(this,arguments)}function Xx(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=e_(t),null===t)break;return t}function $x(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qx(t,e)}function qx(t,e){return qx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},qx(t,e)}function Qx(t){var e=t_();return function(){var n,r=e_(t);if(e){var o=e_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jx(this,n)}}function Jx(t,e){if(e&&("object"===Fx(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Zx(t)}function Zx(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function t_(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function e_(t){return e_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},e_(t)}var n_="time",r_=function(t){$x(n,t);var e=Qx(n);function n(){return Wx(this,n),e.apply(this,arguments)}return zx(n,[{key:"prepare",value:function(t,e,r,o,i,a){Kx(e_(n.prototype),"prepare",this).call(this,t,e,r,o,i,a),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return n_}}]),n}(Uj);function o_(){Hr(yj),Hr(YM),Hr(lI),Hr(EI),Hr(UI),Hr(PM),Hr(ox),Hr(Sx),Hr(Vx),Hr(Uj),Hr(r_)}var i_="html";function a_(t,e,n,r,o,i,a){Gj.apply(this,[t,e,n,r,o,i,a]),Qe(e,null===i||void 0===i?"":i,!1)}a_.RENDERER_TYPE=i_;var l_="autocomplete";function s_(t,e,n,r,o,i,a){var l=t.rootDocument,s=a.allowHtml?a_:Kj,u=l.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(l.createTextNode(String.fromCharCode(9660))),s.apply(this,[t,e,n,r,o,i,a]),e.firstChild||e.appendChild(l.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),Ge(e,"htAutocomplete"),!t.acArrowListener){var c=new Gr(t);t.acArrowListener=function(o){ze(o.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},c.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",(function(){c.destroy()}))}}s_.RENDERER_TYPE=l_;var u_=new WeakMap,c_=new WeakMap,f_="htBadValue",h_="data-row",d_="data-col",p_="checkboxRenderer",y_="checkbox";function v_(t,e,n,r,o,i,a){var l=t.rootDocument;Gj.apply(this,[t,e,n,r,o,i,a]),m_(t);var s=g_(l),u=a.label,c=!1;if("undefined"===typeof a.checkedTemplate&&(a.checkedTemplate=!0),"undefined"===typeof a.uncheckedTemplate&&(a.uncheckedTemplate=!1),Xe(e),i===a.checkedTemplate||Jt(i).toLocaleLowerCase(a.locale)===Jt(a.checkedTemplate).toLocaleLowerCase(a.locale)?s.checked=!0:i===a.uncheckedTemplate||Jt(i).toLocaleLowerCase(a.locale)===Jt(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?s.checked=!1:ee(i)?Ge(s,"noValue"):(s.style.display="none",Ge(s,f_),c=!0),s.setAttribute(h_,n),s.setAttribute(d_,r),!c&&u){var f="";if(u.value)f="function"===typeof u.value?u.value.call(this,n,r,o,i):u.value;else if(u.property){var h=t.getDataAtRowProp(n,u.property);f=null!==h?h:""}var d=b_(l,f,!0!==u.separated);"before"===u.position?u.separated?(e.appendChild(d),e.appendChild(s)):(d.appendChild(s),s=d):u.position&&"after"!==u.position||(u.separated?(e.appendChild(s),e.appendChild(d)):(d.insertBefore(s,d.firstChild),s=d))}function p(){var e=t.getShortcutManager(),n=e.getContext("grid"),r={group:p_};n.addShortcuts([{keys:[["space"]],callback:function(){return y(),!v()}},{keys:[["enter"]],callback:function(){return y(),!v()},runOnlyIf:function(){return t.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return y(!0),!v()},relativeToGroup:ao,position:"before"}],r)}function y(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t.getSelectedRange();if(n)for(var r=0;r<n.length;r++){for(var o=n[r].getTopStartCorner(),i=o.row,a=o.col,l=n[r].getBottomEndCorner(),s=l.row,u=l.col,c=[],f=i;f<=s;f+=1)for(var h=a;h<=u;h+=1){var d=t.getCellMeta(f,h);if("checkbox"!==d.type)return;if(!0!==d.readOnly){"undefined"===typeof d.checkedTemplate&&(d.checkedTemplate=!0),"undefined"===typeof d.uncheckedTemplate&&(d.uncheckedTemplate=!1);var p=t.getDataAtCell(f,h);!1===e?[d.checkedTemplate,d.checkedTemplate.toString()].includes(p)?c.push([f,h,d.uncheckedTemplate]):[d.uncheckedTemplate,d.uncheckedTemplate.toString(),null,void 0].includes(p)&&c.push([f,h,d.checkedTemplate]):c.push([f,h,d.uncheckedTemplate])}}c.length>0&&t.setDataAtCell(c)}}function v(){var e=t.getSelectedRange();if(e){for(var n=0;n<e.length;n++)for(var r=e[n].getTopStartCorner(),o=e[n].getBottomEndCorner(),i=r.row;i<=o.row;i++)for(var a=r.col;a<=o.col;a++){var l=t.getCellMeta(i,a);if("checkbox"!==l.type)return!1;var s=t.getCell(i,a);if(null===s||void 0===s)return!0;var u=s.querySelectorAll("input[type=checkbox]");if(u.length>0&&!l.readOnly)return!0}return!1}}(!u||u&&!u.separated)&&e.appendChild(s),c&&e.appendChild(l.createTextNode("#bad-value#")),u_.has(t)||(u_.set(t,!0),p())}function m_(t){var e=c_.get(t);if(!e){var n=t.rootElement;e=new Gr(t),e.addEventListener(n,"click",(function(e){return S_(e,t)})),e.addEventListener(n,"mouseup",(function(e){return w_(e,t)})),e.addEventListener(n,"change",(function(e){return C_(e,t)})),c_.set(t,e)}return e}function g_(t){var e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function b_(t,e,n){var r=t.createElement("label");return r.className="htCheckboxRendererLabel ".concat(n?"fullWidth":""),r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function w_(t,e){var n=t.target;O_(n)&&n.hasAttribute(h_)&&n.hasAttribute(d_)&&setTimeout(e.listen,10)}function S_(t,e){var n=t.target;if(O_(n)&&n.hasAttribute(h_)&&n.hasAttribute(d_)){var r=parseInt(n.getAttribute(h_),10),o=parseInt(n.getAttribute(d_),10),i=e.getCellMeta(r,o);i.readOnly&&t.preventDefault()}}function C_(t,e){var n=t.target;if(O_(n)&&n.hasAttribute(h_)&&n.hasAttribute(d_)){var r=parseInt(n.getAttribute(h_),10),o=parseInt(n.getAttribute(d_),10),i=e.getCellMeta(r,o);if(!i.readOnly){var a=null;a=t.target.checked?void 0===i.uncheckedTemplate||i.checkedTemplate:void 0!==i.uncheckedTemplate&&i.uncheckedTemplate,e.setDataAtCell(r,o,a)}}}function O_(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}mr.getSingleton().add("modifyAutoColumnSizeSeed",(function(t,e,n){var r=e.label,o=e.type,i=e.row,a=e.column,l=e.prop;if(o===y_){if(r){var s=r.value,u=r.property,c=n;if(s)c="function"===typeof s?s(i,a,l,n):s;else if(u){var f=this.getDataAtRowProp(i,u);c=null!==f?f:n}t=c}return t}})),v_.RENDERER_TYPE=y_;var k_=n(204),R_="numeric";function E_(t,e,n,r,o,i,a){var l=i;if(Ao(l)){var s=a.numericFormat,u=s&&s.culture||"-",c=s&&s.pattern,f=a.className||"",h=f.length?f.split(" "):[];if("undefined"!==typeof u&&!k_.languages()[u]){var d=u.replace("-",""),p=k_.allLanguages?k_.allLanguages[u]:k_[d];p&&k_.registerLanguage(p)}k_.setLanguage(u),l=k_(l).format(c||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),e.dir="ltr"}Kj(t,e,n,r,o,l,a)}E_.RENDERER_TYPE=R_;var P_="password";function T_(t,e,n,r,o,i,a){Kj.apply(this,[t,e,n,r,o,i,a]);var l=a.hashLength||e.innerHTML.length,s=a.hashSymbol||"*",u="";Io(l-1,(function(){u+=s})),Qe(e,u)}T_.RENDERER_TYPE=P_;var j_="time";function A_(t,e,n,r,o,i,a){Kj.apply(this,[t,e,n,r,o,i,a]),e.dir="ltr"}function M_(){Gi(s_),Gi(Gj),Gi(v_),Gi(a_),Gi(E_),Gi(T_),Gi(Kj),Gi(A_)}A_.RENDERER_TYPE=j_;var I_="autocomplete";function x_(t,e){var n=t;null!==n&&void 0!==n||(n=""),this.allowEmpty&&""===n?e(!0):this.strict&&this.source?"function"===typeof this.source?this.source(n,__(n,e)):__(n,e)(this.source):e(!0)}function __(t,e){var n=t;return function(t){for(var r=!1,o=0,i=t.length;o<i;o++)if(n===t[o]){r=!0;break}e(r)}}x_.VALIDATOR_TYPE=I_;n(782);function H_(t){var e=new Date(t);return isNaN(new Date("".concat(t,"T00:00")).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}var N_="date";function D_(t,e){var n=xr(kI,this.instance),r=t,o=!0;null!==r&&void 0!==r||(r="");var i=Xt(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),a=Xt(new Date(r)).isValid()||i;if(this.allowEmpty&&""===r&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(!0===this.correctFormat){var l=L_(r,this.dateFormat),s=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(s,u,l,"dateValidator"),o=!0}else o=!1;e(o)}function L_(t,e){var n,r=Xt(H_(t)),o=Xt(t,e),i=t.search(/[A-z]/g)>-1;return n=r.isValid()&&r.format("x")===o.format("x")||!o.isValid()||i?r:o,n.format(e)}D_.VALIDATOR_TYPE=N_;var B_="numeric";function V_(t,e){var n=t;null!==n&&void 0!==n||(n=""),this.allowEmpty&&""===n?e(!0):e(""!==n&&Ao(t))}V_.VALIDATOR_TYPE=B_;var F_=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],W_="time";function U_(t,e){var n=this.timeFormat||"h:mm:ss a",r=!0,o=t;null===o&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=Xt(o,F_,!0).isValid()?Xt(o):Xt(o,n),l=a.isValid(),s=Xt(o,n,!0).isValid()&&!i;if(this.allowEmpty&&""===o&&(l=!0,s=!0),l||(r=!1),!l&&s&&(r=!0),l&&!s)if(!0===this.correctFormat){var u=a.format(n),c=this.instance.toVisualRow(this.row),f=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,f,u,"timeValidator"),r=!0}else r=!1;e(r)}function z_(){Ji(x_),Ji(D_),Ji(V_),Ji(U_)}U_.VALIDATOR_TYPE=W_;var G_="autocomplete",Y_={CELL_TYPE:G_,editor:YM,renderer:s_,validator:x_},K_="checkbox",X_={CELL_TYPE:K_,editor:lI,renderer:v_},$_="date",q_={CELL_TYPE:$_,editor:EI,renderer:s_,validator:D_},Q_="dropdown",J_={CELL_TYPE:Q_,editor:UI,renderer:s_,validator:x_},Z_="handsontable",tH={CELL_TYPE:Z_,editor:PM,renderer:s_},eH="numeric",nH={CELL_TYPE:eH,editor:ox,renderer:E_,validator:V_,dataType:"number"},rH="password",oH={CELL_TYPE:rH,editor:Sx,renderer:T_,copyable:!1},iH="time",aH={CELL_TYPE:iH,editor:r_,renderer:A_,validator:U_};function lH(){uE(Y_),uE(X_),uE(q_),uE(J_),uE(tH),uE(nH),uE(oH),uE($j),uE(aH)}n(9859);function sH(t){return sH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sH(t)}function uH(t,e){return pH(t)||dH(t,e)||fH(t,e)||cH()}function cH(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fH(t,e){if(t){if("string"===typeof t)return hH(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hH(t,e):void 0}}function hH(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function dH(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function pH(t){if(Array.isArray(t))return t}function yH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vH(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,gH(r.key),r)}}function mH(t,e,n){return e&&vH(t.prototype,e),n&&vH(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function gH(t){var e=bH(t,"string");return"symbol"===sH(e)?e:String(e)}function bH(t,e){if("object"!==sH(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==sH(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function wH(t,e){SH(t,e),e.add(t)}function SH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CH(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var OH=new Map([["plugin",Hi],["cell-type",aE],["editor",Ar],["renderer",Wi],["validator",$i]]),kH="base",RH=new WeakMap,EH=[],PH=null,TH=new WeakSet,jH=function(){function t(e){var n=this;yH(this,t),wH(this,TH),dt(this,"hot",e,{writable:!1}),RH.set(this,{hooks:{}}),PH=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",(function(){return n.onAfterPluginsInitialized()})),this.hot.addHook("afterUpdateSettings",(function(t){return n.onUpdateSettings(t)})),this.hot.addHook("beforeInit",(function(){return n.init()}))}return mH(t,[{key:"init",value:function(){var t=this;this.pluginName=this.hot.getPluginName(this);var e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){var r=[];if(n.forEach((function(t){var e=t.split(":"),n=uH(e,2),o=n[0],i=n[1];if(!OH.has(o))throw new Error('Unknown plugin dependency type "'.concat(o,'" was found.'));OH.get(o)(i)||r.push(" - ".concat(i," (").concat(o,")"))})),r.length>0){var o=["The ".concat(this.pluginName," plugin requires the following modules:\n"),"".concat(r.join("\n"),"\n")].join("");EH.push(o)}}PH||(PH=xi()),PH.indexOf("UndoRedo")>=0&&PH.splice(PH.indexOf("UndoRedo"),1),PH.indexOf(this.pluginName)>=0&&PH.splice(PH.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(function(){t.isEnabled&&t.isEnabled()&&t.enablePlugin()}));var i=0===PH.length;if(i){if(EH.length>0){var a=["".concat(EH.join("\n"),"\n"),"You have to import and register them manually."].join("");throw new Error(a)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(t,e){RH.get(this).hooks[t]=RH.get(this).hooks[t]||[];var n=RH.get(this).hooks[t];this.hot.addHook(t,e),n.push(e),RH.get(this).hooks[t]=n}},{key:"removeHooks",value:function(t){var e=this;U(RH.get(this).hooks[t]||[],(function(n){e.hot.removeHook(t,n)}))}},{key:"clearHooks",value:function(){var t=this,e=RH.get(this).hooks;pt(e,(function(e,n){return t.removeHooks(n)})),e.length=0}},{key:"callOnPluginsReady",value:function(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}},{key:"onAfterPluginsInitialized",value:function(){U(this.pluginsInitializedCallbacks,(function(t){return t()})),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(t){var e=CH(this,TH,AH).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var t=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),pt(this,(function(e,n){"hot"!==n&&(t[n]=null)})),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return kH}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),t}();function AH(t){if(!t)return!1;var e=this.constructor.SETTING_KEYS;if("boolean"===typeof e)return e;for(var n=0;n<e.length;n++)if(void 0!==t[e[n]])return!0;return!1}function MH(t){return MH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},MH(t)}function IH(t,e){return DH(t)||NH(t,e)||_H(t,e)||xH()}function xH(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _H(t,e){if(t){if("string"===typeof t)return HH(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?HH(t,e):void 0}}function HH(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function NH(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function DH(t){if(Array.isArray(t))return t}function LH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function BH(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,FH(r.key),r)}}function VH(t,e,n){return e&&BH(t.prototype,e),n&&BH(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function FH(t){var e=WH(t,"string");return"symbol"===MH(e)?e:String(e)}function WH(t,e){if("object"!==MH(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==MH(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var UH=function(){function t(e){LH(this,t),this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return VH(t,[{key:"addRow",value:function(t,e){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:t};this.rows.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(t){var e=this.hot.getColHeader(0);if(null!==e&&void 0!==e){var n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}},{key:"addColumn",value:function(t,e){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:t};this.columns.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(t){this.injected||this.injectTable(),U(this.rows,(function(e){t(e.row,hn(e.table)-1)}))}},{key:"getWidths",value:function(t){this.injected||this.injectTable(),U(this.columns,(function(e){var n=e.table.getBoundingClientRect(),r=n.width;t(e.col,Math.ceil(r))}))}},{key:"setSettings",value:function(t){this.settings=t}},{key:"setSetting",value:function(t,e){this.settings||(this.settings={}),this.settings[t]=e}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(t){return this.settings?this.settings[t]:null}},{key:"createColGroupsCol",value:function(){var t=this,e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1)),this.samples.forEach((function(n){U(n.strings,(function(n){e.appendChild(t.createColElement(n.col))}))})),e}},{key:"createRow",value:function(t){var e=this,n=this.hot.rootDocument,r=n.createDocumentFragment(),o=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,o),r.appendChild(o)),this.samples.forEach((function(o){U(o.strings,(function(o){var i=o.col,a=e.hot.getCellMeta(t,i);a.col=i,a.row=t;var l=e.hot.getCellRenderer(a),s=n.createElement("td");s.setAttribute("ghost-table",1),l(e.hot,s,t,i,e.hot.colToProp(i),o.value,a),r.appendChild(s)}))})),r}},{key:"appendColumnHeadersRow",value:function(){var t=this,e=this.hot.rootDocument,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){var o=e.createElement("th");r.push([-1,o]),n.appendChild(o)}this.samples.forEach((function(t){U(t.strings,(function(t){var o=t.col,i=e.createElement("th");r.push([o,i]),n.appendChild(i)}))})),this.table.tHead.appendChild(n),U(r,(function(e){var n=IH(e,2),r=n[0],o=n[1];t.hot.view.appendColHeader(r,o)}))}},{key:"createCol",value:function(t){var e=this,n=this.hot.rootDocument,r=n.createDocumentFragment();return this.samples.forEach((function(o){U(o.strings,(function(o){var i=o.row,a=e.hot.getCellMeta(i,t);a.col=t,a.row=i;var l=e.hot.getCellRenderer(a),s=n.createElement("td"),u=n.createElement("tr");s.setAttribute("ghost-table",1),l(e.hot,s,i,t,e.hot.colToProp(t),o.value,a),u.appendChild(s),r.appendChild(u)}))})),r}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(t){var e=this.hot.rootDocument.createElement("col");return e.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(t),"px"),e}},{key:"createTable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.hot.rootDocument,n=e.createDocumentFragment(),r=e.createElement("table"),o=e.createElement("thead"),i=e.createElement("tbody"),a=e.createElement("colgroup"),l=e.createElement("tr"),s=e.createElement("th");return this.isVertical()&&r.appendChild(a),this.isHorizontal()&&(l.appendChild(s),o.appendChild(l),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&i.appendChild(l),r.appendChild(i),Ge(r,t),n.appendChild(r),{fragment:n,table:r,tHead:o,tBody:i,colGroup:a,tr:l,th:s}}},{key:"createContainer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.hot.rootDocument,n=e.createDocumentFragment(),r=e.createElement("div"),o="htGhostTable htAutoSize ".concat(t.trim());return Ge(r,o),n.appendChild(r),{fragment:n,container:r}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}]),t}(),zH=UH;function GH(t){return GH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},GH(t)}function YH(t,e,n){return e=qH(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function XH(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qH(r.key),r)}}function $H(t,e,n){return e&&XH(t.prototype,e),n&&XH(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function qH(t){var e=QH(t,"string");return"symbol"===GH(e)?e:String(e)}function QH(t,e){if("object"!==GH(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==GH(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var JH=function(){function t(e){KH(this,t),this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}return $H(t,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:t.SAMPLE_COUNT}},{key:"setSampleCount",value:function(t){this.customSampleCount=t}},{key:"setAllowDuplicates",value:function(t){this.allowDuplicates=t}},{key:"generateRowSamples",value:function(t,e){return this.generateSamples("row",e,t)}},{key:"generateColumnSamples",value:function(t,e){return this.generateSamples("col",e,t)}},{key:"generateSamples",value:function(t,e,n){var r=this,o=new Map,i="number"===typeof n?{from:n,to:n}:n,a=i.from,l=i.to;return Io(a,l,(function(n){var i=r.generateSample(t,e,n);o.set(n,i)})),o}},{key:"generateSample",value:function(t,e,n){var r=this;if("row"!==t&&"col"!==t)throw new Error("Unsupported sample type");var o=new Map,i="row"===t?"col":"row",a=[];return Io(e.from,e.to,(function(e){var l,s="row"===t?r.dataFactory(n,e):r.dataFactory(e,n),u=s.value,c=s.bundleSeed,f="string"===typeof c&&c.length>0;l=f?c:ht(u)?"".concat(Object.keys(u).length):Array.isArray(u)?"".concat(u.length):"".concat(Jt(u).length),o.has(l)||o.set(l,{needed:r.getSampleCount(),strings:[]});var h=o.get(l);if(h.needed){var d=a.indexOf(u)>-1;(!d||r.allowDuplicates||f)&&(h.strings.push(YH({value:u},i,e)),a.push(u),h.needed-=1)}})),o}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),t}(),ZH=JH;function tN(t){return tN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tN(t)}function eN(t,e){return aN(t)||iN(t,e)||rN(t,e)||nN()}function nN(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rN(t,e){if(t){if("string"===typeof t)return oN(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oN(t,e):void 0}}function oN(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function iN(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function aN(t){if(Array.isArray(t))return t}function lN(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sN(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,cN(r.key),r)}}function uN(t,e,n){return e&&sN(t.prototype,e),n&&sN(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function cN(t){var e=fN(t,"string");return"symbol"===tN(e)?e:String(e)}function fN(t,e){if("object"!==tN(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==tN(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function hN(){return hN="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=dN(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},hN.apply(this,arguments)}function dN(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=wN(t),null===t)break;return t}function pN(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yN(t,e)}function yN(t,e){return yN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},yN(t,e)}function vN(t){var e=bN();return function(){var n,r=wN(t);if(e){var o=wN(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mN(this,n)}}function mN(t,e){if(e&&("object"===tN(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return gN(t)}function gN(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bN(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function wN(t){return wN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wN(t)}mr.getSingleton().register("modifyAutoColumnSizeSeed");var SN="autoColumnSize",CN=10,ON=new WeakMap,kN="autoColumnSize",RN=function(t){pN(n,t);var e=vN(n);function n(t){var r;return lN(this,n),r=e.call(this,t),ON.set(gN(r),{cachedColumnHeaders:[]}),r.ghostTable=new zH(r.hot),r.samplesGenerator=new ZH((function(t,e){var n=r.hot.getCellMeta(t,e),o="";n.spanned||(o=r.hot.getDataAtCell(t,e));var i="";return r.hot.hasHook("modifyAutoColumnSizeSeed")&&(i=r.hot.runHooks("modifyAutoColumnSizeSeed",i,n,o)),{value:o,bundleSeed:i}})),r.firstCalculation=!0,r.inProgress=!1,r.measuredColumns=0,r.columnWidthsMap=new Zm,r.hot.columnIndexMapper.registerMap(kN,r.columnWidthsMap),r.addHook("beforeColumnResize",(function(t,e,n){return r.onBeforeColumnResize(t,e,n)})),r}return uN(n,[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings()[SN]&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[SN];e&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("beforeChangeRender",(function(e){return t.onBeforeChange(e)})),this.addHook("afterFormulasValuesUpdate",(function(e){return t.onAfterFormulasValuesUpdate(e)})),this.addHook("beforeViewRender",(function(e){return t.onBeforeViewRender(e)})),this.addHook("modifyColWidth",(function(e,n){return t.getColumnWidth(n,e)})),this.addHook("afterInit",(function(){return t.onAfterInit()})),hN(wN(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.findColumnsWhereHeaderWasChanged();t.length&&(this.clearCache(t),this.calculateVisibleColumnsWidth()),hN(wN(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=this;hN(wN(n.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",(function(e,n,r){return t.onBeforeColumnResize(e,n,r)}))}},{key:"calculateVisibleColumnsWidth",value:function(){var t=this.hot.countRows();if(t){var e=this.hot.renderCall,n=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();-1!==n&&-1!==r&&this.calculateColumnsWidth({from:n,to:r},void 0,e)}}},{key:"calculateColumnsWidth",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"===typeof e?{from:e,to:e}:e,i="number"===typeof n?{from:n,to:n}:n;Io(o.from,o.to,(function(e){var n=t.hot.toPhysicalColumn(e);if(null===n&&(n=e),r||null===t.columnWidthsMap.getValueAtIndex(n)&&!t.hot._getColWidthFromSettings(n)){var o=t.samplesGenerator.generateColumnSamples(e,i);U(o,(function(e){var n=eN(e,2),r=n[0],o=n[1];return t.ghostTable.addColumn(r,o)}))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((function(){t.ghostTable.getWidths((function(e,n){var r=t.hot.toPhysicalColumn(e);t.columnWidthsMap.setValueAtIndex(r,n)}))}),!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},r=0,o=this.hot.countCols()-1,i=null;this.inProgress=!0;var a=function a(){if(!t.hot)return M(i),void(t.inProgress=!1);t.calculateColumnsWidth({from:r,to:Math.min(r+n.CALCULATION_STEP,o)},e),r=r+n.CALCULATION_STEP+1,r<o?i=P(a):(M(i),t.inProgress=!1,t.hot.view.adjustElementsSize())},l=this.getSyncCalculationLimit();this.firstCalculation&&l>=0&&(this.calculateColumnsWidth({from:0,to:l},e),this.firstCalculation=!1,r=l+1),r<o?a():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings()[SN],e=t&&bt(t,"samplingRatio")?t.samplingRatio:void 0,n=t&&bt(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var t=this.hot.getSettings()[SN],e=n.SYNC_CALCULATION_LIMIT,r=this.hot.countCols()-1;return ht(t)&&(e=t.syncLimit,Ce(e)?e=_o(r,e):e>>=0),Math.min(e,r)}},{key:"getColumnWidth",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e;return void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),n&&"number"===typeof r&&(r=Math.max(r,py.DEFAULT_WIDTH))),r}},{key:"getFirstVisibleColumn",value:function(){var t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){var e=t.wtTable.getFirstVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){var n=t.wtTable.getFirstRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"getLastVisibleColumn",value:function(){var t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){var e=t.wtTable.getLastVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){var n=t.wtTable.getLastRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var t=this.hot.getColHeader(),e=ON.get(this),n=e.cachedColumnHeaders,r=V(t,(function(t,e,r){var o=n.length;return(o-1<r||n[r]!==e)&&t.push(r),o-1<r?n.push(e):n[r]=e,t}),[]);return r}},{key:"clearCache",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length?this.hot.batchExecution((function(){U(e,(function(e){t.columnWidthsMap.setValueAtIndex(e,null)}))}),!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!F(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(function(t){return null===t})).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout((function(){t.hot&&t.recalculateAllColumnsWidth()}),0)}},{key:"onBeforeChange",value:function(t){var e=this,n=W(t,(function(t){var n=eN(t,2),r=n[1];return e.hot.toPhysicalColumn(e.hot.propToCol(r))}));this.clearCache(Array.from(new Set(n)))}},{key:"onBeforeColumnResize",value:function(t,e,n){var r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}},{key:"onAfterInit",value:function(){ON.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(t){var e=F(t,(function(t){var e;return Zt(null===(e=t.address)||void 0===e?void 0:e.col)})),n=W(e,(function(t){return t.address.col}));this.clearCache(Array.from(new Set(n)))}},{key:"destroy",value:function(){this.ghostTable.clean(),hN(wN(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return SN}},{key:"PLUGIN_PRIORITY",get:function(){return CN}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),n}(jH),EN={horizontal:"horizontal",vertical:"vertical"};function PN(t,e,n,r){var o=n.length,i=n?n[0].length:0,a=[],l=e.row-t.row,s=e.col-t.col;if(-1!==["down","up"].indexOf(r)){for(var u=[],c=0;c<s;c++){var f=parseInt(n[0][c],10),h=parseInt(n[o-1][c],10),d=("down"===r?h-f:f-h)/(o-1)||0;u.push(d)}a.push(u)}if(-1!==["right","left"].indexOf(r))for(var p=0;p<l;p++){var y=parseInt(n[p][0],10),v=parseInt(n[p][i-1],10),m=("right"===r?v-y:y-v)/(i-1)||0;a.push([m])}return a}function TN(t,e,n){var r,o,i;return e[0]===t[0]&&e[1]<t[1]?(i="left",r=n(e[0],e[1]),o=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(i="right",r=n(e[0],t[3]+1),o=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(i="up",r=n(e[0],e[1]),o=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(i="down",r=n(t[2]+1,e[1]),o=n(e[2],e[3])),r&&r.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:r,endOfDragCoords:o}}function jN(t){var e={};return!0===t?(e.directions=Object.keys(EN),e.autoInsertRow=!0):ht(t)?(Zt(t.autoInsertRow)?t.direction===EN.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Zt(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(EN)):"string"===typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function AN(t){return AN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AN(t)}function MN(t){return _N(t)||xN(t)||DN(t)||IN()}function IN(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xN(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _N(t){if(Array.isArray(t))return LN(t)}function HN(t,e){return VN(t)||BN(t,e)||DN(t,e)||NN()}function NN(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function DN(t,e){if(t){if("string"===typeof t)return LN(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?LN(t,e):void 0}}function LN(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function BN(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function VN(t){if(Array.isArray(t))return t}function FN(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WN(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zN(r.key),r)}}function UN(t,e,n){return e&&WN(t.prototype,e),n&&WN(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function zN(t){var e=GN(t,"string");return"symbol"===AN(e)?e:String(e)}function GN(t,e){if("object"!==AN(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==AN(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function YN(){return YN="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=KN(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},YN.apply(this,arguments)}function KN(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=tD(t),null===t)break;return t}function XN(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$N(t,e)}function $N(t,e){return $N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},$N(t,e)}function qN(t){var e=ZN();return function(){var n,r=tD(t);if(e){var o=tD(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return QN(this,n)}}function QN(t,e){if(e&&("object"===AN(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return JN(t)}function JN(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ZN(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function tD(t){return tD=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tD(t)}mr.getSingleton().register("modifyAutofillRange"),mr.getSingleton().register("beforeAutofill"),mr.getSingleton().register("afterAutofill");var eD="autofill",nD=20,rD=["fillHandle"],oD="insert_row_below",iD=200,aD=function(t){XN(n,t);var e=qN(n);function n(t){var r;return FN(this,n),r=e.call(this,t),r.eventManager=new Gr(JN(r)),r.addingStarted=!1,r.mouseDownOnCellCorner=!1,r.mouseDragOutside=!1,r.handleDraggedCells=0,r.directions=[],r.autoInsertRow=!1,r}return UN(n,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(function(e){return t.onAfterCellCornerMouseDown(e)})),this.addHook("afterOnCellCornerDblClick",(function(e){return t.onCellCornerDblClick(e)})),this.addHook("beforeOnCellMouseOver",(function(e,n){return t.onBeforeCellMouseOver(n)})),YN(tD(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),YN(tD(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),YN(tD(n.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var t=this,e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner(),r=n.row,o=n.col,i=e.getBottomEndCorner(),a=i.row,l=i.col,s=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:o,endRow:a,endCol:l}]),u=[],c=[],f=[];return U(s,(function(t){for(var e=t.startRow;e<=t.endRow;e+=1)-1===u.indexOf(e)&&u.push(e);for(var n=t.startCol;n<=t.endCol;n+=1)-1===c.indexOf(n)&&c.push(n)})),U(u,(function(e){var n=[];U(c,(function(r){n.push(t.hot.getCopyableData(e,r))})),f.push(n)})),f}},{key:"fillIn",value:function(){var t=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var e=this.hot.selection.highlight.getFill().getVisualCorners(),n=HN(e,4),r=n[0],o=n[1],i=n[2],a=n[3],l=this.hot.getSelectedRangeLast(),s=l.getTopStartCorner(),u=l.getBottomEndCorner();this.resetSelectionOfDraggedArea();var c=[s.row,s.col,u.row,u.col],f=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,r),Math.min(s.col,o),Math.max(u.row,i),Math.max(u.col,a)],c),h=TN(c,f,(function(e,n){return t.hot._createCellCoords(e,n)})),d=h.directionOfDrag,p=h.startOfDragCoords,y=h.endOfDragCoords;if(p&&p.row>-1&&p.col>-1){var v=this.getSelectionData(),m=l.clone(),g=this.hot._createCellRange(p,p,y),b=this.hot.runHooks("beforeAutofill",v,m,g,d);if(!1===b)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var w=PN(p,y,v,d),S=b,C=b;if(["up","left"].indexOf(d)>-1&&(1!==C.length||0!==C[0].length))if(S=[],"up"===d)for(var O=y.row-p.row+1,k=O%C.length,R=0;R<O;R++)S.push(C[(R+(C.length-k))%C.length]);else for(var E=y.col-p.col+1,P=E%C[0].length,T=0;T<C.length;T++){S.push([]);for(var j=0;j<E;j++)S[T].push(C[T][(j+(C[T].length-P))%C[T].length])}this.hot.populateFromArray(p.row,p.col,S,y.row,y.col,"".concat(this.pluginName,".fill"),null,d,w),this.setSelection(f),this.hot.runHooks("afterAutofill",S,m,g,d),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}},{key:"getCoordsOfDragAndDropBorders",value:function(t){var e=this.hot.getSelectedRangeLast(),n=e.getBottomEndCorner(),r=t;if(this.directions.includes(EN.vertical)&&this.directions.includes(EN.horizontal)){var o=e.getTopStartCorner();(n.col<=t.col||o.col>=t.col)&&(r=this.hot._createCellCoords(n.row,t.col)),(n.row<t.row||o.row>t.row)&&(r=this.hot._createCellCoords(t.row,n.col))}else if(this.directions.includes(EN.vertical))r=this.hot._createCellCoords(t.row,n.col);else{if(!this.directions.includes(EN.horizontal))return;r=this.hot._createCellCoords(n.row,t.col)}return this.reduceSelectionAreaIfNeeded(r)}},{key:"showBorder",value:function(t){var e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}},{key:"addRow",value:function(){var t=this;this.hot._registerTimeout((function(){t.hot.alter(oD,void 0,1,"".concat(t.pluginName,".fill")),t.addingStarted=!1}),iD)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){var t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();t[2]<n-1&&e[2]===n-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(t){for(var e,n=this.hot.getData(),r=this.hot.countRows(),o=t[2]+1;o<r;o++){for(var i=t[1];i<=t[3];i++){var a=n[o][i];if(a)return-1}var l=n[o][t[1]-1],s=n[o][t[3]+1];(l||s)&&(e=o)}return e}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}},{key:"setSelection",value:function(t){var e;(e=this.hot).selectCell.apply(e,MN(W(t,(function(t){return Math.max(t,0)}))).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(t){var e=this.hot.rootDocument.documentElement,n=tn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+hn(this.hot.table),r=tn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+fn(this.hot.table);return t.clientY>n&&t.clientX<=r}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()})),this.eventManager.addEventListener(e,"mousemove",(function(e){return t.onMouseMove(e)}))}},{key:"onCellCornerDblClick",value:function(){var t=this.selectAdjacent();t&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(t){var e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var t=jN(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}},{key:"destroy",value:function(){YN(tD(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return eD}},{key:"PLUGIN_PRIORITY",get:function(){return nD}},{key:"SETTING_KEYS",get:function(){return[eD].concat(rD)}}]),n}(jH);function lD(t){return lD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lD(t)}function sD(t,e){return dD(t)||hD(t,e)||cD(t,e)||uD()}function uD(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function cD(t,e){if(t){if("string"===typeof t)return fD(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fD(t,e):void 0}}function fD(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function hD(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function dD(t){if(Array.isArray(t))return t}function pD(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yD(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mD(r.key),r)}}function vD(t,e,n){return e&&yD(t.prototype,e),n&&yD(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function mD(t){var e=gD(t,"string");return"symbol"===lD(e)?e:String(e)}function gD(t,e){if("object"!==lD(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==lD(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function bD(){return bD="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=wD(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},bD.apply(this,arguments)}function wD(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=PD(t),null===t)break;return t}function SD(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&CD(t,e)}function CD(t,e){return CD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},CD(t,e)}function OD(t){var e=ED();return function(){var n,r=PD(t);if(e){var o=PD(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kD(this,n)}}function kD(t,e){if(e&&("object"===lD(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return RD(t)}function RD(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ED(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function PD(t){return PD=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},PD(t)}var TD="autoRowSize",jD=40,AD="autoRowSize",MD=function(t){SD(n,t);var e=OD(n);function n(t){var r;return pD(this,n),r=e.call(this,t),r.rowHeightsMap=void 0,r.headerHeight=null,r.ghostTable=new zH(r.hot),r.samplesGenerator=new ZH((function(t,e){var n;return t>=0?n=r.hot.getDataAtCell(t,e):-1===t&&(n=r.hot.getColHeader(e)),{value:n}})),r.firstCalculation=!0,r.inProgress=!1,r.measuredRows=0,r.rowHeightsMap=new Zm,r.hot.rowIndexMapper.registerMap(AD,r.rowHeightsMap),r.addHook("beforeRowResize",(function(t,e,n){return r.onBeforeRowResize(t,e,n)})),r}return vD(n,[{key:"isEnabled",value:function(){var t=this.hot.getSettings()[TD];return!0===t||ht(t)}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("beforeChangeRender",(function(e){return t.onBeforeChange(e)})),this.addHook("beforeColumnResize",(function(){return t.recalculateAllRowsHeight()})),this.addHook("beforeViewRender",(function(e){return t.onBeforeViewRender(e)})),this.addHook("modifyRowHeight",(function(e,n){return t.getRowHeight(n,e)})),this.addHook("modifyColumnHeaderHeight",(function(){return t.getColumnHeaderHeight()})),bD(PD(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=this;this.headerHeight=null,bD(PD(n.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",(function(e,n,r){return t.onBeforeRowResize(e,n,r)}))}},{key:"calculateRowsHeight",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"===typeof e?{from:e,to:e}:e,i="number"===typeof n?{from:n,to:n}:n;if(null!==this.hot.getColHeader(0)){var a=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(a.get(-1))}Io(o.from,o.to,(function(e){if(r||null===t.rowHeightsMap.getValueAtIndex(e)){var n=t.samplesGenerator.generateRowSamples(e,i);U(n,(function(e){var n=sD(e,2),r=n[0],o=n[1];return t.ghostTable.addRow(r,o)}))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((function(){t.ghostTable.getHeights((function(e,n){e<0?t.headerHeight=n:t.rowHeightsMap.setValueAtIndex(t.hot.toPhysicalRow(e),n)}))}),!0),this.measuredRows=o.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},r=0,o=this.hot.countRows()-1,i=null;this.inProgress=!0;var a=function a(){if(!t.hot)return M(i),void(t.inProgress=!1);t.calculateRowsHeight({from:r,to:Math.min(r+n.CALCULATION_STEP,o)},e),r=r+n.CALCULATION_STEP+1,r<o?i=P(a):(M(i),t.inProgress=!1,t.hot.view.adjustElementsSize(!0),t.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&t.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},l=this.getSyncCalculationLimit();this.firstCalculation&&l>=0&&(this.calculateRowsHeight({from:0,to:l},e),this.firstCalculation=!1,r=l+1),r<o?a():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings()[TD],e=t&&bt(t,"samplingRatio")?t.samplingRatio:void 0,n=t&&bt(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllRowsHeight",value:function(){Ze(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var t=this.hot.getSettings()[TD],e=n.SYNC_CALCULATION_LIMIT,r=this.hot.countRows()-1;return ht(t)&&(e=t.syncLimit,Ce(e)?e=_o(r,e):e>>=0),Math.min(e,r)}},{key:"getRowHeight",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t)),r=e;return null!==n&&n>(e||0)&&(r=n),r}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(t){var e=this,n="number"===typeof t?{from:t,to:t}:t,r=n.from,o=n.to;this.hot.batchExecution((function(){Io(Math.min(r,o),Math.max(r,o),(function(t){e.rowHeightsMap.setValueAtIndex(t,null)}))}),!0)}},{key:"isNeedRecalculate",value:function(){return!!F(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(function(t){return null===t})).length}},{key:"onBeforeViewRender",value:function(){var t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(-1!==n&&-1!==r){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){var o=this.hot.countRows()-1;this.calculateRowsHeight({from:o-e,to:o})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(t,e){this.clearCacheByRange({from:t,to:e}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(t,e,n){var r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout((function(){t.hot&&t.recalculateAllRowsHeight()}),0)}},{key:"onBeforeChange",value:function(t){var e=null;1===t.length?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}},{key:"destroy",value:function(){this.ghostTable.clean(),bD(PD(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return TD}},{key:"PLUGIN_PRIORITY",get:function(){return jD}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),n}(jH),ID=new Map([["indexesSequence",{getListWithInsertedItems:cm,getListWithRemovedItems:fm}],["physicallyIndexed",{getListWithInsertedItems:Nm,getListWithRemovedItems:Dm}]]),xD=function(t){if(!1===ID.has(t))throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return ID.get(t)};function _D(t){return _D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_D(t)}function HD(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ND(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,LD(r.key),r)}}function DD(t,e,n){return e&&ND(t.prototype,e),n&&ND(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function LD(t){var e=BD(t,"string");return"symbol"===_D(e)?e:String(e)}function BD(t,e){if("object"!==_D(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==_D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function VD(){return VD="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=FD(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},VD.apply(this,arguments)}function FD(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=XD(t),null===t)break;return t}function WD(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&UD(t,e)}function UD(t,e){return UD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},UD(t,e)}function zD(t){var e=KD();return function(){var n,r=XD(t);if(e){var o=XD(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return GD(this,n)}}function GD(t,e){if(e&&("object"===_D(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return YD(t)}function YD(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function KD(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function XD(t){return XD=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},XD(t)}var $D=xD("physicallyIndexed"),qD=$D.getListWithInsertedItems,QD=$D.getListWithRemovedItems,JD=function(t){WD(n,t);var e=zD(n);function n(){return HD(this,n),e.call(this,(function(t){return t}))}return DD(n,[{key:"insert",value:function(t,e){var r=dm(this.indexedValues,e);this.indexedValues=qD(r,t,e,this.initValueOrFn),VD(XD(n.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){var e=QD(this.indexedValues,t);this.indexedValues=hm(e,t),VD(XD(n.prototype),"remove",this).call(this,t)}}]),n}(rm),ZD=JD;function tL(t){return tL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tL(t)}function eL(t){return iL(t)||oL(t)||rL(t)||nL()}function nL(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rL(t,e){if(t){if("string"===typeof t)return aL(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?aL(t,e):void 0}}function oL(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function iL(t){if(Array.isArray(t))return aL(t)}function aL(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function lL(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sL(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,cL(r.key),r)}}function uL(t,e,n){return e&&sL(t.prototype,e),n&&sL(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function cL(t){var e=fL(t,"string");return"symbol"===tL(e)?e:String(e)}function fL(t,e){if("object"!==tL(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==tL(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function hL(){return hL="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=dL(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},hL.apply(this,arguments)}function dL(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=wL(t),null===t)break;return t}function pL(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yL(t,e)}function yL(t,e){return yL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},yL(t,e)}function vL(t){var e=bL();return function(){var n,r=wL(t);if(e){var o=wL(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mL(this,n)}}function mL(t,e){if(e&&("object"===tL(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return gL(t)}function gL(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bL(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function wL(t){return wL=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wL(t)}var SL=xD("physicallyIndexed"),CL=SL.getListWithInsertedItems,OL=SL.getListWithRemovedItems,kL=function(t){pL(n,t);var e=vL(n);function n(){return lL(this,n),e.call(this,(function(t){return t}))}return uL(n,[{key:"insert",value:function(t,e){var r=this;this.indexedValues=CL(this.indexedValues,t,e,(function(t,e){return r.getNextValue(e)})),hL(wL(n.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){this.indexedValues=OL(this.indexedValues,t),hL(wL(n.prototype),"remove",this).call(this,t)}},{key:"getNextValue",value:function(t){return Math.max.apply(Math,eL(this.getValues()))+1+t}}]),n}(rm),RL=kL;function EL(t){return EL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},EL(t)}function PL(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TL(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,AL(r.key),r)}}function jL(t,e,n){return e&&TL(t.prototype,e),n&&TL(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function AL(t){var e=ML(t,"string");return"symbol"===EL(e)?e:String(e)}function ML(t,e){if("object"!==EL(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==EL(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function IL(){return IL="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=xL(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},IL.apply(this,arguments)}function xL(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=VL(t),null===t)break;return t}function _L(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&HL(t,e)}function HL(t,e){return HL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},HL(t,e)}function NL(t){var e=BL();return function(){var n,r=VL(t);if(e){var o=VL(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return DL(this,n)}}function DL(t,e){if(e&&("object"===EL(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return LL(t)}function LL(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function BL(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function VL(t){return VL=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},VL(t)}var FL="bindRowsWithHeaders",WL=210,UL="loose",zL=new Map([["loose",ZD],["strict",RL]]),GL=function(t){_L(n,t);var e=NL(n);function n(t){var r;return PL(this,n),r=e.call(this,t),r.headerIndexes=null,r}return jL(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[FL]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[FL];"string"!==typeof e&&(e=UL);var r=zL.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new r),this.addHook("modifyRowHeader",(function(e){return t.onModifyRowHeader(e)})),IL(VL(n.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),IL(VL(n.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}},{key:"destroy",value:function(){IL(VL(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return FL}},{key:"PLUGIN_PRIORITY",get:function(){return WL}}]),n}(jH);function YL(t){return YL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},YL(t)}function KL(t){return QL(t)||qL(t)||$L(t)||XL()}function XL(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $L(t,e){if(t){if("string"===typeof t)return JL(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?JL(t,e):void 0}}function qL(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function QL(t){if(Array.isArray(t))return JL(t)}function JL(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ZL(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tB(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pB(r.key),r)}}function eB(t,e,n){return e&&tB(t.prototype,e),n&&tB(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function nB(){return nB="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=rB(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},nB.apply(this,arguments)}function rB(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=cB(t),null===t)break;return t}function oB(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&iB(t,e)}function iB(t,e){return iB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},iB(t,e)}function aB(t){var e=uB();return function(){var n,r=cB(t);if(e){var o=cB(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lB(this,n)}}function lB(t,e){if(e&&("object"===YL(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return sB(t)}function sB(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function uB(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function cB(t){return cB=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cB(t)}function fB(t,e,n){hB(t,e),e.set(t,n)}function hB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dB(t,e,n){return e=pB(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pB(t){var e=yB(t,"string");return"symbol"===YL(e)?e:String(e)}function yB(t,e){if("object"!==YL(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==YL(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function vB(t,e){var n=bB(t,e,"get");return mB(t,n)}function mB(t,e){return e.get?e.get.call(t):e.value}function gB(t,e,n){var r=bB(t,e,"set");return wB(t,r,n),n}function bB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function wB(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var SB="collapsibleColumns",CB=290,OB=["nestedHeaders"],kB="collapsibleIndicator",RB=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),EB=new WeakMap,PB=function(t){oB(n,t);var e=aB(n);function n(){var t;ZL(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),dB(sB(t),"nestedHeadersPlugin",null),dB(sB(t),"eventManager",new Gr(sB(t))),dB(sB(t),"headerStateManager",null),fB(sB(t),EB,{writable:!0,value:null}),t}return eB(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[SB]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings(),r=e.nestedHeaders;r||Un("You need to configure the Nested Headers plugin in order to use collapsible headers."),gB(this,EB,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(function(){return t.onInit()})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("afterGetColHeader",(function(){return t.onAfterGetColHeader.apply(t,arguments)})),this.addHook("beforeOnCellMouseDown",(function(e,n,r){return t.onBeforeOnCellMouseDown(e,n,r)})),nB(cB(n.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var t=this.hot.getSettings(),e=t.collapsibleColumns;"boolean"===typeof e?this.headerStateManager.mapState((function(t){return{collapsible:t.origColspan>1}})):Array.isArray(e)&&(this.headerStateManager.mapState((function(){return{collapsible:!1}})),this.headerStateManager.mergeStateWith(e))}nB(cB(n.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),gB(this,EB,null),this.nestedHeadersPlugin=null,this.clearButtons(),nB(cB(n.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var t=this.hot.view._wt.getSetting("columnHeaders").length,e=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(t){t&&t.parentNode.removeChild(t)};Io(0,t-1,(function(t){var i=e.childNodes[t],a=n.childNodes[t],l=r?r.childNodes[t]:null;Io(0,i.childNodes.length-1,(function(t){var e=i.childNodes[t].querySelector(".".concat(kB));o(e),a&&a.childNodes[t]&&(e=a.childNodes[t].querySelector(".".concat(kB)),o(e)),r&&l&&l.childNodes[t]&&(e=l.childNodes[t].querySelector(".".concat(kB)),o(e))}))}),!0)}}},{key:"expandSection",value:function(t){this.toggleCollapsibleSection([t],"expand")}},{key:"collapseSection",value:function(t){this.toggleCollapsibleSection([t],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(t){var e=this,n=this.headerStateManager.mapNodes((function(n){var r=n.collapsible,o=n.origColspan,i=n.headerLevel,a=n.columnIndex,l=n.isCollapsed;if(!0===r&&o>1&&(l&&"expand"===t||!l&&"collapse"===t))return{row:e.headerStateManager.levelToRowCoords(i),col:a}}));this.toggleCollapsibleSection(n,t)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(t,e){var n=this;if(!RB.has(e))throw new Error("Unsupported action is passed (".concat(e,")."));if(Array.isArray(t)){var r=F(t,(function(t){var e=t.row;return e<0})),o=r.length>0;U(r,(function(t){var r,i=t.row,a=t.col,l=null!==(r=n.headerStateManager.getHeaderSettings(i,a))&&void 0!==r?r:{},s=l.collapsible,u=l.isCollapsed;if(!s||u&&"collapse"===e||!u&&"expand"===e)return o=!1,!1}));var i=[],a=[];o&&U(r,(function(t){var r=t.row,o=t.col,l=n.headerStateManager.triggerNodeModification(e,r,o),s=l.colspanCompensation,u=l.affectedColumns,c=l.rollbackModification;s>0&&(a.push.apply(a,KL(u)),i.push(c))}));var l=this.getCollapsedColumns(),s=[];"collapse"===e?s=$([].concat(KL(l),a)):"expand"===e&&(s=F(l,(function(t){return!a.includes(t)})));var u=RB.get(e),c=this.hot.runHooks(u.beforeHook,l,s,o);if(!1!==c){this.hot.batchExecution((function(){U(a,(function(t){vB(n,EB).setValueAtIndex(n.hot.toPhysicalColumn(t),u.hideColumn)}))}),!0);var f=this.getCollapsedColumns().length!==l.length;this.hot.runHooks(u.afterHook,l,s,o,f),this.hot.render(),this.hot.view.adjustElementsSize(!0)}else U(i,(function(t){t()}))}}},{key:"getCollapsedColumns",value:function(){return vB(this,EB).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(t,e,n){var r,o,i=null!==(r=this.headerStateManager.getHeaderSettings(n,t))&&void 0!==r?r:{},a=i.collapsible,l=i.origColspan,s=i.isCollapsed,u=a&&l>1&&t>=this.hot.getSettings().fixedColumnsStart,c=e.querySelector(".".concat(kB));u?(c||(c=this.hot.rootDocument.createElement("div"),Ge(c,kB),e.querySelector("div:first-child").appendChild(c)),Ye(c,["collapsed","expanded"]),s?(Ge(c,"collapsed"),Je(c,"+")):(Ge(c,"expanded"),Je(c,"-"))):null===(o=c)||void 0===o||o.remove()}},{key:"onBeforeOnCellMouseDown",value:function(t,e){ze(t.target,kB)&&(ze(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ze(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Zn(t))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(t,e){e||this.updatePlugin()}},{key:"destroy",value:function(){gB(this,EB,null),nB(cB(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return SB}},{key:"PLUGIN_PRIORITY",get:function(){return CB}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[SB].concat(OB)}}]),n}(jH);function TB(t){return TB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TB(t)}function jB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function AB(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?jB(Object(n),!0).forEach((function(e){MB(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jB(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function MB(t,e,n){return e=FB(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IB(t,e){return DB(t)||NB(t,e)||_B(t,e)||xB()}function xB(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _B(t,e){if(t){if("string"===typeof t)return HB(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?HB(t,e):void 0}}function HB(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function NB(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function DB(t){if(Array.isArray(t))return t}function LB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function BB(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,FB(r.key),r)}}function VB(t,e,n){return e&&BB(t.prototype,e),n&&BB(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function FB(t){var e=WB(t,"string");return"symbol"===TB(e)?e:String(e)}function WB(t,e){if("object"!==TB(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==TB(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var UB=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],zB=!1,GB=!0,YB=!0,KB=function(){function t(e,n){LB(this,t),this.hot=e,this.sortingStates=new Ng,this.sortEmptyCells=zB,this.indicator=GB,this.headerAction=YB,this.compareFunctionFactory=void 0,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}return VB(t,[{key:"updateAllColumnsProperties",value:function(t){var e=this;ht(t)&&pt(t,(function(t,n){UB.includes(n)&&(e[n]=t)}))}},{key:"getAllColumnsProperties",value:function(){var t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"===typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}},{key:"getSortOrderOfColumn",value:function(t){var e;return null===(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))||void 0===e?void 0:e.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex((function(e){var n=IB(e,1),r=n[0];return r===t}))}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return 0===this.getNumberOfSortedColumns()}},{key:"isColumnSorted",value:function(t){return ht(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))}},{key:"getSortStates",value:function(){var t=this;if(null===this.sortingStates)return[];var e=this.sortingStates.getEntries();return e.map((function(e){var n=IB(e,2),r=n[0],o=n[1];return AB({column:t.hot.toVisualColumn(r)},o)}))}},{key:"getColumnSortState",value:function(t){var e=this.getSortOrderOfColumn(t);if(Zt(e))return{column:t,sortOrder:e}}},{key:"setSortStates",value:function(t){this.sortingStates.clear();for(var e=0;e<t.length;e+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[e].column),{sortOrder:t[e].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),t}(),XB="asc",$B="desc",qB="colHeader";function QB(t){if(!1===ht(t))return!1;var e=t.column,n=t.sortOrder;return Number.isInteger(e)&&[XB,$B].includes(n)}function JB(t){if(t.some((function(t){return!1===QB(t)})))return!1;var e=t.map((function(t){var e=t.column;return e}));return new Set(e).size===e.length}function ZB(t){if(t!==$B)return t===XB?$B:XB}function tV(t){var e=t.querySelector(".".concat(qB));return e}function eV(t,e){if(t<0||!e.parentNode)return!1;var n=e.parentNode.parentNode.childNodes,r=Array.from(n).indexOf(e.parentNode)-n.length;return-1===r}function nV(t,e,n){return-1===t&&e>=0&&!1===er(n)}var rV="ascending",oV="descending",iV="indicatorDisabled",aV="columnSorting",lV="sortAction",sV=new Map([[XB,rV],[$B,oV]]);function uV(t,e,n,r){var o=[aV];if(r&&o.push(lV),!1===n)return o.push(iV),o;var i=t.getSortOrderOfColumn(e);return Zt(i)&&o.push(sV.get(i)),o}function cV(){return Array.from(sV.values()).concat(lV,iV,aV)}var fV=0,hV=-1,dV=1;function pV(t,e){for(var n=jV(e),r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];t.sort(n.apply(void 0,o))}function yV(t,e,n){var r=e.locale;return function(e,o){var i=n.sortEmptyCells;return"string"===typeof e&&(e=e.toLocaleLowerCase(r)),"string"===typeof o&&(o=o.toLocaleLowerCase(r)),e===o?fV:ee(e)?ee(o)?fV:i&&"asc"===t?hV:dV:ee(o)?i&&"asc"===t?dV:hV:isNaN(e)&&!isNaN(o)?"asc"===t?dV:hV:!isNaN(e)&&isNaN(o)?"asc"===t?hV:dV:(isNaN(e)||isNaN(o)||(e=parseFloat(e),o=parseFloat(o)),e<o?"asc"===t?hV:dV:e>o?"asc"===t?dV:hV:fV)}}var vV="default";function mV(t,e,n){return function(e,r){var o=parseFloat(e),i=parseFloat(r),a=n.sortEmptyCells;if(o===i||isNaN(o)&&isNaN(i))return fV;if(a){if(ee(e))return"asc"===t?hV:dV;if(ee(r))return"asc"===t?dV:hV}return isNaN(o)?dV:isNaN(i)?hV:o<i?"asc"===t?hV:dV:o>i?"asc"===t?dV:hV:fV}}var gV="numeric";function bV(t,e,n){var r=e.checkedTemplate,o=e.uncheckedTemplate,i=n.sortEmptyCells;return function(a,l){var s=ee(a),u=ee(l),c=s?o:a,f=u?o:l,h=c===o||c===r,d=f===o||f===r;if(!1===i){if(s&&!1===u)return dV;if(!1===s&&u)return hV}return!1===h&&d?"asc"===t?hV:dV:h&&!1===d?"asc"===t?dV:hV:!1===h&&!1===d?yV(t,e,n)(a,l):c===o&&f===r?"asc"===t?hV:dV:c===r&&f===o?"asc"===t?dV:hV:fV}}var wV="checkbox";function SV(t,e,n){return function(r,o){var i=n.sortEmptyCells;if(r===o)return fV;if(ee(r))return ee(o)?fV:i&&"asc"===t?hV:dV;if(ee(o))return i&&"asc"===t?dV:hV;var a=e.dateFormat,l=Xt(r,a),s=Xt(o,a);return l.isValid()?s.isValid()?s.isAfter(l)?"asc"===t?hV:dV:s.isBefore(l)?"asc"===t?dV:hV:fV:hV:dV}}var CV="date",OV=Rr("sorting.compareFunctionFactory"),kV=OV.register,RV=OV.getItem,EV=OV.hasItem,PV=Rr("sorting.mainSortComparator"),TV=PV.register,jV=PV.getItem;function AV(t){return EV(t)?RV(t):RV(vV)}function MV(t){return NV(t)||HV(t)||xV(t)||IV()}function IV(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xV(t,e){if(t){if("string"===typeof t)return _V(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_V(t,e):void 0}}function _V(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function HV(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function NV(t){if(Array.isArray(t))return t}function DV(t,e){return function(n,r){var o=MV(n),i=o.slice(1),a=MV(r),l=a.slice(1);return function(n){var r=t[n],o=e[n],a=i[n],s=l[n],u=o.columnSorting,c=u.compareFunctionFactory?u.compareFunctionFactory:AV(o.type),f=c(r,o,u)(a,s);return f}(0)}}function LV(t){return LV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},LV(t)}kV(gV,mV),kV(wV,bV),kV(CV,SV),kV(vV,yV);var BV=["column"],VV=["column"];function FV(t){return GV(t)||zV(t)||UV(t)||WV()}function WV(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function UV(t,e){if(t){if("string"===typeof t)return YV(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?YV(t,e):void 0}}function zV(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function GV(t){if(Array.isArray(t))return YV(t)}function YV(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function KV(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function XV(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?KV(Object(n),!0).forEach((function(e){$V(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):KV(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function $V(t,e,n){return e=eF(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qV(t,e){if(null==t)return{};var n,r,o=QV(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function QV(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function JV(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ZV(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,eF(r.key),r)}}function tF(t,e,n){return e&&ZV(t.prototype,e),n&&ZV(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function eF(t){var e=nF(t,"string");return"symbol"===LV(e)?e:String(e)}function nF(t,e){if("object"!==LV(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==LV(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function rF(){return rF="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=oF(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},rF.apply(this,arguments)}function oF(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=fF(t),null===t)break;return t}function iF(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&aF(t,e)}function aF(t,e){return aF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},aF(t,e)}function lF(t){var e=cF();return function(){var n,r=fF(t);if(e){var o=fF(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return sF(this,n)}}function sF(t,e){if(e&&("object"===LV(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return uF(t)}function uF(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cF(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function fF(t){return fF=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fF(t)}var hF="columnSorting",dF=50,pF="append",yF="replace";TV(hF,DV),mr.getSingleton().register("beforeColumnSort"),mr.getSingleton().register("afterColumnSort");var vF=function(t){iF(n,t);var e=lF(n);function n(t){var r;return JV(this,n),r=e.call(this,t),r.columnStatesManager=null,r.columnMetaCache=null,r.pluginKey=hF,r.indexesSequenceCache=null,r}return tF(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.columnStatesManager=new KB(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Zm((function(e){var n=t.hot.toVisualColumn(e);return null===n&&(n=e),t.getMergedPluginSettings(n)})),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",(function(e,n){return t.onAfterGetColHeader(e,n)})),this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)})),this.addHook("afterOnCellMouseDown",(function(e,n){return t.onAfterOnCellMouseDown(e,n)})),this.addHook("afterInit",(function(){return t.loadOrSortBySettings()})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.hot.view&&this.loadOrSortBySettings(),rF(fF(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=this,e=function(e,n){var r=tV(n);!1!==eV(e,n)&&null!==r&&t.updateHeaderClasses(r)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",(function(){t.hot.removeHook("afterGetColHeader",e)})),this.hot.batchExecution((function(){null!==t.indexesSequenceCache&&(t.hot.rowIndexMapper.setIndexesSequence(t.indexesSequenceCache.getValues()),t.hot.rowIndexMapper.unregisterMap(t.pluginKey))}),!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,rF(fF(n.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(t){var e=this.getSortConfig(),n=this.getNormalizedSortConfigs(t),r=this.areValidSortConfigs(n),o=this.hot.runHooks("beforeColumnSort",e,n,r);!1!==o&&(0===e.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new jm),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",e,r?n:e,r),r&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(t){return Zt(t)?this.columnStatesManager.getColumnSortState(t):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(t){var e=this.getNormalizedSortConfigs(t);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}},{key:"getNormalizedSortConfigs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t]}},{key:"areValidSortConfigs",value:function(t){var e=this.hot.countCols();return JB(t)&&t.every((function(t){var n=t.column;return n<=e&&n>=0}))}},{key:"saveAllSortSettings",value:function(t){var e=this,n=this.columnStatesManager.getAllColumnsProperties(),r=function(t){var n=t.column,r=qV(t,BV);return XV({column:e.hot.toPhysicalColumn(n)},r)};n.initialConfig=W(t,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}},{key:"getAllSavedSortSettings",value:function(){var t=this,e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);var n=e.value,r=function(e){var n=e.column,r=qV(e,VV);return XV({column:t.hot.toVisualColumn(n)},r)};return Zt(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=W(n.initialConfig,r)),n}},{key:"getColumnNextConfig",value:function(t){var e=this.columnStatesManager.getSortOrderOfColumn(t);if(Zt(e)){var n=ZB(e);return Zt(n)?{column:t,sortOrder:n}:void 0}var r=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<r)return{column:t,sortOrder:ZB()}}},{key:"getNextSortConfig",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pF,n=this.columnStatesManager.getIndexOfColumnInSortQueue(t),r=-1!==n,o=this.getSortConfig(),i=this.getColumnNextConfig(t);if(r){if(te(i))return[].concat(FV(o.slice(0,n)),FV(o.slice(n+1)));if(e===pF)return[].concat(FV(o.slice(0,n)),FV(o.slice(n+1)),[i]);if(e===yF)return[].concat(FV(o.slice(0,n)),[i],FV(o.slice(n+1)))}return Zt(i)?o.concat(i):o}},{key:"getPluginColumnConfig",value:function(t){if(ht(t)){var e=t[this.pluginKey];if(ht(e))return e}return{}}},{key:"getMergedPluginSettings",value:function(t){var e=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,t),o=Object.getPrototypeOf(r);return Array.isArray(o.columns)?Object.assign(n,e,this.getPluginColumnConfig(o.columns[t])):_n(o.columns)?Object.assign(n,e,this.getPluginColumnConfig(o.columns(t))):Object.assign(n,e)}},{key:"getFirstCellSettings",value:function(t){var e=this.hot.getCellMeta(0,t),n=Object.create(e);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(t)),n}},{key:"getNumberOfRowsToSort",value:function(t){var e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}},{key:"sortByPresetSortStates",value:function(t){var e=this;if(0!==t.length){for(var n=[],r=this.hot.countRows(),o=function(n){return W(t,(function(t){return e.hot.getDataAtCell(n,t.column)}))},i=0;i<this.getNumberOfRowsToSort(r);i+=1)n.push([this.hot.toPhysicalRow(i)].concat(o(i)));var a=W(n,(function(t){return t[0]}));pV(n,this.pluginKey,W(t,(function(t){return t.sortOrder})),W(t,(function(t){return e.getFirstCellSettings(t.column)})));for(var l=n.length;l<r;l+=1)n.push([l].concat(o(l)));var s=W(n,(function(t){return t[0]})),u=new Map(W(a,(function(t,e){return[t,s[e]]}))),c=W(this.hot.rowIndexMapper.getIndexesSequence(),(function(t){return u.has(t)?u.get(t):t}));this.hot.rowIndexMapper.setIndexesSequence(c)}else this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues())}},{key:"loadOrSortBySettings",value:function(){var t=this.getAllSavedSortSettings();if(ht(t))this.sortBySettings(t);else{var e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}},{key:"sortBySettings",value:function(t){if(ht(t)){this.columnStatesManager.updateAllColumnsProperties(t);var e=t.initialConfig;(Array.isArray(e)||ht(e))&&this.sort(e)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(t,e){var n=tV(e);if(!1!==eV(t,e)&&null!==n){var r=this.getFirstCellSettings(t)[this.pluginKey],o=r.indicator,i=r.headerAction;this.updateHeaderClasses(n,this.columnStatesManager,t,o,i)}}},{key:"updateHeaderClasses",value:function(t){if(Ye(t,cV(t)),!1!==this.enabled){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];Ge(t,uV.apply(void 0,n))}}},{key:"onUpdateSettings",value:function(t){rF(fF(n.prototype),"onUpdateSettings",this).call(this),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Zt(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}},{key:"onAfterLoadData",value:function(t){!0===t&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(t,e){var n=this.getFirstCellSettings(e)[this.pluginKey],r=n.headerAction;return r&&"SPAN"===t.target.nodeName}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){!1!==nV(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(t,e){!1!==nV(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col)),this.sort(this.getColumnNextConfig(e.col)))}},{key:"destroy",value:function(){var t;null===(t=this.columnStatesManager)||void 0===t||t.destroy(),rF(fF(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return hF}},{key:"PLUGIN_PRIORITY",get:function(){return dF}}]),n}(jH);n(4401);function mF(t){return mF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mF(t)}function gF(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bF(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,SF(r.key),r)}}function wF(t,e,n){return e&&bF(t.prototype,e),n&&bF(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function SF(t){var e=CF(t,"string");return"symbol"===mF(e)?e:String(e)}function CF(t,e){if("object"!==mF(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==mF(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var OF,kF=function(){function t(e,n){gF(this,t),this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=n,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return wF(t,[{key:"getEndpoint",value:function(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}},{key:"getAllEndpoints",value:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(t){return this.parseSettings(t.call(this))}},{key:"parseSettings",value:function(t){var e=this,n=[],r=t;if(r||"function"!==typeof this.settings)return r||(r=this.settings),U(r,(function(t){var r={};e.assignSetting(t,r,"ranges",[[0,e.hot.countRows()-1]]),e.assignSetting(t,r,"reversedRowCoords",!1),e.assignSetting(t,r,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),e.assignSetting(t,r,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),e.assignSetting(t,r,"sourceColumn",t.destinationColumn),e.assignSetting(t,r,"type","sum"),e.assignSetting(t,r,"forceNumeric",!1),e.assignSetting(t,r,"suppressDataTypeErrors",!0),e.assignSetting(t,r,"suppressDataTypeErrors",!0),e.assignSetting(t,r,"customFunction",null),e.assignSetting(t,r,"readOnly",!0),e.assignSetting(t,r,"roundFloat",!1),n.push(r)})),n;this.settingsType="function"}},{key:"assignSetting",value:function(t,e,n,r){if("ranges"!==n||void 0!==t[n]){if("ranges"!==n||0!==t[n].length)if(void 0===t[n]){if(r instanceof Error)throw r;e[n]=r}else"destinationRow"===n&&e.reversedRowCoords?e[n]=this.hot.countRows()-t[n]-1:e[n]=t[n]}else e[n]=r}},{key:"resetSetupBeforeStructureAlteration",value:function(t,e,n){if("function"===this.settingsType){var r=t.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();U(o,(function(o){"row"===r&&o.destinationRow>=e&&("insert_row"===t?o.alterRowOffset=n:"remove_row"===t&&(o.alterRowOffset=-1*n)),"col"===r&&o.destinationColumn>=e&&("insert_col"===t?o.alterColumnOffset=n:"remove_col"===t&&(o.alterColumnOffset=-1*n))})),this.resetAllEndpoints(o,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(t,e,n,r,o){var i=this,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"!==this.settingsType){var l=t.indexOf("row")>-1?"row":"col",s=t.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=0===t.indexOf("move_row"),f=e;U(u,(function(t){"row"===l&&t.destinationRow>=f&&(t.alterRowOffset=s*n),"col"===l&&t.destinationColumn>=f&&(t.alterColumnOffset=s*n)})),this.resetAllEndpoints(u,!c),U(u,c?function(t){i.extendEndpointRanges(t,f,r[0],r.length),i.recreatePhysicalRanges(t),i.clearOffsetInformation(t)}:function(t){i.shiftEndpointCoordinates(t,f)}),a&&this.refreshAllEndpoints()}else{var h=function t(){return i.hot.removeHook("beforeViewRender",t),i.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",h)}}},{key:"clearOffsetInformation",value:function(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(t,e,n,r){U(t.ranges,(function(t){t[1]&&(e>=t[0]&&e<=t[1]?n>t[1]?t[1]+=r:n<t[0]&&(t[0]-=r):n>=t[0]&&n<=t[1]&&(t[1]-=r,e<=t[0]&&(t[0]+=1,t[1]+=1)))}))}},{key:"recreatePhysicalRanges",value:function(t){var e=this,n=t.ranges,r=[],o=[];U(n,(function(t){var n=[];if(t[1])for(var r=t[0];r<=t[1];r++)n.push(e.hot.toPhysicalRow(r));else n.push(e.hot.toPhysicalRow(t[0]));o.push(n)})),U(o,(function(t){var e=[];U(t,(function(n,o){0===o?e.push(n):t[o]!==t[o-1]+1&&(e.push(t[o-1]),r.push(e),e=[],e.push(n)),o===t.length-1&&(e.push(n),r.push(e))}))})),t.ranges=r}},{key:"shiftEndpointCoordinates",value:function(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,U(t.ranges,(function(n){U(n,(function(r,o){r>=e&&(n[o]+=t.alterRowOffset||0)}))}))):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.some((function(e){var n=e.alterRowOffset||0,r=e.alterColumnOffset||0;return e.destinationRow+n>=t.hot.countRows()||e.destinationColumn+r>=t.hot.countCols()}));r||(this.cellsToSetCache=[],U(e,(function(e){t.resetEndpointValue(e,n)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var t=this;this.cellsToSetCache=[],U(this.getAllEndpoints(),(function(e){t.currentEndpoint=e,t.plugin.calculate(e),t.setEndpointValue(e,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(t){var e=this,n=[];this.cellsToSetCache=[],U(t,(function(t,r,o){"".concat(t[2]||"")!=="".concat(t[3])&&U(e.getAllEndpoints(),(function(t,i){e.hot.propToCol(o[r][1])===t.sourceColumn&&-1===n.indexOf(i)&&n.push(i)}))})),U(n,(function(t){e.refreshEndpoint(e.getEndpoint(t))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t.alterRowOffset||0,r=t.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(t.destinationRow+(e?n:0)),this.hot.toVisualColumn(t.destinationColumn+(e?r:0)),""])}},{key:"setEndpointValue",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols())this.throwOutOfBoundsWarning();else{var o=this.hot.toVisualRow(t.destinationRow);if(null!==o){var i=this.hot.getCellMeta(o,t.destinationColumn);"init"!==e&&i.readOnly===t.readOnly||(i.readOnly=t.readOnly,i.className="columnSummaryResult")}t.roundFloat&&!isNaN(t.result)&&(t.result=t.result.toFixed(t.roundFloat)),n?this.hot.setDataAtCell(r,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}}},{key:"throwOutOfBoundsWarning",value:function(){Un("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),t}(),RF=kF;function EF(t){return null===t||void 0===t||isNaN(t)}function PF(t){return PF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},PF(t)}function TF(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function jF(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AF(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,IF(r.key),r)}}function MF(t,e,n){return e&&AF(t.prototype,e),n&&AF(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function IF(t){var e=xF(t,"string");return"symbol"===PF(e)?e:String(e)}function xF(t,e){if("object"!==PF(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==PF(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _F(){return _F="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=HF(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},_F.apply(this,arguments)}function HF(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=WF(t),null===t)break;return t}function NF(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&DF(t,e)}function DF(t,e){return DF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},DF(t,e)}function LF(t){var e=FF();return function(){var n,r=WF(t);if(e){var o=WF(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return BF(this,n)}}function BF(t,e){if(e&&("object"===PF(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return VF(t)}function VF(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function FF(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function WF(t){return WF=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},WF(t)}var UF="columnSummary",zF=220,GF=function(t){NF(n,t);var e=LF(n);function n(t){var r;return jF(this,n),r=e.call(this,t),r.endpoints=null,r}return MF(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[UF]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings()[UF],this.endpoints=new RF(this,this.settings),this.addHook("afterInit",(function(){return t.onAfterInit.apply(t,arguments)})),this.addHook("afterChange",(function(){return t.onAfterChange.apply(t,arguments)})),this.addHook("beforeCreateRow",(function(e,n,r){return t.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,n,null,r)})),this.addHook("beforeCreateCol",(function(e,n,r){return t.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,n,null,r)})),this.addHook("beforeRemoveRow",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupBeforeStructureAlteration.apply(e,["remove_row"].concat(r))})),this.addHook("beforeRemoveCol",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupBeforeStructureAlteration.apply(e,["remove_col"].concat(r))})),this.addHook("afterCreateRow",(function(e,n,r){return t.endpoints.resetSetupAfterStructureAlteration("insert_row",e,n,null,r)})),this.addHook("afterCreateCol",(function(e,n,r){return t.endpoints.resetSetupAfterStructureAlteration("insert_col",e,n,null,r)})),this.addHook("afterRemoveRow",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupAfterStructureAlteration.apply(e,["remove_row"].concat(r))})),this.addHook("afterRemoveCol",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupAfterStructureAlteration.apply(e,["remove_col"].concat(r))})),this.addHook("afterRowMove",(function(){return t.onAfterRowMove.apply(t,arguments)})),_F(WF(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":t.result=this.calculateMinMax(t,t.type);break;case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t);break;default:break}}},{key:"calculateSum",value:function(t){var e=this,n=0;return pt(t.ranges,(function(r){n+=e.getPartialSum(r,t.sourceColumn)})),n}},{key:"getPartialSum",value:function(t,e){var n=0,r=t[1]||t[0],o=null,i=0;do{if(o=this.getCellValue(r,e),o=EF(o)?null:o,null!==o){var a=("".concat(o).split(".")[1]||[]).length||1;a>i&&(i=a)}n+=o||0,r-=1}while(r>=t[0]);return Math.round(n*Math.pow(10,i))/Math.pow(10,i)}},{key:"calculateMinMax",value:function(t,e){var n=this,r=null;return pt(t.ranges,(function(o){var i=n.getPartialMinMax(o,t.sourceColumn,e);if(null===r&&null!==i&&(r=i),null!==i)switch(e){case"min":r=Math.min(r,i);break;case"max":r=Math.max(r,i);break;default:break}})),null===r?"Not enough data":r}},{key:"getPartialMinMax",value:function(t,e,n){var r,o=null,i=t[1]||t[0];do{if(r=this.getCellValue(i,e),r=EF(r)?null:r,null===o)o=r;else if(null!==r)switch(n){case"min":o=Math.min(o,r);break;case"max":o=Math.max(o,r);break;default:break}i-=1}while(i>=t[0]);return o}},{key:"countEmpty",value:function(t,e){var n,r=0,o=t[1]||t[0];do{n=this.getCellValue(o,e),n=EF(n)?null:n,null===n&&(r+=1),o-=1}while(o>=t[0]);return r}},{key:"countEntries",value:function(t){var e=this,n=0,r=t.ranges;return pt(r,(function(r){var o=void 0===r[1]?1:r[1]-r[0]+1,i=e.countEmpty(r,t.sourceColumn);n+=o,n-=i})),n}},{key:"calculateAverage",value:function(t){var e=this.calculateSum(t),n=this.countEntries(t);return e/n}},{key:"getCellValue",value:function(t,e){var n=this.hot.toVisualRow(t),r=this.hot.toVisualColumn(e),o=this.hot.getSourceDataAtCell(t,e),i="";if(null!==n&&null!==r&&(i=this.hot.getCellMeta(n,r).className||""),i.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"===typeof o&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error($t(OF||(OF=TF(["ColumnSummary plugin: cell at (",", ",") is not in a \n          numeric format. Cannot do the calculation."],["ColumnSummary plugin: cell at (",", ",") is not in a\\x20\n          numeric format. Cannot do the calculation."])),t,e));return o}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}},{key:"onAfterRowMove",value:function(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return UF}},{key:"PLUGIN_PRIORITY",get:function(){return zF}}]),n}(jH);function YF(t){return YF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},YF(t)}function KF(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function XF(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qF(r.key),r)}}function $F(t,e,n){return e&&XF(t.prototype,e),n&&XF(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function qF(t){var e=QF(t,"string");return"symbol"===YF(e)?e:String(e)}function QF(t,e){if("object"!==YF(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==YF(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var JF=function(){function t(e,n){KF(this,t),this.rootDocument=e,this.isRtl=n,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return $F(t,[{key:"setPosition",value:function(t,e){this.editorStyle.left="".concat(t,"px"),this.editorStyle.top="".concat(e,"px")}},{key:"setSize",value:function(t,e){if(t&&e){var n=this.getInputElement();n.style.width="".concat(t,"px"),n.style.height="".concat(e,"px")}}},{key:"getSize",value:function(){return{width:fn(this.getInputElement()),height:hn(this.getInputElement())}}},{key:"resetSize",value:function(){var t=this.getInputElement();t.style.width="",t.style.height=""}},{key:"setReadOnlyState",value:function(t){var e=this.getInputElement();e.readOnly=t}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return"block"===this.editorStyle.display}},{key:"setValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=t||"";this.getInputElement().value=e}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Ge(this.container,t.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Ge(e,t.CLASS_EDITOR),Ge(n,t.CLASS_INPUT),e.appendChild(n),this.container.appendChild(e),e}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(t.CLASS_INPUT))}},{key:"destroy",value:function(){var t=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,t&&t.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),t}(),ZF=JF,tW="---------";function eW(){return{name:tW}}function nW(t){return W(t,(function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}}))}function rW(t){return ze(t,"htSeparator")}function oW(t){return ze(t,"htSubmenu")}function iW(t){return ze(t,"htDisabled")}function aW(t){return ze(t,"htSelectionDisabled")}function lW(t){var e=t.getSelected();return e?e[0]<0?null:e:null}function sW(t,e){if(-1!==t.indexOf(e))return t;var n=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(n," ").concat(e)}function uW(t,e){if(-1!==t.indexOf(e))return t;var n=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(n," ").concat(e)}function cW(t,e){var n={};return U(t,(function(t){t.forAll((function(t,r){t>=0&&r>=0&&(n[t]||(n[t]=[]),n[t][r]=e(t,r))}))})),n}function fW(t,e,n,r,o){U(t,(function(t){t.forAll((function(t,i){t>=0&&i>=0&&hW(t,i,e,n,r,o)}))}))}function hW(t,e,n,r,o,i){var a=o(t,e),l=r;a.className&&(l="vertical"===n?sW(a.className,r):uW(a.className,r)),i(t,e,"className",l)}function dW(t,e){var n=!1;return Array.isArray(t)&&U(t,(function(t){return t.forAll((function(t,r){if(t>=0&&r>=0&&e(t,r))return n=!0,!1})),n})),n}function pW(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function yW(t,e){return!t.hidden||!("function"===typeof t.hidden&&t.hidden.call(e))}function vW(t,e){for(var n=t.slice(0),r=0;r<n.length;){if(n[r].name!==e)break;n.shift()}return n}function mW(t,e){var n=t.slice(0);return n.reverse(),n=vW(n,e),n.reverse(),n}function gW(t){var e=[];return U(t,(function(t,n){n>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)})),e}function bW(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tW,n=t.slice(0);return n=vW(n,e),n=mW(n,e),n=gW(n),n}function wW(t){return wW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wW(t)}function SW(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function CW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kW(r.key),r)}}function OW(t,e,n){return e&&CW(t.prototype,e),n&&CW(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function kW(t){var e=RW(t,"string");return"symbol"===wW(e)?e:String(e)}function RW(t,e){if("object"!==wW(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==wW(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var EW=250,PW=250,TW=function(){function t(e){SW(this,t),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}return OW(t,[{key:"hide",value:function(){var t=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout((function(){!1===t.wasLastActionShow&&t.runLocalHooks("hide")}),PW)}},{key:"show",value:function(t){this.wasLastActionShow=!0,this.showDebounced(t)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:EW;this.showDebounced=Dn((function(e){t.wasLastActionShow&&t.runLocalHooks("show",e.from.row,e.from.col)}),e)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),t}();ct(TW,qv);var jW=TW;function AW(t){return AW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AW(t)}function MW(t,e,n){return e=HW(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IW(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,HW(r.key),r)}}function _W(t,e,n){return e&&xW(t.prototype,e),n&&xW(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function HW(t){var e=NW(t,"string");return"symbol"===AW(e)?e:String(e)}function NW(t,e){if("object"!==AW(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==AW(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function DW(){return DW="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=LW(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},DW.apply(this,arguments)}function LW(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=GW(t),null===t)break;return t}function BW(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&VW(t,e)}function VW(t,e){return VW=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},VW(t,e)}function FW(t){var e=zW();return function(){var n,r=GW(t);if(e){var o=GW(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return WW(this,n)}}function WW(t,e){if(e&&("object"===AW(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return UW(t)}function UW(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zW(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function GW(t){return GW=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},GW(t)}var YW="comments",KW=60,XW=new WeakMap,$W="comment",qW="value",QW="style",JW="readOnly",ZW=function(t){BW(n,t);var e=FW(n);function n(t){var r;return IW(this,n),r=e.call(this,t),r.editor=null,r.displaySwitch=null,r.eventManager=null,r.range={},r.preventEditorAutoSwitch=!1,XW.set(UW(r),{tempEditorDimensions:{},cellBelowCursor:null}),r}return _W(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[YW]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.editor||(this.editor=new ZF(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Gr(this)),this.displaySwitch||(this.displaySwitch=new jW(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(function(e){return t.addToContextMenu(e)})),this.addHook("afterRenderer",(function(e,n,r,o,i,a){return t.onAfterRenderer(e,a)})),this.addHook("afterScrollHorizontally",(function(){return t.hide()})),this.addHook("afterScrollVertically",(function(){return t.hide()})),this.addHook("afterBeginEditing",(function(){return t.hide()})),this.displaySwitch.addLocalHook("hide",(function(){return t.hide()})),this.displaySwitch.addLocalHook("show",(function(e,n){return t.showAtCell(e,n)})),this.registerListeners(),DW(GW(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),DW(GW(n.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){DW(GW(n.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var t=this,e=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(e,"mousedown",(function(e){return t.onMouseDown(e)})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()})),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",(function(){return t.onEditorBlur()})),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",(function(e){return t.onEditorMouseDown(e)})),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",(function(e){return t.onEditorMouseUp(e)}))}},{key:"setRange",value:function(t){this.range=t}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(t){var e=Ne(t.target,"TD","TBODY");return!!(e&&ze(e,"htCommentCell")&&Ne(e,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(t){return this.editor.getInputElement()===t.target}},{key:"setComment",value:function(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.editor.getValue(),n="";null!==t&&void 0!==t?n=t:null!==e&&void 0!==e&&(n=e);var r=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(r,o,MW({},qW,n)),this.hot.render()}},{key:"setCommentAtCell",value:function(t,e,n){this.setRange({from:this.hot._createCellCoords(t,e)}),this.setComment(n)}},{key:"removeComment",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,$W),t&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(t,e)}),this.removeComment(n)}},{key:"getComment",value:function(){var t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,qW)}},{key:"getCommentAtCell",value:function(t,e){return this.getCommentMeta(t,e,qW)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.range.from,e=t.row,n=t.col;if(e<0||e>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;var r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(r[$W]?r[$W][qW]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(t,e){return this.setRange({from:this.hot._createCellCoords(t,e)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(n||this.range.from&&this.editor.isVisible()){var r=this.hot,o=r.rowIndexMapper,i=r.columnIndexMapper,a=this.range.from,l=a.row,s=a.col,u=o.getRenderableFromVisualIndex(l),c=i.getRenderableFromVisualIndex(s),f=null===u;this.editor.setPosition(0,0),null===u&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(l,-1))),null===c&&(c=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1)));var h=null===u,d=null===c;u=null!==(t=u)&&void 0!==t?t:0,c=null!==(e=c)&&void 0!==e?e:0;var p=this.hot,y=p.rootWindow,v=p.view._wt,m=v.wtTable,g=v.getCell({row:u,col:c},!0),b=this.getCommentMeta(l,s,QW);b?this.editor.setSize(b.width,b.height):this.editor.resetSize();var w=d?0:m.getStretchedColumnWidth(c),S=f&&!h?hn(g):0,C=g.getBoundingClientRect(),O=C.left,k=C.top,R=C.width,E=C.height,P=this.editor.getSize(),T=P.width,j=P.height,A=this.hot.rootWindow,M=A.innerWidth,I=A.innerHeight,x=this.hot.rootDocument.documentElement,_=O+y.scrollX+w,H=k+y.scrollY+S;this.hot.isRtl()&&(_-=T+w),this.hot.isLtr()&&O+R+T>M?_=O+y.scrollX-T-1:this.hot.isRtl()&&_<-(x.scrollWidth-x.clientWidth)&&(_=O+y.scrollX+w+1),k+j>I&&(H-=j-E+1),this.editor.setPosition(_,H),this.editor.setReadOnlyState(this.getCommentMeta(l,s,JW))}}},{key:"checkSelectionCommentsConsistency",value:function(){var t=this.hot.getSelectedRangeLast();if(!t)return!1;var e=!1,n=t.getTopStartCorner();return this.getCommentMeta(n.row,n.col,qW)&&(e=!0),e}},{key:"updateCommentMeta",value:function(t,e,n){var r,o=this.hot.getCellMeta(t,e)[$W];o?(r=st(o),lt(r,n)):r=n,this.hot.setCellMeta(t,e,$W,r)}},{key:"getCommentMeta",value:function(t,e,n){var r=this.hot.getCellMeta(t,e);if(r[$W])return r[$W][n]}},{key:"onMouseDown",value:function(t){if(this.hot.view&&this.hot.view._wt&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(t)){var e=Ne(t.target,"TD","TBODY"),n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}},{key:"onMouseOver",value:function(t){var e=XW.get(this),n=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||ze(t.target,"wtBorder")||e.cellBelowCursor===t.target)&&this.editor)if(e.cellBelowCursor=n.elementFromPoint(t.clientX,t.clientY),this.targetIsCellWithComment(t)){var r=this.hot._createCellRange(this.hot.getCoords(t.target));this.displaySwitch.show(r)}else Le(t.target,n)&&!this.targetIsCommentTextArea(t)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(t,e){e[$W]&&e[$W][qW]&&Ge(t,e.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(t){var e=XW.get(this);e.tempEditorDimensions={width:fn(t.target),height:hn(t.target)}}},{key:"onEditorMouseUp",value:function(t){var e=XW.get(this),n=fn(t.target),r=hn(t.target);n===e.tempEditorDimensions.width+1&&r===e.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,MW({},QW,{width:n,height:r}))}},{key:"onContextMenuAddComment",value:function(){var t=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:t.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var t=this,e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((function(e,n){e>=0&&n>=0&&t.removeCommentAtCell(e,n,!1)})),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var t=this,e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((function(e,n){if(e>=0&&n>=0){var r=!!t.getCommentMeta(e,n,JW);t.updateCommentMeta(e,n,MW({},JW,!r))}}))}},{key:"addToContextMenu",value:function(t){var e=this,n=function(){return e.hot.rowIndexMapper.getRenderableIndexesLength()>0&&e.hot.columnIndexMapper.getRenderableIndexesLength()>0};t.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return e.checkSelectionCommentsConsistency()?e.hot.getTranslatedPhrase(tS):e.hot.getTranslatedPhrase(Zw)},callback:function(){return e.onContextMenuAddComment()},disabled:function(){return!n()||!(e.hot.getSelectedLast()&&!e.hot.selection.isSelectedByCorner())}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(eS)},callback:function(){return e.onContextMenuRemoveComment()},disabled:function(){return!n()||!(e.hot.getSelectedLast()&&!e.hot.selection.isSelectedByCorner())}},{key:"commentsReadOnly",name:function(){var t=this,e=this.getTranslatedPhrase(nS),n=dW(this.getSelectedRangeLast(),(function(e,n){var r=t.getCellMeta(e,n)[$W];if(r&&(r=r[JW]),r)return!0}));return n&&(e=pW(e)),e},callback:function(){return e.onContextMenuMakeReadOnly()},disabled:function(){return!n()||(!(e.hot.getSelectedLast()&&!e.hot.selection.isSelectedByCorner())||!e.checkSelectionCommentsConsistency())}})}},{key:"getDisplayDelaySetting",value:function(){var t=this.hot.getSettings()[YW];if(ht(t))return t.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),DW(GW(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return YW}},{key:"PLUGIN_PRIORITY",get:function(){return KW}}]),n}(jH);function tU(t){return tU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tU(t)}function eU(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nU(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,oU(r.key),r)}}function rU(t,e,n){return e&&nU(t.prototype,e),n&&nU(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function oU(t){var e=iU(t,"string");return"symbol"===tU(e)?e:String(e)}function iU(t,e){if("object"!==tU(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==tU(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var aU=function(){function t(e){eU(this,t),this.hot=e,this.commands={},this.commonCallback=null}return rU(t,[{key:"registerCommand",value:function(t,e){this.commands[t]=e}},{key:"setCommonCallback",value:function(t){this.commonCallback=t}},{key:"execute",value:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=t.split(":"),a=i[0],l=2===i.length?i[1]:null,s=this.commands[a];if(!s)throw new Error("Menu command '".concat(a,"' not exists."));if(l&&s.submenu&&(s=lU(l,s.submenu.items)),!0!==s.disabled&&("function"!==typeof s.disabled||!0!==s.disabled.call(this.hot))&&!bt(s,"submenu")){var u=[];"function"===typeof s.callback&&u.push(s.callback),"function"===typeof this.commonCallback&&u.push(this.commonCallback),r.unshift(i.join(":")),U(u,(function(t){return t.apply(e.hot,r)}))}}}]),t}();function lU(t,e){var n;return U(e,(function(e){var r=e.key?e.key.split(":"):null;if(Array.isArray(r)&&r[1]===t)return n=e,!1})),n}var sU=aU,uU="alignment";function cU(){return{key:uU,name:function(){return this.getTranslatedPhrase(rS)},disabled:function(){return 0===this.countRows()||0===this.countCols()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(uU,":left"),name:function(){var t=this,e=this.getTranslatedPhrase(oS),n=dW(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htLeft"))return!0}));return n&&(e=pW(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=cW(e,(function(e,n){return t.getCellMeta(e,n).className})),r="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",n,e,r,o),fW(e,r,o,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{key:"".concat(uU,":center"),name:function(){var t=this,e=this.getTranslatedPhrase(iS),n=dW(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htCenter"))return!0}));return n&&(e=pW(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=cW(e,(function(e,n){return t.getCellMeta(e,n).className})),r="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",n,e,r,o),fW(e,r,o,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{key:"".concat(uU,":right"),name:function(){var t=this,e=this.getTranslatedPhrase(aS),n=dW(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htRight"))return!0}));return n&&(e=pW(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=cW(e,(function(e,n){return t.getCellMeta(e,n).className})),r="horizontal",o="htRight";this.runHooks("beforeCellAlignment",n,e,r,o),fW(e,r,o,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{key:"".concat(uU,":justify"),name:function(){var t=this,e=this.getTranslatedPhrase(lS),n=dW(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htJustify"))return!0}));return n&&(e=pW(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=cW(e,(function(e,n){return t.getCellMeta(e,n).className})),r="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",n,e,r,o),fW(e,r,o,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{name:tW},{key:"".concat(uU,":top"),name:function(){var t=this,e=this.getTranslatedPhrase(sS),n=dW(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htTop"))return!0}));return n&&(e=pW(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=cW(e,(function(e,n){return t.getCellMeta(e,n).className})),r="vertical",o="htTop";this.runHooks("beforeCellAlignment",n,e,r,o),fW(e,r,o,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{key:"".concat(uU,":middle"),name:function(){var t=this,e=this.getTranslatedPhrase(uS),n=dW(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htMiddle"))return!0}));return n&&(e=pW(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=cW(e,(function(e,n){return t.getCellMeta(e,n).className})),r="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",n,e,r,o),fW(e,r,o,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{key:"".concat(uU,":bottom"),name:function(){var t=this,e=this.getTranslatedPhrase(cS),n=dW(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htBottom"))return!0}));return n&&(e=pW(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=cW(e,(function(e,n){return t.getCellMeta(e,n).className})),r="vertical",o="htBottom";this.runHooks("beforeCellAlignment",n,e,r,o),fW(e,r,o,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1}]}}}var fU="clear_column";function hU(){return{key:fU,name:function(){return this.getTranslatedPhrase(Uw)},callback:function(t,e){var n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled:function(){var t=lW(this);return!t||!this.selection.isSelectedByColumnHeader()}}}var dU="col_left";function pU(){return{key:dU,name:function(){return this.getTranslatedPhrase(Nw)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=lW(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var e=this.countCols();return 0===e}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var yU="col_right";function vU(){return{key:yU,name:function(){return this.getTranslatedPhrase(Dw)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=lW(this);return!t||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden:function(){return!this.getSettings().allowInsertColumn}}}var mU="make_read_only";function gU(){return{key:mU,name:function(){var t=this,e=this.getTranslatedPhrase(Ww),n=dW(this.getSelectedRange(),(function(e,n){return t.getCellMeta(e,n).readOnly}));return n&&(e=pW(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=dW(e,(function(e,n){return t.getCellMeta(e,n).readOnly}));U(e,(function(e){e.forAll((function(e,r){e>=0&&r>=0&&t.setCellMeta(e,r,"readOnly",!n)}))})),this.render()},disabled:function(){return!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))}}}var bU="redo";function wU(){return{key:bU,name:function(){return this.getTranslatedPhrase(Fw)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function SU(t,e){return EU(t)||RU(t,e)||OU(t,e)||CU()}function CU(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function OU(t,e){if(t){if("string"===typeof t)return kU(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kU(t,e):void 0}}function kU(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function RU(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function EU(t){if(Array.isArray(t))return t}var PU="remove_col";function TU(){return{key:PU,name:function(){var t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{var n=SU(t[0],4),r=n[1],o=n[3];r-o!==0&&(e=1)}return this.getTranslatedPhrase(Bw,e)},callback:function(){this.alter("remove_col",BR(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=lW(this);if(!t)return!0;var e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function jU(t,e){return _U(t)||xU(t,e)||MU(t,e)||AU()}function AU(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function MU(t,e){if(t){if("string"===typeof t)return IU(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?IU(t,e):void 0}}function IU(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function xU(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function _U(t){if(Array.isArray(t))return t}var HU="remove_row";function NU(){return{key:HU,name:function(){var t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{var n=jU(t[0],3),r=n[0],o=n[2];r-o!==0&&(e=1)}return this.getTranslatedPhrase(Lw,e)},callback:function(){this.alter("remove_row",VR(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=lW(this);if(!t)return!0;var e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden:function(){return!this.getSettings().allowRemoveRow}}}var DU="row_above";function LU(){return{key:DU,name:function(){return this.getTranslatedPhrase(_w)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=lW(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var e=this.countRows();return 0===e}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var BU="row_below";function VU(){return{key:BU,name:function(){return this.getTranslatedPhrase(Hw)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=lW(this);return!t||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}}var FU="no_items";function WU(){return{key:FU,name:function(){return this.getTranslatedPhrase(xw)},disabled:!0,isCommand:!1}}var UU,zU="undo";function GU(){return{key:zU,name:function(){return this.getTranslatedPhrase(Vw)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function YU(t){return YU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},YU(t)}function KU(t,e,n){return e=XU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XU(t){var e=$U(t,"string");return"symbol"===YU(e)?e:String(e)}function $U(t,e){if("object"!==YU(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==YU(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var qU=[DU,BU,dU,yU,fU,HU,PU,zU,bU,mU,uU,tW,FU],QU=(UU={},KU(UU,tW,eW),KU(UU,FU,WU),KU(UU,DU,LU),KU(UU,BU,VU),KU(UU,dU,pU),KU(UU,yU,vU),KU(UU,fU,hU),KU(UU,HU,NU),KU(UU,PU,TU),KU(UU,zU,GU),KU(UU,bU,wU),KU(UU,mU,gU),KU(UU,uU,cU),UU);function JU(){var t={};return pt(QU,(function(e,n){t[n]=e()})),t}function ZU(t){return ZU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ZU(t)}function tz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ez(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,rz(r.key),r)}}function nz(t,e,n){return e&&ez(t.prototype,e),n&&ez(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function rz(t){var e=oz(t,"string");return"symbol"===ZU(e)?e:String(e)}function oz(t,e){if("object"!==ZU(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ZU(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var iz=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;tz(this,t),this.hot=e,this.predefinedItems=JU(),this.defaultOrderPattern=n}return nz(t,[{key:"setPredefinedItems",value:function(t){var e=this,n={};this.defaultOrderPattern.length=0,pt(t,(function(t,r){var o="";t.name===tW?(n[tW]=t,o=tW):isNaN(parseInt(r,10))?(t.key=void 0===t.key?r:t.key,n[r]=t,o=t.key):(n[t.key]=t,o=t.key),e.defaultOrderPattern.push(o)})),this.predefinedItems=n}},{key:"getItems",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return az(t,this.defaultOrderPattern,this.predefinedItems)}}]),t}();function az(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],o=t;return o&&o.items?o=o.items:Array.isArray(o)||(o=e),ht(o)?pt(o,(function(t,e){var o=n["string"===typeof t?t:e];o||(o=t),ht(t)?at(o,t):"string"===typeof o&&(o={name:o}),void 0===o.key&&(o.key=e),r.push(o)})):U(o,(function(t,e){var o=n[t];!o&&qU.indexOf(t)>=0||(o||(o={name:t,key:"".concat(e)}),ht(t)&&at(o,t),void 0===o.key&&(o.key=e),r.push(o))})),r}var lz=iz;function sz(t){return sz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sz(t)}function uz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cz(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,hz(r.key),r)}}function fz(t,e,n){return e&&cz(t.prototype,e),n&&cz(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function hz(t){var e=dz(t,"string");return"symbol"===sz(e)?e:String(e)}function dz(t,e){if("object"!==sz(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==sz(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var pz=function(){function t(e,n){uz(this,t);var r,o,i,a,l,s,u=en(n),c=nn(n);this.rootWindow=n,this.type=this.getSourceType(e),"literal"===this.type?(r=parseInt(e.top,10),i=parseInt(e.left,10),l=e.height||0,s=e.width||0,o=r,a=i,r+=u,i+=c):"event"===this.type&&(r=parseInt(e.pageY,10),i=parseInt(e.pageX,10),l=e.target.clientHeight,s=e.target.clientWidth,o=r-u,a=i-c),this.top=r,this.topRelative=o,this.left=i,this.leftRelative=a,this.scrollTop=u,this.scrollLeft=c,this.cellHeight=l,this.cellWidth=s}return fz(t,[{key:"getSourceType",value:function(t){var e="literal";return t instanceof Event&&(e="event"),e}},{key:"fitsAbove",value:function(t){return this.topRelative>=t.offsetHeight}},{key:"fitsBelow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}},{key:"fitsOnRight",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}},{key:"fitsOnLeft",value:function(t){return this.leftRelative>=t.offsetWidth}}]),t}(),yz=pz;function vz(t){return vz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vz(t)}function mz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function gz(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?mz(Object(n),!0).forEach((function(e){bz(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mz(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function bz(t,e,n){return e=Oz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sz(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Oz(r.key),r)}}function Cz(t,e,n){return e&&Sz(t.prototype,e),n&&Sz(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Oz(t){var e=kz(t,"string");return"symbol"===vz(e)?e:String(e)}function kz(t,e){if("object"!==vz(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==vz(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Rz=215,Ez="menu",Pz=Ez,Tz=function(){function t(e,n){wz(this,t),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:Rz,container:this.hot.rootDocument.documentElement},this.eventManager=new Gr(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return Cz(t,[{key:"registerEvents",value:function(){var t=this,e=this.hot.rootWindow;while(e)this.eventManager.addEventListener(e.document,"mousedown",(function(e){return t.onDocumentMouseDown(e)})),this.eventManager.addEventListener(e.document,"contextmenu",(function(e){return t.onDocumentContextMenu(e)})),e=_e(e)}},{key:"setMenuItems",value:function(t){this.menuItems=t}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset[t]=e}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var t=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var e=Dn((function(e){return t.openSubMenu(e)}),300),n=this.options.minWidth||Rz,r=!1,o=F(this.menuItems,(function(e){return e.key===FU&&(r=!0),yW(e,t.hot)}));if(o.length<1&&!r)o.push(JU()[FU]);else if(0===o.length)return;o=bW(o,tW);var i=!1,a={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(t){return Zt(t)&&t<n?n:t},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(e,n,r,o,i,a){return t.menuItemRenderer(e,n,r,o,i,a)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(n,r){t.isAllSubMenusClosed()?e(r.row):t.openSubMenu(r.row)},rowHeights:function(t){return o[t].name===tW?1:23},afterOnCellContextMenu:function(e){e.preventDefault(),Lt()&&i&&t.hasSelectedItem()&&t.close(!0)},beforeOnCellMouseUp:function(e){t.hasSelectedItem()&&(i=!t.isCommandPassive(t.getSelectedItem()),t.executeCommand(e))},afterOnCellMouseUp:function(e){Lt()&&er(e)||!i||!t.hasSelectedItem()||(Ht()||Dt()?setTimeout((function(){return t.close(!0)}),325):t.close(!0))},afterUnlisten:function(){!t.hasSelectedItem()&&t.isOpened()&&t.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new UT(this.container,a),this.hotMenu.addHook("afterInit",(function(){return t.onAfterInit()})),this.hotMenu.addHook("afterSelection",(function(){return t.onAfterSelection.apply(t,arguments)})),this.hotMenu.init(),this.hotMenu.listen();var l=this.hotMenu.getShortcutManager(),s=l.addContext(Pz),u={group:Ez},c=gz(gz({},u),{},{runOnlyIf:function(e){return!1===jn(e.target)||!1===t.container.contains(e.target)}});l.setActiveContextName("menu"),s.addShortcuts([{keys:[["Escape"]],callback:function(){t.keyEvent=!0,t.close(),t.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var e=t.hotMenu.getSelectedLast();t.keyEvent=!0,e?t.selectNextCell(e[0],e[1]):t.selectFirstCell(),t.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var e=t.hotMenu.getSelectedLast();t.keyEvent=!0,e?t.selectPrevCell(e[0],e[1]):t.selectLastCell(),t.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var e=t.hotMenu.getSelectedLast();if(t.keyEvent=!0,e){var n=t.openSubMenu(e[0]);n&&n.selectFirstCell()}t.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var e=t.hotMenu.getSelectedLast();t.keyEvent=!0,e&&t.isSubMenu()&&(t.close(),t.parentMenu&&t.parentMenu.hotMenu.listen()),t.keyEvent=!1}},{keys:[["Enter"]],callback:function(e){var n=t.hotMenu.getSelectedLast();t.keyEvent=!0,t.hotMenu.getSourceDataAtRow(n[0]).submenu||(t.executeCommand(e),t.close(!0)),t.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var e=t.hotMenu.getSelectedLast();t.keyEvent=!0,e?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.selectFirstCell(),t.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var e=t.hotMenu.getSelectedLast();t.keyEvent=!0,e?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.selectLastCell(),t.keyEvent=!1}}],c),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(t&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(e){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!oW(n))return!1;var r=this.hotMenu.getSourceDataAtRow(e),o=new t(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(r.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=o,o}},{key:"closeSubMenu",value:function(t){var e=this.hotMenu.getSourceDataAtRow(t),n=this.hotSubMenus[e.key];n&&(n.destroy(),delete this.hotSubMenus[e.key])}},{key:"closeAllSubMenus",value:function(){var t=this;U(this.hotMenu.getData(),(function(e,n){return t.closeSubMenu(n)}))}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){var t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(t){if(this.isOpened()&&this.hasSelectedItem()){var e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),!this.isCommandPassive(e)){var n=this.hot.getSelectedRange(),r=n?nW(n):[];this.runLocalHooks("executeCommand",e.key,r,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,r,t)}}}},{key:"isCommandPassive",value:function(t){var e=t.isCommand,n=t.name,r=t.disabled,o=t.submenu,i=!0===r||"function"===typeof r&&!0===r.call(this.hot);return!1===e||n===tW||!0===i||o}},{key:"setPosition",value:function(t){var e=new yz(t,this.container.ownerDocument.defaultView);this.options.keepInViewport?(e.fitsBelow(this.container)?this.setPositionBelowCursor(e):e.fitsAbove(this.container)?this.setPositionAboveCursor(e):this.setPositionBelowCursor(e),this.hot.isLtr()?this.setHorizontalPositionForLtr(e):this.setHorizontalPositionForRtl(e)):(this.setPositionBelowCursor(e),this.setPositionOnRightOfCursor(e))}},{key:"setHorizontalPositionForRtl",value:function(t){t.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(t):this.setPositionOnRightOfCursor(t)}},{key:"setHorizontalPositionForLtr",value:function(t){t.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(t):this.setPositionOnLeftOfCursor(t)}},{key:"setPositionAboveCursor",value:function(t){var e=this.offset.above+t.top-this.container.offsetHeight;this.isSubMenu()&&(e=t.top+t.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(e,"px")}},{key:"setPositionBelowCursor",value:function(t){var e=this.offset.below+t.top+1;this.isSubMenu()&&(e=t.top-1),this.container.style.top="".concat(e,"px")}},{key:"setPositionOnRightOfCursor",value:function(t){var e=t.left;if(this.isSubMenu()){var n=this.parentMenu.container.getBoundingClientRect(),r=n.right;e+=t.cellWidth+r-(t.left+t.cellWidth)}else e+=this.offset.right;this.container.style.left="".concat(e,"px")}},{key:"setPositionOnLeftOfCursor",value:function(t){var e=this.offset.left+t.left-this.container.offsetWidth;if(this.isSubMenu()){var n=this.parentMenu.container.getBoundingClientRect(),r=n.left;e-=t.left-r}this.container.style.left="".concat(e,"px")}},{key:"selectFirstCell",value:function(){var t=this.hotMenu.getCell(0,0);rW(t)||iW(t)||aW(t)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var t=this.hotMenu.countRows()-1,e=this.hotMenu.getCell(t,0);rW(e)||iW(e)||aW(e)?this.selectPrevCell(t,0):(this.hotMenu.selectCell(t,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(t,0,!0,!1))}},{key:"selectNextCell",value:function(t,e){var n=t+1,r=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,e):null;r&&(rW(r)||iW(r)||aW(r)?this.selectNextCell(n,e):this.hotMenu.selectCell(n,e))}},{key:"selectPrevCell",value:function(t,e){var n=t-1,r=n>=0?this.hotMenu.getCell(n,e):null;r&&(rW(r)||iW(r)||aW(r)?this.selectPrevCell(n,e):this.hotMenu.selectCell(n,e))}},{key:"menuItemRenderer",value:function(t,e,n,r,o,i){var a=this,l=t.getSourceDataAtRow(n),s=this.hot.rootDocument.createElement("div"),u=function(t){return bt(t,"submenu")},c=function(t){return new RegExp(tW,"i").test(t.name)},f=function(t){return!0===t.disabled||"function"===typeof t.disabled&&!0===t.disabled.call(a.hot)},h=function(t){return t.disableSelection},d=i;"function"===typeof d&&(d=d.call(this.hot)),Xe(e),Ge(s,"htItemWrapper"),e.appendChild(s),c(l)?Ge(e,"htSeparator"):"function"===typeof l.renderer?(Ge(e,"htCustomMenuRenderer"),e.appendChild(l.renderer(t,s,n,r,o,d))):Qe(s,d),f(l)?(Ge(e,"htDisabled"),this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()}))):h(l)?(Ge(e,"htSelectionDisabled"),this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()}))):u(l)?(Ge(e,"htSubmenu"),h(l)?this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()})):this.eventManager.addEventListener(e,"mouseenter",(function(){return t.selectCell(n,r,void 0,void 0,!1,!1)}))):(Ye(e,["htSubmenu","htDisabled"]),h(l)?this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()})):this.eventManager.addEventListener(e,"mouseenter",(function(){return t.selectCell(n,r,void 0,void 0,!1,!1)})))}},{key:"createContainer",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.options.container.ownerDocument,r=e;return r&&(_n(r)&&(r=r.call(this.hot),r=null===r||te(r)?"":r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r="".concat(this.options.className,"Sub_").concat(r),t=n.querySelector(".".concat(this.options.className,".").concat(r))),t||(t=n.createElement("div"),Ge(t,"htMenu ".concat(this.options.className)),r&&Ge(t,r),this.options.container.appendChild(t)),t}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var t=this.hotMenu.view._wt.wtTable,e=this.hotMenu.getSettings().data,n=t.hider.style,r=t.holder.style,o=parseInt(n.width,10),i=V(e,(function(t,e){return t+(e.name===tW?1:26)}),0);r.width="".concat(o+3,"px"),r.height="".concat(i+3,"px"),n.height=r.height}},{key:"onAfterSelection",value:function(t,e,n,r,o){!1===this.keyEvent&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Le(t.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Le(t.target,".htMenu")||this.close(!0))}},{key:"onDocumentContextMenu",value:function(t){this.isOpened()&&ze(t.target,"htCore")&&Le(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}]),t}();ct(Tz,qv);var jz=Tz;function Az(t){return Az="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Az(t)}function Mz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Iz(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_z(r.key),r)}}function xz(t,e,n){return e&&Iz(t.prototype,e),n&&Iz(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _z(t){var e=Hz(t,"string");return"symbol"===Az(e)?e:String(e)}function Hz(t,e){if("object"!==Az(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Az(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Nz(){return Nz="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Dz(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Nz.apply(this,arguments)}function Dz(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=zz(t),null===t)break;return t}function Lz(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bz(t,e)}function Bz(t,e){return Bz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Bz(t,e)}function Vz(t){var e=Uz();return function(){var n,r=zz(t);if(e){var o=zz(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Fz(this,n)}}function Fz(t,e){if(e&&("object"===Az(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Wz(t)}function Wz(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Uz(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function zz(t){return zz=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},zz(t)}var Gz="contextMenu",Yz=70;mr.getSingleton().register("afterContextMenuDefaultOptions"),mr.getSingleton().register("beforeContextMenuShow"),mr.getSingleton().register("afterContextMenuShow"),mr.getSingleton().register("afterContextMenuHide"),mr.getSingleton().register("afterContextMenuExecute");var Kz=function(t){Lz(n,t);var e=Vz(n);function n(t){var r;return Mz(this,n),r=e.call(this,t),r.eventManager=new Gr(Wz(r)),r.commandExecutor=new sU(r.hot),r.itemsFactory=null,r.menu=null,r}return xz(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Gz]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[Gz];"function"===typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new jz(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(function(){return t.onMenuBeforeOpen()})),this.menu.addLocalHook("afterOpen",(function(){return t.onMenuAfterOpen()})),this.menu.addLocalHook("afterClose",(function(){return t.onMenuAfterClose()})),this.menu.addLocalHook("executeCommand",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.executeCommand).call.apply(e,[t].concat(r))})),this.addHook("afterOnCellContextMenu",(function(e){return t.onAfterOnCellContextMenu(e)})),Nz(zz(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Nz(zz(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),Nz(zz(n.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(t){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),this.menu.isOpened())){var e=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var r=this.hot.rootWindow.frameElement,o=r.getBoundingClientRect(),i=o.top,a=o.left;e=i-en(t.view),n=a-nn(t.view)}else e=-1*en(this.menu.hotMenu.rootWindow),n=-1*nn(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(t.pageY,10)+e,left:parseInt(t.pageX,10)+n})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(t){var e;null===this.itemsFactory&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=this.commandExecutor).execute.apply(e,[t].concat(r))}},{key:"prepareMenuItems",value:function(){var t=this;this.itemsFactory=new lz(this.hot,n.DEFAULT_ITEMS);var e=this.hot.getSettings()[Gz],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);var o=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",o),this.menu.setMenuItems(o),U(o,(function(e){return t.commandExecutor.registerCommand(e.key,e)}))}},{key:"onAfterOnCellContextMenu",value:function(t){var e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function o(t){return"TD"===t.nodeName||"TD"===t.parentNode.nodeName}var i=t.target;this.close(),ze(i,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),(n||r||o(i)||ze(i,"current")&&ze(i,"wtBorder"))&&this.open(t))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Nz(zz(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Gz}},{key:"PLUGIN_PRIORITY",get:function(){return Yz}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[DU,BU,tW,dU,yU,tW,HU,PU,tW,zU,bU,tW,mU,tW,uU]}}]),n}(jH);function Xz(t){return{key:"copy",name:function(){return this.getTranslatedPhrase(zw)},callback:function(){t.copyCellsOnly()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}function $z(t){return{key:"copy_column_headers_only",name:function(){var t=this.getSelectedRangeLast(),e=t?Math.min(t.getWidth()-1,1):0;return this.getTranslatedPhrase(Kw,e)},callback:function(){t.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}function qz(t){return{key:"copy_with_column_group_headers",name:function(){var t=this.getSelectedRangeLast(),e=t?Math.min(t.getWidth()-1,1):0;return this.getTranslatedPhrase(Yw,e)},callback:function(){t.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}function Qz(t){return{key:"copy_with_column_headers",name:function(){var t=this.getSelectedRangeLast(),e=t?Math.min(t.getWidth()-1,1):0;return this.getTranslatedPhrase(Gw,e)},callback:function(){t.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}function Jz(t){return{key:"cut",name:function(){return this.getTranslatedPhrase(Xw)},callback:function(){t.cut()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}function Zz(t){return Zz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zz(t)}function tG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eG(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,rG(r.key),r)}}function nG(t,e,n){return e&&eG(t.prototype,e),n&&eG(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function rG(t){var e=oG(t,"string");return"symbol"===Zz(e)?e:String(e)}function oG(t,e){if("object"!==Zz(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Zz(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Kz.SEPARATOR={name:tW};var iG=function(){function t(){tG(this,t),this.data={}}return nG(t,[{key:"setData",value:function(t,e){this.data[t]=e}},{key:"getData",value:function(t){return this.data[t]||void 0}}]),t}();function aG(t){return aG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aG(t)}function lG(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,uG(r.key),r)}}function sG(t,e,n){return e&&lG(t.prototype,e),n&&lG(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function uG(t){var e=cG(t,"string");return"symbol"===aG(e)?e:String(e)}function cG(t,e){if("object"!==aG(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==aG(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function fG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var hG=sG((function t(){fG(this,t),this.clipboardData=new iG}));function dG(t){return dG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dG(t)}function pG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yG(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mG(r.key),r)}}function vG(t,e,n){return e&&yG(t.prototype,e),n&&yG(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function mG(t){var e=gG(t,"string");return"symbol"===dG(e)?e:String(e)}function gG(t,e){if("object"!==dG(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==dG(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var bG=function(){function t(e){pG(this,t),this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new Gr(this),this.listenersCount=new WeakSet,this.container=e}return vG(t,[{key:"useSecondaryElement",value:function(){var t=EG(this.container);this.listenersCount.has(t)||(this.listenersCount.add(t),kG(this.eventManager,t,this)),this.mainElement=t}},{key:"setFocusableElement",value:function(t){this.listenersCount.has(t)||(this.listenersCount.add(t),kG(this.eventManager,t,this)),this.mainElement=t}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Ht()||Mn(this.mainElement)}}]),t}();ct(bG,qv);var wG=new WeakMap;function SG(t){var e=new bG(t),n=wG.get(t);return n=isNaN(n)?0:n,wG.set(t,n+1),e}function CG(t){t.eventManager.clear()}var OG=function(t,e){return function(n){return e.runLocalHooks(t,n)}};function kG(t,e,n){t.addEventListener(e,"copy",OG("copy",n)),t.addEventListener(e,"cut",OG("cut",n)),t.addEventListener(e,"paste",OG("paste",n))}var RG=new WeakMap;function EG(t){var e=RG.get(t);if(e)return e.parentElement||t.appendChild(e),e;var n=t.defaultView?t:t.ownerDocument,r=n.createElement("textarea");return RG.set(t,r),r.setAttribute("data-hot-input",""),r.className="HandsontableCopyPaste",r.tabIndex=-1,r.autocomplete="off",r.wrap="hard",r.value=" ",t.appendChild(r),r}function PG(t){if(t instanceof bG){var e=wG.get(t.container);if(e=isNaN(e)?0:e,e>0&&(e-=1),CG(t),e<=0){e=0;var n=RG.get(t.container);n&&n.parentNode&&(n.parentNode.removeChild(n),RG.delete(t.container)),t.mainElement=null}wG.set(t.container,e)}}function TG(t){return TG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TG(t)}function jG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AG(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,IG(r.key),r)}}function MG(t,e,n){return e&&AG(t.prototype,e),n&&AG(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function IG(t){var e=xG(t,"string");return"symbol"===TG(e)?e:String(e)}function xG(t,e){if("object"!==TG(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==TG(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _G(t,e){NG(t,e),e.add(t)}function HG(t,e,n){NG(t,e),e.set(t,n)}function NG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DG(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function LG(t,e){var n=FG(t,e,"get");return BG(t,n)}function BG(t,e){return e.get?e.get.call(t):e.value}function VG(t,e,n){var r=FG(t,e,"set");return WG(t,r,n),n}function FG(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function WG(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var UG=new WeakMap,zG=new WeakMap,GG=new WeakMap,YG=new WeakMap,KG=new WeakMap,XG=new WeakMap,$G=new WeakSet,qG=new WeakSet,QG=function(){function t(e){var n=e.countRows,r=e.countColumns,o=e.rowsLimit,i=e.columnsLimit,a=e.countColumnHeaders;jG(this,t),_G(this,qG),_G(this,$G),HG(this,UG,{writable:!0,value:void 0}),HG(this,zG,{writable:!0,value:void 0}),HG(this,GG,{writable:!0,value:void 0}),HG(this,YG,{writable:!0,value:void 0}),HG(this,KG,{writable:!0,value:void 0}),HG(this,XG,{writable:!0,value:void 0}),VG(this,zG,n),VG(this,GG,r),VG(this,YG,o),VG(this,KG,i),VG(this,XG,a)}return MG(t,[{key:"setSelectedRange",value:function(t){VG(this,UG,t)}},{key:"getCellsRange",value:function(){if(0===LG(this,zG).call(this)||0===LG(this,GG).call(this))return null;var t=LG(this,UG).getTopStartCorner(),e=t.row,n=t.col,r=LG(this,UG).getBottomEndCorner(),o=r.row,i=r.col,a=DG(this,qG,ZG).call(this,e,o),l=DG(this,$G,JG).call(this,n,i),s=o!==a||i!==l;return{isRangeTrimmed:s,startRow:e,startCol:n,endRow:a,endCol:l}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(0===LG(this,GG).call(this)||0===LG(this,XG).call(this))return null;var t=LG(this,UG).getTopStartCorner(),e=t.col,n=LG(this,UG).getBottomEndCorner(),r=n.col,o=DG(this,$G,JG).call(this,e,r),i=r!==o;return{isRangeTrimmed:i,startRow:-1,startCol:e,endRow:-1,endCol:o}}},{key:"getAllColumnHeadersRange",value:function(){if(0===LG(this,GG).call(this)||0===LG(this,XG).call(this))return null;var t=LG(this,UG).getTopStartCorner(),e=t.col,n=LG(this,UG).getBottomEndCorner(),r=n.col,o=DG(this,$G,JG).call(this,e,r),i=r!==o;return{isRangeTrimmed:i,startRow:-LG(this,XG).call(this),startCol:e,endRow:-1,endCol:o}}}]),t}();function JG(t,e){return Math.min(e,Math.max(t+LG(this,KG).call(this)-1,t))}function ZG(t,e){return Math.min(e,Math.max(t+LG(this,YG).call(this)-1,t))}function tY(t){var e=[],n=[];return U(t,(function(t){var r=Math.min(t.startRow,t.endRow),o=Math.max(t.startRow,t.endRow);Io(r,o,(function(t){-1===e.indexOf(t)&&e.push(t)}));var i=Math.min(t.startCol,t.endCol),a=Math.max(t.startCol,t.endCol);Io(i,a,(function(t){-1===n.indexOf(t)&&n.push(t)}))})),{rows:e,columns:n}}function eY(t,e){return aY(t)||iY(t,e)||rY(t,e)||nY()}function nY(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rY(t,e){if(t){if("string"===typeof t)return oY(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oY(t,e):void 0}}function oY(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function iY(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function aY(t){if(Array.isArray(t))return t}function lY(t){return lY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lY(t)}function sY(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uY(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kY(r.key),r)}}function cY(t,e,n){return e&&uY(t.prototype,e),n&&uY(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function fY(){return fY="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=hY(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},fY.apply(this,arguments)}function hY(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=bY(t),null===t)break;return t}function dY(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pY(t,e)}function pY(t,e){return pY=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},pY(t,e)}function yY(t){var e=gY();return function(){var n,r=bY(t);if(e){var o=bY(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vY(this,n)}}function vY(t,e){if(e&&("object"===lY(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return mY(t)}function mY(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gY(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function bY(t){return bY=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bY(t)}function wY(t,e){CY(t,e),e.add(t)}function SY(t,e,n){CY(t,e),e.set(t,n)}function CY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OY(t,e,n){return e=kY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kY(t){var e=RY(t,"string");return"symbol"===lY(e)?e:String(e)}function RY(t,e){if("object"!==lY(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==lY(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function EY(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function PY(t,e){var n=AY(t,e,"get");return TY(t,n)}function TY(t,e){return e.get?e.get.call(t):e.value}function jY(t,e,n){var r=AY(t,e,"set");return MY(t,r,n),n}function AY(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function MY(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}mr.getSingleton().register("afterCopyLimit"),mr.getSingleton().register("modifyCopyableRange"),mr.getSingleton().register("beforeCut"),mr.getSingleton().register("afterCut"),mr.getSingleton().register("beforePaste"),mr.getSingleton().register("afterPaste"),mr.getSingleton().register("beforeCopy"),mr.getSingleton().register("afterCopy");var IY="copyPaste",xY=80,_Y=["fragmentSelection"],HY=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),NY=new WeakMap,DY=new WeakMap,LY=new WeakMap,BY=new WeakMap,VY=new WeakMap,FY=new WeakMap,WY=new WeakMap,UY=new WeakSet,zY=function(t){dY(n,t);var e=yY(n);function n(){var t;sY(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),wY(mY(t),UY),OY(mY(t),"columnsLimit",1/0),OY(mY(t),"rowsLimit",1/0),OY(mY(t),"pasteMode","overwrite"),OY(mY(t),"uiContainer",t.hot.rootDocument.body),SY(mY(t),NY,{writable:!0,value:!1}),SY(mY(t),DY,{writable:!0,value:!1}),SY(mY(t),LY,{writable:!0,value:!1}),SY(mY(t),BY,{writable:!0,value:"cells-only"}),SY(mY(t),VY,{writable:!0,value:!1}),SY(mY(t),FY,{writable:!0,value:!1}),SY(mY(t),WY,{writable:!0,value:new QG({countRows:function(){return t.hot.countRows()},countColumns:function(){return t.hot.countCols()},rowsLimit:function(){return t.rowsLimit},columnsLimit:function(){return t.columnsLimit},countColumnHeaders:function(){return t.hot.view.getColumnHeadersCount()}})}),OY(mY(t),"copyableRanges",[]),OY(mY(t),"focusableElement",void 0),t}return cY(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[IY]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e,r,o=this.hot.getSettings(),i=o[IY];if("object"===lY(i))this.pasteMode=null!==(e=i.pasteMode)&&void 0!==e?e:this.pasteMode,this.rowsLimit=isNaN(i.rowsLimit)?this.rowsLimit:i.rowsLimit,this.columnsLimit=isNaN(i.columnsLimit)?this.columnsLimit:i.columnsLimit,jY(this,NY,!!i.copyColumnHeaders),jY(this,DY,!!i.copyColumnGroupHeaders),jY(this,LY,!!i.copyColumnHeadersOnly),this.uiContainer=null!==(r=i.uiContainer)&&void 0!==r?r:this.uiContainer;this.addHook("afterContextMenuDefaultOptions",(function(e){return t.onAfterContextMenuDefaultOptions(e)})),this.addHook("afterOnCellMouseUp",(function(){return t.onAfterOnCellMouseUp()})),this.addHook("afterSelectionEnd",(function(){return t.onAfterSelectionEnd()})),this.addHook("beforeKeyDown",(function(){return t.onBeforeKeyDown()})),this.focusableElement=SG(this.uiContainer),this.focusableElement.addLocalHook("copy",(function(e){return t.onCopy(e)})).addLocalHook("cut",(function(e){return t.onCut(e)})).addLocalHook("paste",(function(e){return t.onPaste(e)})),fY(bY(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),fY(bY(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&PG(this.focusableElement),fY(bY(n.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only";jY(this,BY,t),jY(this,VY,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){jY(this,FY,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(t){return FP(this.getRangedData(t))}},{key:"getRangedData",value:function(t){var e=this,n=[],r=tY(t),o=r.rows,i=r.columns;return U(o,(function(t){var r=[];U(i,(function(n){t<0?r.push(e.hot.getColHeader(n,t)):r.push(e.hot.getCopyableData(t,n))})),n.push(r)})),n}},{key:"paste",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(t||e){var n=new hG;t&&n.clipboardData.setData("text/plain",t),e&&n.clipboardData.setData("text/html",e),this.getOrCreateFocusableElement(),this.onPaste(n)}}},{key:"setCopyableText",value:function(){var t=this.hot.getSelectedRangeLast();if(t){PY(this,WY).setSelectedRange(t);var e=new Map([["headers",null],["cells",null]]);"column-headers-only"===PY(this,BY)?e.set("headers",PY(this,WY).getMostBottomColumnHeadersRange()):("with-column-headers"===PY(this,BY)?e.set("headers",PY(this,WY).getMostBottomColumnHeadersRange()):"with-column-group-headers"===PY(this,BY)&&e.set("headers",PY(this,WY).getAllColumnHeadersRange()),e.set("cells",PY(this,WY).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter((function(t){return null!==t})).map((function(t){var e=t.startRow,n=t.startCol,r=t.endRow,o=t.endCol;return{startRow:e,startCol:n,endRow:r,endCol:o}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var n=e.get("cells");if(null!==n&&n.isRangeTrimmed){var r=n.startRow,o=n.startCol,i=n.endRow,a=n.endCol;this.hot.runHooks("afterCopyLimit",i-r+1,a-o+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var t,e=null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.TEXTAREA;e?this.focusableElement.setFocusableElement(e):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}},{key:"populateValues",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(t.length){var n=t.length,r=t[0].length,o=[],i=e.getTopStartCorner(),a=i.row,l=i.col,s=e.getBottomEndCorner(),u=s.row,c=s.col,f=a,h=l,d=a,p=l;while(o.length<n||f<=u){var y=this.hot.getCellMeta(f,l),v=y.skipRowOnPaste,m=y.visualRow;if(f=m+1,!0!==v){d=m,h=l;var g=[],b=o.length%n;while(g.length<r||h<=c){var w=this.hot.getCellMeta(a,h),S=w.skipColumnOnPaste,C=w.visualCol;if(h=C+1,!0!==S){p=C;var O=g.length%r;g.push(t[b][O])}}o.push(g)}}return this.hot.populateFromArray(a,l,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,d,p]}}},{key:"onCopy",value:function(t){if((this.hot.isListening()||PY(this,VY))&&!this.isEditorOpened()){this.setCopyableText(),jY(this,VY,!1);var e=this.getRangedData(this.copyableRanges),n=EY(this,UY,GY).call(this,this.copyableRanges),r=!!this.hot.runHooks("beforeCopy",e,this.copyableRanges,n);if(r){var o=FP(e);if(t&&t.clipboardData){var i=So(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",o),t.clipboardData.setData("text/html",[HY,i].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",e,this.copyableRanges,n)}jY(this,BY,"cells-only"),t.preventDefault()}}},{key:"onCut",value:function(t){if((this.hot.isListening()||PY(this,FY))&&!this.isEditorOpened()){this.setCopyableText(),jY(this,FY,!1);var e=this.getRangedData(this.copyableRanges),n=!!this.hot.runHooks("beforeCut",e,this.copyableRanges);if(n){var r=FP(e);if(t&&t.clipboardData){var o=So(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",r),t.clipboardData.setData("text/html",[HY,o].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",e,this.copyableRanges)}t.preventDefault()}}},{key:"onPaste",value:function(t){if(this.hot.isListening()&&!this.isEditorOpened()){var e;if(t&&t.preventDefault&&t.preventDefault(),t&&"undefined"!==typeof t.clipboardData){var n=Re(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(n&&/(<table)|(<TABLE)/g.test(n)){var r=Co(n,this.hot.rootDocument);e=r.data}else e=t.clipboardData.getData("text/plain")}else"undefined"===typeof ClipboardEvent&&"undefined"!==typeof this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));if("string"===typeof e&&(e=VP(e)),(!e||0!==e.length)&&!1!==this.hot.runHooks("beforePaste",e,this.copyableRanges)){var o=this.populateValues(e),i=eY(o,4),a=i[0],l=i[1],s=i[2],u=i[3];this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,s),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",e,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(t){t.items.push({name:"---------"},Xz(this)),PY(this,NY)&&t.items.push(Qz(this)),PY(this,DY)&&t.items.push(qz(this)),PY(this,LY)&&t.items.push($z(this)),t.items.push(Jz(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&bn()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var t=this.hot.rootDocument.activeElement,e=this.hot.getActiveEditor();!e||t!==this.focusableElement.getFocusableElement()&&t!==e.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(PG(this.focusableElement),this.focusableElement=null),fY(bY(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return IY}},{key:"SETTING_KEYS",get:function(){return[IY].concat(_Y)}},{key:"PLUGIN_PRIORITY",get:function(){return xY}}]),n}(jH);function GY(t){for(var e=tY(t),n=e.rows,r=0,o=0;o<n.length;o++){if(n[o]>=0)break;r+=1}return{columnHeadersCount:r}}function YY(t,e){return"border_row".concat(t,"col").concat(e)}function KY(){return{width:1,color:"#000"}}function XY(){return{hide:!0}}function $Y(){return{width:1,color:"#000",cornerVisible:!1}}function qY(t){var e,n;(Zt(t.start)||Zt(t.left))&&(t.start=null!==(e=t.start)&&void 0!==e?e:t.left);(Zt(t.end)||Zt(t.right))&&(t.end=null!==(n=t.end)&&void 0!==n?n:t.right);return delete t.left,delete t.right,t}function QY(t){return Zt(t.start)&&(t.left=t.start),Zt(t.end)&&(t.right=t.end),t}function JY(t,e){return{id:YY(t,e),border:$Y(),row:t,col:e,top:XY(),bottom:XY(),start:XY(),end:XY()}}function ZY(t,e){return bt(e,"border")&&e.border&&(t.border=e.border),bt(e,"top")&&Zt(e.top)&&(e.top?(ht(e.top)||(e.top=KY()),t.top=e.top):(e.top=XY(),t.top=e.top)),bt(e,"bottom")&&Zt(e.bottom)&&(e.bottom?(ht(e.bottom)||(e.bottom=KY()),t.bottom=e.bottom):(e.bottom=XY(),t.bottom=e.bottom)),bt(e,"start")&&Zt(e.start)&&(e.start?(ht(e.start)||(e.start=KY()),t.start=e.start):(e.start=XY(),t.start=e.start)),bt(e,"end")&&Zt(e.end)&&(e.end?(ht(e.end)||(e.end=KY()),t.end=e.end):(e.end=XY(),t.end=e.end)),t}function tK(t,e){var n=!1;return U(t.getSelectedRange(),(function(r){r.forAll((function(r,o){if(!(r<0||o<0)){var i=t.getCellMeta(r,o).borders;if(i){if(!e)return n=!0,!1;if(!bt(i[e],"hide")||!1===i[e].hide)return n=!0,!1}}}))})),n}function eK(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function nK(t){return t.some((function(t){return Zt(t.left)||Zt(t.right)}))}function rK(t){return t.some((function(t){return Zt(t.start)||Zt(t.end)}))}var oK=new Map([["left","start"],["right","end"]]);function iK(t){var e;return null!==(e=oK.get(t))&&void 0!==e?e:t}function aK(t){return{key:"borders:top",name:function(){var t=this.getTranslatedPhrase(hS),e=tK(this,"top");return e&&(t=eK(t)),t},callback:function(e,n){var r=tK(this,"top");t.prepareBorder(n,"top",r)}}}function lK(t){var e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var t=this.getTranslatedPhrase(dS),n=tK(this,e);return n&&(t=eK(t)),t},callback:function(n,r){var o=tK(this,e);t.prepareBorder(r,e,o)}}}function sK(t){return{key:"borders:bottom",name:function(){var t=this.getTranslatedPhrase(pS),e=tK(this,"bottom");return e&&(t=eK(t)),t},callback:function(e,n){var r=tK(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function uK(t){var e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var t=this.getTranslatedPhrase(yS),n=tK(this,e);return n&&(t=eK(t)),t},callback:function(n,r){var o=tK(this,e);t.prepareBorder(r,e,o)}}}function cK(t){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(vS)},callback:function(e,n){t.prepareBorder(n,"noBorders")},disabled:function(){return!tK(this)}}}function fK(t){return fK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fK(t)}function hK(t,e){return mK(t)||vK(t,e)||pK(t,e)||dK()}function dK(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pK(t,e){if(t){if("string"===typeof t)return yK(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yK(t,e):void 0}}function yK(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function vK(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function mK(t){if(Array.isArray(t))return t}function gK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bK(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,MK(r.key),r)}}function wK(t,e,n){return e&&bK(t.prototype,e),n&&bK(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function SK(){return SK="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=CK(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},SK.apply(this,arguments)}function CK(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=jK(t),null===t)break;return t}function OK(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kK(t,e)}function kK(t,e){return kK=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},kK(t,e)}function RK(t){var e=TK();return function(){var n,r=jK(t);if(e){var o=jK(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return EK(this,n)}}function EK(t,e){if(e&&("object"===fK(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return PK(t)}function PK(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function TK(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function jK(t){return jK=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},jK(t)}function AK(t,e,n){return e=MK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MK(t){var e=IK(t,"string");return"symbol"===fK(e)?e:String(e)}function IK(t,e){if("object"!==fK(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==fK(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var xK="customBorders",_K=90,HK=function(t){OK(n,t);var e=RK(n);function n(){var t;gK(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),AK(PK(t),"savedBorders",[]),t}return wK(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[xK]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(e){return t.onAfterContextMenuDefaultOptions(e)})),this.addHook("init",(function(){return t.onAfterInit()})),SK(jK(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),SK(jK(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),SK(jK(n.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(t,e){var n=this,r=["top","bottom","start","end"],o=null;e&&(this.checkSettingsCohesion([e]),r=Object.keys(e),o=qY(e));var i=DR(t),a=LR(i);U(t,(function(t){for(var e=a(t),i=hK(e,4),l=i[0],s=i[1],u=i[2],c=i[3],f=function(t){for(var e=function(e){U(r,(function(r){n.prepareBorderFromCustomAdded(t,e,o,iK(r))}))},i=s;i<=c;i+=1)e(i)},h=l;h<=u;h+=1)f(h)})),this.hot.view.render()}},{key:"getBorders",value:function(t){var e=this;if(!Array.isArray(t))return this.savedBorders;var n=DR(t),r=LR(n),o=[];return U(t,(function(t){for(var n=r(t),i=hK(n,4),a=i[0],l=i[1],s=i[2],u=i[3],c=function(t){for(var n=function(n){U(e.savedBorders,(function(e){e.row===t&&e.col===n&&o.push(QY(e))}))},r=l;r<=u;r+=1)n(r)},f=a;f<=s;f+=1)c(f)})),o}},{key:"clearBorders",value:function(t){var e=this;t?this.setBorders(t):(U(this.savedBorders,(function(t){e.clearBordersFromSelectionSettings(t.id),e.clearNullCellRange(),e.hot.removeCellMeta(t.row,t.col,"borders")})),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(t,e){var n=this.checkSavedBorders(t);n||this.savedBorders.push(t);var r=this.hot._createCellRange(this.hot._createCellCoords(t.row,t.col)),o=this.checkCustomSelections(t,r,e);o||this.hot.selection.highlight.addCustomSelection({border:t,visualCellRange:r})}},{key:"prepareBorderFromCustomAdded",value:function(t,e,n,r){var o=this.hot.countRows(),i=this.hot.countCols();if(!(t>=o||e>=i)){var a=JY(t,e);n&&(a=ZY(a,n),U(this.hot.selection.highlight.customSelections,(function(t){if(a.id===t.settings.id)return Object.assign(t.settings,n),a.id=t.settings.id,a.top=t.settings.top,a.bottom=t.settings.bottom,a.start=t.settings.start,a.end=t.settings.end,!1}))),this.hot.setCellMeta(t,e,"borders",QY(a)),this.insertBorderIntoSettings(a,r)}}},{key:"prepareBorderFromCustomAddedRange",value:function(t,e){var n=this,r=Math.min(t.to.row,this.hot.countRows()-1),o=Math.min(t.to.col,this.hot.countCols()-1);Io(t.from.row,r,(function(r){Io(t.from.col,o,(function(o){var i=JY(r,o),a=0;r===t.from.row&&bt(e,"top")&&(a+=1,i.top=e.top),r===t.to.row&&bt(e,"bottom")&&(a+=1,i.bottom=e.bottom),o===t.from.col&&bt(e,"start")&&(a+=1,i.start=e.start),o===t.to.col&&bt(e,"end")&&(a+=1,i.end=e.end),a>0&&(n.hot.setCellMeta(r,o,"borders",QY(i)),n.insertBorderIntoSettings(i))}))}))}},{key:"removeAllBorders",value:function(t,e){var n=YY(t,e);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}},{key:"setBorder",value:function(t,e,n,r){var o=this.hot.getCellMeta(t,e).borders;if(o=o&&void 0!==o.border?qY(o):JY(t,e),r){o[n]=XY();var i=this.countHide(o);if(4===i)this.removeAllBorders(t,e);else{var a=this.checkCustomSelectionsFromContextMenu(o,n,r);a||this.insertBorderIntoSettings(o),this.hot.setCellMeta(t,e,"borders",QY(o))}}else{o[n]=KY();var l=this.checkCustomSelectionsFromContextMenu(o,n,r);l||this.insertBorderIntoSettings(o),this.hot.setCellMeta(t,e,"borders",QY(o))}}},{key:"prepareBorder",value:function(t,e,n){var r=this;U(t,(function(t){var o=t.start,i=t.end;if(o.row===i.row&&o.col===i.col)"noBorders"===e?r.removeAllBorders(o.row,o.col):r.setBorder(o.row,o.col,e,n);else switch(e){case"noBorders":Io(o.col,i.col,(function(t){Io(o.row,i.row,(function(e){r.removeAllBorders(e,t)}))}));break;case"top":Io(o.col,i.col,(function(t){r.setBorder(o.row,t,e,n)}));break;case"bottom":Io(o.col,i.col,(function(t){r.setBorder(i.row,t,e,n)}));break;case"start":Io(o.row,i.row,(function(t){r.setBorder(t,o.col,e,n)}));break;case"end":Io(o.row,i.row,(function(t){r.setBorder(t,i.col,e,n)}));break;default:break}}))}},{key:"createCustomBorders",value:function(t){var e=this;U(t,(function(t){var n=qY(t);t.range?e.prepareBorderFromCustomAddedRange(t.range,n):e.prepareBorderFromCustomAdded(t.row,t.col,n)}))}},{key:"countHide",value:function(t){var e=t.top,n=t.bottom,r=t.start,o=t.end,i=[e,n,r,o];return V(i,(function(t,e){var n=t;return e&&e.hide&&(n+=1),n}),0)}},{key:"clearBordersFromSelectionSettings",value:function(t){var e=W(this.hot.selection.highlight.customSelections,(function(t){return t.settings.id})).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear()}},{key:"clearNullCellRange",value:function(){var t=this;U(this.hot.selection.highlight.customSelections,(function(e,n){if(null===e.cellRange)return t.hot.selection.highlight.customSelections[n].destroy(),t.hot.selection.highlight.customSelections.splice(n,1),!1}))}},{key:"hideBorders",value:function(){var t=this;U(this.savedBorders,(function(e){t.clearBordersFromSelectionSettings(e.id),t.clearNullCellRange()}))}},{key:"spliceBorder",value:function(t){var e=W(this.savedBorders,(function(t){return t.id})).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}},{key:"checkSavedBorders",value:function(t){var e=this,n=!1,r=this.countHide(t);return 4===r?(this.spliceBorder(t.id),n=!0):U(this.savedBorders,(function(r,o){if(t.id===r.id)return e.savedBorders[o]=t,n=!0,!1})),n}},{key:"checkCustomSelectionsFromContextMenu",value:function(t,e,n){var r=!1;return U(this.hot.selection.highlight.customSelections,(function(o){if(t.id===o.settings.id)return pt(o.instanceBorders,(function(t){t.toggleHiddenClass(e,n)})),r=!0,!1})),r}},{key:"checkCustomSelections",value:function(t,e,n){var r=this.countHide(t),o=!1;return 4===r?(this.removeAllBorders(t.row,t.col),o=!0):U(this.hot.selection.highlight.customSelections,(function(r){if(t.id===r.settings.id)return r.visualCellRange=e,r.commit(),n&&pt(r.instanceBorders,(function(e){e.changeBorderStyle(n,t)})),o=!0,!1})),o}},{key:"changeBorderSettings",value:function(){var t=this.hot.getSettings()[xK];if(Array.isArray(t)){var e=st(t);this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)}else void 0!==t&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(t){var e=nK(t),n=rK(t);if(e&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&e)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(t){this.hot.getSettings()[xK]&&t.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(fS)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[aK(this),lK(this),sK(this),uK(this),cK(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){SK(jK(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return xK}},{key:"PLUGIN_PRIORITY",get:function(){return _K}}]),n}(jH);function NK(t){return NK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NK(t)}function DK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LK(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,VK(r.key),r)}}function BK(t,e,n){return e&&LK(t.prototype,e),n&&LK(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function VK(t){var e=FK(t,"string");return"symbol"===NK(e)?e:String(e)}function FK(t,e){if("object"!==NK(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==NK(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function WK(){return WK="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=UK(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},WK.apply(this,arguments)}function UK(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=qK(t),null===t)break;return t}function zK(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&GK(t,e)}function GK(t,e){return GK=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},GK(t,e)}function YK(t){var e=$K();return function(){var n,r=qK(t);if(e){var o=qK(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return KK(this,n)}}function KK(t,e){if(e&&("object"===NK(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return XK(t)}function XK(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $K(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function qK(t){return qK=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qK(t)}var QK="dragToScroll",JK=100,ZK=function(t){zK(n,t);var e=YK(n);function n(t){var r;return DK(this,n),r=e.call(this,t),r.eventManager=new Gr(XK(r)),r.boundaries=null,r.callback=null,r.listening=!1,r}return BK(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[QK]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterOnCellMouseDown",(function(e){return t.setupListening(e)})),this.addHook("afterOnCellCornerMouseDown",(function(e){return t.setupListening(e)})),this.registerEvents(),WK(qK(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),WK(qK(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),WK(qK(n.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(t){this.boundaries=t}},{key:"setCallback",value:function(t){this.callback=t}},{key:"check",value:function(t,e){var n=0,r=0;e<this.boundaries.top?r=e-this.boundaries.top:e>this.boundaries.bottom&&(r=e-this.boundaries.bottom),t<this.boundaries.left?n=t-this.boundaries.left:t>this.boundaries.right&&(n=t-this.boundaries.right),this.callback(n,r)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootWindow,n=e;while(n)this.eventManager.addEventListener(n.document,"contextmenu",(function(){return t.unlisten()})),this.eventManager.addEventListener(n.document,"mouseup",(function(){return t.unlisten()})),this.eventManager.addEventListener(n.document,"mousemove",(function(e){return t.onMouseMove(e)})),n=_e(n)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(t){if(!er(t)){var e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback((function(t,n){t<0?e.scrollLeft-=50:t>0&&(e.scrollLeft+=50),n<0?e.scrollTop-=20:n>0&&(e.scrollTop+=20)})),this.listen())}}},{key:"onMouseMove",value:function(t){this.isListening()&&this.check(t.clientX,t.clientY)}},{key:"destroy",value:function(){WK(qK(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return QK}},{key:"PLUGIN_PRIORITY",get:function(){return JK}}]),n}(jH);function tX(t){return tX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tX(t)}function eX(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nX(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,oX(r.key),r)}}function rX(t,e,n){return e&&nX(t.prototype,e),n&&nX(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function oX(t){var e=iX(t,"string");return"symbol"===tX(e)?e:String(e)}function iX(t,e){if("object"!==tX(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==tX(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function aX(){return aX="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=lX(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},aX.apply(this,arguments)}function lX(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=pX(t),null===t)break;return t}function sX(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uX(t,e)}function uX(t,e){return uX=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},uX(t,e)}function cX(t){var e=dX();return function(){var n,r=pX(t);if(e){var o=pX(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fX(this,n)}}function fX(t,e){if(e&&("object"===tX(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return hX(t)}function hX(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dX(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function pX(t){return pX=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pX(t)}mr.getSingleton().register("afterDropdownMenuDefaultOptions"),mr.getSingleton().register("beforeDropdownMenuShow"),mr.getSingleton().register("afterDropdownMenuShow"),mr.getSingleton().register("afterDropdownMenuHide"),mr.getSingleton().register("afterDropdownMenuExecute");var yX="dropdownMenu",vX=230,mX="changeType",gX=function(t){sX(n,t);var e=cX(n);function n(t){var r;return eX(this,n),r=e.call(this,t),r.eventManager=new Gr(hX(r)),r.commandExecutor=new sU(r.hot),r.itemsFactory=null,r.menu=null,r.hot.addHook("afterGetColHeader",(function(t,e){return r.onAfterGetColHeader(t,e)})),r}return rX(n,[{key:"isEnabled",value:function(){return this.hot.getSettings()[yX]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.itemsFactory=new lz(this.hot,n.DEFAULT_ITEMS);var e=this.hot.getSettings()[yX],r={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"===typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),aX(pX(n.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady((function(){t.hot.runHooks("afterDropdownMenuDefaultOptions",r),t.itemsFactory.setPredefinedItems(r.items);var n=t.itemsFactory.getItems(e);t.menu&&t.menu.destroy(),t.menu=new jz(t.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||t.hot.rootDocument.body}),t.hot.runHooks("beforeDropdownMenuSetItems",n),t.menu.setMenuItems(n),t.menu.addLocalHook("beforeOpen",(function(){return t.onMenuBeforeOpen()})),t.menu.addLocalHook("afterOpen",(function(){return t.onMenuAfterOpen()})),t.menu.addLocalHook("afterClose",(function(){return t.onMenuAfterClose()})),t.menu.addLocalHook("executeCommand",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.executeCommand).call.apply(e,[t].concat(r))})),U(n,(function(e){return t.commandExecutor.registerCommand(e.key,e)}))}))}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),aX(pX(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),aX(pX(n.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"click",(function(e){return t.onTableClick(e)}))}},{key:"open",value:function(t){this.menu&&(this.menu.open(),t.width&&this.menu.setOffset("left",t.width),this.menu.setPosition(t))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=this.commandExecutor).execute.apply(e,[t].concat(r))}},{key:"setListening",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(t){if(t.stopPropagation(),ze(t.target,mX)&&!this.menu.isOpened()){var e=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var r=this.hot.rootWindow.frameElement,o=r.getBoundingClientRect(),i=o.top,a=o.left;e=i,n=a}var l=t.target.getBoundingClientRect();this.open({left:l.left+n,top:l.top+t.target.offsetHeight+3+e,width:l.width,height:l.height})}}},{key:"onAfterGetColHeader",value:function(t,e){var n=e.parentNode;if(n){var r=n.parentNode.childNodes,o=Array.prototype.indexOf.call(r,n);if(!(t<0||o!==r.length-1)){var i=e.querySelector(".".concat(mX));if(!this.enabled||!i)if(this.enabled){var a=this.hot.rootDocument.createElement("button");a.className=mX,a.type="button",a.onclick=function(){return!1},e.firstChild.insertBefore(a,e.firstChild.firstChild)}else i&&i.parentNode.removeChild(i)}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),aX(pX(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return yX}},{key:"PLUGIN_PRIORITY",get:function(){return vX}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[dU,yU,tW,PU,tW,fU,tW,mU,tW,uU]}}]),n}(jH);function bX(t){return bX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bX(t)}function wX(t,e){return RX(t)||kX(t,e)||CX(t,e)||SX()}function SX(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function CX(t,e){if(t){if("string"===typeof t)return OX(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?OX(t,e):void 0}}function OX(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function kX(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function RX(t){if(Array.isArray(t))return t}function EX(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PX(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,jX(r.key),r)}}function TX(t,e,n){return e&&PX(t.prototype,e),n&&PX(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function jX(t){var e=AX(t,"string");return"symbol"===bX(e)?e:String(e)}function AX(t,e){if("object"!==bX(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==bX(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}gX.SEPARATOR={name:tW};var MX=function(){function t(e){EX(this,t),this.hot=e,this.options={}}return TX(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"getData",value:function(){var t=this,e=this._getDataRange(),n=e.startRow,r=e.startCol,o=e.endRow,i=e.endCol,a=this.options,l=[];return Io(n,o,(function(e){var n=[];!a.exportHiddenRows&&t._isHiddenRow(e)||(Io(r,i,(function(r){!a.exportHiddenColumns&&t._isHiddenColumn(r)||n.push(t.hot.getDataAtCell(e,r))})),l.push(n))})),l}},{key:"getRowHeaders",value:function(){var t=this,e=[];if(this.options.rowHeaders){var n=this._getDataRange(),r=n.startRow,o=n.endRow,i=this.hot.getRowHeader();Io(r,o,(function(n){!t.options.exportHiddenRows&&t._isHiddenRow(n)||e.push(i[n])}))}return e}},{key:"getColumnHeaders",value:function(){var t=this,e=[];if(this.options.columnHeaders){var n=this._getDataRange(),r=n.startCol,o=n.endCol,i=this.hot.getColHeader();Io(r,o,(function(n){!t.options.exportHiddenColumns&&t._isHiddenColumn(n)||e.push(i[n])}))}return e}},{key:"_getDataRange",value:function(){var t=this.hot.countCols()-1,e=this.hot.countRows()-1,n=wX(this.options.range,4),r=n[0],o=void 0===r?0:r,i=n[1],a=void 0===i?0:i,l=n[2],s=void 0===l?e:l,u=n[3],c=void 0===u?t:u;return o=Math.max(o,0),a=Math.max(a,0),s=Math.min(s,e),c=Math.min(c,t),{startRow:o,startCol:a,endRow:s,endCol:c}}},{key:"_isHiddenRow",value:function(t){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(t))}},{key:"_isHiddenColumn",value:function(t){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(t))}}]),t}(),IX=MX;function xX(t){return xX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xX(t)}function _X(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function HX(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,DX(r.key),r)}}function NX(t,e,n){return e&&HX(t.prototype,e),n&&HX(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function DX(t){var e=LX(t,"string");return"symbol"===xX(e)?e:String(e)}function LX(t,e){if("object"!==xX(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==xX(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var BX=function(){function t(e,n){_X(this,t),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}return NX(t,[{key:"_mergeOptions",value:function(e){var n=ut(this.constructor.DEFAULT_OPTIONS),r=new Date;return n=at(ut(t.DEFAULT_OPTIONS),n),n=at(n,e),n.filename=Oe(n.filename,{YYYY:r.getFullYear(),MM:"".concat(r.getMonth()+1).padStart(2,"0"),DD:"".concat(r.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),t}(),VX=BX;function FX(t){return FX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FX(t)}function WX(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function UX(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,GX(r.key),r)}}function zX(t,e,n){return e&&UX(t.prototype,e),n&&UX(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function GX(t){var e=YX(t,"string");return"symbol"===FX(e)?e:String(e)}function YX(t,e){if("object"!==FX(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==FX(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function KX(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&XX(t,e)}function XX(t,e){return XX=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},XX(t,e)}function $X(t){var e=JX();return function(){var n,r=ZX(t);if(e){var o=ZX(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qX(this,n)}}function qX(t,e){if(e&&("object"===FX(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return QX(t)}function QX(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function JX(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function ZX(t){return ZX=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ZX(t)}var t$=String.fromCharCode(13),e$=String.fromCharCode(34),n$=String.fromCharCode(10),r$=function(t){KX(n,t);var e=$X(n);function n(){return WX(this,n),e.apply(this,arguments)}return zX(n,[{key:"export",value:function(){var t=this,e=this.options,n=this.dataProvider.getData(),r=this.dataProvider.getColumnHeaders(),o=r.length>0,i=this.dataProvider.getRowHeaders(),a=i.length>0,l=e.bom?String.fromCharCode(65279):"";return o&&(r=W(r,(function(e){return t._escapeCell(e,!0)})),a&&(l+=e.columnDelimiter),l+=r.join(e.columnDelimiter),l+=e.rowDelimiter),U(n,(function(n,r){r>0&&(l+=e.rowDelimiter),a&&(l+=t._escapeCell(i[r])+e.columnDelimiter),l+=n.map((function(e){return t._escapeCell(e)})).join(e.columnDelimiter)})),l}},{key:"_escapeCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Jt(t);return""!==n&&(e||n.indexOf(t$)>=0||n.indexOf(e$)>=0||n.indexOf(n$)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n='"'.concat(n,'"')),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}}]),n}(VX),o$=r$;function i$(t){return i$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i$(t)}function a$(t,e,n){return e=l$(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l$(t){var e=s$(t,"string");return"symbol"===i$(e)?e:String(e)}function s$(t,e){if("object"!==i$(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==i$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var u$="csv",c$=a$({},u$,o$);function f$(t,e,n){return"function"===typeof c$[t]?new c$[t](e,n):null}function h$(t){return h$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h$(t)}function d$(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p$(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,v$(r.key),r)}}function y$(t,e,n){return e&&p$(t.prototype,e),n&&p$(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function v$(t){var e=m$(t,"string");return"symbol"===h$(e)?e:String(e)}function m$(t,e){if("object"!==h$(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==h$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function g$(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b$(t,e)}function b$(t,e){return b$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b$(t,e)}function w$(t){var e=O$();return function(){var n,r=k$(t);if(e){var o=k$(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S$(this,n)}}function S$(t,e){if(e&&("object"===h$(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return C$(t)}function C$(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O$(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function k$(t){return k$=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},k$(t)}var R$="exportFile",E$=240,P$=function(t){g$(n,t);var e=w$(n);function n(){return d$(this,n),e.apply(this,arguments)}return y$(n,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}},{key:"exportAsBlob",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}},{key:"downloadFile",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.hot,r=n.rootDocument,o=n.rootWindow,i=this._createTypeFormatter(t,e),a=this._createBlob(i),l=o.URL||o.webkitURL,s=r.createElement("a"),u="".concat(i.options.filename,".").concat(i.options.fileExtension);if(void 0!==s.download){var c=l.createObjectURL(a);s.style.display="none",s.setAttribute("href",c),s.setAttribute("download",u),r.body.appendChild(s),s.dispatchEvent(new MouseEvent("click")),r.body.removeChild(s),setTimeout((function(){l.revokeObjectURL(c)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,u)}},{key:"_createTypeFormatter",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!c$[t])throw new Error('Export format type "'.concat(t,'" is not supported.'));return f$(t,new IX(this.hot),e)}},{key:"_createBlob",value:function(t){var e=null;return"undefined"!==typeof Blob&&(e=new Blob([t.export()],{type:"".concat(t.options.mimeType,";charset=").concat(t.options.encoding)})),e}}],[{key:"PLUGIN_KEY",get:function(){return R$}},{key:"PLUGIN_PRIORITY",get:function(){return E$}}]),n}(jH);function T$(t){return T$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T$(t)}function j$(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A$(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,I$(r.key),r)}}function M$(t,e,n){return e&&A$(t.prototype,e),n&&A$(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function I$(t){var e=x$(t,"string");return"symbol"===T$(e)?e:String(e)}function x$(t,e){if("object"!==T$(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==T$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var _$=function(){function t(e,n){var r=n.id,o=n.stateless,i=void 0===o||o;j$(this,t),this.hot=e,this.id=r,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Ng)}return M$(t,[{key:"reset",value:function(){U(this.elements,(function(t){return t.reset()}))}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return null===this.hot||this.hidden}},{key:"restoreState",value:function(t){this.state&&this.setState(this.state.getValueAtIndex(t))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(t){this.state&&this.state.setValueAtIndex(t,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),U(this.elements,(function(t){return t.destroy()})),this.state=null,this.elements=null,this.hot=null}}]),t}();ct(_$,qv);var H$=_$,N$={};function D$(t,e){if(!N$[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));var n=N$[t],r=n.condition,o=n.descriptor,i=e;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(t){return r.apply(t.meta.instance,[].concat([t],[i]))}}function L$(t){if(!N$[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));return N$[t].descriptor}function B$(t,e,n){n.key=t,N$[t]={condition:e,descriptor:n}}var V$="none";function F$(){return!0}B$(V$,F$,{name:RS,inputsCount:0,showOperators:!1});var W$="empty";function U$(t){return ee(t.value)}B$(W$,U$,{name:ES,inputsCount:0,showOperators:!0});var z$="not_empty";function G$(t,e){return!D$(W$,e)(t)}function Y$(t,e){return Q$(t)||q$(t,e)||X$(t,e)||K$()}function K$(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function X$(t,e){if(t){if("string"===typeof t)return $$(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$$(t,e):void 0}}function $$(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function q$(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Q$(t){if(Array.isArray(t))return t}B$(z$,G$,{name:PS,inputsCount:0,showOperators:!0});var J$="eq";function Z$(t,e){var n=Y$(e,1),r=n[0];return Jt(t.value).toLocaleLowerCase(t.meta.locale)===Jt(r)}B$(J$,Z$,{name:TS,inputsCount:1,showOperators:!0});var tq="neq";function eq(t,e){return!D$(J$,e)(t)}function nq(t,e){return lq(t)||aq(t,e)||oq(t,e)||rq()}function rq(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function oq(t,e){if(t){if("string"===typeof t)return iq(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?iq(t,e):void 0}}function iq(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function aq(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function lq(t){if(Array.isArray(t))return t}B$(tq,eq,{name:jS,inputsCount:1,showOperators:!0});var sq="gt";function uq(t,e){var n=nq(e,1),r=n[0],o=r;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value>o}function cq(t,e){return yq(t)||pq(t,e)||hq(t,e)||fq()}function fq(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function hq(t,e){if(t){if("string"===typeof t)return dq(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dq(t,e):void 0}}function dq(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function pq(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function yq(t){if(Array.isArray(t))return t}B$(sq,uq,{name:HS,inputsCount:1,showOperators:!0});var vq="gte";function mq(t,e){var n=cq(e,1),r=n[0],o=r;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value>=o}function gq(t,e){return Oq(t)||Cq(t,e)||wq(t,e)||bq()}function bq(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function wq(t,e){if(t){if("string"===typeof t)return Sq(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Sq(t,e):void 0}}function Sq(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Cq(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Oq(t){if(Array.isArray(t))return t}B$(vq,mq,{name:NS,inputsCount:1,showOperators:!0});var kq="lt";function Rq(t,e){var n=gq(e,1),r=n[0],o=r;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value<o}function Eq(t,e){return Mq(t)||Aq(t,e)||Tq(t,e)||Pq()}function Pq(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Tq(t,e){if(t){if("string"===typeof t)return jq(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jq(t,e):void 0}}function jq(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Aq(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Mq(t){if(Array.isArray(t))return t}B$(kq,Rq,{name:DS,inputsCount:1,showOperators:!0});var Iq="lte";function xq(t,e){var n=Eq(e,1),r=n[0],o=r;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value<=o}function _q(t,e){return Bq(t)||Lq(t,e)||Nq(t,e)||Hq()}function Hq(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Nq(t,e){if(t){if("string"===typeof t)return Dq(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dq(t,e):void 0}}function Dq(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Lq(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Bq(t){if(Array.isArray(t))return t}B$(Iq,xq,{name:LS,inputsCount:1,showOperators:!0});var Vq="date_after";function Fq(t,e){var n=_q(e,1),r=n[0],o=Xt(t.value,t.meta.dateFormat),i=Xt(r,t.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)>=0}function Wq(t,e){return Kq(t)||Yq(t,e)||zq(t,e)||Uq()}function Uq(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function zq(t,e){if(t){if("string"===typeof t)return Gq(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gq(t,e):void 0}}function Gq(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Yq(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Kq(t){if(Array.isArray(t))return t}B$(Vq,Fq,{name:FS,inputsCount:1,showOperators:!0});var Xq="date_before";function $q(t,e){var n=Wq(e,1),r=n[0],o=Xt(t.value,t.meta.dateFormat),i=Xt(r,t.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)<=0}function qq(t,e){return eQ(t)||tQ(t,e)||Jq(t,e)||Qq()}function Qq(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Jq(t,e){if(t){if("string"===typeof t)return Zq(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zq(t,e):void 0}}function Zq(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function tQ(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function eQ(t){if(Array.isArray(t))return t}B$(Xq,$q,{name:WS,inputsCount:1,showOperators:!0});var nQ="between";function rQ(t,e){var n=qq(e,2),r=n[0],o=n[1],i=r,a=o;if("numeric"===t.meta.type){var l=parseFloat(i,10),s=parseFloat(a,10);i=Math.min(l,s),a=Math.max(l,s)}else if("date"===t.meta.type){var u=D$(Xq,[a]),c=D$(Vq,[i]);return u(t)&&c(t)}return t.value>=i&&t.value<=a}B$(nQ,rQ,{name:BS,inputsCount:2,showOperators:!0});var oQ="not_between";function iQ(t,e){return!D$(nQ,e)(t)}function aQ(t,e){return fQ(t)||cQ(t,e)||sQ(t,e)||lQ()}function lQ(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function sQ(t,e){if(t){if("string"===typeof t)return uQ(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uQ(t,e):void 0}}function uQ(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function cQ(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function fQ(t){if(Array.isArray(t))return t}B$(oQ,iQ,{name:VS,inputsCount:2,showOperators:!0});var hQ="begins_with";function dQ(t,e){var n=aQ(e,1),r=n[0];return Jt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Jt(r))}B$(hQ,dQ,{name:AS,inputsCount:1,showOperators:!0});n(8605);function pQ(t,e){return bQ(t)||gQ(t,e)||vQ(t,e)||yQ()}function yQ(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function vQ(t,e){if(t){if("string"===typeof t)return mQ(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mQ(t,e):void 0}}function mQ(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function gQ(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function bQ(t){if(Array.isArray(t))return t}var wQ="ends_with";function SQ(t,e){var n=pQ(e,1),r=n[0];return Jt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Jt(r))}function CQ(t,e){return PQ(t)||EQ(t,e)||kQ(t,e)||OQ()}function OQ(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function kQ(t,e){if(t){if("string"===typeof t)return RQ(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?RQ(t,e):void 0}}function RQ(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function EQ(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function PQ(t){if(Array.isArray(t))return t}B$(wQ,SQ,{name:MS,inputsCount:1,showOperators:!0});var TQ="contains";function jQ(t,e){var n=CQ(e,1),r=n[0];return Jt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Jt(r))>=0}B$(TQ,jQ,{name:IS,inputsCount:1,showOperators:!0});var AQ="not_contains";function MQ(t,e){return!D$(TQ,e)(t)}B$(AQ,MQ,{name:xS,inputsCount:1,showOperators:!0});var IQ="date_tomorrow";function xQ(t){var e=Xt(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(Xt().subtract(-1,"days").startOf("day"),"d")}B$(IQ,xQ,{name:zS,inputsCount:0});var _Q="date_today";function HQ(t){var e=Xt(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(Xt().startOf("day"),"d")}B$(_Q,HQ,{name:US,inputsCount:0});var NQ,DQ="date_yesterday";function LQ(t){var e=Xt(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(Xt().subtract(1,"days").startOf("day"),"d")}function BQ(t){return BQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},BQ(t)}function VQ(t,e,n){return e=FQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FQ(t){var e=WQ(t,"string");return"symbol"===BQ(e)?e:String(e)}function WQ(t,e){if("object"!==BQ(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==BQ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}B$(DQ,LQ,{name:GS,inputsCount:0});var UQ="numeric",zQ="text",GQ="date",YQ=(NQ={},VQ(NQ,UQ,[V$,tW,W$,z$,tW,J$,tq,tW,sq,vq,kq,Iq,nQ,oQ]),VQ(NQ,zQ,[V$,tW,W$,z$,tW,J$,tq,tW,hQ,wQ,tW,TQ,AQ]),VQ(NQ,GQ,[V$,tW,W$,z$,tW,J$,tq,tW,Xq,Vq,nQ,tW,IQ,_Q,DQ]),NQ);function KQ(t){var e=[],n=t;return YQ[n]||(n=zQ),U(YQ[n],(function(t){var n;n=t===tW?{name:tW}:ut(L$(t)),e.push(n)})),e}function XQ(t){return XQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},XQ(t)}function $Q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qQ(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,JQ(r.key),r)}}function QQ(t,e,n){return e&&qQ(t.prototype,e),n&&qQ(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function JQ(t){var e=ZQ(t,"string");return"symbol"===XQ(e)?e:String(e)}function ZQ(t,e){if("object"!==XQ(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==XQ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var tJ="built",eJ="building",nJ=["click","input","keydown","keypress","keyup","focus","blur","change"],rJ=function(){function t(e,n){$Q(this,t),this.hot=e,this.eventManager=new Gr(this),this.options=at(t.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return QQ(t,[{key:"setValue",value:function(t){this.options.value=t,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===eJ?this._element:this.buildState===tJ?(this.update(),this._element):(this.buildState=eJ,this.build(),this.buildState=tJ,this._element)}},{key:"isBuilt",value:function(){return this.buildState===tJ}},{key:"translateIfPossible",value:function(t){return"string"===typeof t&&t.startsWith(OS)?this.hot.getTranslatedPhrase(t):t}},{key:"build",value:function(){var t=this,e=function(e,n){t.eventManager.addEventListener(e,n,(function(e){return t.runLocalHooks(n,e,t)}))};if(this.buildState||(this.buildState=eJ),this.options.className&&Ge(this._element,this.options.className),this.options.children.length)U(this.options.children,(function(e){return t._element.appendChild(e.element)}));else if(this.options.wrapIt){var n=this.hot.rootDocument.createElement(this.options.tagName);pt(this.options,(function(e,r){void 0!==n[r]&&"className"!==r&&"tagName"!==r&&"children"!==r&&(n[r]=t.translateIfPossible(e))})),this._element.appendChild(n),U(nJ,(function(t){return e(n,t)}))}else U(nJ,(function(n){return e(t._element,n)}))}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return ut({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),t}();ct(rJ,qv);var oJ=rJ;function iJ(t){return iJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iJ(t)}function aJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lJ(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,uJ(r.key),r)}}function sJ(t,e,n){return e&&lJ(t.prototype,e),n&&lJ(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function uJ(t){var e=cJ(t,"string");return"symbol"===iJ(e)?e:String(e)}function cJ(t,e){if("object"!==iJ(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==iJ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function fJ(){return fJ="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=hJ(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},fJ.apply(this,arguments)}function hJ(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=bJ(t),null===t)break;return t}function dJ(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pJ(t,e)}function pJ(t,e){return pJ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},pJ(t,e)}function yJ(t){var e=gJ();return function(){var n,r=bJ(t);if(e){var o=bJ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vJ(this,n)}}function vJ(t,e){if(e&&("object"===iJ(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return mJ(t)}function mJ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gJ(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function bJ(t){return bJ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bJ(t)}var wJ=new WeakMap,SJ=function(t){dJ(n,t);var e=yJ(n);function n(t,r){var o;return aJ(this,n),o=e.call(this,t,at(n.DEFAULTS,r)),wJ.set(mJ(o),{}),o.registerHooks(),o}return sJ(n,[{key:"registerHooks",value:function(){var t=this;this.addLocalHook("click",(function(){return t.onClick()})),this.addLocalHook("keyup",(function(e){return t.onKeyup(e)}))}},{key:"build",value:function(){fJ(bJ(n.prototype),"build",this).call(this);var t=wJ.get(this),e=this.hot.rootDocument.createElement("div");t.input=this._element.firstChild,Ge(this._element,"htUIInput"),Ge(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var t=wJ.get(this).input;t.type=this.options.type,t.placeholder=this.translateIfPossible(this.options.placeholder),t.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&wJ.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(t){this.options.value=t.target.value}}],[{key:"DEFAULTS",get:function(){return ut({placeholder:"",type:"text",tagName:"input"})}}]),n}(oJ),CJ=SJ;function OJ(t){return OJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OJ(t)}function kJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function RJ(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,PJ(r.key),r)}}function EJ(t,e,n){return e&&RJ(t.prototype,e),n&&RJ(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function PJ(t){var e=TJ(t,"string");return"symbol"===OJ(e)?e:String(e)}function TJ(t,e){if("object"!==OJ(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==OJ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function jJ(){return jJ="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=AJ(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},jJ.apply(this,arguments)}function AJ(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=DJ(t),null===t)break;return t}function MJ(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&IJ(t,e)}function IJ(t,e){return IJ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},IJ(t,e)}function xJ(t){var e=NJ();return function(){var n,r=DJ(t);if(e){var o=DJ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _J(this,n)}}function _J(t,e){if(e&&("object"===OJ(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return HJ(t)}function HJ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function NJ(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function DJ(t){return DJ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},DJ(t)}var LJ=new WeakMap,BJ=function(t){MJ(n,t);var e=xJ(n);function n(t,r){var o;return kJ(this,n),o=e.call(this,t,at(n.DEFAULTS,r)),LJ.set(HJ(o),{}),o.menu=null,o.items=[],o.registerHooks(),o}return EJ(n,[{key:"registerHooks",value:function(){var t=this;this.addLocalHook("click",(function(){return t.onClick()}))}},{key:"setItems",value:function(t){this.items=this.translateNames(t),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(t){var e=this;return U(t,(function(t){t.name=e.translateIfPossible(t.name)})),t}},{key:"build",value:function(){var t=this;jJ(DJ(n.prototype),"build",this).call(this),this.menu=new jz(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var e=new oJ(this.hot,{className:"htUISelectCaption"}),r=new oJ(this.hot,{className:"htUISelectDropdown"}),o=LJ.get(this);o.caption=e,o.captionElement=e.element,o.dropdown=r,U([e,r],(function(e){return t._element.appendChild(e.element)})),this.menu.addLocalHook("select",(function(e){return t.onMenuSelect(e)})),this.menu.addLocalHook("afterClose",(function(){return t.onMenuClosed()})),this.update()}},{key:"update",value:function(){var t;this.isBuilt()&&(t=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(RS),LJ.get(this).captionElement.textContent=t,jJ(DJ(n.prototype),"update",this).call(this))}},{key:"openOptions",value:function(){var t=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(t){t.name!==tW&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var t=LJ.get(this),e=t.caption,r=t.dropdown;e&&e.destroy(),r&&r.destroy(),jJ(DJ(n.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return ut({className:"htUISelect",wrapIt:!1})}}]),n}(oJ),VJ=BJ;function FJ(t){return FJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FJ(t)}function WJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function UJ(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,GJ(r.key),r)}}function zJ(t,e,n){return e&&UJ(t.prototype,e),n&&UJ(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function GJ(t){var e=YJ(t,"string");return"symbol"===FJ(e)?e:String(e)}function YJ(t,e){if("object"!==FJ(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==FJ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function KJ(){return KJ="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=XJ(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},KJ.apply(this,arguments)}function XJ(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=eZ(t),null===t)break;return t}function $J(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qJ(t,e)}function qJ(t,e){return qJ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},qJ(t,e)}function QJ(t){var e=tZ();return function(){var n,r=eZ(t);if(e){var o=eZ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return JJ(this,n)}}function JJ(t,e){if(e&&("object"===FJ(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ZJ(t)}function ZJ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tZ(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function eZ(t){return eZ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},eZ(t)}var nZ=function(t){$J(n,t);var e=QJ(n);function n(t,r){var o;return WJ(this,n),o=e.call(this,t,{id:r.id,stateless:!1}),o.name=r.name,o.addSeparator=r.addSeparator,o.elements.push(new VJ(o.hot,{menuContainer:r.menuContainer})),o.elements.push(new CJ(o.hot,{placeholder:nC})),o.elements.push(new CJ(o.hot,{placeholder:rC})),o.registerHooks(),o}return zJ(n,[{key:"registerHooks",value:function(){var t=this;this.getSelectElement().addLocalHook("select",(function(e){return t.onConditionSelect(e)})),this.getSelectElement().addLocalHook("afterClose",(function(){return t.onSelectUIClosed()})),U(this.getInputElements(),(function(e){e.addLocalHook("keydown",(function(e){return t.onInputKeyDown(e)}))}))}},{key:"setState",value:function(t){var e=this;if(this.reset(),t){var n=ut(t.command);n.name.startsWith(kS)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),U(t.args,(function(t,r){if(r>n.inputsCount-1)return!1;var o=e.getInputElement(r);o.setValue(t),o[n.inputsCount>r?"show":"hide"](),r||setTimeout((function(){return o.focus()}),10)}))}}},{key:"getState",value:function(){var t=this.getSelectElement().getValue()||L$(V$),e=[];return U(this.getInputElements(),(function(n,r){t.inputsCount>r&&e.push(n.getValue())})),{command:t,args:e}}},{key:"updateState",value:function(t,e){var n=L$(t?t.name:V$);this.state.setValueAtIndex(e,{command:n,args:t?t.args:[]}),t||U(this.getInputElements(),(function(t){return t.setValue(null)}))}},{key:"getSelectElement",value:function(){return this.elements.filter((function(t){return t instanceof VJ}))[0]}},{key:"getInputElement",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}},{key:"getInputElements",value:function(){return this.elements.filter((function(t){return t instanceof CJ}))}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n,r,o,i,a){Ge(n.parentNode,"htFiltersMenuCondition"),t.addSeparator&&Ge(n.parentNode,"border");var l=t.hot.rootDocument.createElement("div");return Ge(l,"htFiltersMenuLabel"),l.textContent=a,n.appendChild(l),n.parentNode.hasAttribute("ghost-table")||U(t.elements,(function(t){return n.appendChild(t.element)})),n}}}},{key:"reset",value:function(){var t=this.hot.getPlugin("filters").getSelectedColumn(),e=[L$(V$)];if(null!==t){var r=t.visualIndex;e=KQ(this.hot.getDataType(0,r,this.hot.countRows(),r))}U(this.getInputElements(),(function(t){return t.hide()})),this.getSelectElement().setItems(e),KJ(eZ(n.prototype),"reset",this).call(this),this.getSelectElement().setValue(e[0])}},{key:"onConditionSelect",value:function(t){U(this.getInputElements(),(function(e,n){e[t.inputsCount>n?"show":"hide"](),0===n&&setTimeout((function(){return e.focus()}),10)})),this.runLocalHooks("change",t)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(t){Jn(t.keyCode,"ENTER")?(this.runLocalHooks("accept"),Zn(t)):Jn(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Zn(t))}}]),n}(H$),rZ=nZ,oZ={};function iZ(t){if(!oZ[t])throw Error('Operation with id "'.concat(t,'" does not exist.'));var e=oZ[t].func;return function(t,n){return e(t,n)}}function aZ(t){return oZ[t].name}function lZ(t,e,n){oZ[t]={name:e,func:n}}var sZ="conjunction",uZ=XS;function cZ(t,e){return t.every((function(t){return t.func(e)}))}lZ(sZ,uZ,cZ);var fZ="disjunction",hZ=$S;function dZ(t,e){return t.some((function(t){return t.func(e)}))}lZ(fZ,hZ,dZ);var pZ="disjunctionWithExtraCondition",yZ=$S;function vZ(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some((function(t){return t.func(e)}))&&t[t.length-1].func(e)}function mZ(t){return mZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mZ(t)}function gZ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bZ(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,SZ(r.key),r)}}function wZ(t,e,n){return e&&bZ(t.prototype,e),n&&bZ(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function SZ(t){var e=CZ(t,"string");return"symbol"===mZ(e)?e:String(e)}function CZ(t,e){if("object"!==mZ(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==mZ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function OZ(){return OZ="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=kZ(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},OZ.apply(this,arguments)}function kZ(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=MZ(t),null===t)break;return t}function RZ(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&EZ(t,e)}function EZ(t,e){return EZ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},EZ(t,e)}function PZ(t){var e=AZ();return function(){var n,r=MZ(t);if(e){var o=MZ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return TZ(this,n)}}function TZ(t,e){if(e&&("object"===mZ(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return jZ(t)}function jZ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function AZ(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function MZ(t){return MZ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},MZ(t)}lZ(pZ,yZ,vZ);var IZ,xZ=new WeakMap,_Z=function(t){RZ(n,t);var e=PZ(n);function n(t,r){var o;return gZ(this,n),o=e.call(this,t,at(n.DEFAULTS,r)),xZ.set(jZ(o),{}),o}return wZ(n,[{key:"build",value:function(){OZ(MZ(n.prototype),"build",this).call(this);var t=xZ.get(this);t.input=this._element.firstChild;var e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),t.label=e,this._element.appendChild(e),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var t=xZ.get(this);t.input.checked=this.options.checked,t.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.options.checked=t,this.update()}},{key:"focus",value:function(){this.isBuilt()&&xZ.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return ut({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),n}(oJ),HZ=_Z;function NZ(t){return NZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NZ(t)}function DZ(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function LZ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function BZ(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,FZ(r.key),r)}}function VZ(t,e,n){return e&&BZ(t.prototype,e),n&&BZ(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function FZ(t){var e=WZ(t,"string");return"symbol"===NZ(e)?e:String(e)}function WZ(t,e){if("object"!==NZ(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==NZ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function UZ(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zZ(t,e)}function zZ(t,e){return zZ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},zZ(t,e)}function GZ(t){var e=XZ();return function(){var n,r=$Z(t);if(e){var o=$Z(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return YZ(this,n)}}function YZ(t,e){if(e&&("object"===NZ(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return KZ(t)}function KZ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function XZ(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function $Z(t){return $Z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$Z(t)}var qZ=0,QZ=function(t){UZ(n,t);var e=GZ(n);function n(t,r){var o;return LZ(this,n),o=e.call(this,t,{id:r.id,stateless:!1}),o.name=r.name,o.buildOperatorsElement(),o}return VZ(n,[{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n){return Ge(n.parentNode,"htFiltersMenuOperators"),n.parentNode.hasAttribute("ghost-table")||U(t.elements,(function(t){return n.appendChild(t.element)})),n}}}},{key:"buildOperatorsElement",value:function(){var t=this,e=[sZ,fZ];U(e,(function(n){var r=new HZ(t.hot,{name:"operator",label:{htmlFor:n,textContent:aZ(n)},value:n,checked:n===e[qZ],id:n});r.addLocalHook("change",(function(e){return t.onRadioInputChange(e)})),t.elements.push(r)}))}},{key:"setChecked",value:function(t){if(this.elements.length<t)throw Error($t(IZ||(IZ=DZ(["Radio button with index "," doesn't exist."])),t));U(this.elements,(function(e,n){e.setChecked(n===t)}))}},{key:"getActiveOperationId",value:function(){var t=this.elements.find((function(t){return t instanceof HZ&&t.isChecked()}));return t?t.getValue():sZ}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(t){this.reset(),t&&this.getActiveOperationId()!==t&&U(this.elements,(function(e){e.setChecked(e.getValue()===t)}))}},{key:"updateState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:sZ,e=arguments.length>1?arguments[1]:void 0,n=t;n===pZ&&(n=fZ),this.state.setValueAtIndex(e,n)}},{key:"reset",value:function(){this.setChecked(qZ)}},{key:"onRadioInputChange",value:function(t){this.setState(t.target.value)}}]),n}(H$),JZ=QZ;H();function ZZ(t,e){var n=t;return""===n&&(n="(".concat(e,")")),n}var t0=new Set([1]).has(1),e0=t0&&"function"===typeof Array.from;function n0(t){var e=t;return t0&&(e=new Set(e)),function(t){var n;return n=t0?e.has(t):!!~e.indexOf(t),n}}function r0(t){return null===t||void 0===t?"":t}function o0(t){var e=t;return e=e0?Array.from(new Set(e)):$(e),e=e.sort((function(t,e){return"number"===typeof t&&"number"===typeof e?t-e:t===e?0:t>e?1:-1})),e}function i0(t,e,n,r){var o,i=[],a=t===e;return a||(o=n0(e)),U(t,(function(t){var e=!1;(a||o(t))&&(e=!0);var l={checked:e,value:t,visualValue:ZZ(t,n)};r&&r(l),i.push(l)})),i}n(3645);function a0(t){return a0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a0(t)}function l0(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s0(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,c0(r.key),r)}}function u0(t,e,n){return e&&s0(t.prototype,e),n&&s0(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function c0(t){var e=f0(t,"string");return"symbol"===a0(e)?e:String(e)}function f0(t,e){if("object"!==a0(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==a0(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function h0(){return h0="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=d0(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},h0.apply(this,arguments)}function d0(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=w0(t),null===t)break;return t}function p0(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y0(t,e)}function y0(t,e){return y0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},y0(t,e)}function v0(t){var e=b0();return function(){var n,r=w0(t);if(e){var o=w0(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return m0(this,n)}}function m0(t,e){if(e&&("object"===a0(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return g0(t)}function g0(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b0(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function w0(t){return w0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},w0(t)}var S0=new WeakMap,C0=function(t){p0(n,t);var e=v0(n);function n(t,r){var o;return l0(this,n),o=e.call(this,t,at(n.DEFAULTS,r)),S0.set(g0(o),{}),o}return u0(n,[{key:"build",value:function(){h0(w0(n.prototype),"build",this).call(this);var t=S0.get(this);t.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(S0.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return ut({href:"#",tagName:"a"})}}]),n}(oJ),O0=C0;function k0(t){return k0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k0(t)}function R0(t){return j0(t)||T0(t)||P0(t)||E0()}function E0(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function P0(t,e){if(t){if("string"===typeof t)return A0(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A0(t,e):void 0}}function T0(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function j0(t){if(Array.isArray(t))return A0(t)}function A0(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function M0(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I0(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_0(r.key),r)}}function x0(t,e,n){return e&&I0(t.prototype,e),n&&I0(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _0(t){var e=H0(t,"string");return"symbol"===k0(e)?e:String(e)}function H0(t,e){if("object"!==k0(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==k0(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function N0(){return N0="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=D0(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},N0.apply(this,arguments)}function D0(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=z0(t),null===t)break;return t}function L0(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&B0(t,e)}function B0(t,e){return B0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},B0(t,e)}function V0(t){var e=U0();return function(){var n,r=z0(t);if(e){var o=z0(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return F0(this,n)}}function F0(t,e){if(e&&("object"===k0(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return W0(t)}function W0(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function U0(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function z0(t){return z0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},z0(t)}var G0=new WeakMap,Y0="multipleSelect.itemBox",K0=function(t){L0(n,t);var e=V0(n);function n(t,r){var o;return M0(this,n),o=e.call(this,t,at(n.DEFAULTS,r)),G0.set(W0(o),{}),o.searchInput=new CJ(o.hot,{placeholder:eC,className:"htUIMultipleSelectSearch"}),o.selectAllUI=new O0(o.hot,{textContent:QS,className:"htUISelectAll"}),o.clearAllUI=new O0(o.hot,{textContent:JS,className:"htUIClearAll"}),o.items=[],o.itemsBox=null,o.registerHooks(),o}return x0(n,[{key:"registerHooks",value:function(){var t=this;this.searchInput.addLocalHook("keydown",(function(e){return t.onInputKeyDown(e)})),this.searchInput.addLocalHook("input",(function(e){return t.onInput(e)})),this.selectAllUI.addLocalHook("click",(function(e){return t.onSelectAllClick(e)})),this.clearAllUI.addLocalHook("click",(function(e){return t.onClearAllClick(e)}))}},{key:"setItems",value:function(t){this.items=t,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(t){this.locale=t}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return R0(this.items)}},{key:"getValue",value:function(){return q0(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var t=this;N0(z0(n.prototype),"build",this).call(this);var e=this.hot.rootDocument,r=e.createElement("div"),o=new oJ(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(o.element),this._element.appendChild(r);var i=function(n){if(t._element){t.itemsBox&&t.itemsBox.destroy(),Ge(n,"htUIMultipleSelectHot"),t.itemsBox=new t.hot.constructor(n,{data:t.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(t,e,n,r,o,i){t.title=i.instance.getDataAtRowProp(e,i.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return t.itemsBox.container.scrollWidth-On(e)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:t.hot.isRtl()?"rtl":"ltr"}),t.itemsBox.init();var r=t.itemsBox.getShortcutManager(),o=r.getContext("grid");o.addShortcut({keys:[["Escape"]],callback:function(e){t.runLocalHooks("keydown",e,t)},group:Y0})}};i(r),setTimeout((function(){return i(r)}),100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData($0(this.items,this.options.value)),N0(z0(n.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,N0(z0(n.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(t){var e,n=this,r=t.target.value.toLocaleLowerCase(this.getLocale());e=""===r?R0(this.items):F(this.items,(function(t){return"".concat(t.value).toLocaleLowerCase(n.getLocale()).indexOf(r)>=0})),this.itemsBox.loadData(e)}},{key:"onInputKeyDown",value:function(t){this.runLocalHooks("keydown",t,this);var e=Bn(Jn,t.keyCode);e("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Zn(t),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(t){var e=[];t.preventDefault(),U(this.itemsBox.getSourceData(),(function(t,n){t.checked=!0,e.push(Nv(t,n)[0])})),this.itemsBox.setSourceDataAtCell(e)}},{key:"onClearAllClick",value:function(t){var e=[];t.preventDefault(),U(this.itemsBox.getSourceData(),(function(t,n){t.checked=!1,e.push(Nv(t,n)[0])})),this.itemsBox.setSourceDataAtCell(e)}}],[{key:"DEFAULTS",get:function(){return ut({className:"htUIMultipleSelect",value:[]})}}]),n}(oJ),X0=K0;function $0(t,e){var n=n0(e);return W(t,(function(t){return t.checked=n(t.value),t}))}function q0(t){var e=[];return U(t,(function(t){t.checked&&e.push(t.value)})),e}function Q0(t,e){return n1(t)||e1(t,e)||Z0(t,e)||J0()}function J0(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Z0(t,e){if(t){if("string"===typeof t)return t1(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t1(t,e):void 0}}function t1(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function e1(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function n1(t){if(Array.isArray(t))return t}var r1="by_value";function o1(t,e){var n=Q0(e,1),r=n[0];return r(t.value)}function i1(t){return i1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i1(t)}function a1(t,e){return f1(t)||c1(t,e)||s1(t,e)||l1()}function l1(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s1(t,e){if(t){if("string"===typeof t)return u1(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u1(t,e):void 0}}function u1(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c1(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function f1(t){if(Array.isArray(t))return t}function h1(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d1(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,y1(r.key),r)}}function p1(t,e,n){return e&&d1(t.prototype,e),n&&d1(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function y1(t){var e=v1(t,"string");return"symbol"===i1(e)?e:String(e)}function v1(t,e){if("object"!==i1(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==i1(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function m1(){return m1="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=g1(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},m1.apply(this,arguments)}function g1(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=R1(t),null===t)break;return t}function b1(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w1(t,e)}function w1(t,e){return w1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},w1(t,e)}function S1(t){var e=k1();return function(){var n,r=R1(t);if(e){var o=R1(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return C1(this,n)}}function C1(t,e){if(e&&("object"===i1(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return O1(t)}function O1(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function k1(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function R1(t){return R1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},R1(t)}B$(r1,o1,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var e=Q0(t,1),n=e[0];return[n0(n)]},showOperators:!1});var E1=function(t){b1(n,t);var e=S1(n);function n(t,r){var o;return h1(this,n),o=e.call(this,t,{id:r.id,stateless:!1}),o.name=r.name,o.elements.push(new X0(o.hot)),o.registerHooks(),o}return p1(n,[{key:"registerHooks",value:function(){var t=this;this.getMultipleSelectElement().addLocalHook("keydown",(function(e){return t.onInputKeyDown(e)}))}},{key:"setState",value:function(t){if(this.reset(),t&&t.command.key===r1){var e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0]),e.setLocale(t.locale)}}},{key:"getState",value:function(){var t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?V$:r1},args:[t.getValue()],itemsSnapshot:e}}},{key:"updateState",value:function(t){var e=this,n=function(n,r,o,i,a){var l=F(r,(function(t){return t.name===r1})),s=a1(l,1),u=s[0],c={},f=e.hot.getTranslatedPhrase(qS);if(u){var h=o0(W(i(n,a),(function(t){return t.value})));o&&(u.args[0]=o);var d=[],p=i0(h,u.args[0],f,(function(t){t.checked&&d.push(t.value)})),y=t.editedConditionStack.column;c.locale=e.hot.getCellMeta(0,y).locale,c.args=[d],c.command=L$(r1),c.itemsSnapshot=p}else c.args=[],c.command=L$(V$);e.state.setValueAtIndex(n,c)};n(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&n(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter((function(t){return t instanceof X0}))[0]}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n,r,o,i,a){Ge(n.parentNode,"htFiltersMenuValue");var l=t.hot.rootDocument.createElement("div");return Ge(l,"htFiltersMenuLabel"),l.textContent=a,n.appendChild(l),n.parentNode.hasAttribute("ghost-table")||U(t.elements,(function(t){return n.appendChild(t.element)})),n}}}},{key:"reset",value:function(){var t=this.hot.getTranslatedPhrase(qS),e=o0(this._getColumnVisibleValues()),r=i0(e,e,t);this.getMultipleSelectElement().setItems(r),m1(R1(n.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(e);var o=this.hot.getPlugin("filters").getSelectedColumn();null!==o&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,o.visualIndex).locale)}},{key:"onInputKeyDown",value:function(t){Jn(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Zn(t))}},{key:"_getColumnVisibleValues",value:function(){var t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:W(this.hot.getDataAtCol(t.visualIndex),(function(t){return r0(t)}))}}]),n}(H$),P1=E1;function T1(t){return T1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T1(t)}function j1(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A1(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,I1(r.key),r)}}function M1(t,e,n){return e&&A1(t.prototype,e),n&&A1(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function I1(t){var e=x1(t,"string");return"symbol"===T1(e)?e:String(e)}function x1(t,e){if("object"!==T1(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==T1(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _1(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&H1(t,e)}function H1(t,e){return H1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},H1(t,e)}function N1(t){var e=B1();return function(){var n,r=V1(t);if(e){var o=V1(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return D1(this,n)}}function D1(t,e){if(e&&("object"===T1(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return L1(t)}function L1(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function B1(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function V1(t){return V1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},V1(t)}var F1,W1,U1=function(t){_1(n,t);var e=N1(n);function n(t,r){var o;return j1(this,n),o=e.call(this,t,{id:r.id,stateless:!0}),o.name=r.name,o.elements.push(new CJ(o.hot,{type:"button",value:ZS,className:"htUIButton htUIButtonOK",identifier:n.BUTTON_OK})),o.elements.push(new CJ(o.hot,{type:"button",value:tC,className:"htUIButton htUIButtonCancel",identifier:n.BUTTON_CANCEL})),o.registerHooks(),o}return M1(n,[{key:"registerHooks",value:function(){var t=this;U(this.elements,(function(e){e.addLocalHook("click",(function(e,n){return t.onButtonClick(e,n)}))}))}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n){return Ge(n.parentNode,"htFiltersMenuActionBar"),n.parentNode.hasAttribute("ghost-table")||U(t.elements,(function(t){return n.appendChild(t.element)})),n}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(t,e){e.options.identifier===n.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),n}(H$),z1=U1;function G1(t){return G1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G1(t)}function Y1(t,e){return Q1(t)||q1(t,e)||X1(t,e)||K1()}function K1(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function X1(t,e){if(t){if("string"===typeof t)return $1(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$1(t,e):void 0}}function $1(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function q1(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Q1(t){if(Array.isArray(t))return t}function J1(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Z1(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function t2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,n2(r.key),r)}}function e2(t,e,n){return e&&t2(t.prototype,e),n&&t2(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function n2(t){var e=r2(t,"string");return"symbol"===G1(e)?e:String(e)}function r2(t,e){if("object"!==G1(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==G1(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var o2="ConditionCollection.filteringStates",i2=function(){function t(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Z1(this,t),this.hot=e,this.isMapRegistrable=n,this.filteringStates=new Ng,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(o2,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return e2(t,[{key:"isEmpty",value:function(){return 0===this.getFilteredColumns().length}},{key:"isMatch",value:function(t,e){var n,r=this.filteringStates.getValueAtIndex(e),o=null!==(n=null===r||void 0===r?void 0:r.conditions)&&void 0!==n?n:[],i=null===r||void 0===r?void 0:r.operation;return this.isMatchInConditions(o,t,i)}},{key:"isMatchInConditions",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:sZ;return!t.length||iZ(n)(t,e)}},{key:"addCondition",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:sZ,r=arguments.length>3?arguments[3]:void 0,o=this.hot.getCellMeta(0,t).locale,i=W(e.args,(function(t){return"string"===typeof t?t.toLocaleLowerCase(o):t})),a=e.name||e.command.key;this.runLocalHooks("beforeAdd",t);var l=this.getOperation(t);if(l){if(l!==n)throw Error($t(F1||(F1=J1(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),t,l))}else if(te(oZ[n]))throw new Error($t(W1||(W1=J1(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),n));var s=this.getConditions(t);0===s.length?this.filteringStates.setValueAtIndex(t,{operation:n,conditions:[{name:a,args:i,func:D$(a,i)}]},r):s.push({name:a,args:i,func:D$(a,i)}),this.runLocalHooks("afterAdd",t)}},{key:"getConditions",value:function(t){var e,n;return null!==(e=null===(n=this.filteringStates.getValueAtIndex(t))||void 0===n?void 0:n.conditions)&&void 0!==e?e:[]}},{key:"getOperation",value:function(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map((function(t){var e=Y1(t,1),n=e[0];return n}))}},{key:"getColumnStackPosition",value:function(t){return this.getFilteredColumns().indexOf(t)}},{key:"exportAllConditions",value:function(){return V(this.filteringStates.getEntries(),(function(t,e){var n=Y1(e,2),r=n[0],o=n[1],i=o.operation,a=o.conditions;return t.push({column:r,operation:i,conditions:W(a,(function(t){var e=t.name,n=t.args;return{name:e,args:n}}))}),t}),[])}},{key:"importAllConditions",value:function(t){var e=this;this.clean(),U(t,(function(t){U(t.conditions,(function(n){return e.addCondition(t.column,n)}))}))}},{key:"removeConditions",value:function(t){this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(t,e){var n=this.getConditions(t);return e?n.some((function(t){return t.name===e})):n.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(o2),this.filteringStates=null,this.clearLocalHooks()}}]),t}();ct(i2,qv);var a2=i2;function l2(t){return l2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l2(t)}function s2(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,f2(r.key),r)}}function c2(t,e,n){return e&&u2(t.prototype,e),n&&u2(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function f2(t){var e=h2(t,"string");return"symbol"===l2(e)?e:String(e)}function h2(t,e){if("object"!==l2(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==l2(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var d2=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return[]};s2(this,t),this.conditionCollection=e,this.columnDataFactory=n}return c2(t,[{key:"filter",value:function(){var t=this,e=[];return U(this.conditionCollection.getFilteredColumns(),(function(n,r){var o=t.columnDataFactory(n);r&&(o=t._getIntersectData(o,e)),e=t.filterByColumn(n,o)})),e}},{key:"filterByColumn",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return U(n,(function(n){void 0!==n&&e.conditionCollection.isMatch(n,t)&&r.push(n)})),r}},{key:"_getIntersectData",value:function(t,e){var n=[];return U(e,(function(e){var r=e.meta.visualRow;void 0!==t[r]&&(n[r]=t[r])})),n}}]),t}(),p2=d2;function y2(t){return y2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y2(t)}function v2(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,b2(r.key),r)}}function g2(t,e,n){return e&&m2(t.prototype,e),n&&m2(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function b2(t){var e=w2(t,"string");return"symbol"===y2(e)?e:String(e)}function w2(t,e){if("object"!==y2(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==y2(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var S2=function(){function t(e,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return[]};v2(this,t),this.hot=e,this.conditionCollection=n,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",(function(t){return r._onConditionBeforeModify(t)})),this.conditionCollection.addLocalHook("afterRemove",(function(t){return r.updateStatesAtColumn(t)})),this.conditionCollection.addLocalHook("afterAdd",(function(t){return r.updateStatesAtColumn(t)})),this.conditionCollection.addLocalHook("beforeClean",(function(){return r._onConditionBeforeClean()})),this.conditionCollection.addLocalHook("afterClean",(function(){return r._onConditionAfterClean()}))}return g2(t,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var t=this;this.grouping=!1,U(this.changes,(function(e){t.updateStatesAtColumn(e)})),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}},{key:"updateStatesAtColumn",value:function(t,e){var n=this;if(this.grouping)-1===this.changes.indexOf(t)&&this.changes.push(t);else{var r=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.getColumnStackPosition(t);-1===o&&(o=this.latestEditedColumnPosition);var i=r.slice(0,o),a=r.slice(o);a.length&&a[0].column===t&&a.shift();var l=Vn((function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=new a2(n.hot,!1),i=[].concat(t,r);o.importAllConditions(i);var a,l=n.columnDataFactory(e);a=o.isEmpty()?l:new p2(o,(function(t){return n.columnDataFactory(t)})).filter(),a=W(a,(function(t){return t.meta.visualRow}));var s=n0(a);return o.destroy(),F(l,(function(t){return s(t.meta.visualRow)}))}))(i),s=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:s},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:e})}}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var t=this;U(this.latestOrderStack,(function(e){t.updateStatesAtColumn(e)}))}},{key:"destroy",value:function(){var t=this;this.clearLocalHooks(),pt(this,(function(e,n){t[n]=null}))}}]),t}();ct(S2,qv);var C2,O2=S2;function k2(t){return k2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k2(t)}function R2(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function E2(t,e){return M2(t)||A2(t,e)||T2(t,e)||P2()}function P2(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function T2(t,e){if(t){if("string"===typeof t)return j2(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j2(t,e):void 0}}function j2(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function A2(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function M2(t){if(Array.isArray(t))return t}function I2(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,H2(r.key),r)}}function _2(t,e,n){return e&&x2(t.prototype,e),n&&x2(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function H2(t){var e=N2(t,"string");return"symbol"===k2(e)?e:String(e)}function N2(t,e){if("object"!==k2(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==k2(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function D2(){return D2="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=L2(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},D2.apply(this,arguments)}function L2(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=G2(t),null===t)break;return t}function B2(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&V2(t,e)}function V2(t,e){return V2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},V2(t,e)}function F2(t){var e=z2();return function(){var n,r=G2(t);if(e){var o=G2(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return W2(this,n)}}function W2(t,e){if(e&&("object"===k2(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return U2(t)}function U2(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function z2(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function G2(t){return G2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},G2(t)}var Y2="filters",K2=250,X2=function(t){B2(n,t);var e=F2(n);function n(t){var r;return I2(this,n),r=e.call(this,t),r.eventManager=new Gr(U2(r)),r.dropdownMenuPlugin=null,r.conditionCollection=null,r.conditionUpdateObserver=null,r.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),r.filtersRowsMap=null,r.hot.addHook("afterGetColHeader",(function(t,e){return r.onAfterGetColHeader(t,e)})),r}return _2(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Y2]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new qg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var e=this.hot.getSettings().dropdownMenu,r=e&&e.uiContainer||this.hot.rootDocument.body,o=function(e){return e.addLocalHook("accept",(function(){return t.onActionBarSubmit("accept")})),e.addLocalHook("cancel",(function(){return t.onActionBarSubmit("cancel")})),e.addLocalHook("change",(function(n){return t.onComponentChange(e,n)})),e},i=function(){return"".concat(t.hot.getTranslatedPhrase(YS),":")},a=function(){return"".concat(t.hot.getTranslatedPhrase(KS),":")};if(!this.components.get("filter_by_condition")){var l=new rZ(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:r});l.addLocalHook("afterClose",(function(){return t.onSelectUIClosed()})),this.components.set("filter_by_condition",o(l))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new JZ(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var s=new rZ(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});s.addLocalHook("afterClose",(function(){return t.onSelectUIClosed()})),this.components.set("filter_by_condition2",o(s))}this.components.get("filter_by_value")||this.components.set("filter_by_value",o(new P1(this.hot,{id:"filter_by_value",name:a}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",o(new z1(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new a2(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new O2(this.hot,this.conditionCollection,(function(e){return t.getDataMapAtColumn(e)})),this.conditionUpdateObserver.addLocalHook("update",(function(e){return t.updateComponents(e)}))),this.components.forEach((function(t){return t.show()})),this.addHook("beforeDropdownMenuSetItems",(function(e){return t.onBeforeDropdownMenuSetItems(e)})),this.addHook("afterDropdownMenuDefaultOptions",(function(e){return t.onAfterDropdownMenuDefaultOptions(e)})),this.addHook("afterDropdownMenuShow",(function(){return t.onAfterDropdownMenuShow()})),this.addHook("afterDropdownMenuHide",(function(){return t.onAfterDropdownMenuHide()})),this.addHook("afterChange",(function(e){return t.onAfterChange(e)})),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),D2(G2(n.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var t,e=this;this.enabled&&(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((function(t,n){t.destroy(),e.components.set(n,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));D2(G2(n.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:sZ,o=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(o,{command:{key:e},args:n},r)}},{key:"removeConditions",value:function(t){var e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}},{key:"clearConditions",value:function(t){if(void 0===t)this.conditionCollection.clean();else{var e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}},{key:"filter",value:function(){var t=this,e=this._createDataFilter(),n=!this.conditionCollection.isEmpty(),r=[],o=this.conditionCollection.exportAllConditions(),i=this.hot.runHooks("beforeFilter",o);if(!1!==i)if(n){var a=[];this.hot.batchExecution((function(){t.filtersRowsMap.clear(),r=W(e.filter(),(function(t){return t.meta.visualRow}));var n=n0(r);Io(t.hot.countSourceRows()-1,(function(t){n(t)||a.push(t)})),U(a,(function(e){t.filtersRowsMap.setValueAtIndex(e,!0)}))}),!0),r.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var t,e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}},{key:"clearColumnSelection",value:function(){var t=this.getSelectedColumn();null!==t&&this.hot.selectCell(0,t.visualIndex)}},{key:"getDataMapAtColumn",value:function(t){var e=this,n=this.hot.toVisualColumn(t),r=[];return U(this.hot.getSourceDataAtCol(n),(function(t,o){var i,a=e.hot.getCellMeta(o,n),l=a.row,s=a.col,u=a.visualCol,c=a.visualRow,f=a.type,h=a.instance,d=a.dateFormat,p=a.locale,y=null!==(i=e.hot.getDataAtCell(e.hot.toVisualRow(o),n))&&void 0!==i?i:t;r.push({meta:{row:l,col:s,visualCol:u,visualRow:c,type:f,instance:h,dateFormat:d,locale:p},value:r0(y)})})),r}},{key:"onAfterChange",value:function(t){var e=this;t&&U(t,(function(t){var n=E2(t,2),r=n[1],o=e.hot.propToCol(r);e.conditionCollection.hasConditions(o)&&e.updateValueComponentCondition(o)}))}},{key:"updateValueComponentCondition",value:function(t){var e=this.hot.getDataAtCol(t),n=o0(e);this.conditionUpdateObserver.updateStatesAtColumn(t,n)}},{key:"restoreComponents",value:function(t){var e,n=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach((function(t){t.isHidden()||t.restoreState(n)})),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var t=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",(function(){t.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})}))}},{key:"onAfterDropdownMenuDefaultOptions",value:function(t){t.items.push({name:tW}),this.components.forEach((function(e){t.items.push(e.getMenuItemDescriptor())}))}},{key:"getOperationBasedOnArguments",value:function(t,e,n,r){var o=t;return o===fZ&&e.command.key!==V$&&n.command.key!==V$&&r.command.key!==V$?o=pZ:r.command.key!==V$&&(e.command.key!==V$&&n.command.key!==V$||(o=sZ)),o}},{key:"onActionBarSubmit",value:function(t){var e;if("accept"===t){var n,r=this.getSelectedColumn();if(null===r)return void(null===(n=this.dropdownMenuPlugin)||void 0===n||n.close());var o=r.physicalIndex,i=this.components.get("filter_by_condition").getState(),a=this.components.get("filter_by_condition2").getState(),l=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),i,a,l);this.conditionUpdateObserver.groupChanges();var u=this.conditionCollection.getColumnStackPosition(o);-1===u&&(u=void 0),this.conditionCollection.removeConditions(o),i.command.key!==V$&&(this.conditionCollection.addCondition(o,i,s,u),a.command.key!==V$&&this.conditionCollection.addCondition(o,a,s,u)),l.command.key!==V$&&this.conditionCollection.addCondition(o,l,s,u),this.conditionUpdateObserver.flush(),this.components.forEach((function(t){return t.saveState(o)})),this.filtersRowsMap.clear(),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}},{key:"onComponentChange",value:function(t,e){this.updateDependentComponentsVisibility(),t.constructor!==rZ||e.inputsCount||this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var t=this.components.get("filter_by_condition"),e=t.getState(),n=e.command,r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents.apply(this,r):this.hideComponents.apply(this,r)}},{key:"onAfterGetColHeader",value:function(t,e){var n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?Ge(e,"htFiltersActive"):Ye(e,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new p2(e,(function(e){return t.getDataMapAtColumn(e)}))}},{key:"updateComponents",value:function(t){var e;if(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled){var n=t.editedConditionStack,r=n.conditions,o=n.column,i=r.filter((function(t){return t.name===r1})),a=r.filter((function(t){return t.name!==r1}));if(i.length>=2||a.length>=3)Un($t(C2||(C2=R2(["The filter conditions have been applied properly, but couldn’t be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."],["The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20\n        The overall amount of conditions exceed the capability of the dropdown menu.\\x20\n        For more details see the documentation."]))));else{var l=this.conditionCollection.getOperation(o);this.components.get("filter_by_condition").updateState(a[0],o),this.components.get("filter_by_condition2").updateState(a[1],o),this.components.get("filter_operators").updateState(l,o),this.components.get("filter_by_value").updateState(t)}}}},{key:"getIndexesOfComponents",value:function(){var t=[];if(!this.dropdownMenuPlugin)return t;for(var e=this.dropdownMenuPlugin.menu,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return U(r,(function(n){U(e.menuItems,(function(e,r){e.key===n.getMenuItemDescriptor().key&&t.push(r)}))})),t}},{key:"changeComponentsVisibility",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.dropdownMenuPlugin){for(var e=this.dropdownMenuPlugin.menu,n=e.hotMenu,r=n.getPlugin("hiddenRows"),o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var l=this.getIndexesOfComponents.apply(this,i);t?r.showRows(l):r.hideRows(l),n.render()}}},{key:"hideComponents",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!1].concat(e))}},{key:"showComponents",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!0].concat(e))}},{key:"destroy",value:function(){var t=this;this.enabled&&(this.components.forEach((function(e,n){null!==e&&(e.destroy(),t.components.set(n,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),D2(G2(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Y2}},{key:"PLUGIN_PRIORITY",get:function(){return K2}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),n}(jH);function $2(t){return $2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$2(t)}function q2(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Q2(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?q2(Object(n),!0).forEach((function(e){J2(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):q2(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function J2(t,e,n){return e=Z2(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z2(t){var e=t3(t,"string");return"symbol"===$2(e)?e:String(e)}function t3(t,e){if("object"!==$2(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==$2(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var e3,n3="internal-use-in-handsontable",r3={licenseKey:n3,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function o3(t){var e,n;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:null===(e=t[Z8])||void 0===e||null===(n=e.language)||void 0===n?void 0:n.langCode}}function i3(t){return Object.keys(t).reduce((function(e,n){return"hyperformula"!==n&&(e[n]=t[n]),e}),{})}function a3(t){var e,n=t[Z8],r=i3(null!==n&&void 0!==n&&null!==(e=n.engine)&&void 0!==e&&e.hyperformula?n.engine:{}),o=o3(t);return Q2(Q2(Q2({},r3),r),o)}function l3(t){var e,n=t[Z8],r=i3(null!==n&&void 0!==n&&null!==(e=n.engine)&&void 0!==e&&e.hyperformula?n.engine:{}),o=o3(t);return Q2(Q2({},r),o)}function s3(t,e){return Object.keys(e).some((function(n){return void 0!==e[n]&&e[n]!==t[n]}))}function u3(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function c3(t){return c3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c3(t)}function f3(){var t="engine_relationship",e=Rr(Z8);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function h3(){var t="shared_engine_usage",e=Rr(Z8);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function d3(t){var e,n=t.getSettings(),r=n[Z8],o=null===r||void 0===r?void 0:r.engine;if(!0===r)return null;if(te(o))return null;if("function"===typeof o.hyperformula||"function"===typeof o)return p3(null!==(e=o.hyperformula)&&void 0!==e?e:o,n,t);if("object"===c3(o)&&te(o.hyperformula)){var i=f3(),a=h3().get(o);return i.has(o)||i.set(o,[]),i.get(o).push(t),a&&a.push(t.guid),o.getConfig().licenseKey||o.updateConfig({licenseKey:n3}),o.getConfig().leapYear1900===r3.leapYear1900&&!1!==ft(o.getConfig().nullDate,r3.nullDate)||Un($t(e3||(e3=u3(["If you use HyperFormula with Handsontable, keep the default `leapYear1900` and `nullDate` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."],["If you use HyperFormula with Handsontable, keep the default \\`leapYear1900\\` and \\`nullDate\\` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."])))),o}return null}function p3(t,e,n){var r=e[Z8],o=a3(e),i=f3(),a=h3();m3(t,r.functions),g3(t,r.language);var l=t.buildEmpty(o);return i.set(l,[n]),a.set(l,[n.guid]),b3(l,r.namedExpressions),l.on("sheetAdded",(function(){l.rebuildAndRecalculate()})),l.on("sheetRemoved",(function(){l.rebuildAndRecalculate()})),l}function y3(t){var e,n=f3(),r=0===n.size?[]:Array.from(null!==(e=n.get(t))&&void 0!==e?e:[]);return new Map(r.map((function(t){return[t.getPlugin("formulas").sheetId,t]})))}function v3(t,e){if(t){var n=f3(),r=n.get(t),o=h3(),i=o.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),0===r.length&&n.delete(t)),i&&i.includes(e.guid)&&(i.splice(i.indexOf(e.guid),1),0===i.length&&(o.delete(t),t.destroy()))}}function m3(t,e){e&&e.forEach((function(e){var n=e.name,r=e.plugin,o=e.translations;try{t.registerFunction(n,r,o)}catch(i){Un(i.message)}}))}function g3(t,e){if(e){var n=e.langCode;try{t.registerLanguage(n,e)}catch(r){Un(r.message)}}}function b3(t,e){e&&(t.suspendEvaluation(),e.forEach((function(e){var n=e.name,r=e.expression,o=e.scope,i=e.options;try{t.addNamedExpression(n,r,o,i)}catch(a){Un(a.message)}})),t.resumeEvaluation())}function w3(t,e){return!te(e)&&t.doesSheetExist(e)||(e=t.addSheet(e)),e}var S3="DD/MM/YYYY";function C3(t){return"string"===typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function O3(t){return C3(t)?t.substr(1):t}function k3(t){return"string"===typeof t&&t.startsWith("=")}function R3(t,e){return"string"===typeof t&&"date"===e}function E3(t,e){return Xt(t,e,!0).isValid()}function P3(t,e){return Xt(t,e,!0).format(S3)}function T3(t,e){return Xt(t,S3,!0).format(e)}function j3(t,e){var n=-1,r=new Date(Date.UTC(0,0,t+n));return Xt(r).format(e)}function A3(t){return A3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A3(t)}function M3(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I3(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_3(r.key),r)}}function x3(t,e,n){return e&&I3(t.prototype,e),n&&I3(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _3(t){var e=H3(t,"string");return"symbol"===A3(e)?e:String(e)}function H3(t,e){if("object"!==A3(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==A3(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function N3(t,e,n){D3(t,e),e.set(t,n)}function D3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function L3(t,e){var n=F3(t,e,"get");return B3(t,n)}function B3(t,e){return e.get?e.get.call(t):e.value}function V3(t,e,n){var r=F3(t,e,"set");return W3(t,r,n),n}function F3(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function W3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var U3=new WeakMap,z3=new WeakMap,G3=new WeakMap,Y3=new WeakMap,K3=new WeakMap,X3=new WeakMap,$3=new WeakMap,q3=function(){function t(e,n,r){M3(this,t),N3(this,U3,{writable:!0,value:void 0}),N3(this,z3,{writable:!0,value:void 0}),N3(this,G3,{writable:!0,value:void 0}),N3(this,Y3,{writable:!0,value:[]}),N3(this,K3,{writable:!0,value:[]}),N3(this,X3,{writable:!0,value:void 0}),N3(this,$3,{writable:!0,value:[]}),V3(this,U3,e),V3(this,z3,n),V3(this,G3,r)}return x3(t,[{key:"setRemovedHfIndexes",value:function(t){var e=this;return V3(this,$3,t.map((function(t){var n=L3(e,z3).getVisualFromPhysicalIndex(t);return e.getHfIndexFromVisualIndex(n)}))),L3(this,$3)}},{key:"getRemovedHfIndexes",value:function(){return L3(this,$3)}},{key:"getHfIndexFromVisualIndex",value:function(t){var e=L3(this,z3).getIndexesSequence(),n=L3(this,z3).getNotTrimmedIndexes();return e.indexOf(n[t])}},{key:"syncMoves",value:function(t){var e=this,n=1,r="move".concat(be(L3(this,U3)),"s");L3(this,G3).getEngine().batch((function(){t.forEach((function(t){var o=t.from!==t.to,i=t.from+1!==t.to;o&&i&&L3(e,G3).getEngine()[r](L3(e,G3).getSheetId(),t.from,n,t.to)}))}))}},{key:"storeMovesInformation",value:function(t,e,n){var r=this;!1!==n&&(V3(this,K3,t.map((function(t){return r.getHfIndexFromVisualIndex(t)}))),V3(this,X3,this.getHfIndexFromVisualIndex(e)))}},{key:"getMoveLine",value:function(t,e){var n,r=L3(this,z3).getNumberOfIndexes(),o=Array.from(Array(r).keys()).filter((function(e){return!1===t.includes(e)}));return 0===e?null!==(n=o[e])&&void 0!==n?n:0:o[e-1]+1}},{key:"getInitiallyCalculatedMoves",value:function(t,e){var n=this.getMoveLine(t,e),r=[];return t.forEach((function(t){var e={from:t,to:n};r.forEach((function(t){var n=t.from>t.to,r=t.to<=e.from,o=t.from>e.from;o&&r&&n&&(e.from+=1)})),e.from>=n&&(n+=1),r.push(e)})),r}},{key:"adjustedCalculatedMoves",value:function(t){return t.forEach((function(e,n){var r=t.slice(n+1);r.forEach((function(t){var n=t.from<t.to;t.from>e.from&&n&&(t.from-=1)}))})),t}},{key:"calculateAndSyncMoves",value:function(t,e){var n=this;if(!L3(this,G3).isPerformingUndoRedo()&&!1!==t&&!1!==e){var r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(L3(this,K3),L3(this,X3)));null===L3(this,G3).getSheetId()?L3(this,G3).getPostponeAction((function(){return n.syncMoves(r)})):this.syncMoves(r)}}},{key:"getIndexesChangeSyncMethod",value:function(){var t=this,e="set".concat(be(L3(this,U3)),"Order");return function(n){if(!L3(t,G3).isPerformingUndoRedo()){var r=L3(t,z3).getIndexesSequence();if("update"===n){var o,i=L3(t,Y3).map((function(t){return r.indexOf(t)})),a=L3(t,G3).getEngine().getSheetDimensions(L3(t,G3).getSheetId());o="row"===L3(t,U3)?a.height:a.width;for(var l=i.length,s=l;s<o;s+=1)i.push(s);L3(t,G3).getEngine()[e](L3(t,G3).getSheetId(),i)}V3(t,Y3,r)}}}},{key:"init",value:function(){V3(this,Y3,L3(this,z3).getIndexesSequence())}}]),t}(),Q3=q3;function J3(t){return J3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J3(t)}function Z3(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function t8(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,n8(r.key),r)}}function e8(t,e,n){return e&&t8(t.prototype,e),n&&t8(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function n8(t){var e=r8(t,"string");return"symbol"===J3(e)?e:String(e)}function r8(t,e){if("object"!==J3(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==J3(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function o8(t,e,n){i8(t,e),e.set(t,n)}function i8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a8(t,e){var n=u8(t,e,"get");return l8(t,n)}function l8(t,e){return e.get?e.get.call(t):e.value}function s8(t,e,n){var r=u8(t,e,"set");return c8(t,r,n),n}function u8(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function c8(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var f8=new WeakMap,h8=new WeakMap,d8=new WeakMap,p8=new WeakMap,y8=new WeakMap,v8=new WeakMap,m8=new WeakMap,g8=function(){function t(e,n,r){Z3(this,t),o8(this,f8,{writable:!0,value:void 0}),o8(this,h8,{writable:!0,value:void 0}),o8(this,d8,{writable:!0,value:void 0}),o8(this,p8,{writable:!0,value:!1}),o8(this,y8,{writable:!0,value:!1}),o8(this,v8,{writable:!0,value:null}),o8(this,m8,{writable:!0,value:null}),s8(this,f8,new Q3("row",e,this)),s8(this,h8,new Q3("column",n,this)),s8(this,d8,r)}return e8(t,[{key:"getForAxis",value:function(t){return a8(this,"row"===t?f8:h8)}},{key:"setPerformUndo",value:function(t){s8(this,p8,t)}},{key:"setPerformRedo",value:function(t){s8(this,y8,t)}},{key:"isPerformingUndoRedo",value:function(){return a8(this,p8)||a8(this,y8)}},{key:"getSheetId",value:function(){return a8(this,m8)}},{key:"getEngine",value:function(){return a8(this,v8)}},{key:"getPostponeAction",value:function(){return a8(this,d8)}},{key:"setupSyncEndpoint",value:function(t,e){s8(this,v8,t),s8(this,m8,e),a8(this,f8).init(),a8(this,h8).init()}}]),t}(),b8=g8;function w8(t){return O8(t)||C8(t)||P8(t)||S8()}function S8(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function C8(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function O8(t){if(Array.isArray(t))return T8(t)}function k8(t){return k8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k8(t)}function R8(t,e){return A8(t)||j8(t,e)||P8(t,e)||E8()}function E8(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function P8(t,e){if(t){if("string"===typeof t)return T8(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T8(t,e):void 0}}function T8(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function j8(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function A8(t){if(Array.isArray(t))return t}function M8(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I8(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,z8(r.key),r)}}function x8(t,e,n){return e&&I8(t.prototype,e),n&&I8(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _8(){return _8="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=H8(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},_8.apply(this,arguments)}function H8(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=W8(t),null===t)break;return t}function N8(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&D8(t,e)}function D8(t,e){return D8=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},D8(t,e)}function L8(t){var e=F8();return function(){var n,r=W8(t);if(e){var o=W8(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return B8(this,n)}}function B8(t,e){if(e&&("object"===k8(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return V8(t)}function V8(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function F8(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function W8(t){return W8=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},W8(t)}function U8(t,e,n){return e=z8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z8(t){var e=G8(t,"string");return"symbol"===k8(e)?e:String(e)}function G8(t,e){if("object"!==k8(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==k8(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Y8(t,e,n){K8(t,e),e.set(t,n)}function K8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function X8(t,e,n){var r=Q8(t,e,"set");return $8(t,r,n),n}function $8(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function q8(t,e){var n=Q8(t,e,"get");return J8(t,n)}function Q8(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function J8(t,e){return e.get?e.get.call(t):e.value}var Z8="formulas",t6=["maxRows","maxColumns","language"],e6=260;mr.getSingleton().register("afterNamedExpressionAdded"),mr.getSingleton().register("afterNamedExpressionRemoved"),mr.getSingleton().register("afterSheetAdded"),mr.getSingleton().register("afterSheetRemoved"),mr.getSingleton().register("afterSheetRenamed"),mr.getSingleton().register("afterFormulasValuesUpdate");var n6=function(t){return"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t},r6=new WeakMap,o6=new WeakMap,i6=new WeakMap,a6=function(t){N8(n,t);var e=L8(n);function n(){var t;M8(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),Y8(V8(t),r6,{writable:!0,value:!1}),Y8(V8(t),o6,{writable:!0,value:!1}),Y8(V8(t),i6,{writable:!0,value:[["valuesUpdated",function(){var e;return(e=t).onEngineValuesUpdated.apply(e,arguments)}],["namedExpressionAdded",function(){var e;return(e=t).onEngineNamedExpressionsAdded.apply(e,arguments)}],["namedExpressionRemoved",function(){var e;return(e=t).onEngineNamedExpressionsRemoved.apply(e,arguments)}],["sheetAdded",function(){var e;return(e=t).onEngineSheetAdded.apply(e,arguments)}],["sheetRenamed",function(){var e;return(e=t).onEngineSheetRenamed.apply(e,arguments)}],["sheetRemoved",function(){var e;return(e=t).onEngineSheetRemoved.apply(e,arguments)}]]}),U8(V8(t),"staticRegister",Rr("formulas")),U8(V8(t),"engine",null),U8(V8(t),"sheetName",null),U8(V8(t),"indexSyncer",null),U8(V8(t),"rowAxisSyncer",null),U8(V8(t),"columnAxisSyncer",null),t}return x8(n,[{key:"sheetId",get:function(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Z8]}},{key:"enablePlugin",value:function(){var t,e=this;if(!this.enabled)if(this.engine=null!==(t=d3(this.hot))&&void 0!==t?t:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){var r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==r&&(this.sheetName=r)}this.addHook("beforeLoadData",(function(){return e.onBeforeLoadData.apply(e,arguments)})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("beforeUpdateData",(function(){return e.onBeforeLoadData.apply(e,arguments)})),this.addHook("afterUpdateData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("modifyData",(function(){return e.onModifyData.apply(e,arguments)})),this.addHook("modifySourceData",(function(){return e.onModifySourceData.apply(e,arguments)})),this.addHook("beforeValidate",(function(){return e.onBeforeValidate.apply(e,arguments)})),this.addHook("afterSetSourceDataAtCell",(function(){return e.onAfterSetSourceDataAtCell.apply(e,arguments)})),this.addHook("afterSetDataAtCell",(function(){return e.onAfterSetDataAtCell.apply(e,arguments)})),this.addHook("afterSetDataAtRowProp",(function(){return e.onAfterSetDataAtCell.apply(e,arguments)})),this.addHook("beforeCreateRow",(function(){return e.onBeforeCreateRow.apply(e,arguments)})),this.addHook("beforeCreateCol",(function(){return e.onBeforeCreateCol.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("afterCreateCol",(function(){return e.onAfterCreateCol.apply(e,arguments)})),this.addHook("beforeRemoveRow",(function(){return e.onBeforeRemoveRow.apply(e,arguments)})),this.addHook("beforeRemoveCol",(function(){return e.onBeforeRemoveCol.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("afterRemoveCol",(function(){return e.onAfterRemoveCol.apply(e,arguments)})),this.indexSyncer=new b8(this.hot.rowIndexMapper,this.hot.columnIndexMapper,(function(t){e.hot.addHookOnce("init",(function(){t()}))})),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(function(t,n,r,o){e.rowAxisSyncer.storeMovesInformation(t,n,o)})),this.hot.addHook("beforeColumnMove",(function(t,n,r,o){e.columnAxisSyncer.storeMovesInformation(t,n,o)})),this.hot.addHook("afterRowMove",(function(t,n,r,o,i){e.rowAxisSyncer.calculateAndSyncMoves(o,i)})),this.hot.addHook("afterColumnMove",(function(t,n,r,o,i){e.columnAxisSyncer.calculateAndSyncMoves(o,i)})),this.hot.addHook("beforeColumnFreeze",(function(t,n){e.columnAxisSyncer.storeMovesInformation([t],e.hot.getSettings().fixedColumnsStart,n)})),this.hot.addHook("afterColumnFreeze",(function(t,n){e.columnAxisSyncer.calculateAndSyncMoves(n,n)})),this.hot.addHook("beforeColumnUnfreeze",(function(t,n){e.columnAxisSyncer.storeMovesInformation([t],e.hot.getSettings().fixedColumnsStart-1,n)})),this.hot.addHook("afterColumnUnfreeze",(function(t,n){e.columnAxisSyncer.calculateAndSyncMoves(n,n)})),this.addHook("afterCellMetaReset",(function(){return e.onAfterCellMetaReset.apply(e,arguments)})),this.addHook("beforeUndo",(function(){e.indexSyncer.setPerformUndo(!0),e.engine.undo()})),this.addHook("beforeRedo",(function(){e.indexSyncer.setPerformRedo(!0),e.engine.redo()})),this.addHook("afterUndo",(function(){e.indexSyncer.setPerformUndo(!1)})),this.addHook("afterUndo",(function(){e.indexSyncer.setPerformRedo(!1)})),this.addHook("afterDetachChild",(function(){return e.onAfterDetachChild.apply(e,arguments)})),this.addHook("beforeAutofill",(function(){return e.onBeforeAutofill.apply(e,arguments)})),q8(this,i6).forEach((function(t){var n=R8(t,2),r=n[0],o=n[1];return e.engine.on(r,o)})),_8(W8(n.prototype),"enablePlugin",this).call(this)}else Un("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}},{key:"disablePlugin",value:function(){var t=this;q8(this,i6).forEach((function(e){var n=R8(e,2),r=n[0],o=n[1];return t.engine.off(r,o)})),v3(this.engine,this.hot),this.engine=null,_8(W8(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(t){var e=l3(this.hot.getSettings());s3(this.engine.getConfig(),e)&&this.engine.updateConfig(e);var r=this.hot.getSettings()[Z8];if(Zt(r)&&Zt(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!t.data&&null===this.sheetName){var o=this.hot.getSettings()[Z8].sheetName;o&&this.engine.doesSheetExist(o)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!==o&&void 0!==o?o:void 0,this.hot.getSourceDataArray())}_8(W8(n.prototype),"updatePlugin",this).call(this,t)}},{key:"destroy",value:function(){var t=this;q8(this,i6).forEach((function(e){var n,r=R8(e,2),o=r[0],i=r[1];return null===(n=t.engine)||void 0===n?void 0:n.off(o,i)})),X8(this,i6,null),v3(this.engine,this.hot),this.engine=null,_8(W8(n.prototype),"destroy",this).call(this)}},{key:"addSheet",value:function(t,e){if(Zt(e)&&!Lv(e))return Un("The provided data should be an array of arrays."),!1;if(void 0!==t&&null!==t&&this.engine.doesSheetExist(t))return Un("Sheet with the provided name already exists."),!1;try{var n=this.engine.addSheet(null!==t&&void 0!==t?t:void 0);return e&&this.engine.setSheetContent(this.engine.getSheetId(n),e),n}catch(r){return Un(r.message),!1}}},{key:"switchSheet",value:function(t){if(this.engine.doesSheetExist(t)){this.sheetName=t;var e=this.engine.getSheetSerialized(this.sheetId);e.length>0&&this.hot.loadData(e,"".concat(be(Z8),".switchSheet"))}else zn("The sheet named `".concat(t,"` does not exist, switch aborted."))}},{key:"getCellType",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(e);return null!==r&&null!==o?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)}):"EMPTY"}},{key:"isFormulaCellType",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)})}},{key:"renderDependentSheets",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new Set;t.forEach((function(t){var e,n=null===t||void 0===t||null===(e=t.address)||void 0===e?void 0:e.sheet;void 0!==n&&(r.has(n)||r.add(n))})),y3(this.engine).forEach((function(t,o){var i;(n||o!==e.sheetId)&&r.has(o)&&(t.render(),null===(i=t.view)||void 0===i||i.adjustElementsSize())}))}},{key:"validateDependentCells",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=function(t){var e,n=null!==(e=null===t||void 0===t?void 0:t.address)&&void 0!==e?e:{},r=n.row,o=n.col,i=n.sheet;return Zt(i)?"".concat(i,":").concat(r,"x").concat(o):""},o=new Set(n.map((function(t){return r(t)})));t.forEach((function(t){var n,i,a=null!==(n=t.address)&&void 0!==n?n:{},l=a.row,s=a.col;if(!(!1===Zt(l)||!1===Zt(s)||l>=e.hot.countRows()||s>=e.hot.countCols())){var u=null===t||void 0===t||null===(i=t.address)||void 0===i?void 0:i.sheet,c=r(t);if(void 0!==u&&!o.has(c)){var f=y3(e.engine).get(u);if(!f)return;f.validateCell(f.getDataAtCell(l,s),f.getCellMeta(l,s),(function(){}))}}}))}},{key:"syncChangeWithEngine",value:function(t,e,n){var r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};if(this.engine.isItPossibleToSetCellContents(r)){var o=this.hot.getCellMeta(t,e);return R3(n,o.type)&&(E3(n,o.dateFormat)?n=P3(n,o.dateFormat):!1===k3(n)&&(n="'".concat(n))),this.engine.setCellContents(r,n)}Un("Not possible to set cell data at ".concat(JSON.stringify(r)))}},{key:"onBeforeValidate",value:function(t,e,n){var r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){var o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},i=this.hot.getCellMeta(e,r),a=this.engine.getCellValue(o);return"date"===i.type&&Ao(a)&&(a=j3(a,i.dateFormat)),"object"===k8(a)&&null!==a?a.value:a}return t}},{key:"onBeforeAutofill",value:function(t,e,n){var r=e.getTopStartCorner(),o=r.row,i=r.col,a=e.getBottomEndCorner(),l=a.row,s=a.col,u=n.getTopStartCorner(),c=u.row,f=u.col,h=n.getBottomEndCorner(),d=h.row,p=h.col,y={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},v={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(f),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(d),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(p),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(v))return!1;for(var m=this.engine.getFillRangeData(y,v),g=y.start,b=g.row,w=g.col,S=y.end,C=S.row,O=S.col,k=C-b+1,R=O-w+1,E=0;E<m.length;E+=1)for(var P=0;P<m[E].length;P+=1){var T=m[E][P],j=E%k,A=P%R,M=this.hot.getCellMeta(j,A);R3(T,M.type)&&(T.startsWith("'")?m[E][P]=T.slice(1):!1===this.isFormulaCellType(j,A,this.sheetId)&&(m[E][P]=T3(T,M.dateFormat)))}return m}},{key:"onBeforeLoadData",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";n.includes(be(Z8))||X8(this,o6,te(this.hot.getSettings().data))}},{key:"onAfterCellMetaReset",value:function(){var t=this,e=this.hot.getSourceDataArray(),n=!1;e.forEach((function(r,o){r.forEach((function(r,i){var a=t.hot.getCellMeta(o,i),l=a.dateFormat;R3(r,a.type)&&(n=!0,E3(r,l)?e[o][i]=P3(r,l):!1===t.isFormulaCellType(o,i)&&(e[o][i]="'".concat(r)))}))})),!0===n&&(X8(this,r6,!0),this.engine.setSheetContent(this.sheetId,e),X8(this,r6,!1))}},{key:"onAfterLoadData",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!n.includes(be(Z8)))if(this.sheetName=w3(this.engine,this.hot.getSettings()[Z8].sheetName),q8(this,o6))this.switchSheet(this.sheetName);else{var r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){X8(this,r6,!0);var o=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),X8(this,r6,!1)}}}},{key:"onModifyData",value:function(t,e,n,r){if("get"===r&&!q8(this,r6)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var o=this.hot.toVisualRow(t);if(null!==o&&null!==e){var i=this.isFormulaCellType(o,e);if(!i){var a=this.getCellType(o,e);if("ARRAY"!==a)return void(C3(n.value)&&(n.value=O3(n.value)))}var l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId},s=this.engine.getCellValue(l),u=this.hot.getCellMeta(o,e);"date"===u.type&&Ao(s)&&(s=j3(s,u.dateFormat));var c="object"===k8(s)&&null!==s?s.value:s;n.value=c}}}},{key:"onModifySourceData",value:function(t,e,n,r){if("get"===r&&!q8(this,r6)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var o=this.hot.toVisualRow(t),i=this.hot.propToCol(e);if(null!==o&&null!==i){var a=this.isFormulaCellType(o,i);if(!a){var l=this.getCellType(o,i);if("ARRAY"!==l)return}var s=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0!==s.width||0!==s.height){var u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId};n.value=this.engine.getCellSerialized(u)}}}}},{key:"onAfterSetDataAtCell",value:function(t,e){var n=this;if(!n6(e)){var r=[],o=[],i=this.engine.batch((function(){t.forEach((function(t){var e=R8(t,4),i=e[0],a=e[1],l=e[3],s=n.hot.propToCol(a),u=n.hot.toPhysicalRow(i),c=n.hot.toPhysicalColumn(s),f={row:n.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:n.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:n.sheetId};null!==u&&null!==c?n.syncChangeWithEngine(i,s,l):r.push([i,s,l]),o.push({address:f})}))}));r.length&&this.hot.addHookOnce("afterChange",(function(){var t=n.engine.batch((function(){r.forEach((function(t){var e=R8(t,3),r=e[0],o=e[1],i=e[2];n.syncChangeWithEngine(r,o,i)}))}));n.renderDependentSheets(t,!0)})),this.renderDependentSheets(i),this.validateDependentCells(i,o)}}},{key:"onAfterSetSourceDataAtCell",value:function(t,e){var n=this;if(!n6(e)){var r=[],o=[];t.forEach((function(t){var e=R8(t,4),i=e[0],a=e[1],l=e[3],s=n.hot.propToCol(a);if(Ao(s)){var u={row:n.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:n.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:n.sheetId};n.engine.isItPossibleToSetCellContents(u)?(o.push({address:u}),r.push.apply(r,w8(n.engine.setCellContents(u,l)))):Un("Not possible to set source cell data at ".concat(JSON.stringify(u)))}})),this.renderDependentSheets(r),this.validateDependentCells(r,o)}}},{key:"onBeforeCreateRow",value:function(t,e){var n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}},{key:"onBeforeCreateCol",value:function(t,e){var n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}},{key:"onBeforeRemoveRow",value:function(t,e,n){var r=this,o=this.rowAxisSyncer.setRemovedHfIndexes(n),i=o.every((function(t){return r.engine.isItPossibleToRemoveRows(r.sheetId,[t,1])}));return!1!==i&&void 0}},{key:"onBeforeRemoveCol",value:function(t,e,n){var r=this,o=this.columnAxisSyncer.setRemovedHfIndexes(n),i=o.every((function(t){return r.engine.isItPossibleToRemoveColumns(r.sheetId,[t,1])}));return!1!==i&&void 0}},{key:"onAfterCreateRow",value:function(t,e,n){if(!n6(n)){var r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}}},{key:"onAfterCreateCol",value:function(t,e,n){if(!n6(n)){var r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}}},{key:"onAfterRemoveRow",value:function(t,e,n,r){var o=this;if(!n6(r)){var i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),a=this.engine.batch((function(){i.forEach((function(t){o.engine.removeRows(o.sheetId,[t,1])}))}));this.renderDependentSheets(a)}}},{key:"onAfterRemoveCol",value:function(t,e,n,r){var o=this;if(!n6(r)){var i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),a=this.engine.batch((function(){i.forEach((function(t){o.engine.removeColumns(o.sheetId,[t,1])}))}));this.renderDependentSheets(a)}}},{key:"onAfterDetachChild",value:function(t,e,n){var r,o=this;X8(this,r6,!0);var i=this.hot.getSourceDataArray(n,0,n+((null===(r=e.__children)||void 0===r?void 0:r.length)||0),this.hot.countSourceCols());X8(this,r6,!1),i.forEach((function(t,e){t.forEach((function(t,r){o.engine.setCellContents({col:r,row:n+e,sheet:o.sheetId},[[t]])}))}))}},{key:"onEngineValuesUpdated",value:function(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}},{key:"onEngineNamedExpressionsAdded",value:function(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}},{key:"onEngineNamedExpressionsRemoved",value:function(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}},{key:"onEngineSheetAdded",value:function(t){this.hot.runHooks("afterSheetAdded",t)}},{key:"onEngineSheetRenamed",value:function(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}},{key:"onEngineSheetRemoved",value:function(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}}],[{key:"PLUGIN_KEY",get:function(){return Z8}},{key:"PLUGIN_PRIORITY",get:function(){return e6}},{key:"SETTING_KEYS",get:function(){return[Z8].concat(t6)}}]),n}(jH);function l6(t,e){return h6(t)||f6(t,e)||u6(t,e)||s6()}function s6(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u6(t,e){if(t){if("string"===typeof t)return c6(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c6(t,e):void 0}}function c6(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f6(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function h6(t){if(Array.isArray(t))return t}function d6(t){return{key:"hidden_columns_hide",name:function(){var t=this.getSelectedLast(),e=0;if(Array.isArray(t)){var n=l6(t,4),r=n[1],o=n[3];r-o!==0&&(e=1)}return this.getTranslatedPhrase(bS,e)},callback:function(){for(var e=this.getSelectedRangeLast(),n=e.from,r=e.to,o=Math.max(Math.min(n.col,r.col),0),i=Math.max(n.col,r.col),a=[],l=o;l<=i;l+=1)a.push(l);t.hideColumns(a);var s=a[a.length-1],u=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(u)&&u>=0?this.selectColumns(u):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function p6(t){return g6(t)||m6(t)||v6(t)||y6()}function y6(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v6(t,e){if(t){if("string"===typeof t)return b6(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b6(t,e):void 0}}function m6(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function g6(t){if(Array.isArray(t))return b6(t)}function b6(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function w6(t){var e=[];return{key:"hidden_columns_show",name:function(){var t=e.length>1?1:0;return this.getTranslatedPhrase(wS,t)},callback:function(){var n,r;if(0!==e.length){var o=e[0],i=e[e.length-1];o=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,i=null!==(r=this.columnIndexMapper.getNearestNotHiddenIndex(i+1,1))&&void 0!==r?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0);var a=i-o+1===this.countCols();a||this.selectColumns(o,i)}},disabled:!1,hidden:function(){var n=this,r=W(t.getHiddenColumns(),(function(t){return n.toPhysicalColumn(t)}));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;e.length=0;var o=this.getSelectedRangeLast(),i=o.getTopStartCorner().col,a=o.getBottomEndCorner().col,l=this.columnIndexMapper,s=l.getRenderableFromVisualIndex(i),u=l.getRenderableFromVisualIndex(a),c=l.getNotTrimmedIndexes(),f=[];if(i!==a){var h=a-i+1,d=u-s+1;if(h>d){var p=c.slice(i,a+1);f.push.apply(f,p6(p.filter((function(t){return r.includes(t)}))))}}else if(0===s&&s<i)f.push.apply(f,p6(c.slice(0,i)));else if(null===s)f.push.apply(f,p6(c.slice(0,this.countCols())));else{var y=this.countCols()-1,v=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(y,-1));u===v&&y>a&&f.push.apply(f,p6(c.slice(a+1)))}return U(f,(function(t){e.push(n.toVisualColumn(t))})),0===e.length}}}function S6(t){return S6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S6(t)}function C6(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O6(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,R6(r.key),r)}}function k6(t,e,n){return e&&O6(t.prototype,e),n&&O6(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function R6(t){var e=E6(t,"string");return"symbol"===S6(e)?e:String(e)}function E6(t,e){if("object"!==S6(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==S6(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function P6(){return P6="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=T6(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},P6.apply(this,arguments)}function T6(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=H6(t),null===t)break;return t}function j6(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&A6(t,e)}function A6(t,e){return A6=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},A6(t,e)}function M6(t){var e=_6();return function(){var n,r=H6(t);if(e){var o=H6(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return I6(this,n)}}function I6(t,e){if(e&&("object"===S6(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return x6(t)}function x6(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _6(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function H6(t){return H6=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},H6(t)}function N6(t,e,n){D6(t,e),e.set(t,n)}function D6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function L6(t,e){var n=F6(t,e,"get");return B6(t,n)}function B6(t,e){return e.get?e.get.call(t):e.value}function V6(t,e,n){var r=F6(t,e,"set");return W6(t,r,n),n}function F6(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function W6(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}mr.getSingleton().register("beforeHideColumns"),mr.getSingleton().register("afterHideColumns"),mr.getSingleton().register("beforeUnhideColumns"),mr.getSingleton().register("afterUnhideColumns");var U6="hiddenColumns",z6=310,G6=new WeakMap,Y6=new WeakMap,K6=function(t){j6(n,t);var e=M6(n);function n(){var t;C6(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),N6(x6(t),G6,{writable:!0,value:{}}),N6(x6(t),Y6,{writable:!0,value:null}),t}return k6(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[U6]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[U6];ht(e)&&(V6(this,G6,e),te(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),V6(this,Y6,new dg),L6(this,Y6).addLocalHook("init",(function(){return t.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,L6(this,Y6)),this.addHook("afterContextMenuDefaultOptions",(function(){return t.onAfterContextMenuDefaultOptions.apply(t,arguments)})),this.addHook("afterGetCellMeta",(function(e,n,r){return t.onAfterGetCellMeta(e,n,r)})),this.addHook("modifyColWidth",(function(e,n){return t.onModifyColWidth(e,n)})),this.addHook("afterGetColHeader",(function(){return t.onAfterGetColHeader.apply(t,arguments)})),this.addHook("modifyCopyableRange",(function(e){return t.onModifyCopyableRange(e)})),P6(H6(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),P6(H6(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),V6(this,G6,{}),P6(H6(n.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(t){var e=this,n=this.getHiddenColumns(),r=this.isValidConfig(t),o=n,i=L6(this,Y6).getValues().slice(),a=t.length>0;if(r&&a){var l=t.map((function(t){return e.hot.toPhysicalColumn(t)}));U(l,(function(t){i[t]=!1})),o=V(i,(function(t,n,r){return n&&t.push(e.hot.toVisualColumn(r)),t}),[])}var s=this.hot.runHooks("beforeUnhideColumns",n,o,r&&a);!1!==s&&(r&&a&&L6(this,Y6).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,o,r&&a,r&&o.length<n.length))}},{key:"showColumn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showColumns(e)}},{key:"hideColumns",value:function(t){var e=this,n=this.getHiddenColumns(),r=this.isValidConfig(t),o=n;r&&(o=Array.from(new Set(n.concat(t))));var i=this.hot.runHooks("beforeHideColumns",n,o,r);!1!==i&&(r&&this.hot.batchExecution((function(){U(t,(function(t){L6(e,Y6).setValueAtIndex(e.hot.toPhysicalColumn(t),!0)}))}),!0),this.hot.runHooks("afterHideColumns",n,o,r,r&&o.length>n.length))}},{key:"hideColumn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideColumns(e)}},{key:"getHiddenColumns",value:function(){var t=this;return W(L6(this,Y6).getHiddenIndexes(),(function(e){return t.hot.toVisualColumn(e)}))}},{key:"isHidden",value:function(t){return L6(this,Y6).getValueAtIndex(this.hot.toPhysicalColumn(t))||!1}},{key:"isValidConfig",value:function(t){var e=this.hot.countCols();return!!(Array.isArray(t)&&t.length>0)&&t.every((function(t){return Number.isInteger(t)&&t>=0&&t<e}))}},{key:"resetCellsMeta",value:function(){U(this.hot.getCellsMeta(),(function(t){t&&(t.skipColumnOnPaste=!1)}))}},{key:"onModifyColWidth",value:function(t,e){return this.isHidden(e)?0:L6(this,G6).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&"number"===typeof t&&this.hot.hasColHeaders()?t+15:void 0}},{key:"onAfterGetCellMeta",value:function(t,e,n){if(!1===L6(this,G6).copyPasteEnabled&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){var r=n.className.split(" ");if(r.length>0){var o=r.indexOf("afterHiddenColumn");o>-1&&r.splice(o,1),n.className=r.join(" ")}}}},{key:"onModifyCopyableRange",value:function(t){var e=this;if(L6(this,G6).copyPasteEnabled)return t;var n=[],r=function(t,e,r,o){n.push({startRow:t,endRow:e,startCol:r,endCol:o})};return U(t,(function(t){var n=!0,o=0;Io(t.startCol,t.endCol,(function(i){e.isHidden(i)?(n||r(t.startRow,t.endRow,o,i-1),n=!0):(n&&(o=i),i===t.endCol&&r(t.startRow,t.endRow,o,i),n=!1)}))})),n}},{key:"onAfterGetColHeader",value:function(t,e){if(L6(this,G6).indicators&&!(t<0)){var n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),Ge(e,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(t){t.items.push({name:tW},d6(this),w6(this))}},{key:"onMapInit",value:function(){Array.isArray(L6(this,G6).columns)&&this.hideColumns(L6(this,G6).columns)}},{key:"destroy",value:function(){V6(this,G6,null),V6(this,Y6,null),P6(H6(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return U6}},{key:"PLUGIN_PRIORITY",get:function(){return z6}}]),n}(jH);function X6(t,e){return Z6(t)||J6(t,e)||q6(t,e)||$6()}function $6(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function q6(t,e){if(t){if("string"===typeof t)return Q6(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Q6(t,e):void 0}}function Q6(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function J6(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Z6(t){if(Array.isArray(t))return t}function t5(t){return{key:"hidden_rows_hide",name:function(){var t=this.getSelectedLast(),e=0;if(Array.isArray(t)){var n=X6(t,3),r=n[0],o=n[2];r-o!==0&&(e=1)}return this.getTranslatedPhrase(SS,e)},callback:function(){for(var e=this.getSelectedRangeLast(),n=e.from,r=e.to,o=Math.max(Math.min(n.row,r.row),0),i=Math.max(n.row,r.row),a=[],l=o;l<=i;l+=1)a.push(l);t.hideRows(a);var s=a[a.length-1],u=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(u)&&u>=0?this.selectRows(u):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function e5(t){return i5(t)||o5(t)||r5(t)||n5()}function n5(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r5(t,e){if(t){if("string"===typeof t)return a5(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a5(t,e):void 0}}function o5(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function i5(t){if(Array.isArray(t))return a5(t)}function a5(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l5(t){var e=[];return{key:"hidden_rows_show",name:function(){var t=e.length>1?1:0;return this.getTranslatedPhrase(CS,t)},callback:function(){var n,r;if(0!==e.length){var o=e[0],i=e[e.length-1];o=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,i=null!==(r=this.rowIndexMapper.getNearestNotHiddenIndex(i+1,1))&&void 0!==r?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0);var a=i-o+1===this.countRows();a||this.selectRows(o,i)}},disabled:!1,hidden:function(){var n=this,r=W(t.getHiddenRows(),(function(t){return n.toPhysicalRow(t)}));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;e.length=0;var o=this.getSelectedRangeLast(),i=o.getTopStartCorner().row,a=o.getBottomEndCorner().row,l=this.rowIndexMapper,s=l.getRenderableFromVisualIndex(i),u=l.getRenderableFromVisualIndex(a),c=l.getNotTrimmedIndexes(),f=[];if(i!==a){var h=a-i+1,d=u-s+1;if(h>d){var p=c.slice(i,a+1);f.push.apply(f,e5(p.filter((function(t){return r.includes(t)}))))}}else if(0===s&&s<i)f.push.apply(f,e5(c.slice(0,i)));else if(null===s)f.push.apply(f,e5(c.slice(0,this.countRows())));else{var y=this.countRows()-1,v=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(y,-1));u===v&&y>a&&f.push.apply(f,e5(c.slice(a+1)))}return U(f,(function(t){e.push(n.toVisualRow(t))})),0===e.length}}}function s5(t){return s5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s5(t)}function u5(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c5(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,h5(r.key),r)}}function f5(t,e,n){return e&&c5(t.prototype,e),n&&c5(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function h5(t){var e=d5(t,"string");return"symbol"===s5(e)?e:String(e)}function d5(t,e){if("object"!==s5(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==s5(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function p5(){return p5="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=y5(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},p5.apply(this,arguments)}function y5(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=C5(t),null===t)break;return t}function v5(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m5(t,e)}function m5(t,e){return m5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},m5(t,e)}function g5(t){var e=S5();return function(){var n,r=C5(t);if(e){var o=C5(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return b5(this,n)}}function b5(t,e){if(e&&("object"===s5(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return w5(t)}function w5(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S5(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function C5(t){return C5=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},C5(t)}function O5(t,e,n){k5(t,e),e.set(t,n)}function k5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function R5(t,e){var n=T5(t,e,"get");return E5(t,n)}function E5(t,e){return e.get?e.get.call(t):e.value}function P5(t,e,n){var r=T5(t,e,"set");return j5(t,r,n),n}function T5(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function j5(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}mr.getSingleton().register("beforeHideRows"),mr.getSingleton().register("afterHideRows"),mr.getSingleton().register("beforeUnhideRows"),mr.getSingleton().register("afterUnhideRows");var A5="hiddenRows",M5=320,I5=new WeakMap,x5=new WeakMap,_5=function(t){v5(n,t);var e=g5(n);function n(){var t;u5(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),O5(w5(t),I5,{writable:!0,value:{}}),O5(w5(t),x5,{writable:!0,value:null}),t}return f5(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[A5]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[A5];ht(e)&&(P5(this,I5,e),te(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),P5(this,x5,new dg),R5(this,x5).addLocalHook("init",(function(){return t.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,R5(this,x5)),this.addHook("afterContextMenuDefaultOptions",(function(){return t.onAfterContextMenuDefaultOptions.apply(t,arguments)})),this.addHook("afterGetCellMeta",(function(e,n,r){return t.onAfterGetCellMeta(e,n,r)})),this.addHook("modifyRowHeight",(function(e,n){return t.onModifyRowHeight(e,n)})),this.addHook("afterGetRowHeader",(function(){return t.onAfterGetRowHeader.apply(t,arguments)})),this.addHook("modifyCopyableRange",(function(e){return t.onModifyCopyableRange(e)})),p5(C5(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),p5(C5(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),P5(this,I5,{}),p5(C5(n.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(t){var e=this,n=this.getHiddenRows(),r=this.isValidConfig(t),o=n,i=R5(this,x5).getValues().slice(),a=t.length>0;if(r&&a){var l=t.map((function(t){return e.hot.toPhysicalRow(t)}));U(l,(function(t){i[t]=!1})),o=V(i,(function(t,n,r){return n&&t.push(e.hot.toVisualRow(r)),t}),[])}var s=this.hot.runHooks("beforeUnhideRows",n,o,r&&a);!1!==s&&(r&&a&&R5(this,x5).setValues(i),this.hot.runHooks("afterUnhideRows",n,o,r&&a,r&&o.length<n.length))}},{key:"showRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showRows(e)}},{key:"hideRows",value:function(t){var e=this,n=this.getHiddenRows(),r=this.isValidConfig(t),o=n;r&&(o=Array.from(new Set(n.concat(t))));var i=this.hot.runHooks("beforeHideRows",n,o,r);!1!==i&&(r&&this.hot.batchExecution((function(){U(t,(function(t){R5(e,x5).setValueAtIndex(e.hot.toPhysicalRow(t),!0)}))}),!0),this.hot.runHooks("afterHideRows",n,o,r,r&&o.length>n.length))}},{key:"hideRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideRows(e)}},{key:"getHiddenRows",value:function(){var t=this;return W(R5(this,x5).getHiddenIndexes(),(function(e){return t.hot.toVisualRow(e)}))}},{key:"isHidden",value:function(t){return R5(this,x5).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}},{key:"isValidConfig",value:function(t){var e=this.hot.countRows();return!!(Array.isArray(t)&&t.length>0)&&t.every((function(t){return Number.isInteger(t)&&t>=0&&t<e}))}},{key:"resetCellsMeta",value:function(){U(this.hot.getCellsMeta(),(function(t){t&&(t.skipRowOnPaste=!1)}))}},{key:"onModifyRowHeight",value:function(t,e){return this.isHidden(e)?0:t}},{key:"onAfterGetCellMeta",value:function(t,e,n){if(!1===R5(this,I5).copyPasteEnabled&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){var r=n.className.split(" ");if(r.length>0){var o=r.indexOf("afterHiddenRow");o>-1&&r.splice(o,1),n.className=r.join(" ")}}}},{key:"onModifyCopyableRange",value:function(t){var e=this;if(R5(this,I5).copyPasteEnabled)return t;var n=[],r=function(t,e,r,o){n.push({startRow:t,endRow:e,startCol:r,endCol:o})};return U(t,(function(t){var n=!0,o=0;Io(t.startRow,t.endRow,(function(i){e.isHidden(i)?(n||r(o,i-1,t.startCol,t.endCol),n=!0):(n&&(o=i),i===t.endRow&&r(o,i,t.startCol,t.endCol),n=!1)}))})),n}},{key:"onAfterGetRowHeader",value:function(t,e){if(R5(this,I5).indicators&&!(t<0)){var n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),Ge(e,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(t){t.items.push({name:tW},t5(this),l5(this))}},{key:"onMapInit",value:function(){Array.isArray(R5(this,I5).rows)&&this.hideRows(R5(this,I5).rows)}},{key:"destroy",value:function(){P5(this,I5,null),P5(this,x5,null),p5(C5(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return A5}},{key:"PLUGIN_PRIORITY",get:function(){return M5}}]),n}(jH);function H5(t,e){return V5(t)||B5(t,e)||D5(t,e)||N5()}function N5(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function D5(t,e){if(t){if("string"===typeof t)return L5(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L5(t,e):void 0}}function L5(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function B5(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function V5(t){if(Array.isArray(t))return t}function F5(t){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase($w)},callback:function(e,n){var r=H5(n,1),o=r[0].start.col;t.freezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(e=!0),e}}}function W5(t,e){return K5(t)||Y5(t,e)||z5(t,e)||U5()}function U5(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function z5(t,e){if(t){if("string"===typeof t)return G5(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G5(t,e):void 0}}function G5(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Y5(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function K5(t){if(Array.isArray(t))return t}function X5(t){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(qw)},callback:function(e,n){var r=W5(n,1),o=r[0].start.col;t.unfreezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(e=!0),e}}}function $5(t){return $5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$5(t)}function q5(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q5(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Z5(r.key),r)}}function J5(t,e,n){return e&&Q5(t.prototype,e),n&&Q5(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Z5(t){var e=t4(t,"string");return"symbol"===$5(e)?e:String(e)}function t4(t,e){if("object"!==$5(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==$5(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function e4(){return e4="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=n4(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},e4.apply(this,arguments)}function n4(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=u4(t),null===t)break;return t}function r4(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o4(t,e)}function o4(t,e){return o4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o4(t,e)}function i4(t){var e=s4();return function(){var n,r=u4(t);if(e){var o=u4(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return a4(this,n)}}function a4(t,e){if(e&&("object"===$5(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l4(t)}function l4(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s4(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function u4(t){return u4=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u4(t)}mr.getSingleton().register("beforeColumnFreeze"),mr.getSingleton().register("afterColumnFreeze"),mr.getSingleton().register("beforeColumnUnfreeze"),mr.getSingleton().register("afterColumnUnfreeze");var c4="manualColumnFreeze",f4=110,h4=new WeakMap,d4=function(t){r4(n,t);var e=i4(n);function n(t){var r;return q5(this,n),r=e.call(this,t),h4.set(l4(r),{afterFirstUse:!1}),r}return J5(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[c4]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(e){return t.addContextMenuEntry(e)})),this.addHook("beforeColumnMove",(function(e,n){return t.onBeforeColumnMove(e,n)})),e4(u4(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=h4.get(this);t.afterFirstUse=!1,e4(u4(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),e4(u4(n.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(t){var e=h4.get(this),n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&t>n.fixedColumnsStart-1;e.afterFirstUse||(e.afterFirstUse=!0);var o=this.hot.runHooks("beforeColumnFreeze",t,r);!1!==o&&(r&&(this.hot.columnIndexMapper.moveIndexes(t,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",t,r))}},{key:"unfreezeColumn",value:function(t){var e=h4.get(this),n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&t<=n.fixedColumnsStart-1;e.afterFirstUse||(e.afterFirstUse=!0);var o=this.hot.runHooks("beforeColumnUnfreeze",t,r);!1!==o&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(t,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",t,r))}},{key:"addContextMenuEntry",value:function(t){t.items.push({name:"---------"},F5(this),X5(this))}},{key:"onBeforeColumnMove",value:function(t,e){var n=h4.get(this);if(n.afterFirstUse){var r=this.hot.getSettings().fixedColumnsStart;if(e<r)return!1;if(t.some((function(t){return t<r})))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return c4}},{key:"PLUGIN_PRIORITY",get:function(){return f4}}]),n}(jH);function p4(t){return p4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p4(t)}function y4(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v4(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,g4(r.key),r)}}function m4(t,e,n){return e&&v4(t.prototype,e),n&&v4(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function g4(t){var e=b4(t,"string");return"symbol"===p4(e)?e:String(e)}function b4(t,e){if("object"!==p4(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==p4(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var w4=0,S4=1,C4=2,O4="px",k4=function(){function t(e){y4(this,t),this.hot=e,this._element=null,this.state=w4,this.inlineProperty=e.isRtl()?"right":"left"}return m4(t,[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=C4}},{key:"build",value:function(){this.state===w4&&(this._element=this.hot.rootDocument.createElement("div"),this.state=S4)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=w4}},{key:"isAppended",value:function(){return this.state===C4}},{key:"isBuilt",value:function(){return this.state>=S4}},{key:"setPosition",value:function(t,e){Ao(t)&&(this._element.style.top=t+O4),Ao(e)&&(this._element.style[this.inlineProperty]=e+O4)}},{key:"getPosition",value:function(){var t=this._element.style;return{top:t.top?parseInt(t.top,10):0,start:t[this.inlineProperty]?parseInt(t[this.inlineProperty],10):0}}},{key:"setSize",value:function(t,e){Ao(t)&&(this._element.style.width=t+O4),Ao(e)&&(this._element.style.height=e+O4)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,e){Ao(t)&&(this._element.style.marginTop=t+O4),Ao(e)&&(this._element.style["margin".concat(be(this.inlineProperty))]=e+O4)}},{key:"getOffset",value:function(){var t=this._element.style,e="margin".concat(be(this.inlineProperty));return{top:t.marginTop?parseInt(t.marginTop,10):0,start:t[e]?parseInt(t[e],10):0}}}]),t}(),R4=k4;function E4(t){return E4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E4(t)}function P4(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T4(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,A4(r.key),r)}}function j4(t,e,n){return e&&T4(t.prototype,e),n&&T4(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function A4(t){var e=M4(t,"string");return"symbol"===E4(e)?e:String(e)}function M4(t,e){if("object"!==E4(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==E4(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function I4(){return I4="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=x4(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},I4.apply(this,arguments)}function x4(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=V4(t),null===t)break;return t}function _4(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&H4(t,e)}function H4(t,e){return H4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},H4(t,e)}function N4(t){var e=B4();return function(){var n,r=V4(t);if(e){var o=V4(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return D4(this,n)}}function D4(t,e){if(e&&("object"===E4(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return L4(t)}function L4(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function B4(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function V4(t){return V4=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},V4(t)}var F4="ht__manualColumnMove--backlight",W4=function(t){_4(n,t);var e=N4(n);function n(){return P4(this,n),e.apply(this,arguments)}return j4(n,[{key:"build",value:function(){I4(V4(n.prototype),"build",this).call(this),Ge(this._element,F4)}}]),n}(R4),U4=W4;function z4(t){return z4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z4(t)}function G4(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y4(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,X4(r.key),r)}}function K4(t,e,n){return e&&Y4(t.prototype,e),n&&Y4(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function X4(t){var e=$4(t,"string");return"symbol"===z4(e)?e:String(e)}function $4(t,e){if("object"!==z4(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==z4(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function q4(){return q4="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Q4(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},q4.apply(this,arguments)}function Q4(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=o9(t),null===t)break;return t}function J4(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Z4(t,e)}function Z4(t,e){return Z4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Z4(t,e)}function t9(t){var e=r9();return function(){var n,r=o9(t);if(e){var o=o9(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return e9(this,n)}}function e9(t,e){if(e&&("object"===z4(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return n9(t)}function n9(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function r9(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function o9(t){return o9=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},o9(t)}var i9="ht__manualColumnMove--guideline",a9=function(t){J4(n,t);var e=t9(n);function n(){return G4(this,n),e.apply(this,arguments)}return K4(n,[{key:"build",value:function(){q4(o9(n.prototype),"build",this).call(this),Ge(this._element,i9)}}]),n}(R4),l9=a9;function s9(t){return s9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s9(t)}function u9(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c9(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,h9(r.key),r)}}function f9(t,e,n){return e&&c9(t.prototype,e),n&&c9(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function h9(t){var e=d9(t,"string");return"symbol"===s9(e)?e:String(e)}function d9(t,e){if("object"!==s9(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==s9(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function p9(){return p9="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=y9(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},p9.apply(this,arguments)}function y9(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=C9(t),null===t)break;return t}function v9(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m9(t,e)}function m9(t,e){return m9=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},m9(t,e)}function g9(t){var e=S9();return function(){var n,r=C9(t);if(e){var o=C9(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return b9(this,n)}}function b9(t,e){if(e&&("object"===s9(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return w9(t)}function w9(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S9(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function C9(t){return C9=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},C9(t)}mr.getSingleton().register("beforeColumnMove"),mr.getSingleton().register("afterColumnMove");var O9="manualColumnMove",k9=120,R9=new WeakMap,E9="ht__manualColumnMove",P9="show-ui",T9="on-moving--columns",j9="after-selection--columns",A9=function(t){v9(n,t);var e=g9(n);function n(t){var r;return u9(this,n),r=e.call(this,t),R9.set(w9(r),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),r.eventManager=new Gr(w9(r)),r.backlight=new U4(t),r.guideline=new l9(t),r}return f9(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[O9]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return t.onBeforeOnCellMouseOver.apply(t,arguments)})),this.addHook("afterScrollVertically",(function(){return t.onAfterScrollVertically()})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.buildPluginUI(),this.registerEvents(),Ge(this.hot.rootElement,E9),p9(C9(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),p9(C9(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ye(this.hot.rootElement,E9),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),p9(C9(n.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(t,e){return this.moveColumns([t],e)}},{key:"moveColumns",value:function(t,e){var n=R9.get(this),r=n.cachedDropIndex,o=this.isMovePossible(t,e),i=this.hot.runHooks("beforeColumnMove",t,e,r,o);if(n.cachedDropIndex=void 0,!1!==i){o&&this.hot.columnIndexMapper.moveIndexes(t,e);var a=o&&this.isColumnOrderChanged(t,e);return this.hot.runHooks("afterColumnMove",t,e,r,o,a),a}}},{key:"dragColumn",value:function(t,e){return this.dragColumns([t],e)}},{key:"dragColumns",value:function(t,e){var n=this.countFinalIndex(t,e),r=R9.get(this);return r.cachedDropIndex=e,this.moveColumns(t,n)}},{key:"isMovePossible",value:function(t,e){var n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=t.length+e>n,o=e<0,i=t.some((function(t){return t<0})),a=t.some((function(t){return t>=n}));return!(r||o||i||a)}},{key:"isColumnOrderChanged",value:function(t,e){return t.some((function(t,n){return t-n!==e}))}},{key:"countFinalIndex",value:function(t,e){var n=V(t,(function(t,n){return n<e&&(t+=1),t}),0);return e-n}},{key:"getColumnsWidth",value:function(t,e){for(var n=this.hot.columnIndexMapper,r=0,o=t;o<=e;o+=1){var i=n.getRenderableFromVisualIndex(o);o<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==i&&(r+=this.hot.view._wt.wtTable.getStretchedColumnWidth(i)||0)}return r}},{key:"moveBySettingsOrLoad",value:function(){var t=this.hot.getSettings()[O9];if(Array.isArray(t))this.moveColumns(t,0);else if(void 0!==t){var e=this.persistentStateLoad();e.length&&this.moveColumns(e,0)}}},{key:"isFixedColumnsStart",value:function(t){return t<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value?t.value:[]}},{key:"prepareColumnsToMoving",value:function(t,e){var n=[];return Io(t,e,(function(t){n.push(t)})),n}},{key:"refreshPositions",value:function(){var t=R9.get(this),e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(t.hoveredColumn)&&e>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1));var n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,o="number"===typeof r.scrollX?r.scrollX:r.scrollLeft,i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,t.hoveredColumn-1),a=n.hider.offsetWidth,l=n.TBODY.offsetLeft,s=this.backlight.getOffset().start,u=this.backlight.getSize().width,c=0,f=0;if(this.hot.isRtl()){var h=this.hot.rootWindow,d=fn(this.hot.rootElement),p=h.innerWidth-t.rootElementOffset-d;f=h.innerWidth-t.target.eventPageX-p-(void 0===r.scrollX?o:0)}else f=t.target.eventPageX-(t.rootElementOffset-(void 0===r.scrollX?o:0));if(t.hasRowHeaders&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(t.hoveredColumn)&&(i+=o),i+=c,t.hoveredColumn<0)t.fixedColumnsStart>0?t.target.col=0:t.target.col=e>0?e-1:e;else if(t.target.TD.offsetWidth/2+i<=f){var y=t.hoveredColumn>=t.countCols?t.countCols-1:t.hoveredColumn;t.target.col=y+1,i+=t.target.TD.offsetWidth}else t.target.col=t.hoveredColumn;var v=f,m=i;f+u+s>=a?v=a-u-s:f+s<l+c&&(v=l+c+Math.abs(s)),i>=a-1?m=a-1:0===m?m=1:void 0!==r.scrollX&&t.hoveredColumn<t.fixedColumnsStart&&(m-=t.rootElementOffset<=r.scrollX?t.rootElementOffset:0),this.backlight.setPosition(null,v),this.guideline.setPosition(null,m)}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(e,"mousemove",(function(e){return t.onMouseMove(e)})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){var o=this.hot.view._wt.wtTable,i=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),l=R9.get(this),s=ze(t.target,"sortAction");if(!a||!i||l.pressed||0!==t.button||s)return l.pressed=!1,l.columnsToMove.length=0,void Ye(this.hot.rootElement,[T9,P9]);var u=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&c&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider));var f=a.from,h=a.to,d=Math.min(f.col,h.col),p=Math.max(f.col,h.col);if(e.row<0&&e.col>=d&&e.col<=p){r.column=!0,l.pressed=!0,l.target.eventPageX=t.pageX,l.target.eventOffsetX=t.offsetX,l.hoveredColumn=e.col,l.target.TD=n,l.target.col=e.col,l.columnsToMove=this.prepareColumnsToMoving(d,p),l.hasRowHeaders=!!this.hot.getSettings().rowHeaders,l.countCols=this.hot.countCols(),l.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,l.rootElementOffset=tn(this.hot.rootElement).left;var y=l.hasRowHeaders?-1:0,v=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,m=e.col<l.fixedColumnsStart,g=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),b=Math.abs(t.offsetX-(this.hot.isRtl()?t.target.offsetWidth:0)),w=this.getColumnsWidth(d,e.col-1)+b,S=this.getColumnsWidth(y,d-1)+(m?g:0)+w;this.backlight.setPosition(v,S),this.backlight.setSize(this.getColumnsWidth(d,p),o.hider.offsetHeight-v),this.backlight.setOffset(null,-w),Ge(this.hot.rootElement,T9)}else Ye(this.hot.rootElement,j9),l.pressed=!1,l.columnsToMove.length=0}},{key:"onMouseMove",value:function(t){var e=R9.get(this);if(e.pressed){if(t.target===this.backlight.element){var n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout((function(){this.backlight.setPosition(n)}))}e.target.eventPageX=t.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){var o=this.hot.getSelectedRangeLast(),i=R9.get(this);o&&i.pressed&&(i.columnsToMove.indexOf(e.col)>-1?Ye(this.hot.rootElement,P9):Ge(this.hot.rootElement,P9),r.row=!0,r.column=!0,r.cell=!0,i.hoveredColumn=e.col,i.target.TD=n)}},{key:"onMouseUp",value:function(){var t=R9.get(this),e=t.target.col,n=t.columnsToMove.length;if(t.hoveredColumn=void 0,t.pressed=!1,t.backlightWidth=0,Ye(this.hot.rootElement,[T9,P9,j9]),this.hot.selection.isSelectedByColumnHeader()&&Ge(this.hot.rootElement,j9),!(n<1||void 0===e)){var r=t.columnsToMove[0],o=this.hot.toPhysicalColumn(r),i=this.dragColumns(t.columnsToMove,e);if(t.columnsToMove.length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var a=this.hot.toVisualColumn(o),l=a+n-1;this.hot.selectColumns(a,l)}}}},{key:"onAfterScrollVertically",value:function(){var t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;this.backlight.setPosition(r),this.backlight.setSize(null,t.hider.offsetHeight-r)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),p9(C9(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return O9}},{key:"PLUGIN_PRIORITY",get:function(){return k9}}]),n}(jH);function M9(t){return M9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M9(t)}function I9(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x9(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,H9(r.key),r)}}function _9(t,e,n){return e&&x9(t.prototype,e),n&&x9(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function H9(t){var e=N9(t,"string");return"symbol"===M9(e)?e:String(e)}function N9(t,e){if("object"!==M9(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==M9(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function D9(){return D9="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=L9(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},D9.apply(this,arguments)}function L9(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=G9(t),null===t)break;return t}function B9(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&V9(t,e)}function V9(t,e){return V9=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},V9(t,e)}function F9(t){var e=z9();return function(){var n,r=G9(t);if(e){var o=G9(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return W9(this,n)}}function W9(t,e){if(e&&("object"===M9(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return U9(t)}function U9(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function z9(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function G9(t){return G9=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},G9(t)}var Y9="manualColumnResize",K9=130,X9="manualColumnWidths",$9=new WeakMap,q9=function(t){B9(n,t);var e=F9(n);function n(t){var r;I9(this,n),r=e.call(this,t);var o=r.hot.rootDocument;return r.currentTH=null,r.currentCol=null,r.selectedCols=[],r.currentWidth=null,r.newSize=null,r.startY=null,r.startWidth=null,r.startOffset=null,r.handle=o.createElement("DIV"),r.guide=o.createElement("DIV"),r.eventManager=new Gr(U9(r)),r.pressed=null,r.dblclick=0,r.autoresizeTimeout=null,r.columnWidthsMap=void 0,$9.set(U9(r),{config:void 0}),Ge(r.handle,"manualColumnResizer"),Ge(r.guide,"manualColumnResizerGuide"),r}return _9(n,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Y9]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.columnWidthsMap=new Zm,this.columnWidthsMap.addLocalHook("init",(function(){return t.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(function(e,n){return t.onModifyColWidth(e,n)})),this.addHook("beforeStretchingColumnWidth",(function(e,n){return t.onBeforeStretchingColumnWidth(e,n)})),this.addHook("beforeColumnResize",(function(e,n,r){return t.onBeforeColumnResize(e,n,r)})),this.bindEvents(),D9(G9(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),D9(G9(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=$9.get(this);t.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),D9(G9(n.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",X9,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var t={};return this.hot.runHooks("persistentStateLoad",X9,t),t.value}},{key:"setManualSize",value:function(t,e){var n=Math.max(e,20),r=this.hot.toPhysicalColumn(t);return this.columnWidthsMap.setValueAtIndex(r,n),n}},{key:"clearManualSize",value:function(t){var e=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(e,null)}},{key:"onMapInit",value:function(){var t=this,e=$9.get(this),n=this.hot.getSettings()[Y9],r=this.loadManualColumnWidths();"undefined"!==typeof r?this.hot.batchExecution((function(){r.forEach((function(e,n){t.columnWidthsMap.setValueAtIndex(n,e)}))}),!0):Array.isArray(n)?(this.hot.batchExecution((function(){n.forEach((function(e,n){t.columnWidthsMap.setValueAtIndex(n,e)}))}),!0),e.config=n):!0===n&&Array.isArray(e.config)&&this.hot.batchExecution((function(){e.config.forEach((function(e,n){t.columnWidthsMap.setValueAtIndex(n,e)}))}),!0)}},{key:"setupHandlePosition",value:function(t){var e=this;if(t.parentNode){this.currentTH=t;var n=this.hot.view._wt,r=n.wtTable.getCoords(this.currentTH),o=r.col;if(!(o<0)){var i,a=hn(this.currentTH),l=this.currentTH.getBoundingClientRect(),s=o<n.getSetting("fixedColumnsStart");s&&(i=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),i||(i=n.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),this.selectedCols=[];var u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){var c=this.hot.getSelectedRange();U(c,(function(t){var n=t.getTopStartCorner().col,r=t.getBottomEndCorner().col;Io(n,r,(function(t){e.selectedCols.includes(t)||e.selectedCols.push(t)}))}))}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=i.start-6,this.startWidth=parseInt(l.width,10),this.handle.style.top="".concat(i.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(a,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var t=parseInt(hn(this.handle),10),e=parseInt(this.handle.style.top,10)+t,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Ge(this.handle,"active"),Ge(this.guide,"active"),this.guide.style.top="".concat(e,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(n-t,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Ye(this.handle,"active"),Ye(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(t){return!!Ne(t,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}},{key:"onMouseOver",value:function(t){if(!In(t.target)&&this.checkIfColumnHeader(t.target)){var e=this.getClosestTHParent(t.target);if(!e)return;var n=e.getAttribute("colspan");!e||null!==n&&"1"!==n||this.pressed||this.setupHandlePosition(e)}}},{key:"afterMouseDownTimeout",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.adjustElementsSize(!0)},n=function(n,r){var o=t.hot.runHooks("beforeColumnResize",t.newSize,n,!0);void 0!==o&&(t.newSize=o),"all"===t.hot.getSettings().stretchH?t.clearManualSize(n):t.setManualSize(n,t.newSize),t.saveManualColumnWidths(),t.hot.runHooks("afterColumnResize",t.newSize,n,!0),r&&e()};if(this.dblclick>=2){var r=this.selectedCols.length;r>1?(U(this.selectedCols,(function(t){n(t)})),e()):U(this.selectedCols,(function(t){n(t,!0)}))}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(t){var e=this;ze(t.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return e.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=t.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(t){var e=this;if(this.pressed){var n=(t.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+n,U(this.selectedCols,(function(t){e.newSize=e.setManualSize(t,e.currentWidth)})),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.adjustElementsSize(!0)},n=function(n,r){t.hot.runHooks("beforeColumnResize",t.newSize,n,!1),r&&e(),t.saveManualColumnWidths(),t.hot.runHooks("afterColumnResize",t.newSize,n,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var r=this.selectedCols.length;r>1?(U(this.selectedCols,(function(t){n(t)})),e()):U(this.selectedCols,(function(t){n(t,!0)}))}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var t=this,e=this.hot,n=e.rootWindow,r=e.rootElement;this.eventManager.addEventListener(r,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(r,"mousedown",(function(e){return t.onMouseDown(e)})),this.eventManager.addEventListener(n,"mousemove",(function(e){return t.onMouseMove(e)})),this.eventManager.addEventListener(n,"mouseup",(function(){return t.onMouseUp()}))}},{key:"onModifyColWidth",value:function(t,e){var n=t;if(this.enabled){var r=this.hot.toPhysicalColumn(e),o=this.columnWidthsMap.getValueAtIndex(r);this.hot.getSettings()[Y9]&&o&&(n=o)}return n}},{key:"onBeforeStretchingColumnWidth",value:function(t,e){var n=this.columnWidthsMap.getValueAtIndex(e);return null===n&&(n=t),n}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){D9(G9(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Y9}},{key:"PLUGIN_PRIORITY",get:function(){return K9}}]),n}(jH);function Q9(t){return Q9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q9(t)}function J9(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Z9(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,e7(r.key),r)}}function t7(t,e,n){return e&&Z9(t.prototype,e),n&&Z9(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function e7(t){var e=n7(t,"string");return"symbol"===Q9(e)?e:String(e)}function n7(t,e){if("object"!==Q9(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Q9(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var r7=0,o7=1,i7=2,a7="px",l7=function(){function t(e){J9(this,t),this.hot=e,this._element=null,this.state=r7}return t7(t,[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=i7}},{key:"build",value:function(){this.state===r7&&(this._element=this.hot.rootDocument.createElement("div"),this.state=o7)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=r7}},{key:"isAppended",value:function(){return this.state===i7}},{key:"isBuilt",value:function(){return this.state>=o7}},{key:"setPosition",value:function(t,e){void 0!==t&&(this._element.style.top=t+a7),void 0!==e&&(this._element.style.left=e+a7)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(t,e){t&&(this._element.style.width=t+a7),e&&(this._element.style.height=e+a7)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,e){t&&(this._element.style.marginTop=t+a7),e&&(this._element.style.marginLeft=e+a7)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),t}(),s7=l7;function u7(t){return u7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u7(t)}function c7(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,d7(r.key),r)}}function h7(t,e,n){return e&&f7(t.prototype,e),n&&f7(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function d7(t){var e=p7(t,"string");return"symbol"===u7(e)?e:String(e)}function p7(t,e){if("object"!==u7(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==u7(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function y7(){return y7="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=v7(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},y7.apply(this,arguments)}function v7(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=O7(t),null===t)break;return t}function m7(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g7(t,e)}function g7(t,e){return g7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g7(t,e)}function b7(t){var e=C7();return function(){var n,r=O7(t);if(e){var o=O7(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return w7(this,n)}}function w7(t,e){if(e&&("object"===u7(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return S7(t)}function S7(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C7(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function O7(t){return O7=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},O7(t)}var k7="ht__manualRowMove--backlight",R7=function(t){m7(n,t);var e=b7(n);function n(){return c7(this,n),e.apply(this,arguments)}return h7(n,[{key:"build",value:function(){y7(O7(n.prototype),"build",this).call(this),Ge(this._element,k7)}}]),n}(s7),E7=R7;function P7(t){return P7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P7(t)}function T7(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,M7(r.key),r)}}function A7(t,e,n){return e&&j7(t.prototype,e),n&&j7(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function M7(t){var e=I7(t,"string");return"symbol"===P7(e)?e:String(e)}function I7(t,e){if("object"!==P7(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==P7(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function x7(){return x7="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=_7(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},x7.apply(this,arguments)}function _7(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=F7(t),null===t)break;return t}function H7(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&N7(t,e)}function N7(t,e){return N7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},N7(t,e)}function D7(t){var e=V7();return function(){var n,r=F7(t);if(e){var o=F7(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return L7(this,n)}}function L7(t,e){if(e&&("object"===P7(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return B7(t)}function B7(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function V7(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function F7(t){return F7=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},F7(t)}var W7="ht__manualRowMove--guideline",U7=function(t){H7(n,t);var e=D7(n);function n(){return T7(this,n),e.apply(this,arguments)}return A7(n,[{key:"build",value:function(){x7(F7(n.prototype),"build",this).call(this),Ge(this._element,W7)}}]),n}(s7),z7=U7;function G7(t){return G7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G7(t)}function Y7(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$7(r.key),r)}}function X7(t,e,n){return e&&K7(t.prototype,e),n&&K7(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function $7(t){var e=q7(t,"string");return"symbol"===G7(e)?e:String(e)}function q7(t,e){if("object"!==G7(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==G7(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Q7(){return Q7="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=J7(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Q7.apply(this,arguments)}function J7(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=itt(t),null===t)break;return t}function Z7(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ttt(t,e)}function ttt(t,e){return ttt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ttt(t,e)}function ett(t){var e=ott();return function(){var n,r=itt(t);if(e){var o=itt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ntt(this,n)}}function ntt(t,e){if(e&&("object"===G7(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return rtt(t)}function rtt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ott(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function itt(t){return itt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},itt(t)}mr.getSingleton().register("beforeRowMove"),mr.getSingleton().register("afterRowMove");var att="manualRowMove",ltt=140,stt=new WeakMap,utt="ht__manualRowMove",ctt="show-ui",ftt="on-moving--rows",htt="after-selection--rows",dtt=function(t){Z7(n,t);var e=ett(n);function n(t){var r;return Y7(this,n),r=e.call(this,t),stt.set(rtt(r),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),r.eventManager=new Gr(rtt(r)),r.backlight=new E7(t),r.guideline=new z7(t),r}return X7(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[att]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return t.onBeforeOnCellMouseOver.apply(t,arguments)})),this.addHook("afterScrollHorizontally",(function(){return t.onAfterScrollHorizontally()})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.buildPluginUI(),this.registerEvents(),Ge(this.hot.rootElement,utt),Q7(itt(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),Q7(itt(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ye(this.hot.rootElement,utt),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Q7(itt(n.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(t,e){return this.moveRows([t],e)}},{key:"moveRows",value:function(t,e){var n=stt.get(this),r=n.cachedDropIndex,o=this.isMovePossible(t,e),i=this.hot.runHooks("beforeRowMove",t,e,r,o);if(n.cachedDropIndex=void 0,!1!==i){o&&this.hot.rowIndexMapper.moveIndexes(t,e);var a=o&&this.isRowOrderChanged(t,e);return this.hot.runHooks("afterRowMove",t,e,r,o,a),a}}},{key:"dragRow",value:function(t,e){return this.dragRows([t],e)}},{key:"dragRows",value:function(t,e){var n=this.countFinalIndex(t,e),r=stt.get(this);return r.cachedDropIndex=e,this.moveRows(t,n)}},{key:"isMovePossible",value:function(t,e){var n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=t.length+e>n,o=e<0,i=t.some((function(t){return t<0})),a=t.some((function(t){return t>=n}));return!(r||o||i||a)}},{key:"isRowOrderChanged",value:function(t,e){return t.some((function(t,n){return t-n!==e}))}},{key:"countFinalIndex",value:function(t,e){var n=V(t,(function(t,n){return n<e&&(t+=1),t}),0);return e-n}},{key:"getRowsHeight",value:function(t,e){for(var n=this.hot.rowIndexMapper,r=0,o=t;o<=e;o++){var i=n.getRenderableFromVisualIndex(o);null!==i&&(r+=this.hot.view._wt.wtTable.getRowHeight(i)||23)}return r}},{key:"moveBySettingsOrLoad",value:function(){var t=this.hot.getSettings()[att];if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){var e=this.persistentStateLoad();e.length&&this.moveRows(e,0)}}},{key:"isFixedRowTop",value:function(t){return t<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(t){return t>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}},{key:"prepareRowsToMoving",value:function(){var t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;var n=t.from,r=t.to,o=Math.min(n.row,r.row),i=Math.max(n.row,r.row);return Io(o,i,(function(t){e.push(t)})),e}},{key:"refreshPositions",value:function(){var t=stt.get(this),e=t.target.coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),o=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<o&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);var i,a=this.hot.view._wt.wtTable,l=t.target.TD,s=this.hot.rootElement,u=tn(s),c=ln(s),f=a.holder.scrollTop;i=this.hot.rootWindow===c?c.scrollY:c.scrollTop;var h=u.top-i,d=t.target.eventPageY-h+f,p=a.hider.offsetHeight,y=a.TBODY.offsetTop,v=this.backlight.getOffset().top,m=this.backlight.getSize().height,g=l.offsetHeight/2,b=l.offsetHeight,w=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1),S=d>=w+g;this.isFixedRowTop(e.row)&&(w+=a.holder.scrollTop),e.row<0?t.target.row=n>0?n-1:n:S?(t.target.row=e.row+1,w+=0===e.row?b-1:b):t.target.row=e.row;var C=d,O=w;d+m+v>=p?C=p-m-v:d+v<y&&(C=y+Math.abs(v)),w>=p-1&&(O=p-1),this.backlight.setPosition(C),this.guideline.setPosition(O)}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(e,"mousemove",(function(e){return t.onMouseMove(e)})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){var o=this.hot.view._wt,i=o.wtTable,a=o.wtViewport,l=this.hot.selection.isSelectedByRowHeader(),s=this.hot.getSelectedRangeLast(),u=stt.get(this);if(!s||!l||u.pressed||0!==t.button)return u.pressed=!1,u.rowsToMove.length=0,void Ye(this.hot.rootElement,[ftt,ctt]);var c=this.guideline.isBuilt()&&!this.guideline.isAppended(),f=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&f&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));var h=s.from,d=s.to,p=Math.min(h.row,d.row),y=Math.max(h.row,d.row);if(e.col<0&&e.row>=p&&e.row<=y){r.row=!0,u.pressed=!0,u.target.eventPageY=t.pageY,u.target.coords=e,u.target.TD=n,u.rowsToMove=this.prepareRowsToMoving();var v=i.holder.scrollLeft+a.getRowHeaderWidth();this.backlight.setPosition(null,v),this.backlight.setSize(i.hider.offsetWidth-v,this.getRowsHeight(p,y)),this.backlight.setOffset(-1*(this.getRowsHeight(p,e.row-1)+t.offsetY),null),Ge(this.hot.rootElement,ftt),this.refreshPositions()}else Ye(this.hot.rootElement,htt),u.pressed=!1,u.rowsToMove.length=0}},{key:"onMouseMove",value:function(t){var e=stt.get(this);if(e.pressed){if(t.target===this.backlight.element){var n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout((function(){this.backlight.setPosition(null,n)}))}e.target.eventPageY=t.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){var o=this.hot.getSelectedRangeLast(),i=stt.get(this);o&&i.pressed&&(i.rowsToMove.indexOf(e.row)>-1?Ye(this.hot.rootElement,ctt):Ge(this.hot.rootElement,ctt),r.row=!0,r.column=!0,r.cell=!0,i.target.coords=e,i.target.TD=n)}},{key:"onMouseUp",value:function(){var t=stt.get(this),e=t.target.row,n=t.rowsToMove.length;if(t.pressed=!1,t.backlightHeight=0,Ye(this.hot.rootElement,[ftt,ctt,htt]),this.hot.selection.isSelectedByRowHeader()&&Ge(this.hot.rootElement,htt),!(n<1||void 0===e)){var r=t.rowsToMove[0],o=this.hot.toPhysicalRow(r),i=this.dragRows(t.rowsToMove,e);if(t.rowsToMove.length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var a=this.hot.toVisualRow(o),l=a+n-1;this.hot.selectRows(a,l)}}}},{key:"onAfterScrollHorizontally",value:function(){var t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;this.backlight.setPosition(null,r),this.backlight.setSize(t.hider.offsetWidth-r)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Q7(itt(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return att}},{key:"PLUGIN_PRIORITY",get:function(){return ltt}}]),n}(jH);function ptt(t){return ptt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ptt(t)}function ytt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vtt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,gtt(r.key),r)}}function mtt(t,e,n){return e&&vtt(t.prototype,e),n&&vtt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function gtt(t){var e=btt(t,"string");return"symbol"===ptt(e)?e:String(e)}function btt(t,e){if("object"!==ptt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ptt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function wtt(){return wtt="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Stt(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},wtt.apply(this,arguments)}function Stt(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Ttt(t),null===t)break;return t}function Ctt(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ott(t,e)}function Ott(t,e){return Ott=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ott(t,e)}function ktt(t){var e=Ptt();return function(){var n,r=Ttt(t);if(e){var o=Ttt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Rtt(this,n)}}function Rtt(t,e){if(e&&("object"===ptt(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ett(t)}function Ett(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ptt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Ttt(t){return Ttt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ttt(t)}var jtt,Att,Mtt,Itt,xtt="manualRowResize",_tt=30,Htt="manualRowHeights",Ntt=new WeakMap,Dtt=function(t){Ctt(n,t);var e=ktt(n);function n(t){var r;ytt(this,n),r=e.call(this,t);var o=r.hot.rootDocument;return r.currentTH=null,r.currentRow=null,r.selectedRows=[],r.currentHeight=null,r.newSize=null,r.startY=null,r.startHeight=null,r.startOffset=null,r.handle=o.createElement("DIV"),r.guide=o.createElement("DIV"),r.eventManager=new Gr(Ett(r)),r.pressed=null,r.dblclick=0,r.autoresizeTimeout=null,r.rowHeightsMap=void 0,Ntt.set(Ett(r),{config:void 0}),Ge(r.handle,"manualRowResizer"),Ge(r.guide,"manualRowResizerGuide"),r}return mtt(n,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[xtt]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.rowHeightsMap=new Zm,this.rowHeightsMap.addLocalHook("init",(function(){return t.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(function(e,n){return t.onModifyRowHeight(e,n)})),this.bindEvents(),wtt(Ttt(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),wtt(Ttt(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=Ntt.get(this);t.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),wtt(Ttt(n.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",Htt,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var t={};return this.hot.runHooks("persistentStateLoad",Htt,t),t.value}},{key:"setManualSize",value:function(t,e){var n=this.hot.toPhysicalRow(t),r=Math.max(e,iy.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(n,r),r}},{key:"setupHandlePosition",value:function(t){var e=this;this.currentTH=t;var n=this.hot.view,r=n._wt,o=r.wtTable.getCoords(this.currentTH),i=o.row;if(!(i<0)){var a,l=fn(this.currentTH),s=this.currentTH.getBoundingClientRect(),u=i<r.getSetting("fixedRowsTop"),c=i>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");u?a=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col):c&&(a=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),a||(a=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.selectedRows=[];var f=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&f){var h=this.hot.getSelectedRange();U(h,(function(t){var n=t.getTopStartCorner().row,r=t.getBottomStartCorner().row;Io(n,r,(function(t){e.selectedRows.includes(t)||e.selectedRows.push(t)}))}))}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=a.top-6,this.startHeight=parseInt(s.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(a.start,"px"),this.handle.style.width="".concat(l,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var t=parseInt(fn(this.handle),10),e=parseInt(this.handle.style[this.inlineDir],10)+t,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Ge(this.handle,"active"),Ge(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(e,"px"),this.guide.style.width="".concat(n-t,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Ye(this.handle,"active"),Ye(this.guide,"active")}},{key:"checkIfRowHeader",value:function(t){var e,n,r=Ne(t,["TH"],this.hot.rootElement);return r&&"TBODY"===(null===(e=t.parentNode)||void 0===e||null===(n=e.parentNode)||void 0===n?void 0:n.tagName)}},{key:"getClosestTHParent",value:function(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}},{key:"getActualRowHeight",value:function(t){var e=this.hot.view._wt.wtTable.getRowHeight(t);return void 0!==e&&this.newSize<e?e:this.newSize}},{key:"onMouseOver",value:function(t){if(!In(t.target)&&this.checkIfRowHeader(t.target)){var e=this.getClosestTHParent(t.target);e&&(this.pressed||this.setupHandlePosition(e))}}},{key:"afterMouseDownTimeout",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.adjustElementsSize(!0)},n=function(n,r){var o=t.hot.runHooks("beforeRowResize",t.getActualRowHeight(n),n,!0);void 0!==o&&(t.newSize=o),t.setManualSize(n,t.newSize),t.hot.runHooks("afterRowResize",t.getActualRowHeight(n),n,!0),r&&e()};if(this.dblclick>=2){var r=this.selectedRows.length;r>1?(U(this.selectedRows,(function(t){n(t)})),e()):U(this.selectedRows,(function(t){n(t,!0)}))}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(t){var e=this;ze(t.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return e.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=t.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(t){var e=this;this.pressed&&(this.currentHeight=this.startHeight+(t.pageY-this.startY),U(this.selectedRows,(function(t){e.newSize=e.setManualSize(t,e.currentHeight)})),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.adjustElementsSize(!0)},n=function(n,r){t.hot.runHooks("beforeRowResize",t.getActualRowHeight(n),n,!1),r&&e(),t.saveManualRowHeights(),t.hot.runHooks("afterRowResize",t.getActualRowHeight(n),n,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var r=this.selectedRows.length;r>1?(U(this.selectedRows,(function(t){n(t)})),e()):U(this.selectedRows,(function(t){n(t,!0)}))}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var t=this,e=this.hot,n=e.rootElement,r=e.rootWindow;this.eventManager.addEventListener(n,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(n,"mousedown",(function(e){return t.onMouseDown(e)})),this.eventManager.addEventListener(r,"mousemove",(function(e){return t.onMouseMove(e)})),this.eventManager.addEventListener(r,"mouseup",(function(){return t.onMouseUp()}))}},{key:"onModifyRowHeight",value:function(t,e){var n=t;if(this.enabled){var r=this.hot.toPhysicalRow(e),o=this.rowHeightsMap.getValueAtIndex(r);this.hot.getSettings()[xtt]&&o&&(n=o)}return n}},{key:"onMapInit",value:function(){var t=this,e=Ntt.get(this),n=this.hot.getSettings()[xtt],r=this.loadManualRowHeights();this.hot.batchExecution((function(){"undefined"!==typeof r?r.forEach((function(e,n){t.rowHeightsMap.setValueAtIndex(n,e)})):Array.isArray(n)?(n.forEach((function(e,n){t.rowHeightsMap.setValueAtIndex(n,e)})),e.config=n):!0===n&&Array.isArray(e.config)&&e.config.forEach((function(e,n){t.rowHeightsMap.setValueAtIndex(n,e)}))}),!0)}},{key:"destroy",value:function(){wtt(Ttt(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return xtt}},{key:"PLUGIN_PRIORITY",get:function(){return _tt}}]),n}(jH);function Ltt(t){return Ltt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ltt(t)}function Btt(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Vtt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ftt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Utt(r.key),r)}}function Wtt(t,e,n){return e&&Ftt(t.prototype,e),n&&Ftt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Utt(t){var e=ztt(t,"string");return"symbol"===Ltt(e)?e:String(e)}function ztt(t,e){if("object"!==Ltt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ltt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Gtt,Ytt=function(){function t(e,n,r,o,i,a){Vtt(this,t),this.row=e,this.col=n,this.rowspan=r,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return Wtt(t,[{key:"normalize",value:function(t){var e=t.countRows(),n=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}},{key:"includes",value:function(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}},{key:"includesHorizontally",value:function(t){return this.col<=t&&this.col+this.colspan-1>=t}},{key:"includesVertically",value:function(t){return this.row<=t&&this.row+this.rowspan-1>=t}},{key:"shift",value:function(t,e){var n=t[0]||t[1],r=e+Math.abs(t[0]||t[1])-1,o=t[0]?"colspan":"rowspan",i=t[0]?"col":"row",a=Math.min(e,r),l=Math.max(e,r),s=this[i],u=this[i]+this[o]-1;if(s>=e&&(this[i]+=n),n>0)e<=u&&e>s&&(this[o]+=n);else if(n<0){if(a<=s&&l>=u)return this.removed=!0,!1;if(s>=a&&s<=l){var c=l-s+1,f=Math.abs(n)-c;this[i]-=f+n,this[o]-=c}else if(s<=a&&u>=l)this[o]+=n;else if(s<=a&&u>=a&&u<l){var h=u-a+1;this[o]-=h}}return!0}},{key:"isFarther",value:function(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(t){return $t(jtt||(jtt=Btt(["The merged cell declared with {row: ",", col: ",", \n      rowspan: ",", colspan: ","} contains negative values, which is \n      not supported. It will not be added to the collection."],["The merged cell declared with {row: ",", col: ",",\\x20\n      rowspan: ",", colspan: ","} contains negative values, which is\\x20\n      not supported. It will not be added to the collection."])),t.row,t.col,t.rowspan,t.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(t){return $t(Att||(Att=Btt(["The merged cell declared at [",", ","] is positioned \n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] is positioned\\x20\n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."])),t.row,t.col)}},{key:"IS_SINGLE_CELL",value:function(t){return $t(Mtt||(Mtt=Btt(["The merged cell declared at [",", ",'] has both "rowspan" \n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has both "rowspan"\\x20\n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'])),t.row,t.col)}},{key:"ZERO_SPAN_WARNING",value:function(t){return $t(Itt||(Itt=Btt(["The merged cell declared at [",", ",'] has "rowspan" \n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has "rowspan"\\x20\n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'])),t.row,t.col)}},{key:"containsNegativeValues",value:function(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}},{key:"isSingleCell",value:function(t){return 1===t.colspan&&1===t.rowspan}},{key:"containsZeroSpan",value:function(t){return 0===t.colspan||0===t.rowspan}},{key:"isOutOfBounds",value:function(t,e,n){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=n||t.col+t.colspan-1>=n}}]),t}(),Ktt=Ytt;function Xtt(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function $tt(t){return $tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$tt(t)}function qtt(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Qtt(t){return eet(t)||tet(t)||Ztt(t)||Jtt()}function Jtt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ztt(t,e){if(t){if("string"===typeof t)return net(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?net(t,e):void 0}}function tet(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function eet(t){if(Array.isArray(t))return net(t)}function net(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ret(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oet(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,aet(r.key),r)}}function iet(t,e,n){return e&&oet(t.prototype,e),n&&oet(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function aet(t){var e=set(t,"string");return"symbol"===$tt(e)?e:String(e)}function set(t,e){if("object"!==$tt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==$tt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var uet=function(){function t(e){ret(this,t),this.plugin=e,this.mergedCells=[],this.hot=e.hot}return iet(t,[{key:"get",value:function(t,e){var n=this.mergedCells,r=!1;return U(n,(function(n){return!(n.row<=t&&n.row+n.rowspan-1>=t&&n.col<=e&&n.col+n.colspan-1>=e)||(r=n,!1)})),r}},{key:"getByRange",value:function(t){var e=this.mergedCells,n=!1;return U(e,(function(e){return!(e.row<=t.from.row&&e.row+e.rowspan-1>=t.to.row&&e.col<=t.from.col&&e.col+e.colspan-1>=t.to.col)||(n=e,n)})),n}},{key:"getWithinRange",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCells,o=[],i=t;if(!i.includesRange){var a=this.hot._createCellCoords(i.from.row,i.from.col),l=this.hot._createCellCoords(i.to.row,i.to.col);i=this.hot._createCellRange(a,a,l)}return U(r,(function(t){var r=e.hot._createCellCoords(t.row,t.col),a=e.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),l=e.hot._createCellRange(r,r,a);n?i.overlaps(l)&&o.push(t):i.includesRange(l)&&o.push(t)})),!!o.length&&o}},{key:"add",value:function(e){var n=this.mergedCells,r=e.row,o=e.col,i=e.rowspan,a=e.colspan,l=new Ktt(r,o,i,a,this.hot._createCellCoords,this.hot._createCellRange),s=this.get(r,o),u=this.isOverlapping(l);return s||u?(Un(t.IS_OVERLAPPING_WARNING(l)),!1):(this.hot&&l.normalize(this.hot),n.push(l),l)}},{key:"remove",value:function(t,e){var n=this.mergedCells,r=this.get(t,e),o=r?this.mergedCells.indexOf(r):-1;return!(!r||-1===o)&&(n.splice(o,1),r)}},{key:"clear",value:function(){var t=this,e=this.mergedCells,n=[],r=[];U(e,(function(e){var r=t.hot.getCell(e.row,e.col);r&&n.push([r,t.get(e.row,e.col),e.row,e.col])})),this.mergedCells.length=0,U(n,(function(e,o){Io(0,e.rowspan-1,(function(n){Io(0,e.colspan-1,(function(o){if(0!==o||0!==n){var i=t.hot.getCell(e.row+n,e.col+o);i&&r.push([i,null,null,null])}}))})),n[o][1]=null})),U(n,(function(t){Xtt.apply(void 0,Qtt(t))})),U(r,(function(t){Xtt.apply(void 0,Qtt(t))}))}},{key:"isOverlapping",value:function(t){var e=this,n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1)),r=!1;return U(this.mergedCells,(function(t){var o=e.hot._createCellRange(e.hot._createCellCoords(0,0),e.hot._createCellCoords(t.row,t.col),e.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1));return!o.overlaps(n)||(r=!0,!1)})),r}},{key:"isFirstRenderableMergedCell",value:function(t,e){var n=this.get(t,e);return n&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)===e}},{key:"getFirstRenderableCoords",value:function(t,e){var n=this.get(t,e);if(!n||this.isFirstRenderableMergedCell(t,e))return this.hot._createCellCoords(t,e);var r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(r,o)}},{key:"shiftCollections",value:function(t,e,n){var r=this,o=[0,0];switch(t){case"right":o[0]+=n;break;case"left":o[0]-=n;break;case"down":o[1]+=n;break;case"up":o[1]-=n;break;default:}U(this.mergedCells,(function(t){t.shift(o,e)})),xo(this.mergedCells.length-1,0,(function(t){var e=r.mergedCells[t];e&&e.removed&&r.mergedCells.splice(r.mergedCells.indexOf(e),1)}))}}],[{key:"IS_OVERLAPPING_WARNING",value:function(t){return $t(Gtt||(Gtt=qtt(["The merged cell declared at [",", ","], overlaps \n      with the other declared merged cell. The overlapping merged cell was not added to the table, please \n      fix your setup."],["The merged cell declared at [",", ","], overlaps\\x20\n      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20\n      fix your setup."])),t.row,t.col)}}]),t}(),cet=uet;function fet(t){return fet="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fet(t)}function het(t,e){return met(t)||vet(t,e)||pet(t,e)||det()}function det(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pet(t,e){if(t){if("string"===typeof t)return yet(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yet(t,e):void 0}}function yet(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function vet(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function met(t){if(Array.isArray(t))return t}function get(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bet(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Cet(r.key),r)}}function wet(t,e,n){return e&&bet(t.prototype,e),n&&bet(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cet(t){var e=Oet(t,"string");return"symbol"===fet(e)?e:String(e)}function Oet(t,e){if("object"!==fet(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==fet(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ket=function(){function t(e){get(this,t),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return wet(t,[{key:"correctSelectionAreaSize",value:function(t){if(t[0]===t[2]&&t[1]===t[3]){var e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}},{key:"getDirection",value:function(t,e){var n=null;return n=e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left",n}},{key:"snapDragArea",value:function(t,e,n,r){var o=e.slice(0),i=this.getAutofillSize(t,e,n),a=het(t,4),l=a[0],s=a[1],u=a[2],c=a[3],f=["up","down"].indexOf(n)>-1,h=f?u-l+1:c-s+1,d=Math.floor(i/h)*h,p=i-d,y=this.getFarthestCollection(t,e,n,r);if(y)if("down"===n){var v=y.row+y.rowspan-l-p,m=o[2]+v;m>=this.plugin.hot.countRows()?o[2]-=p:o[2]+=p?v:0}else if("right"===n){var g=y.col+y.colspan-s-p,b=o[3]+g;b>=this.plugin.hot.countCols()?o[3]-=p:o[3]+=p?g:0}else if("up"===n){var w=u-p-y.row+1,S=o[0]+w;S<0?o[0]+=p:o[0]-=p?w:0}else if("left"===n){var C=c-p-y.col+1,O=o[1]+C;O<0?o[1]+=p:o[1]-=p?C:0}return this.updateCurrentFillCache({baseArea:t,dragDirection:n,foundMergedCells:r,fillSize:i,dragArea:o,cycleLength:h}),o}},{key:"updateCurrentFillCache",value:function(t){this.currentFillData||(this.currentFillData={}),at(this.currentFillData,t)}},{key:"getAutofillSize",value:function(t,e,n){var r=het(t,4),o=r[0],i=r[1],a=r[2],l=r[3],s=het(e,4),u=s[0],c=s[1],f=s[2],h=s[3];switch(n){case"up":return o-u;case"down":return f-a;case"left":return i-c;case"right":return h-l;default:return null}}},{key:"getDragArea",value:function(t,e,n){var r=het(t,4),o=r[0],i=r[1],a=r[2],l=r[3],s=het(e,4),u=s[0],c=s[1],f=s[2],h=s[3];switch(n){case"up":return[u,c,o-1,l];case"down":return[a+1,i,f,l];case"left":return[u,c,a,i-1];case"right":return[o,l+1,f,h];default:return null}}},{key:"getFarthestCollection",value:function(t,e,n,r){var o=het(t,4),i=o[0],a=o[1],l=o[2],s=o[3],u=["up","down"].indexOf(n)>-1,c=u?l:s,f=u?i:a,h=this.getAutofillSize(t,e,n),d=u?l-i+1:s-a+1,p=Math.floor(h/d)*d,y=h-p,v=null,m=null,g=null;switch(n){case"up":v="includesVertically",g=c-y+1;break;case"left":v="includesHorizontally",g=c-y+1;break;case"down":v="includesVertically",g=f+y-1;break;case"right":v="includesHorizontally",g=f+y-1;break;default:}return U(r,(function(t){t[v](g)&&t.isFarther(m,n)&&(m=t)})),m}},{key:"recreateAfterDataPopulation",value:function(t){if(this.currentFillData){var e=this.getRangeFromChanges(t),n=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=function(t,n){switch(r){case"up":return t.row-n>=e.from.row;case"down":return t.row+t.rowspan-1+n<=e.to.row;case"left":return t.col-n>=e.from.column;case"right":return t.col+t.colspan-1+n<=e.to.column;default:return null}},i=0,a=null,l=1;do{for(var s=0;s<n.length;s+=1){if(a=n[s],i=l*this.currentFillData.cycleLength,o(a,i))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-i,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+i,colspan:a.colspan});break;default:}s===n.length-1&&(l+=1)}}while(o(a,i));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(t){var e=this,n={min:null,max:null},r={min:null,max:null};return U(t,(function(t){var o=t[0],i=e.plugin.hot.propToCol(t[1]);(null===n.min||o<n.min)&&(n.min=o),(null===n.max||o>n.max)&&(n.max=o),(null===r.min||i<r.min)&&(r.min=i),(null===r.max||i>r.max)&&(r.max=i)})),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}},{key:"dragAreaOverlapsCollections",value:function(t,e,n){var r=this.getDragArea(t,e,n),o=het(r,4),i=o[0],a=o[1],l=o[2],s=o[3],u=this.plugin.hot._createCellCoords(i,a),c=this.plugin.hot._createCellCoords(l,s),f=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(f,!0)}}]),t}(),Ret=ket;function Eet(t){return Eet="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eet(t)}function Pet(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tet(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Aet(r.key),r)}}function jet(t,e,n){return e&&Tet(t.prototype,e),n&&Tet(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Aet(t){var e=Met(t,"string");return"symbol"===Eet(e)?e:String(e)}function Met(t,e){if("object"!==Eet(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Eet(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Iet=function(){function t(e){Pet(this,t),this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return jet(t,[{key:"snapDelta",value:function(t,e,n){var r=e.to,o=r.row+t.row,i=r.col+t.col;t.row?this.jumpOverMergedCell(t,n,o):t.col&&this.jumpOverMergedCell(t,n,i)}},{key:"jumpOverMergedCell",value:function(t,e,n){var r=t.row||t.col,o=null,i=null,a=null;t.row?(o=e.includesVertically(n),i=e.row,a=e.getLastRow()):t.col&&(o=e.includesHorizontally(n),i=e.col,a=e.getLastColumn()),0!==r&&(r>0?o&&n!==i&&(r+=a-n+1):o&&n!==a&&(r-=n-i+1),t.row?t.row=r:t.col&&(t.col=r))}},{key:"getUpdatedSelectionRange",value:function(t,e){return this.hot._createCellRange(t.highlight,t.from,this.hot._createCellCoords(t.to.row+e.row,t.to.col+e.col))}},{key:"getSelectedMergedCellClassName",value:function(t,e,n,r){var o=Math.min(n[0],n[2]),i=Math.min(n[1],n[3]),a=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]);if(void 0!==r){var s=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(t,e);if(s){var u=this.plugin.mergedCellsCollection.get(t,e);if(u){var c=u.getLastRow(),f=u.getLastColumn(),h=o<=u.row&&i<=u.col&&a>=c&&l>=f;return h?"".concat(this.fullySelectedMergedCellClassName,"-").concat(r):this.plugin.selectionCalculations.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange())?"".concat(this.fullySelectedMergedCellClassName,"-multiple"):void 0}}}}},{key:"isMergeCellFullySelected",value:function(t,e){var n=[];if(!e||!t)return!1;for(var r=0;r<t.rowspan;r+=1)for(var o=0;o<t.colspan;o+=1)n.push(this.hot._createCellCoords(t.row+r,t.col+o));for(var i=0;i<n.length;i+=1){for(var a=[],l=0;l<e.length;l+=1)a[l]=e[l].includes(n[i]);if(!a.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var t=[],e=0;e<=7;e+=1)t.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(e));return t.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),t}}]),t}(),xet=Iet;function _et(t){return{key:"mergeCells",name:function(){var e=this.getSelectedLast();if(e){var n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(Jw)}return this.getTranslatedPhrase(Qw)},callback:function(){t.toggleMergeOnSelection()},disabled:function(){var t=this.getSelectedLast();if(!t)return!0;var e=Ktt.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1});return e||this.selection.isSelectedByCorner()},hidden:!1}}function Het(t){return Het="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Het(t)}function Net(t,e){return Bet(t)||Let(t,e)||Wet(t,e)||Det()}function Det(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Let(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Bet(t){if(Array.isArray(t))return t}function Vet(t){return zet(t)||Uet(t)||Wet(t)||Fet()}function Fet(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Wet(t,e){if(t){if("string"===typeof t)return Get(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Get(t,e):void 0}}function Uet(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function zet(t){if(Array.isArray(t))return Get(t)}function Get(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Yet(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ket(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$et(r.key),r)}}function Xet(t,e,n){return e&&Ket(t.prototype,e),n&&Ket(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function $et(t){var e=qet(t,"string");return"symbol"===Het(e)?e:String(e)}function qet(t,e){if("object"!==Het(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Het(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Qet(){return Qet="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Jet(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Qet.apply(this,arguments)}function Jet(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=int(t),null===t)break;return t}function Zet(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tnt(t,e)}function tnt(t,e){return tnt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},tnt(t,e)}function ent(t){var e=ont();return function(){var n,r=int(t);if(e){var o=int(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nnt(this,n)}}function nnt(t,e){if(e&&("object"===Het(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return rnt(t)}function rnt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ont(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function int(t){return int=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},int(t)}mr.getSingleton().register("beforeMergeCells"),mr.getSingleton().register("afterMergeCells"),mr.getSingleton().register("beforeUnmergeCells"),mr.getSingleton().register("afterUnmergeCells");var ant,lnt="mergeCells",snt=150,unt=new WeakMap,cnt=lnt,fnt=function(t){Zet(n,t);var e=ent(n);function n(t){var r;return Yet(this,n),r=e.call(this,t),unt.set(rnt(r),{lastDesiredCoords:null}),r.mergedCellsCollection=null,r.autofillCalculations=null,r.selectionCalculations=null,r}return Xet(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[lnt]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.mergedCellsCollection=new cet(this),this.autofillCalculations=new Ret(this),this.selectionCalculations=new xet(this),this.addHook("afterInit",(function(){return t.onAfterInit.apply(t,arguments)})),this.addHook("modifyTransformStart",(function(){return t.onModifyTransformStart.apply(t,arguments)})),this.addHook("afterModifyTransformStart",(function(){return t.onAfterModifyTransformStart.apply(t,arguments)})),this.addHook("modifyTransformEnd",(function(){return t.onModifyTransformEnd.apply(t,arguments)})),this.addHook("modifyGetCellCoords",(function(){return t.onModifyGetCellCoords.apply(t,arguments)})),this.addHook("beforeSetRangeStart",(function(){return t.onBeforeSetRangeStart.apply(t,arguments)})),this.addHook("beforeSetRangeStartOnly",(function(){return t.onBeforeSetRangeStart.apply(t,arguments)})),this.addHook("beforeSetRangeEnd",(function(){return t.onBeforeSetRangeEnd.apply(t,arguments)})),this.addHook("afterIsMultipleSelection",(function(){return t.onAfterIsMultipleSelection.apply(t,arguments)})),this.addHook("afterRenderer",(function(){return t.onAfterRenderer.apply(t,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return t.addMergeActionsToContextMenu.apply(t,arguments)})),this.addHook("afterGetCellMeta",(function(){return t.onAfterGetCellMeta.apply(t,arguments)})),this.addHook("afterViewportRowCalculatorOverride",(function(){return t.onAfterViewportRowCalculatorOverride.apply(t,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return t.onAfterViewportColumnCalculatorOverride.apply(t,arguments)})),this.addHook("modifyAutofillRange",(function(){return t.onModifyAutofillRange.apply(t,arguments)})),this.addHook("afterCreateCol",(function(){return t.onAfterCreateCol.apply(t,arguments)})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol.apply(t,arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow.apply(t,arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow.apply(t,arguments)})),this.addHook("afterChange",(function(){return t.onAfterChange.apply(t,arguments)})),this.addHook("beforeDrawBorders",(function(){return t.onBeforeDrawAreaBorders.apply(t,arguments)})),this.addHook("afterDrawSelection",(function(){return t.onAfterDrawSelection.apply(t,arguments)})),this.addHook("beforeRemoveCellClassNames",(function(){return t.onBeforeRemoveCellClassNames.apply(t,arguments)})),this.addHook("beforeUndoStackChange",(function(t,e){if("MergeCells"===e)return!1})),this.registerShortcuts(),Qet(int(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),Qet(int(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings()[lnt];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),Qet(int(n.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var t=this;if(Rt()){var e=[],n=[];this.mergedCellsCollection.mergedCells.forEach((function(t){for(var e=t.row,r=t.rowspan,o=e+1;o<e+r;o++)n.push(o)})),n=Vet(new Set(n)),n.forEach((function(n){var r=t.hot.rowIndexMapper.getRenderableFromVisualIndex(n);t.hot.view._wt.wtOverlays.getOverlays(!0).map((function(t){return"master"===(null===t||void 0===t?void 0:t.name)?t:t.clone.wtTable})).forEach((function(t){var n=t.getRow(r);n&&(n.style.background=sn(n,"backgroundColor").replace(")",", 0.99)"),e.push(n))}))})),this.hot._registerTimeout((function(){e.forEach((function(t){t.style.background=sn(t,"backgroundColor").replace(", 0.99)",")")}))}),1)}}},{key:"validateSetting",value:function(t){var e=!0;return!!t&&(Ktt.containsNegativeValues(t)?(Un(Ktt.NEGATIVE_VALUES_WARNING(t)),e=!1):Ktt.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?(Un(Ktt.IS_OUT_OF_BOUNDS_WARNING(t)),e=!1):Ktt.isSingleCell(t)?(Un(Ktt.IS_SINGLE_CELL(t)),e=!1):Ktt.containsZeroSpan(t)&&(Un(Ktt.ZERO_SPAN_WARNING(t)),e=!1),e)}},{key:"generateFromSettings",value:function(t){var e=this;if(Array.isArray(t)){var n=[];if(U(t,(function(t){if(e.validateSetting(t)){var r=e.hot._createCellCoords(t.row,t.col),o=e.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),i=e.hot._createCellRange(r,r,o);e.mergeRange(i,!0,!0),Io(t.row,t.row+t.rowspan-1,(function(e){Io(t.col,t.col+t.colspan-1,(function(r){!1===(e===t.row&&r===t.col)&&n.push([e,r,null])}))}))}})),0===n.length)return;this.hot.setDataAtCell(n)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!e||this.validateSetting(t)}},{key:"toggleMergeOnSelection",value:function(){var t=this.hot.getSelectedRangeLast();if(t){t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var e=t.from,n=t.to;this.toggleMerge(t),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}}},{key:"mergeSelection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(t){t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var e=t.from,n=t.to;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}}},{key:"unmergeSelection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(t){var e=t.from,n=t.to;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}}},{key:"mergeRange",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t.getTopStartCorner(),i=t.getBottomEndCorner(),a={row:o.row,col:o.col,rowspan:i.row-o.row+1,colspan:i.col-o.col+1},l=[],s=null;if(!this.canMergeRange(a,n))return!1;this.hot.runHooks("beforeMergeCells",t,n),Io(0,a.rowspan-1,(function(t){Io(0,a.colspan-1,(function(n){var r=null;l[t]||(l[t]=[]),0===t&&0===n?r=e.hot.getSourceDataAtCell(e.hot.toPhysicalRow(a.row),e.hot.toPhysicalColumn(a.col)):e.hot.setCellMeta(a.row+t,a.col+n,"hidden",!0),l[t][n]=r}))})),this.hot.setCellMeta(a.row,a.col,"spanned",!0);var u=this.mergedCellsCollection.add(a);return!u||(r?s=[a.row,a.col,l]:this.hot.populateFromArray(a.row,a.col,l,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",t,a,n),s)}},{key:"unmergeRange",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCellsCollection.getWithinRange(t);r&&(this.hot.runHooks("beforeUnmergeCells",t,n),U(r,(function(t){e.mergedCellsCollection.remove(t.row,t.col),Io(0,t.rowspan-1,(function(n){Io(0,t.colspan-1,(function(r){e.hot.removeCellMeta(t.row+n,t.col+r,"hidden")}))})),e.hot.removeCellMeta(t.row,t.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",t,n),this.hot.render())}},{key:"toggleMerge",value:function(t){var e=this.mergedCellsCollection.get(t.from.row,t.from.col),n=e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col;n?this.unmergeRange(t):this.mergeSelection(t)}},{key:"merge",value:function(t,e,n,r){var o=this.hot._createCellCoords(t,e),i=this.hot._createCellCoords(n,r);this.mergeRange(this.hot._createCellRange(o,o,i))}},{key:"unmerge",value:function(t,e,n,r){var o=this.hot._createCellCoords(t,e),i=this.hot._createCellCoords(n,r);this.unmergeRange(this.hot._createCellRange(o,o,i))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[lnt]),this.hot.render()}},{key:"registerShortcuts",value:function(){var t=this,e=this.hot.getShortcutManager(),n=e.getContext("grid");n.addShortcut({keys:[["Control","m"]],callback:function(){t.toggleMerge(t.hot.getSelectedRangeLast()),t.hot.render()},runOnlyIf:function(t){return!t.altKey},group:cnt})}},{key:"unregisterShortcuts",value:function(){var t=this.hot.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(cnt)}},{key:"onAfterIsMultipleSelection",value:function(t){if(t)for(var e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1;return t}},{key:"onModifyTransformStart",value:function(t){var e=unt.get(this),n=this.hot.getSelectedRangeLast(),r={row:t.row,col:t.col},o=null,i=this.hot._createCellCoords(n.highlight.row,n.highlight.col),a=this.mergedCellsCollection.get(i.row,i.col);if(e.lastDesiredCoords||(e.lastDesiredCoords=this.hot._createCellCoords(null,null)),a){var l=this.hot._createCellCoords(a.row,a.col),s=this.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1),u=this.hot._createCellRange(l,l,s);u.includes(e.lastDesiredCoords)||(e.lastDesiredCoords=this.hot._createCellCoords(null,null)),r.row=e.lastDesiredCoords.row?e.lastDesiredCoords.row-i.row:r.row,r.col=e.lastDesiredCoords.col?e.lastDesiredCoords.col-i.col:r.col,t.row>0?r.row=a.row+a.rowspan-1-i.row+t.row:t.row<0&&(r.row=i.row-a.row+t.row),t.col>0?r.col=a.col+a.colspan-1-i.col+t.col:t.col<0&&(r.col=i.col-a.col+t.col)}o=this.hot._createCellCoords(n.highlight.row+r.row,n.highlight.col+r.col);var c=this.mergedCellsCollection.get(o.row,o.col);if(c){var f=this.mergedCellsCollection.getFirstRenderableCoords(c.row,c.col);e.lastDesiredCoords=o,r={row:f.row-i.row,col:f.col-i.col}}0!==r.row&&(t.row=r.row),0!==r.col&&(t.col=r.col)}},{key:"onModifyTransformEnd",value:function(t){var e=this,n=this.hot.getSelectedRangeLast(),r=ut(t),o=this.selectionCalculations.getUpdatedSelectionRange(n,t),i=ut(r),a=this.mergedCellsCollection.getWithinRange(o,!0);do{i=ut(r),this.selectionCalculations.getUpdatedSelectionRange(n,r),U(a,(function(t){e.selectionCalculations.snapDelta(r,n,t)}))}while(r.row!==i.row||r.col!==i.col);t.row=r.row,t.col=r.col}},{key:"onModifyGetCellCoords",value:function(t,e){if(!(t<0||e<0)){var n=this.mergedCellsCollection.get(t,e);if(n){var r=n.row,o=n.col,i=n.colspan,a=n.rowspan;return[r,o,r+a-1,o+i-1]}}}},{key:"addMergeActionsToContextMenu",value:function(t){t.items.push({name:"---------"},_et(this))}},{key:"onAfterRenderer",value:function(t,e,n){var r=this.mergedCellsCollection.get(e,n),o=ht(r)?ut(r):void 0;if(ht(o)){var i=this.hot,a=i.rowIndexMapper,l=i.columnIndexMapper,s=o.row,u=o.col,c=o.colspan,f=o.rowspan,h=this.translateMergedCellToRenderable(s,f,u,c),d=Net(h,2),p=d[0],y=d[1],v=a.getRenderableFromVisualIndex(e),m=l.getRenderableFromVisualIndex(n),g=p-v+1,b=y-m+1;o.row=a.getNearestNotHiddenIndex(o.row,1),o.col=l.getNearestNotHiddenIndex(o.col,1),o.rowspan=Math.min(o.rowspan,g),o.colspan=Math.min(o.colspan,b)}Xtt(t,o,e,n)}},{key:"onBeforeSetRangeStart",value:function(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){var e=this.mergedCellsCollection.get(t.row,t.col),n=[e.row,e.col];t.row=n[0],t.col=n[1]}}},{key:"onBeforeSetRangeEnd",value:function(t){var e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;var n=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{n=!1;for(var r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){var o=this.mergedCellsCollection.mergedCells[r],i=o.getRange();e.expandByRange(i)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}},{key:"onAfterGetCellMeta",value:function(t,e,n){var r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(t){var e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}},{key:"modifyViewportRowStart",value:function(t,e){for(var n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(t.startRow),o=0;o<e;o+=1){var i=this.mergedCellsCollection.get(r,o);if(ht(i)){var a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i.row,1));if(a<t.startRow)return t.startRow=a,void this.modifyViewportRowStart(t,e)}}}},{key:"modifyViewportRowEnd",value:function(t,e){for(var n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(t.endRow),o=0;o<e;o+=1){var i=this.mergedCellsCollection.get(r,o);if(ht(i)){var a=i.row+i.rowspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>t.endRow)return t.endRow=l,void this.modifyViewportRowEnd(t,e)}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(t){var e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}},{key:"modifyViewportColumnStart",value:function(t,e){for(var n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(t.startColumn),o=0;o<e;o+=1){var i=this.mergedCellsCollection.get(o,r);if(ht(i)){var a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i.col,1));if(a<t.startColumn)return t.startColumn=a,void this.modifyViewportColumnStart(t,e)}}}},{key:"modifyViewportColumnEnd",value:function(t,e){for(var n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(t.endColumn),o=0;o<e;o+=1){var i=this.mergedCellsCollection.get(o,r);if(ht(i)){var a=i.col+i.colspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>t.endColumn)return t.endColumn=l,void this.modifyViewportColumnEnd(t,e)}}}},{key:"translateMergedCellToRenderable",value:function(t,e,n,r){var o,i,a=this.hot,l=a.rowIndexMapper,s=a.columnIndexMapper;o=0===e?l.getNearestNotHiddenIndex(t,1):l.getNearestNotHiddenIndex(t+e-1,-1),i=0===r?s.getNearestNotHiddenIndex(n,1):s.getNearestNotHiddenIndex(n+r-1,-1);var u=t>=0?l.getRenderableFromVisualIndex(o):t,c=n>=0?s.getRenderableFromVisualIndex(i):n;return[u,c]}},{key:"onModifyAutofillRange",value:function(t,e){this.autofillCalculations.correctSelectionAreaSize(e);var n=this.autofillCalculations.getDirection(e,t),r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;var o=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return o?(r=this.autofillCalculations.snapDragArea(e,r,n,o),r):r}},{key:"onAfterCreateCol",value:function(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}},{key:"onAfterRemoveCol",value:function(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}},{key:"onAfterCreateRow",value:function(t,e,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",t,e)}},{key:"onAfterRemoveRow",value:function(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}},{key:"onAfterChange",value:function(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}},{key:"onBeforeDrawAreaBorders",value:function(t,e){if(e&&"area"===e){var n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);U(r,(function(e){n.getBottomEndCorner().row===e.getLastRow()&&n.getBottomEndCorner().col===e.getLastColumn()&&(t[2]=e.row,t[3]=e.col)}))}}},{key:"onAfterModifyTransformStart",value:function(t,e,n){if(this.enabled){var r=this.mergedCellsCollection.get(t.row,t.col);if(r){var o=e>0,i=e<0,a=n<0,l=n>0,s=r.row+r.rowspan-1===this.hot.countRows()-1,u=0===r.row,c=r.col+r.colspan-1===this.hot.countCols()-1,f=0===r.col;(o&&s||i&&u||l&&c||a&&f)&&(t.row=r.row,t.col=r.col)}}}},{key:"onAfterDrawSelection",value:function(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return lnt}},{key:"PLUGIN_PRIORITY",get:function(){return snt}}]),n}(jH);function hnt(t){return mnt(t)||vnt(t)||pnt(t)||dnt()}function dnt(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pnt(t,e){if(t){if("string"===typeof t)return ynt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ynt(t,e):void 0}}function ynt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function vnt(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function mnt(t){if(Array.isArray(t))return t}function gnt(t,e){return function(n,r){var o=hnt(n),i=o.slice(1),a=hnt(r),l=a.slice(1);return function n(r){var o=t[r],a=e[r],s=i[r],u=l[r],c=a.multiColumnSorting,f=c.compareFunctionFactory?c.compareFunctionFactory:AV(a.type),h=f(o,a,c)(s,u);if(h===fV){var d=r+1;if("undefined"!==typeof e[d])return n(d)}return h}(0)}}function bnt(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function wnt(){Un($t(ant||(ant=bnt(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var Snt="sort";function Cnt(t,e,n){var r=[];return!1===n||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push("".concat(Snt,"-").concat(t.getIndexOfColumnInSortQueue(e)+1)),r}function Ont(t){var e=t.className.split(" "),n=new RegExp("^".concat(Snt,"-[0-9]{1,2}$"));return e.filter((function(t){return n.test(t)}))}function knt(t){return knt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},knt(t)}function Rnt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ent(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Tnt(r.key),r)}}function Pnt(t,e,n){return e&&Ent(t.prototype,e),n&&Ent(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tnt(t){var e=jnt(t,"string");return"symbol"===knt(e)?e:String(e)}function jnt(t,e){if("object"!==knt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==knt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ant(){return Ant="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Mnt(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ant.apply(this,arguments)}function Mnt(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Lnt(t),null===t)break;return t}function Int(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xnt(t,e)}function xnt(t,e){return xnt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},xnt(t,e)}function _nt(t){var e=Dnt();return function(){var n,r=Lnt(t);if(e){var o=Lnt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Hnt(this,n)}}function Hnt(t,e){if(e&&("object"===knt(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Nnt(t)}function Nnt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Dnt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Lnt(t){return Lnt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Lnt(t)}var Bnt="multiColumnSorting",Vnt=170,Fnt="append",Wnt="columnSorting";TV(Bnt,gnt);var Unt=function(t){Int(n,t);var e=_nt(n);function n(t){var r;return Rnt(this,n),r=e.call(this,t),r.pluginKey=Bnt,r}return Pnt(n,[{key:"isEnabled",value:function(){return Ant(Lnt(n.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Wnt]&&wnt(),Ant(Lnt(n.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ant(Lnt(n.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(t){Ant(Lnt(n.prototype),"sort",this).call(this,t)}},{key:"clearSort",value:function(){Ant(Lnt(n.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Ant(Lnt(n.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(t){return Ant(Lnt(n.prototype),"getSortConfig",this).call(this,t)}},{key:"setSortConfig",value:function(t){Ant(Lnt(n.prototype),"setSortConfig",this).call(this,t)}},{key:"getNormalizedSortConfigs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}},{key:"updateHeaderClasses",value:function(t){for(var e,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];(e=Ant(Lnt(n.prototype),"updateHeaderClasses",this)).call.apply(e,[this,t].concat(o)),Ye(t,Ont(t)),!1!==this.enabled&&Ge(t,Cnt.apply(void 0,o))}},{key:"onUpdateSettings",value:function(t){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Wnt]&&wnt(),Ant(Lnt(n.prototype),"onUpdateSettings",this).call(this,t)}},{key:"onAfterOnCellMouseDown",value:function(t,e){!1!==nV(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,Fnt))):this.sort(this.getColumnNextConfig(e.col)))}}],[{key:"PLUGIN_KEY",get:function(){return Bnt}},{key:"PLUGIN_PRIORITY",get:function(){return Vnt}}]),n}(vF);function znt(t){return znt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},znt(t)}function Gnt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ynt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Xnt(r.key),r)}}function Knt(t,e,n){return e&&Ynt(t.prototype,e),n&&Ynt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Xnt(t){var e=$nt(t,"string");return"symbol"===znt(e)?e:String(e)}function $nt(t,e){if("object"!==znt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==znt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function qnt(){return qnt="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Qnt(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},qnt.apply(this,arguments)}function Qnt(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=ort(t),null===t)break;return t}function Jnt(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Znt(t,e)}function Znt(t,e){return Znt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Znt(t,e)}function trt(t){var e=rrt();return function(){var n,r=ort(t);if(e){var o=ort(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ert(this,n)}}function ert(t,e){if(e&&("object"===znt(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return nrt(t)}function nrt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rrt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function ort(t){return ort=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ort(t)}var irt="multipleSelectionHandles",art=160,lrt=function(t){Jnt(n,t);var e=trt(n);function n(t){var r;return Gnt(this,n),r=e.call(this,t),r.dragged=[],r.eventManager=null,r.lastSetCell=null,r}return Knt(n,[{key:"isEnabled",value:function(){return Ht()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Gr(this)),this.registerListeners(),qnt(ort(n.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var t=this,e=this,n=this.hot.rootElement;function r(t){if(1===e.dragged.length)return e.dragged.splice(0,e.dragged.length),!0;var n=e.dragged.indexOf(t);if(-1===n)return!1;0===n?e.dragged=e.dragged.slice(0,1):1===n&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",(function(t){var n;return ze(t.target,"topSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):ze(t.target,"bottomSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchend",(function(t){return ze(t.target,"topSelectionHandle-HitArea")?(r.call(e,"top"),e.touchStartRange=void 0,t.preventDefault(),!1):ze(t.target,"bottomSelectionHandle-HitArea")?(r.call(e,"bottom"),e.touchStartRange=void 0,t.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchmove",(function(n){var r,o,i,a,l,s,u=t.hot.rootDocument;if(0!==e.dragged.length){var c=u.elementFromPoint(n.touches[0].clientX,n.touches[0].clientY);c&&c!==e.lastSetCell&&("TD"!==c.nodeName&&"TH"!==c.nodeName||(r=e.hot.getCoords(c),-1===r.col&&(r.col=0),o=e.hot.getSelectedRangeLast(),i=o.getWidth(),a=o.getHeight(),l=o.getDirection(),1===i&&1===a&&e.hot.selection.setRangeEnd(r),s=e.getCurrentRangeCoords(o,r,e.touchStartRange.direction,l,e.dragged[0]),null!==s.start&&e.hot.selection.setRangeStart(s.start),e.hot.selection.setRangeEnd(s.end),e.lastSetCell=c),n.preventDefault())}}))}},{key:"getCurrentRangeCoords",value:function(t,e,n,r,o){var i=t.getTopStartCorner(),a=t.getBottomEndCorner(),l=t.getBottomStartCorner(),s=t.getTopEndCorner(),u={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":u="top"===o?{start:this.hot._createCellCoords(e.row,t.highlight.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,i.col)};break;case"SE-NW":"bottom"===o&&(u={start:this.hot._createCellCoords(a.row,e.col),end:this.hot._createCellCoords(e.row,i.col)});break;default:break}break;case"NW-SE":switch(r){case"NE-SW":"top"===o?u={start:e,end:l}:u.end=e;break;case"NW-SE":"top"===o?u={start:e,end:a}:u.end=e;break;case"SE-NW":"top"===o?u={start:e,end:i}:u.end=e;break;case"SW-NE":"top"===o?u={start:e,end:s}:u.end=e;break;default:break}break;case"SW-NE":switch(r){case"NW-SE":u="bottom"===o?{start:this.hot._createCellCoords(e.row,i.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(i.row,e.col),end:this.hot._createCellCoords(e.row,a.col)};break;case"SW-NE":u="top"===o?{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,a.col)}:{start:this.hot._createCellCoords(e.row,i.col),end:this.hot._createCellCoords(i.row,e.col)};break;case"SE-NW":"bottom"===o?u={start:this.hot._createCellCoords(e.row,s.col),end:this.hot._createCellCoords(i.row,e.col)}:"top"===o&&(u={start:l,end:e});break;default:break}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"top"===o&&(u.end=e);break;case"SE-NW":"top"===o?u.end=e:u={start:e,end:i};break;default:break}break;default:break}return u}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return irt}},{key:"PLUGIN_PRIORITY",get:function(){return art}}]),n}(jH);function srt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.label,n=void 0===e?"":e,r=t.colspan,o=void 0===r?1:r,i=t.origColspan,a=void 0===i?1:i,l=t.collapsible,s=void 0!==l&&l,u=t.crossHiddenColumns,c=void 0===u?[]:u,f=t.isCollapsed,h=void 0!==f&&f,d=t.isHidden,p=void 0!==d&&d,y=t.isRoot,v=void 0!==y&&y,m=t.isPlaceholder,g=void 0!==m&&m;return{label:n,colspan:o,origColspan:a,collapsible:s,isCollapsed:h,crossHiddenColumns:c,isHidden:p,isRoot:v,isPlaceholder:g}}function urt(){return{label:"",isPlaceholder:!0}}function crt(t){return prt(t)||drt(t)||hrt(t)||frt()}function frt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function hrt(t,e){if(t){if("string"===typeof t)return yrt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yrt(t,e):void 0}}function drt(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function prt(t){if(Array.isArray(t))return yrt(t)}function yrt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function vrt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=[];if(0===e)return n;U(t,(function(t){var r=[],o=0;n.push(r),U(t,(function(t){var n=srt();if(ht(t)){var i=t.label,a=t.colspan;n.label=Jt(i),"number"===typeof a&&a>1&&(n.colspan=a,n.origColspan=a)}else n.label=Jt(t);o+=n.origColspan;var l=!1;if(o>=e&&(n.colspan=n.origColspan-(o-e),n.origColspan=n.colspan,l=!0),r.push(n),n.colspan>1)for(var s=0;s<n.colspan-1;s++)r.push(urt());return!l}))}));var r=Math.max.apply(Math,crt(W(n,(function(t){return t.length}))));return U(n,(function(t){if(t.length<r){var e=W(new Array(r-t.length),(function(){return srt()}));t.splice.apply(t,[t.length,0].concat(crt(e)))}})),n}function mrt(t){return mrt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mrt(t)}var grt=["row","col"];function brt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function wrt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?brt(Object(n),!0).forEach((function(e){Srt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):brt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Srt(t,e,n){return e=Prt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Crt(t,e){if(null==t)return{};var n,r,o=Ort(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function Ort(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function krt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rrt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Prt(r.key),r)}}function Ert(t,e,n){return e&&Rrt(t.prototype,e),n&&Rrt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Prt(t){var e=Trt(t,"string");return"symbol"===mrt(e)?e:String(e)}function Trt(t,e){if("object"!==mrt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==mrt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function jrt(t,e,n){Art(t,e),e.set(t,n)}function Art(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mrt(t,e){var n=_rt(t,e,"get");return Irt(t,n)}function Irt(t,e){return e.get?e.get.call(t):e.value}function xrt(t,e,n){var r=_rt(t,e,"set");return Hrt(t,r,n),n}function _rt(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Hrt(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Nrt=["label","collapsible"],Drt=new WeakMap,Lrt=new WeakMap,Brt=new WeakMap,Vrt=function(){function t(){krt(this,t),jrt(this,Drt,{writable:!0,value:[]}),jrt(this,Lrt,{writable:!0,value:0}),jrt(this,Brt,{writable:!0,value:1/0})}return Ert(t,[{key:"setColumnsLimit",value:function(t){xrt(this,Brt,t)}},{key:"setData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];xrt(this,Drt,vrt(t,Mrt(this,Brt))),xrt(this,Lrt,Mrt(this,Drt).length)}},{key:"getData",value:function(){return Mrt(this,Drt)}},{key:"mergeWith",value:function(t){var e=this;U(t,(function(t){var n=t.row,r=t.col,o=Crt(t,grt),i=e.getHeaderSettings(n,r);null!==i&&at(i,o,Nrt)}))}},{key:"map",value:function(t){U(Mrt(this,Drt),(function(e){U(e,(function(e){var n=t(wrt({},e));ht(n)&&at(e,n,Nrt)}))}))}},{key:"getHeaderSettings",value:function(t,e){var n;if(t>=Mrt(this,Lrt)||t<0)return null;var r=Mrt(this,Drt)[t];return e>=r.length?null:null!==(n=r[e])&&void 0!==n?n:null}},{key:"getHeadersSettings",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=[];if(t>=Mrt(this,Lrt)||t<0)return r;for(var o=Mrt(this,Drt)[t],i=0,a=e;a<o.length;a++){var l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(i+=l.colspan,r.push(l),l.colspan>1&&(a+=l.colspan-1),i===n)break;if(i>n)throw new Error("The last column settings cannot overlap the other header layers")}return r}},{key:"getLayersCount",value:function(){return Mrt(this,Lrt)}},{key:"getColumnsCount",value:function(){return Mrt(this,Lrt)>0?Mrt(this,Drt)[0].length:0}},{key:"clear",value:function(){xrt(this,Drt,[]),xrt(this,Lrt,0)}}]),t}();function Frt(t){return Frt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Frt(t)}function Wrt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Urt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Wrt(Object(n),!0).forEach((function(e){Krt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wrt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function zrt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Grt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Xrt(r.key),r)}}function Yrt(t,e,n){return e&&Grt(t.prototype,e),n&&Grt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Krt(t,e,n){return e=Xrt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xrt(t){var e=$rt(t,"string");return"symbol"===Frt(e)?e:String(e)}function $rt(t,e){if("object"!==Frt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Frt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function qrt(t){return tot(t)||Zrt(t)||Jrt(t)||Qrt()}function Qrt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Jrt(t,e){if(t){if("string"===typeof t)return eot(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eot(t,e):void 0}}function Zrt(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function tot(t){if(Array.isArray(t))return eot(t)}function eot(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var not="DF-pre-order";function rot(t,e){for(var n=t.call(e,this),r=0;r<this.childs.length;r++){if(!1===n)return!1;n=rot.call(this.childs[r],t,e)}return n}var oot="DF-post-order";function iot(t,e){for(var n=0;n<this.childs.length;n++){var r=iot.call(this.childs[n],t,e);if(!1===r)return!1}return t.call(e,this)}var aot="BF";function lot(t,e){var n=[this];function r(){if(0!==n.length){var o=n.shift();n.push.apply(n,qrt(o.childs)),!1!==t.call(e,o)&&r()}}r()}var sot=aot,uot=new Map([[not,rot],[oot,iot],[aot,lot]]),cot=function(){function t(e){zrt(this,t),Krt(this,"data",{}),Krt(this,"parent",null),Krt(this,"childs",[]),this.data=e}return Yrt(t,[{key:"addChild",value:function(t){t.parent=this,this.childs.push(t)}},{key:"cloneTree",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=new t(Urt({},e.data)),r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}},{key:"replaceTreeWith",value:function(t){this.data=Urt({},t.data),this.childs=[];for(var e=0;e<t.childs.length;e++)this.addChild(t.childs[e])}},{key:"walkDown",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sot;if(!uot.has(e))throw new Error('Traversal strategy "'.concat(e,'" does not exist'));uot.get(e).call(this,t,this)}},{key:"walkUp",value:function(t){var e=this,n=function n(r){var o=t.call(e,r);!1!==o&&null!==r.parent&&n(r.parent)};n(this)}}]),t}();function fot(t){return fot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fot(t)}function hot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function dot(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?hot(Object(n),!0).forEach((function(e){pot(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):hot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function pot(t,e,n){return e=kot(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yot(t,e){return wot(t)||bot(t,e)||mot(t,e)||vot()}function vot(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function mot(t,e){if(t){if("string"===typeof t)return got(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?got(t,e):void 0}}function got(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function bot(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function wot(t){if(Array.isArray(t))return t}function Sot(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kot(r.key),r)}}function Oot(t,e,n){return e&&Cot(t.prototype,e),n&&Cot(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function kot(t){var e=Rot(t,"string");return"symbol"===fot(e)?e:String(e)}function Rot(t,e){if("object"!==fot(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==fot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Eot(t,e,n){Pot(t,e),e.set(t,n)}function Pot(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tot(t,e){var n=Mot(t,e,"get");return jot(t,n)}function jot(t,e){return e.get?e.get.call(t):e.value}function Aot(t,e,n){var r=Mot(t,e,"set");return Iot(t,r,n),n}function Mot(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Iot(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var xot,_ot,Hot=new WeakMap,Not=new WeakMap,Dot=new WeakMap,Lot=function(){function t(e){Sot(this,t),Eot(this,Hot,{writable:!0,value:new Map}),Eot(this,Not,{writable:!0,value:new Map}),Eot(this,Dot,{writable:!0,value:null}),Aot(this,Dot,e)}return Oot(t,[{key:"getRoots",value:function(){return Array.from(Tot(this,Hot).values())}},{key:"getRootByColumn",value:function(t){var e;return Tot(this,Not).has(t)&&(e=Tot(this,Hot).get(Tot(this,Not).get(t))),e}},{key:"getNode",value:function(t,e){var n=this.getRootByColumn(e);if(n){var r,o=e-Tot(this,Not).get(e),i=0;return n.walkDown((function(n){var a=n.data,l=a.origColspan,s=a.headerLevel;if(t===s){if(o>=i&&o<=i+l-1)return r=n,r.data.isRoot=e===r.data.columnIndex,!1;i+=l}})),r}}},{key:"rebuildTreeIndex",value:function(){var t=this,e=0;Tot(this,Not).clear(),U(Tot(this,Hot),(function(n){for(var r=yot(n,2),o=r[1].data.colspan,i=e;i<e+o;i++)Tot(t,Not).set(i,e);e+=o}))}},{key:"buildTree",value:function(){this.clear();var t=Tot(this,Dot).getColumnsCount(),e=0;while(e<t){var n=Tot(this,Dot).getHeaderSettings(0,e),r=new cot;Tot(this,Hot).set(e,r),this.buildLeaves(r,e,0,n.origColspan),e+=n.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(t,e,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=Tot(this,Dot).getHeadersSettings(n,e,o);n+=1,U(i,(function(o){var i,a=dot(dot({},o),{},{headerLevel:n-1,columnIndex:e});1===n?(t.data=a,i=t):(i=new cot(a),t.addChild(i)),n<Tot(r,Dot).getLayersCount()&&r.buildLeaves(i,e,n,o.origColspan),e+=o.origColspan}))}},{key:"clear",value:function(){Tot(this,Hot).clear(),Tot(this,Not).clear()}}]),t}();function Bot(t,e){t.walkDown((function(t){var n=t.data,r=t.childs;if(!n.isHidden&&(e(n.columnIndex),0===r.length))for(var o=1;o<n.colspan;o++)e(n.columnIndex+o)}))}function Vot(t,e){var n=t.childs;if(0!==n.length)return n[0].data[e]}function Fot(t){return Vot(t,"origColspan")===t.data.origColspan}function Wot(t){var e=t.data,n=t.childs;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var r=Fot(t);if(r)return Wot(n[0]);e.isCollapsed=!1;var o=n.slice(1),i=new Set,a=0;if(o.length>0)U(o,(function(t){t.replaceTreeWith(t.data.clonedTree),t.data.clonedTree=null;var e=t.data;a+=e.colspan,Bot(t,(function(t){i.add(t)}))}));else{var l=e.colspan,s=e.origColspan,u=e.columnIndex;a=s-l;for(var c=1;c<s;c++)i.add(u+c)}return t.walkUp((function(t){var e=t.data;e.colspan+=a,e.colspan>=e.origColspan?(e.colspan=e.origColspan,e.isCollapsed=!1):Fot(t)&&(e.isCollapsed=Vot(t,"isCollapsed"))})),{rollbackModification:function(){return Uot(t)},affectedColumns:Array.from(i),colspanCompensation:a}}function Uot(t){var e,n=t.data,r=t.childs;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=Fot(t);if(o)return Uot(r[0]);n.isCollapsed=!0;var i=r.slice(1),a=new Set;if(i.length>0)U(i,(function(t){Bot(t,(function(t){a.add(t)})),t.data.clonedTree=t.cloneTree(),t.walkDown((function(t){var e=t.data;e.isHidden=!0}))}));else for(var l=n.origColspan,s=n.columnIndex,u=1;u<l;u++){var c=s+u;a.add(c)}var f=n.colspan-(null!==(e=Vot(t,"colspan"))&&void 0!==e?e:1);return t.walkUp((function(t){var e=t.data;e.colspan-=f,e.colspan<=1?(e.colspan=1,e.isCollapsed=!0):Fot(t)&&(e.isCollapsed=Vot(t,"isCollapsed"))})),{rollbackModification:function(){return Wot(t)},affectedColumns:Array.from(a),colspanCompensation:f}}function zot(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Got(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error($t(xot||(xot=zot(["The passed node is not the last node on the tree. Only for \nthe last node, the hide column modification can be applied."],["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the hide column modification can be applied."]))));var n=t.data.crossHiddenColumns;if(!n.includes(e)){var r=!1;t.walkUp((function(t){var e=t.data.collapsible;if(e)return r=!0,!1})),r||t.walkUp((function(t){var n=t.data;n.crossHiddenColumns.push(e),n.colspan>1?n.colspan-=1:n.isHidden=!0}))}}function Yot(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Kot(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error($t(_ot||(_ot=Yot(["The passed node is not the last node on the tree. Only for \nthe last node, the show column modification can be applied."],["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the show column modification can be applied."]))));var n=t.data.crossHiddenColumns;if(n.includes(e)){var r=!1;t.walkUp((function(t){var e=t.data.collapsible;if(e)return r=!0,!1})),r||t.walkUp((function(t){var n=t.data;n.crossHiddenColumns.splice(n.crossHiddenColumns.indexOf(e),1),!n.isHidden&&n.colspan<n.origColspan&&(n.colspan+=1),n.isHidden=!1}))}}var Xot=new Map([["collapse",Uot],["expand",Wot],["hide-column",Got],["show-column",Kot]]);function $ot(t,e,n){if(!Xot.has(t))throw new Error('The node modifier action ("'.concat(t,'") does not exist.'));return Xot.get(t)(e,n)}var qot=["crossHiddenColumns"];function Qot(t,e){if(null==t)return{};var n,r,o=Jot(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function Jot(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function Zot(t){var e=[];return U(t,(function(t){t.walkDown((function(t){for(var n=t.data,r=n.origColspan,o=n.columnIndex,i=n.headerLevel,a=n.crossHiddenColumns,l=eit(e,i),s=!1,u=o;u<o+r;u++){var c=a.includes(u);if(c||s)l.push(urt(n));else{var f=tit(n);f.isRoot=!0,l.push(f),s=!0}}}))})),e}function tit(t){var e=srt(t),n=(e.crossHiddenColumns,Qot(e,qot));return n}function eit(t,e){var n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function nit(t){return nit="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nit(t)}var rit=["row"];function oit(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function iit(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?oit(Object(n),!0).forEach((function(e){ait(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oit(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ait(t,e,n){return e=hit(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lit(t,e){if(null==t)return{};var n,r,o=sit(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function sit(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function uit(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cit(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,hit(r.key),r)}}function fit(t,e,n){return e&&cit(t.prototype,e),n&&cit(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function hit(t){var e=dit(t,"string");return"symbol"===nit(e)?e:String(e)}function dit(t,e){if("object"!==nit(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==nit(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function pit(t,e,n){yit(t,e),e.set(t,n)}function yit(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vit(t,e,n){var r=bit(t,e,"set");return mit(t,r,n),n}function mit(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function git(t,e){var n=bit(t,e,"get");return wit(t,n)}function bit(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function wit(t,e){return e.get?e.get.call(t):e.value}var Sit=new WeakMap,Cit=new WeakMap,Oit=new WeakMap,kit=function(){function t(){uit(this,t),pit(this,Sit,{writable:!0,value:new Vrt}),pit(this,Cit,{writable:!0,value:new Lot(git(this,Sit))}),pit(this,Oit,{writable:!0,value:[[]]})}return fit(t,[{key:"setState",value:function(t){git(this,Sit).setData(t);var e=!1;try{git(this,Cit).buildTree()}catch(n){git(this,Cit).clear(),git(this,Sit).clear(),e=!0}return vit(this,Oit,Zot(git(this,Cit).getRoots())),e}},{key:"setColumnsLimit",value:function(t){git(this,Sit).setColumnsLimit(t)}},{key:"mergeStateWith",value:function(t){var e=this,n=W(t,(function(t){var n=t.row,r=lit(t,rit);return iit({row:n<0?e.rowCoordsToLevel(n):n},r)}));git(this,Sit).mergeWith(n),git(this,Cit).buildTree(),vit(this,Oit,Zot(git(this,Cit).getRoots()))}},{key:"mapState",value:function(t){git(this,Sit).map(t),git(this,Cit).buildTree(),vit(this,Oit,Zot(git(this,Cit).getRoots()))}},{key:"mapNodes",value:function(t){return V(git(this,Cit).getRoots(),(function(e,n){return n.walkDown((function(n){var r=t(n.data);void 0!==r&&e.push(r)})),e}),[])}},{key:"triggerNodeModification",value:function(t,e,n){e<0&&(e=this.rowCoordsToLevel(e));var r,o=git(this,Cit).getNode(e,n);return o&&(r=$ot(t,o,n),vit(this,Oit,Zot(git(this,Cit).getRoots()))),r}},{key:"triggerColumnModification",value:function(t,e){return this.triggerNodeModification(t,-1,e)}},{key:"rowCoordsToLevel",value:function(t){if(t>=0)return null;var e=t+Math.max(this.getLayersCount(),1);return e<0?null:e}},{key:"levelToRowCoords",value:function(t){if(t<0)return null;var e=t-Math.max(this.getLayersCount(),1);return e>=0?null:e}},{key:"getHeaderSettings",value:function(t,e){var n,r;return t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount()?null:null!==(n=null===(r=git(this,Oit)[t])||void 0===r?void 0:r[e])&&void 0!==n?n:null}},{key:"getHeaderTreeNodeData",value:function(t,e){if(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())return null;var n=git(this,Cit).getNode(t,e);return n?iit({},n.data):null}},{key:"findLeftMostColumnIndex",value:function(t,e){var n,r=null!==(n=this.getHeaderSettings(t,e))&&void 0!==n?n:{isRoot:!0},o=r.isRoot;if(o)return e;var i=e-1;while(i>=0){var a,l=null!==(a=this.getHeaderSettings(t,i))&&void 0!==a?a:{isRoot:!0},s=l.isRoot;if(s)break;i-=1}return i}},{key:"getLayersCount",value:function(){return git(this,Sit).getLayersCount()}},{key:"getColumnsCount",value:function(){return git(this,Sit).getColumnsCount()}},{key:"clear",value:function(){vit(this,Oit,[]),git(this,Sit).clear(),git(this,Cit).clear()}}]),t}();function Rit(t){return Rit="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rit(t)}function Eit(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pit(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ait(r.key),r)}}function Tit(t,e,n){return e&&Pit(t.prototype,e),n&&Pit(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function jit(t,e,n){return e=Ait(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ait(t){var e=Mit(t,"string");return"symbol"===Rit(e)?e:String(e)}function Mit(t,e){if("object"!==Rit(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Rit(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Iit,xit,_it=function(){function t(e,n){Eit(this,t),jit(this,"hot",void 0),jit(this,"nestedHeaderSettingsGetter",void 0),jit(this,"layersCount",0),jit(this,"container",void 0),jit(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return Tit(t,[{key:"setLayersCount",value:function(t){return this.layersCount=t,this}},{key:"getWidth",value:function(t){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length;this.widthsMap.clear();for(var n=0;n<e;n++){var r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),o=this.hot.toPhysicalColumn(r);this.widthsMap.setValueAtIndex(o,t[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(t){for(var e=this.hot,n=e.rootDocument,r=e.columnIndexMapper,o=n.createDocumentFragment(),i=n.createElement("table"),a=!!this.hot.getSettings().dropdownMenu,l=r.getRenderableIndexesLength(),s=0;s<this.layersCount;s++){for(var u=n.createElement("tr"),c=0;c<l;c++){var f=r.getVisualFromRenderableIndex(c);null===f&&(f=c);var h=n.createElement("th"),d=this.nestedHeaderSettingsGetter(s,f);if(d&&(!d.isPlaceholder||d.isHidden)){var p=d.label;a&&(p+='<button class="changeType"></button>'),Qe(h,p),h.colSpan=d.colspan,u.appendChild(h)}}i.appendChild(u)}o.appendChild(i),t.appendChild(o)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),t}(),Hit=_it;function Nit(t){return Nit="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nit(t)}function Dit(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Lit(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bit(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Qit(r.key),r)}}function Vit(t,e,n){return e&&Bit(t.prototype,e),n&&Bit(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fit(){return Fit="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Wit(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Fit.apply(this,arguments)}function Wit(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=$it(t),null===t)break;return t}function Uit(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zit(t,e)}function zit(t,e){return zit=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},zit(t,e)}function Git(t){var e=Xit();return function(){var n,r=$it(t);if(e){var o=$it(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Yit(this,n)}}function Yit(t,e){if(e&&("object"===Nit(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Kit(t)}function Kit(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xit(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function $it(t){return $it=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$it(t)}function qit(t,e,n){return e=Qit(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qit(t){var e=Jit(t,"string");return"symbol"===Nit(e)?e:String(e)}function Jit(t,e){if("object"!==Nit(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Nit(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Zit(t,e,n){tat(t,e),e.set(t,n)}function tat(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eat(t,e,n){var r=oat(t,e,"set");return nat(t,r,n),n}function nat(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function rat(t,e){var n=oat(t,e,"get");return iat(t,n)}function oat(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function iat(t,e){return e.get?e.get.call(t):e.value}var aat="nestedHeaders",lat=280,sat=new WeakMap,uat=new WeakMap,cat=function(t){Uit(n,t);var e=Git(n);function n(){var t;Lit(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),Zit(Kit(t),sat,{writable:!0,value:new kit}),Zit(Kit(t),uat,{writable:!0,value:null}),qit(Kit(t),"ghostTable",new Hit(t.hot,(function(e,n){return t.getHeaderSettings(e,n)}))),qit(Kit(t),"detectedOverlappedHeaders",!1),t}return Vit(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[aat]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings(),r=e.nestedHeaders;Array.isArray(r)&&Array.isArray(r[0])||Un($t(Iit||(Iit=Dit(["Your Nested Headers plugin configuration is invalid. The settings has to be \n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"],["Your Nested Headers plugin configuration is invalid. The settings has to be\\x20\n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"])))),this.addHook("init",(function(){return t.onInit()})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)})),this.addHook("afterOnCellMouseDown",(function(){return t.onAfterOnCellMouseDown.apply(t,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return t.onBeforeOnCellMouseOver.apply(t,arguments)})),this.addHook("afterGetColumnHeaderRenderers",(function(e){return t.onAfterGetColumnHeaderRenderers(e)})),this.addHook("modifyColWidth",(function(){return t.onModifyColWidth.apply(t,arguments)})),this.addHook("modifyColumnHeaderValue",(function(){return t.onModifyColumnHeaderValue.apply(t,arguments)})),this.addHook("beforeHighlightingColumnHeader",(function(){return t.onBeforeHighlightingColumnHeader.apply(t,arguments)})),this.addHook("beforeCopy",(function(){return t.onBeforeCopy.apply(t,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return t.onAfterViewportColumnCalculatorOverride.apply(t,arguments)})),Fit($it(n.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var t=this;if(this.hot.view){var e=this.hot.getSettings(),r=e.nestedHeaders;rat(this,sat).setColumnsLimit(this.hot.countCols()),Array.isArray(r)&&(this.detectedOverlappedHeaders=rat(this,sat).setState(r)),this.detectedOverlappedHeaders&&Un($t(xit||(xit=Dit(["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration \n                        is currently not supported."],["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20\n                        is currently not supported."])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((function(e,n){var r=!0===e?"hide-column":"show-column";rat(t,sat).triggerColumnModification(r,n)})),!rat(this,uat)&&this.enabled&&eat(this,uat,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((function(e){e.forEach((function(e){var n=e.op,r=e.index,o=e.newValue;if("replace"===n){var i=!0===o?"hide-column":"show-column";rat(t,sat).triggerColumnModification(i,r)}})),t.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),Fit($it(n.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),rat(this,sat).clear(),rat(this,uat).unsubscribe(),eat(this,uat,null),this.ghostTable.clear(),Fit($it(n.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return rat(this,sat)}},{key:"getLayersCount",value:function(){return rat(this,sat).getLayersCount()}},{key:"getHeaderSettings",value:function(t,e){return rat(this,sat).getHeaderSettings(t,e)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var t=this.hot.view._wt,e=t.getSetting("columnHeaders").length,n=t.wtTable.THEAD,r=t.wtOverlays.topOverlay.clone.wtTable.THEAD,o=t.wtOverlays.topInlineStartCornerOverlay?t.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=0;i<e;i++){var a=n.childNodes[i];if(!a)break;for(var l=r.childNodes[i],s=o?o.childNodes[i]:null,u=0,c=a.childNodes.length;u<c;u++)a.childNodes[u].removeAttribute("colspan"),Ye(a.childNodes[u],"hiddenHeader"),l&&l.childNodes[u]&&(l.childNodes[u].removeAttribute("colspan"),Ye(l.childNodes[u],"hiddenHeader")),o&&s&&s.childNodes[u]&&(s.childNodes[u].removeAttribute("colspan"),Ye(s.childNodes[u],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(t){var e=this,n=this.hot.view._wt.getSetting("fixedColumnsStart");return function(r,o){var i,a=e.hot,l=a.columnIndexMapper,s=a.view,u=l.getVisualFromRenderableIndex(r);null===u&&(u=r),o.removeAttribute("colspan"),Ye(o,"hiddenHeader");var c=null!==(i=rat(e,sat).getHeaderSettings(t,u))&&void 0!==i?i:{label:""},f=c.colspan,h=c.isHidden,d=c.isPlaceholder;if(d||h)Ge(o,"hiddenHeader");else if(f>1){var p,y,v=s._wt.wtOverlays,m=null===(p=v.topInlineStartCornerOverlay)||void 0===p?void 0:p.clone.wtTable.THEAD.contains(o),g=null===(y=v.inlineStartOverlay)||void 0===y?void 0:y.clone.wtTable.THEAD.contains(o),b=m||g?Math.min(f,n-r):f;b>1&&o.setAttribute("colspan",b)}e.hot.view.appendColHeader(u,o,(function(){return e.getColumnHeaderValue.apply(e,arguments)}),t)}}},{key:"getColumnHeaderValue",value:function(t,e){var n,r=null!==(n=rat(this,sat).getHeaderSettings(e,t))&&void 0!==n?n:{},o=r.isHidden,i=r.isPlaceholder;return i||o?"":this.hot.getColHeader(t,e)}},{key:"onBeforeHighlightingColumnHeader",value:function(t,e,n){var r=rat(this,sat).getHeaderTreeNodeData(e,t);if(!r)return t;var o=n.classNames,i=n.columnCursor,a=n.selectionType,l=n.selectionWidth,s=rat(this,sat).getHeaderSettings(e,t),u=s.isRoot,c=s.colspan;if(a===TC){if(!u)return r.columnIndex}else a===kC&&(c>l-i||!u)&&(o.length=0);return t}},{key:"onBeforeCopy",value:function(t,e,n){var r=n.columnHeadersCount;if(0!==r)for(var o=0;o<e.length;o++){var i=e[o],a=i.startRow,l=i.startCol,s=i.endRow,u=i.endCol,c=s-a+1,f=l-u+1;if(a>=0||1===f)break;for(var h=l;h<=u;h++)for(var d=a;d<=s;d++){var p,y=c+d,v=h-l;if(0!==v){var m=null===(p=rat(this,sat).getHeaderTreeNodeData(d,h))||void 0===p?void 0:p.isRoot;!1===m&&(t[y][v]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){var o=this._getHeaderTreeNodeDataByCoords(e);o&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(t,e){var n=this._getHeaderTreeNodeDataByCoords(e);if(n){var r=this.hot.selection,o=r.isSelected()?r.getSelectedRange().current():null,i=[],a=n.columnIndex,l=n.origColspan,s=!r.inInSelection(e);t.shiftKey&&o?e.col<o.from.col?i.push(o.getTopEndCorner().col,a,e.row):e.col>o.from.col?i.push(o.getTopStartCorner().col,a+l-1,e.row):i.push(a,a+l-1,e.row):(nr(t)||er(t)&&s)&&i.push(a,a+l-1,e.row),r.selectColumns.apply(r,i)}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){var o;if(this.hot.view.isMouseDown()){var i=this._getHeaderTreeNodeDataByCoords(e);if(i){var a=i.columnIndex,l=i.origColspan,s=this.hot.getSelectedRangeLast(),u=s.getTopStartCorner(),c=s.getBottomEndCorner(),f=s.from;r.column=!0,r.cell=!0;var h=[];e.col<f.col?h.push(c.col,a):e.col>f.col?h.push(u.col,a+l-1):h.push(a,a+l-1),(o=this.hot).selectColumns.apply(o,h)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(t){t.length=0;for(var e=0;e<rat(this,sat).getLayersCount();e++)t.push(this.headerRendererFactory(e))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(t){for(var e=rat(this,sat).getLayersCount(),n=t.startColumn,r=!!e,o=0;o<e;o++){var i=rat(this,sat).findLeftMostColumnIndex(o,t.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(i);if(i>=0&&(r=!1),Ao(a)&&a<t.startColumn){n=a;break}}t.startColumn=r?rat(this,sat).getHeaderTreeNodeData(0,n).columnIndex:n}},{key:"onModifyColWidth",value:function(t,e){var n=this.ghostTable.getWidth(e);return t>n?t:n}},{key:"onModifyColumnHeaderValue",value:function(t,e,n){var r,o=null!==(r=rat(this,sat).getHeaderTreeNodeData(n,e))&&void 0!==r?r:{label:""},i=o.label;return i}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(t,e){e||this.updatePlugin()}},{key:"destroy",value:function(){eat(this,sat,null),null!==rat(this,uat)&&(rat(this,uat).unsubscribe(),eat(this,uat,null)),Fit($it(n.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(t){if(!(t.row>=0||t.col<0))return rat(this,sat).getHeaderTreeNodeData(t.row,t.col)}}],[{key:"PLUGIN_KEY",get:function(){return aat}},{key:"PLUGIN_PRIORITY",get:function(){return lat}}]),n}(jH);function fat(t){return yat(t)||pat(t)||dat(t)||hat()}function hat(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function dat(t,e){if(t){if("string"===typeof t)return vat(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vat(t,e):void 0}}function pat(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function yat(t){if(Array.isArray(t))return vat(t)}function vat(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function mat(t){return mat="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mat(t)}function gat(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bat(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Sat(r.key),r)}}function wat(t,e,n){return e&&bat(t.prototype,e),n&&bat(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Sat(t){var e=Cat(t,"string");return"symbol"===mat(e)?e:String(e)}function Cat(t,e){if("object"!==mat(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==mat(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Oat=function(){function t(e,n){gat(this,t),this.hot=n,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return wat(t,[{key:"setData",value:function(t){this.data=t}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var t=null;return this.plugin.disableCoreAPIModifiers(),t=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),t}},{key:"updateWithData",value:function(t){this.setData(t),this.rewriteCache()}},{key:"rewriteCache",value:function(){var t=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Io(0,this.data.length-1,(function(e){t.cacheNode(t.data[e],0,null)}))}},{key:"cacheNode",value:function(t,e,n){var r=this;this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:n,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&U(t.__children,(function(n){r.cacheNode(n,e+1,t)}))}},{key:"getDataObject",value:function(t){return null===t||void 0===t?null:this.cache.rows[t]}},{key:"readTreeNodes",value:function(t,e,n,r){var o=this,i=!1,a=e;if(isNaN(a)&&a.end)return a;var l=t;return l||(l={__children:this.data},i=!0,a-=1),null!==n&&void 0!==n&&a===n?{result:l,end:!0}:null!==r&&void 0!==r&&l===r?{result:a,end:!0}:(a+=1,l.__children&&U(l.__children,(function(t){if(o.parentReference.set(t,i?null:l),a=o.readTreeNodes(t,a,n,r),isNaN(a)&&a.end)return!1})),a)}},{key:"mockParent",value:function(){var t=this.mockNode();return t.__children=this.data,t}},{key:"mockNode",value:function(){var t={};return pt(this.data[0],(function(e,n){t[n]=null})),t}},{key:"getRowIndex",value:function(t){return null===t||void 0===t?null:this.cache.nodeInfo.get(t).row}},{key:"getRowIndexWithinParent",value:function(t){var e=null;e=isNaN(t)?t:this.getDataObject(t);var n=this.getRowParent(t);return null===n||void 0===n?this.data.indexOf(e):n.__children.indexOf(e)}},{key:"countAllRows",value:function(){var t={__children:this.data};return this.countChildren(t)}},{key:"countChildren",value:function(t){var e=this,n=0,r=t;return isNaN(r)||(r=this.getDataObject(r)),r&&r.__children?(U(r.__children,(function(t){n+=1,t.__children&&(n+=e.countChildren(t))})),n):0}},{key:"getRowParent",value:function(t){var e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}},{key:"getRowObjectParent",value:function(t){return t&&"object"===mat(t)?this.cache.nodeInfo.get(t).parent:null}},{key:"getRowLevel",value:function(t){var e=null;return e=isNaN(t)?t:this.getDataObject(t),e?this.getRowObjectLevel(e):null}},{key:"getRowObjectLevel",value:function(t){return null===t||void 0===t?null:this.cache.nodeInfo.get(t).level}},{key:"hasChildren",value:function(t){var e=t;return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)}},{key:"isChild",value:function(t){return null!==this.getRowParent(t)}},{key:"getChild",value:function(t,e){var n;return(null===(n=t.__children)||void 0===n?void 0:n[e])||null}},{key:"isRowHighestLevel",value:function(t){return!this.isChild(t)}},{key:"isParent",value:function(t){var e,n=t;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(e=n.__children)||void 0===e?void 0:e.length)}},{key:"addChild",value:function(t,e){var n=e;this.hot.runHooks("beforeAddChild",t,n);var r=null;t&&(r=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(t)+1,1);var o=t;t||(o=this.mockParent()),o.__children||(o.__children=[]),n||(n=this.mockNode()),o.__children.push(n),this.rewriteCache();var i=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(i,1),this.hot.runHooks("afterCreateRow",i,1),this.hot.runHooks("afterAddChild",t,n)}},{key:"addChildAtIndex",value:function(t,e,n){var r,o=n;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",t,o,e),t){var i=this.getRowIndex(t),a=i+e+1;this.hot.runHooks("beforeCreateRow",a,1),t.__children.splice(e,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),r=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",e,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[e]);o=this.getDataObject(r),this.hot.runHooks("afterAddChild",t,o,e)}},{key:"addSibling",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",n=this.translateTrimmedRow(t),r=this.getRowParent(n),o=this.getRowIndexWithinParent(n);switch(e){case"below":this.addChildAtIndex(r,o+1,null);break;case"above":this.addChildAtIndex(r,o,null);break;default:break}}},{key:"detachFromParent",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=null,o=[];Array.isArray(t)?(Io(t[0],t[2],(function(t){var n=e.translateTrimmedRow(t);o.push(e.getDataObject(n))})),Io(0,o.length-2,(function(t){e.detachFromParent(o[t],!1)})),r=o[o.length-1]):r=t;var i=this.getRowIndex(r),a=this.countChildren(r),l=this.getRowIndexWithinParent(r),s=this.getRowParent(r),u=this.getRowParent(s),c=this.getRowIndex(u),f=null;if(this.hot.runHooks("beforeDetachChild",s,r),null!==l&&void 0!==l){var h=Array.from(new Array(i+a+1).keys()).splice(-1*(a+1));if(this.hot.runHooks("beforeRemoveRow",i,a+1,h,this.plugin.pluginName),s.__children.splice(l,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,a+1,h,this.plugin.pluginName),u){f=c+this.countChildren(u);var d=this.getChild(u,this.countChildren(u)-1),p=this.getRowIndex(d);this.hot.runHooks("beforeCreateRow",p+1,a+1,this.plugin.pluginName),u.__children.push(r)}else f=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",f-2,a+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",f-2,a+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",s,r,this.getRowIndex(r)),n&&this.hot.render()}},{key:"filterData",value:function(t,e,n){var r=this,o=[];U(n,(function(t){o.push(r.getDataObject(t))})),U(o,(function(t){var e=r.getRowIndexWithinParent(t),n=r.getRowParent(t);null===n?r.data.splice(e,1):n.__children.splice(e,1)})),this.rewriteCache()}},{key:"spliceData",value:function(t,e,n){var r,o=this.getDataObject(t-1),i=null,a=t;if(o&&o.__children&&0===o.__children.length?(i=o,a=0):t<this.countAllRows()&&(i=this.getRowParent(t),a=this.getRowIndexWithinParent(t)),i)n?(r=i.__children).splice.apply(r,[a,e].concat(fat(n))):i.__children.splice(a,e);else if(n){var l;(l=this.data).splice.apply(l,[a,e].concat(fat(n)))}else this.data.splice(a,e);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(t){var e=t,n=null;do{n=this.getRowParent(n),null!==n&&(e=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(e),"__children",e.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(t,e,n,r){var o=e===this.hot.countRows(),i=this.getRowParent(t),a=this.getRowIndexWithinParent(t),l=i.__children.slice(a,a+1),s=t>e,u=o?this.getRowParent(e-1):this.getRowParent(e);null!==u&&void 0!==u||(u=this.getRowParent(e-1)),null!==u&&void 0!==u||(u=this.getDataObject(e-1)),u?u.__children||(u.__children=[]):(u=this.getDataObject(e),u.__children=[]);var c=o||n||r?u.__children.length:this.getRowIndexWithinParent(e),f=i===u;u.__children.splice(c,0,l[0]),i.__children.splice(a+(s&&f?1:0),1),this.syncRowWithRawSource(i),f||this.syncRowWithRawSource(u)}},{key:"translateTrimmedRow",value:function(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}},{key:"untranslateTrimmedRow",value:function(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(t):t}}]),t}(),kat=Oat;function Rat(t){return Rat="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rat(t)}function Eat(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Tat(r.key),r)}}function Pat(t,e,n){return e&&Eat(t.prototype,e),n&&Eat(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tat(t){var e=jat(t,"string");return"symbol"===Rat(e)?e:String(e)}function jat(t,e){if("object"!==Rat(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Rat(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Aat(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Mat=Pat((function t(e,n){Aat(this,t),this.hot=n,this.plugin=e})),Iat=Mat;function xat(t){return xat="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xat(t)}function _at(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hat(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Dat(r.key),r)}}function Nat(t,e,n){return e&&Hat(t.prototype,e),n&&Hat(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Dat(t){var e=Lat(t,"string");return"symbol"===xat(e)?e:String(e)}function Lat(t,e){if("object"!==xat(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==xat(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Bat(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vat(t,e)}function Vat(t,e){return Vat=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Vat(t,e)}function Fat(t){var e=zat();return function(){var n,r=Gat(t);if(e){var o=Gat(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Wat(this,n)}}function Wat(t,e){if(e&&("object"===xat(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Uat(t)}function Uat(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zat(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Gat(t){return Gat=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gat(t)}var Yat=function(t){Bat(n,t);var e=Fat(n);function n(t,r){var o;return _at(this,n),o=e.call(this,t,r),o.dataManager=o.plugin.dataManager,o.collapsingUI=o.plugin.collapsingUI,o.rowHeaderWidthCache=null,o}return Nat(n,[{key:"appendLevelIndicators",value:function(t,e){var r=this.hot.toPhysicalRow(t),o=this.dataManager.getRowLevel(r),i=this.dataManager.getDataObject(r),a=e.getElementsByTagName("DIV")[0],l=a.querySelector("span.rowHeader"),s=a.querySelectorAll('[class^="ht_nesting"]');if(U(s,(function(t){t&&a.removeChild(t)})),Ge(e,n.CSS_CLASSES.indicatorContainer),o){var u=this.hot.rootDocument,c=l.cloneNode(!0);a.innerHTML="",Io(0,o-1,(function(){var t=u.createElement("SPAN");Ge(t,n.CSS_CLASSES.emptyIndicator),a.appendChild(t)})),a.appendChild(c)}if(this.dataManager.hasChildren(i)){var f=this.hot.rootDocument.createElement("DIV");Ge(e,n.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?Ge(f,"".concat(n.CSS_CLASSES.button," ").concat(n.CSS_CLASSES.expandButton)):Ge(f,"".concat(n.CSS_CLASSES.button," ").concat(n.CSS_CLASSES.collapseButton)),a.appendChild(f)}}},{key:"updateRowHeaderWidth",value:function(t){var e=t;e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),n}(Iat),Kat=Yat;function Xat(t){return Xat="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xat(t)}function $at(t){return Zat(t)||Jat(t)||Qat(t)||qat()}function qat(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Qat(t,e){if(t){if("string"===typeof t)return tlt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tlt(t,e):void 0}}function Jat(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Zat(t){if(Array.isArray(t))return tlt(t)}function tlt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function elt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nlt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,olt(r.key),r)}}function rlt(t,e,n){return e&&nlt(t.prototype,e),n&&nlt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function olt(t){var e=ilt(t,"string");return"symbol"===Xat(e)?e:String(e)}function ilt(t,e){if("object"!==Xat(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Xat(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function alt(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&llt(t,e)}function llt(t,e){return llt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},llt(t,e)}function slt(t){var e=flt();return function(){var n,r=hlt(t);if(e){var o=hlt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ult(this,n)}}function ult(t,e){if(e&&("object"===Xat(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return clt(t)}function clt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function flt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function hlt(t){return hlt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hlt(t)}var dlt=function(t){alt(n,t);var e=slt(n);function n(t,r){var o;return elt(this,n),o=e.call(this,t,r),o.dataManager=o.plugin.dataManager,o.collapsedRows=[],o.collapsedRowsStash={stash:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,t)},shiftStash:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null!==e&&void 0!==e||(e=1/0),U(o.lastCollapsedRows,(function(r,i){r>=t&&r<e&&(o.lastCollapsedRows[i]=r+n)}))},applyStash:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];o.collapseMultipleChildren(o.lastCollapsedRows,t),o.lastCollapsedRows=void 0},trimStash:function(t,e){Io(t,t+e-1,(function(t){var e=o.lastCollapsedRows.indexOf(t);e>-1&&o.lastCollapsedRows.splice(e,1)}))}},o}return rlt(n,[{key:"collapseChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=null,a=null,l=null;return isNaN(t)?(i=t,a=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(t),a=t),this.dataManager.hasChildren(i)&&U(i.__children,(function(t){o.push(e.dataManager.getRowIndex(t))})),l=this.collapseRows(o,!0,!1),r&&this.trimRows(l),n&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(a)&&this.collapsedRows.push(a),l}},{key:"collapseMultipleChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];U(t,(function(t){o.push.apply(o,$at(e.collapseChildren(t,!1,!1)))})),r&&this.trimRows(o),n&&this.renderAndAdjust()}},{key:"collapseRow",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([t],e)}},{key:"collapseRows",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return U(t,(function(t){o.push(t),n&&e.collapseChildRows(t,o)})),r&&this.trimRows(o),o}},{key:"collapseChildRows",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){var o=this.dataManager.getDataObject(t);U(o.__children,(function(t){var r=e.dataManager.getRowIndex(t);n.push(r),e.collapseChildRows(r,n)}))}r&&this.trimRows(n)}},{key:"expandRow",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([t],e)}},{key:"expandRows",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return U(t,(function(t){o.push(t),n&&e.expandChildRows(t,o)})),r&&this.untrimRows(o),o}},{key:"expandChildRows",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){var o=this.dataManager.getDataObject(t);U(o.__children,(function(t){if(!e.isAnyParentCollapsed(t)){var r=e.dataManager.getRowIndex(t);n.push(r),e.expandChildRows(r,n)}}))}r&&this.untrimRows(n)}},{key:"expandChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=null,a=null,l=null;return isNaN(t)?(i=t,a=this.dataManager.getRowIndex(t)):(i=this.dataManager.getDataObject(t),a=t),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(i)&&U(i.__children,(function(t){var n=e.dataManager.getRowIndex(t);o.push(n)})),l=this.expandRows(o,!0,!1),r&&this.untrimRows(l),n&&this.renderAndAdjust(),l}},{key:"expandMultipleChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];U(t,(function(t){o.push.apply(o,$at(e.expandChildren(t,!1,!1)))})),r&&this.untrimRows(o),n&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var t=this,e=this.dataManager.getData(),n=[];U(e,(function(e){t.dataManager.hasChildren(e)&&n.push(e)})),this.collapseMultipleChildren(n),this.renderAndAdjust()}},{key:"expandAll",value:function(){var t=this,e=this.dataManager.getData(),n=[];U(e,(function(e){t.dataManager.hasChildren(e)&&n.push(e)})),this.expandMultipleChildren(n),this.renderAndAdjust()}},{key:"trimRows",value:function(t){var e=this;this.hot.batchExecution((function(){U(t,(function(t){e.plugin.collapsedRowsMap.setValueAtIndex(t,!0)}))}),!0)}},{key:"untrimRows",value:function(t){var e=this;this.hot.batchExecution((function(){U(t,(function(t){e.plugin.collapsedRowsMap.setValueAtIndex(t,!1)}))}),!0)}},{key:"areChildrenCollapsed",value:function(t){var e=this,n=isNaN(t)?t:this.dataManager.getDataObject(t),r=!0;return null===n&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&U(n.__children,(function(t){var n=e.dataManager.getRowIndex(t);if(!e.plugin.collapsedRowsMap.getValueAtIndex(n))return r=!1,!1})),r}},{key:"isAnyParentCollapsed",value:function(t){var e=t;while(null!==e){e=this.dataManager.getRowParent(e);var n=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}},{key:"toggleState",value:function(t,e){if(!(e.col>=0)){var n=this.translateTrimmedRow(e.row);ze(t.target,Kat.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),Zn(t))}}},{key:"translateTrimmedRow",value:function(t){return this.hot.toPhysicalRow(t)}},{key:"untranslateTrimmedRow",value:function(t){return this.hot.toVisualRow(t)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),n}(Iat),plt=dlt;function ylt(t){return ylt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ylt(t)}function vlt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mlt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,blt(r.key),r)}}function glt(t,e,n){return e&&mlt(t.prototype,e),n&&mlt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function blt(t){var e=wlt(t,"string");return"symbol"===ylt(e)?e:String(e)}function wlt(t,e){if("object"!==ylt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ylt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Slt(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Clt(t,e)}function Clt(t,e){return Clt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Clt(t,e)}function Olt(t){var e=Elt();return function(){var n,r=Plt(t);if(e){var o=Plt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return klt(this,n)}}function klt(t,e){if(e&&("object"===ylt(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Rlt(t)}function Rlt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Elt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Plt(t){return Plt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Plt(t)}var Tlt,jlt=new WeakMap,Alt=function(t){Slt(n,t);var e=Olt(n);function n(t,r){var o;return vlt(this,n),o=e.call(this,t,r),jlt.set(Rlt(o),{row_above:function(t,e){var n=e[e.length-1];o.dataManager.addSibling(n.start.row,"above")},row_below:function(t,e){var n=e[e.length-1];o.dataManager.addSibling(n.start.row,"below")}}),o.dataManager=o.plugin.dataManager,o}return glt(n,[{key:"appendOptions",value:function(t){var e=this,n=[{key:"add_child",name:function(){return this.getTranslatedPhrase(mS)},callback:function(){var t=e.dataManager.translateTrimmedRow(e.hot.getSelectedLast()[0]),n=e.dataManager.getDataObject(t);e.dataManager.addChild(n)},disabled:function(){var t=e.hot.getSelectedLast();return!t||t[0]<0||e.hot.selection.isSelectedByColumnHeader()||e.hot.countRows()>=e.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(gS)},callback:function(){e.dataManager.detachFromParent(e.hot.getSelectedLast())},disabled:function(){var t=e.hot.getSelectedLast(),n=e.dataManager.translateTrimmedRow(t[0]),r=e.dataManager.getRowParent(n);return!r||!t||t[0]<0||e.hot.selection.isSelectedByColumnHeader()||e.hot.countRows()>=e.hot.getSettings().maxRows}},{name:"---------"}];return Io(0,t.items.length-1,(function(e){if(0===e)return U(n,(function(n,r){t.items.splice(e+r,0,n)})),!1})),this.modifyRowInsertingOptions(t)}},{key:"modifyRowInsertingOptions",value:function(t){var e=jlt.get(this);return Io(0,t.items.length-1,(function(n){var r=e[t.items[n].key];null!==r&&void 0!==r&&(t.items[n].callback=r)})),t}}]),n}(Iat),Mlt=Alt;function Ilt(t){return Ilt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ilt(t)}function xlt(t){return Dlt(t)||Nlt(t)||Hlt(t)||_lt()}function _lt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Hlt(t,e){if(t){if("string"===typeof t)return Llt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Llt(t,e):void 0}}function Nlt(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Dlt(t){if(Array.isArray(t))return Llt(t)}function Llt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Blt(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Vlt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Flt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ult(r.key),r)}}function Wlt(t,e,n){return e&&Flt(t.prototype,e),n&&Flt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ult(t){var e=zlt(t,"string");return"symbol"===Ilt(e)?e:String(e)}function zlt(t,e){if("object"!==Ilt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ilt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Glt=function(){function t(e){Vlt(this,t),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}return Wlt(t,[{key:"onBeforeRowMove",value:function(t,e,n,r){var o=this,i=this.displayAPICompatibilityWarning({rows:t,finalIndex:e,dropIndex:n,movePossible:r});if(i)return!1;this.movedToCollapsed=!1;var a=n===this.hot.countRows(),l=a?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n),s=!0,u=t.map((function(t){if(!s)return!1;var e=o.dataManager.translateTrimmedRow(t);return s=o.shouldAllowMoving(e,l),e})),c=-1===u.indexOf(l);if(!s||!c)return!1;var f=this.getBaseParent(u),h=this.getTargetParent(a,l),d=f===h;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(h),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,l,d),this.moveRows(u,l,h),this.dataManager.rewriteCache(),this.moveCellsMeta(u,l),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",t,e,n,r,r&&this.isRowOrderChanged(t,e)),this.hot.render(),this.selectCells(t,n),!1}},{key:"displayAPICompatibilityWarning",value:function(t){var e=t.rows,n=t.finalIndex,r=t.dropIndex,o=t.movePossible,i=!1;return te(r)&&(Un($t(Tlt||(Tlt=Blt(["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows \n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."],["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20\n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."])))),this.hot.runHooks("afterRowMove",e,n,r,o,!1),i=!0),i}},{key:"shouldAllowMoving",value:function(t,e){return!(this.dataManager.isParent(t)||this.dataManager.isRowHighestLevel(t)||t===e||0===e)}},{key:"getBaseParent",value:function(t){return this.dataManager.getRowParent(t[0])}},{key:"getTargetParent",value:function(t,e){var n=this.dataManager.getRowParent(t?e-1:e);return null!==n&&void 0!==n||(n=this.dataManager.getRowParent(e-1)),n}},{key:"shiftCollapsibleParentsLocations",value:function(t,e,n){n||(Math.max.apply(Math,xlt(t))<=e?this.collapsingUI.collapsedRowsStash.shiftStash(t[0],e,-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(e,t[0],t.length))}},{key:"moveRows",value:function(t,e,n){var r=this,o=e===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender((function(){t.forEach((function(t){r.dataManager.moveRow(t,e,r.movedToCollapsed,o)}))}))}},{key:"moveCellsMeta",value:function(t,e){var n,r=this,o=[],i=Math.max.apply(Math,xlt(t))<e;t.forEach((function(t){o.push(r.hot.getCellMetaAtRow(t))})),this.hot.spliceCellsMeta(t[0],t.length),(n=this.hot).spliceCellsMeta.apply(n,[e-(i?o.length:0),0].concat(o))}},{key:"selectCells",value:function(t,e){var n=t.length,r=0,o=0,i=null,a=null;if(this.movedToCollapsed){var l=null;l=t[n-1]<e?this.dataManager.translateTrimmedRow(e-n):this.dataManager.translateTrimmedRow(e);var s=this.dataManager.getRowParent(null===l?this.hot.countSourceRows()-1:l-1),u=this.dataManager.getRowIndex(s);r=this.dataManager.untranslateTrimmedRow(u),o=r}else t[n-1]<e?(o=e-1,r=o-n+1):(r=e,o=r+n-1);i=this.hot.selection,a=this.hot.countCols()-1,i.setRangeStart(this.hot._createCellCoords(r,0)),i.setRangeEnd(this.hot._createCellCoords(o,a),!0)}},{key:"isRowOrderChanged",value:function(t,e){return t.some((function(t,n){return t-n!==e}))}}]),t}();function Ylt(t){return Ylt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ylt(t)}function Klt(t){return Qlt(t)||qlt(t)||$lt(t)||Xlt()}function Xlt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $lt(t,e){if(t){if("string"===typeof t)return Jlt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jlt(t,e):void 0}}function qlt(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Qlt(t){if(Array.isArray(t))return Jlt(t)}function Jlt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Zlt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tst(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,nst(r.key),r)}}function est(t,e,n){return e&&tst(t.prototype,e),n&&tst(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function nst(t){var e=rst(t,"string");return"symbol"===Ylt(e)?e:String(e)}function rst(t,e){if("object"!==Ylt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ylt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ost(){return ost="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=ist(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},ost.apply(this,arguments)}function ist(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=hst(t),null===t)break;return t}function ast(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lst(t,e)}function lst(t,e){return lst=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lst(t,e)}function sst(t){var e=fst();return function(){var n,r=hst(t);if(e){var o=hst(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ust(this,n)}}function ust(t,e){if(e&&("object"===Ylt(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return cst(t)}function cst(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fst(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function hst(t){return hst=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hst(t)}var dst="nestedRows",pst=300,yst=new WeakMap,vst="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",mst=function(t){ast(n,t);var e=sst(n);function n(t){var r;return Zlt(this,n),r=e.call(this,t),r.dataManager=null,r.headersUI=null,r.collapsedRowsMap=null,yst.set(cst(r),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),r}return est(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[dst]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new qg),this.dataManager=new kat(this,this.hot),this.collapsingUI=new plt(this,this.hot),this.headersUI=new Kat(this,this.hot),this.contextMenuUI=new Mlt(this,this.hot),this.rowMoveController=new Glt(this),this.addHook("afterInit",(function(){return t.onAfterInit.apply(t,arguments)})),this.addHook("beforeViewRender",(function(){return t.onBeforeViewRender.apply(t,arguments)})),this.addHook("modifyRowData",(function(){return t.onModifyRowData.apply(t,arguments)})),this.addHook("modifySourceLength",(function(){return t.onModifySourceLength.apply(t,arguments)})),this.addHook("beforeDataSplice",(function(){return t.onBeforeDataSplice.apply(t,arguments)})),this.addHook("filterData",(function(){return t.onFilterData.apply(t,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return t.onAfterContextMenuDefaultOptions.apply(t,arguments)})),this.addHook("afterGetRowHeader",(function(){return t.onAfterGetRowHeader.apply(t,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)})),this.addHook("beforeRemoveRow",(function(){return t.onBeforeRemoveRow.apply(t,arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow.apply(t,arguments)})),this.addHook("beforeAddChild",(function(){return t.onBeforeAddChild.apply(t,arguments)})),this.addHook("afterAddChild",(function(){return t.onAfterAddChild.apply(t,arguments)})),this.addHook("beforeDetachChild",(function(){return t.onBeforeDetachChild.apply(t,arguments)})),this.addHook("afterDetachChild",(function(){return t.onAfterDetachChild.apply(t,arguments)})),this.addHook("modifyRowHeaderWidth",(function(){return t.onModifyRowHeaderWidth.apply(t,arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow.apply(t,arguments)})),this.addHook("beforeRowMove",(function(){return t.onBeforeRowMove.apply(t,arguments)})),this.addHook("beforeLoadData",(function(e){return t.onBeforeLoadData(e)})),this.addHook("beforeUpdateData",(function(e){return t.onBeforeLoadData(e)})),ost(hst(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),ost(hst(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var t=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(t),ost(hst(n.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}},{key:"disableCoreAPIModifiers",value:function(){var t=yst.get(this);t.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var t=yst.get(this);t.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n){this.collapsingUI.toggleState(t,e,n)}},{key:"onModifyRowData",value:function(t){var e=yst.get(this);if(!e.skipCoreAPIModifiers)return this.dataManager.getDataObject(t)}},{key:"onModifySourceLength",value:function(){var t=yst.get(this);if(!t.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(t,e,n){var r=yst.get(this);return!(!r.skipCoreAPIModifiers&&!this.dataManager.isRowHighestLevel(t))||(this.dataManager.spliceData(t,e,n),!1)}},{key:"onFilterData",value:function(t,e,n){var r=yst.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),r.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(t){return this.contextMenuUI.appendOptions(t)}},{key:"onAfterGetRowHeader",value:function(t,e){this.headersUI.appendLevelIndicators(t,e)}},{key:"onModifyRowHeaderWidth",value:function(t){return this.headersUI.rowHeaderWidthCache||t}},{key:"onAfterRemoveRow",value:function(t,e,n,r){var o=this;if(r!==this.pluginName){var i=yst.get(this);setTimeout((function(){i.skipRender=null,o.headersUI.updateRowHeaderWidth(),o.collapsingUI.collapsedRowsStash.applyStash()}),0)}}},{key:"onBeforeRemoveRow",value:function(t,e,n){var r=this,o=Array.from(n.reduce((function(t,e){if(r.dataManager.isParent(e)){var n=r.dataManager.getDataObject(e).__children;return t.add(e),Array.isArray(n)&&n.forEach((function(e){return t.add(r.dataManager.getRowIndex(e))})),t}return t.add(e)}),new Set));n.length=0,n.push.apply(n,o)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var t=Math.max.apply(Math,Klt(this.dataManager.cache.levels));t>0&&this.headersUI.updateRowHeaderWidth(t)}},{key:"onBeforeViewRender",value:function(t,e){var n=yst.get(this);n.skipRender&&(e.skipRender=!0)}},{key:"destroy",value:function(){ost(hst(n.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(t){if(!Bv(t))return zn(vst),this.hot.getSettings()[dst]=!1,void this.disablePlugin();this.dataManager.setData(t),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return dst}},{key:"PLUGIN_PRIORITY",get:function(){return pst}}]),n}(jH);function gst(t){return gst="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gst(t)}function bst(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wst(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Cst(r.key),r)}}function Sst(t,e,n){return e&&wst(t.prototype,e),n&&wst(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cst(t){var e=Ost(t,"string");return"symbol"===gst(e)?e:String(e)}function Ost(t,e){if("object"!==gst(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==gst(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var kst=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;bst(this,t),this.rootWindow=n,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}return Sst(t,[{key:"saveValue",value:function(t,e){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(t),JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}},{key:"loadValue",value:function(t,e){var n="undefined"===typeof t?e:t,r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(n));return null===r?void 0:JSON.parse(r)}},{key:"reset",value:function(t){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(t))}},{key:"resetAll",value:function(){var t=this;U(this.savedKeys,(function(e,n){t.rootWindow.localStorage.removeItem("".concat(t.prefix,"_").concat(t.savedKeys[n]))})),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var t=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),e="string"===typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),t}(),Rst=kst;function Est(t){return Est="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Est(t)}function Pst(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tst(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ast(r.key),r)}}function jst(t,e,n){return e&&Tst(t.prototype,e),n&&Tst(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ast(t){var e=Mst(t,"string");return"symbol"===Est(e)?e:String(e)}function Mst(t,e){if("object"!==Est(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Est(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ist(){return Ist="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=xst(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ist.apply(this,arguments)}function xst(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Vst(t),null===t)break;return t}function _st(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hst(t,e)}function Hst(t,e){return Hst=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Hst(t,e)}function Nst(t){var e=Bst();return function(){var n,r=Vst(t);if(e){var o=Vst(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Dst(this,n)}}function Dst(t,e){if(e&&("object"===Est(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Lst(t)}function Lst(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bst(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Vst(t){return Vst=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Vst(t)}mr.getSingleton().register("persistentStateSave"),mr.getSingleton().register("persistentStateLoad"),mr.getSingleton().register("persistentStateReset");var Fst="persistentState",Wst=0,Ust=function(t){_st(n,t);var e=Nst(n);function n(t){var r;return Pst(this,n),r=e.call(this,t),r.storage=void 0,r}return jst(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Fst]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.storage||(this.storage=new Rst(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(function(e,n){return t.saveValue(e,n)})),this.addHook("persistentStateLoad",(function(e,n){return t.loadValue(e,n)})),this.addHook("persistentStateReset",(function(){return t.resetValue()})),Ist(Vst(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,Ist(Vst(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ist(Vst(n.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(t,e){e.value=this.storage.loadValue(t)}},{key:"saveValue",value:function(t,e){this.storage.saveValue(t,e)}},{key:"resetValue",value:function(t){"undefined"===typeof t?this.storage.resetAll():this.storage.reset(t)}},{key:"destroy",value:function(){Ist(Vst(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Fst}},{key:"PLUGIN_PRIORITY",get:function(){return Wst}}]),n}(jH);function zst(t){return zst="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zst(t)}function Gst(t){return $st(t)||Xst(t)||Kst(t)||Yst()}function Yst(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Kst(t,e){if(t){if("string"===typeof t)return qst(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qst(t,e):void 0}}function Xst(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function $st(t){if(Array.isArray(t))return qst(t)}function qst(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Qst(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jst(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,tut(r.key),r)}}function Zst(t,e,n){return e&&Jst(t.prototype,e),n&&Jst(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function tut(t){var e=eut(t,"string");return"symbol"===zst(e)?e:String(e)}function eut(t,e){if("object"!==zst(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==zst(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function nut(){return nut="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=rut(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},nut.apply(this,arguments)}function rut(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=cut(t),null===t)break;return t}function out(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&iut(t,e)}function iut(t,e){return iut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},iut(t,e)}function aut(t){var e=uut();return function(){var n,r=cut(t);if(e){var o=cut(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lut(this,n)}}function lut(t,e){if(e&&("object"===zst(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return sut(t)}function sut(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function uut(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function cut(t){return cut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cut(t)}var fut="search",hut=190,dut="htSearchResult",put=function(t,e,n,r,o){t.getCellMeta(e,n).isSearchResult=o},yut=function(t,e,n){return!(te(t)||null===t||!t.toLocaleLowerCase||0===t.length)&&(!te(e)&&null!==e&&-1!==e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale)))},vut=function(t){out(n,t);var e=aut(n);function n(t){var r;return Qst(this,n),r=e.call(this,t),r.callback=put,r.queryMethod=yut,r.searchResultClass=dut,r}return Zst(n,[{key:"isEnabled",value:function(){return this.hot.getSettings()[fut]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[fut];this.updatePluginSettings(e),this.addHook("beforeRenderer",(function(){return t.onBeforeRenderer.apply(t,arguments)})),nut(cut(n.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var t=this,e=function(){return t.onBeforeRenderer.apply(t,arguments)};this.hot.addHook("beforeRenderer",e),this.hot.addHookOnce("afterViewRender",(function(){t.hot.removeHook("beforeRenderer",e)})),nut(cut(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),nut(cut(n.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod(),o=this.hot.countRows(),i=this.hot.countCols(),a=[],l=this.hot;return Io(0,o-1,(function(o){Io(0,i-1,(function(i){var s=e.hot.getDataAtCell(o,i),u=e.hot.getCellMeta(o,i),c=u.search.callback||n,f=u.search.queryMethod||r,h=f(t,s,u);if(h){var d={row:o,col:i,data:s};a.push(d)}c&&c(l,o,i,s,h)}))})),a}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(t){this.callback=t}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(t){this.queryMethod=t}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(t){this.searchResultClass=t}},{key:"updatePluginSettings",value:function(t){ht(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}},{key:"onBeforeRenderer",value:function(t,e,n,r,o,i){var a,l=i.className||[],s=[];"string"===typeof l?s=l.split(" "):(a=s).push.apply(a,Gst(l));this.isEnabled()&&i.isSearchResult?s.includes(this.searchResultClass)||s.push("".concat(this.searchResultClass)):s.includes(this.searchResultClass)&&s.splice(s.indexOf(this.searchResultClass),1),i.className=s.join(" ")}},{key:"destroy",value:function(){nut(cut(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return fut}},{key:"PLUGIN_PRIORITY",get:function(){return hut}}]),n}(jH);function mut(t){return mut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mut(t)}function gut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function but(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Sut(r.key),r)}}function wut(t,e,n){return e&&but(t.prototype,e),n&&but(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Sut(t){var e=Cut(t,"string");return"symbol"===mut(e)?e:String(e)}function Cut(t,e){if("object"!==mut(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==mut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Out(){return Out="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=kut(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Out.apply(this,arguments)}function kut(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Mut(t),null===t)break;return t}function Rut(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Eut(t,e)}function Eut(t,e){return Eut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Eut(t,e)}function Put(t){var e=Aut();return function(){var n,r=Mut(t);if(e){var o=Mut(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Tut(this,n)}}function Tut(t,e){if(e&&("object"===mut(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return jut(t)}function jut(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Aut(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Mut(t){return Mut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Mut(t)}var Iut="touchScroll",xut=200,_ut=function(t){Rut(n,t);var e=Put(n);function n(t){var r;return gut(this,n),r=e.call(this,t),r.scrollbars=[],r.clones=[],r.lockedCollection=!1,r.freezeOverlays=!1,r}return wut(n,[{key:"isEnabled",value:function(){return I()}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterViewRender",(function(){return t.onAfterViewRender()})),this.registerEvents(),Out(Mut(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,Out(Mut(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Out(Mut(n.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var t=this;this.addHook("beforeTouchScroll",(function(){return t.onBeforeTouchScroll()})),this.addHook("afterMomentumScroll",(function(){return t.onAfterMomentumScroll()}))}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var t=this.hot.view._wt.wtOverlays,e=t.topOverlay,n=t.bottomOverlay,r=t.inlineStartOverlay,o=t.topInlineStartCornerOverlay,i=t.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),n.clone&&this.scrollbars.push(n),this.scrollbars.push(r),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,U(this.clones,(function(t){Ge(t,"hide-tween")}))}},{key:"onAfterMomentumScroll",value:function(){var t=this;this.freezeOverlays=!1,U(this.clones,(function(t){Ye(t,"hide-tween"),Ge(t,"show-tween")})),this.hot._registerTimeout((function(){U(t.clones,(function(t){Ye(t,"show-tween")}))}),400),U(this.scrollbars,(function(t){t.refresh(),t.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return Iut}},{key:"PLUGIN_PRIORITY",get:function(){return xut}},{key:"SETTING_KEYS",get:function(){return!0}}]),n}(jH);function Hut(t){return Hut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hut(t)}function Nut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,But(r.key),r)}}function Lut(t,e,n){return e&&Dut(t.prototype,e),n&&Dut(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function But(t){var e=Vut(t,"string");return"symbol"===Hut(e)?e:String(e)}function Vut(t,e){if("object"!==Hut(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Hut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Fut(){return Fut="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Wut(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Fut.apply(this,arguments)}function Wut(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=$ut(t),null===t)break;return t}function Uut(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zut(t,e)}function zut(t,e){return zut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},zut(t,e)}function Gut(t){var e=Xut();return function(){var n,r=$ut(t);if(e){var o=$ut(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Yut(this,n)}}function Yut(t,e){if(e&&("object"===Hut(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Kut(t)}function Kut(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xut(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function $ut(t){return $ut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$ut(t)}var qut="trimRows",Qut=330,Jut=function(t){Uut(n,t);var e=Gut(n);function n(t){var r;return Nut(this,n),r=e.call(this,t),r.trimmedRowsMap=null,r}return Lut(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[qut]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new qg),this.trimmedRowsMap.addLocalHook("init",(function(){return t.onMapInit()})),Fut($ut(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var t=this,e=this.hot.getSettings()[qut];Array.isArray(e)&&this.hot.batchExecution((function(){t.trimmedRowsMap.clear(),U(e,(function(e){t.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0),Fut($ut(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),Fut($ut(n.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(t){var e=this,n=this.getTrimmedRows(),r=this.isValidConfig(t),o=n;r&&(o=Array.from(new Set(n.concat(t))));var i=this.hot.runHooks("beforeTrimRow",n,o,r);!1!==i&&(r&&this.hot.batchExecution((function(){U(t,(function(t){e.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),this.hot.runHooks("afterTrimRow",n,o,r,r&&o.length>n.length))}},{key:"trimRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.trimRows(e)}},{key:"untrimRows",value:function(t){var e=this.getTrimmedRows(),n=this.isValidConfig(t),r=e,o=this.trimmedRowsMap.getValues().slice(),i=t.length>0;n&&i&&(U(t,(function(t){o[t]=!1})),r=V(o,(function(t,e,n){return e&&t.push(n),t}),[]));var a=this.hot.runHooks("beforeUntrimRow",e,r,n&&i);!1!==a&&(n&&i&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",e,r,n&&i,n&&r.length<e.length))}},{key:"untrimRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.untrimRows(e)}},{key:"isTrimmed",value:function(t){return this.trimmedRowsMap.getValueAtIndex(t)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(t){var e=this.hot.countSourceRows();return t.every((function(t){return Number.isInteger(t)&&t>=0&&t<e}))}},{key:"onMapInit",value:function(){var t=this,e=this.hot.getSettings()[qut];Array.isArray(e)&&this.hot.batchExecution((function(){U(e,(function(e){t.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0)}},{key:"destroy",value:function(){Fut($ut(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return qut}},{key:"PLUGIN_PRIORITY",get:function(){return Qut}}]),n}(jH);function Zut(t){return Zut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zut(t)}function tct(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ect(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,rct(r.key),r)}}function nct(t,e,n){return e&&ect(t.prototype,e),n&&ect(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function rct(t){var e=oct(t,"string");return"symbol"===Zut(e)?e:String(e)}function oct(t,e){if("object"!==Zut(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Zut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ict(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&act(t,e)}function act(t,e){return act=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},act(t,e)}function lct(t){var e=cct();return function(){var n,r=fct(t);if(e){var o=fct(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return sct(this,n)}}function sct(t,e){if(e&&("object"===Zut(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return uct(t)}function uct(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function fct(t){return fct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fct(t)}function hct(t){return yct(t)||pct(t)||gct(t)||dct()}function dct(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pct(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function yct(t){if(Array.isArray(t))return bct(t)}function vct(t,e){return Sct(t)||wct(t,e)||gct(t,e)||mct()}function mct(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function gct(t,e){if(t){if("string"===typeof t)return bct(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bct(t,e):void 0}}function bct(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function wct(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Sct(t){if(Array.isArray(t))return t}var Cct="undoRedo",Oct="undoRedo";function kct(t){var e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",(function(n,r){var o=this,i=n&&n.length;if(i){var a=n.find((function(t){var e=vct(t,4),n=e[2],r=e[3];return n!==r}));if(a){var l=function(){var e=n.reduce((function(t,e){return t.push(hct(e)),t}),[]);U(e,(function(e){e[1]=t.propToCol(e[1])}));var r=i>1?o.getSelected():[[e[0][0],e[0][1]]];return new kct.ChangeAction(e,r)};e.done(l,r)}}})),t.addHook("afterCreateRow",(function(t,n,r){e.done((function(){return new kct.CreateRowAction(t,n)}),r)})),t.addHook("beforeRemoveRow",(function(n,r,o,i){var a=function(){var o=t.toPhysicalRow(n),i=st(e.instance.getSourceData(o,0,o+r-1,e.instance.countSourceCols()-1));return new kct.RemoveRowAction(o,i,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(a,i)})),t.addHook("afterCreateCol",(function(t,n,r){e.done((function(){return new kct.CreateColumnAction(t,n)}),r)})),t.addHook("beforeRemoveCol",(function(n,r,o,i){var a=function(){var o=e.instance.getSourceDataArray(),i=(e.instance.countCols()+n)%e.instance.countCols(),a=[],l=[],s=[];Io(o.length-1,(function(e){var n=[],l=o[e];Io(i,i+(r-1),(function(e){n.push(l[t.toPhysicalColumn(e)])})),a.push(n)})),Io(r-1,(function(e){s.push(t.toPhysicalColumn(i+e))})),Array.isArray(t.getSettings().colHeaders)&&Io(r-1,(function(e){l.push(t.getSettings().colHeaders[t.toPhysicalColumn(i+e)]||null)}));var u=t.columnIndexMapper.getIndexesSequence(),c=t.rowIndexMapper.getIndexesSequence();return new kct.RemoveColumnAction(i,s,a,l,u,c,t.getSettings().fixedColumnsStart)};e.done(a,i)})),t.addHook("beforeCellAlignment",(function(t,n,r,o){e.done((function(){return new kct.CellAlignmentAction(t,n,r,o)}))})),t.addHook("beforeFilter",(function(t){e.done((function(){return new kct.FiltersAction(t)}))})),t.addHook("beforeRowMove",(function(t,n){!1!==t&&e.done((function(){return new kct.RowMoveAction(t,n)}))})),t.addHook("beforeMergeCells",(function(n,r){r||e.done((function(){return new kct.MergeCellsAction(t,n)}))})),t.addHook("afterUnmergeCells",(function(n,r){r||e.done((function(){return new kct.UnmergeCellsAction(t,n)}))})),t.addHook("afterInit",(function(){e.init()}))}kct.prototype.done=function(t,e){if(!this.ignoreNewActions){var n="UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e;if(!n){var r=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",r,e);if(!1!==o){var i=t(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}},kct.prototype.undo=function(){if(this.isUndoAvailable()){var t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);var e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());var n=st(e),r=this.instance.runHooks("beforeUndo",n);if(!1===r)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),e.undo(this.instance,(function(){o.ignoreNewActions=!1,o.undoneActions.push(e)})),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}},kct.prototype.redo=function(){if(this.isRedoAvailable()){var t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);var e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());var n=st(e),r=this.instance.runHooks("beforeRedo",n);if(!1===r)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),e.redo(this.instance,(function(){o.ignoreNewActions=!1,o.doneActions.push(e)})),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}},kct.prototype.isUndoAvailable=function(){return this.doneActions.length>0},kct.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},kct.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},kct.prototype.isEnabled=function(){return this.enabled},kct.prototype.enable=function(){if(!this.isEnabled()){var t=this.instance;this.enabled=!0,Tct(t),this.registerShortcuts(),t.addHook("afterChange",Pct)}},kct.prototype.disable=function(){if(this.isEnabled()){var t=this.instance;this.enabled=!1,jct(t),this.unregisterShortcuts(),t.removeHook("afterChange",Pct)}},kct.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},kct.Action=function(){},kct.Action.prototype.undo=function(){},kct.Action.prototype.redo=function(){},kct.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"},it(kct.ChangeAction,kct.Action),kct.ChangeAction.prototype.undo=function(t,e){for(var n=st(this.changes),r=t.countEmptyRows(!0),o=t.countEmptyCols(!0),i=0,a=n.length;i<a;i++)n[i].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(var l=0,s=n.length;l<s;l++){var u=vct(n[l],2),c=u[0],f=u[1];t.getSettings().minSpareRows&&c+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(c+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&f+1+t.getSettings().minSpareCols===t.countCols()&&o===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(f+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)},kct.ChangeAction.prototype.redo=function(t,e){for(var n=st(this.changes),r=0,o=n.length;r<o;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)},kct.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},it(kct.CreateRowAction,kct.Action),kct.CreateRowAction.prototype.undo=function(t,e){var n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},kct.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},kct.RemoveRowAction=function(t,e,n,r,o){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=o},it(kct.RemoveRowAction,kct.Action),kct.RemoveRowAction.prototype.undo=function(t,e){var n=this,r=t.getSettings(),o=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((function(t,e){Object.keys(t).forEach((function(r){var i=parseInt(r,10);o.push([n.index+e,isNaN(i)?r:i,t[r]])}))})),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},kct.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},kct.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},it(kct.CreateColumnAction,kct.Action),kct.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},kct.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},kct.RemoveColumnAction=function(t,e,n,r,o,i,a){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a},it(kct.RemoveColumnAction,kct.Action),kct.RemoveColumnAction.prototype.undo=function(t,e){var n=this,r=t.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(t,e,r){return r[n.indexes.indexOf(o[e])]},a=this.data.length,l=[],s=0;s<a;s++)l.push(W(this.data[s],i));var u=W(this.headers,i),c=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),U(t.getSourceDataArray(),(function(t,e){U(o,(function(n,r){t[n]=l[e][r],c.push([e,n,t[n]])}))})),t.setSourceDataAtCell(c,void 0,void 0,"UndoRedo.undo"),"undefined"!==typeof this.headers&&U(u,(function(e,n){t.getSettings().colHeaders[o[n]]=e})),t.batchExecution((function(){t.rowIndexMapper.setIndexesSequence(n.rowPositions),t.columnIndexMapper.setIndexesSequence(n.columnPositions)}),!0),t.addHookOnce("afterViewRender",e),t.render()},kct.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},kct.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r},kct.CellAlignmentAction.prototype.undo=function(t,e){var n=this;U(this.range,(function(e){e.forAll((function(e,r){e>=0&&r>=0&&t.setCellMeta(e,r,"className",n.stateBefore[e][r]||" htLeft")}))})),t.addHookOnce("afterViewRender",e),t.render()},kct.CellAlignmentAction.prototype.redo=function(t,e){fW(this.range,this.type,this.alignment,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),t.addHookOnce("afterViewRender",e),t.render()},kct.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},it(kct.FiltersAction,kct.Action),kct.FiltersAction.prototype.undo=function(t,e){var n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},kct.FiltersAction.prototype.redo=function(t,e){var n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};var Rct=function(t){ict(n,t);var e=lct(n);function n(t,r){var o;tct(this,n),o=e.call(this),o.cellRange=r;var i=o.cellRange.getTopStartCorner(),a=o.cellRange.getBottomEndCorner();return o.rangeData=t.getData(i.row,i.col,a.row,a.col),o}return nct(n,[{key:"undo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.unmergeRange(this.cellRange,!0);var r=this.cellRange.getTopStartCorner();t.populateFromArray(r.row,r.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.mergeRange(this.cellRange)}}]),n}(kct.Action);kct.MergeCellsAction=Rct;var Ect=function(t){ict(n,t);var e=lct(n);function n(t,r){var o;return tct(this,n),o=e.call(this),o.cellRange=r,o}return nct(n,[{key:"undo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.unmergeRange(this.cellRange,!0),t.render()}}]),n}(kct.Action);function Pct(t,e){var n=this;if("loadData"===e)return n.undoRedo.clear()}function Tct(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function jct(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}kct.UnmergeCellsAction=Ect,kct.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"},it(kct.RowMoveAction,kct.Action),kct.RowMoveAction.prototype.undo=function(t,e){var n=this,r=t.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter((function(t){return t>n.finalIndex})),a=o.filter((function(t){return t<=n.finalIndex})),l=i.sort((function(t,e){return e-t})).concat(a.sort((function(t,e){return t-e})));t.addHookOnce("afterViewRender",e);for(var s=0;s<l.length;s+=1){var u=t.toVisualRow(l[s]);r.moveRow(u,l[s])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},kct.RowMoveAction.prototype.redo=function(t,e){var n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},kct.prototype.init=function(){var t=this.instance.getSettings().undo,e="undefined"===typeof t||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},kct.prototype.registerShortcuts=function(){var t=this,e=this.instance.getShortcutManager(),n=e.getContext("grid"),r=function(t){return!t.altKey},o={runOnlyIf:r,group:Cct};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){t.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){t.redo()}}],o)},kct.prototype.unregisterShortcuts=function(){var t=this.instance.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(Cct)};var Act=mr.getSingleton();Act.add("afterUpdateSettings",(function(){var t;null===(t=this.getPlugin("undoRedo"))||void 0===t||t.init()})),Act.register("beforeUndo"),Act.register("afterUndo"),Act.register("beforeRedo"),Act.register("afterRedo"),kct.PLUGIN_KEY=Oct,kct.SETTING_KEYS=!0;var Mct,Ict,xct,_ct,Hct,Nct=kct;function Dct(){Ni(RN),Ni(aD),Ni(MD),Ni(GL),Ni(PB),Ni(vF),Ni(GF),Ni(ZW),Ni(Kz),Ni(zY),Ni(HK),Ni(ZK),Ni(gX),Ni(P$),Ni(X2),Ni(a6),Ni(K6),Ni(_5),Ni(d4),Ni(A9),Ni(q9),Ni(dtt),Ni(Dtt),Ni(fnt),Ni(Unt),Ni(lrt),Ni(cat),Ni(mst),Ni(Ust),Ni(vut),Ni(_ut),Ni(Jut),Ni(Nct)}function Lct(){o_(),M_(),z_(),lH(),Dct()}function Bct(t){var e="undefined"!==typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){var n,r=this.first(),o=r.data("handsontable");if("string"!==typeof e){var i=e||{};return o?o.updateSettings(i):(o=new t.Core(r[0],i),r.data("handsontable",o),o.init()),r}if(o){if("undefined"===typeof o[e])throw new Error("Handsontable do not provide action: ".concat(e));for(var a,l=arguments.length,s=new Array(l>1?l-1:0),u=1;u<l;u++)s[u-1]=arguments[u];n=(a=o[e]).call.apply(a,[o].concat(s)),"destroy"===e&&r.removeData()}return n})}Lct(),Bct(Qj),Qj.__GhostTable=zH,Qj._getListenersCounter=Yr,Qj._getRegisteredMapsCounter=lb,Qj.EventManager=Gr;var Vct=[o,a,y,m,r,c,l,p,i,s,f,d],Fct=[u,h];Qj.helper={},Qj.dom={},U(Vct,(function(t){U(Object.getOwnPropertyNames(t),(function(e){"_"!==e.charAt(0)&&(Qj.helper[e]=t[e])}))})),U(Fct,(function(t){U(Object.getOwnPropertyNames(t),(function(e){"_"!==e.charAt(0)&&(Qj.dom[e]=t[e])}))})),Qj.cellTypes=null!==(Mct=Qj.cellTypes)&&void 0!==Mct?Mct:{},U(lE(),(function(t){Qj.cellTypes[t]=sE(t)})),Qj.cellTypes.registerCellType=uE,Qj.cellTypes.getCellType=sE,Qj.editors=null!==(Ict=Qj.editors)&&void 0!==Ict?Ict:{},U(Mr(),(function(t){Qj.editors["".concat(be(t),"Editor")]=_r(t)})),Qj.editors.registerEditor=Hr,Qj.editors.getEditor=_r,Qj.renderers=null!==(xct=Qj.renderers)&&void 0!==xct?xct:{},U(Ui(),(function(t){var e=zi(t);"base"===t&&(Qj.renderers.cellDecorator=e),Qj.renderers["".concat(be(t),"Renderer")]=e})),Qj.renderers.registerRenderer=Gi,Qj.renderers.getRenderer=zi,Qj.validators=null!==(_ct=Qj.validators)&&void 0!==_ct?_ct:{},U(qi(),(function(t){Qj.validators["".concat(be(t),"Validator")]=Qi(t)})),Qj.validators.registerValidator=Ji,Qj.validators.getValidator=Qi,Qj.plugins=null!==(Hct=Qj.plugins)&&void 0!==Hct?Hct:{},U(xi(),(function(t){Qj.plugins[t]=_i(t)})),Qj.plugins["".concat(be(jH.PLUGIN_KEY),"Plugin")]=jH,Qj.plugins.registerPlugin=Ni,Qj.plugins.getPlugin=_i;var Wct=Qj,Uct=function(t,e){var n=e.className;void 0!==n&&Wct.dom.addClass(t,n)},zct=function(t,e,n,r,o,i,a){var l=document.createElement("div");l.style.width="".concat(10*i,"px"),Uct(e,a),Wct.dom.addClass(l,"progressBar"),Wct.dom.empty(e),e.appendChild(l)},Gct=function(t,e,n,r,o,i,a){Wct.renderers.TextRenderer.apply(this,[t,e,n,r,o,"★".repeat(i),a])},Yct=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]),Kct=function(t,e,n,r,o,i){if(0===n){var a=t.parentElement;null!==a&&(i.instance.getDataAtRowProp(e,"0")?Wct.dom.addClass(a,lM):Wct.dom.removeClass(a,lM),e%2===0?Wct.dom.addClass(a,sM):Wct.dom.removeClass(a,sM))}},Xct=function(t,e){var n=document.createElement("input");n.type="checkbox",t>=0&&this.getDataAtRowProp(t,"0")&&(n.checked=!0),Wct.dom.empty(e),e.appendChild(n)};function $ct(t,e){if(!(t<0)){var n=this.isRtl()?"htRight":"htLeft";e.firstChild&&(Yct.has(t.toString())?(Wct.dom.removeClass(e.firstChild,n),Wct.dom.addClass(e.firstChild,Yct.get(t.toString()))):Wct.dom.addClass(e.firstChild,n))}}var qct=function(t,e){var n=t.target;-1===e.col&&t.target&&"INPUT"===n.nodeName&&(t.preventDefault(),this.setDataAtRowProp(e.row,"0",!n.checked))},Qct={name:"DataGrid",data:function(){return{hotSettings:{height:450,dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,afterOnCellMouseDown:qct,afterGetColHeader:$ct,afterGetRowHeader:Xct,beforeRenderer:Kct,colWidths:[140,192,100,90,90,110,97,100,126],colHeaders:["Company name","Name","Sell date","In stock","Qty","Progress","Rating","Order ID","Country"],columns:[{data:1,type:"text"},{data:3,type:"text"},{data:4,type:"date",allowInvalid:!1},{data:6,type:"checkbox",className:"htCenter"},{data:7,type:"numeric"},{data:8,renderer:zct,readOnly:!0,className:"htMiddle"},{data:9,renderer:Gct,readOnly:!0,className:"star htCenter"},{data:5,type:"text"},{data:2,type:"text"}],licenseKey:"non-commercial-and-evaluation"},data:uM()}},components:{HotTable:BA}},Jct=Qct,Zct=n(9917),tft=(0,Zct.Z)(Jct,k,R,!1,null,null,null),eft=tft.exports,nft={name:"App",components:{DataGrid:eft}},rft=nft,oft=(0,Zct.Z)(rft,C,O,!1,null,null,null),ift=oft.exports;console.log("Handsontable: v".concat(Wct.version," (").concat(Wct.buildDate,") Wrapper: v").concat(BA.version," Vue: v").concat(S.ZP.version)),S.ZP.config.silent=!0,new S.ZP({render:function(t){return t(ift)}}).$mount("#app")},5131:function(t,e,n){var r={"./af":4466,"./af.js":4466,"./ar":9252,"./ar-dz":6520,"./ar-dz.js":6520,"./ar-kw":2358,"./ar-kw.js":2358,"./ar-ly":3229,"./ar-ly.js":3229,"./ar-ma":1707,"./ar-ma.js":1707,"./ar-sa":3237,"./ar-sa.js":3237,"./ar-tn":8206,"./ar-tn.js":8206,"./ar.js":9252,"./az":9665,"./az.js":9665,"./be":2888,"./be.js":2888,"./bg":5945,"./bg.js":5945,"./bm":6375,"./bm.js":6375,"./bn":758,"./bn-bd":533,"./bn-bd.js":533,"./bn.js":758,"./bo":5502,"./bo.js":5502,"./br":70,"./br.js":70,"./bs":295,"./bs.js":295,"./ca":6647,"./ca.js":6647,"./cs":4343,"./cs.js":4343,"./cv":9886,"./cv.js":9886,"./cy":2985,"./cy.js":2985,"./da":139,"./da.js":139,"./de":472,"./de-at":994,"./de-at.js":994,"./de-ch":4824,"./de-ch.js":4824,"./de.js":472,"./dv":9271,"./dv.js":9271,"./el":5195,"./el.js":5195,"./en-au":8847,"./en-au.js":8847,"./en-ca":1348,"./en-ca.js":1348,"./en-gb":9053,"./en-gb.js":9053,"./en-ie":1853,"./en-ie.js":1853,"./en-il":4135,"./en-il.js":4135,"./en-in":7122,"./en-in.js":7122,"./en-nz":3011,"./en-nz.js":3011,"./en-sg":6714,"./en-sg.js":6714,"./eo":197,"./eo.js":197,"./es":4293,"./es-do":8029,"./es-do.js":8029,"./es-mx":1154,"./es-mx.js":1154,"./es-us":8357,"./es-us.js":8357,"./es.js":4293,"./et":6720,"./et.js":6720,"./eu":5808,"./eu.js":5808,"./fa":4924,"./fa.js":4924,"./fi":5949,"./fi.js":5949,"./fil":6108,"./fil.js":6108,"./fo":2687,"./fo.js":2687,"./fr":6724,"./fr-ca":9466,"./fr-ca.js":9466,"./fr-ch":867,"./fr-ch.js":867,"./fr.js":6724,"./fy":9550,"./fy.js":9550,"./ga":4735,"./ga.js":4735,"./gd":9878,"./gd.js":9878,"./gl":9787,"./gl.js":9787,"./gom-deva":6492,"./gom-deva.js":6492,"./gom-latn":5339,"./gom-latn.js":5339,"./gu":836,"./gu.js":836,"./he":9315,"./he.js":9315,"./hi":3724,"./hi.js":3724,"./hr":3730,"./hr.js":3730,"./hu":7657,"./hu.js":7657,"./hy-am":1918,"./hy-am.js":1918,"./id":2215,"./id.js":2215,"./is":4095,"./is.js":4095,"./it":2446,"./it-ch":1947,"./it-ch.js":1947,"./it.js":2446,"./ja":9545,"./ja.js":9545,"./jv":1437,"./jv.js":1437,"./ka":1689,"./ka.js":1689,"./kk":8900,"./kk.js":8900,"./km":5620,"./km.js":5620,"./kn":7081,"./kn.js":7081,"./ko":8130,"./ko.js":8130,"./ku":5295,"./ku.js":5295,"./ky":8578,"./ky.js":8578,"./lb":8773,"./lb.js":8773,"./lo":6366,"./lo.js":6366,"./lt":2532,"./lt.js":2532,"./lv":3902,"./lv.js":3902,"./me":3636,"./me.js":3636,"./mi":4059,"./mi.js":4059,"./mk":6005,"./mk.js":6005,"./ml":2982,"./ml.js":2982,"./mn":5543,"./mn.js":5543,"./mr":4898,"./mr.js":4898,"./ms":4145,"./ms-my":8766,"./ms-my.js":8766,"./ms.js":4145,"./mt":4780,"./mt.js":4780,"./my":3445,"./my.js":3445,"./nb":4372,"./nb.js":4372,"./ne":2862,"./ne.js":2862,"./nl":2254,"./nl-be":3293,"./nl-be.js":3293,"./nl.js":2254,"./nn":6986,"./nn.js":6986,"./oc-lnc":6623,"./oc-lnc.js":6623,"./pa-in":3802,"./pa-in.js":3802,"./pl":2560,"./pl.js":2560,"./pt":6467,"./pt-br":3595,"./pt-br.js":3595,"./pt.js":6467,"./ro":5092,"./ro.js":5092,"./ru":2238,"./ru.js":2238,"./sd":5555,"./sd.js":5555,"./se":7291,"./se.js":7291,"./si":3013,"./si.js":3013,"./sk":7005,"./sk.js":7005,"./sl":284,"./sl.js":284,"./sq":7274,"./sq.js":7274,"./sr":1344,"./sr-cyrl":1521,"./sr-cyrl.js":1521,"./sr.js":1344,"./ss":9573,"./ss.js":9573,"./sv":8865,"./sv.js":8865,"./sw":1769,"./sw.js":1769,"./ta":1108,"./ta.js":1108,"./te":2002,"./te.js":2002,"./tet":3164,"./tet.js":3164,"./tg":6599,"./tg.js":6599,"./th":1806,"./th.js":1806,"./tk":2315,"./tk.js":2315,"./tl-ph":3296,"./tl-ph.js":3296,"./tlh":3102,"./tlh.js":3102,"./tr":5886,"./tr.js":5886,"./tzl":6963,"./tzl.js":6963,"./tzm":1203,"./tzm-latn":4676,"./tzm-latn.js":4676,"./tzm.js":1203,"./ug-cn":1444,"./ug-cn.js":1444,"./uk":2676,"./uk.js":2676,"./ur":5026,"./ur.js":5026,"./uz":9895,"./uz-latn":1873,"./uz-latn.js":1873,"./uz.js":9895,"./vi":5646,"./vi.js":5646,"./x-pseudo":7377,"./x-pseudo.js":7377,"./yo":9632,"./yo.js":9632,"./zh-cn":5665,"./zh-cn.js":5665,"./zh-hk":627,"./zh-hk.js":627,"./zh-mo":7922,"./zh-mo.js":7922,"./zh-tw":8973,"./zh-tw.js":8973};function o(t){var e=i(t);return n(e)}function i(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}o.keys=function(){return Object.keys(r)},o.resolve=i,t.exports=o,o.id=5131}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=t,function(){var t=[];n.O=function(e,r,o,i){if(!r){var a=1/0;for(c=0;c<t.length;c++){r=t[c][0],o=t[c][1],i=t[c][2];for(var l=!0,s=0;s<r.length;s++)(!1&i||a>=i)&&Object.keys(n.O).every((function(t){return n.O[t](r[s])}))?r.splice(s--,1):(l=!1,i<a&&(a=i));if(l){t.splice(c--,1);var u=o();void 0!==u&&(e=u)}}return e}i=i||0;for(var c=t.length;c>0&&t[c-1][2]>i;c--)t[c]=t[c-1];t[c]=[r,o,i]}}(),function(){n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,r){var o,i,a=r[0],l=r[1],s=r[2],u=0;if(a.some((function(e){return 0!==t[e]}))){for(o in l)n.o(l,o)&&(n.m[o]=l[o]);if(s)var c=s(n)}for(e&&e(r);u<a.length;u++)i=a[u],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(c)},r=self["webpackChunkvue_template"]=self["webpackChunkvue_template"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(1093)}));r=n.O(r)})();
//# sourceMappingURL=app.d79c9c70.js.map