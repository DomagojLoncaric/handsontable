(function(){var t={1093:function(t,e,o){"use strict";var n={};o.r(n),o.d(n,{arrayAvg:function(){return _},arrayEach:function(){return O},arrayFilter:function(){return H},arrayFlatten:function(){return D},arrayMap:function(){return A},arrayMax:function(){return N},arrayMin:function(){return P},arrayReduce:function(){return I},arraySum:function(){return k},arrayUnique:function(){return L},extendArray:function(){return T},getDifferenceOfArrays:function(){return V},getIntersectionOfArrays:function(){return B},getUnionOfArrays:function(){return F},pivot:function(){return x},stringToArray:function(){return W},to2dArray:function(){return M}});var s={};o.r(s),o.d(s,{_injectProductInfo:function(){return it},isDefined:function(){return z},isEmpty:function(){return G},isRegExp:function(){return Y},isUndefined:function(){return $},stringify:function(){return U}});var i={};o.r(i),o.d(i,{equalsIgnoreCase:function(){return at},isPercentValue:function(){return ct},randomString:function(){return ht},sanitize:function(){return gt},stripTags:function(){return ut},substitute:function(){return dt},toUpperCaseFirst:function(){return lt}});var r={};o.r(r),o.d(r,{HTML_CHARACTERS:function(){return Ht},addClass:function(){return Mt},addEvent:function(){return Yt},clearTextSelection:function(){return Jt},closest:function(){return Ct},closestDown:function(){return yt},empty:function(){return It},fastInnerHTML:function(){return At},fastInnerText:function(){return Ot},getCaretPosition:function(){return Xt},getComputedStyle:function(){return jt},getCssTransform:function(){return re},getFrameElement:function(){return ft},getParent:function(){return mt},getParentWindow:function(){return pt},getScrollLeft:function(){return Lt},getScrollTop:function(){return Dt},getScrollableElement:function(){return Vt},getScrollbarWidth:function(){return oe},getSelectionEndPosition:function(){return qt},getSelectionText:function(){return Qt},getStyle:function(){return Ft},getTrimmingContainer:function(){return Bt},getWindowScrollLeft:function(){return _t},getWindowScrollTop:function(){return Pt},hasAccessToParentWindow:function(){return wt},hasClass:function(){return Et},hasHorizontalScrollbar:function(){return se},hasVerticalScrollbar:function(){return ne},index:function(){return bt},innerHeight:function(){return $t},innerWidth:function(){return Gt},isChildOf:function(){return vt},isDetached:function(){return de},isInput:function(){return ae},isOutsideInput:function(){return he},isVisible:function(){return kt},matchesCSSRules:function(){return Wt},observeVisibilityChangeOnce:function(){return ue},offset:function(){return Nt},outerHeight:function(){return zt},outerWidth:function(){return Ut},overlayContainsElement:function(){return St},removeClass:function(){return Tt},removeEvent:function(){return Kt},removeTextNodes:function(){return xt},resetCssTransform:function(){return le},selectElementIfAllowed:function(){return ce},setCaretPosition:function(){return Zt},setOverlayPosition:function(){return ie}});var l={};o.r(l),o.d(l,{curry:function(){return ye},curryRight:function(){return ve},debounce:function(){return pe},fastCall:function(){return be},isFunction:function(){return ge},partial:function(){return Ce},pipe:function(){return we},throttle:function(){return me},throttleAfterHits:function(){return fe}});var a={};o.r(a),o.d(a,{clone:function(){return xe},createObjectPropListener:function(){return De},deepClone:function(){return Te},deepExtend:function(){return Me},deepObjectSize:function(){return _e},defineGetter:function(){return Oe},duckSchema:function(){return Se},extend:function(){return Ee},getProperty:function(){return Ne},hasOwnProperty:function(){return Le},inherit:function(){return Re},isObject:function(){return Ae},isObjectEqual:function(){return He},mixin:function(){return Ie},objectEach:function(){return ke},setProperty:function(){return Pe}});var h={};o.r(h),o.d(h,{isChrome:function(){return Ue},isChromeWebKit:function(){return ze},isEdge:function(){return Ke},isEdgeWebKit:function(){return Xe},isFirefox:function(){return $e},isFirefoxWebKit:function(){return Ge},isIOS:function(){return Qe},isIpadOS:function(){return Je},isLinuxOS:function(){return eo},isMacOS:function(){return to},isMobileBrowser:function(){return qe},isSafari:function(){return Ye},isWindowsOS:function(){return Ze},setBrowserMeta:function(){return We},setPlatformMeta:function(){return je}});var c={};o.r(c),o.d(c,{KEY_CODES:function(){return oo},isCtrlKey:function(){return ro},isCtrlMetaKey:function(){return lo},isFunctionKey:function(){return io},isKey:function(){return ao},isPrintableChar:function(){return so}});var d={};o.r(d),o.d(d,{isImmediatePropagationStopped:function(){return co},isLeftClick:function(){return go},isRightClick:function(){return uo},stopImmediatePropagation:function(){return ho}});var u={};o.r(u),o.d(u,{_dataToHTML:function(){return qo},htmlToGridSettings:function(){return Qo},instanceToHTML:function(){return Xo}});var g={};o.r(g),o.d(g,{isNumeric:function(){return Jo},isNumericLike:function(){return Zo},rangeEach:function(){return tn},rangeEachReverse:function(){return en},valueAccordingPercent:function(){return on}});var m={};o.r(m),o.d(m,{cancelAnimationFrame:function(){return Wn},getComparisonFunction:function(){return zn},isTouchSupported:function(){return jn},requestAnimationFrame:function(){return Fn}});var f={};o.r(f),o.d(f,{countFirstRowKeys:function(){return sl},createEmptySpreadsheetData:function(){return ol},createSpreadsheetData:function(){return tl},createSpreadsheetObjectData:function(){return el},dataRowToChangesArray:function(){return nl},isArrayOfArrays:function(){return il},isArrayOfObjects:function(){return rl},spreadsheetColumnIndex:function(){return Zr},spreadsheetColumnLabel:function(){return Jr}});var p={};o.r(p),o.d(p,{CONTEXTMENU_ITEMS_ADD_COMMENT:function(){return Na},CONTEXTMENU_ITEMS_ALIGNMENT:function(){return La},CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:function(){return za},CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:function(){return Ba},CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:function(){return Wa},CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:function(){return Va},CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:function(){return Ua},CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:function(){return Fa},CONTEXTMENU_ITEMS_ALIGNMENT_TOP:function(){return ja},CONTEXTMENU_ITEMS_BORDERS:function(){return $a},CONTEXTMENU_ITEMS_BORDERS_BOTTOM:function(){return Ka},CONTEXTMENU_ITEMS_BORDERS_LEFT:function(){return Xa},CONTEXTMENU_ITEMS_BORDERS_RIGHT:function(){return Ya},CONTEXTMENU_ITEMS_BORDERS_TOP:function(){return Ga},CONTEXTMENU_ITEMS_CLEAR_COLUMN:function(){return Ra},CONTEXTMENU_ITEMS_COPY:function(){return Ea},CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:function(){return xa},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:function(){return Ta},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:function(){return Ma},CONTEXTMENU_ITEMS_CUT:function(){return Ia},CONTEXTMENU_ITEMS_EDIT_COMMENT:function(){return Pa},CONTEXTMENU_ITEMS_FREEZE_COLUMN:function(){return Ha},CONTEXTMENU_ITEMS_HIDE_COLUMN:function(){return Za},CONTEXTMENU_ITEMS_HIDE_ROW:function(){return eh},CONTEXTMENU_ITEMS_INSERT_LEFT:function(){return pa},CONTEXTMENU_ITEMS_INSERT_RIGHT:function(){return wa},CONTEXTMENU_ITEMS_MERGE_CELLS:function(){return Oa},CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:function(){return Ja},CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:function(){return Qa},CONTEXTMENU_ITEMS_NO_ITEMS:function(){return ga},CONTEXTMENU_ITEMS_READ_ONLY:function(){return Sa},CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:function(){return Da},CONTEXTMENU_ITEMS_REDO:function(){return ba},CONTEXTMENU_ITEMS_REMOVE_BORDERS:function(){return qa},CONTEXTMENU_ITEMS_REMOVE_COLUMN:function(){return ya},CONTEXTMENU_ITEMS_REMOVE_COMMENT:function(){return _a},CONTEXTMENU_ITEMS_REMOVE_ROW:function(){return Ca},CONTEXTMENU_ITEMS_ROW_ABOVE:function(){return ma},CONTEXTMENU_ITEMS_ROW_BELOW:function(){return fa},CONTEXTMENU_ITEMS_SHOW_COLUMN:function(){return th},CONTEXTMENU_ITEMS_SHOW_ROW:function(){return oh},CONTEXTMENU_ITEMS_UNDO:function(){return va},CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:function(){return Aa},CONTEXTMENU_ITEMS_UNMERGE_CELLS:function(){return ka},CONTEXT_MENU_ITEMS_NAMESPACE:function(){return da},FILTERS_BUTTONS_CANCEL:function(){return Ph},FILTERS_BUTTONS_CLEAR:function(){return kh},FILTERS_BUTTONS_OK:function(){return Nh},FILTERS_BUTTONS_PLACEHOLDER_SEARCH:function(){return _h},FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:function(){return Lh},FILTERS_BUTTONS_PLACEHOLDER_VALUE:function(){return Dh},FILTERS_BUTTONS_SELECT_ALL:function(){return Oh},FILTERS_CONDITIONS_AFTER:function(){return bh},FILTERS_CONDITIONS_BEFORE:function(){return Sh},FILTERS_CONDITIONS_BEGINS_WITH:function(){return ch},FILTERS_CONDITIONS_BETWEEN:function(){return yh},FILTERS_CONDITIONS_BY_VALUE:function(){return mh},FILTERS_CONDITIONS_CONTAINS:function(){return uh},FILTERS_CONDITIONS_EMPTY:function(){return rh},FILTERS_CONDITIONS_ENDS_WITH:function(){return dh},FILTERS_CONDITIONS_EQUAL:function(){return ah},FILTERS_CONDITIONS_GREATER_THAN:function(){return fh},FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:function(){return ph},FILTERS_CONDITIONS_LESS_THAN:function(){return wh},FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:function(){return Ch},FILTERS_CONDITIONS_NAMESPACE:function(){return sh},FILTERS_CONDITIONS_NONE:function(){return ih},FILTERS_CONDITIONS_NOT_BETWEEN:function(){return vh},FILTERS_CONDITIONS_NOT_CONTAIN:function(){return gh},FILTERS_CONDITIONS_NOT_EMPTY:function(){return lh},FILTERS_CONDITIONS_NOT_EQUAL:function(){return hh},FILTERS_CONDITIONS_TODAY:function(){return Rh},FILTERS_CONDITIONS_TOMORROW:function(){return Eh},FILTERS_CONDITIONS_YESTERDAY:function(){return Mh},FILTERS_DIVS_FILTER_BY_CONDITION:function(){return Th},FILTERS_DIVS_FILTER_BY_VALUE:function(){return xh},FILTERS_LABELS_CONJUNCTION:function(){return Ih},FILTERS_LABELS_DISJUNCTION:function(){return Hh},FILTERS_NAMESPACE:function(){return nh},FILTERS_VALUES_BLANK_CELLS:function(){return Ah}});var w={};o.r(w),o.d(w,{getNormalizedDate:function(){return Tm}});var C=o(6427),y=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("DataGrid")],1)},v=[],b=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"example"}},[e("hot-table",{ref:"hotTableComponent",attrs:{data:t.data,settings:t.hotSettings}})],1)},S=[],R=(o(9796),o(3247),o(9028),o(9757)),E=o(8289);function M(t){const e=t.length;let o=0;while(o<e)t[o]=[t[o]],o+=1}function T(t,e){const o=e.length;let n=0;while(n<o)t.push(e[n]),n+=1}function x(t){const e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;const o=t.length,n=t[0].length;for(let s=0;s<o;s++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][s]=t[s][o];return e}function I(t,e,o,n){let s=-1,i=t,r=o;Array.isArray(t)||(i=Array.from(t));const l=i.length;n&&l&&(s+=1,r=i[s]),s+=1;while(s<l)r=e(r,i[s],s,i),s+=1;return r}function H(t,e){let o=0,n=t;Array.isArray(t)||(n=Array.from(t));const s=n.length,i=[];let r=-1;while(o<s){const t=n[o];e(t,o,n)&&(r+=1,i[r]=t),o+=1}return i}function A(t,e){let o=0,n=t;Array.isArray(t)||(n=Array.from(t));const s=n.length,i=[];let r=-1;while(o<s){const t=n[o];r+=1,i[r]=e(t,o,n),o+=1}return i}function O(t,e){let o=0,n=t;Array.isArray(t)||(n=Array.from(t));const s=n.length;while(o<s){if(!1===e(n[o],o,n))break;o+=1}return t}function k(t){return I(t,((t,e)=>t+e),0)}function N(t){return I(t,((t,e)=>t>e?t:e),Array.isArray(t)?t[0]:void 0)}function P(t){return I(t,((t,e)=>t<e?t:e),Array.isArray(t)?t[0]:void 0)}function _(t){return t.length?k(t)/t.length:0}function D(t){return I(t,((t,e)=>t.concat(Array.isArray(e)?D(e):e)),[])}function L(t){const e=[];return O(t,(t=>{-1===e.indexOf(t)&&e.push(t)})),e}function V(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...s]=[...e];let i=n;return O(s,(t=>{i=i.filter((e=>!t.includes(e)))})),i}function B(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...s]=[...e];let i=n;return O(s,(t=>{i=i.filter((e=>t.includes(e)))})),i}function F(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...s]=[...e],i=new Set(n);return O(s,(t=>{O(t,(t=>{i.has(t)||i.add(t)}))})),Array.from(i)}function W(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}function j(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];const s=I(t,((t,e,n)=>{const s=e.replace(/\r?\n\s*/g,""),i=o[n]?o[n]:"";return t+s+i}),"");return s.trim()}function U(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function z(t){return"undefined"!==typeof t}function $(t){return"undefined"===typeof t}function G(t){return null===t||""===t||$(t)}function Y(t){return"[object RegExp]"===Object.prototype.toString.call(t)}const K="length",X=t=>parseInt(t,16),q=t=>parseInt(t,10),Q=(t,e,o)=>t["substr"](e,o),J=t=>t["codePointAt"](0)-65,Z=t=>`${t}`.replace(/\-/g,""),tt=t=>X(Q(Z(t),X("12"),J("F")))/(X(Q(Z(t),J("B"),~~![][K]))||9),et=()=>"undefined"!==typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let ot=!1;const nt={invalid:()=>j`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:o}=t;return j`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${o}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>j`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},st={invalid:()=>j`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:o}=t;return j`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${o}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>j`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function it(t,e){const o=!G(t),n="string"===typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),s="13.0.0";let i,r="invalid",l="invalid";t=Z(t||"");const a=rt(t);if(o||n||a)if(a){const e=E("22/06/2023","DD/MM/YYYY"),o=Math.floor(e.toDate().getTime()/864e5),n=tt(t);i=E(864e5*(n+1),"x").format("MMMM DD, YYYY"),o>n?(r="expired",l="expired"):(r="valid",l="valid")}else n?(r="non_commercial",l="valid"):(r="invalid",l="invalid");else r="missing",l="missing";if(et()&&(r="valid",l="valid"),!ot&&"valid"!==r){const t=nt[r]({keyValidityDate:i,hotVersion:s});t&&console["non_commercial"===r?"info":"warn"](nt[r]({keyValidityDate:i,hotVersion:s})),ot=!0}if("valid"!==l&&e.parentNode){const t=st[l]({keyValidityDate:i,hotVersion:s});if(t){const t=document.createElement("div");t.className="hot-display-license-info",t.innerHTML=st[l]({keyValidityDate:i,hotVersion:s}),e.parentNode.insertBefore(t,e.nextSibling)}}}function rt(t){let e=[][K],o=e;if(t[K]!==J("Z"))return!1;for(let n="",s="B<H4P+".split(""),i=J(s.shift());i;i=J(s.shift()||"A"))--i<""[K]?o|=(q(`${q(X(n)+(X(Q(t,Math.abs(i),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=Q(t,i,i?1===s[K]?9:8:6);return o===e}function lt(t){return t[0].toUpperCase()+t.substr(1)}function at(){const t=[];for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];let s=o.length;while(s){s-=1;const e=U(o[s]).toLowerCase();-1===t.indexOf(e)&&t.push(e)}return 1===t.length}function ht(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function ct(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function dt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,((t,o)=>"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[o]?"":e[o]))}function ut(t){return gt(`${t}`,{ALLOWED_TAGS:[]})}function gt(t,e){return R.sanitize(t,e)}function mt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=-1,n=null,s=t;while(null!==s){if(o===e){n=s;break}s.host&&s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?s=s.host:(o+=1,s=s.parentNode)}return n}function ft(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function pt(t){return ft(t)&&t.parent}function wt(t){return!!Object.getPrototypeOf(t.parent)}function Ct(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:s}=Node;let i=t;while(null!==i&&void 0!==i&&i!==o){const{nodeType:t,nodeName:o}=i;if(t===n&&(e.includes(o)||e.includes(i)))return i;const{host:r}=i;i=r&&t===s?r:i.parentNode}return null}function yt(t,e,o){const n=[];let s=t;while(s){if(s=Ct(s,e,o),!s||o&&!o.contains(s))break;n.push(s),s=s.host&&s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?s.host:s.parentNode}const i=n.length;return i?n[i-1]:null}function vt(t,e){let o=t.parentNode,n=[];"string"===typeof e?n=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);while(null!==o){if(n.indexOf(o)>-1)return!0;o=o.parentNode}return!1}function bt(t){let e=0,o=t;if(o.previousSibling)while(o=o.previousSibling)e+=1;return e}function St(t,e,o){const n=o.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function Rt(t){return t&&t.length?t.filter((t=>!!t)):[]}function Et(t,e){return void 0!==t.classList&&"string"===typeof e&&""!==e&&t.classList.contains(e)}function Mt(t,e){"string"===typeof e&&(e=e.split(" ")),e=Rt(e),e.length>0&&t.classList.add(...e)}function Tt(t,e){"string"===typeof e&&(e=e.split(" ")),e=Rt(e),e.length>0&&t.classList.remove(...e)}function xt(t){if(3===t.nodeType)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let t=e.length-1;t>=0;t--)xt(e[t])}}function It(t){let e;while(e=t.lastChild)t.removeChild(e)}const Ht=/(<(.*)>|&(.*);)/;function At(t,e){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Ht.test(e)?t.innerHTML=o?gt(e):e:Ot(t,e)}function Ot(t,e){const o=t.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.textContent=e:(It(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function kt(t){const e=t.ownerDocument.documentElement;let o=t;while(o!==e){if(null===o)return!1;if(o.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(o.host){if(o.host.impl)return kt(o.host.impl);if(o.host)return kt(o.host);throw new Error("Lost in Web Components world")}return!1}if(o.style&&"none"===o.style.display)return!1;o=o.parentNode}return!0}function Nt(t){const e=t.ownerDocument,o=e.defaultView,n=e.documentElement;let s,i,r,l=t;s=l.offsetLeft,i=l.offsetTop,r=l;while(l=l.offsetParent){if(l===e.body)break;s+=l.offsetLeft,i+=l.offsetTop,r=l}return r&&"fixed"===r.style.position&&(s+=o.pageXOffset||n.scrollLeft,i+=o.pageYOffset||n.scrollTop),{left:s,top:i}}function Pt(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollY}function _t(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollX}function Dt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?Pt(e):t.scrollTop}function Lt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?_t(e):t.scrollLeft}function Vt(t){let e=t.ownerDocument,o=e?e.defaultView:void 0;e||(e=t.document?t.document:t,o=e.defaultView);const n=["auto","scroll"];let s=t.parentNode;while(s&&s.style&&e.body!==s){let{overflow:t,overflowX:e,overflowY:i}=s.style;if([t,e,i].includes("scroll"))return s;if(({overflow:t,overflowX:e,overflowY:i}=o.getComputedStyle(s)),n.includes(t)||n.includes(e)||n.includes(i))return s;if(s.clientHeight<=s.scrollHeight+1&&(n.includes(i)||n.includes(t)))return s;if(s.clientWidth<=s.scrollWidth+1&&(n.includes(e)||n.includes(t)))return s;s=s.parentNode}return o}function Bt(t){const e=t.ownerDocument,o=e.defaultView;let n=t.parentNode;while(n&&n.style&&e.body!==n){if("visible"!==n.style.overflow&&""!==n.style.overflow)return n;const t=jt(n,o),e=["scroll","hidden","auto"],s=t.getPropertyValue("overflow"),i=t.getPropertyValue("overflow-y"),r=t.getPropertyValue("overflow-x");if(e.includes(s)||e.includes(i)||e.includes(r))return n;n=n.parentNode}return o}function Ft(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!t)return;if(t===o)return"width"===e?`${o.innerWidth}px`:"height"===e?`${o.innerHeight}px`:void 0;const n=t.style[e];if(""!==n&&void 0!==n)return n;const s=jt(t,o);return""!==s[e]&&void 0!==s[e]?s[e]:void 0}function Wt(t,e){const{selectorText:o}=e;let n=!1;return e.type===CSSRule.STYLE_RULE&&o&&(t.msMatchesSelector?n=t.msMatchesSelector(o):t.matches&&(n=t.matches(o))),n}function jt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function Ut(t){return t.offsetWidth}function zt(t){return t.offsetHeight}function $t(t){return t.clientHeight||t.innerHeight}function Gt(t){return t.clientWidth||t.innerWidth}function Yt(t,e,o){t.addEventListener(e,o,!1)}function Kt(t,e,o){t.removeEventListener(e,o,!1)}function Xt(t){return t.selectionStart?t.selectionStart:0}function qt(t){return t.selectionEnd?t.selectionEnd:0}function Qt(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;const e=t.document;let o="";return t.getSelection?o=t.getSelection().toString():e.selection&&"Control"!==e.selection.type&&(o=e.selection.createRange().text),o}function Jt(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Zt(t,e,o){if(void 0===o&&(o=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,o)}catch(n){const s=t.parentNode,i=s.style.display;s.style.display="block",t.setSelectionRange(e,o),s.style.display=i}}}let te;function ee(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const o=t.createElement("div");o.style.boxSizing="content-box",o.style.height="150px",o.style.left="0px",o.style.overflow="hidden",o.style.position="absolute",o.style.top="0px",o.style.width="200px",o.style.visibility="hidden",o.appendChild(e),(t.body||t.documentElement).appendChild(o);const n=e.offsetWidth;o.style.overflow="scroll";let s=e.offsetWidth;return n===s&&(s=o.clientWidth),(t.body||t.documentElement).removeChild(o),n-s}function oe(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===te&&(te=ee(t)),te}function ne(t){return t.offsetWidth!==t.clientWidth}function se(t){return t.offsetHeight!==t.clientHeight}function ie(t,e,o){t.style.transform=`translate3d(${e},${o},0)`}function re(t){let e;return t.style.transform&&""!==(e=t.style.transform)?["transform",e]:-1}function le(t){t.style.transform&&""!==t.style.transform&&(t.style.transform="")}function ae(t){const e=["INPUT","SELECT","TEXTAREA"];return t&&(e.indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function he(t){return ae(t)&&!1===t.hasAttribute("data-hot-input")}function ce(t){const e=t.ownerDocument.activeElement;he(e)||t.select()}function de(t){return!t.parentNode}function ue(t,e){const o=new IntersectionObserver(((o,n)=>{o.forEach((o=>{o.isIntersecting&&null!==t.offsetParent&&(e(),n.unobserve(t))}))}),{root:t.ownerDocument.body});o.observe(t)}function ge(t){return"function"===typeof t}function me(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=0;const n={lastCallThrottled:!0};let s=null;function i(){for(var i=arguments.length,r=new Array(i),l=0;l<i;l++)r[l]=arguments[l];const a=Date.now();let h=!1;n.lastCallThrottled=!0,o||(o=a,h=!0);const c=e-(a-o);return h?(n.lastCallThrottled=!1,t.apply(this,r)):(s&&clearTimeout(s),s=setTimeout((()=>{n.lastCallThrottled=!1,t.apply(this,r),o=0,s=void 0}),c)),n}return i}function fe(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;const n=me(t,e);let s=o;function i(){s=o}function r(){for(var e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return s?(s-=1,t.apply(this,o)):n.apply(this,o)}return r.clearHits=i,r}function pe(t){let e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=null;function s(){for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n&&clearTimeout(n),n=setTimeout((()=>{e=t.apply(this,i)}),o),e}return s}function we(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];const[n,...s]=e;return function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return I(s,((t,e)=>e(t)),n.apply(this,e))}}function Ce(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return t.apply(this,o.concat(n))}}function ye(t){const e=t.length;function o(n){return function(){for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];const l=n.concat(i);let a;return a=l.length>=e?t.apply(this,l):o(l),a}}return o([])}function ve(t){const e=t.length;function o(n){return function(){for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];const l=n.concat(i.reverse());let a;return a=l.length>=e?t.apply(this,l):o(l),a}}return o([])}function be(t,e,o,n,s,i,r,l){return z(l)?t.call(e,o,n,s,i,r,l):z(r)?t.call(e,o,n,s,i,r):z(i)?t.call(e,o,n,s,i):z(s)?t.call(e,o,n,s):z(n)?t.call(e,o,n):z(o)?t.call(e,o):t.call(e)}o(7751);function Se(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},ke(t,((t,o)=>{"__children"!==o&&(t&&"object"===typeof t&&!Array.isArray(t)?e[o]=Se(t):Array.isArray(t)?t.length&&"object"===typeof t[0]&&!Array.isArray(t[0])?e[o]=[Se(t[0])]:e[o]=[]:e[o]=null)}))),e}function Re(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Ee(t,e,o){const n=Array.isArray(o);return ke(e,((e,s)=>{(!1===n||o.includes(s))&&(t[s]=e)})),t}function Me(t,e){ke(e,((o,n)=>{e[n]&&"object"===typeof e[n]?(t[n]||(Array.isArray(e[n])?t[n]=[]:"[object Date]"===Object.prototype.toString.call(e[n])?t[n]=e[n]:t[n]={}),Me(t[n],e[n])):t[n]=e[n]}))}function Te(t){return"object"===typeof t?JSON.parse(JSON.stringify(t)):t}function xe(t){const e={};return ke(t,((t,o)=>{e[o]=t})),e}function Ie(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];return O(o,(e=>{t.MIXINS.push(e.MIXIN_NAME),ke(e,((e,o)=>{if(void 0!==t.prototype[o])throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if("function"===typeof e)t.prototype[o]=e;else{const n=function(t,e){const o=`_${t}`,n=t=>{let e=t;return(Array.isArray(e)||Ae(e))&&(e=Te(e)),e};return function(){return void 0===this[o]&&(this[o]=n(e)),this[o]}},s=function(t){const e=`_${t}`;return function(t){this[e]=t}};Object.defineProperty(t.prototype,o,{get:n(o,e),set:s(o),configurable:!0})}}))})),t}function He(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Ae(t){return"[object Object]"===Object.prototype.toString.call(t)}function Oe(t,e,o,n){n.value=o,n.writable=!1!==n.writable,n.enumerable=!1!==n.enumerable,n.configurable=!1!==n.configurable,Object.defineProperty(t,e,n)}function ke(t,e){for(const o in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,o))&&!1===e(t[o],o,t))break;return t}function Ne(t,e){const o=e.split(".");let n=t;return ke(o,(t=>{if(n=n[t],void 0===n)return n=void 0,!1})),n}function Pe(t,e,o){const n=e.split(".");let s=t;n.forEach(((t,e)=>{e!==n.length-1?(Le(s,t)||(s[t]={}),s=s[t]):s[t]=o}))}function _e(t){if(!Ae(t))return 0;const e=function(t){let o=0;return Ae(t)?ke(t,((t,n)=>{"__children"!==n&&(o+=e(t))})):o+=1,o};return e(t)}function De(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const o=`_${e}`,n={_touched:!1,[o]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[o]},set(t){this._touched=!0,this[o]=t},enumerable:!0,configurable:!0}),n}function Le(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const Ve=t=>{const e={value:!1,test:(o,n)=>{e.value=t(o,n)}};return e},Be={chrome:Ve(((t,e)=>/Chrome/.test(t)&&/Google/.test(e))),chromeWebKit:Ve((t=>/CriOS/.test(t))),edge:Ve((t=>/Edge/.test(t))),edgeWebKit:Ve((t=>/EdgiOS/.test(t))),firefox:Ve((t=>/Firefox/.test(t))),firefoxWebKit:Ve((t=>/FxiOS/.test(t))),mobile:Ve((t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t))),safari:Ve(((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e)))},Fe={mac:Ve((t=>/^Mac/.test(t))),win:Ve((t=>/^Win/.test(t))),linux:Ve((t=>/^Linux/.test(t))),ios:Ve((t=>/iPhone|iPad|iPod/i.test(t)))};function We(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ke(Be,(o=>{let{test:n}=o;n(t,e)}))}function je(){let{platform:t=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ke(Fe,(e=>{let{test:o}=e;o(t)}))}function Ue(){return Be.chrome.value}function ze(){return Be.chromeWebKit.value}function $e(){return Be.firefox.value}function Ge(){return Be.firefoxWebKit.value}function Ye(){return Be.safari.value}function Ke(){return Be.edge.value}function Xe(){return Be.edgeWebKit.value}function qe(){return Be.mobile.value}function Qe(){return Fe.ios.value}function Je(){let{maxTouchPoints:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return t>2&&Fe.mac.value}function Ze(){return Fe.win.value}function to(){return Fe.mac.value}function eo(){return Fe.linux.value}We(),je();const oo={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:$e()?182:174,AUDIO_MUTE:$e()?181:173,AUDIO_UP:$e()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},no=[oo.ALT,oo.ARROW_DOWN,oo.ARROW_LEFT,oo.ARROW_RIGHT,oo.ARROW_UP,oo.AUDIO_DOWN,oo.AUDIO_MUTE,oo.AUDIO_UP,oo.BACKSPACE,oo.CAPS_LOCK,oo.DELETE,oo.END,oo.ENTER,oo.ESCAPE,oo.F1,oo.F2,oo.F3,oo.F4,oo.F5,oo.F6,oo.F7,oo.F8,oo.F9,oo.F10,oo.F11,oo.F12,oo.F13,oo.F14,oo.F15,oo.F16,oo.F17,oo.F18,oo.F19,oo.HOME,oo.INSERT,oo.MEDIA_NEXT,oo.MEDIA_PLAY_PAUSE,oo.MEDIA_PREV,oo.MEDIA_STOP,oo.NULL,oo.NUM_LOCK,oo.PAGE_DOWN,oo.PAGE_UP,oo.PAUSE,oo.SCROLL_LOCK,oo.SHIFT,oo.TAB];function so(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function io(t){return no.includes(t)}function ro(t){const e=[];return to()?e.push(oo.COMMAND_LEFT,oo.COMMAND_RIGHT,oo.COMMAND_FIREFOX):e.push(oo.CONTROL),e.includes(t)}function lo(t){return[oo.CONTROL,oo.COMMAND_LEFT,oo.COMMAND_RIGHT,oo.COMMAND_FIREFOX].includes(t)}function ao(t,e){const o=e.split("|");let n=!1;return O(o,(e=>{if(t===oo[e])return n=!0,!1})),n}function ho(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function co(t){return!1===t.isImmediatePropagationEnabled}function uo(t){return 2===t.button}function go(t){return 0===t.button}function mo(){z(console)&&console.warn(...arguments)}function fo(){z(console)&&console.error(...arguments)}const po=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],wo=j`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Co=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),yo=new Map([]);class vo{static getSingleton(){return So()}constructor(){this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const t=Object.create(null);return O(po,(e=>t[e]=[])),t}getBucket(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}add(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))O(e,(e=>this.add(t,e,o)));else{Co.has(t)&&mo(dt(wo,{hookName:t,removedInVersion:Co.get(t)})),yo.has(t)&&mo(yo.get(t));const n=this.getBucket(o);if("undefined"===typeof n[t]&&(this.register(t),n[t]=[]),e.skip=!1,-1===n[t].indexOf(e)){let o=!1;e.initialHook&&O(n[t],((s,i)=>{if(s.initialHook)return n[t][i]=e,o=!0,!1})),o||n[t].push(e)}}return this}once(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?O(e,(e=>this.once(t,e,o))):(e.runOnce=!0,this.add(t,e,o))}remove(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n=this.getBucket(o);return"undefined"!==typeof n[t]&&n[t].indexOf(e)>=0&&(e.skip=!0,!0)}has(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const o=this.getBucket(e);return!(void 0===o[t]||!o[t].length)}run(t,e,o,n,s,i,r,l){{const a=this.globalBucket[e],h=a?a.length:0;let c=0;if(h)while(c<h){if(!a[c]||a[c].skip){c+=1;continue}const h=be(a[c],t,o,n,s,i,r,l);void 0!==h&&(o=h),a[c]&&a[c].runOnce&&this.remove(e,a[c]),c+=1}}{const a=this.getBucket(t)[e],h=a?a.length:0;let c=0;if(h)while(c<h){if(!a[c]||a[c].skip){c+=1;continue}const h=be(a[c],t,o,n,s,i,r,l);void 0!==h&&(o=h),a[c]&&a[c].runOnce&&this.remove(e,a[c],t),c+=1}}return o}destroy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;ke(this.getBucket(t),((t,e,o)=>o[e].length=0))}register(t){this.isRegistered(t)||po.push(t)}deregister(t){this.isRegistered(t)&&po.splice(po.indexOf(t),1)}isDeprecated(t){return yo.has(t)||Co.has(t)}isRegistered(t){return po.indexOf(t)>=0}getRegistered(){return po}}const bo=new vo;function So(){return bo}var Ro=vo;const Eo=new Map;function Mo(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";Eo.has(t)||Eo.set(t,new Map);const e=Eo.get(t);function o(t,o){e.set(t,o)}function n(t){return e.get(t)}function s(t){return e.has(t)}function i(){return[...e.keys()]}function r(){return[...e.values()]}return{register:o,getItem:n,hasItem:s,getNames:i,getValues:r}}const To=new WeakMap,{register:xo,getItem:Io,hasItem:Ho,getNames:Ao,getValues:Oo}=Mo("editors");function ko(t){const e={},o=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new o(t)),e[t.guid]},Ro.getSingleton().add("afterDestroy",(function(){e[this.guid]=null}))}function No(t,e){let o;if("function"===typeof t)To.get(t)||_o(null,t),o=To.get(t);else{if("string"!==typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');o=Io(t)}if(!o)throw Error(`No editor registered under name "${t}"`);return o.getInstance(e)}function Po(t){if("function"===typeof t)return t;if(!Ho(t))throw Error(`No registered editor found under "${t}" name`);return Io(t).getConstructor()}function _o(t,e){t&&"string"!==typeof t&&(e=t,t=e.EDITOR_TYPE);const o=new ko(e);"string"===typeof t&&xo(t,o),To.set(e,o)}let Do=0;class Lo{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function s(t){o.call(this,Vo(t))}return this.context.eventListeners.push({element:t,event:e,callback:o,callbackProxy:s,options:n,eventManager:this}),t.addEventListener(e,s,n),Do+=1,()=>{this.removeEventListener(t,e,o)}}removeEventListener(t,e,o){let n,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.context.eventListeners.length;while(i)if(i-=1,n=this.context.eventListeners[i],n.event===e&&n.element===t){if(o&&o!==n.callback)continue;if(s&&n.eventManager!==this)continue;this.context.eventListeners.splice(i,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),Do-=1}}clearEvents(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let e=this.context.eventListeners.length;while(e){e-=1;const o=this.context.eventListeners[e];t&&o.eventManager!==this||(this.context.eventListeners.splice(e,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),Do-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(t,e){let o=t.document,n=t;o||(o=t.ownerDocument?t.ownerDocument:t,n=o.defaultView);const s={bubbles:!0,cancelable:"mousemove"!==e,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let i;o.createEvent?(i=o.createEvent("MouseEvents"),i.initMouseEvent(e,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,s.relatedTarget||o.body.parentNode)):i=o.createEventObject(),t.dispatchEvent?t.dispatchEvent(i):t.fireEvent(`on${e}`,i)}}function Vo(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),ho(this)},t}var Bo=Lo;function Fo(){return Do}const Wo="editorManager.navigation",jo="editorManager.handlingEditor";class Uo{constructor(t,e,o){this.instance=t,this.tableMeta=e,this.selection=o,this.eventManager=new Bo(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;const n=this.instance.getShortcutManager();n.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",(t=>this.onAfterDocumentKeyDown(t))),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(t=>{!this.destroyed&&this.instance.isListening()&&this.openEditor("",t)})),this.instance.view._wt.update("onCellDblClick",((t,e,o)=>this.onCellDblClick(t,e,o)))}registerShortcuts(){const t=this.instance.getShortcutManager(),e=t.getContext("grid"),o=t.getContext("editor"),n={group:jo};o.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(e,o)=>{this.closeEditorAndSaveChanges(t.isCtrlPressed()),this.moveSelectionAfterEnter(o.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>{this.closeEditorAndRestoreOriginalValue(t.isCtrlPressed()),this.activeEditor.focus()}}],n),e.addShortcuts([{keys:[["F2"]],callback:t=>{this.openEditor(null,t,!0)}},{keys:[["Backspace"],["Delete"]],callback:()=>{this.instance.emptySelectedCells(),this.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>{this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.openEditor(null,t,!0):this.moveSelectionAfterEnter(e.includes("shift")),ho(t)}}],{...n,runOnlyIf:()=>z(this.instance.getSelected())})}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(t){this.lock||this.closeEditor(t)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,(t=>{t&&this.prepareEditor()}));const{row:t,col:e}=this.instance.getSelectedRangeLast().highlight,o=this.instance.runHooks("modifyGetCellCoords",t,e);let n=t,s=e;Array.isArray(o)&&([n,s]=o),this.cellProperties=this.instance.getCellMeta(n,s);const{activeElement:i}=this.instance.rootDocument;if(i&&he(i)&&i.blur(),!this.isCellEditable())return void this.clearActiveEditor();const r=this.instance.getCell(t,e,!0);if(r){const o=this.instance.getCellEditor(this.cellProperties),i=this.instance.colToProp(s),l=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(n),s);this.activeEditor=No(o,this.instance),this.activeEditor.prepare(t,e,i,r,l,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.isCellEditable()){if(!this.activeEditor){const{row:t,col:e}=this.instance.getSelectedRangeLast().highlight,o=this.instance.rowIndexMapper.getRenderableFromVisualIndex(t),n=this.instance.columnIndexMapper.getRenderableFromVisualIndex(e);this.instance.view.scrollViewport(this.instance._createCellCoords(o,n)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(o&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))}else this.clearActiveEditor()}closeEditor(t,e,o){this.activeEditor?this.activeEditor.finishEditing(t,e,o):o&&o(!1)}closeEditorAndSaveChanges(t){this.closeEditor(!1,t)}closeEditorAndRestoreOriginalValue(t){this.closeEditor(!0,t)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const t=this.instance.getCellEditor(this.cellProperties),{row:e,col:o}=this.instance.getSelectedRangeLast().highlight,{rowIndexMapper:n,columnIndexMapper:s}=this.instance,i=n.isHidden(this.instance.toPhysicalRow(e))||s.isHidden(this.instance.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!t||i)}moveSelectionAfterEnter(t){const e="function"===typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;t?this.selection.transformStart(-e.row,-e.col):this.selection.transformStart(e.row,e.col,!0)}onAfterDocumentKeyDown(t){if(!this.instance.isListening())return;const{keyCode:e}=t;if(!this.selection.isSelected())return;const o=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!io(e)&&!lo(e)&&!o&&!this.isEditorOpened()){const e=this.instance.getShortcutManager(),o=e.getContext("editor"),n={runOnlyIf:()=>z(this.instance.getSelected()),group:Wo};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.instance.selection.transformStart(0,-1*this.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.instance.selection.transformStart(0,this.instance.getDirectionFactor())}}],n),this.openEditor("",t)}}onCellDblClick(t,e,o){"TD"===o.nodeName&&this.openEditor(null,t,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}const zo=new WeakMap;Uo.getInstance=function(t,e,o){let n=zo.get(t);return n||(n=new Uo(t,e,o),zo.set(t,n)),n};var $o=Uo;const Go={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Yo=new RegExp(Object.keys(Go).map((t=>`(${t})`)).join("|"),"gi");function Ko(t){return"TABLE"===(t&&t.nodeName||"")}function Xo(t){const e=t.hasColHeaders(),o=t.hasRowHeaders(),n=[e?-1:0,o?-1:0,t.countRows()-1,t.countCols()-1],s=t.getData(...n),i=s.length,r=i>0?s[0].length:0,l=["<table>","</table>"],a=e?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],c=o?1:0,d=e?1:0;for(let u=0;u<i;u+=1){const n=e&&0===u,i=[];for(let e=0;e<r;e+=1){const r=!n&&o&&0===e;let l="";if(n)l=`<th>${t.getColHeader(e-c)}</th>`;else if(r)l=`<th>${t.getRowHeader(u-d)}</th>`;else{const o=s[u][e],{hidden:n,rowspan:i,colspan:r}=t.getCellMeta(u-d,e-c);if(!n){const t=[];if(i&&t.push(`rowspan="${i}"`),r&&t.push(`colspan="${r}"`),G(o))l=`<td ${t.join(" ")}></td>`;else{const e=o.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");l=`<td ${t.join(" ")}>${e}</td>`}}}i.push(l)}const l=["<tr>",...i,"</tr>"].join("");n?a.splice(1,0,l):h.splice(-1,0,l)}return l.splice(1,0,a.join(""),h.join("")),l.join("")}function qo(t){const e=t.length,o=["<table>"];for(let n=0;n<e;n+=1){const s=t[n],i=s.length,r=[];0===n&&o.push("<tbody>");for(let t=0;t<i;t+=1){const e=s[t],o=G(e)?"":e.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,(t=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(t.length-1)} </span>`)).replace(/\t/gi,"&#9;");r.push(`<td>${o}</td>`)}o.push("<tr>",...r,"</tr>"),n+1===e&&o.push("</tbody>")}return o.push("</table>"),o.join("")}function Qo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const o={},n=e.createDocumentFragment(),s=e.createElement("div");n.appendChild(s);let i=t;if("string"===typeof i){const t=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(t=>{const e=t.match(/<td\b[^>]*?>/g)[0],o=t.substring(e.length,t.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),n="</td>";return`${e}${o}${n}`}));s.insertAdjacentHTML("afterbegin",`${t}`),i=s.querySelector("table")}if(!i||!Ko(i))return;const r=s.querySelector('meta[name$="enerator"]'),l=null!==i.querySelector("tbody th"),a=i.querySelector("tr"),h=a?Array.from(a.cells).reduce(((t,e)=>t+e.colSpan),0)-(l?1:0):0,c=i.tFoot&&Array.from(i.tFoot.rows)||[],d=[];let u=!1,g=0,m=0;if(i.tHead){const t=Array.from(i.tHead.rows).filter((t=>{const e=null!==t.querySelector("td");return e&&d.push(t),!e}));g=t.length,u=g>0,g>1?o.nestedHeaders=Array.from(t).reduce(((t,e)=>{const o=Array.from(e.cells).reduce(((t,e,o)=>{if(l&&0===o)return t;const{colSpan:n,innerHTML:s}=e,i=n>1?{label:s,colspan:n}:s;return t.push(i),t}),[]);return t.push(o),t}),[]):u&&(o.colHeaders=Array.from(t[0].children).reduce(((t,e,o)=>(l&&0===o||t.push(e.innerHTML),t)),[]))}d.length&&(o.fixedRowsTop=d.length),c.length&&(o.fixedRowsBottom=c.length);const f=[...d,...Array.from(i.tBodies).reduce(((t,e)=>(t.push(...Array.from(e.rows)),t)),[]),...c];m=f.length;const p=new Array(m);for(let y=0;y<m;y++)p[y]=new Array(h);const w=[],C=[];for(let y=0;y<m;y++){const t=f[y],e=Array.from(t.cells),o=e.length;for(let n=0;n<o;n++){const t=e[n],{nodeName:o,innerHTML:s,rowSpan:i,colSpan:l}=t,a=p[y].findIndex((t=>void 0===t));if("TD"===o){if(i>1||l>1){for(let t=y;t<y+i;t++)if(t<m)for(let e=a;e<a+l;e++)p[t][e]=null;const e=t.getAttribute("style"),o=e&&e.includes("mso-ignore:colspan");o||w.push({col:a,row:y,rowspan:i,colspan:l})}let e="";e=r&&/excel/gi.test(r.content)?s.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):s.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),p[y][a]=e.replace(Yo,(t=>Go[t]))}else C.push(s)}}return w.length&&(o.mergeCells=w),C.length&&(o.rowHeaders=C),p.length&&(o.data=p),o}function Jo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=typeof t;if("number"===o)return!isNaN(t)&&isFinite(t);if("string"===o){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);const o=Array.from(new Set([".",...e])).map((t=>`\\${t}`)).join("|");return new RegExp(`^[+-]?\\s*(((${o})?\\d+((${o})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}return"object"===o&&(!!t&&"number"===typeof t.valueOf()&&!(t instanceof Date))}function Zo(t){return Jo(t,[","])}function tn(t,e,o){let n=-1;"function"===typeof e?(o=e,e=t):n=t-1;while(++n<=e)if(!1===o(n))break}function en(t,e,o){let n=t+1;"function"===typeof e&&(o=e,e=0);while(--n>=e)if(!1===o(n))break}function on(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}const nn="asc",sn="desc",rn=new Map([[nn,[-1,1]],[sn,[1,-1]]]),ln=t=>`The priority '${t}' is already declared in a map.`,an=t=>`The priority '${t}' is not a number.`;function hn(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=new Map;function n(n,s){if(!Jo(n))throw new Error(e(n));if(o.has(n))throw new Error(t(n));o.set(n,s)}function s(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nn;const[e,n]=rn.get(t)||rn.get(nn);return[...o].sort(((t,o)=>t[0]<o[0]?e:n)).map((t=>t[1]))}return t=ge(t)?t:ln,e=ge(e)?e:an,{addItem:n,getItems:s}}const cn=t=>`The id '${t}' is already declared in a map.`;function dn(){let{errorIdExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Map;function o(o,n){if(a(o))throw new Error(t(o));e.set(o,n)}function n(t){return e.delete(t)}function s(){e.clear()}function i(t){const[e]=l().find((e=>{let[o,n]=e;return t===n&&o}))||[null];return e}function r(t){return e.get(t)}function l(){return[...e]}function a(t){return e.has(t)}return t=ge(t)?t:cn,{addItem:o,clear:s,getId:i,getItem:r,getItems:l,hasItem:a,removeItem:n}}const un=t=>`'${t}' value is already declared in a unique set.`;function gn(){let{errorItemExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Set;function o(o){if(e.has(o))throw new Error(t(o));e.add(o)}function n(){return[...e]}function s(){e.clear()}return t=ge(t)?t:un,{addItem:o,clear:s,getItems:n}}const mn=t=>`There is already registered "${t}" plugin.`,fn=t=>`There is already registered plugin on priority "${t}".`,pn=t=>`The priority "${t}" is not a number.`,wn=hn({errorPriorityExists:fn,errorPriorityNaN:pn}),Cn=gn({errorItemExists:mn}),yn=dn({errorIdExists:mn});function vn(){return[...wn.getItems(),...Cn.getItems()]}function bn(t){const e=lt(t);return yn.getItem(e)}function Sn(t){return!!bn(t)}function Rn(t,e,o){[t,e,o]=Mn(t,e,o),void 0===bn(t)&&En(t,e,o)}function En(t,e,o){const n=lt(t);if(yn.hasItem(n))throw new Error(mn(n));void 0===o?Cn.addItem(n):wn.addItem(o,n),yn.addItem(n,e)}function Mn(t,e,o){return"function"===typeof t&&(e=t,t=e.PLUGIN_KEY,o=e.PLUGIN_PRIORITY),[t,e,o]}const{register:Tn,getItem:xn,hasItem:In,getNames:Hn,getValues:An}=Mo("renderers");function On(t){if("function"===typeof t)return t;if(!In(t))throw Error(`No registered renderer found under "${t}" name`);return xn(t)}function kn(t,e){"string"!==typeof t&&(e=t,t=e.RENDERER_TYPE),Tn(t,e)}const{register:Nn,getItem:Pn,hasItem:_n,getNames:Dn,getValues:Ln}=Mo("validators");function Vn(t){if("function"===typeof t)return t;if(!_n(t))throw Error(`No registered validator found under "${t}" name`);return Pn(t)}function Bn(t,e){"string"!==typeof t&&(e=t,t=e.VALIDATOR_TYPE),Nn(t,e)}function Fn(t){return window.requestAnimationFrame(t)}function Wn(t){window.cancelAnimationFrame(t)}function jn(){return"ontouchstart"in window}let Un;function zn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Un||(Un="object"===typeof Intl?new Intl.Collator(t,e).compare:"function"===typeof String.prototype.localeCompare?(t,e)=>`${t}`.localeCompare(e):(t,e)=>t===e?0:t>e?-1:1,Un)}const $n=new WeakMap;class Gn{constructor(t,e,o,n,s,i){let r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.wtSettings=o,this.domBindings=e,this.wtTable=s,this.selections=i,this.parent=r,this.eventManager=n,this.facadeGetter=t,$n.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}registerEvents(){this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",(t=>this.onContextMenu(t))),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",(t=>this.onMouseOver(t))),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",(t=>this.onMouseOut(t)));const t=()=>{this.eventManager.addEventListener(this.wtTable.holder,"touchstart",(t=>this.onTouchStart(t))),this.eventManager.addEventListener(this.wtTable.holder,"touchend",(t=>this.onTouchEnd(t))),this.momentumScrolling||(this.momentumScrolling={}),this.eventManager.addEventListener(this.wtTable.holder,"scroll",(()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||this.wtSettings.getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout((()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,this.wtSettings.getSetting("onAfterMomentumScroll"))}),200)}))},e=()=>{this.eventManager.addEventListener(this.wtTable.holder,"mouseup",(t=>this.onMouseUp(t))),this.eventManager.addEventListener(this.wtTable.holder,"mousedown",(t=>this.onMouseDown(t)))};qe()?t():(jn()&&t(),e())}selectedCellWasTouched(t){const e=$n.get(this),o=this.parentCell(t),n=o.coords;if(e.selectedCellBeforeTouchEnd&&n){const[t,o]=[n.row,e.selectedCellBeforeTouchEnd.from.row],[s,i]=[n.col,e.selectedCellBeforeTouchEnd.from.col];return t===o&&s===i}return!1}parentCell(t){const e={},o=this.wtTable.TABLE,n=yt(t,["TD","TH"],o);return n?(e.coords=this.wtTable.getCoords(n),e.TD=n):Et(t,"wtBorder")&&Et(t,"current")?(e.coords=this.selections.getCell().cellRange.highlight,e.TD=this.wtTable.getCell(e.coords)):Et(t,"wtBorder")&&Et(t,"area")&&this.selections.createOrGetArea().cellRange&&(e.coords=this.selections.createOrGetArea().cellRange.to,e.TD=this.wtTable.getCell(e.coords)),e}onMouseDown(t){const e=$n.get(this),o=this.domBindings.rootDocument.activeElement,n=Ce(mt,t.target),s=t.target;if(s===o||n(0)===o||n(1)===o)return;const i=this.parentCell(s);Et(s,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",t,s):i.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,i.coords,i.TD),(0===t.button||this.touchApplied)&&i.TD&&(e.dblClickOrigin[0]=i.TD,clearTimeout(e.dblClickTimeout[0]),e.dblClickTimeout[0]=setTimeout((()=>{e.dblClickOrigin[0]=null}),1e3))}onContextMenu(t){if(this.wtSettings.has("onCellContextMenu")){const e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}onMouseOver(t){if(!this.wtSettings.has("onCellMouseOver"))return;const e=this.wtTable.TABLE,o=yt(t.target,["TD","TH"],e),n=this.parent||this;o&&o!==n.lastMouseOver&&vt(o,e)&&(n.lastMouseOver=o,this.callListener("onCellMouseOver",t,this.wtTable.getCoords(o),o))}onMouseOut(t){if(!this.wtSettings.has("onCellMouseOut"))return;const e=this.wtTable.TABLE,o=yt(t.target,["TD","TH"],e),n=yt(t.relatedTarget,["TD","TH"],e),s=this.parent||this;o&&o!==n&&vt(o,e)&&(this.callListener("onCellMouseOut",t,this.wtTable.getCoords(o),o),null===n&&(s.lastMouseOver=null))}onMouseUp(t){const e=$n.get(this),o=this.parentCell(t.target);o.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,o.coords,o.TD),(0===t.button||this.touchApplied)&&(o.TD===e.dblClickOrigin[0]&&o.TD===e.dblClickOrigin[1]?(Et(t.target,"corner")?this.callListener("onCellCornerDblClick",t,o.coords,o.TD):this.callListener("onCellDblClick",t,o.coords,o.TD),e.dblClickOrigin[0]=null,e.dblClickOrigin[1]=null):o.TD===e.dblClickOrigin[0]&&(e.dblClickOrigin[1]=o.TD,clearTimeout(e.dblClickTimeout[1]),e.dblClickTimeout[1]=setTimeout((()=>{e.dblClickOrigin[1]=null}),500)))}onTouchStart(t){const e=$n.get(this);e.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(t)}onTouchEnd(t){var e;const o=t.target,n=null===(e=this.parentCell(o))||void 0===e?void 0:e.coords,s=z(n)&&n.row>=0&&n.col>=0,i=t.cancelable&&s&&this.wtSettings.getSetting("isDataViewInstance");if(i){const e=["A","BUTTON","INPUT"];Qe()&&(ze()||Ge())&&this.selectedCellWasTouched(o)&&!e.includes(o.tagName)?t.preventDefault():this.selectedCellWasTouched(o)||t.preventDefault()}this.onMouseUp(t),this.touchApplied=!1}callListener(t,e,o,n){const s=this.wtSettings.getSettingPure(t);s&&s(e,o,n,this.facadeGetter())}destroy(){const t=$n.get(this);clearTimeout(t.dblClickTimeout[0]),clearTimeout(t.dblClickTimeout[1]),this.eventManager.destroy()}}var Yn=Gn;class Kn{constructor(t,e,o){this.offset=t,this.total=e,this.countTH=o}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleRowHeadedColumnToSourceColumn(t){return this.renderedToSource(this.offsettedTH(t))}sourceColumnToVisibleRowHeadedColumn(t){return this.unOffsettedTH(this.sourceToRendered(t))}}var Xn=Kn;class qn{constructor(t,e,o){this.offset=t,this.total=e,this.countTH=o}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleColHeadedRowToSourceRow(t){return this.renderedToSource(this.offsettedTH(t))}sourceRowToVisibleColHeadedRow(t){return this.unOffsettedTH(this.sourceToRendered(t))}}var Qn=qn;const Jn=0,Zn=1,ts=2;class es{constructor(){this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}setSize(t){this.currentSize=this.nextSize,this.nextSize=t}setOffset(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}class os{constructor(){this.size=new es,this.workingSpace=Jn,this.sharedSize=null}setSize(t){this.size.setSize(t)}setOffset(t){this.size.setOffset(t)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof es}isPlaceOn(t){return this.workingSpace===t}append(t){this.workingSpace=Zn,t.workingSpace=ts,this.sharedSize=t.getViewSize()}prepend(t){this.workingSpace=ts,t.workingSpace=Zn,this.sharedSize=t.getViewSize()}}class ns{constructor(t,e,o){this.rootNode=t,this.nodesPool=e,this.sizeSet=new os,this.childNodeType=o.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}setSize(t){return this.sizeSet.setSize(t),this}setOffset(t){return this.sizeSet.setOffset(t),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}getCurrentNode(){const t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}getRenderedChildCount(){const{rootNode:t,sizeSet:e}=this;let o=0;if(this.isSharedViewSet()){let n=t.firstElementChild;while(n){if(n.tagName===this.childNodeType)o+=1;else if(e.isPlaceOn(Zn))break;n=n.nextElementSibling}}else o=t.childElementCount;return o}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:t,sizeSet:e}=this,o=this.isSharedViewSet(),{nextSize:n}=e.getViewSize();let s=this.getRenderedChildCount();while(s<n){const n=this.nodesPool();!o||o&&e.isPlaceOn(ts)?t.appendChild(n):t.insertBefore(n,t.firstChild),s+=1}const i=o&&e.isPlaceOn(Zn);while(s>n)t.removeChild(i?t.firstChild:t.lastChild),s-=1}render(){const{rootNode:t,sizeSet:e}=this;let o=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(ts)&&(o+=e.sharedSize.nextSize);let n=t.childNodes[o];if(n.tagName!==this.childNodeType){const e=this.nodesPool();t.replaceChild(e,n),n=e}this.collectedNodes.push(n),this.visualIndex+=1}end(){}}class ss extends ns{prependView(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}appendView(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}class is{constructor(t){this.nodeType=t.toUpperCase()}setRootDocument(t){this.rootDocument=t}obtain(){return this.rootDocument.createElement(this.nodeType)}}class rs{constructor(t,e){this.nodesPool="string"===typeof t?new is(t):null,this.nodeType=t,this.rootNode=e,this.table=null,this.renderedNodes=0}setTable(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}adjust(){}render(){}}class ls extends rs{constructor(){super("TH"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new ss(t,(t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,rowHeaderFunctions:e,rowHeadersCount:o,rows:n,cells:s}=this.table;for(let i=0;i<t;i++){const t=this.table.renderedRowToSource(i),r=n.getRenderedNode(i);this.sourceRowIndex=t;const l=this.obtainOrderView(r),a=s.obtainOrderView(r);l.appendView(a).setSize(o).setOffset(this.table.renderedColumnToSource(0)).start();for(let n=0;n<o;n++){l.render();const o=l.getCurrentNode();o.className="",o.removeAttribute("style"),e[n](t,o,n)}l.end()}}}class as extends rs{constructor(t){super(null,t)}adjust(){const{columnHeadersCount:t,rowHeadersCount:e}=this.table;let o=this.rootNode.firstChild;if(t){const{columnsToRender:n}=this.table,s=n+e;for(let e=0,r=t;e<r;e++){o=this.rootNode.childNodes[e],o||(o=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(o)),this.renderedNodes=o.childNodes.length;while(this.renderedNodes<s)o.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;while(this.renderedNodes>s)o.removeChild(o.lastChild),this.renderedNodes-=1}const i=this.rootNode.childNodes.length;if(i>t)for(let e=t;e<i;e++)this.rootNode.removeChild(this.rootNode.lastChild)}else o&&It(o)}render(){const{columnHeadersCount:t}=this.table;for(let e=0;e<t;e+=1){const{columnHeaderFunctions:t,columnsToRender:o,rowHeadersCount:n}=this.table,s=this.rootNode.childNodes[e];for(let i=-1*n;i<o;i+=1){const o=this.table.renderedColumnToSource(i),r=s.childNodes[i+n];r.className="",r.removeAttribute("style"),t[e](o,r,e)}}}}class hs extends rs{constructor(t){super(null,t)}adjust(){const{columnsToRender:t,rowHeadersCount:e}=this.table,o=t+e;while(this.renderedNodes<o)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;while(this.renderedNodes>o)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:t,rowHeadersCount:e}=this.table;for(let n=0;n<e;n++){const t=this.table.renderedColumnToSource(n),e=this.table.columnUtils.getHeaderWidth(t);this.rootNode.childNodes[n].style.width=`${e}px`}for(let n=0;n<t;n++){const t=this.table.renderedColumnToSource(n),o=this.table.columnUtils.getStretchedColumnWidth(t);this.rootNode.childNodes[n+e].style.width=`${o}px`}const o=this.rootNode.firstChild;o&&Mt(o,"rowHeader")}}let cs=!1;class ds extends rs{constructor(t){super("TR",t),this.orderView=new ns(t,(t=>this.nodesPool.obtain(t)),this.nodeType)}getRenderedNode(t){return this.orderView.getNode(t)}render(){const{rowsToRender:t}=this.table;!cs&&t>1e3&&(cs=!0,mo(j`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(let e=0;e<t;e++)this.orderView.render();this.orderView.end()}}class us extends rs{constructor(){super("TD"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new ss(t,(t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,columnsToRender:e,rows:o,rowHeaders:n}=this.table;for(let s=0;s<t;s++){const t=this.table.renderedRowToSource(s),i=o.getRenderedNode(s);this.sourceRowIndex=t;const r=this.obtainOrderView(i),l=n.obtainOrderView(i);r.prependView(l).setSize(e).setOffset(this.table.renderedColumnToSource(0)).start();for(let o=0;o<e;o++){r.render();const e=r.getCurrentNode(),n=this.table.renderedColumnToSource(o);Et(e,"hide")||(e.className=""),e.removeAttribute("style"),e.removeAttribute("dir"),this.table.cellRenderer(t,n,e)}r.end()}}}class gs{constructor(t){let{cellRenderer:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=e}setAxisUtils(t,e){this.rowUtils=t,this.columnUtils=e}setViewportSize(t,e){this.rowsToRender=t,this.columnsToRender=e}setFilters(t,e){this.rowFilter=t,this.columnFilter=e}setHeaderContentRenderers(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}setRenderers(){let{rowHeaders:t,columnHeaders:e,colGroup:o,rows:n,cells:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setTable(this),e.setTable(this),o.setTable(this),n.setTable(this),s.setTable(this),this.rowHeaders=t,this.columnHeaders=e,this.colGroup=o,this.rows=n,this.cells=s}renderedRowToSource(t){return this.rowFilter.renderedToSource(t)}renderedColumnToSource(t){return this.columnFilter.renderedToSource(t)}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:t,rows:e}=this;for(let o=0;o<t;o++){const t=e.getRenderedNode(o);if(t.firstChild){const e=this.renderedRowToSource(o),n=this.rowUtils.getHeight(e);t.firstChild.style.height=n?n-1+"px":""}}}}class ms{constructor(){let{TABLE:t,THEAD:e,COLGROUP:o,TBODY:n,rowUtils:s,columnUtils:i,cellRenderer:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new gs(t,{cellRenderer:r}),this.renderer.setRenderers({rowHeaders:new ls,columnHeaders:new as(e),colGroup:new hs(o),rows:new ds(n),cells:new us}),this.renderer.setAxisUtils(s,i)}setFilters(t,e){return this.renderer.setFilters(t,e),this}setViewportSize(t,e){return this.renderer.setViewportSize(t,e),this}setHeaderContentRenderers(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}class fs{constructor(t,e){this.dataAccessObject=t,this.wtSettings=e,this.headerWidths=new Map}getWidth(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(t){const e=this.dataAccessObject.wtViewport.columnsRenderCalculator;let o=this.getWidth(t);if(e){const n=e.getStretchedColumnWidth(t,o);n&&(o=n)}return o}getHeaderHeight(t){let e=this.wtSettings.getSetting("defaultRowHeight");const o=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==o&&(e=e?Math.max(e,o):o),e}getHeaderWidth(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}calculateWidths(){const{wtSettings:t}=this,{wtTable:e,wtViewport:o,cloneSource:n}=this.dataAccessObject,s=n?n.wtTable.holder:e.holder,i=s.offsetHeight<s.scrollHeight?oe():0;let r=t.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-i),r=t.getSetting("onModifyRowHeaderWidth",r),null!==r&&void 0!==r){const e=t.getSetting("rowHeaders").length,o=t.getSetting("defaultColumnWidth");for(let t=0;t<e;t++){let e=Array.isArray(r)?r[t]:r;e=null===e||void 0===e?o:e,this.headerWidths.set(t,e)}}}}class ps{constructor(t,e){this.dataAccessObject=t,this.wtSettings=e}getHeight(t){let e=this.wtSettings.getSetting("rowHeight",t);const o=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==o&&(e=void 0===e?o:Math.max(e,o)),e}}const ws="top",Cs="bottom",ys="inline_start",vs="top_inline_start_corner",bs="bottom_inline_start_corner",Ss=[ws,Cs,ys,vs,bs],Rs=new Map([[ws,`ht_clone_${ws}`],[Cs,`ht_clone_${Cs}`],[ys,`ht_clone_${ys} ht_clone_left`],[vs,`ht_clone_${vs} ht_clone_top_left_corner`],[bs,`ht_clone_${bs} ht_clone_bottom_left_corner`]]);function Es(t,e,o){return e=Ms(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ms(t){var e=Ts(t,"string");return"symbol"===typeof e?e:String(e)}function Ts(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class xs{constructor(t,e,o,n,s){Es(this,"wtSettings",null),Es(this,"domBindings",void 0),Es(this,"TBODY",null),Es(this,"THEAD",null),Es(this,"COLGROUP",null),Es(this,"hasTableHeight",!0),Es(this,"hasTableWidth",!0),Es(this,"isTableVisible",!1),Es(this,"tableOffset",0),Es(this,"holderOffset",0),this.domBindings=o,this.isMaster="master"===s,this.name=s,this.dataAccessObject=t,this.facadeGetter=e,this.wtSettings=n,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=o.rootTable,xt(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const i=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(()=>this._modifyRowHeaderWidth(i))),this.rowUtils=new ps(this.dataAccessObject,this.wtSettings),this.columnUtils=new fs(this.dataAccessObject,this.wtSettings),this.tableRenderer=new ms({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(t){return this.name===t}fixTableDomTree(){const t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(t){const e=t.parentNode;let o;return e&&e.nodeType===Node.ELEMENT_NODE&&Et(e,"wtHolder")||(o=this.domBindings.rootDocument.createElement("div"),o.className="wtSpreader",e&&e.insertBefore(o,t),o.appendChild(t)),o.style.position="relative",o}createHider(t){const e=t.parentNode;let o;return e&&e.nodeType===Node.ELEMENT_NODE&&Et(e,"wtHolder")||(o=this.domBindings.rootDocument.createElement("div"),o.className="wtHider",e&&e.insertBefore(o,t),o.appendChild(t)),o}createHolder(t){const e=t.parentNode;let o;return e&&e.nodeType===Node.ELEMENT_NODE&&Et(e,"wtHolder")||(o=this.domBindings.rootDocument.createElement("div"),o.style.position="relative",o.className="wtHolder",e&&e.insertBefore(o,t),this.isMaster&&(o.parentNode.className+="ht_master handsontable",o.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),o.appendChild(t)),o}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:e}=this,{wtOverlays:o,wtViewport:n}=this.dataAccessObject,s=e.getSetting("totalRows"),i=e.getSetting("totalColumns"),r=e.getSetting("rowHeaders"),l=r.length,a=e.getSetting("columnHeaders"),h=a.length;let c=!1,d=t;if(this.isMaster&&(this.holderOffset=Nt(this.holder),d=n.createRenderCalculators(d),l&&!e.getSetting("fixedColumnsStart"))){const t=o.inlineStartOverlay.getScrollPosition(),e=this.correctHeaderWidth;this.correctHeaderWidth=0!==t,e!==this.correctHeaderWidth&&(d=!1)}if(this.isMaster&&(c=o.updateStateOfRendering()),d)this.isMaster&&n.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=Nt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const t=s>0?this.getFirstRenderedRow():0,e=i>0?this.getFirstRenderedColumn():0;this.rowFilter=new Qn(t,s,h),this.columnFilter=new Xn(e,i,l);let o=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const t={};this.wtSettings.getSetting("beforeDraw",!0,t),o=!0!==t.skipRender}if(o){let t;if(this.tableRenderer.setHeaderContentRenderers(r,a),(this.is(Cs)||this.is(bs))&&this.tableRenderer.setHeaderContentRenderers(r,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(t=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Cs))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const e=Ut(this.hider),o=Ut(this.TABLE);0!==e&&o!==e&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),t!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Cs)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let u=!1;return this.isMaster&&(u=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&(u=o.bottomOverlay.resetFixedPosition()||u),u=o.inlineStartOverlay.resetFixedPosition()||u,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),u?(o.refreshAll(),o.adjustElementsSize()):this.refreshSelections(d),c&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(t){const e=this.columnFilter.renderedToSource(t);let o=this.wtSettings.getSetting("columnHeaders").length;const n=this.wtSettings.getSetting("defaultRowHeight");let s,i,r;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];while(o)o-=1,s=this.getColumnHeaderHeight(o),i=this.getColumnHeader(e,o),i&&(r=$t(i),(!s&&n<r||s<r)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=r),Array.isArray(l)?null!==l[o]&&void 0!==l[o]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l[o]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(l[o]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l[o]||l))}adjustColumnHeaderHeights(){const{wtSettings:t}=this,e=this.THEAD.childNodes,o=this.dataAccessObject.wtViewport.oversizedColumnHeaders,n=t.getSetting("columnHeaders");for(let s=0,i=n.length;s<i;s++)if(o[s]){if(!e[s]||0===e[s].childNodes.length)return;e[s].childNodes[0].style.height=`${o[s]}px`}}resetOversizedRows(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject;if((this.isMaster||this.is(Cs))&&!t.getSetting("externalRowCalculator")){const t=this.getRenderedRowsCount();for(let o=0;o<t;o++){const t=this.rowFilter.renderedToSource(o);e.oversizedRows&&e.oversizedRows[t]&&(e.oversizedRows[t]=void 0)}}}removeClassFromCells(t){const e=this.TABLE.querySelectorAll(`.${t}`);for(let o=0,n=e.length;o<n;o++)Tt(e[o],t)}refreshSelections(t){const{wtSettings:e}=this,{selections:o}=this.dataAccessObject;if(!o)return;const n=Array.from(o),s=n.length;if(t){const t=[];for(let e=0;e<s;e++){const{highlightHeaderClassName:o,highlightRowClassName:s,highlightColumnClassName:i}=n[e].settings,r=n[e].classNames,l=r.length;for(let e=0;e<l;e++)t.includes(r[e])||t.push(r[e]);o&&!t.includes(o)&&t.push(o),s&&!t.includes(s)&&t.push(s),i&&!t.includes(i)&&t.push(i)}const o=e.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(o))for(let e=0;e<o.length;e++)t.push(o[e]);const i=t.length;for(let e=0;e<i;e++)this.removeClassFromCells(t[e])}for(let i=0;i<s;i++)n[i].draw(this.facadeGetter(),t)}getCell(t){let e=t.row,o=t.col;const n=this.wtSettings.getSetting("onModifyGetCellCoords",e,o);if(n&&Array.isArray(n)&&([e,o]=n),this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;if(this.isColumnBeforeRenderedColumns(o))return-3;if(this.isColumnAfterRenderedColumns(o))return-4;const s=this.getRow(e);if(!s&&e>=0)throw new Error("TR was expected to be rendered but is not");const i=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)];if(!i&&o>=0)throw new Error("TD or TH was expected to be rendered but is not");return i}getRow(t){let e=null,o=null;var n,s;t<0?(e=null===(n=this.rowFilter)||void 0===n?void 0:n.sourceRowToVisibleColHeadedRow(t),o=this.THEAD):(e=null===(s=this.rowFilter)||void 0===s?void 0:s.sourceToRendered(t),o=this.TBODY);return void 0!==e&&void 0!==o&&(!(o.childNodes.length<e+1)&&o.childNodes[e])}getColumnHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const o=this.THEAD.childNodes[e];return null===o||void 0===o?void 0:o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}getColumnHeaders(t){const e=[],o=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach((t=>{const n=t.childNodes[o];n&&e.push(n)})),e}getRowHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return;const o=this.wtSettings.getSetting("rowHeaders").length;if(e>=o)return;const n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)];return null===n||void 0===n?void 0:n.childNodes[e]}getRowHeaders(t){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return[];const e=[],o=this.wtSettings.getSetting("rowHeaders").length;for(let n=0;n<o;n++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],s=null===o||void 0===o?void 0:o.childNodes[n];s&&e.push(s)}return e}getCoords(t){let e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=Ct(e,["TD","TH"])),null===e)return null;const o=e.parentNode,n=o.parentNode;let s=bt(o),i=e.cellIndex;if(St(vs,e,this.wtRootElement)||St(ws,e,this.wtRootElement))"THEAD"===n.nodeName&&(s-=n.childNodes.length);else if(St(bs,e,this.wtRootElement)||St(Cs,e,this.wtRootElement)){const t=this.wtSettings.getSetting("totalRows");s=t-n.childNodes.length+s}else s=n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(s):this.rowFilter.renderedToSource(s);return i=St(vs,e,this.wtRootElement)||St(ys,e,this.wtRootElement)||St(bs,e,this.wtRootElement)?this.columnFilter.offsettedTH(i):this.columnFilter.visibleRowHeadedColumnToSourceColumn(i),this.wot.createCellCoords(s,i)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let t=this.TBODY.childNodes.length;const e=t*this.wtSettings.getSetting("defaultRowHeight"),o=$t(this.TBODY)-1;let n,s,i,r,l;if(e!==o||this.wtSettings.getSetting("fixedRowsBottom"))while(t)t-=1,i=this.rowFilter.renderedToSource(t),n=this.getRowHeight(i),r=this.getTrForRow(i),l=r.querySelector("th"),s=l?$t(l):$t(r)-1,(!n&&this.wtSettings.getSetting("defaultRowHeight")<s||n<s)&&(s+=1,this.dataAccessObject.wtViewport.oversizedRows[i]=s)}getTrForRow(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}isColumnHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("rowHeaders"),o=e.length;return Math.abs(t)<=o}isRowHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("columnHeaders"),o=e.length;return Math.abs(t)<=o}isRowBeforeRenderedRows(t){const e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}isRowAfterRenderedRows(t){return t>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(t){const e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}isColumnAfterRenderedColumns(t){return this.columnFilter&&t>this.getLastRenderedColumn()}isColumnAfterViewport(t){return this.columnFilter&&t>this.getLastVisibleColumn()}isRowAfterViewport(t){return this.rowFilter&&t>this.getLastVisibleRow()}isColumnBeforeViewport(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(t){return this.rowUtils.getHeight(t)}getColumnHeaderHeight(t){return this.columnUtils.getHeaderHeight(t)}getColumnWidth(t){return this.columnUtils.getWidth(t)}getStretchedColumnWidth(t){return this.columnUtils.getStretchedColumnWidth(t)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Ut(this.TABLE)}getHeight(){return zt(this.TABLE)}getTotalWidth(){const t=Ut(this.hider);return 0!==t?t:this.getWidth()}getTotalHeight(){const t=zt(this.hider);return 0!==t?t:this.getHeight()}isVisible(){return kt(this.TABLE)}_modifyRowHeaderWidth(t){let e=ge(t)?t():null;return Array.isArray(e)?(e=[...e],e[e.length-1]=this._correctRowHeaderWidth(e[e.length-1])):e=this._correctRowHeaderWidth(e),e}_correctRowHeaderWidth(t){let e=t;return"number"!==typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}var Is=xs;const Hs="stickyRowsTop",As={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows");return 0===t?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};Oe(As,"MIXIN_NAME",Hs,{writable:!1,enumerable:!1});var Os=As;const ks="calculatedColumns",Ns={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible}};Oe(Ns,"MIXIN_NAME",ks,{writable:!1,enumerable:!1});var Ps=Ns;class _s extends Is{constructor(t,e,o,n){super(t,e,o,n,ws)}}Ie(_s,Os),Ie(_s,Ps);var Ds=_s;function Ls(t,e,o){return e=Vs(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Vs(t){var e=Bs(t,"string");return"symbol"===typeof e?e:String(e)}function Bs(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Fs{constructor(t){Ls(this,"dataAccessObject",void 0),Ls(this,"lastScrolledColumnPos",-1),Ls(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}scrollViewport(t,e,o,n,s){const i=this.scrollViewportHorizontally(t.col,o,s),r=this.scrollViewportVertically(t.row,e,n);return i||r}scrollViewportHorizontally(t,e,o){const{drawn:n,totalColumns:s}=this.dataAccessObject;if(!n||!Number.isInteger(t)||t<0||t>s)return!1;const i=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn(),l=void 0===e&&void 0===o,{fixedColumnsStart:a,inlineStartOverlay:h}=this.dataAccessObject;if(l&&t<a)return!1;let c=!1;return-1===i?c=h.scrollTo(t,l?t>this.lastScrolledColumnPos:e):(l&&(t<i||t>r)||!l)&&(c=h.scrollTo(t,l?t>r:e)),c&&(this.lastScrolledColumnPos=t),c}scrollViewportVertically(t,e,o){const{drawn:n,totalRows:s}=this.dataAccessObject;if(!n||!Number.isInteger(t)||t<0||t>s)return!1;const i=this.getFirstVisibleRow(),r=this.getLastVisibleRow(),l=void 0===e&&void 0===o,{fixedRowsBottom:a,fixedRowsTop:h,topOverlay:c}=this.dataAccessObject;if(l&&(t<h||t>s-a-1))return!1;let d=!1;return-1===i?d=c.scrollTo(t,l?t>this.lastScrolledRowPos:o):(l&&(t<i||t>r)||!l)&&(d=c.scrollTo(t,l?t>r:o)),d&&(this.lastScrolledRowPos=t),d}getFirstVisibleRow(){const{topOverlay:t,wtTable:e,wtViewport:o,totalRows:n,fixedRowsTop:s,rootWindow:i}=this.dataAccessObject;let r=e.getFirstVisibleRow();if(t.mainTableScrollableElement===i){const l=Nt(e.wtRootElement),a=$t(e.hider),h=$t(i),c=Dt(i,i);if(l.top+a-h<=c){let e=o.getColumnHeaderHeight();e+=t.sumCellSizes(0,s);for(let o=n;o>0;o--)if(e+=t.sumCellSizes(o-1,o),l.top+a-e<=c){r=o;break}}}return r}getLastVisibleRow(){const{topOverlay:t,wtTable:e,wtViewport:o,totalRows:n,rootWindow:s}=this.dataAccessObject;let i=e.getLastVisibleRow();if(t.mainTableScrollableElement===s){const r=Nt(e.wtRootElement),l=Dt(s,s);if(r.top>l){const e=$t(s);let a=o.getColumnHeaderHeight();for(let o=1;o<=n;o++)if(a+=t.sumCellSizes(o-1,o),r.top+a-l>=e){i=o-2;break}}}return i}getFirstVisibleColumn(){const{inlineStartOverlay:t,wtTable:e,wtViewport:o,totalColumns:n,rootWindow:s}=this.dataAccessObject;let i=e.getFirstVisibleColumn();if(t.mainTableScrollableElement===s){const r=Nt(e.wtRootElement),l=Gt(e.hider),a=Gt(s),h=Math.abs(Lt(s,s));if(r.left+l-a<=h){let e=o.getRowHeaderWidth();for(let o=n;o>0;o--)if(e+=t.sumCellSizes(o-1,o),r.left+l-e<=h){i=o;break}}}return i}getLastVisibleColumn(){const{wtSettings:t,inlineStartOverlay:e,wtTable:o,wtViewport:n,totalColumns:s,rootWindow:i}=this.dataAccessObject;let r=o.getLastVisibleColumn();if(e.mainTableScrollableElement===i){const l=t.getSetting("rtlMode");let a=null;if(l){const t=o.TABLE.getBoundingClientRect(),e=this.dataAccessObject.rootWindow.document,n=e.documentElement.offsetWidth;a=Math.abs(t.right-n)}else{const t=Nt(o.wtRootElement);a=t.left}const h=Math.abs(Lt(i,i));if(a>h){const t=Gt(i);let o=n.getRowHeaderWidth();for(let n=1;n<=s;n++)if(o+=e.sumCellSizes(n-1,n),a+o-h>=t){r=n-2;break}}}return r}}var Ws=Fs;function js(t,e,o){Us(t,e),e.set(t,o)}function Us(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zs(t,e,o){return e=$s(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function $s(t){var e=Gs(t,"string");return"symbol"===typeof e?e:String(e)}function Gs(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ys(t,e){var o=qs(t,e,"get");return Ks(t,o)}function Ks(t,e){return e.get?e.get.call(t):e.value}function Xs(t,e,o){var n=qs(t,e,"set");return Qs(t,n,o),o}function qs(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Qs(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var Js=new WeakMap;class Zs{constructor(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];zs(this,"row",null),zs(this,"col",null),js(this,Js,{writable:!0,value:!1}),Xs(this,Js,o),"undefined"!==typeof t&&"undefined"!==typeof e&&(this.row=t,this.col=e)}isValid(t){return!(this.row<0||this.col<0)&&!(this.row>=t.getSetting("totalRows")||this.col>=t.getSetting("totalColumns"))}isEqual(t){return t===this||this.row===t.row&&this.col===t.col}isSouthEastOf(t){return this.row>=t.row&&(Ys(this,Js)?this.col<=t.col:this.col>=t.col)}isNorthWestOf(t){return this.row<=t.row&&(Ys(this,Js)?this.col>=t.col:this.col<=t.col)}isSouthWestOf(t){return this.row>=t.row&&(Ys(this,Js)?this.col>=t.col:this.col<=t.col)}isNorthEastOf(t){return this.row<=t.row&&(Ys(this,Js)?this.col<=t.col:this.col>=t.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}clone(){return new Zs(this.row,this.col,Ys(this,Js))}toObject(){return{row:this.row,col:this.col}}}var ti=Zs;function ei(t,e,o){oi(t,e),e.set(t,o)}function oi(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ni(t,e,o){return e=si(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function si(t){var e=ii(t,"string");return"symbol"===typeof e?e:String(e)}function ii(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ri(t,e){var o=hi(t,e,"get");return li(t,o)}function li(t,e){return e.get?e.get.call(t):e.value}function ai(t,e,o){var n=hi(t,e,"set");return ci(t,n,o),o}function hi(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function ci(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var di=new WeakMap;class ui{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];ni(this,"highlight",null),ni(this,"from",null),ni(this,"to",null),ei(this,di,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=e.clone(),this.to=o.clone(),ai(this,di,n)}setHighlight(t){return this.highlight=t.clone().normalize(),this}setFrom(t){return this.from=t.clone(),this}setTo(t){return this.to=t.clone(),this}isValid(t){return this.from.isValid(t)&&this.to.isValid(t)}isSingle(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(t){const{row:e,col:o}=t,n=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return n.row<=e&&s.row>=e&&n.col<=o&&s.col>=o}includesRange(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}isEqual(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}overlaps(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}isNorthWestOf(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}isOverlappingHorizontally(t){return this.getOuterTopRightCorner().col>=t.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=t.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=t.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=t.getOuterTopLeftCorner().col}isOverlappingVertically(t){return this.getOuterBottomRightCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=t.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=t.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=t.getOuterTopRightCorner().row}expand(t){const e=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>o.row||t.col>o.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(o.row,t.row),Math.max(o.col,t.col)),!0)}expandByRange(t){if(this.includesRange(t)||!this.overlaps(t))return!1;const e=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),n=this.getDirection(),s=t.getOuterTopStartCorner(),i=t.getOuterBottomEndCorner(),r=Math.min(e.row,s.row),l=Math.min(e.col,s.col),a=Math.max(o.row,i.row),h=Math.max(o.col,i.col),c=this._createCellCoords(r,l),d=this._createCellCoords(a,h);return this.from=c,this.to=d,this.setDirection(n),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(t){switch(t){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break;default:break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){const t=this.getDirection();switch(t){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}flipDirectionHorizontally(){const t=this.getDirection();switch(t){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return ri(this,di)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return ri(this,di)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return ri(this,di)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return ri(this,di)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return ri(this,di)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return ri(this,di)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return ri(this,di)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return ri(this,di)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(t,e){return!!(e&&e.includes(t)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(e.from.row,e.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(e.from.row,e.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(e.to.row,e.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(e.to.row,e.to.col))))||(t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner()))}getOppositeCorner(t,e){if(!(t instanceof ti))return!1;if(e){const{from:o,to:n}=e;if(e.includes(t)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(o.row,n.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(n.row,o.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterTopStartCorner()}}return t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0}getBordersSharedWith(t){if(!this.includesRange(t))return[];const e={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},o={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},n=[];return e.top===o.top&&n.push("top"),e.right===o.right&&n.push("right"),e.bottom===o.bottom&&n.push("bottom"),e.left===o.left&&n.push("left"),n}getInner(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),o=[];for(let n=t.row;n<=e.row;n++)for(let s=t.col;s<=e.col;s++)this.from.row===n&&this.from.col===s||this.to.row===n&&this.to.col===s||o.push(this._createCellCoords(n,s));return o}getAll(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),o=[];for(let n=t.row;n<=e.row;n++)for(let s=t.col;s<=e.col;s++)t.row===n&&t.col===s?o.push(t):e.row===n&&e.col===s?o.push(e):o.push(this._createCellCoords(n,s));return o}forAll(t){const e=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();for(let n=e.row;n<=o.row;n++)for(let s=e.col;s<=o.col;s++){const e=t(n,s);if(!1===e)return}}clone(){return new ui(this.highlight,this.from,this.to,ri(this,di))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(t,e){return new ti(t,e,ri(this,di))}}var gi=ui;function mi(t,e,o){return e=fi(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function fi(t){var e=pi(t,"string");return"symbol"===typeof e?e:String(e)}function pi(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class wi{get eventManager(){return new Bo(this)}constructor(t,e){mi(this,"wtTable",void 0),mi(this,"wtScroll",void 0),mi(this,"wtViewport",void 0),mi(this,"wtOverlays",void 0),mi(this,"selections",void 0),mi(this,"wtEvent",void 0),mi(this,"guid",`wt_${ht()}`),mi(this,"drawInterrupted",!1),mi(this,"drawn",!1),mi(this,"domBindings",void 0),mi(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new Ws(this.createScrollDao())}findOriginalHeaders(){const t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let e=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;e<o;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,o){Ot(o,t[e])}])}}createCellCoords(t,e){return new ti(t,e,this.wtSettings.getSetting("rtlMode"))}createCellRange(t,e,o){return new gi(t,e,o,this.wtSettings.getSetting("rtlMode"))}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return this.wtTable.getCell(t);const o=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<n&&t.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<i&&t.row>=o-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);if(t.row<o&&t.row>=o-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}scrollViewport(t,e,o,n,s){return!(t.col<0||t.row<0)&&this.wtScroll.scrollViewport(t,e,o,n,s)}scrollViewportHorizontally(t,e,o){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,o)}scrollViewportVertically(t,e,o){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,o)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selections(){return t.selections},get drawn(){return t.drawn},set drawn(e){t.drawn=e},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count}}}}function Ci(t,e,o){return e=yi(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function yi(t){var e=vi(t,"string");return"symbol"===typeof e?e:String(e)}function vi(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class bi extends wi{constructor(t,e,o){super(t,e),Ci(this,"cloneSource",void 0),Ci(this,"cloneOverlay",void 0);const n=this.wtSettings.getSetting("facade",this);this.cloneSource=o.source,this.cloneOverlay=o.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=o.viewport,this.selections=o.selections,this.wtEvent=new Yn(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections,o.event),this.findOriginalHeaders()}}function Si(t,e,o){return e=Ri(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Ri(t){var e=Ei(t,"string");return"symbol"===typeof e?e:String(e)}function Ei(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Mi{constructor(t,e,o,n,s){Si(this,"wtSettings",null),Oe(this,"wot",t,{writable:!1}),this.domBindings=s,this.facadeGetter=e,this.wtSettings=n;const{TABLE:i,hider:r,spreader:l,holder:a,wtRootElement:h}=this.wot.wtTable;this.instance=this.wot,this.type=o,this.mainTableScrollableElement=null,this.TABLE=i,this.hider=r,this.spreader=l,this.holder=a,this.wtRootElement=h,this.trimmingContainer=Bt(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const t=this.needFullRender;this.needFullRender=this.shouldBeRendered();const e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Bt(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:t}=this.wot,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Vt(t.TABLE)}getRelativeCellPosition(t,e,o){if(!1===this.clone.wtTable.holder.contains(t))return void mo(`The provided element is not a child of the ${this.type} overlay`);const n=this.mainTableScrollableElement===this.domBindings.rootWindow,s=o<this.wtSettings.getSetting("fixedColumnsStart"),i=e<this.wtSettings.getSetting("fixedRowsTop"),r=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,a={start:this.getRelativeStartPosition(l),top:l.offsetTop},h={start:this.getRelativeStartPosition(t),top:t.offsetTop};let c=null;return c=n?this.getRelativeCellPositionWithinWindow(i,s,h,a):this.getRelativeCellPositionWithinHolder(i,r,s,h,a),c}getRelativeStartPosition(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}getRelativeCellPositionWithinWindow(t,e,o,n){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let i=0,r=0;if(e){let t=s.left;this.isRtl()&&(t=this.domBindings.rootWindow.innerWidth-(s.left+s.width+oe())),i=t<=0?-1*t:0}else i=n.start;if(t){const t=this.clone.wtTable.TABLE.getBoundingClientRect();r=t.top-s.top}else r=n.top;return{start:o.start+i,top:o.top+r}}getRelativeCellPositionWithinHolder(t,e,o,n,s){const i={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let r=0,l=0;if(o||(r=i.horizontal-s.start),e){const t=this.wot.wtTable.wtRootElement.getBoundingClientRect(),e=this.clone.wtTable.TABLE.getBoundingClientRect();l=-1*e.top+t.top}else t||(l=i.vertical-s.top);return{start:n.start-r,top:n.top-l}}makeClone(){if(-1===Ss.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:o}=this.domBindings,n=e.createElement("DIV"),s=e.createElement("TABLE"),i=t.wtRootElement.parentNode;n.className=`${Rs.get(this.type)} handsontable`,n.setAttribute("dir",this.isRtl()?"rtl":"ltr"),n.style.position="absolute",n.style.top=0,n.style.overflow="visible",this.isRtl()?n.style.right=0:n.style.left=0,s.className=t.TABLE.className,n.appendChild(s),i.appendChild(n);const r=this.wtSettings.getSetting("preventOverflow");return!0===r||"horizontal"===r&&this.type===ws||"vertical"===r&&this.type===ys?this.mainTableScrollableElement=o:"hidden"===o.getComputedStyle(i).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=Vt(t.TABLE),new bi(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}reset(){if(!this.clone)return;const t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,o=t.style,n=e.style,s=t.parentNode.style;O([o,n,s],(t=>{t.width="",t.height=""}))}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}function Ti(t,e,o){return e=xi(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function xi(t){var e=Ii(t,"string");return"symbol"===typeof e?e:String(e)}function Ii(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Hi extends Mi{constructor(t,e,o,n){super(t,e,ws,o,n),Ti(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new Ds(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode,{rootWindow:e}=this.domBindings,o=this.wtSettings.getSetting("preventOverflow");let n=0,s=!1;if(this.trimmingContainer!==e||o&&"vertical"===o)n=this.getScrollPosition(),le(t);else{const{wtTable:e}=this.wot,o=e.hider.getBoundingClientRect(),i=Math.ceil(o.bottom),r=t.offsetHeight;s=i===r,n=this.getOverlayOffset(),ie(t,"0px",`${n}px`)}const i=this.adjustHeaderBordersPosition(n,s);return this.adjustElementsSize(),i}setScrollPosition(t){const e=this.domBindings.rootWindow;let o=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo(_t(e),t),o=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const o=this.wtSettings.getSetting("defaultRowHeight");let n=t,s=0;while(n<e){const t=this.wot.wtTable.getRowHeight(n);s+=void 0===t?o:t,n+=1}return s}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:o}=this.domBindings,n=oe(e),s=this.clone.wtTable.holder.parentNode,i=s.style,r=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===r){let e=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(e-=n),e=Math.min(e,t.wtRootElement.scrollWidth),i.width=`${e}px`}else i.width="";this.clone.wtTable.holder.style.width=i.width;let l=zt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),i.height=`${l}px`}adjustRootChildrenSize(){var t;const{holder:e}=this.clone.wtTable,{selections:o}=this.wot,n=this.facadeGetter(),s=Math.abs(null!==(t=null===o||void 0===o?void 0:o.getCell().getBorder(n).cornerCenterPointOffset)&&void 0!==t?t:0);this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+s}px`}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){const{wot:o,wtSettings:n}=this,s=o.cloneSource?o.cloneSource:o,i=s.wtTable.holder;let r=this.getTableParentOffset(),l=0;if(e){const o=this.wot.wtTable.getRowHeight(t),n=this.wot.wtViewport.getViewportHeight();o>n&&(e=!1)}if(e&&i.offsetHeight!==i.clientHeight&&(l=oe(this.domBindings.rootDocument)),e){const e=n.getSetting("fixedRowsBottom"),s=n.getSetting("totalRows");r+=this.sumCellSizes(0,t+1),r-=o.wtViewport.getViewportHeight()-this.sumCellSizes(s-e,s),r+=1}else r+=this.sumCellSizes(n.getSetting("fixedRowsTop"),t);return r+=l,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Dt(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let o=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),n=t-e;o=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),o>n&&(o=0)}return o}adjustHeaderBordersPosition(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("totalColumns");n?Tt(o,"emptyColumns"):Mt(o,"emptyColumns");let s=!1;if(!e){const e=this.wtSettings.getSetting("fixedRowsTop"),n=this.cachedFixedRowsTop!==e,i=this.wtSettings.getSetting("columnHeaders");if((n||0===e)&&i.length>0){const e=Et(o,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),t||0===this.wtSettings.getSetting("totalRows")?(Mt(o,"innerBorderTop"),s=!e):(Tt(o,"innerBorderTop"),s=e)}}return s}}const Ai="stickyRowsBottom",Oi={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),o=t-e;return 0===t||0===e?-1:o<0?0:o},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};Oe(Oi,"MIXIN_NAME",Ai,{writable:!1,enumerable:!1});var ki=Oi;class Ni extends Is{constructor(t,e,o,n){super(t,e,o,n,Cs)}}Ie(Ni,ki),Ie(Ni,Ps);var Pi=Ni;function _i(t,e,o){return e=Di(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Di(t){var e=Li(t,"string");return"symbol"===typeof e?e:String(e)}function Li(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Vi extends Mi{constructor(t,e,o,n){super(t,e,Cs,o,n),_i(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new Pi(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,e=this.clone.wtTable.holder.parentNode;e.style.top="";let o=0;const n=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||n&&"vertical"===n?(o=this.getScrollPosition(),this.repositionOverlay()):(o=this.getOverlayOffset(),e.style.bottom=`${o}px`);const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:o}=this.domBindings,n=this.clone.wtTable.holder.parentNode;let s=0;e.hasVerticalScroll()||(s+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(s+=oe(o)),n.style.bottom=`${s}px`}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let o=!1;return this.mainTableScrollableElement===e?(e.scrollTo(_t(e),t),o=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const{wtTable:o,wtSettings:n}=this.wot,s=n.getSetting("defaultRowHeight");let i=t,r=0;while(i<e){const t=o.getRowHeight(i);r+=void 0===t?s:t,i+=1}return r}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:o,rootWindow:n}=this.domBindings,s=oe(o),i=this.clone.wtTable.holder.parentNode,r=i.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===l){let o=e.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(o-=s),o=Math.min(o,t.wtRootElement.scrollWidth),r.width=`${o}px`}else r.width="";this.clone.wtTable.holder.style.width=r.width;let a=zt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(a=0),r.height=`${a}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let o=this.getTableParentOffset();const n=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=n.wtTable.holder;let i=0;e&&s.offsetHeight!==s.clientHeight&&(i=oe(this.domBindings.rootDocument)),e?(o+=this.sumCellSizes(0,t+1),o-=this.wot.wtViewport.getViewportHeight(),o+=1):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),o+=i,this.setScrollPosition(o)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Dt(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let o=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),n=t-e,s=this.domBindings.rootDocument.documentElement.clientHeight;o=Math.max(this.getTableParentOffset()-this.getScrollPosition()-s+t,0),o>n&&(o=0)}return o}adjustHeaderBordersPosition(t){const e=this.wtSettings.getSetting("fixedRowsBottom"),o=this.cachedFixedRowsBottom!==e,n=this.wtSettings.getSetting("columnHeaders");let s=!1;if((o||0===e)&&n.length>0){const e=this.wot.wtTable.holder.parentNode,o=Et(e,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?(Mt(e,"innerBorderBottom"),s=!o):(Tt(e,"innerBorderBottom"),s=o)}return s}}const Bi="calculatedRows",Fi={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible}};Oe(Fi,"MIXIN_NAME",Bi,{writable:!1,enumerable:!1});var Wi=Fi;const ji="stickyColumnsStart",Ui={getFirstRenderedColumn(){const t=this.wtSettings.getSetting("totalColumns");return 0===t?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()}};Oe(Ui,"MIXIN_NAME",ji,{writable:!1,enumerable:!1});var zi=Ui;class $i extends Is{constructor(t,e,o,n){super(t,e,o,n,ys)}}Ie($i,Wi),Ie($i,zi);var Gi=$i;class Yi extends Mi{constructor(t,e,o,n){super(t,e,ys,o,n)}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new Gi(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:t}=this.wot;if(!this.needFullRender||!t.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,o=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer!==e||n&&"horizontal"===n?(s=this.getScrollPosition(),le(o)):(s=this.getOverlayOffset()*(this.isRtl()?-1:1),ie(o,`${s}px`,"0px"));const i=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),i}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let o=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,Pt(e)),o=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,o=!0),o}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(t,e){const o=this.wtSettings.getSetting("defaultColumnWidth");let n=t,s=0;while(n<e)s+=this.wot.wtTable.getStretchedColumnWidth(n)||o,n+=1;return s}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t}=this.wot,{rootDocument:e,rootWindow:o}=this.domBindings,n=oe(e),s=this.clone.wtTable.holder.parentNode,i=s.style,r=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"vertical"===r){let e=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(e-=n),e=Math.min(e,t.wtRootElement.scrollHeight),i.height=`${e}px`}else i.height="";this.clone.wtTable.holder.style.height=i.height;const l=Ut(this.clone.wtTable.TABLE);i.width=`${l}px`}adjustRootChildrenSize(){var t;const{holder:e}=this.clone.wtTable,{selections:o}=this.wot,n=this.facadeGetter(),s=Math.abs(null!==(t=null===o||void 0===o?void 0:o.getCell().getBorder(n).cornerCenterPointOffset)&&void 0!==t?t:0);this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+s}px`}applyToDOM(){const t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[e]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(t,e){let o=this.getTableParentOffset();const n=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=n.wtTable.holder;let i=0;if(e){const o=this.wot.wtTable.getColumnWidth(t),n=this.wot.wtViewport.getViewportWidth();o>n&&(e=!1)}return e&&s.offsetWidth!==s.clientWidth&&(i=oe(this.domBindings.rootDocument)),e?(o+=this.sumCellSizes(0,t+1),o-=this.wot.wtViewport.getViewportWidth()):o+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),o+=i,this.setScrollPosition(o)}getTableParentOffset(){const t=this.wtSettings.getSetting("preventOverflow");let e=0;return t||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs(Lt(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let o=0;if(this.trimmingContainer===t&&(!e||"horizontal"!==e)){o=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const t=this.wot.wtTable.getTotalWidth(),e=this.clone.wtTable.getTotalWidth(),n=t-e;o>n&&(o=0)}return o}adjustHeaderBordersPosition(t){const e=this.wot.wtTable.holder.parentNode,o=this.wtSettings.getSetting("rowHeaders"),n=this.wtSettings.getSetting("fixedColumnsStart"),s=this.wtSettings.getSetting("totalRows");s?Tt(e,"emptyRows"):Mt(e,"emptyRows");let i=!1;if(n&&!o.length)Mt(e,"innerBorderLeft innerBorderInlineStart");else if(!n&&o.length){const o=Et(e,"innerBorderInlineStart");t?(Mt(e,"innerBorderLeft innerBorderInlineStart"),i=!o):(Tt(e,"innerBorderLeft innerBorderInlineStart"),i=o)}return i}}class Ki extends Is{constructor(t,e,o,n){super(t,e,o,n,vs)}}Ie(Ki,Os),Ie(Ki,zi);var Xi=Ki;function qi(t,e,o){return e=Qi(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Qi(t){var e=Ji(t,"string");return"symbol"===typeof e?e:String(e)}function Ji(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Zi extends Mi{constructor(t,e,o,n,s,i){super(t,e,vs,o,n),qi(this,"topOverlay",void 0),qi(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=i}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new Xi(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const e=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();ie(t,`${e}px`,`${o}px`)}else le(t);let e=zt(this.clone.wtTable.TABLE);const o=Ut(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(e=0),t.style.height=`${e}px`,t.style.width=`${o}px`,!1}}class tr extends Is{constructor(t,e,o,n){super(t,e,o,n,bs)}}Ie(tr,ki),Ie(tr,zi);var er=tr;class or extends Mi{constructor(t,e,o,n,s,i){super(t,e,bs,o,n),this.bottomOverlay=s,this.inlineStartOverlay=i}createTable(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return new er(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:t}=this;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const t=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]=`${t}px`,e.style.bottom=`${o}px`}else le(e),this.repositionOverlay();let o=zt(this.clone.wtTable.TABLE);const n=Ut(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(o=0),e.style.height=`${o}px`,e.style.width=`${n}px`,!1}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:o}=this.domBindings,n=this.clone.wtTable.holder.parentNode;let s=0;e.hasVerticalScroll()||(s+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(s+=oe(o)),n.style.bottom=`${s}px`}}function nr(t,e,o){return e=sr(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function sr(t){var e=ir(t,"string");return"symbol"===typeof e?e:String(e)}function ir(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class rr{constructor(t,e,o,n,s,i){nr(this,"wot",null),nr(this,"topOverlay",null),nr(this,"bottomOverlay",null),nr(this,"inlineStartOverlay",null),nr(this,"topInlineStartCornerOverlay",null),nr(this,"bottomInlineStartCornerOverlay",null),nr(this,"browserLineHeight",void 0),nr(this,"wtSettings",null),nr(this,"resizeObserver",new ResizeObserver((t=>{Fn((()=>{Array.isArray(t)&&t.length&&this.wtSettings.getSetting("onContainerElementResize")}))}))),this.wot=t,this.wtSettings=n,this.domBindings=o,this.facadeGetter=e,this.wtTable=i;const{rootDocument:r,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=oe(r);const a="hidden"===l.getComputedStyle(i.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=a?i.holder:Vt(i.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return t&&e.push(this.wtTable),e}initBrowserLineHeight(){const{rootWindow:t,rootDocument:e}=this.domBindings,o=t.getComputedStyle(e.body),n=parseInt(o.lineHeight,10),s=1.2*parseInt(o.fontSize,10);this.browserLineHeight=n||s}initOverlays(){const t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Hi(...t),this.bottomOverlay=new Vi(...t),this.inlineStartOverlay=new Yi(...t),this.topInlineStartCornerOverlay=new Zi(...t,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new or(...t,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let t=this.topOverlay.updateStateOfRendering();return t=this.bottomOverlay.updateStateOfRendering()||t,t=this.inlineStartOverlay.updateStateOfRendering()||t,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(t=this.topInlineStartCornerOverlay.updateStateOfRendering()||t),this.bottomOverlay.needFullRender&&(t=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||t)),t}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument:t,rootWindow:e}=this.domBindings,{mainTableScrollableElement:o}=this.topOverlay,{mainTableScrollableElement:n}=this.inlineStartOverlay;this.eventManager.addEventListener(t.documentElement,"keydown",(t=>this.onKeyDown(t))),this.eventManager.addEventListener(t.documentElement,"keyup",(()=>this.onKeyUp())),this.eventManager.addEventListener(t,"visibilitychange",(()=>this.onKeyUp())),this.eventManager.addEventListener(o,"scroll",(t=>this.onTableScroll(t)),{passive:!0}),o!==n&&this.eventManager.addEventListener(n,"scroll",(t=>this.onTableScroll(t)),{passive:!0});const s=e.devicePixelRatio&&e.devicePixelRatio>1,i=this.scrollableElement===e,r=this.wtSettings.getSetting("preventWheel"),l={passive:i};(r||s||!Ue())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(t=>this.onCloneWheel(t,r)),l);const a=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let h;a.forEach((t=>{if(t&&t.needFullRender){const{holder:e}=t.clone.wtTable;this.eventManager.addEventListener(e,"wheel",(t=>this.onCloneWheel(t,r)),l)}})),this.eventManager.addEventListener(e,"resize",(()=>{clearTimeout(h),h=setTimeout((()=>{this.wtSettings.getSetting("onWindowResize")}),200)})),i||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(t){const e=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,s=t.target;this.keyPressed&&(n!==e&&s!==e&&!t.target.contains(n)||o!==e&&s!==e&&!t.target.contains(o))||this.syncScrollPositions(t)}onCloneWheel(t,e){const{rootWindow:o}=this.domBindings,n=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,i=t.target,r=s!==o&&i!==o&&!i.contains(s),l=n!==o&&i!==o&&!i.contains(n);if(this.keyPressed&&(r||l))return;const a=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==o&&a)&&t.preventDefault()}onKeyDown(t){this.keyPressed=ao(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(t){let e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,o=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(o+=o*this.browserLineHeight,e+=e*this.browserLineHeight);const n=this.scrollVertically(e),s=this.scrollHorizontally(o);return n||s}scrollVertically(t){const e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}scrollHorizontally(t){const e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:t}=this.domBindings,e=this.topOverlay.clone.wtTable.holder,o=this.inlineStartOverlay.clone.wtTable.holder,[n,s]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=e.scrollLeft!==n||this.lastScrollX!==t.scrollX,this.verticalScrolling=o.scrollTop!==s||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=n;const t=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;t&&(t.scrollLeft=n)}this.verticalScrolling&&(o.scrollTop=s),this.refreshAll()}syncScrollWithMaster(){const t=this.topOverlay.mainTableScrollableElement,{scrollLeft:e,scrollTop:o}=t;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=o)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:t}=this,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=Vt(t.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.updateLastSpreaderSize();e&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}updateLastSpreaderSize(){const t=this.wtTable.spreader,e=t.clientWidth,o=t.clientHeight,n=e!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height;return n&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=o),n}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtViewport:e}=this.wot,{wtTable:o}=this,n=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),i=e.getRowHeaderWidth(),r=e.getColumnHeaderHeight(),l=o.hider.style;if(l.width=`${i+this.inlineStartOverlay.sumCellSizes(0,n)}px`,l.height=`${r+this.topOverlay.sumCellSizes(0,s)+1}px`,this.scrollbarSize>0){const{scrollHeight:t,scrollWidth:e}=o.wtRootElement,{scrollHeight:n,scrollWidth:s}=o.holder;this.hasScrollbarRight=t<n,this.hasScrollbarBottom=e<s,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>e?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>t&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.inlineStartOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(t){if(!t)return null;const e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let o=null;return O(e,(e=>{e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(o=e.clone)})),o}syncOverlayTableClassNames(){const t=this.wtTable.TABLE,e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];O(e,(e=>{e&&(e.clone.wtTable.TABLE.className=t.className)}))}}var lr=rr;function ar(t,e,o){return e=hr(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function hr(t){var e=cr(t,"string");return"symbol"===typeof e?e:String(e)}function cr(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class dr{constructor(t){ar(this,"settings",{}),ar(this,"defaults",Object.freeze(this.getDefaults())),ke(this.defaults,((e,o)=>{if(void 0!==t[o])this.settings[o]=t[o];else{if(void 0===e)throw new Error(`A required setting "${o}" was not provided`);this.settings[o]=e}}))}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(t,e,o)=>{const n=this.getSetting("data",t,e);Ot(o,void 0===n||null===n?"":n)},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:t=>t,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:t=>t,onBeforeHighlightingColumnHeader:t=>t,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}update(t,e){return void 0===e?ke(t,((t,e)=>{this.settings[e]=t})):this.settings[t]=e,this}getSetting(t,e,o,n,s){return"function"===typeof this.settings[t]?this.settings[t](e,o,n,s):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}getSettingPure(t){return this.settings[t]}has(t){return!!this.settings[t]}}class ur extends Is{constructor(t,e,o,n){super(t,e,o,n,"master")}alignOverlaysWithTrimmingContainer(){const t=Bt(this.wtRootElement),{rootWindow:e}=this.domBindings;if(t===e){const t=this.wtSettings.getSetting("preventOverflow");t||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{const o=t.parentElement,n=Ft(t,"height",e),s=Ft(t,"overflow",e),i=this.holder.style,{scrollWidth:r,scrollHeight:l}=t;let{width:a,height:h}=t.getBoundingClientRect();const c=["auto","hidden","scroll"];if(o&&c.includes(s)){const n=t.cloneNode(!1);n.style.overflow="auto",n.style.position="absolute",t.nextElementSibling?o.insertBefore(n,t.nextElementSibling):o.appendChild(n);const s=parseInt(jt(n,e).height,10);o.removeChild(n),0===s&&(h=0)}h=Math.min(h,l),i.height="auto"===n?"auto":`${h}px`,a=Math.min(a,r),i.width=`${a}px`,i.overflow="",this.hasTableHeight="auto"===i.height||h>0,this.hasTableWidth=a>0}this.isTableVisible=kt(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject,o="master",n=t.getSetting("columnHeaders"),s=n.length;if(s&&!e.hasOversizedColumnHeadersMarked[o]){const n=t.getSetting("rowHeaders"),i=n.length,r=this.getRenderedColumnsCount();for(let t=0;t<s;t++)for(let e=-1*i;e<r;e++)this.markIfOversizedColumnHeader(e);e.hasOversizedColumnHeadersMarked[o]=!0}}}Ie(ur,Wi),Ie(ur,Ps);var gr=ur;const mr=1,fr=2;o(2585);const pr=new WeakMap;class wr{static get DEFAULT_HEIGHT(){return 23}constructor(){let{viewportSize:t,scrollOffset:e,totalItems:o,itemSizeFn:n,overrideFn:s,calculationType:i,scrollbarHeight:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};pr.set(this,{viewportHeight:t,scrollOffset:e,totalRows:o,rowHeightFn:n,overrideFn:s,calculationType:i,horizontalScrollbarHeight:r}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}calculate(){const t=pr.get(this),e=t.calculationType,o=t.overrideFn,n=t.rowHeightFn,s=t.scrollOffset,i=Math.max(t.scrollOffset,0),r=t.totalRows,l=t.viewportHeight,a=t.horizontalScrollbarHeight||0;let h=0,c=!0;const d=[];let u,g=0,m=0;for(let C=0;C<r;C++)if(u=n(C),isNaN(u)&&(u=wr.DEFAULT_HEIGHT),h<=i&&e!==fr&&(this.startRow=C,g=u),h>=i&&h+(e===fr?u:0)<=i+l-a&&(null===this.startRow&&(this.startRow=C,g=u),this.endRow=C),d.push(h),h+=u,m=u,e!==fr&&(this.endRow=C),h>=i+l-a){c=!1;break}const f=s+l-a,p=e===fr?g:0,w=e===fr?0:m;if(f<p||s>d.at(-1)+w?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===r-1&&c){this.startRow=this.endRow;while(this.startRow>0){const t=d[this.endRow]+u-d[this.startRow-1];if((t<=l-a||e!==fr)&&(this.startRow-=1),t>=l-a)break}}e===mr&&null!==this.startRow&&o&&o(this),this.startPosition=d[this.startRow],void 0===this.startPosition&&(this.startPosition=null),r<this.endRow&&(this.endRow=r-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}var Cr=wr;const yr=new WeakMap;class vr{static get DEFAULT_WIDTH(){return 50}constructor(){let{viewportSize:t,scrollOffset:e,totalItems:o,itemSizeFn:n,overrideFn:s,calculationType:i,stretchMode:r,stretchingItemWidthFn:l=(t=>t),inlineStartOffset:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};yr.set(this,{viewportWidth:t,scrollOffset:e,totalColumns:o,columnWidthFn:n,overrideFn:s,calculationType:i,stretchingColumnWidthFn:l,inlineStartOffset:a}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=r,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}calculate(){let t=0,e=!0;const o=[];let n,s=0,i=0;const r=yr.get(this),l=r.calculationType,a=r.overrideFn,h=r.scrollOffset,c=Math.max(r.scrollOffset,0),d=r.totalColumns,u=r.viewportWidth,g=c>0?u+1:u;for(let w=0;w<d;w++)if(n=this._getColumnWidth(w),t<=c&&l!==fr&&(this.startColumn=w,s=n),t>=c&&t+(l===fr?n:0)<=c+g&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=w,s=n),this.endColumn=w),o.push(t),t+=n,i=n,l!==fr&&(this.endColumn=w),t>=c+u){e=!1;break}const m=h+u-g,f=l===fr?0:i,p=l===fr?s:0;if(m<-1*r.inlineStartOffset||h>o.at(-1)+f||-1*r.scrollOffset-r.viewportWidth>-1*p?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===d-1&&e){this.startColumn=this.endColumn;while(this.startColumn>0){const t=o[this.endColumn]+n-o[this.startColumn-1];if((t<=u||l!==fr)&&(this.startColumn-=1),t>u)break}}l===mr&&null!==this.startColumn&&a&&a(this),this.startPosition=o[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(t){if("none"===this.stretch)return;let e=t;this.totalTargetWidth=e;const o=yr.get(this),n=o.totalColumns;let s=0;for(let r=0;r<n;r++){const t=this._getColumnWidth(r),n=o.stretchingColumnWidthFn(void 0,r);"number"===typeof n?e-=n:s+=t}const i=e-s;if("all"===this.stretch&&i>0)this.stretchAllRatio=e/s,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&e!==1/0){const t=this._getColumnWidth(n-1),e=i+t;this.stretchLastWidth=e>=0?e:t}}getStretchedColumnWidth(t,e){let o=null;return"all"===this.stretch&&0!==this.stretchAllRatio?o=this._getStretchedAllColumnWidth(t,e):"last"===this.stretch&&0!==this.stretchLastWidth&&(o=this._getStretchedLastColumnWidth(t)),o}_getStretchedAllColumnWidth(t,e){let o=0;const n=yr.get(this),s=n.totalColumns;if(!this.stretchAllColumnsWidth[t]){const o=Math.round(e*this.stretchAllRatio),s=n.stretchingColumnWidthFn(o,t);this.stretchAllColumnsWidth[t]=void 0===s?o:isNaN(s)?this._getColumnWidth(t):s}if(this.stretchAllColumnsWidth.length===s&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let t=0;t<this.stretchAllColumnsWidth.length;t++)o+=this.stretchAllColumnsWidth[t];o!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-o)}return this.stretchAllColumnsWidth[t]}_getStretchedLastColumnWidth(t){const e=yr.get(this),o=e.totalColumns;return t===o-1?this.stretchLastWidth:null}_getColumnWidth(t){let e=yr.get(this).columnWidthFn(t);return isNaN(e)&&(e=vr.DEFAULT_WIDTH),e}}var br=vr;class Sr{constructor(t,e,o,n,s){this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=e,this.wtSettings=o,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=n,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(()=>{this.clientHeight=this.getWorkspaceHeight()}))}getWorkspaceHeight(){const t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer;let o=0;if(e===this.domBindings.rootWindow)o=t.documentElement.clientHeight;else{const t=zt(e);o=t>0&&e.clientHeight>0?e.clientHeight:1/0}return o}getWorkspaceWidth(){const{wtSettings:t}=this,{rootDocument:e,rootWindow:o}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=e.documentElement.offsetWidth,i=t.getSetting("totalColumns"),r=t.getSetting("preventOverflow"),l=t.getSetting("rtlMode"),a=this.wtTable.TABLE.getBoundingClientRect(),h=l?a.right-s:a.left,c=s-h;let d,u;if(r)return Ut(this.wtTable.wtRootElement);if(d=t.getSetting("freezeOverlays")?Math.min(c,s):Math.min(this.getContainerFillWidth(),c,s),n===o&&i>0&&this.sumColumnWidths(0,i-1)>d)return e.documentElement.clientWidth;if(n!==o&&(u=Ft(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o),"scroll"===u||"hidden"===u||"auto"===u))return Math.max(d,n.clientWidth);const g=t.getSetting("stretchH");return"none"!==g&&g?d:Math.max(d,Ut(this.wtTable.TABLE))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(t,e){let o=0,n=t;while(n<e)o+=this.wtTable.getColumnWidth(n),n+=1;return o}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);const o=e.offsetWidth;return this.containerWidth=o,t.removeChild(e),o}getWorkspaceOffset(){return Nt(this.wtTable.TABLE)}getColumnHeaderHeight(){const t=this.wtSettings.getSetting("columnHeaders");return t.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=zt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let t=this.getWorkspaceHeight();if(t===1/0)return t;const e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}getRowHeaderWidth(){const t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(let o=0,n=e.length;o<n;o++)this.rowHeaderWidth+=t[o]||t}if(isNaN(this.rowHeaderWidth))if(e.length){let t=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let o=0,n=e.length;o<n;o++)t?(this.rowHeaderWidth+=Ut(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const t=this.getWorkspaceWidth();if(t===1/0)return t;const e=this.getRowHeaderWidth();return e>0?t-e:t}createRowsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mr;const{wtSettings:e,wtTable:o}=this;let n,s,i;this.rowHeaderWidth=NaN,n=e.getSetting("renderAllRows")&&t===mr?1/0:this.getViewportHeight();let r=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=e.getSetting("fixedRowsTop"),a=e.getSetting("fixedRowsBottom"),h=e.getSetting("totalRows");return l&&r>=0&&(i=this.dataAccessObject.topOverlay.sumCellSizes(0,l),r+=i,n-=i),a&&this.dataAccessObject.bottomOverlay.clone&&(i=this.dataAccessObject.bottomOverlay.sumCellSizes(h-a,h),n-=i),s=o.holder.clientHeight===o.holder.offsetHeight?0:oe(this.domBindings.rootDocument),new Cr({viewportSize:n,scrollOffset:r,totalItems:e.getSetting("totalRows"),itemSizeFn:t=>o.getRowHeight(t),overrideFn:e.getSettingPure("viewportRowCalculatorOverride"),calculationType:t,scrollbarHeight:s})}createColumnsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mr;const{wtSettings:e,wtTable:o}=this;let n=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const i=e.getSetting("fixedColumnsStart");if(i&&s>=0){const t=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,i);s+=t,n-=t}return o.holder.clientWidth!==o.holder.offsetWidth&&(n-=oe(this.domBindings.rootDocument)),new br({viewportSize:n,scrollOffset:s,totalItems:e.getSetting("totalColumns"),itemSizeFn:t=>o.getColumnWidth(t),overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),calculationType:t,stretchMode:e.getSetting("stretchH"),stretchingItemWidthFn:(t,o)=>e.getSetting("onBeforeStretchingColumnWidth",t,o),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=t;if(e){const t=this.createRowsCalculator(fr),o=this.createColumnsCalculator(fr);this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(mr),this.columnsRenderCalculator=this.createColumnsCalculator(mr)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(fr),this.columnsVisibleCalculator=this.createColumnsCalculator(fr)}areAllProposedVisibleRowsAlreadyRendered(t){if(!this.rowsVisibleCalculator)return!1;const{startRow:e,endRow:o,isVisibleInTrimmingContainer:n}=t;if(null===e&&null===o)return!n;const{startRow:s,endRow:i}=this.rowsRenderCalculator;return!(e<s||e===s&&e>0)&&!(o>i||o===i&&o<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(t){if(!this.columnsVisibleCalculator)return!1;const{startColumn:e,endColumn:o,isVisibleInTrimmingContainer:n}=t;if(null===e&&null===o)return!n;const{startColumn:s,endColumn:i}=this.columnsRenderCalculator;return!(e<s||e===s&&e>0)&&!(o>i||o===i&&o<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){ke(this.hasOversizedColumnHeadersMarked,((t,e,o)=>{o[e]=void 0}))}}var Rr=Sr;class Er extends wi{constructor(t,e){super(t,new dr(e));const o=this.wtSettings.getSetting("facade",this);this.wtTable=new gr(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=new Rr(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selections=this.wtSettings.getSetting("selections"),this.wtEvent=new Yn(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections),this.wtOverlays=new lr(this,o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const t={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},e=[],o=[];ke(t,((t,n)=>{this.wtSettings.getSetting(n).length&&o.push(t),e.push(t)})),Tt(this.wtTable.wtRootElement.parentNode,e),Mt(this.wtTable.wtRootElement.parentNode,o)}getViewportDao(){const t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}class Mr{constructor(t){t instanceof wi?this._wot=t:this._initFromSettings(t)}_initFromSettings(t){t.facade=t=>{const e=new Mr(t);return()=>e},this._wot=new Er(t.table,t)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selections(){return this._wot.selections}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(t){this._wot.drawn=t}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(t){this._wot.drawInterrupted=t}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(t){this._wot.lastMouseOver=t}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(t){this._wot.momentumScrolling=t}get touchApplied(){return this._wot.touchApplied}set touchApplied(t){this._wot.touchApplied=t}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(t){this._wot.eventListeners=t}get eventManager(){return this._wot.eventManager}createCellCoords(t,e){return this._wot.createCellCoords(t,e)}createCellRange(t,e,o){return this._wot.createCellRange(t,e,o)}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}scrollViewport(t,e,o,n,s){return this._wot.scrollViewport(t,e,o,n,s)}scrollViewportHorizontally(t,e,o){return this._wot.scrollViewportHorizontally(t,e,o)}scrollViewportVertically(t,e,o){return this._wot.scrollViewportVertically(t,e,o)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(t,e){return this._wot.wtSettings.update(t,e),this}getSetting(t,e,o,n,s){return this._wot.wtSettings.getSetting(t,e,o,n,s)}hasSetting(t){return this._wot.wtSettings.hasSetting(t)}destroy(){this._wot.destroy()}}function Tr(t){let{isShiftKey:e,isLeftClick:o,isRightClick:n,coords:s,selection:i,controller:r,cellCoordsFactory:l}=t;const a=i.isSelected()?i.getSelectedRange().current():null,h=i.isSelectedByCorner(),c=i.isSelectedByRowHeader();if(e&&a)s.row>=0&&s.col>=0&&!r.cell?i.setRangeEnd(s):(h||c)&&s.row>=0&&s.col>=0&&!r.cell?i.setRangeEnd(l(s.row,s.col)):h&&s.row<0&&!r.column?i.setRangeEnd(l(a.to.row,s.col)):c&&s.col<0&&!r.row?i.setRangeEnd(l(s.row,a.to.col)):(!h&&!c&&s.col<0||h&&s.col<0)&&!r.row?i.selectRows(Math.max(a.from.row,0),s.row,s.col):(!h&&!c&&s.row<0||c&&s.row<0)&&!r.column&&i.selectColumns(Math.max(a.from.col,0),s.col,s.row);else{const t=!i.inInSelection(s),e=o||n&&t;s.row<0&&s.col>=0&&!r.column?e&&i.selectColumns(s.col,s.col,s.row):s.col<0&&s.row>=0&&!r.row?e&&i.selectRows(s.row,s.row,s.col):s.col>=0&&s.row>=0&&!r.cell?e&&i.setRangeStart(s):s.col<0&&s.row<0&&i.selectAll(!0,!0)}}function xr(t){let{isLeftClick:e,coords:o,selection:n,controller:s,cellCoordsFactory:i}=t;if(!e)return;const r=n.isSelectedByRowHeader(),l=n.isSelectedByColumnHeader(),a=n.tableProps.countCols(),h=n.tableProps.countRows();l&&!s.column?n.setRangeEnd(i(h-1,o.col)):r&&!s.row?n.setRangeEnd(i(o.row,a-1)):s.cell||n.setRangeEnd(o)}const Ir=new Map([["mousedown",Tr],["mouseover",xr],["touchstart",Tr]]);function Hr(t,e){let{coords:o,selection:n,controller:s,cellCoordsFactory:i}=e;Ir.get(t.type)({coords:o,selection:n,controller:s,cellCoordsFactory:i,isShiftKey:t.shiftKey,isLeftClick:go(t)||"touchstart"===t.type,isRightClick:uo(t)})}const Ar=new WeakMap,Or=Symbol("rootInstance");function kr(t){Ar.set(t,!0)}function Nr(t){return t===Or}function Pr(t){return Ar.has(t)}function _r(t,e,o){Dr(t,e),e.set(t,o)}function Dr(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lr(t,e,o){return e=Vr(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Vr(t){var e=Br(t,"string");return"symbol"===typeof e?e:String(e)}function Br(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Fr(t,e){var o=Ur(t,e,"get");return Wr(t,o)}function Wr(t,e){return e.get?e.get.call(t):e.value}function jr(t,e,o){var n=Ur(t,e,"set");return zr(t,n,o),o}function Ur(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function zr(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}const $r=new WeakMap;var Gr=new WeakMap,Yr=new WeakMap;class Kr{constructor(t){Lr(this,"instance",void 0),Lr(this,"eventManager",void 0),Lr(this,"settings",void 0),Lr(this,"THEAD",void 0),Lr(this,"TBODY",void 0),Lr(this,"_wt",void 0),Lr(this,"activeWt",void 0),_r(this,Gr,{writable:!0,value:0}),_r(this,Yr,{writable:!0,value:0}),Lr(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new Bo(this.instance),this.settings=this.instance.getSettings(),$r.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(t)}getCellAtCoords(t,e){const o=this._wt.getCell(t,e);return o<0?null:o}scrollViewport(t,e,o,n,s){return this._wt.scrollViewport(t,e,o,n,s)}scrollViewportHorizontally(t,e,o){return this._wt.scrollViewportHorizontally(t,e,o)}scrollViewportVertically(t,e,o){return this._wt.scrollViewportVertically(t,e,o)}createElements(){const t=$r.get(this),{rootElement:e,rootDocument:o}=this.instance,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),Mt(e,"handsontable"),t.table=o.createElement("TABLE"),Mt(t.table,"htCore"),this.instance.getSettings().tableClassName&&Mt(t.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),t.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),t.table.appendChild(this.TBODY),this.instance.table=t.table,this.instance.container.insertBefore(t.table,this.instance.container.firstChild)}registerEvents(){const t=$r.get(this),{rootElement:e,rootDocument:o,selection:n}=this.instance,s=o.documentElement;this.eventManager.addEventListener(e,"mousedown",(e=>{if(t.selectionMouseDown=!0,!this.isTextSelectionAllowed(e.target)){const{rootWindow:t}=this.instance;Jt(t),e.preventDefault(),t.focus()}})),this.eventManager.addEventListener(e,"mouseup",(()=>{t.selectionMouseDown=!1})),this.eventManager.addEventListener(e,"mousemove",(e=>{t.selectionMouseDown&&!this.isTextSelectionAllowed(e.target)&&(this.settings.fragmentSelection&&Jt(this.instance.rootWindow),e.preventDefault())})),this.eventManager.addEventListener(s,"keyup",(t=>{n.isInProgress()&&!t.shiftKey&&n.finish()})),this.eventManager.addEventListener(s,"mouseup",(s=>{n.isInProgress()&&go(s)&&n.finish(),t.mouseDown=!1,!he(o.activeElement)&&(n.isSelected()||n.isSelectedByAnyHeader()||e.contains(s.target)||uo(s))||this.instance.unlisten()})),this.eventManager.addEventListener(s,"contextmenu",(e=>{n.isInProgress()&&uo(e)&&(n.finish(),t.mouseDown=!1)})),this.eventManager.addEventListener(s,"touchend",(()=>{n.isInProgress()&&n.finish(),t.mouseDown=!1})),this.eventManager.addEventListener(s,"mousedown",(n=>{const i=n.target,r=n.x||n.clientX,l=n.y||n.clientY;let a=n.target;if(t.mouseDown||!e||!this.instance.view)return;const{holder:h}=this.instance.view._wt.wtTable;if(a===h){const t=oe(o);if(o.elementFromPoint(r+t,l)!==h||o.elementFromPoint(r,l+t)!==h)return}else while(a!==s){if(null===a){if(n.isTargetWebComponent)break;return}if(a===e)return;a=a.parentNode}const c="function"===typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(i):this.settings.outsideClickDeselects;c?this.instance.deselectCell():this.instance.destroyEditor(!1,!1)})),this.eventManager.addEventListener(t.table,"selectstart",(t=>{this.settings.fragmentSelection||ae(t.target)||t.preventDefault()}))}translateFromRenderableToVisualCoords(t){let{row:e,col:o}=t;return this.instance._createCellCoords(...this.translateFromRenderableToVisualIndex(e,o))}translateFromRenderableToVisualIndex(t,e){let o=t>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t,n=e>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===o&&(o=t),null===n&&(n=e),[o,n]}countRenderableIndexes(t,e){const o=Math.min(t.getNotTrimmedIndexesLength(),e),n=t.getNearestNotHiddenIndex(o-1,-1);return null===n?0:t.getRenderableFromVisualIndex(n)+1}countRenderableColumns(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.instance.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.instance.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(t,e,o,n){if(isNaN(t)||t<0)return 0;const s=o.getNearestNotHiddenIndex(t,e),i=o.getRenderableFromVisualIndex(s);if(!Number.isInteger(i))return 0;let r=0;return e<0?r=i+1:e>0&&(r=n-i),r}countNotHiddenFixedColumnsStart(){const t=this.instance.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}countNotHiddenFixedRowsTop(){const t=this.instance.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}countNotHiddenFixedRowsBottom(){const t=this.instance.countRows(),e=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}isMainTableNotFullyCoveredByOverlays(){const t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>t&&this.instance.countRenderedCols()>e}initializeWalkontable(){const t=$r.get(this),e={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:t.table,isDataViewInstance:()=>Pr(this.instance),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(t,e)=>this.instance.getDataAtCell(...this.translateFromRenderableToVisualIndex(t,e)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const t=[];return this.instance.hasRowHeaders()&&t.push(((t,e)=>{const o=t>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t;this.appendRowHeader(o,e)})),this.instance.runHooks("afterGetRowHeaderRenderers",t),jr(this,Yr,t.length),t},columnHeaders:()=>{const t=[];return this.instance.hasColHeaders()&&t.push(((t,e)=>{const o=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;this.appendColHeader(o,e)})),this.instance.runHooks("afterGetColumnHeaderRenderers",t),jr(this,Gr,t.length),t},columnWidth:t=>{const e=this.instance.columnIndexMapper.getVisualFromRenderableIndex(t);return this.instance.getColWidth(null===e?t:e)},rowHeight:t=>{const e=this.instance.rowIndexMapper.getVisualFromRenderableIndex(t);return this.instance.getRowHeight(null===e?t:e)},cellRenderer:(t,e,o)=>{const[n,s]=this.translateFromRenderableToVisualIndex(t,e),i=this.instance.runHooks("modifyGetCellCoords",n,s);let r=n,l=s;Array.isArray(i)&&([r,l]=i);const a=this.instance.getCellMeta(r,l),h=this.instance.colToProp(l);let c=this.instance.getDataAtRowProp(r,h);this.instance.hasHook("beforeValueRender")&&(c=this.instance.runHooks("beforeValueRender",c,a)),this.instance.runHooks("beforeRenderer",o,n,s,h,c,a),this.instance.getCellRenderer(a)(this.instance,o,n,s,h,c,a),this.instance.runHooks("afterRenderer",o,n,s,h,c,a)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onContainerElementResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onCellMouseDown:(e,o,n,s)=>{const i=this.translateFromRenderableToVisualCoords(o),r={row:!1,column:!1,cell:!1};this.instance.listen(),this.activeWt=s,t.mouseDown=!0,this.instance.runHooks("beforeOnCellMouseDown",e,i,n,r),co(e)||(Hr(e,{coords:i,selection:this.instance.selection,controller:r,cellCoordsFactory:(t,e)=>this.instance._createCellCoords(t,e)}),this.instance.runHooks("afterOnCellMouseDown",e,i,n),this.activeWt=this._wt)},onCellContextMenu:(e,o,n,s)=>{const i=this.translateFromRenderableToVisualCoords(o);this.activeWt=s,t.mouseDown=!1,this.instance.selection.isInProgress()&&this.instance.selection.finish(),this.instance.runHooks("beforeOnCellContextMenu",e,i,n),co(e)||(this.instance.runHooks("afterOnCellContextMenu",e,i,n),this.activeWt=this._wt)},onCellMouseOut:(t,e,o,n)=>{const s=this.translateFromRenderableToVisualCoords(e);this.activeWt=n,this.instance.runHooks("beforeOnCellMouseOut",t,s,o),co(t)||(this.instance.runHooks("afterOnCellMouseOut",t,s,o),this.activeWt=this._wt)},onCellMouseOver:(e,o,n,s)=>{const i=this.translateFromRenderableToVisualCoords(o),r={row:!1,column:!1,cell:!1};this.activeWt=s,this.instance.runHooks("beforeOnCellMouseOver",e,i,n,r),co(e)||(t.mouseDown&&Hr(e,{coords:i,selection:this.instance.selection,controller:r,cellCoordsFactory:(t,e)=>this.instance._createCellCoords(t,e)}),this.instance.runHooks("afterOnCellMouseOver",e,i,n),this.activeWt=this._wt)},onCellMouseUp:(t,e,o,n)=>{const s=this.translateFromRenderableToVisualCoords(e);this.activeWt=n,this.instance.runHooks("beforeOnCellMouseUp",t,s,o),co(t)||this.instance.isDestroyed||(this.instance.runHooks("afterOnCellMouseUp",t,s,o),this.activeWt=this._wt)},onCellCornerMouseDown:t=>{t.preventDefault(),this.instance.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:t=>{t.preventDefault(),this.instance.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:(t,e)=>this.beforeRender(t,e),onDraw:t=>this.afterRender(t),onScrollVertically:()=>this.instance.runHooks("afterScrollVertically"),onScrollHorizontally:()=>this.instance.runHooks("afterScrollHorizontally"),onBeforeRemoveCellClassNames:()=>this.instance.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(t,e,o)=>{const n=this.instance.rowIndexMapper,s=n.getVisualFromRenderableIndex(t),i=this.instance.runHooks("beforeHighlightingRowHeader",s,e,o);return n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,1))},onBeforeHighlightingColumnHeader:(t,e,o)=>{const n=this.instance.columnIndexMapper,s=n.getVisualFromRenderableIndex(t),i=this.instance.runHooks("beforeHighlightingColumnHeader",s,e,o);return n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,1))},onAfterDrawSelection:(t,e,o)=>{let n;const[s,i]=this.translateFromRenderableToVisualIndex(t,e),r=this.instance.selection.getSelectedRange(),l=r.size();if(l>0){const t=(null!==o&&void 0!==o?o:0)+1-l,e=r.peekByIndex(t);n=[e.from.row,e.from.col,e.to.row,e.to.col]}return this.instance.runHooks("afterDrawSelection",s,i,n,o)},onBeforeDrawBorders:(t,e)=>{const[o,n,s,i]=t,r=[this.instance.rowIndexMapper.getVisualFromRenderableIndex(o),this.instance.columnIndexMapper.getVisualFromRenderableIndex(n),this.instance.rowIndexMapper.getVisualFromRenderableIndex(s),this.instance.columnIndexMapper.getVisualFromRenderableIndex(i)];return this.instance.runHooks("beforeDrawBorders",r,e)},onBeforeTouchScroll:()=>this.instance.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.instance.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(t,e)=>{const o=this.instance.columnIndexMapper.getVisualFromRenderableIndex(e);return this.instance.runHooks("beforeStretchingColumnWidth",t,o)},onModifyRowHeaderWidth:t=>this.instance.runHooks("modifyRowHeaderWidth",t),onModifyGetCellCoords:(t,e,o)=>{const n=this.instance.rowIndexMapper,s=this.instance.columnIndexMapper,i=e>=0?s.getVisualFromRenderableIndex(e):e,r=t>=0?n.getVisualFromRenderableIndex(t):t,l=this.instance.runHooks("modifyGetCellCoords",r,i,o);if(Array.isArray(l)){const[t,e,o,i]=l;return[t>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(t,1)):t,e>=0?s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(e,1)):e,o>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1)):o,i>=0?s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(i,-1)):i]}},viewportRowCalculatorOverride:t=>{let e=this.settings.viewportRowRenderingOffset;if("auto"===e&&this.settings.fixedRowsTop&&(e=10),e>0||"auto"===e){const o=this.countRenderableRows(),n=t.startRow,s=t.endRow;if("number"===typeof e)t.startRow=Math.max(n-e,0),t.endRow=Math.min(s+e,o-1);else if("auto"===e){const e=Math.ceil(s/o*12);t.startRow=Math.max(n-e,0),t.endRow=Math.min(s+e,o-1)}}this.instance.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:t=>{let e=this.settings.viewportColumnRenderingOffset;if("auto"===e&&this.settings.fixedColumnsStart&&(e=10),e>0||"auto"===e){const o=this.countRenderableColumns(),n=t.startColumn,s=t.endColumn;if("number"===typeof e&&(t.startColumn=Math.max(n-e,0),t.endColumn=Math.min(s+e,o-1)),"auto"===e){const e=Math.ceil(s/o*6);t.startColumn=Math.max(n-e,0),t.endColumn=Math.min(s+e,o-1)}}this.instance.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const t=this.instance.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||t}};this.instance.runHooks("beforeInitWalkontable",e),this._wt=new Mr(e),this.activeWt=this._wt;const o=this._wt.wtTable.spreader,{width:n,height:s}=this.instance.rootElement.getBoundingClientRect();this.setLastSize(n,s),this.eventManager.addEventListener(o,"mousedown",(t=>{t.target===o&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(o,"contextmenu",(t=>{t.target===o&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.instance.forceFullRender=!0,this.render())}))}isTextSelectionAllowed(t){if(ae(t))return!0;const e=vt(t,this.instance.view._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return $r.get(this).mouseDown}isSelectedOnlyCell(){var t,e;return null!==(t=null===(e=this.instance.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&void 0!==t&&t}isCellEdited(){const t=this.instance.getActiveEditor();return t&&t.isOpened()}beforeRender(t,e){t&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,e)}afterRender(t){t&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}appendRowHeader(t,e){if(e.firstChild){const o=e.firstChild;if(!Et(o,"relative"))return It(e),void this.appendRowHeader(t,e);this.updateCellHeader(o.querySelector(".rowHeader"),t,this.instance.getRowHeader)}else{const{rootDocument:o,getRowHeader:n}=this.instance,s=o.createElement("div"),i=o.createElement("span");s.className="relative",i.className="rowHeader",this.updateCellHeader(i,t,n),s.appendChild(i),e.appendChild(s)}this.instance.runHooks("afterGetRowHeader",t,e)}appendColHeader(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.instance.getColHeader,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e.firstChild){const s=e.firstChild;Et(s,"relative")?this.updateCellHeader(s.querySelector(".colHeader"),t,o,n):(It(e),this.appendColHeader(t,e,o,n))}else{const{rootDocument:s}=this.instance,i=s.createElement("div"),r=s.createElement("span");i.className="relative",r.className="colHeader",this.updateCellHeader(r,t,o,n),i.appendChild(r),e.appendChild(i)}this.instance.runHooks("afterGetColHeader",t,e,n)}updateCellHeader(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=e;const i=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&(Et(t,"colHeader")?s=i.wtTable.columnFilter.sourceToRendered(e):Et(t,"rowHeader")&&(s=i.wtTable.rowFilter.sourceToRendered(e))),s>-1?At(t,o(e,n)):(Ot(t,String.fromCharCode(160)),Mt(t,"cornerHeader"))}maximumVisibleElementWidth(t){const e=this._wt.wtViewport.getWorkspaceWidth(),o=e-t;return o>0?o:0}maximumVisibleElementHeight(t){const e=this._wt.wtViewport.getWorkspaceHeight(),o=e-t;return o>0?o:0}setLastSize(t,e){const o=$r.get(this);[o.lastWidth,o.lastHeight]=[t,e]}getLastSize(){const t=$r.get(this);return{width:t.lastWidth,height:t.lastHeight}}getFirstFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return Fr(this,Gr)}getRowHeadersCount(){return Fr(this,Yr)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}var Xr=Kr;const qr="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Qr=qr.length;function Jr(t){let e,o=t+1,n="";while(o>0)e=(o-1)%Qr,n=String.fromCharCode(65+e)+n,o=parseInt((o-e)/Qr,10);return n}function Zr(t){let e=0;if(t)for(let o=0,n=t.length-1;o<t.length;o+=1,n-=1)e+=Qr**n*(qr.indexOf(t[o])+1);return e-=1,e}function tl(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const o=[];let n,s;for(n=0;n<t;n++){const t=[];for(s=0;s<e;s++)t.push(Jr(s)+(n+1));o.push(t)}return o}function el(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const o=[];let n,s;for(n=0;n<t;n++){const t={};for(s=0;s<e;s++)t[`prop${s}`]=Jr(s)+(n+1);o.push(t)}return o}function ol(t,e){const o=[];let n;for(let s=0;s<t;s++){n=[];for(let t=0;t<e;t++)n.push("");o.push(n)}return o}function nl(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=t;const n=[];return Array.isArray(t)&&Array.isArray(t[0])||(o=[t]),o.forEach(((t,o)=>{Array.isArray(t)?t.forEach(((t,s)=>{n.push([o+e,s,t])})):Object.keys(t).forEach((s=>{n.push([o+e,s,t[s]])}))})),n}function sl(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Ae(t[0])&&(e=_e(t[0]))),e}function il(t){return!!(Array.isArray(t)&&t.length&&t.every((t=>Array.isArray(t))))}function rl(t){return!!(Array.isArray(t)&&t.length&&t.every((t=>"object"===typeof t&&!Array.isArray(t)&&null!==t)))}class ll{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.hot=t,this.data=e,this.dataType="array",this.colToProp=()=>{},this.propToCol=()=>{}}modifyRowData(t){let e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}getData(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}setData(t){this.data=t}getAtColumn(t){const e=[];return O(this.data,((o,n)=>{const s=this.getAtCell(n,t);e.push(s)})),e}getAtRow(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=void 0===e&&void 0===o;let i=null,r=null;if(i=this.modifyRowData(t),Array.isArray(i))r=[],s?i.forEach(((e,o)=>{r[o]=this.getAtPhysicalCell(t,o,i)})):tn(e,o,(o=>{r[o-e]=this.getAtPhysicalCell(t,o,i)}));else if(Ae(i)||ge(i))if(r=n?[]:{},!s||n){const s=0,l=this.countFirstRowKeys()-1;tn(s,l,(a=>{const h=this.colToProp(a);if(a>=(e||s)&&a<=(o||l)&&!Number.isInteger(h)){const e=this.getAtPhysicalCell(t,h,i);n?r.push(e):Pe(r,h,e)}}))}else ke(i,((e,o)=>{Pe(r,o,this.getAtPhysicalCell(t,o,i))}));return r}setAtCell(t,e,o){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const n=De(o);this.hot.runHooks("modifySourceData",t,e,n,"set"),n.isTouched()&&(o=n.value)}Number.isInteger(e)?this.data[t][e]=o:Pe(this.data[t],e,o)}}getAtPhysicalCell(t,e,o){let n=null;if(o&&(n="string"===typeof e?Ne(o,e):"function"===typeof e?e(o):o[e]),this.hot.hasHook("modifySourceData")){const o=De(n);this.hot.runHooks("modifySourceData",t,e,o,"get"),o.isTouched()&&(n=o.value)}return n}getAtCell(t,e){const o=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),o)}getByRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,s=null,i=null,r=null,l=null;null===t||null===e?(n=!0,s=0,r=this.countRows()-1):(s=Math.min(t.row,e.row),i=Math.min(t.col,e.col),r=Math.max(t.row,e.row),l=Math.max(t.col,e.col));const a=[];return tn(s,r,(t=>{a.push(n?this.getAtRow(t,void 0,void 0,o):this.getAtRow(t,i,l,o))})),a}countRows(){if(this.hot.hasHook("modifySourceLength")){const t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}countFirstRowKeys(){return sl(this.data)}destroy(){this.data=null,this.hot=null}}var al=ll;const hl="localHooks",cl={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,o,n,s,i,r){if(this._localHooks[t]){const l=this._localHooks[t].length;for(let a=0;a<l;a++)be(this._localHooks[t][a],this,e,o,n,s,i,r)}},clearLocalHooks(){return this._localHooks={},this}};Oe(cl,"MIXIN_NAME",hl,{writable:!1,enumerable:!1});var dl=cl;class ul{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.indexedValues=[],this.initValueOrFn=t}getValues(){return this.indexedValues}getValueAtIndex(t){const e=this.indexedValues;if(t<e.length)return e[t]}setValues(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}setValueAtIndex(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ge(this.initValueOrFn)?tn(t-1,(t=>this.indexedValues.push(this.initValueOrFn(t)))):tn(t-1,(()=>this.indexedValues.push(this.initValueOrFn))),this.runLocalHooks("change")}init(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function gl(t,e,o){return[...t.slice(0,e),...o,...t.slice(e)]}function ml(t,e){return H(t,(t=>!1===e.includes(t)))}function fl(t,e){return A(t,(t=>t-e.filter((e=>e<t)).length))}function pl(t,e){const o=e[0],n=e.length;return A(t,(t=>t>=o?t+n:t))}Ie(ul,dl);class wl extends ul{constructor(){super((t=>t))}insert(t,e){const o=pl(this.indexedValues,e);this.indexedValues=gl(o,t,e),super.insert(t,e)}remove(t){const e=ml(this.indexedValues,t);this.indexedValues=fl(e,t),super.remove(t)}}function Cl(t,e,o,n){const s=o.length?o[0]:void 0;return[...t.slice(0,s),...o.map(((t,e)=>ge(n)?n(t,e):n)),...void 0===s?[]:t.slice(s)]}function yl(t,e){return H(t,((t,o)=>!1===e.includes(o)))}class vl extends ul{insert(t,e){this.indexedValues=Cl(this.indexedValues,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){this.indexedValues=yl(this.indexedValues,t),super.remove(t)}}class bl extends vl{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getHiddenIndexes(){return I(this.getValues(),((t,e,o)=>(e&&t.push(o),t)),[])}}function Sl(t,e,o){return e=Rl(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Rl(t){var e=El(t,"string");return"symbol"===typeof e?e:String(e)}function El(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Ml extends ul{constructor(){super(...arguments),Sl(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map((t=>this.indexedValues[t]))}setValues(t){this.orderOfIndexes=[...Array(t.length).keys()],super.setValues(t)}setValueAtIndex(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(o,0,t),this.runLocalHooks("change"),!0)}clearValue(t){this.orderOfIndexes=ml(this.orderOfIndexes,[t]),ge(this.initValueOrFn)?super.setValueAtIndex(t,this.initValueOrFn(t)):super.setValueAtIndex(t,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(t)}insert(t,e){this.indexedValues=Cl(this.indexedValues,t,e,this.initValueOrFn),this.orderOfIndexes=pl(this.orderOfIndexes,e),super.insert(t,e)}remove(t){this.indexedValues=yl(this.indexedValues,t),this.orderOfIndexes=ml(this.orderOfIndexes,t),this.orderOfIndexes=fl(this.orderOfIndexes,t),super.remove(t)}getEntries(){return this.orderOfIndexes.map((t=>[t,this.getValueAtIndex(t)]))}}class Tl extends vl{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getTrimmedIndexes(){return I(this.getValues(),((t,e,o)=>(e&&t.push(o),t)),[])}}const xl=new Map([["hiding",bl],["index",ul],["linkedPhysicalIndexToValue",Ml],["physicalIndexToValue",vl],["trimming",Tl]]);function Il(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!xl.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(xl.get(t))(e)}let Hl=0;class Al{constructor(){this.collection=new Map}register(t,e){!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",(()=>this.runLocalHooks("change",e))),Hl+=1)}unregister(t){const e=this.collection.get(t);z(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),Hl-=1)}unregisterAll(){this.collection.forEach(((t,e)=>this.unregister(e))),this.collection.clear()}get(t){return $(t)?Array.from(this.collection.values()):this.collection.get(t)}getLength(){return this.collection.size}removeFromEvery(t){this.collection.forEach((e=>{e.remove(t)}))}insertToEvery(t,e){this.collection.forEach((o=>{o.insert(t,e)}))}initEvery(t){this.collection.forEach((e=>{e.init(t)}))}}function Ol(){return Hl}Ie(Al,dl);class kl extends Al{constructor(t,e){super(),this.mergedValuesCache=[],this.aggregationFunction=t,this.fallbackValue=e}getMergedValues(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.mergedValuesCache;if(0===this.getLength())return[];const e=A(this.get(),(t=>t.getValues())),o=[],n=z(e[0])&&e[0].length||0;for(let s=0;s<n;s+=1){const t=[];for(let o=0;o<this.getLength();o+=1)t.push(e[o][s]);o.push(t)}return A(o,this.aggregationFunction)}getMergedValueAtIndex(t,e){const o=this.getMergedValues(e)[t];return z(o)?o:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Nl(t,e,o){Pl(t,e),e.set(t,o)}function Pl(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _l(t,e,o){var n=Vl(t,e,"set");return Dl(t,n,o),o}function Dl(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function Ll(t,e){var o=Vl(t,e,"get");return Bl(t,o)}function Vl(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Bl(t,e){return e.get?e.get.call(t):e.value}var Fl=new WeakMap;class Wl{constructor(){Nl(this,Fl,{writable:!0,value:[]})}subscribe(t){return this.addLocalHook("change",t),this._write(Ll(this,Fl)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(t){return t.length>0&&this.runLocalHooks("change",t),this}_writeInitialChanges(t){_l(this,Fl,t)}}function jl(t,e){const o=[];let n=0,s=0;for(;n<t.length&&s<e.length;n++,s++)t[n]!==e[s]&&o.push({op:"replace",index:s,oldValue:t[n],newValue:e[s]});for(;n<e.length;n++)o.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;s<t.length;s++)o.push({op:"remove",index:s,oldValue:t[s],newValue:void 0});return o}function Ul(t,e,o){zl(t,e),e.set(t,o)}function zl(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $l(t,e){var o=Kl(t,e,"get");return Gl(t,o)}function Gl(t,e){return e.get?e.get.call(t):e.value}function Yl(t,e,o){var n=Kl(t,e,"set");return Xl(t,n,o),o}function Kl(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Xl(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}Ie(Wl,dl);var ql=new WeakMap,Ql=new WeakMap,Jl=new WeakMap,Zl=new WeakMap,ta=new WeakMap;class ea{constructor(){let{initialIndexValue:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ul(this,ql,{writable:!0,value:new Set}),Ul(this,Ql,{writable:!0,value:[]}),Ul(this,Jl,{writable:!0,value:[]}),Ul(this,Zl,{writable:!0,value:!1}),Ul(this,ta,{writable:!0,value:!1}),Yl(this,ta,null!==t&&void 0!==t&&t)}createObserver(){const t=new Wl;return $l(this,ql).add(t),t.addLocalHook("unsubscribe",(()=>{$l(this,ql).delete(t)})),t._writeInitialChanges(jl($l(this,Ql),$l(this,Jl))),t}emit(t){let e=$l(this,Jl);$l(this,Zl)&&$l(this,Ql).length===t.length||(0===t.length?t=new Array(e.length).fill($l(this,ta)):Yl(this,Ql,new Array(t.length).fill($l(this,ta))),$l(this,Zl)||(Yl(this,Zl,!0),e=$l(this,Ql)));const o=jl(e,t);$l(this,ql).forEach((t=>t._write(o))),Yl(this,Jl,t)}}new Set;class oa{constructor(){this.indexesSequence=new wl,this.trimmingMapsCollection=new kl((t=>t.some((t=>!0===t))),!1),this.hidingMapsCollection=new kl((t=>t.some((t=>!0===t))),!1),this.variousMapsCollection=new Al,this.hidingChangesObservable=new ea({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",(()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(t=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(t=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(t=>{this.runLocalHooks("change",t,this.variousMapsCollection)}))}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(t){if("hiding"!==t)throw new Error(`Unsupported index map type "${t}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(t,e,o){return this.registerMap(t,Il(e,o))}registerMap(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error(`Map with name "${t}" has been already registered.`);e instanceof Tl?this.trimmingMapsCollection.register(t,e):e instanceof bl?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);const o=this.getNumberOfIndexes();return o>0&&e.init(o),e}unregisterMap(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(t){const e=this.notTrimmedIndexesCache[t];return z(e)?e:null}getPhysicalFromRenderableIndex(t){const e=this.renderablePhysicalIndexesCache[t];return z(e)?e:null}getVisualFromPhysicalIndex(t){const e=this.fromPhysicalToVisualIndexesCache.get(t);return z(e)?e:null}getVisualFromRenderableIndex(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}getRenderableFromVisualIndex(t){const e=this.fromVisualToRenderableIndexesCache.get(t);return z(e)?e:null}getNearestNotHiddenIndex(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.getPhysicalFromVisualIndex(t);if(null===n)return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let i=-1;return i=e>0?s.findIndex((e=>e>t)):s.reverse().findIndex((e=>e<t)),-1===i?o?this.getNearestNotHiddenIndex(t,-e,!1):null:s[i]}initToLength(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(t).keys()],this.notHiddenIndexesCache=[...new Array(t).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(t){const e=this.getNumberOfIndexes();if(t<e){const e=[...Array(this.getNumberOfIndexes()-t).keys()].map((e=>e+t));this.removeIndexes(e)}else this.insertIndexes(e,t-e)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(t){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(t),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notTrimmedIndexesCache;const e=this.getIndexesSequence();return e.filter((t=>!1===this.isTrimmed(t)))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.notHiddenIndexesCache;const e=this.getIndexesSequence();return e.filter((t=>!1===this.isHidden(t)))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.renderablePhysicalIndexesCache;const e=this.getNotTrimmedIndexes();return e.filter((t=>!1===this.isHidden(t)))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(t,e){"number"===typeof t&&(t=[t]);const o=A(t,(t=>this.getPhysicalFromVisualIndex(t))),n=this.getNotTrimmedIndexesLength(),s=t.length,i=ml(this.getIndexesSequence(),o),r=i.filter((t=>!1===this.isTrimmed(t)));let l=i.indexOf(r[r.length-1])+1;if(e+s<n){const t=r[e];l=i.indexOf(t)}this.indexesChangeSource="move",this.setIndexesSequence(gl(i,l,o)),this.indexesChangeSource=void 0}isTrimmed(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}isHidden(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}insertIndexes(t,e){const o=this.getNotTrimmedIndexes()[t],n=z(o)?o:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),i=A(new Array(e).fill(n),((t,e)=>t+e));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,i),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(s,i),this.hidingMapsCollection.insertToEvery(s,i),this.variousMapsCollection.insertToEvery(s,i),this.resumeOperations()}removeIndexes(t){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}updateCache(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(t,e)}}cacheFromVisualToRenderableIndexes(){const t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromRenderableIndex(e),o=this.getVisualFromPhysicalIndex(t);this.fromVisualToRenderableIndexesCache.set(o,e)}}}function na(t,e){return ke(e,((e,o)=>{$(t[o])&&(t[o]=e)})),t}function sa(t){const e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,o=e.exec(t);return o?`${o[1].toLowerCase()}-${o[2].toUpperCase()}`:t}function ia(t){z(t)&&fo(j`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function ra(t,e){const o=Array.isArray(t)&&Number.isInteger(e);return o?t[e]:t}Ie(oa,dl);const{register:la,getValues:aa}=Mo("phraseFormatters");function ha(t,e){la(t,e)}function ca(){return aa()}ha("pluralize",ra);const da="ContextMenu:items",ua=da,ga=`${ua}.noItems`,ma=`${ua}.insertRowAbove`,fa=`${ua}.insertRowBelow`,pa=`${ua}.insertColumnOnTheLeft`,wa=`${ua}.insertColumnOnTheRight`,Ca=`${ua}.removeRow`,ya=`${ua}.removeColumn`,va=`${ua}.undo`,ba=`${ua}.redo`,Sa=`${ua}.readOnly`,Ra=`${ua}.clearColumn`,Ea=`${ua}.copy`,Ma=`${ua}.copyWithHeaders`,Ta=`${ua}.copyWithGroupHeaders`,xa=`${ua}.copyHeadersOnly`,Ia=`${ua}.cut`,Ha=`${ua}.freezeColumn`,Aa=`${ua}.unfreezeColumn`,Oa=`${ua}.mergeCells`,ka=`${ua}.unmergeCells`,Na=`${ua}.addComment`,Pa=`${ua}.editComment`,_a=`${ua}.removeComment`,Da=`${ua}.readOnlyComment`,La=`${ua}.align`,Va=`${ua}.align.left`,Ba=`${ua}.align.center`,Fa=`${ua}.align.right`,Wa=`${ua}.align.justify`,ja=`${ua}.align.top`,Ua=`${ua}.align.middle`,za=`${ua}.align.bottom`,$a=`${ua}.borders`,Ga=`${ua}.borders.top`,Ya=`${ua}.borders.right`,Ka=`${ua}.borders.bottom`,Xa=`${ua}.borders.left`,qa=`${ua}.borders.remove`,Qa=`${ua}.nestedHeaders.insertChildRow`,Ja=`${ua}.nestedHeaders.detachFromParent`,Za=`${ua}.hideColumn`,th=`${ua}.showColumn`,eh=`${ua}.hideRow`,oh=`${ua}.showRow`,nh="Filters:",sh=`${nh}conditions`,ih=`${sh}.none`,rh=`${sh}.isEmpty`,lh=`${sh}.isNotEmpty`,ah=`${sh}.isEqualTo`,hh=`${sh}.isNotEqualTo`,ch=`${sh}.beginsWith`,dh=`${sh}.endsWith`,uh=`${sh}.contains`,gh=`${sh}.doesNotContain`,mh=`${sh}.byValue`,fh=`${sh}.greaterThan`,ph=`${sh}.greaterThanOrEqualTo`,wh=`${sh}.lessThan`,Ch=`${sh}.lessThanOrEqualTo`,yh=`${sh}.isBetween`,vh=`${sh}.isNotBetween`,bh=`${sh}.after`,Sh=`${sh}.before`,Rh=`${sh}.today`,Eh=`${sh}.tomorrow`,Mh=`${sh}.yesterday`,Th=`${nh}labels.filterByCondition`,xh=`${nh}labels.filterByValue`,Ih=`${nh}labels.conjunction`,Hh=`${nh}labels.disjunction`,Ah=`${nh}values.blankCells`,Oh=`${nh}buttons.selectAll`,kh=`${nh}buttons.clear`,Nh=`${nh}buttons.ok`,Ph=`${nh}buttons.cancel`,_h=`${nh}buttons.placeholder.search`,Dh=`${nh}buttons.placeholder.value`,Lh=`${nh}buttons.placeholder.secondValue`,Vh={languageCode:"en-US",[ga]:"No available options",[ma]:"Insert row above",[fa]:"Insert row below",[pa]:"Insert column left",[wa]:"Insert column right",[Ca]:["Remove row","Remove rows"],[ya]:["Remove column","Remove columns"],[va]:"Undo",[ba]:"Redo",[Sa]:"Read only",[Ra]:"Clear column",[La]:"Alignment",[Va]:"Left",[Ba]:"Center",[Fa]:"Right",[Wa]:"Justify",[ja]:"Top",[Ua]:"Middle",[za]:"Bottom",[Ha]:"Freeze column",[Aa]:"Unfreeze column",[$a]:"Borders",[Ga]:"Top",[Ya]:"Right",[Ka]:"Bottom",[Xa]:"Left",[qa]:"Remove border(s)",[Na]:"Add comment",[Pa]:"Edit comment",[_a]:"Delete comment",[Da]:"Read-only comment",[Oa]:"Merge cells",[ka]:"Unmerge cells",[Ea]:"Copy",[Ma]:["Copy with header","Copy with headers"],[Ta]:["Copy with group header","Copy with group headers"],[xa]:["Copy header only","Copy headers only"],[Ia]:"Cut",[Qa]:"Insert child row",[Ja]:"Detach from parent",[Za]:["Hide column","Hide columns"],[th]:["Show column","Show columns"],[eh]:["Hide row","Hide rows"],[oh]:["Show row","Show rows"],[ih]:"None",[rh]:"Is empty",[lh]:"Is not empty",[ah]:"Is equal to",[hh]:"Is not equal to",[ch]:"Begins with",[dh]:"Ends with",[uh]:"Contains",[gh]:"Does not contain",[fh]:"Greater than",[ph]:"Greater than or equal to",[wh]:"Less than",[Ch]:"Less than or equal to",[yh]:"Is between",[vh]:"Is not between",[bh]:"After",[Sh]:"Before",[Rh]:"Today",[Eh]:"Tomorrow",[Mh]:"Yesterday",[Ah]:"Blank cells",[Th]:"Filter by condition",[xh]:"Filter by value",[Ih]:"And",[Hh]:"Or",[Oh]:"Select all",[kh]:"Clear",[Nh]:"OK",[Ph]:"Cancel",[_h]:"Search",[Dh]:"Value",[Lh]:"Second value"};var Bh=Vh;const Fh=p,Wh=Bh.languageCode,{register:jh,getItem:Uh,hasItem:zh,getValues:$h}=Mo("languagesDictionaries");function Gh(t,e){let o=t,n=e;return Ae(t)&&(n=t,o=n.languageCode),Yh(o,n),jh(o,Te(n)),Te(n)}function Yh(t,e){t!==Wh&&na(e,Uh(Wh))}function Kh(t){return Xh(t)?Te(Uh(t)):null}function Xh(t){return zh(t)}function qh(){return $h()}function Qh(t,e,o){const n=Kh(t);if(null===n)return null;const s=n[e];if($(s))return null;const i=Jh(s,o);return Array.isArray(i)?i[0]:i}function Jh(t,e){let o=t;return O(ca(),(n=>{o=n(t,e)})),o}function Zh(t){let e=sa(t);return Xh(e)||(e=Wh,ia(t)),e}Gh(Bh);const tc="active-header",ec="area",oc="cell",nc="fill",sc="header",ic="custom-selection";class rc{constructor(t,e){e&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners())}registerListeners(){const t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(()=>this.onMouseDown())),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp()));for(let e=0,o=this.main.childNodes.length;e<o;e++){const t=this.main.childNodes[e];this.eventManager.addEventListener(t,"mouseenter",(t=>this.onMouseEnter(t,this.main.childNodes[e])))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(t,e){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;t.preventDefault(),ho(t);const o=this,n=this.wot.rootDocument.body,s=e.getBoundingClientRect();function i(t){return t.clientY<Math.floor(s.top)||(t.clientY>Math.ceil(s.top+s.height)||(t.clientX<Math.floor(s.left)||(t.clientX>Math.ceil(s.left+s.width)||void 0)))}function r(t){i(t)&&(o.eventManager.removeEventListener(n,"mousemove",r),e.style.display="block")}e.style.display="none",this.eventManager.addEventListener(n,"mousemove",r)}createBorders(t){const{rootDocument:e}=this.wot;this.main=e.createElement("div");const o=["top","start","bottom","end","corner"];let n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(let r=0;r<5;r++){const s=o[r],i=e.createElement("div");i.className=`wtBorder ${this.settings.className||""}`,this.settings[s]&&this.settings[s].hide&&(i.className+=" hidden"),n=i.style,n.backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:t.border.color,n.height=this.settings[s]&&this.settings[s].width?`${this.settings[s].width}px`:`${t.border.width}px`,n.width=this.settings[s]&&this.settings[s].width?`${this.settings[s].width}px`:`${t.border.width}px`,this.main.appendChild(i)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),qe()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let i=s.bordersHolder;i||(i=e.createElement("div"),i.className="htBorders",s.bordersHolder=i,s.spreader.appendChild(i)),i.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:t}=this.wot;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")};const e=10,o=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const n={position:"absolute",height:`${o}px`,width:`${o}px`,"border-radius":`${parseInt(o/1.5,10)}px`};ke(n,((t,e)=>{this.selectionHandles.styles.bottomHitArea[e]=t,this.selectionHandles.styles.topHitArea[e]=t}));const s={position:"absolute",height:`${e}px`,width:`${e}px`,"border-radius":`${parseInt(e/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};ke(s,((t,e)=>{this.selectionHandles.styles.bottom[e]=t,this.selectionHandles.styles.top[e]=t})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(t,e){const o=this.wot.selections.createOrGetArea();return!(!o.cellRange||t===o.cellRange.to.row&&e===o.cellRange.to.col)}updateMultipleSelectionHandlesPosition(t,e,o,n,s,i){const r=this.wot.wtSettings.getSetting("rtlMode"),l=r?"right":"left",{top:a,topHitArea:h,bottom:c,bottomHitArea:d}=this.selectionHandles.styles,u=parseInt(a.borderWidth,10),g=parseInt(a.width,10),m=parseInt(h.width,10),f=this.wot.wtTable.getWidth(),p=this.wot.wtTable.getHeight();a.top=`${parseInt(o-g-1,10)}px`,a[l]=`${parseInt(n-g-1,10)}px`,h.top=`${parseInt(o-m/4*3,10)}px`,h[l]=`${parseInt(n-m/4*3,10)}px`;const w=Math.min(parseInt(n+s,10),f-g-2*u),C=Math.min(parseInt(n+s-m/4,10),f-m-2*u);c[l]=`${w}px`,d[l]=`${C}px`;const y=Math.min(parseInt(o+i,10),p-g-2*u),v=Math.min(parseInt(o+i-m/4,10),p-m-2*u);c.top=`${y}px`,d.top=`${v}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(a.display="block",h.display="block",this.isPartRange(t,e)?(c.display="none",d.display="none"):(c.display="block",d.display="block")):(a.display="none",c.display="none",h.display="none",d.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(a.zIndex="9999",h.zIndex="9999"):(a.zIndex="",h.zIndex="")}appear(t){if(this.disabled)return;const{wtTable:e,rootDocument:o,rootWindow:n}=this.wot;let s,i,r,l,a,h;const c=e.getRenderedRowsCount();for(let N=0;N<c;N+=1){const o=e.rowFilter.renderedToSource(N);if(o>=t[0]&&o<=t[2]){s=o,a=t[0];break}}for(let N=c-1;N>=0;N-=1){const o=e.rowFilter.renderedToSource(N);if(o>=t[0]&&o<=t[2]){i=o;break}}const d=e.getRenderedColumnsCount();for(let N=0;N<d;N+=1){const o=e.columnFilter.renderedToSource(N);if(o>=t[1]&&o<=t[3]){r=o,h=t[1];break}}for(let N=d-1;N>=0;N-=1){const o=e.columnFilter.renderedToSource(N);if(o>=t[1]&&o<=t[3]){l=o;break}}if(void 0===s||void 0===r)return void this.disappear();let u=e.getCell(this.wot.createCellCoords(s,r));const g=s!==i||r!==l,m=g?e.getCell(this.wot.createCellCoords(i,l)):u,f=Nt(u),p=g?Nt(m):f,w=Nt(e.TABLE),C=Ut(e.TABLE),y=f.top,v=f.left,b=this.wot.wtSettings.getSetting("rtlMode");let S=0,R=0;if(b){const t=Ut(u),e=n.innerWidth-w.left-C;R=v+t-p.left,S=n.innerWidth-v-t-e-1}else R=p.left+Ut(m)-v,S=v-w.left-1;if(this.isEntireColumnSelected(s,i)){const t=this.getDimensionsFromHeader("columns",r,l,a,w);let e=null;t&&([e,S,R]=t),e&&(u=e)}let E=y-w.top-1,M=p.top+zt(m)-y;if(this.isEntireRowSelected(r,l)){const t=this.getDimensionsFromHeader("rows",s,i,h,w);let e=null;t&&([e,E,M]=t),e&&(u=e)}const T=jt(u,n);parseInt(T.borderTopWidth,10)>0&&(E+=1,M=M>0?M-1:0),parseInt(T[b?"borderRightWidth":"borderLeftWidth"],10)>0&&(S+=1,R=R>0?R-1:0);const x=b?"right":"left";this.topStyle.top=`${E}px`,this.topStyle[x]=`${S}px`,this.topStyle.width=`${R}px`,this.topStyle.display="block",this.startStyle.top=`${E}px`,this.startStyle[x]=`${S}px`,this.startStyle.height=`${M}px`,this.startStyle.display="block";const I=Math.floor(this.settings.border.width/2);this.bottomStyle.top=E+M-I+"px",this.bottomStyle[x]=`${S}px`,this.bottomStyle.width=`${R}px`,this.bottomStyle.display="block",this.endStyle.top=`${E}px`,this.endStyle[x]=S+R-I+"px",this.endStyle.height=`${M+1}px`,this.endStyle.display="block";let H=this.settings.border.cornerVisible;H="function"===typeof H?H(this.settings.layerLevel):H;const A=this.wot.getSetting("onModifyGetCellCoords",i,l);let[O,k]=[i,l];if(A&&Array.isArray(A)&&([,,O,k]=A),qe()||!H||this.isPartRange(O,k))this.cornerStyle.display="none";else{this.cornerStyle.top=E+M+this.cornerCenterPointOffset-1+"px",this.cornerStyle[x]=S+R+this.cornerCenterPointOffset-1+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let t=Bt(e.TABLE);const s=t===n;s&&(t=o.documentElement);const r=parseInt(this.cornerDefaultStyle.width,10)/2,a=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const e=s?m.getBoundingClientRect().left:m.offsetLeft;let o=!1,n=0;b?(n=e-parseInt(this.cornerDefaultStyle.width,10)/2,o=n<0):(n=e+Ut(m)+parseInt(this.cornerDefaultStyle.width,10)/2,o=n>=Gt(t)),o&&(this.cornerStyle[x]=`${Math.floor(S+R+this.cornerCenterPointOffset-r)}px`,this.cornerStyle[b?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){const e=s?m.getBoundingClientRect().top:m.offsetTop,o=e+zt(m)+parseInt(this.cornerDefaultStyle.height,10)/2,n=o>=$t(t);n&&(this.cornerStyle.top=`${Math.floor(E+M+this.cornerCenterPointOffset-a)}px`,this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}qe()&&this.updateMultipleSelectionHandlesPosition(i,l,E,S,R,M)}isEntireColumnSelected(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(t,e,o,n,s){const{wtTable:i}=this.wot,r=i.wtRootElement.parentNode;let l=null,a=null,h=null,c=null,d=null,u=null,g=null,m=null;switch(t){case"rows":l=function(){return i.getRowHeader(...arguments)},a=function(){return zt(...arguments)},h="ht__selection--rows",u="top";break;case"columns":l=function(){return i.getColumnHeader(...arguments)},a=function(){return Ut(...arguments)},h="ht__selection--columns",u="left";break;default:}if(r.classList.contains(h)){const t=this.wot.getSetting("columnHeaders").length;if(g=l(e,t-n),m=l(o,t-n),!g||!m)return!1;const i=Nt(g),r=Nt(m);return g&&m&&(c=i[u]-s[u]-1,d=r[u]+a(m)-i[u]),[g,c,d]}return!1}changeBorderStyle(t,e){const o=this[t].style,n=e[t];!n||n.hide?Mt(this[t],"hidden"):(Et(this[t],"hidden")&&Tt(this[t],"hidden"),o.backgroundColor=n.color,"top"!==t&&"bottom"!==t||(o.height=`${n.width}px`),"start"!==t&&"end"!==t||(o.width=`${n.width}px`))}changeBorderToDefaultStyle(t){const e={width:1,color:"#000"},o=this[t].style;o.backgroundColor=e.color,o.width=`${e.width}px`,o.height=`${e.width}px`}toggleHiddenClass(t,e){this.changeBorderToDefaultStyle(t),e?Mt(this[t],"hidden"):Tt(this[t],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",qe()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}var lc=rc;class ac{constructor(t,e){this.settings=t,this.cellRange=e||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}getBorder(t){return this.instanceBorders[t.guid]||(this.instanceBorders[t.guid]=new lc(t,this.settings)),this.instanceBorders[t.guid]}isEmpty(){return null===this.cellRange}add(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}replace(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}addClassAtCoords(t,e,o,n){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=t.wtTable.getCell(this.settings.createCellCoords(e,o));if("object"===typeof i){let t=n;s&&(t=this.classNameGenerator(i),this.classNames.includes(t)||this.classNames.push(t)),Mt(i,t)}return this}linearClassNameGenerator(t,e){return function o(n){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===e||0===s)return t;let i=s>=0?s:e,r=t;i-=1;const l=0===i?t:`${t}-${i}`;if(Et(n,l)){const e=i+1;r=`${t}-${e}`}else r=o(n,i);return r}}draw(t){if(this.isEmpty())return void(this.settings.border&&this.getBorder(t).disappear());const e=t.wtTable.getRenderedRowsCount(),o=t.wtTable.getRenderedColumnsCount(),n=this.getCorners(),[s,i,r,l]=n,{highlightHeaderClassName:a,highlightColumnClassName:h,highlightRowClassName:c,highlightOnlyClosestHeader:d,selectionType:u}=this.settings,g=void 0===u||["active-header","header"].includes(u);if(g&&null!==i&&null!==l){let e=0;for(let n=0;n<o;n+=1){const o=t.wtTable.columnFilter.renderedToSource(n);if(o>=i&&o<=l){let n=t.wtTable.getColumnHeaders(o);const s=n.length-1;d&&n.length>1&&(n=[n[s]]);for(let r=0;r<n.length;r+=1){const c=[];let g=n[r];a&&c.push(a),h&&c.push(h),r=d?s:r;const m=t.getSetting("onBeforeHighlightingColumnHeader",o,r,{selectionType:u,columnCursor:e,selectionWidth:l-i+1,classNames:c});m!==o&&(g=t.wtTable.getColumnHeader(m,r)),Mt(g,c)}e+=1}}}if(null!==s&&null!==r){let n=0;for(let m=0;m<e;m+=1){const e=t.wtTable.rowFilter.renderedToSource(m);if(g&&e>=s&&e<=r){let o=t.wtTable.getRowHeaders(e);const i=o.length-1;d&&o.length>1&&(o=[o[i]]);for(let l=0;l<o.length;l+=1){const h=[];let g=o[l];a&&h.push(a),c&&h.push(c),l=d?i:l;const m=t.getSetting("onBeforeHighlightingRowHeader",e,l,{selectionType:u,rowCursor:n,selectionHeight:r-s+1,classNames:h});m!==e&&(g=t.wtTable.getRowHeader(m,l)),Mt(g,h)}n+=1}if(null!==i&&null!==l)for(let n=0;n<o;n+=1){const o=t.wtTable.columnFilter.renderedToSource(n);e>=s&&e<=r&&o>=i&&o<=l?this.settings.className&&this.addClassAtCoords(t,e,o,this.settings.className,this.settings.markIntersections):e>=s&&e<=r?c&&this.addClassAtCoords(t,e,o,c):o>=i&&o<=l&&h&&this.addClassAtCoords(t,e,o,h);const a=t.getSetting("onAfterDrawSelection",e,o,this.settings.layerLevel);"string"===typeof a&&this.addClassAtCoords(t,e,o,a)}}}t.getSetting("onBeforeDrawBorders",n,this.settings.className),this.settings.border&&this.getBorder(t).appear(n)}destroy(){Object.values(this.instanceBorders).forEach((t=>t.destroy()))}}var hc=ac;function cc(t,e,o){return e=dc(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function dc(t){var e=uc(t,"string");return"symbol"===typeof e?e:String(e)}function uc(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class gc extends hc{constructor(t,e){super(t,null),cc(this,"visualCellRange",null),this.visualCellRange=e||null,this.commit()}add(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(t){let{from:e,to:o}=t,n=this.getNearestNotHiddenCoords(e,1),s=this.getNearestNotHiddenCoords(o,-1);if(null===n||null===s)return null;if(n.row>s.row||n.col>s.col){const t="header"===this.settings.type||"active-header"===this.settings.type;if(!t)return null;n=e,s=o}return this.settings.createCellRange(n,n,s)}getNearestNotHiddenCoords(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const n=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),t.row,e);if(null===n)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),t.col,o);return null===s?null:this.settings.createCellCoords(n,s)}getNearestNotHiddenIndex(t,e,o){if(e<0)return e;const n=t.getNearestNotHiddenIndex(e,o),s="header"===this.settings.type||"active-header"===this.settings.type;return s&&null===n?-1:n}commit(){if(null===this.visualCellRange)return this;const t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===t?null:this.createRenderableCellRange(t.from,t.to),this}syncWith(t){const e="N-S"===t.getVerticalDirection()?1:-1,o="W-E"===t.getHorizontalDirection()?1:-1,n=this.getNearestNotHiddenCoords(t.from.clone().normalize(),e,o);if(null!==n&&t.overlaps(n)){if(null===this.cellRange){const t=this.settings.visualToRenderableCoords(n);this.cellRange=this.settings.createCellRange(t)}return t.setHighlight(n),this}return t.setHighlight(t.from),this}getCorners(){const{from:t,to:e}=this.cellRange,o=null===t.row||null===e.row,n=null===t.col||null===e.col,s=this.settings.createCellCoords(o?null:Math.min(t.row,e.row),n?null:Math.min(t.col,e.col)),i=this.settings.createCellCoords(o?null:Math.max(t.row,e.row),n?null:Math.max(t.col,e.col));return[s.row,s.col,i.row,i.col]}getVisualCorners(){const t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}createRenderableCellRange(t,e){const o=this.settings.visualToRenderableCoords(t),n=this.settings.visualToRenderableCoords(e);return this.settings.createCellRange(o,o,n)}}var mc=gc;function fc(t){let{activeHeaderClassName:e,...o}=t;const n=new mc({highlightHeaderClassName:e,...o,selectionType:tc});return n}var pc=fc;function wc(t){let{layerLevel:e,areaCornerVisible:o,...n}=t;const s=new mc({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:o},...n,selectionType:ec});return s}var Cc=wc;function yc(t){let{cellCornerVisible:e,...o}=t;const n=new mc({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e},...o,selectionType:oc});return n}var vc=yc;function bc(t){let{border:e,visualCellRange:o,...n}=t;const s=new mc({...e,...n,selectionType:ic},o);return s}var Sc=bc;function Rc(t){let{...e}=t;const o=new mc({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:nc});return o}var Ec=Rc;function Mc(t){let{headerClassName:e,rowClassName:o,columnClassName:n,...s}=t;const i=new mc({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:o,highlightColumnClassName:n,...s,highlightOnlyClosestHeader:!0,selectionType:sc});return i}var Tc=Mc;const{register:xc,getItem:Ic}=Mo("highlight/types");function Hc(t,e){return Ic(t)({type:t,...e})}xc(tc,pc),xc(ec,Cc),xc(oc,vc),xc(ic,Sc),xc(nc,Ec),xc(sc,Tc);class Ac{constructor(t){this.options=t,this.layerLevel=0,this.cell=Hc(oc,t),this.fill=Hc(nc,t),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}isEnabledFor(t,e){let o=t;t===oc&&(o="current");let n=this.options.disabledCellSelection(e.row,e.col);return"string"===typeof n&&(n=[n]),!1===n||Array.isArray(n)&&!n.includes(o)}useLayerLevel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}getCell(){return this.cell}getFill(){return this.fill}createOrGetArea(){const t=this.layerLevel;let e;return this.areas.has(t)?e=this.areas.get(t):(e=Hc(ec,{layerLevel:t,...this.options}),this.areas.set(t,e)),e}getAreas(){return[...this.areas.values()]}createOrGetHeader(){const t=this.layerLevel;let e;return this.headers.has(t)?e=this.headers.get(t):(e=Hc(sc,{...this.options}),this.headers.set(t,e)),e}getHeaders(){return[...this.headers.values()]}createOrGetActiveHeader(){const t=this.layerLevel;let e;return this.activeHeaders.has(t)?e=this.activeHeaders.get(t):(e=Hc(tc,{...this.options}),this.activeHeaders.set(t,e)),e}getActiveHeaders(){return[...this.activeHeaders.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(t){this.customSelections.push(Hc(ic,{...this.options,...t}))}clear(){this.cell.clear(),this.fill.clear(),O(this.areas.values(),(t=>{t.clear()})),O(this.headers.values(),(t=>{t.clear()})),O(this.activeHeaders.values(),(t=>{t.clear()}))}[Symbol.iterator](){return[this.cell,this.fill,...this.areas.values(),...this.headers.values(),...this.activeHeaders.values(),...this.customSelections][Symbol.iterator]()}}var Oc=Ac;class kc{constructor(t){this.ranges=[],this.createCellRange=t}isEmpty(){return 0===this.size()}set(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}add(t){return this.ranges.push(this.createCellRange(t)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(0)}previous(){return this.peekByIndex(-1)}includes(t){return this.ranges.some((e=>e.includes(t)))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const e=this.size()+t-1;let o;return e>=0&&(o=this.ranges[e]),o}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}var Nc=kc;class Pc{constructor(t,e){this.range=t,this.options=e}transformStart(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.options.createCellCoords(t,e),s=this.range.current().highlight,{row:i,col:r}=this.options.visualToRenderableCoords(s);let l=s,a=0,h=0;if(this.runLocalHooks("beforeTransformStart",n),null!==i&&null!==r){let e=this.options.countRows(),s=this.options.countCols();const c=this.options.fixedRowsBottom(),d=this.options.minSpareRows(),u=this.options.minSpareCols(),g=this.options.autoWrapRow(),m=this.options.autoWrapCol();i+t>e-1?o&&d>0&&!(c&&i>=e-c-1)?(this.runLocalHooks("insertRowRequire",e),e=this.options.countRows()):m&&(n.row=1-e,n.col=r+n.col===s-1?1-s:1):m&&i+n.row<0&&r+n.col>=0&&(n.row=e-1,n.col=r+n.col===0?s-1:-1),r+n.col>s-1?o&&u>0?(this.runLocalHooks("insertColRequire",s),s=this.options.countCols()):g&&(n.row=i+n.row===e-1?1-e:1,n.col=1-s):g&&r+n.col<0&&i+n.row>=0&&(n.row=i+n.row===0?e-1:-1,n.col=s-1);const f=this.options.createCellCoords(i+n.row,r+n.col);a=0,h=0,f.row<0?(a=-1,f.row=0):f.row>0&&f.row>=e&&(a=1,f.row=e-1),f.col<0?(h=-1,f.col=0):f.col>0&&f.col>=s&&(h=1,f.col=s-1),l=this.options.renderableToVisualCoords(f)}return this.runLocalHooks("afterTransformStart",l,a,h),l}transformEnd(t,e){const o=this.options.createCellCoords(t,e),n=this.range.current();let s=n.to,i=0,r=0;this.runLocalHooks("beforeTransformEnd",o);const{row:l,col:a}=this.options.visualToRenderableCoords(n.highlight);if(null!==l&&null!==a){const t=this.options.countRows(),e=this.options.countCols(),{row:l,col:a}=this.options.visualToRenderableCoords(n.to),h=this.options.createCellCoords(l+o.row,a+o.col);i=0,r=0,h.row<0?(i=-1,h.row=0):h.row>0&&h.row>=t&&(i=1,h.row=t-1),h.col<0?(r=-1,h.col=0):h.col>0&&h.col>=e&&(r=1,h.col=e-1),s=this.options.renderableToVisualCoords(h)}return this.runLocalHooks("afterTransformEnd",s,i,r),s}}Ie(Pc,dl);var _c=Pc;const Dc=0,Lc=1,Vc=2,Bc=3,Fc=[Bc,Vc],Wc=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],jc=Symbol("root"),Uc=Symbol("child");function zc(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jc;if(e!==jc&&e!==Uc)throw new Error("The second argument is used internally only and cannot be overwritten.");const o=Array.isArray(t),n=e===jc;let s=Dc;if(o){const e=t[0];if(0===t.length)s=Lc;else if(n&&e instanceof gi)s=Bc;else if(n&&Array.isArray(e))s=zc(e,Uc);else if(t.length>=2&&t.length<=4){const e=!t.some(((t,e)=>!Wc[e].includes(typeof t)));e&&(s=Vc)}}return s}function $c(t){let{keepDirection:e=!1,propToCol:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Fc.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(n){const s=t===Bc;let i=s?n.from.row:n[0],r=s?n.from.col:n[1],l=s?n.to.row:n[2],a=s?n.to.col:n[3];if("function"===typeof o&&("string"===typeof r&&(r=o(r)),"string"===typeof a&&(a=o(a))),$(l)&&(l=i),$(a)&&(a=r),!e){const t=i,e=r,o=l,n=a;i=Math.min(t,o),r=Math.min(e,n),l=Math.max(t,o),a=Math.max(e,n)}return[i,r,l,a]}}function Gc(t){const e=zc(t);if(e===Dc||e===Lc)return[];const o=$c(e),n=new Set;O(t,(t=>{const[,e,,s]=o(t),i=Math.max(e,0),r=s-i+1;O(Array.from(new Array(r),((t,e)=>i+e)),(t=>{n.has(t)||n.add(t)}))}));const s=Array.from(n).sort(((t,e)=>t-e)),i=I(s,((t,e,o,n)=>(0!==o&&e===n[o-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t)),[]);return i}function Yc(t){const e=zc(t);if(e===Dc||e===Lc)return[];const o=$c(e),n=new Set;O(t,(t=>{const[e,,s]=o(t),i=Math.max(e,0),r=s-i+1;O(Array.from(new Array(r),((t,e)=>i+e)),(t=>{n.has(t)||n.add(t)}))}));const s=Array.from(n).sort(((t,e)=>t-e)),i=I(s,((t,e,o,n)=>(0!==o&&e===n[o-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t)),[]);return i}function Kc(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return"number"===typeof t&&t>=0&&t<e}class Xc{constructor(t,e){var o=this;this.settings=t,this.tableProps=e,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Nc(((t,e,o)=>this.tableProps.createCellRange(t,e,o))),this.highlight=new Oc({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:(t,e)=>this.tableProps.isDisabledCellSelection(t,e),cellCornerVisible:function(){return o.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return o.isAreaCornerVisible(...arguments)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),createCellRange:(t,e,o)=>this.tableProps.createCellRange(t,e,o),rowIndexMapper:()=>this.tableProps.rowIndexMapper(),columnIndexMapper:()=>this.tableProps.columnIndexMapper()}),this.transformation=new _c(this.selectedRange,{countRows:()=>this.tableProps.countRowsTranslated(),countCols:()=>this.tableProps.countColsTranslated(),visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),fixedRowsBottom:()=>t.fixedRowsBottom,minSpareRows:()=>t.minSpareRows,minSpareCols:()=>t.minSpareCols,autoWrapRow:()=>t.autoWrapRow,autoWrapCol:()=>t.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeModifyTransformStart",...e)})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("afterModifyTransformStart",...e)})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("beforeModifyTransformEnd",...e)})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("afterModifyTransformEnd",...e)})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("insertRowRequire",...e)})),this.transformation.addLocalHook("insertColRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.runLocalHooks("insertColRequire",...e)}))}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n="multiple"===this.settings.selectionMode,s=$(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,i=t.row<0,r=t.col<0,l=i&&r,a=t.clone();this.selectedByCorner=l,this.runLocalHooks("beforeSetRangeStart"+(o?"Only":""),a),(!n||n&&!s&&$(e))&&this.selectedRange.clear(),this.selectedRange.add(a),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!l&&r&&this.selectedByRowHeader.add(this.getLayerLevel()),!l&&i&&this.selectedByColumnHeader.add(this.getLayerLevel()),o||this.setRangeEnd(t)}setRangeStartOnly(t,e){this.setRangeStart(t,e,!0)}setRangeEnd(t){if(this.selectedRange.isEmpty())return;const e=t.clone();this.runLocalHooks("beforeSetRangeEnd",e),this.begin();const o=this.selectedRange.current();"single"!==this.settings.selectionMode&&o.setTo(this.tableProps.createCellCoords(e.row,e.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(oc,o.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(o);const n=this.getLayerLevel();n<this.highlight.layerLevel&&(O(this.highlight.getAreas(),(t=>{t.clear()})),O(this.highlight.getHeaders(),(t=>{t.clear()})),O(this.highlight.getActiveHeaders(),(t=>{t.clear()}))),this.highlight.useLayerLevel(n);const s=this.highlight.createOrGetArea(),i=this.highlight.createOrGetHeader(),r=this.highlight.createOrGetActiveHeader();if(s.clear(),i.clear(),r.clear(),this.highlight.isEnabledFor(ec,o.highlight)&&(this.isMultiple()||n>=1)&&(s.add(o.from).add(o.to).commit(),1===n)){const t=this.selectedRange.previous();this.highlight.useLayerLevel(n-1).createOrGetArea().add(t.from).commit().syncWith(t),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(sc,o.highlight)){const t=0===this.tableProps.countRowsTranslated(),e=0===this.tableProps.countColsTranslated();let n=o;if((t||e)&&(n=o.clone()),t&&(n.from.row=-1),e&&(n.from.col=-1),"single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&n.from.normalize(),i.add(n.from).commit()):i.add(n.from).add(n.to).commit(),this.isEntireRowSelected()){const t=this.tableProps.countCols()===o.getWidth();t&&r.add(this.tableProps.createCellCoords(o.from.row,-1)).add(this.tableProps.createCellCoords(o.to.row,-1)).commit()}if(this.isEntireColumnSelected()){const t=this.tableProps.countRows()===o.getHeight();t&&r.add(this.tableProps.createCellCoords(-1,o.from.col)).add(this.tableProps.createCellCoords(-1,o.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",t)}isMultiple(){const t=De(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}transformStart(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(t,e,o))}transformEnd(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&this.isEntireRowSelected(t)}isEntireRowSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t)}isSelectedByColumnHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(t)}isEntireColumnSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByCorner}inInSelection(t){return this.selectedRange.includes(t)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isAreaCornerVisible(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.tableProps.countRows(),n=this.tableProps.countCols();if(!t&&!e&&(0===o||0===n))return;const s=this.tableProps.createCellCoords(e?-1:0,t?-1:0),i=this.tableProps.createCellCoords(o-1,n-1);this.clear(),this.setRangeStartOnly(s),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(i),this.finish()}selectCells(t){const e=zc(t);if(e===Lc)return!1;if(e===Dc)throw new Error(j`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const o=$c(e,{propToCol:t=>this.tableProps.propToCol(t),keepDirection:!0}),n=this.tableProps.countRows(),s=this.tableProps.countCols(),i=!t.some((t=>{const[e,i,r,l]=o(t),a=Kc(e,n)&&Kc(i,s)&&Kc(r,n)&&Kc(l,s);return!a}));return i&&(this.clear(),O(t,(t=>{const[e,n,s,i]=o(t);this.setRangeStartOnly(this.tableProps.createCellCoords(e,n),!1),this.setRangeEnd(this.tableProps.createCellCoords(s,i)),this.finish()}))),i}selectColumns(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;const n="string"===typeof t?this.tableProps.propToCol(t):t,s="string"===typeof e?this.tableProps.propToCol(e):e,i=this.tableProps.countCols(),r=this.tableProps.countRows(),l=Kc(n,i)&&Kc(s,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(o,n)),this.setRangeEnd(this.tableProps.createCellCoords(r-1,s)),this.finish()),l}selectRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;const n=this.tableProps.countRows(),s=this.tableProps.countCols(),i=Kc(t,n)&&Kc(e,n);return i&&(this.setRangeStartOnly(this.tableProps.createCellCoords(t,o)),this.setRangeEnd(this.tableProps.createCellCoords(e,s-1)),this.finish()),i}refresh(){const t=this.highlight.getCustomSelections();if(t.forEach((t=>{t.commit()})),!this.isSelected())return;const e=this.highlight.getCell(),o=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(let n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);const t=this.highlight.createOrGetArea(),e=this.highlight.createOrGetHeader(),o=this.highlight.createOrGetActiveHeader();t.commit(),e.commit(),o.commit()}this.highlight.useLayerLevel(o)}}Ie(Xc,dl);var qc=Xc;const{register:Qc,getItem:Jc,hasItem:Zc,getNames:td,getValues:ed}=Mo("cellTypes");function od(t){if(!Zc(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return Jc(t)}function nd(t,e){"string"!==typeof t&&(e=t,t=e.CELL_TYPE);const{editor:o,renderer:n,validator:s}=e;o&&_o(t,o),n&&kn(t,n),s&&Bn(t,s),Qc(t,e)}function sd(t,e){var o;return"CELL_TYPE"!==t&&((null===(o=e._automaticallyAssignedMetaProps)||void 0===o?void 0:o.has(t))||!Le(e,t))}function id(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const n="string"===typeof e.type?od(e.type):e.type;if(t._automaticallyAssignedMetaProps&&ke(e,((e,o)=>{t._automaticallyAssignedMetaProps.delete(o)})),!Ae(n))return;o!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);const s={};ke(n,((e,n)=>{var i;sd(n,o)&&(s[n]=e,null===(i=t._automaticallyAssignedMetaProps)||void 0===i||i.add(n))})),Ee(t,s)}function rd(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function o(){}Re(o,t);for(let n=0;n<e.length;n++)o.prototype[e[n]]=void 0;return o}function ld(t){return Number.isInteger(t)&&t>=0}function ad(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function hd(t){return null===t||void 0===t}var cd=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol(t){let e,o,n;for(e=0,o=this.countRows();e<o;e++)if(n=this.getDataAtCell(e,t),!1===G(n))return!1;return!0},isEmptyRow(t){let e,o,n,s;for(e=0,o=this.countCols();e<o;e++)if(n=this.getDataAtCell(t,e),!1===G(n))return"object"===typeof n&&(s=this.getCellMeta(t,e),He(this.getSchema()[s.prop],n));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function dd(){return class{}}class ud{constructor(t){this.metaCtor=dd(),this.meta=this.metaCtor.prototype,Ee(this.meta,cd()),this.meta.instance=t}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(t){var e;Ee(this.meta,t),id(this.meta,{...t,type:null!==(e=t.type)&&void 0!==e?e:this.meta.type},t)}}class gd{constructor(t){const e=t.getMetaConstructor();this.meta=new e}getMeta(){return this.meta}updateMeta(t){Ee(this.meta,t),id(this.meta,t,t)}}class md{constructor(t){this.valueFactory=t,this.data=[],this.index=[],this.holes=new Set}obtain(t){ad((()=>ld(t)),"Expecting an unsigned number.");const e=this._getStorageIndexByKey(t);let o;if(e>=0)o=this.data[e],void 0===o&&(o=this.valueFactory(t),this.data[e]=o);else if(o=this.valueFactory(t),this.holes.size>0){const e=this.holes.values().next().value;this.holes.delete(e),this.data[e]=o,this.index[t]=e}else this.data.push(o),this.index[t]=this.data.length-1;return o}insert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;ad((()=>ld(t)||hd(t)),"Expecting an unsigned number or null/undefined argument.");const o=[],n=this.data.length;for(let i=0;i<e;i++)o.push(n+i),this.data.push(void 0);const s=hd(t)?this.index.length:t;this.index=[...this.index.slice(0,s),...o,...this.index.slice(s)]}remove(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;ad((()=>ld(t)||hd(t)),"Expecting an unsigned number or null/undefined argument.");const o=this.index.splice(hd(t)?this.index.length-e:t,e);for(let n=0;n<o.length;n++){const t=o[n];"number"===typeof t&&this.holes.add(t)}}size(){return this.data.length-this.holes.size}values(){return H(this.data,((t,e)=>!this.holes.has(e)))[Symbol.iterator]()}entries(){const t=[];for(let o=0;o<this.data.length;o++){const e=this._getKeyByStorageIndex(o);-1!==e&&t.push([e,this.data[o]])}let e=0;return{next:()=>{if(e<t.length){const o=t[e];return e+=1,{value:o,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(t){return this.index.length>t?this.index[t]:-1}_getKeyByStorageIndex(t){return this.index.indexOf(t)}[Symbol.iterator](){return this.entries()}}const fd=["data","width"];class pd{constructor(t){this.globalMeta=t,this.metas=new md((()=>this._createMeta()))}updateMeta(t,e){const o=this.getMeta(t);Ee(o,e),id(o,e)}createColumn(t,e){this.metas.insert(t,e)}removeColumn(t,e){this.metas.remove(t,e)}getMeta(t){return this.metas.obtain(t)}getMetaConstructor(t){return this.metas.obtain(t).constructor}clearCache(){this.metas.clear()}_createMeta(){return rd(this.globalMeta.getMetaConstructor(),fd).prototype}}class wd{constructor(t){this.columnMeta=t,this.metas=new md((()=>this._createRow()))}updateMeta(t,e,o){const n=this.getMeta(t,e);Ee(n,o),id(n,o)}createRow(t,e){this.metas.insert(t,e)}createColumn(t,e){for(let o=0;o<this.metas.size();o++)this.metas.obtain(o).insert(t,e)}removeRow(t,e){this.metas.remove(t,e)}removeColumn(t,e){for(let o=0;o<this.metas.size();o++)this.metas.obtain(o).remove(t,e)}getMeta(t,e,o){const n=this.metas.obtain(t).obtain(e);return void 0===o?n:n[o]}setMeta(t,e,o,n){var s;const i=this.metas.obtain(t).obtain(e);null===(s=i._automaticallyAssignedMetaProps)||void 0===s||s.delete(o),i[o]=n}removeMeta(t,e,o){const n=this.metas.obtain(t).obtain(e);delete n[o]}getMetas(){const t=[],e=Array.from(this.metas.values());for(let o=0;o<e.length;o++)t.push(...e[o].values());return t}getMetasAtRow(t){ad((()=>ld(t)),"Expecting an unsigned number.");const e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new md((t=>this._createMeta(t)))}_createMeta(t){const e=this.columnMeta.getMetaConstructor(t);return new e}}class Cd{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=t,this.globalMeta=new ud(t),this.tableMeta=new gd(this.globalMeta),this.columnMeta=new pd(this.globalMeta),this.cellMeta=new wd(this.columnMeta),o.forEach((t=>new t(this))),this.globalMeta.updateMeta(e)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(t){this.globalMeta.updateMeta(t)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(t){this.tableMeta.updateMeta(t)}getColumnMeta(t){return this.columnMeta.getMeta(t)}updateColumnMeta(t,e){this.columnMeta.updateMeta(t,e)}getCellMeta(t,e,o){let{visualRow:n,visualColumn:s}=o;const i=this.cellMeta.getMeta(t,e);return i.visualRow=n,i.visualCol=s,i.row=t,i.col=e,this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(t,e,o){if("string"!==typeof o)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,o)}setCellMeta(t,e,o,n){this.cellMeta.setMeta(t,e,o,n)}updateCellMeta(t,e,o){this.cellMeta.updateMeta(t,e,o)}removeCellMeta(t,e,o){this.cellMeta.removeMeta(t,e,o)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(t){return this.cellMeta.getMetasAtRow(t)}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}createColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}removeColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Ie(Cd,dl);class yd{constructor(t){this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",(t=>this.extendCellMeta(t))),Ro.getSingleton().add("beforeRender",(t=>{t&&this.metaSyncMemo.clear()}),this.metaManager.hot)}extendCellMeta(t){var e;const{row:o,col:n}=t;if(null!==(e=this.metaSyncMemo.get(o))&&void 0!==e&&e.has(n))return;const{visualRow:s,visualCol:i}=t,r=this.metaManager.hot,l=r.colToProp(i);t.prop=l,r.runHooks("beforeGetCellMeta",s,i,t);const a=Le(t,"type")?t.type:null;let h=ge(t.cells)?t.cells(o,n,l):null;var c;a&&(h?h.type=null!==(c=h.type)&&void 0!==c?c:a:h={type:a});h&&this.metaManager.updateCellMeta(o,n,h),r.runHooks("afterGetCellMeta",s,i,t),this.metaSyncMemo.has(o)||this.metaSyncMemo.set(o,new Set),this.metaSyncMemo.get(o).add(n)}}class vd{constructor(t){this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){const e=this.metaManager.hot.isRtl();if(e&&"fixedColumnsLeft"===t)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,e,o){if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]]),this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach(((t,e)=>{const{target:o,onChange:n=(()=>{})}=t,s="string"===typeof o,i=s?o:e,r=`_${i}`;this.metaManager.globalMeta.meta[r]=this.metaManager.globalMeta.meta[i],this.installPropWatcher(e,r,n),s&&this.installPropWatcher(o,r,n)}))}installPropWatcher(t,e,o){const n=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get(){return this[e]},set(s){const i=!n.usageTracker.has(t);n.usageTracker.add(t),o.call(n,t,s,i),this[e]=s},enumerable:!0,configurable:!0})}}const bd=/^(\r\n|\n\r|\r|\n)/,Sd=/^[^\t\r\n]+/,Rd=/^\t/;function Ed(t){const e=[[""]];if(0===t.length)return e;let o,n=0,s=0;while(t.length>0){if(o===t.length)break;if(o=t.length,t.match(Rd))t=t.replace(Rd,""),n+=1,e[s][n]="";else if(t.match(bd))t=t.replace(bd,""),n=0,s+=1,e[s]=[""];else{let o="";if(t.startsWith('"')){let e=0,n=!0;while(n){const s=t.slice(0,1);'"'===s&&(e+=1),o+=s,t=t.slice(1),(0===t.length||t.match(/^[\t\r\n]/)&&e%2===0)&&(n=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(t=>new Array(Math.floor(t.length/2)).fill('"').join("")))}else{const e=t.match(Sd);o=e?e[0]:"",t=t.slice(o.length)}e[s][n]=o}}return e}function Md(t){let e,o,n,s,i,r="";for(e=0,o=t.length;e<o;e+=1){for(s=t[e].length,n=0;n<s;n+=1)n>0&&(r+="\t"),i=t[e][n],"string"===typeof i?i.indexOf("\n")>-1?r+=`"${i.replace(/"/g,'""')}"`:r+=i:r+=null===i||void 0===i?"":i;e!==o-1&&(r+="\n")}return r}class Td{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(t,e,o){this.instance=t,this.metaManager=o,this.tableMeta=o.getTableMeta(),this.dataSource=e,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}createMap(){const t=this.getSchema();if("undefined"===typeof t)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const e=this.tableMeta.columns;let o;if(this.colToPropCache=[],this.propToColCache=new Map,e){let n=0,s=0,i=!1;if("function"===typeof e){const e=_e(t);n=e>0?e:this.countFirstRowKeys(),i=!0}else{const t=this.tableMeta.maxCols;n=Math.min(t,e.length)}for(o=0;o<n;o++){const t=i?e(o):e[o];if(Ae(t)){if("undefined"!==typeof t.data){const e=i?s:o;this.colToPropCache[e]=t.data,this.propToColCache.set(t.data,e)}s+=1}}}else this.recursiveDuckColumns(t)}countFirstRowKeys(){return sl(this.dataSource)}recursiveDuckColumns(t,e,o){let n,s=e,i=o;return"undefined"===typeof s&&(s=0,i=""),"object"!==typeof t||Array.isArray(t)||ke(t,((t,e)=>{null===t?(n=i+e,this.colToPropCache.push(n),this.propToColCache.set(n,s),s+=1):s=this.recursiveDuckColumns(t,s,`${e}.`)})),s}colToProp(t){if(!1===Number.isInteger(t))return t;const e=this.instance.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&z(this.colToPropCache[e])?this.colToPropCache[e]:e}propToCol(t){const e=this.propToColCache.get(t);if(z(e))return this.instance.toVisualColumn(e);const o=this.instance.toVisualColumn(t);return null===o?t:o}getSchema(){const t=this.tableMeta.dataSchema;return t?"function"===typeof t?t():t:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Se(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:o,mode:n="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=this.instance.countSourceRows();let i=s,r=0,l=t;("number"!==typeof l||l>=s)&&(l=s),l<this.instance.countRows()&&(i=this.instance.toPhysicalRow(l));const a=this.instance.runHooks("beforeCreateRow",l,e,o);if(!1===a||null===i)return{delta:0};const h=this.tableMeta.maxRows,c=this.getSchema().length,d=[];while(r<e&&s+r<h){let t=null;"array"===this.instance.dataType?this.tableMeta.dataSchema?t=Te(this.getSchema()):(t=[],tn(c-1,(()=>t.push(null)))):"function"===this.instance.dataType?t=this.tableMeta.dataSchema(l+r):(t={},Me(t,this.getSchema())),d.push(t),r+=1}this.instance.rowIndexMapper.insertIndexes(l,r),"below"===n&&(i=Math.min(i+1,s)),this.spliceData(i,0,d);const u=this.instance.toVisualRow(i);return this.instance.countSourceRows()===d.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),r>0&&(void 0===t||null===t?this.metaManager.createRow(null,r):"auto"!==o&&this.metaManager.createRow(i,e)),this.instance.runHooks("afterCreateRow",u,r,o),this.instance.forceFullRender=!0,{delta:r,startPhysicalIndex:i}}createCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:o,mode:n="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,i=this.tableMeta.maxCols,r=this.instance.countSourceCols();let l=t;("number"!==typeof l||l>=r)&&(l=r);const a=this.instance.runHooks("beforeCreateCol",l,e,o);if(!1===a)return{delta:0};let h=r;l<this.instance.countCols()&&(h=this.instance.toPhysicalColumn(l));const c=this.instance.countSourceRows();let d=this.instance.countCols(),u=0,g=h;"end"===n&&(g=Math.min(g+1,r));const m=g;while(u<e&&d<i){if("number"!==typeof l||l>=d)if(c>0)for(let t=0;t<c;t+=1)"undefined"===typeof s[t]&&(s[t]=[]),s[t].push(null);else s.push([null]);else for(let t=0;t<c;t++)s[t].splice(g,0,null);u+=1,g+=1,d+=1}this.instance.columnIndexMapper.insertIndexes(l,u),u>0&&(void 0===t||null===t?this.metaManager.createColumn(null,u):"auto"!==o&&this.metaManager.createColumn(m,e));const f=this.instance.toVisualColumn(m);return this.instance.runHooks("afterCreateCol",f,u,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:u,startPhysicalIndex:m}}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,n=Number.isInteger(t)?t:-e;const s=this.visualRowsToPhysical(n,e),i=this.instance.countSourceRows();n=(i+n)%i;const r=this.instance.runHooks("beforeRemoveRow",n,s.length,s,o);if(!1===r)return!1;const l=s.length;if(this.filterData(n,l,s),n<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(s);const t=z(this.tableMeta.columns)||z(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===t&&this.instance.columnIndexMapper.setIndexesSequence([])}const a=s.slice(0).sort(((t,e)=>e-t));return a.forEach((t=>{this.metaManager.removeRow(t,1)})),this.instance.runHooks("afterRemoveRow",n,l,s,o),this.instance.forceFullRender=!0,!0}removeCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let n="number"!==typeof t?-e:t;n=(this.instance.countCols()+n)%this.instance.countCols();const s=this.visualColumnsToPhysical(n,e),i=s.slice(0).sort(((t,e)=>e-t)),r=this.instance.runHooks("beforeRemoveCol",n,e,s,o);if(!1===r)return!1;let l=!0;const a=i.length,h=this.dataSource;for(let c=0;c<a;c++)l&&s[0]!==s[c]-c&&(l=!1);if(l)for(let c=0,d=this.instance.countSourceRows();c<d;c++)h[c].splice(s[0],e),0===c&&this.metaManager.removeColumn(s[0],e);else for(let c=0,d=this.instance.countSourceRows();c<d;c++)for(let t=0;t<a;t++)h[c].splice(i[t],1),0===c&&this.metaManager.removeColumn(i[t],1);return n<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(s),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",n,e,s,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(t,e,o){const n=this.instance.getDataAtCol(t),s=n.slice(e,e+o),i=n.slice(e+o);for(var r=arguments.length,l=new Array(r>3?r-3:0),a=3;a<r;a++)l[a-3]=arguments[a];T(l,i);let h=0;while(h<o)l.push(null),h+=1;return M(l),this.instance.populateFromArray(e,t,l,null,null,"spliceCol"),s}spliceRow(t,e,o){const n=this.instance.getSourceDataAtRow(t),s=n.slice(e,e+o),i=n.slice(e+o);for(var r=arguments.length,l=new Array(r>3?r-3:0),a=3;a<r;a++)l[a-3]=arguments[a];T(l,i);let h=0;while(h<o)l.push(null),h+=1;return this.instance.populateFromArray(t,e,[l],null,null,"spliceRow"),s}spliceData(t,e,o){const n=this.instance.runHooks("beforeDataSplice",t,e,o);if(!1!==n){const e=[...this.dataSource.slice(0,t),...o,...this.dataSource.slice(t)];this.dataSource.length=0,e.forEach((t=>this.dataSource.push(t)))}}filterData(t,e,o){let n=this.instance.runHooks("filterData",t,e,o);!1===Array.isArray(n)&&(n=this.dataSource.filter(((t,e)=>-1===o.indexOf(e)))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,n)}get(t,e){const o=this.instance.toPhysicalRow(t);let n=this.dataSource[o];const s=this.instance.runHooks("modifyRowData",o);n=isNaN(s)?s:n;let i=null;if(n&&n.hasOwnProperty&&Le(n,e))i=n[e];else if("string"===typeof e&&e.indexOf(".")>-1){const t=e.split(".");let o=n;if(!o)return null;for(let e=0,n=t.length;e<n;e++)if(o=o[t[e]],"undefined"===typeof o)return null;i=o}else"function"===typeof e&&(i=e(this.dataSource.slice(o,o+1)[0]));if(this.instance.hasHook("modifyData")){const t=De(i);this.instance.runHooks("modifyData",o,this.propToCol(e),t,"get"),t.isTouched()&&(i=t.value)}return i}getCopyable(t,e){return this.instance.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}set(t,e,o){const n=this.instance.toPhysicalRow(t);let s=o,i=this.dataSource[n];const r=this.instance.runHooks("modifyRowData",n);if(i=isNaN(r)?r:i,this.instance.hasHook("modifyData")){const t=De(s);this.instance.runHooks("modifyData",n,this.propToCol(e),t,"set"),t.isTouched()&&(s=t.value)}if(i&&i.hasOwnProperty&&Le(i,e))i[e]=s;else if("string"===typeof e&&e.indexOf(".")>-1){const t=e.split(".");let o,n=i,r=0;for(r=0,o=t.length-1;r<o;r++)"undefined"===typeof n[t[r]]&&(n[t[r]]={}),n=n[t[r]];n[t[r]]=s}else"function"===typeof e?e(this.dataSource.slice(n,n+1)[0],s):i[e]=s}visualRowsToPhysical(t,e){const o=this.instance.countSourceRows(),n=[];let s,i=(o+t)%o,r=e;while(i<o&&r)s=this.instance.toPhysicalRow(i),n.push(s),r-=1,i+=1;return n}visualColumnsToPhysical(t,e){const o=this.instance.countCols(),n=[];let s=(o+t)%o,i=e;while(s<o&&i){const t=this.instance.toPhysicalColumn(s);n.push(t),i-=1,s+=1}return n}clear(){for(let t=0;t<this.instance.countSourceRows();t++)for(let e=0;e<this.instance.countCols();e++)this.set(t,this.colToProp(e),"")}getLength(){const t=this.tableMeta.maxRows;let e;e=t<0||0===t?0:t||1/0;const o=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(o,e)}getAll(){const t={row:0,col:0},e={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return t.row-e.row!==0||this.instance.countSourceRows()?this.getRange(t,e,Td.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(t,e,o){const n=[];let s,i,r;const l=this.tableMeta.maxRows,a=this.tableMeta.maxCols;if(0===l||0===a)return[];const h=o===Td.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,c=Math.min(Math.max(l-1,0),Math.max(t.row,e.row)),d=Math.min(Math.max(a-1,0),Math.max(t.col,e.col));for(s=Math.min(t.row,e.row);s<=c;s++){r=[];const o=s>=0?this.instance.toPhysicalRow(s):s;for(i=Math.min(t.col,e.col);i<=d;i++){if(null===o)break;r.push(h.call(this,s,this.colToProp(i)))}null!==o&&n.push(r)}return n}getText(t,e){return Md(this.getRange(t,e,Td.DESTINATION_RENDERER))}getCopyableText(t,e){return Md(this.getRange(t,e,Td.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}var xd=Td;function Id(t,e,o,n){const{hotInstance:s,dataMap:i,dataSource:r,internalSource:l,source:a,metaManager:h,firstRun:c}=n,d=lt(l),u=s.getSettings();Array.isArray(u.dataSchema)?s.dataType="array":ge(u.dataSchema)?s.dataType="function":s.dataType="object",i&&i.destroy(),t=s.runHooks(`before${d}`,t,c,a);const g=new xd(s,t,h);if(e(g),"object"===typeof t&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error(`${l} only accepts array of objects or array of arrays (${typeof t} given)`);{const e=g.getSchema();let o;t=[];let n=0,i=0;for(n=0,i=u.startRows;n<i;n++)if("object"!==s.dataType&&"function"!==s.dataType||!u.dataSchema)if("array"===s.dataType)o=Te(e[0]),t.push(o);else{o=[];for(let t=0,e=u.startCols;t<e;t++)o.push(null);t.push(o)}else o=Te(e),t.push(o)}}Array.isArray(t[0])&&(s.dataType="array"),u.data=t,g.dataSource=t,r.data=t,r.dataType=s.dataType,r.colToProp=g.colToProp.bind(g),r.propToCol=g.propToCol.bind(g),r.countCachedColumns=g.countCachedColumns.bind(g),o(g),s.runHooks(`after${d}`,t,c,a),c||(s.runHooks("afterChange",null,l),s.render())}const Hd=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Ad=t=>t.map((t=>{const e=t.toLowerCase();return Hd.has(e)?Hd.get(e):e})).sort().join("+"),Od=t=>t.split("+"),kd=t=>t.toLowerCase(),Nd=t=>{const e=dn({errorIdExists:e=>`The "${e}" shortcut is already registered in the "${t}" context.`}),o=function(){let{keys:t,callback:o,group:n,runOnlyIf:s=(()=>!0),captureCtrl:i=!1,preventDefault:r=!0,stopPropagation:l=!1,relativeToGroup:a,position:h}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if($(n))throw new Error("You need to define the shortcut's group.");if(!1===ge(o))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(t))throw new Error(j`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const c={callback:o,group:n,runOnlyIf:s,captureCtrl:i,preventDefault:r,stopPropagation:l};z(a)&&([c.relativeToGroup,c.position]=[a,h]),t.forEach((t=>{const o=Ad(t),n=e.hasItem(o);if(n){const t=e.getItem(o);let n=t.findIndex((t=>t.group===a));-1!==n?"before"===h?n-=1:n+=1:n=t.length,t.splice(n,0,c)}else e.addItem(o,[c])}))},n=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach((t=>{ke(e,((o,n)=>{!1===Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=e[n])})),o(t)}))},s=t=>{const o=Ad(t);e.removeItem(o)},i=t=>{const o=e.getItems();o.forEach((e=>{let[o,n]=e;const i=n.filter((e=>e.group!==t));0===i.length?s(Od(o)):(n.length=0,n.push(...i))}))},r=t=>{const o=Ad(t),n=e.getItem(o);return z(n)?n.slice():[]},l=t=>{const o=Ad(t);return e.hasItem(o)};return{addShortcut:o,addShortcuts:n,getShortcuts:r,hasShortcut:l,removeShortcutsByKeys:s,removeShortcutsByGroup:i}};function Pd(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const _d=["meta","alt","shift","control"],Dd=Pd();function Ld(t,e,o,n,s){const i=t=>_d.includes(t),r=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=[];return t.altKey&&o.push("alt"),e&&(t.ctrlKey||t.metaKey)?o.push("control/meta"):(t.ctrlKey&&o.push("control"),t.metaKey&&o.push("meta")),t.shiftKey&&o.push("shift"),o},l=t=>{if(!1===e(t))return;const l=o(t);if(229===t.keyCode||!1===l||co(t))return;const a=kd(t.key);let h=[];i(a)?Dd.press(a):h=r(t);const c=[a].concat(h),d=s(t,c);!d&&(to()&&h.includes("meta")||!to()&&h.includes("control"))&&s(t,[a].concat(r(t,!0))),n(t)},a=t=>{if(!1===e(t))return;const o=kd(t.key);!1!==i(o)&&Dd.release(o)},h=()=>{Dd.releaseAll()},c=()=>{let e=t;while(e)e.document.documentElement.addEventListener("keydown",l),e.document.documentElement.addEventListener("keyup",a),e.document.documentElement.addEventListener("blur",h),e=pt(e)},d=()=>{let e=t;while(e)e.document.documentElement.removeEventListener("keydown",l),e.document.documentElement.removeEventListener("keyup",a),e.document.documentElement.removeEventListener("blur",h),e=pt(e)};return{mount:c,unmount:d,isPressed:t=>Dd.isPressed(t),releasePressedKeys:()=>Dd.releaseAll()}}const Vd=t=>{let{ownerWindow:e,handleEvent:o,beforeKeyDown:n,afterKeyDown:s}=t;const i=dn({errorIdExists:t=>`The "${t}" context name is already registered.`});let r="grid";const l=t=>{const e=Nd(t);return i.addItem(t,e),e},a=()=>r,h=t=>i.getItem(t),c=t=>{r=t};let d=!1;const u=Ld(e,o,n,s,((t,e)=>{const o=h(a());let n=!1;if(!o.hasShortcut(e))return n;const s=o.getShortcuts(e);for(let i=0;i<s.length;i++){const{callback:o,runOnlyIf:r,preventDefault:l,stopPropagation:a,captureCtrl:h}=s[i];if(!1!==r(t)&&(d=h,n=!1===o(t,e),d=!1,l&&t.preventDefault(),a&&t.stopPropagation(),n))break}return n}));return u.mount(),{addContext:l,getActiveContextName:a,getContext:h,setActiveContextName:c,isCtrlPressed:()=>!d&&(u.isPressed("control")||u.isPressed("meta")),releasePressedKeys:()=>u.releasePressedKeys(),destroy:()=>u.unmount()}},Bd="gridDefault";let Fd=null;new Set;function Wd(t,e){var o;let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=!1,i=this;const r=new Bo(i);let l,a,h,c,d=!0;Nr(n)&&kr(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const u=null!==(o=null===e||void 0===e?void 0:e.layoutDirection)&&void 0!==o?o:"inherit",g=["rtl","ltr"].includes(u)?u:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",g),this.isRtl=function(){return"rtl"===g},this.isLtr=function(){return!i.isRtl()},this.getDirectionFactor=function(){return i.isLtr()?1:-1},e.language=Zh(e.language);const m=new Cd(i,e,[yd,vd]),f=m.getTableMeta(),p=m.getGlobalMeta(),w=dn();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Pr(this)&&it(e.licenseKey,t),this.guid=`ht_${ht()}`,this.columnIndexMapper=new oa,this.rowIndexMapper=new oa,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(t=>{i.runHooks("afterColumnSequenceChange",t)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(t=>{i.runHooks("afterRowSequenceChange",t)})),a=new al(i),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);const C=t=>{const{row:e,col:o}=t;return i._createCellCoords(e>=0?i.rowIndexMapper.getRenderableFromVisualIndex(e):e,o>=0?i.columnIndexMapper.getRenderableFromVisualIndex(o):o)},y=t=>{const{row:e,col:o}=t;return i._createCellCoords(e>=0?i.rowIndexMapper.getVisualFromRenderableIndex(e):e,o>=0?i.columnIndexMapper.getVisualFromRenderableIndex(o):o)};let v=new qc(f,{rowIndexMapper:()=>i.rowIndexMapper,columnIndexMapper:()=>i.columnIndexMapper,countCols:()=>i.countCols(),countRows:()=>i.countRows(),propToCol:t=>l.propToCol(t),isEditorOpened:()=>!!i.getActiveEditor()&&i.getActiveEditor().isOpened(),countColsTranslated:()=>this.view.countRenderableColumns(),countRowsTranslated:()=>this.view.countRenderableRows(),getShortcutManager:()=>i.getShortcutManager(),createCellCoords:(t,e)=>i._createCellCoords(t,e),createCellRange:(t,e,o)=>i._createCellRange(t,e,o),visualToRenderableCoords:C,renderableToVisualCoords:y,isDisabledCellSelection:(t,e)=>i.getCellMeta(t,e).disableVisualSelection});this.selection=v;const b=t=>{let{hiddenIndexesChanged:e}=t;e&&this.selection.refresh()};function S(t){const e=sa(t);Xh(e)?(i.runHooks("beforeLanguageChange",e),p.language=e,i.runHooks("afterLanguageChange",e)):ia(t)}function R(t,e){const o="className"===t?i.rootElement:i.table;if(d)Mt(o,e);else{let n=[],s=[];p[t]&&(n=Array.isArray(p[t])?p[t]:W(p[t])),e&&(s=Array.isArray(e)?e:W(e));const i=V(n,s),r=V(s,n);i.length&&Tt(o,i),r.length&&Mt(o,r)}p[t]=e}function E(){let t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function M(t){const e=t.replace(",",".");return!1===isNaN(parseFloat(e))?parseFloat(e):t}function T(t,e,o){if(!t.length)return;const n=i.getActiveEditor(),s=new E;let r=!0;s.onQueueEmpty=t=>{n&&r&&n.cancelChanges(),o(t)};for(let a=t.length-1;a>=0;a--){const[o,n,,h]=t[a],c=l.propToCol(n),d=i.getCellMeta(o,c);"numeric"===d.type&&"string"===typeof h&&Zo(h)&&(t[a][3]=M(h)),i.getCellValidator(d)&&(s.addValidatorToQueue(),i.validateCell(t[a][3],d,function(e,o){return function(n){if("boolean"!==typeof n)throw new Error("Validation error: result is not boolean");if(!1===n&&!1===o.allowInvalid){r=!1,t.splice(e,1),o.valid=!0;const n=i.getCell(o.visualRow,o.visualCol);null!==n&&Tt(n,f.invalidCellClassName)}s.removeValidatorFormQueue()}}(a,d),e))}s.checkIfQueueIsEmpty()}function H(t,e){let o=t.length-1;if(o<0)return;for(;o>=0;o--){let n=!1;if(null!==t[o]){if(null!==t[o][2]&&void 0!==t[o][2]||null!==t[o][3]&&void 0!==t[o][3]){if(f.allowInsertRow)while(t[o][0]>i.countRows()-1){const{delta:t}=l.createRow(void 0,void 0,{source:e});if(0===t){n=!0;break}}if("array"===i.dataType&&(!f.columns||0===f.columns.length)&&f.allowInsertColumn)while(l.propToCol(t[o][1])>i.countCols()-1){const{delta:t}=l.createCol(void 0,void 0,{source:e});if(0===t){n=!0;break}}n||l.set(t[o][0],t[o][1],t[o][3])}}else t.splice(o,1)}i.forceFullRender=!0,h.adjustRowsAndCols(),i.runHooks("beforeChangeRender",t,e),c.lockEditor(),i._refreshBorders(null),c.unlockEditor(),i.view.adjustElementsSize(),i.runHooks("afterChange",t,e||"edit");const n=i.getActiveEditor();n&&z(n.refreshValue)&&n.refreshValue()}function k(t,e,o){return Array.isArray(t)?t:[[t,e,o]]}function N(t,e){const o=i.getActiveEditor(),n=i.runHooks("beforeChange",t,e||"edit"),s=t.filter((t=>null!==t));return!1===n||0===s.length?(o&&o.cancelChanges(),[]):s}this.columnIndexMapper.addLocalHook("cacheUpdated",b),this.rowIndexMapper.addLocalHook("cacheUpdated",b),this.selection.addLocalHook("beforeSetRangeStart",(t=>{this.runHooks("beforeSetRangeStart",t)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(t=>{this.runHooks("beforeSetRangeStartOnly",t)})),this.selection.addLocalHook("beforeSetRangeEnd",(t=>{this.runHooks("beforeSetRangeEnd",t),t.row<0&&(t.row=this.view._wt.wtTable.getFirstVisibleRow()),t.col<0&&(t.col=this.view._wt.wtTable.getFirstVisibleColumn())})),this.selection.addLocalHook("afterSetRangeEnd",(t=>{const e=De(!1),o=this.selection.getSelectedRange(),{from:n,to:r}=o.current(),l=o.size()-1;this.runHooks("afterSelection",n.row,n.col,r.row,r.col,e,l),this.runHooks("afterSelectionByProp",n.row,i.colToProp(n.col),r.row,i.colToProp(r.col),e,l);const a=this.selection.isSelectedByAnyHeader(),h=this.selection.selectedRange.current();let c=!0;s&&(c=!1),e.isTouched()&&(c=!e.value);const d=this.selection.isSelectedByRowHeader(),u=this.selection.isSelectedByColumnHeader();!1!==c&&(a?d?this.view.scrollViewportVertically(i.rowIndexMapper.getRenderableFromVisualIndex(t.row)):u&&this.view.scrollViewportHorizontally(i.columnIndexMapper.getRenderableFromVisualIndex(t.col)):h&&!this.selection.isMultiple()?this.view.scrollViewport(C(h.from)):this.view.scrollViewport(C(t))),d&&u?Mt(this.rootElement,["ht__selection--rows","ht__selection--columns"]):d?(Tt(this.rootElement,"ht__selection--columns"),Mt(this.rootElement,"ht__selection--rows")):u?(Tt(this.rootElement,"ht__selection--rows"),Mt(this.rootElement,"ht__selection--columns")):Tt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(t=>{const e=t.length-1,{from:o,to:n}=t[e];this.runHooks("afterSelectionEnd",o.row,o.col,n.row,n.col,e),this.runHooks("afterSelectionEndByProp",o.row,i.colToProp(o.col),n.row,i.colToProp(n.col),e)})),this.selection.addLocalHook("afterIsMultipleSelection",(t=>{const e=this.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)})),this.selection.addLocalHook("beforeModifyTransformStart",(t=>{this.runHooks("modifyTransformStart",t)})),this.selection.addLocalHook("afterModifyTransformStart",((t,e,o)=>{this.runHooks("afterModifyTransformStart",t,e,o)})),this.selection.addLocalHook("beforeModifyTransformEnd",(t=>{this.runHooks("modifyTransformEnd",t)})),this.selection.addLocalHook("afterModifyTransformEnd",((t,e,o)=>{this.runHooks("afterModifyTransformEnd",t,e,o)})),this.selection.addLocalHook("afterDeselect",(()=>{c.destroyEditor(),this._refreshBorders(),Tt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(t=>{this.alter("insert_row_above",t,1,"auto")})),this.selection.addLocalHook("insertColRequire",(t=>{this.alter("insert_col_start",t,1,"auto")})),h={alter(t,e){var o,n;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;const c=t=>{if(0===t.length)return[];const e=[...t];e.sort(((t,e)=>{let[o]=t,[n]=e;return o===n?0:o>n?1:-1}));const o=I(e,((t,e)=>{let[o,n]=e;const s=t[t.length-1],[i,r]=s,l=i+r;if(o<=l){const t=Math.max(n-(l-o),0);s[1]+=t}else t.push([o,n]);return t}),[e[0]]);return o};switch(t){case"insert_row_below":case"insert_row_above":const a=i.countSourceRows();if(f.maxRows===a)return;const d="insert_row_below"===t?"below":"above";e=null!==(o=e)&&void 0!==o?o:"below"===d?a:0;const{delta:u,startPhysicalIndex:g}=l.createRow(e,s,{source:r,mode:d});if(u){const t=v.selectedRange.current(),e=null===t||void 0===t?void 0:t.from,o=null===e||void 0===e?void 0:e.row,n=i.toVisualRow(g);if(v.isSelectedByCorner())i.selectAll();else if(z(o)&&o>=n){const{row:n,col:s}=t.to;let r=e.col;v.isSelectedByRowHeader()&&(r=-1),v.getSelectedRange().pop(),v.setRangeStartOnly(i._createCellCoords(o+u,r),!0),v.setRangeEnd(i._createCellCoords(n+u,s))}else i._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const m="insert_col_end"===t?"end":"start";e=null!==(n=e)&&void 0!==n?n:"end"===m?i.countSourceCols():0;const{delta:p,startPhysicalIndex:w}=l.createCol(e,s,{source:r,mode:m});if(p){if(Array.isArray(f.colHeaders)){const t=[i.toVisualColumn(w),0];t.length+=p,Array.prototype.splice.apply(f.colHeaders,t)}const t=v.selectedRange.current(),e=null===t||void 0===t?void 0:t.from,o=null===e||void 0===e?void 0:e.col,n=i.toVisualColumn(w);if(v.isSelectedByCorner())i.selectAll();else if(z(o)&&o>=n){const{row:n,col:s}=t.to;let r=e.row;v.isSelectedByColumnHeader()&&(r=-1),v.getSelectedRange().pop(),v.setRangeStartOnly(i._createCellCoords(r,o+p),!0),v.setRangeEnd(i._createCellCoords(n,s+p))}else i._refreshBorders()}break;case"remove_row":const C=t=>{let e=0;O(t,(t=>{let[o,n]=t;const s=G(o)?i.countRows()-1:Math.max(o-e,0);Number.isInteger(o)&&(o=Math.max(o-e,0));const a=l.removeRow(o,n,r);if(!a)return;const h=i.countRows(),c=f.fixedRowsTop;c>=s+1&&(f.fixedRowsTop-=Math.min(n,c-s));const d=f.fixedRowsBottom;d&&s>=h-d&&(f.fixedRowsBottom-=Math.min(n,d)),e+=n}))};Array.isArray(e)?C(c(e)):C([[e,s]]),h.adjustRowsAndCols(),i._refreshBorders();break;case"remove_col":const y=t=>{let e=0;O(t,(t=>{let[o,n]=t;const s=G(o)?i.countCols()-1:Math.max(o-e,0);let a=i.toPhysicalColumn(s);Number.isInteger(o)&&(o=Math.max(o-e,0));const h=l.removeCol(o,n,r);if(!h)return;const c=f.fixedColumnsStart;c>=s+1&&(f.fixedColumnsStart-=Math.min(n,c-s)),Array.isArray(f.colHeaders)&&("undefined"===typeof a&&(a=-1),f.colHeaders.splice(a,n)),e+=n}))};Array.isArray(e)?y(c(e)):y([[e,s]]),h.adjustRowsAndCols(),i._refreshBorders();break;default:throw new Error(`There is no such action "${t}"`)}a||h.adjustRowsAndCols()},adjustRowsAndCols(){const t=f.minRows,e=f.minSpareRows,o=f.minCols,n=f.minSpareCols;if(0===i.countRows()&&0===i.countCols()&&v.deselect(),t){const e=i.countRows();e<t&&l.createRow(e,t-e,{source:"auto"})}if(e){const t=i.countEmptyRows(!0);if(t<e){const o=e-t,n=Math.min(o,f.maxRows-i.countSourceRows());l.createRow(i.countRows(),n,{source:"auto"})}}{let t;(o||n)&&(t=i.countEmptyCols(!0));let e=i.countCols();if(o&&!f.columns&&e<o){const n=o-e;t+=n,l.createCol(e,n,{source:"auto"})}if(n&&!f.columns&&"array"===i.dataType&&t<n){e=i.countCols();const o=n-t,s=Math.min(o,f.maxCols-e);l.createCol(e,s,{source:"auto"})}}if(v.isSelected()){const t=i.countRows(),e=i.countCols();O(v.selectedRange,(o=>{let n=!1,s=o.from.row,r=o.from.col,l=o.to.row,a=o.to.col;s>t-1?(s=t-1,n=!0,l>s&&(l=s)):l>t-1&&(l=t-1,n=!0,s>l&&(s=l)),r>e-1?(r=e-1,n=!0,a>r&&(a=r)):a>e-1&&(a=e-1,n=!0,r>a&&(r=a)),n&&i.selectCell(s,r,l,a)}))}i.view&&i.view.adjustElementsSize()},populateFromArray(t,e,o,n,s){let r,l,a,h;const c=[],d={},u=[],g=t.row,m=t.col;if(l=e.length,0===l)return!1;let p=0,w=0;switch(Ae(o)&&(p=o.col-m+1,w=o.row-g+1),s){case"shift_down":const s=x(e),C=s.length,y=Math.max(C,p),v=i.getData().slice(g),b=x(v).slice(m,m+y);for(a=0;a<y;a+=1)if(a<C){for(r=0,l=s[a].length;r<w-l;r+=1)s[a].push(s[a][r%l]);a<b.length?u.push(s[a].concat(b[a])):u.push(s[a].concat(new Array(v.length).fill(null)))}else u.push(s[a%C].concat(b[a]));i.populateFromArray(g,m,x(u));break;case"shift_right":const S=e.length,R=Math.max(S,w),E=i.getData().slice(g).map((t=>t.slice(m)));for(r=0;r<R;r+=1)if(r<S){for(a=0,h=e[r].length;a<p-h;a+=1)e[r].push(e[r][a%h]);if(r<E.length)for(let t=0;t<E[r].length;t+=1)e[r].push(E[r][t]);else e[r].push(...new Array(E[0].length).fill(null))}else e.push(e[r%l].slice(0,R).concat(E[r]));i.populateFromArray(g,m,e);break;case"overwrite":default:d.row=t.row,d.col=t.col;let M,T=0,I=0,H=!0;const A=function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=e[t%e.length];return null!==o?n[o%n.length]:n},O=e.length,k=o?o.row-t.row+1:0;for(l=o?k:Math.max(O,k),r=0;r<l;r++){if(o&&d.row>o.row&&k>O||!f.allowInsertRow&&d.row>i.countRows()-1||d.row>=f.maxRows)break;const e=r-T,s=A(e).length,u=o?o.col-t.col+1:0;if(h=o?u:Math.max(s,u),d.col=t.col,M=i.getCellMeta(d.row,d.col),"CopyPaste.paste"!==n&&"Autofill.fill"!==n||!M.skipRowOnPaste){for(I=0,a=0;a<h;a++){if(o&&d.col>o.col&&u>s||!f.allowInsertColumn&&d.col>i.countCols()-1||d.col>=f.maxCols)break;if(M=i.getCellMeta(d.row,d.col),("CopyPaste.paste"===n||"Autofill.fill"===n)&&M.skipColumnOnPaste){I+=1,d.col+=1,h+=1;continue}if(M.readOnly&&"UndoRedo.undo"!==n){d.col+=1;continue}const t=a-I;let r=A(e,t),l=i.getDataAtCell(d.row,d.col);if(null!==r&&"object"===typeof r)if(Array.isArray(r)&&null===l&&(l=[]),null===l||"object"!==typeof l)H=!1;else{const t=Se(Array.isArray(l)?l:l[0]||l),e=Se(Array.isArray(r)?r:r[0]||r);He(t,e)||Array.isArray(t)&&Array.isArray(e)?r=Te(r):H=!1}else null!==l&&"object"===typeof l&&(H=!1);H&&c.push([d.row,d.col,r]),H=!0,d.col+=1}d.row+=1}else T+=1,d.row+=1,l+=1}i.setDataAtCell(c,null,null,n||"populateFromArray");break}}},this.init=function(){a.setData(f.data),i.runHooks("beforeInit"),(qe()||Je())&&Mt(i.rootElement,"mobile"),this.updateSettings(f,!0),this.view=new Xr(this),c=$o.getInstance(i,f,v),i.runHooks("init"),this.forceFullRender=!0,this.view.render(),d&&null===i.rootElement.offsetParent&&ue(i.rootElement,(()=>{i.view._wt.wtOverlays.updateLastSpreaderSize(),i.render(),i.view.adjustElementsSize()})),"object"===typeof d&&(i.runHooks("afterChange",d[0],d[1]),d=!1),i.runHooks("afterInit")},this._createCellCoords=function(t,e){return i.view._wt.createCellCoords(t,e)},this._createCellRange=function(t,e,o){return i.view._wt.createCellRange(t,e,o)},this.validateCell=function(t,e,o,n){let s=i.getCellValidator(e);function r(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!n||!0===e.hidden)return void o(t);const s=e.visualCol,r=e.visualRow,l=i.getCell(r,s,!0);if(l&&"TH"!==l.nodeName){const t=i.rowIndexMapper.getRenderableFromVisualIndex(r),e=i.columnIndexMapper.getRenderableFromVisualIndex(s);i.view._wt.getSetting("cellRenderer",t,e,l)}o(t)}Y(s)&&(s=function(t){return function(e,o){o(t.test(e))}}(s)),ge(s)?(t=i.runHooks("beforeValidate",t,e.visualRow,e.prop,n),i._registerImmediate((()=>{s.call(e,t,(o=>{i&&(o=i.runHooks("afterValidate",o,t,e.visualRow,e.prop,n),e.valid=o,r(o),i.runHooks("postAfterValidate",o,t,e.visualRow,e.prop,n))}))}))):i._registerImmediate((()=>{e.valid=!0,r(e.valid,!1)}))},this.setDataAtCell=function(t,e,o,n){const s=k(t,e,o),r=[];let h,c,d,u=n;for(h=0,c=s.length;h<c;h++){if("object"!==typeof s[h])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!==typeof s[h][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");d=s[h][1]>=this.countCols()?s[h][1]:l.colToProp(s[h][1]),r.push([s[h][0],d,a.getAtCell(this.toPhysicalRow(s[h][0]),s[h][1]),s[h][2]])}u||"object"!==typeof t||(u=e);const g=N(r,n);i.runHooks("afterSetDataAtCell",g,u),T(g,u,(()=>{H(g,u)}))},this.setDataAtRowProp=function(t,e,o,n){const s=k(t,e,o),r=[];let l,h,c=n;for(l=0,h=s.length;l<h;l++)r.push([s[l][0],s[l][1],a.getAtCell(this.toPhysicalRow(s[l][0]),s[l][1]),s[l][2]]);c||"object"!==typeof t||(c=e);const d=N(r,n);i.runHooks("afterSetDataAtRowProp",d,c),T(d,c,(()=>{H(d,c)}))},this.listen=function(){i&&!i.isListening()&&(Fd=i.guid,i.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Fd=null,i.runHooks("afterUnlisten"))},this.isListening=function(){return Fd===i.guid},this.destroyEditor=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];i._refreshBorders(t,e)},this.populateFromArray=function(t,e,o,n,s,r,l){if("object"!==typeof o||"object"!==typeof o[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const a="number"===typeof n?i._createCellCoords(n,s):null;return h.populateFromArray(i._createCellCoords(t,e),o,a,r,l)},this.spliceCol=function(t,e,o){for(var n=arguments.length,s=new Array(n>3?n-3:0),i=3;i<n;i++)s[i-3]=arguments[i];return l.spliceCol(t,e,o,...s)},this.spliceRow=function(t,e,o){for(var n=arguments.length,s=new Array(n>3?n-3:0),i=3;i<n;i++)s[i-3]=arguments[i];return l.spliceRow(t,e,o,...s)},this.getSelected=function(){if(v.isSelected())return A(v.getSelectedRange(),(t=>{let{from:e,to:o}=t;return[e.row,e.col,o.row,o.col]}))},this.getSelectedLast=function(){const t=this.getSelected();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(v.isSelected())return Array.from(v.getSelectedRange())},this.getSelectedRangeLast=function(){const t=this.getSelectedRange();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(t){if(!v.isSelected()||0===this.countRows()||0===this.countCols())return;const e=[];O(v.getSelectedRange(),(t=>{const o=t.getTopStartCorner(),n=t.getBottomEndCorner();tn(o.row,n.row,(t=>{tn(o.col,n.col,(o=>{this.getCellMeta(t,o).readOnly||e.push([t,o,null])}))}))})),e.length>0&&this.setDataAtCell(e,t)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const t=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(t,0),this.isRenderSuspended()||t!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(c.lockEditor(),this._refreshBorders(null),c.unlockEditor()))},this.batchRender=function(t){this.suspendRender();const e=t();return this.resumeRender(),e},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(e,0),(!this.isExecutionSuspended()&&e===this.executionSuspendedCounter||t)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const o=t();return this.resumeExecution(e),o},this.batch=function(t){this.suspendRender(),this.suspendExecution();const e=t();return this.resumeExecution(),this.resumeRender(),e},this.refreshDimensions=function(){if(!i.view)return;const{width:t,height:e}=i.view.getLastSize(),{width:o,height:n}=i.rootElement.getBoundingClientRect(),s=o!==t||n!==e,r=!1===i.runHooks("beforeRefreshDimensions",{width:t,height:e},{width:o,height:n},s);r||((s||i.view._wt.wtOverlays.scrollableElement===i.rootWindow)&&(i.view.setLastSize(o,n),i.render()),i.runHooks("afterRefreshDimensions",{width:t,height:e},{width:o,height:n},s))},this.updateData=function(t,e){Id(t,(t=>{l=t}),(t=>{l=t,i.columnIndexMapper.fitToLength(this.getInitialColumnCount()),i.rowIndexMapper.fitToLength(this.countSourceRows()),h.adjustRowsAndCols()}),{hotInstance:i,dataMap:l,dataSource:a,internalSource:"updateData",source:e,metaManager:m,firstRun:d})},this.loadData=function(t,e){Id(t,(t=>{l=t}),(()=>{m.clearCellsCache(),i.initIndexMappers(),h.adjustRowsAndCols(),d&&(d=[null,"loadData"])}),{hotInstance:i,dataMap:l,dataSource:a,internalSource:"loadData",source:e,metaManager:m,firstRun:d})},this.getInitialColumnCount=function(){const t=f.columns;let e=0;if(Array.isArray(t))e=t.length;else if(ge(t))if("array"===i.dataType){const o=this.countSourceCols();for(let n=0;n<o;n+=1)t(n)&&(e+=1)}else"object"!==i.dataType&&"function"!==i.dataType||(e=l.colToPropCache.length);else if(z(f.dataSchema)){const t=l.getSchema();e=Array.isArray(t)?t.length:_e(t)}else e=this.countSourceCols();return e},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(t,e,o,n){return $(t)?l.getAll():l.getRange(i._createCellCoords(t,e),i._createCellCoords(o,n),l.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,o,n){return l.getCopyableText(i._createCellCoords(t,e),i._createCellCoords(o,n))},this.getCopyableData=function(t,e){return l.getCopyable(t,l.colToProp(e))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=(d?i.loadData:i.updateData).bind(this);let n,s,r=!1;if(z(t.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(z(t.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(z(t.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(n in t)"data"===n||("language"===n?S(t.language):"className"===n?R("className",t.className):"tableClassName"===n&&i.table?(R("tableClassName",t.tableClassName),i.view._wt.wtOverlays.syncOverlayTableClassNames()):Ro.getSingleton().isRegistered(n)||Ro.getSingleton().isDeprecated(n)?(ge(t[n])||Array.isArray(t[n]))&&(t[n].initialHook=!0,i.addHook(n,t[n])):!e&&Le(t,n)&&(p[n]=t[n]));void 0===t.data&&void 0===f.data?o(null,"updateSettings"):void 0!==t.data?o(t.data,"updateSettings"):void 0!==t.columns&&(l.createMap(),i.initIndexMappers());const a=i.countCols(),u=f.columns;if(u&&ge(u)&&(r=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||m.clearCache(),a>0)for(n=0,s=0;n<a;n++){if(u){const t=r?u(n):u[s];t&&m.updateColumnMeta(s,t)}s+=1}z(t.cell)&&ke(t.cell,(t=>{i.setCellMetaObject(t.row,t.col,t)})),i.runHooks("afterCellMetaReset");let g=i.rootElement.style.height;""!==g&&(g=parseInt(i.rootElement.style.height,10));let w=t.height;if(ge(w)&&(w=w()),e){const t=i.rootElement.getAttribute("style");t&&i.rootElement.setAttribute("data-initialstyle",i.rootElement.getAttribute("style"))}if(null===w){const t=i.rootElement.getAttribute("data-initialstyle");t&&(t.indexOf("height")>-1||t.indexOf("overflow")>-1)?i.rootElement.setAttribute("style",t):(i.rootElement.style.height="",i.rootElement.style.overflow="")}else void 0!==w&&(i.rootElement.style.height=isNaN(w)?`${w}`:`${w}px`,i.rootElement.style.overflow="hidden");if("undefined"!==typeof t.width){let e=t.width;ge(e)&&(e=e()),i.rootElement.style.width=isNaN(e)?`${e}`:`${e}px`}e||(i.view&&(i.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),i.view._wt.exportSettingsAsClassNames()),i.runHooks("afterUpdateSettings",t)),h.adjustRowsAndCols(),i.view&&!d&&(i.forceFullRender=!0,c.lockEditor(),i._refreshBorders(null),i.view._wt.wtOverlays.adjustElementsSize(),c.unlockEditor()),e||!i.view||""!==g&&""!==w&&void 0!==w||g===w||i.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const t=i.getSelectedLast();if(f.getValue){if(ge(f.getValue))return f.getValue.call(i);if(t)return i.getData()[t[0][0]][f.getValue]}else if(t)return i.getDataAtCell(t[0],t[1])},this.getSettings=function(){return f},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,o,n,s){h.alter(t,e,o,n,s)},this.getCell=function(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e,s=t;if(e>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(e)))return null;n=this.columnIndexMapper.getRenderableFromVisualIndex(e)}if(t>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(t)))return null;s=this.rowIndexMapper.getRenderableFromVisualIndex(t)}return null===s||null===n?null:i.view.getCellAtCoords(i._createCellCoords(s,n),o)},this.getCoords=function(t){const e=this.view._wt.wtTable.getCoords(t);if(null===e)return null;const{row:o,col:n}=e;let s=o,r=n;return o>=0&&(s=this.rowIndexMapper.getVisualFromRenderableIndex(o)),n>=0&&(r=this.columnIndexMapper.getVisualFromRenderableIndex(n)),i._createCellCoords(s,r)},this.colToProp=function(t){return l.colToProp(t)},this.propToCol=function(t){return l.propToCol(t)},this.toVisualRow=t=>this.rowIndexMapper.getVisualFromPhysicalIndex(t),this.toVisualColumn=t=>this.columnIndexMapper.getVisualFromPhysicalIndex(t),this.toPhysicalRow=t=>this.rowIndexMapper.getPhysicalFromVisualIndex(t),this.toPhysicalColumn=t=>this.columnIndexMapper.getPhysicalFromVisualIndex(t),this.getDataAtCell=function(t,e){return l.get(t,l.colToProp(e))},this.getDataAtRowProp=function(t,e){return l.get(t,e)},this.getDataAtCol=function(t){const e=[],o=l.getRange(i._createCellCoords(0,t),i._createCellCoords(f.data.length-1,t),l.DESTINATION_RENDERER);for(let n=0;n<o.length;n+=1)for(let t=0;t<o[n].length;t+=1)e.push(o[n][t]);return e},this.getDataAtProp=function(t){const e=[],o=l.getRange(i._createCellCoords(0,l.propToCol(t)),i._createCellCoords(f.data.length-1,l.propToCol(t)),l.DESTINATION_RENDERER);for(let n=0;n<o.length;n+=1)for(let t=0;t<o[n].length;t+=1)e.push(o[n][t]);return e},this.getSourceData=function(t,e,o,n){let s;return s=void 0===t?a.getData():a.getByRange(i._createCellCoords(t,e),i._createCellCoords(o,n)),s},this.getSourceDataArray=function(t,e,o,n){let s;return s=void 0===t?a.getData(!0):a.getByRange(i._createCellCoords(t,e),i._createCellCoords(o,n),!0),s},this.getSourceDataAtCol=function(t){return a.getAtColumn(t)},this.setSourceDataAtCell=function(t,e,o,n){const s=k(t,e,o),r=this.hasHook("afterSetSourceDataAtCell"),l=[];r&&O(s,(t=>{let[e,o,n]=t;l.push([e,o,a.getAtCell(e,o),n])})),O(s,(t=>{let[e,o,n]=t;a.setAtCell(e,o,n)})),r&&this.runHooks("afterSetSourceDataAtCell",l,n),this.render();const h=i.getActiveEditor();h&&z(h.refreshValue)&&h.refreshValue()},this.getSourceDataAtRow=function(t){return a.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return a.getAtCell(t,e)},this.getDataAtRow=function(t){const e=l.getRange(i._createCellCoords(t,0),i._createCellCoords(t,this.countCols()-1),l.DESTINATION_RENDERER);return e[0]||[]},this.getDataType=function(t,e,o,n){const s=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,o,n],[i,r]=s;let[,,l,a]=s,h=null,c=null;void 0===l&&(l=i),void 0===a&&(a=r);let d="mixed";return tn(Math.max(Math.min(i,l),0),Math.max(i,l),(t=>{let e=!0;return tn(Math.max(Math.min(r,a),0),Math.max(r,a),(o=>{const n=this.getCellMeta(t,o);return c=n.type,h?e=h===c:h=c,e})),d=e?c:"mixed",e})),d},this.removeCellMeta=function(t,e,o){const[n,s]=[this.toPhysicalRow(t),this.toPhysicalColumn(e)];let r=m.getCellMetaKeyValue(n,s,o);const l=i.runHooks("beforeRemoveCellMeta",t,e,o,r);!1!==l&&(m.removeCellMeta(n,s,o),i.runHooks("afterRemoveCellMeta",t,e,o,r)),r=null},this.spliceCellsMeta=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var o=arguments.length,n=new Array(o>2?o-2:0),s=2;s<o;s++)n[s-2]=arguments[s];if(n.length>0&&!Array.isArray(n[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");e>0&&m.removeRow(this.toPhysicalRow(t),e),n.length>0&&O(n.reverse(),(e=>{m.createRow(this.toPhysicalRow(t)),O(e,((e,o)=>this.setCellMetaObject(t,o,e)))})),i.render()},this.setCellMetaObject=function(t,e,o){"object"===typeof o&&ke(o,((o,n)=>{this.setCellMeta(t,e,n,o)}))},this.setCellMeta=function(t,e,o,n){const s=i.runHooks("beforeSetCellMeta",t,e,o,n);if(!1===s)return;let r=t,l=e;t<this.countRows()&&(r=this.toPhysicalRow(t)),e<this.countCols()&&(l=this.toPhysicalColumn(e)),m.setCellMeta(r,l,o,n),i.runHooks("afterSetCellMeta",t,e,o,n)},this.getCellsMeta=function(){return m.getCellsMeta()},this.getCellMeta=function(t,e){let o=this.toPhysicalRow(t),n=this.toPhysicalColumn(e);return null===o&&(o=t),null===n&&(n=e),m.getCellMeta(o,n,{visualRow:t,visualColumn:e})},this.getCellMetaAtRow=function(t){return m.getCellsMetaAtRow(t)},this.isColumnModificationAllowed=function(){return!("object"===i.dataType||f.columns)},this.getCellRenderer=function(t,e){const o="number"===typeof t?i.getCellMeta(t,e).renderer:t.renderer;return"string"===typeof o?On(o):$(o)?On("text"):o},this.getCellEditor=function(t,e){const o="number"===typeof t?i.getCellMeta(t,e).editor:t.editor;return"string"===typeof o?Po(o):$(o)?Po("text"):o},this.getCellValidator=function(t,e){const o="number"===typeof t?i.getCellMeta(t,e).validator:t.validator;return"string"===typeof o?Vn(o):o},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,o){const n=new E;t&&(n.onQueueEmpty=t);let s=i.countRows()-1;while(s>=0){if(void 0!==e&&-1===e.indexOf(s)){s-=1;continue}let t=i.countCols()-1;while(t>=0)void 0===o||-1!==o.indexOf(t)?(n.addValidatorToQueue(),i.validateCell(i.getDataAtCell(s,t),i.getCellMeta(s,t),(t=>{if("boolean"!==typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(n.valid=!1),n.removeValidatorFormQueue()}),"validateCells"),t-=1):t-=1;s-=1}n.checkIfQueueIsEmpty()},this.getRowHeader=function(t){let e=f.rowHeaders,o=t;return void 0!==o&&(o=i.runHooks("modifyRowHeader",o)),void 0===o?(e=[],tn(i.countRows()-1,(t=>{e.push(i.getRowHeader(t))}))):Array.isArray(e)&&void 0!==e[o]?e=e[o]:ge(e)?e=e(o):e&&"string"!==typeof e&&"number"!==typeof e&&(e=o+1),e},this.hasRowHeaders=function(){return!!f.rowHeaders},this.hasColHeaders=function(){if(void 0!==f.colHeaders&&null!==f.colHeaders)return!!f.colHeaders;for(let t=0,e=i.countCols();t<e;t++)if(i.getColHeader(t))return!0;return!1},this.getColHeader=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const o=i.runHooks("modifyColHeader",t);if(void 0===o){const t=[],e=i.countCols();for(let o=0;o<e;o++)t.push(i.getColHeader(o));return t}let n=f.colHeaders;const s=function(t){const e=[],o=i.countCols();let n=0;for(;n<o;n++)ge(f.columns)&&f.columns(n)&&e.push(n);return e[t]},r=i.toPhysicalColumn(o),l=s(r);return!1===f.colHeaders?n=null:f.columns&&ge(f.columns)&&f.columns(l)&&f.columns(l).title?n=f.columns(l).title:f.columns&&f.columns[r]&&f.columns[r].title?n=f.columns[r].title:Array.isArray(f.colHeaders)&&void 0!==f.colHeaders[r]?n=f.colHeaders[r]:ge(f.colHeaders)?n=f.colHeaders(r):f.colHeaders&&"string"!==typeof f.colHeaders&&"number"!==typeof f.colHeaders&&(n=Jr(o)),n=i.runHooks("modifyColumnHeaderValue",n,t,e),n},this._getColWidthFromSettings=function(t){let e;if(t>=0){const o=i.getCellMeta(0,t);e=o.width}if(void 0!==e&&e!==f.width||(e=f.colWidths),void 0!==e&&null!==e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t);break;default:break}"string"===typeof e&&(e=parseInt(e,10))}return e},this.getColWidth=function(t){let e=i._getColWidthFromSettings(t);return e=i.runHooks("modifyColWidth",e,t),void 0===e&&(e=br.DEFAULT_WIDTH),e},this._getRowHeightFromSettings=function(t){let e=f.rowHeights;if(void 0!==e&&null!==e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t);break;default:break}"string"===typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){let e=i._getRowHeightFromSettings(t);return e=i.runHooks("modifyRowHeight",e,t),e},this.countSourceRows=function(){return a.countRows()},this.countSourceCols=function(){return a.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const t=f.maxCols,e=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(t,e)},this.countRenderedRows=function(){return i.view._wt.drawn?i.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return i.view._wt.drawn?i.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return i.view._wt.drawn?i.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return i.view._wt.drawn?i.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return en(i.countRows()-1,(o=>{if(i.isEmptyRow(o))e+=1;else if(!0===t)return!1})),e},this.countEmptyCols=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return en(i.countCols()-1,(o=>{if(i.isEmptyCol(o))e+=1;else if(!0===t)return!1})),e},this.isEmptyRow=function(t){return f.isEmptyRow.call(i,t)},this.isEmptyCol=function(t){return f.isEmptyCol.call(i,t)},this.selectCell=function(t,e,o,n){let s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!$(t)&&!$(e)&&this.selectCells([[t,e,o,n]],s,i)},this.selectCells=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===e&&(s=!0);const n=v.selectCells(t);return n&&o&&i.listen(),s=!1,n},this.selectColumns=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return v.selectColumns(t,e)},this.selectRows=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return v.selectRows(t,e)},this.deselectCell=function(){v.deselect()},this.selectAll=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=t&&this.hasRowHeaders(),o=t&&this.hasColHeaders();s=!0,v.selectAll(e,o),s=!1};const P=(t,e)=>t.getNearestNotHiddenIndex(e,1,!0);function _(t){return()=>{throw new Error(`The "${t}" method cannot be called because this Handsontable instance has been destroyed`)}}this.scrollViewportTo=function(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const r=!o,l=!n;let a=t,h=e;if(s){const o=Number.isInteger(t),n=Number.isInteger(e),s=o?P(this.rowIndexMapper,t):void 0,r=n?P(this.columnIndexMapper,e):void 0;if(null===s||null===r)return!1;a=o?i.rowIndexMapper.getRenderableFromVisualIndex(s):void 0,h=n?i.columnIndexMapper.getRenderableFromVisualIndex(r):void 0}const c=Number.isInteger(a),d=Number.isInteger(h);return c&&d?i.view.scrollViewport(i._createCellCoords(a,h),r,n,o,l):c&&!1===d?i.view.scrollViewportVertically(a,r,o):!(!d||!1!==c)&&i.view.scrollViewportHorizontally(h,n,l)},this.destroy=function(){if(i._clearTimeouts(),i._clearImmediates(),i.view&&i.view.destroy(),a&&a.destroy(),a=null,this.getShortcutManager().destroy(),m.clearCache(),Pr(i)){const t=this.rootDocument.querySelector(".hot-display-license-info");t&&t.parentNode.removeChild(t)}It(i.rootElement),r.destroy(),c&&c.destroy(),i.batchExecution((()=>{i.rowIndexMapper.unregisterAll(),i.columnIndexMapper.unregisterAll(),w.getItems().forEach((t=>{let[,e]=t;e.destroy()})),w.clear(),i.runHooks("afterDestroy")}),!0),Ro.getSingleton().destroy(i),ke(i,((t,e,o)=>{ge(t)?o[e]=_(e):"guid"!==e&&(o[e]=null)})),i.isDestroyed=!0,l&&l.destroy(),l=null,h=null,v=null,c=null,i=null},this.getActiveEditor=function(){return c.getActiveEditor()},this.getPlugin=function(t){const e=lt(t);return"UndoRedo"===e?this.undoRedo:w.getItem(e)},this.getPluginName=function(t){return t===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:w.getId(t)},this.getInstance=function(){return i},this.addHook=function(t,e){Ro.getSingleton().add(t,e,i)},this.hasHook=function(t){return Ro.getSingleton().has(t,i)||Ro.getSingleton().has(t)},this.addHookOnce=function(t,e){Ro.getSingleton().once(t,e,i)},this.removeHook=function(t,e){Ro.getSingleton().remove(t,e,i)},this.runHooks=function(t,e,o,n,s,r,l){return Ro.getSingleton().run(i,t,e,o,n,s,r,l)},this.getTranslatedPhrase=function(t,e){return Qh(f.language,t,e)},this.toHTML=()=>Xo(this),this.toTableElement=()=>{const t=this.rootDocument.createElement("div");return t.insertAdjacentHTML("afterbegin",Xo(this)),t.firstElementChild},this.timeouts=[],this._registerTimeout=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=t;"function"===typeof o&&(o=setTimeout(o,e)),this.timeouts.push(o)},this._clearTimeouts=function(){O(this.timeouts,(t=>{clearTimeout(t)}))},this.immediates=[],this._registerImmediate=function(t){this.immediates.push(setImmediate(t))},this._clearImmediates=function(){O(this.immediates,(t=>{clearImmediate(t)}))},this._refreshBorders=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];c.destroyEditor(t),i.view.render(),e&&v.isSelected()&&c.prepareEditor()},this.isRtl=function(){return"rtl"===i.rootWindow.getComputedStyle(i.rootElement).direction},this.isLtr=function(){return!i.isRtl()},this.getDirectionFactor=function(){return i.isLtr()?1:-1};const D=Vd({handleEvent(t){const e=i.isListening(),o=void 0!==(null===t||void 0===t?void 0:t.key);return e&&o},beforeKeyDown:t=>this.runHooks("beforeKeyDown",t),afterKeyDown:t=>{this.isDestroyed||i.runHooks("afterDocumentKeyDown",t)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",(t=>{!1===t.ctrlKey&&!1===t.metaKey&&D.releasePressedKeys()})),this.getShortcutManager=function(){return D};const L=D.addContext("grid"),B={runOnlyIf:()=>z(i.getSelected())&&i.countRenderedRows()>0&&i.countRenderedCols()>0,group:Bd};D.setActiveContextName("grid"),L.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>{i.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:()=>{const t=i.getSelectedRange(),{row:e,col:o}=t[t.length-1].highlight,n=i.getDataAtCell(e,o),s=new Map;for(let r=0;r<t.length;r++)t[r].forAll(((t,r)=>{if(t>=0&&r>=0&&(t!==e||r!==o)){const{readOnly:e}=i.getCellMeta(t,r);e||s.set(`${t}x${r}`,[t,r,n])}}));i.setDataAtCell(Array.from(s.values()))},runOnlyIf:()=>i.getSelectedRangeLast().getCellsCount()>1},{keys:[["ArrowUp"]],callback:()=>{v.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>{v.setRangeStart(i._createCellCoords(i.rowIndexMapper.getNearestNotHiddenIndex(0,1),i.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:()=>{v.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:t,to:e}=i.getSelectedRangeLast(),o=i.rowIndexMapper.getNearestNotHiddenIndex(0,1);v.setRangeStart(t.clone()),v.setRangeEnd(i._createCellCoords(o,e.col))},runOnlyIf:()=>!(i.selection.isSelectedByCorner()||i.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>{v.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>{v.setRangeStart(i._createCellCoords(i.rowIndexMapper.getNearestNotHiddenIndex(i.countRows()-1,-1),i.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:()=>{v.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:t,to:e}=i.getSelectedRangeLast(),o=i.rowIndexMapper.getNearestNotHiddenIndex(i.countRows()-1,-1);v.setRangeStart(t.clone()),v.setRangeEnd(i._createCellCoords(o,e.col))},runOnlyIf:()=>!(i.selection.isSelectedByCorner()||i.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>{v.transformStart(0,-1*i.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>{const t=i.getSelectedRangeLast().highlight.row,e=i.columnIndexMapper.getNearestNotHiddenIndex(...i.isRtl()?[i.countCols()-1,-1]:[0,1]);v.setRangeStart(i._createCellCoords(t,e))}},{keys:[["ArrowLeft","Shift"]],callback:()=>{v.transformEnd(0,-1*i.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:t,to:e}=i.getSelectedRangeLast(),o=i.columnIndexMapper.getNearestNotHiddenIndex(...i.isRtl()?[i.countCols()-1,-1]:[0,1]);v.setRangeStart(t.clone()),v.setRangeEnd(i._createCellCoords(e.row,o))},runOnlyIf:()=>!(i.selection.isSelectedByCorner()||i.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>{v.transformStart(0,i.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>{const t=i.getSelectedRangeLast().highlight.row,e=i.columnIndexMapper.getNearestNotHiddenIndex(...i.isRtl()?[0,1]:[i.countCols()-1,-1]);v.setRangeStart(i._createCellCoords(t,e))}},{keys:[["ArrowRight","Shift"]],callback:()=>{v.transformEnd(0,i.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:t,to:e}=i.getSelectedRangeLast(),o=i.columnIndexMapper.getNearestNotHiddenIndex(...i.isRtl()?[0,1]:[i.countCols()-1,-1]);v.setRangeStart(t.clone()),v.setRangeEnd(i._createCellCoords(e.row,o))},runOnlyIf:()=>!(i.selection.isSelectedByCorner()||i.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>{const t=parseInt(i.getSettings().fixedColumnsStart,10),e=i.getSelectedRangeLast().highlight.row,o=i.columnIndexMapper.getNearestNotHiddenIndex(t,1);v.setRangeStart(i._createCellCoords(e,o))},runOnlyIf:()=>i.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>{v.setRangeEnd(i._createCellCoords(v.selectedRange.current().from.row,i.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>{const t=parseInt(i.getSettings().fixedRowsTop,10),e=parseInt(i.getSettings().fixedColumnsStart,10),o=i.rowIndexMapper.getNearestNotHiddenIndex(t,1),n=i.columnIndexMapper.getNearestNotHiddenIndex(e,1);v.setRangeStart(i._createCellCoords(o,n))},runOnlyIf:()=>i.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>{v.setRangeStart(i._createCellCoords(i.getSelectedRangeLast().highlight.row,i.columnIndexMapper.getNearestNotHiddenIndex(i.countCols()-1,-1)))},runOnlyIf:()=>i.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>{v.setRangeEnd(i._createCellCoords(v.selectedRange.current().from.row,i.columnIndexMapper.getNearestNotHiddenIndex(i.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>{const t=parseInt(i.getSettings().fixedRowsBottom,10),e=i.rowIndexMapper.getNearestNotHiddenIndex(i.countRows()-t-1,-1),o=i.columnIndexMapper.getNearestNotHiddenIndex(i.countCols()-1,-1);v.setRangeStart(i._createCellCoords(e,o))},runOnlyIf:()=>i.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>{v.transformStart(-i.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:()=>{const{to:t}=i.getSelectedRangeLast(),e=Math.max(t.row-i.countVisibleRows(),0),o=i.rowIndexMapper.getNearestNotHiddenIndex(e,1);if(null!==o){const e=i._createCellCoords(o,t.col),n=t.row-i.view.getFirstFullyVisibleRow(),s=Math.max(e.row-n,0);v.setRangeEnd(e),i.scrollViewportTo(s)}}},{keys:[["PageDown"]],callback:()=>{v.transformStart(i.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:()=>{const{to:t}=i.getSelectedRangeLast(),e=Math.min(t.row+i.countVisibleRows(),i.countRows()-1),o=i.rowIndexMapper.getNearestNotHiddenIndex(e,-1);if(null!==o){const e=i._createCellCoords(o,t.col),n=t.row-i.view.getFirstFullyVisibleRow(),s=Math.min(e.row-n,i.countRows()-1);v.setRangeEnd(e),i.scrollViewportTo(s)}}},{keys:[["Tab"]],callback:t=>{const e="function"===typeof f.tabMoves?f.tabMoves(t):f.tabMoves;v.transformStart(e.row,e.col,!0)}},{keys:[["Shift","Tab"]],callback:t=>{const e="function"===typeof f.tabMoves?f.tabMoves(t):f.tabMoves;v.transformStart(-e.row,-e.col)}}],B),vn().forEach((t=>{const e=bn(t);w.addItem(t,new e(this))})),Ro.getSingleton().run(i,"construct")}const jd="hooksRefRegisterer",Ud={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){O(this._hooksStorage[t]||[],(e=>{this.hot.removeHook(t,e)}))},clearHooks(){ke(this._hooksStorage,((t,e)=>this.removeHooksByKey(e))),this._hooksStorage={}}};Oe(Ud,"MIXIN_NAME",jd,{writable:!1,enumerable:!1});var zd=Ud;const $d="base",Gd=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Yd="baseEditor";class Kd{static get EDITOR_TYPE(){return $d}constructor(t){this.hot=t,this.instance=t,this.state=Gd.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}_fireCallbacks(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(t,e,o,n,s,i){this.TD=n,this.row=t,this.col=e,this.prop=o,this.originalValue=s,this.cellProperties=i,this.state=Gd.VIRGIN}extend(){return class extends this.constructor{}}saveValue(t,e){let o,n,s,i;if(e){const t=this.hot.getSelectedLast();o=Math.max(Math.min(t[0],t[2]),0),n=Math.max(Math.min(t[1],t[3]),0),s=Math.max(t[0],t[2]),i=Math.max(t[1],t[3])}else[o,n,s,i]=[this.row,this.col,null,null];const r=this.hot.runHooks("modifyGetCellCoords",o,n);Array.isArray(r)&&([o,n]=r);const l=this.hot.getShortcutManager(),a=l.getContext("editor"),h={runOnlyIf:()=>z(this.hot.getSelected()),group:Yd};this.isInFullEditMode()&&a.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],h),this.hot.populateFromArray(o,n,t,s,i,"edit")}beginEditing(t,e){if(this.state!==Gd.VIRGIN)return;const o=this.hot,n=o.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=o.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(o.view.scrollViewport(o._createCellCoords(n,s)),this.state=Gd.EDITING,this.isInFullEditMode()){const e="string"===typeof t?t:U(this.originalValue);this.setValue(e)}this.open(e),this._opened=!0,this.focus(),o.view.render(),o.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(t,e,o){let n;if(o){const t=this._closeCallback;this._closeCallback=e=>{t&&t(e),o(e),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager(),i=s.getContext("editor");if(i.removeShortcutsByGroup(Yd),i.removeShortcutsByGroup(Wo),this.state!==Gd.VIRGIN){if(this.state===Gd.EDITING){if(t)return this.cancelChanges(),void this.hot.view.render();const o=this.getValue();n=this.cellProperties.trimWhitespace?[["string"===typeof o?String.prototype.trim.call(o||""):o]]:[[o]],this.state=Gd.WAITING,this.saveValue(n,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(t=>{this.state=Gd.FINISHED,this.discardEditor(t)})):(this.state=Gd.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((()=>{this._fireCallbacks(!0)}))}cancelChanges(){this.state=Gd.FINISHED,this.discardEditor()}discardEditor(t){if(this.state===Gd.FINISHED)if(!1===t&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=Gd.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Gd.VIRGIN,this._fireCallbacks(!0);const t=this.hot.getShortcutManager();t.setActiveContextName("grid")}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Gd.WAITING}getEditedCellRect(){var t;const e=this.getEditedCell();if(!e)return;const{wtOverlays:o,wtViewport:n}=this.hot.view._wt,s=this.hot.rootWindow,i=Nt(e),r=Ut(e),l=Nt(this.hot.rootElement),a=Ut(this.hot.rootElement),h=o.topOverlay.holder,c=o.inlineStartOverlay.holder,d=h!==s?h.scrollTop:0,u=c!==s?c.scrollLeft:0,g=s.innerWidth-l.left-a,{wtTable:m}=null!==(t=o.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt,f=m.name,p=["master","inline_start"].includes(f)?d:0,w=["master","top","bottom"].includes(f)?u:0,C=i.top===l.top?0:1;let y=i.top-l.top-C-p,v=0;v=this.hot.isRtl()?s.innerWidth-i.left-r-g-1+w:i.left-l.left-1-w,["top","top_inline_start_corner"].includes(f)&&(y+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(f)&&(v+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));const b=this.hot.hasColHeaders(),S=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),R=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),E=this.hot.rowIndexMapper.getRenderableIndexesLength(),M=E-this.hot.view._wt.getSetting("fixedRowsBottom");(b&&S<=0||S===M)&&(y+=1),R<=0&&(v+=1);const T=n.rowsRenderCalculator.startPosition,x=n.columnsRenderCalculator.startPosition,I=Math.abs(o.inlineStartOverlay.getScrollPosition()),H=o.topOverlay.getScrollPosition(),A=oe(this.hot.rootDocument),O=e.offsetTop+T-H;let k=0;if(this.hot.isRtl()){const t=e.offsetLeft;k=t>=0?m.getWidth()-e.offsetLeft:Math.abs(t),k+=x-I-r}else k=e.offsetLeft+x-I;const N=jt(this.TD,this.hot.rootWindow),P=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",_=parseInt(N[P],10)>0?0:1,D=parseInt(N.borderTopWidth,10)>0?0:1,L=Ut(e)+_,V=zt(e)+D,B=ne(h)?A:0,F=se(c)?A:0,W=this.hot.view.maximumVisibleElementWidth(k)-B+_,j=Math.max(this.hot.view.maximumVisibleElementHeight(O)-F+D,23);return{top:y,start:v,height:V,maxHeight:j,width:L,maxWidth:W}}getEditedCellsLayerClass(){const t=this.checkEditorSection();switch(t){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const t=this.hot.countRows();let e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}function Xd(){var t,e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},o=document.body,n=document.createTextNode(""),s=document.createElement("SPAN"),i=function(t,e,o){t.addEventListener(e,o,!1)},r=function(t,e,o){t.removeEventListener(e,o,!1)},l=function(i){var r,l;i?/^[a-zA-Z \.,\\\/\|0-9]$/.test(i)||(i="."):i="",void 0!==n.textContent?n.textContent=t.value+i:n.data=t.value+i,s.style.position="absolute",s.style.fontSize=d(t).fontSize,s.style.fontFamily=d(t).fontFamily,s.style.whiteSpace="pre",o.appendChild(s),r=s.clientWidth+2,o.removeChild(s),t.style.height=e.minHeight+"px",e.minWidth>r?t.style.width=e.minWidth+"px":r>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=r+"px",l=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>l?t.style.height=e.minHeight+"px":e.maxHeight<l?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=l+"px"},a=function(){window.setTimeout(l,0)},h=function(o){if(o&&o.minHeight)if("inherit"==o.minHeight)e.minHeight=t.clientHeight;else{var i=parseInt(o.minHeight);isNaN(i)||(e.minHeight=i)}if(o&&o.maxHeight)if("inherit"==o.maxHeight)e.maxHeight=t.clientHeight;else{var r=parseInt(o.maxHeight);isNaN(r)||(e.maxHeight=r)}if(o&&o.minWidth)if("inherit"==o.minWidth)e.minWidth=t.clientWidth;else{var l=parseInt(o.minWidth);isNaN(l)||(e.minWidth=l)}if(o&&o.maxWidth)if("inherit"==o.maxWidth)e.maxWidth=t.clientWidth;else{var a=parseInt(o.maxWidth);isNaN(a)||(e.maxWidth=a)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(n))},c=function(o,n,s){t=o,h(n),"TEXTAREA"==t.nodeName&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),s&&(i(t,"change",l),i(t,"cut",a),i(t,"paste",a),i(t,"drop",a),i(t,"keydown",a),i(t,"focus",l),i(t,"compositionstart",a),i(t,"compositionupdate",a),i(t,"compositionend",a)),l()};function d(t){return t.currentStyle||document.defaultView.getComputedStyle(t)}return{init:function(t,e,o){c(t,e,o)},unObserve:function(){r(t,"change",l),r(t,"cut",a),r(t,"paste",a),r(t,"drop",a),r(t,"keydown",a),r(t,"focus",l),r(t,"compositionstart",a),r(t,"compositionupdate",a),r(t,"compositionend",a)},resize:l}}function qd(t,e){const o=Xt(e),n=e.value.split("\n");let s=o,i=0;for(let r=0;r<n.length;r++){const e=n[r];0!==r&&(i+=n[r-1].length+1);const l=i+e.length;if("home"===t?s=i:"end"===t&&(s=l),o<=l)break}Zt(e,s)}Ie(Kd,zd);const Qd="ht_editor_visible",Jd="ht_editor_hidden",Zd="textEditor",tu="text";class eu extends Kd{static get EDITOR_TYPE(){return tu}constructor(t){super(t),this.eventManager=new Bo(this),this.autoResize=Xd(),this.TEXTAREA=void 0,this.textareaStyle=void 0,this.TEXTAREA_PARENT=void 0,this.textareaParentStyle=void 0,this.layerClass=void 0,this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",(()=>this.destroy()))}getValue(){return this.TEXTAREA.value}setValue(t){this.TEXTAREA.value=t}open(){this.refreshDimensions(),this.showEditableElement();const t=this.hot.getShortcutManager();t.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",(t=>this.onAfterDocumentKeyDown(t))),this.registerShortcuts()}close(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(t,e,o,n,s,i){const r=this.state;if(super.prepare(t,e,o,n,s,i),!i.readOnly){this.refreshDimensions(!0);const{allowInvalid:t,fragmentSelection:e}=i;t&&(this.TEXTAREA.value=""),r!==Gd.FINISHED&&this.hideEditableElement();const o=!e;o&&!qe()&&this.focus()}}beginEditing(t,e){this.state===Gd.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(t,e))}focus(){this.TEXTAREA.select(),Zt(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:t}=this.hot;this.TEXTAREA=t.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Mt(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),Mt(this.TEXTAREA_PARENT,"handsontableInputHolder"),Et(this.TEXTAREA_PARENT,this.layerClass)&&Tt(this.TEXTAREA_PARENT,this.layerClass),Mt(this.TEXTAREA_PARENT,Jd),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Ke()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Tt(this.TEXTAREA_PARENT,this.layerClass),Mt(this.TEXTAREA_PARENT,Jd)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const t=this.TEXTAREA_PARENT.childNodes;let e=!1;tn(t.length-1,(o=>{const n=t[o];if(Et(n,"handsontableEditor"))return e=!0,!1})),Et(this.TEXTAREA_PARENT,Jd)&&Tt(this.TEXTAREA_PARENT,Jd),e?(this.layerClass=Qd,Mt(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Mt(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==Gd.EDITING&&!t)return;if(this.TD=this.getEditedCell(),!this.TD)return void(t||this.close());const{top:e,start:o,width:n,maxWidth:s,height:i,maxHeight:r}=this.getEditedCellRect();this.textareaParentStyle.top=`${e}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${o}px`,this.showEditableElement();const l=jt(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const a=jt(this.TEXTAREA),h=parseInt(a.paddingLeft,10)+parseInt(a.paddingRight,10),c=parseInt(a.paddingTop,10)+parseInt(a.paddingBottom,10),d=n-h,u=i-c,g=s-h,m=r-c;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,g),minHeight:Math.min(u,m),maxWidth:g,maxHeight:m},!0)}bindEvents(){this.eventManager.addEventListener(this.TEXTAREA,"cut",(t=>t.stopPropagation())),this.eventManager.addEventListener(this.TEXTAREA,"paste",(t=>t.stopPropagation())),Qe()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(()=>this.finishEditing(!1))),this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>{this.refreshDimensions(),this.focus()})),this.addHook("afterRowResize",(()=>{this.refreshDimensions(),this.focus()}))}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor"),o={runOnlyIf:()=>z(this.hot.getSelected()),group:Zd},n=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Tab"]],callback:t=>{const e=this.hot.getSettings(),o="function"===typeof e.tabMoves?e.tabMoves(t):e.tabMoves;this.hot.selection.transformStart(o.row,o.col,!0)}},{keys:[["Shift","Tab"]],callback:t=>{const e=this.hot.getSettings(),o="function"===typeof e.tabMoves?e.tabMoves(t):e.tabMoves;this.hot.selection.transformStart(-o.row,-o.col)}},{keys:[["Control","Enter"]],callback:()=>(n(),!1),runOnlyIf:t=>!this.hot.selection.isMultiple()&&!t.altKey,relativeToGroup:jo,position:"before"},{keys:[["Meta","Enter"]],callback:()=>(n(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple(),relativeToGroup:jo,position:"before"},{keys:[["Alt","Enter"]],callback:()=>(n(),!1),relativeToGroup:jo,position:"before"},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(t,e)=>{let[o]=e;qd(o,this.TEXTAREA)}},{keys:[["End"]],callback:(t,e)=>{let[o]=e;qd(o,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout((()=>{this.autoResize.resize()}),10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout((()=>{this.autoResize.resize()}),10)}}],o)}unregisterShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(Wo),e.removeShortcutsByGroup(Zd),e.removeShortcutsByGroup(Yd)}onAfterDocumentKeyDown(t){const e=[oo.ARROW_UP,oo.ARROW_RIGHT,oo.ARROW_DOWN,oo.ARROW_LEFT];-1===e.indexOf(t.keyCode)&&this.autoResize.resize(String.fromCharCode(t.keyCode))}}const ou="base";function nu(t,e,o,n,s,i,r){const l=[],a=[];r.className&&Mt(e,r.className),r.readOnly&&l.push(r.readOnlyCellClassName),!1===r.valid&&r.invalidCellClassName?l.push(r.invalidCellClassName):a.push(r.invalidCellClassName),!1===r.wordWrap&&r.noWordWrapClassName&&l.push(r.noWordWrapClassName),!i&&r.placeholder&&l.push(r.placeholderCellClassName),Tt(e,a),Mt(e,l)}nu.RENDERER_TYPE=ou;const su="text";function iu(t,e,o,n,s,i,r){nu.apply(this,[t,e,o,n,s,i,r]);let l=i;if(!l&&r.placeholder&&(l=r.placeholder),l=U(l),r.trimWhitespace&&(l=l.trim()),r.rendererTemplate){It(e);const n=t.rootDocument.createElement("TEMPLATE");n.setAttribute("bind","{{}}"),n.innerHTML=r.rendererTemplate,HTMLTemplateElement.decorate(n),n.model=t.getSourceDataAtRow(o),e.appendChild(n)}else Ot(e,l)}iu.RENDERER_TYPE=su;const ru="text",lu={CELL_TYPE:ru,editor:eu,renderer:iu};function au(t,e){const o=new Wd(t,e||{},Or);return o.init(),o}nd(lu),au.editors={BaseEditor:Kd},au.Core=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Wd(t,e,Or)},au.DefaultSettings=cd(),au.hooks=Ro.getSingleton(),au.CellCoords=ti,au.CellRange=gi,au.packageName="handsontable",au.buildDate="14/07/2023 07:21:02",au.version="13.0.0",au.languages={dictionaryKeys:Fh,getLanguageDictionary:Kh,getLanguagesDictionaries:qh,registerLanguageDictionary:Gh,getTranslatedPhrase:Qh};var hu=au,cu=o(1711);function du(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function uu(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?du(Object(o),!0).forEach((function(e){wu(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):du(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function gu(t){return gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gu(t)}function mu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fu(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tu(n.key),n)}}function pu(t,e,o){return e&&fu(t.prototype,e),o&&fu(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function wu(t,e,o){return e=Tu(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Cu(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vu(t,e)}function yu(t){return yu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yu(t)}function vu(t,e){return vu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},vu(t,e)}function bu(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Su(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ru(t,e){if(e&&("object"===typeof e||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Su(t)}function Eu(t){var e=bu();return function(){var o,n=yu(t);if(e){var s=yu(this).constructor;o=Reflect.construct(n,arguments,s)}else o=n.apply(this,arguments);return Ru(this,o)}}function Mu(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Tu(t){var e=Mu(t,"string");return"symbol"===typeof e?e:String(e)}var xu=Symbol("unassigned"),Iu=null,Hu="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function Au(t){t.hotInstance&&(t.hotInstance.addHook("beforeChange",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateCol",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveCol",(function(){t.__internalEdit=!0})))}function Ou(t){var e=hu.hooks.getRegistered(),o={};for(var n in Object.assign(o,hu.DefaultSettings),o)o[n]={default:xu};for(var s=0;s<e.length;s++)o[e[s]]={default:xu};return o.settings={default:xu},"HotTable"===t&&(o.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},o.wrapperRendererCacheSize={type:Number,default:3e3}),o}function ku(t){var e={},o=t["settings"];if(o!==xu)for(var n in o)o.hasOwnProperty(n)&&o[n]!==xu&&(e[n]=o[n]);for(var s in t)t.hasOwnProperty(s)&&"settings"!==s&&t[s]!==xu&&(e[s]=t[s]);return e}function Nu(t,e){var o=ku(t),n=t.settings?t.settings:o,s=t.settings?o:null,i={};for(var r in n)!n.hasOwnProperty(r)||void 0===n[r]||e&&"data"!==r&&Lu(e[r],n[r])||(i[r]=n[r]);for(var l in s)!s.hasOwnProperty(l)||"id"===l||"settings"===l||"wrapperRendererCacheSize"===l||void 0===s[l]||e&&"data"!==l&&Lu(e[l],s[l])||(i[l]=s[l]);return i}function Pu(t,e){var o=null;return t.every((function(t,n){return!t.data||!t.data.attrs||void 0===t.data.attrs[e]||(o=t,!1)})),o}function _u(t){return t.filter((function(t){return"HotColumn"===t.$options.name}))}function Du(t,e,o,n){var s=e.$el?e.$el.ownerDocument:document,i={propsData:o,parent:e,data:n};Iu||(Iu=s.createElement("DIV"),Iu.id="vueHotComponents",s.body.appendChild(Iu));var r=s.createElement("DIV");return Iu.appendChild(r),new t.componentOptions.Ctor(i).$mount(r)}function Lu(t,e){return JSON.stringify(t)===JSON.stringify(e)}var Vu="13.0.0";"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self&&self;function Bu(t,e){return e={exports:{}},t(e,e.exports),e.exports}var Fu=Bu((function(t,e){(function(t,o){var n=e;o(n)})(0,(function(t){var e=Symbol("newer"),o=Symbol("older");function n(t,e){"number"!==typeof t&&(e=t,t=0),this.size=0,this.limit=t,this.oldest=this.newest=void 0,this._keymap=new Map,e&&(this.assign(e),t<1&&(this.limit=this.size))}function s(t,n){this.key=t,this.value=n,this[e]=void 0,this[o]=void 0}t.LRUMap=n,n.prototype._markEntryAsUsed=function(t){t!==this.newest&&(t[e]&&(t===this.oldest&&(this.oldest=t[e]),t[e][o]=t[o]),t[o]&&(t[o][e]=t[e]),t[e]=void 0,t[o]=this.newest,this.newest&&(this.newest[e]=t),this.newest=t)},n.prototype.assign=function(t){var n,i=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var r=t[Symbol.iterator](),l=r.next();!l.done;l=r.next()){var a=new s(l.value[0],l.value[1]);if(this._keymap.set(a.key,a),n?(n[e]=a,a[o]=n):this.oldest=a,n=a,0==i--)throw new Error("overflow")}this.newest=n,this.size=this._keymap.size},n.prototype.get=function(t){var e=this._keymap.get(t);if(e)return this._markEntryAsUsed(e),e.value},n.prototype.set=function(t,n){var i=this._keymap.get(t);return i?(i.value=n,this._markEntryAsUsed(i),this):(this._keymap.set(t,i=new s(t,n)),this.newest?(this.newest[e]=i,i[o]=this.newest):this.oldest=i,this.newest=i,++this.size,this.size>this.limit&&this.shift(),this)},n.prototype.shift=function(){var t=this.oldest;if(t)return this.oldest[e]?(this.oldest=this.oldest[e],this.oldest[o]=void 0):(this.oldest=void 0,this.newest=void 0),t[e]=t[o]=void 0,this._keymap["delete"](t.key),--this.size,[t.key,t.value]},n.prototype.has=function(t){return this._keymap.has(t)}}))})),Wu=Fu.LRUMap,ju={name:"HotTable",props:Ou("HotTable"),watch:{mergedHotSettings:function(t){this.hotInstance&&void 0!==t&&(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var t=this,e=new Wu(this.wrapperRendererCacheSize);return e.shift=function(){var t=Wu.prototype.shift.call(this);return t[1].component.$destroy(),t},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:e,editorCache:new Map,get hotInstance(){return!t.__hotInstance||t.__hotInstance&&!t.__hotInstance.isDestroyed?t.__hotInstance:(console.warn(Hu),null)},set hotInstance(e){t.__hotInstance=e}}},computed:{mergedHotSettings:function(){return Nu(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var t=this.getGlobalRendererVNode(),e=this.getGlobalEditorVNode(),o=Nu(this.$props);o.columns=this.columnSettings?this.columnSettings:o.columns,e&&(o.editor=this.getEditorClass(e,this),e.child.$destroy()),t&&(o.renderer=this.getRendererWrapper(t,this),t.child.$destroy()),this.hotInstance=new hu.Core(this.$el,o),this.hotInstance.init(),Au(this),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var e,o=this.hotInstance.getSourceData(),n=[],s=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),r=this.hotInstance.isColumnModificationAllowed(),l=0;if(o&&o.length!==i&&o.length<i)for(var a=o.length;a<i;a++)n.push(a);if(r)if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),o&&o[0]&&(null===(e=o[0])||void 0===e?void 0:e.length)!==l&&o[0].length<l)for(var h=o[0].length;h<l;h++)s.push(h);this.hotInstance.batch((function(){n.length>0?t.hotInstance.rowIndexMapper.removeIndexes(n):t.hotInstance.rowIndexMapper.insertIndexes(i-1,o.length-i),r&&0!==o.length&&(s.length>0?t.hotInstance.columnIndexMapper.removeIndexes(s):t.hotInstance.columnIndexMapper.insertIndexes(l-1,o[0].length-l))}))}},getGlobalRendererVNode:function(){var t=this.$slots["default"]||[];return Pu(t,"hot-renderer")},getGlobalEditorVNode:function(){var t=this.$slots["default"]||[];return Pu(t,"hot-editor")},getColumnSettings:function(){var t=_u(this.$children),e=!1,o=t.map((function(t){return t.usesRendererComponent&&(e=!0),uu({},t.columnSettings)}));return e&&this.settings&&(!1!==this.settings.autoColumnSize||this.settings.autoRowSize)&&(!1!==this.autoColumnSize||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),o.length?o:void 0},getRendererWrapper:function(t,e){var o=this;return function(n,s,i,r,l,a,h){if(s&&!s.getAttribute("ghost-table")){var c=o.rendererCache,d={hotInstance:n,TD:s,row:i,col:r,prop:l,value:a,cellProperties:h,isRenderer:!0};if(c&&!c.has("".concat(i,"-").concat(r))){var u=Du(t,e,t.componentOptions.propsData,d);c.set("".concat(i,"-").concat(r),{component:u,lastUsedTD:null})}var g=c.get("".concat(i,"-").concat(r)),m=g.component,f=g.lastUsedTD;if(Object.assign(m.$data,d),!m.$el.parentElement||f!==s){while(s.firstChild)s.removeChild(s.firstChild);s.appendChild(m.$el),g.lastUsedTD=s}}return s}},getEditorClass:function(t,e){var o=t.key?t.key.toString():null,n=t.componentOptions.Ctor.options.name,s=o?"".concat(n,":").concat(o):n,i=this.editorCache,r=null;return i.has(s)?r=i.get(s):(r=Du(t,e,t.componentOptions.propsData,{isEditor:!0}),i.set(s,r)),r.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:Vu};function Uu(t,e,o,n,s,i,r,l,a,h){"boolean"!==typeof r&&(a=l,l=r,r=!1);const c="function"===typeof o?o.options:o;let d;if(t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,s&&(c.functional=!0)),n&&(c._scopeId=n),i?(d=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,a(t)),t&&t._registeredComponents&&t._registeredComponents.add(i)},c._ssrRegister=d):e&&(d=r?function(t){e.call(this,h(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,l(t))}),d)if(c.functional){const t=c.render;c.render=function(e,o){return d.call(o),t(e,o)}}else{const t=c.beforeCreate;c.beforeCreate=t?[].concat(t,d):[d]}return o}var zu=ju,$u=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:t.id}},[t._t("default")],2)},Gu=[],Yu=void 0,Ku=void 0,Xu=void 0,qu=!1,Qu=Uu({render:$u,staticRenderFns:Gu},Yu,zu,Ku,qu,Xu,!1,void 0,void 0,void 0);Ou("HotColumn");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function Ju(t,e,o,n){var s,i=arguments.length,r=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var l=t.length-1;l>=0;l--)(s=t[l])&&(r=(i<3?s(r):i>3?s(e,o,r):s(e,o))||r);return i>3&&r&&Object.defineProperty(e,o,r),r}function Zu(t){return Zu="function"===typeof Symbol&&"symbol"===gu(Symbol.iterator)?function(t){return gu(t)}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":gu(t)},Zu(t)}function tg(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function eg(t){return og(t)||ng(t)||sg()}function og(t){if(Array.isArray(t)){for(var e=0,o=new Array(t.length);e<t.length;e++)o[e]=t[e];return o}}function ng(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function sg(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function ig(){return"undefined"!==typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function rg(t,e){lg(t,e),Object.getOwnPropertyNames(e.prototype).forEach((function(o){lg(t.prototype,e.prototype,o)})),Object.getOwnPropertyNames(e).forEach((function(o){lg(t,e,o)}))}function lg(t,e,o){var n=o?Reflect.getOwnMetadataKeys(e,o):Reflect.getOwnMetadataKeys(e);n.forEach((function(n){var s=o?Reflect.getOwnMetadata(n,e,o):Reflect.getOwnMetadata(n,e);o?Reflect.defineMetadata(n,s,t,o):Reflect.defineMetadata(n,s,t)}))}var ag={__proto__:[]},hg=ag instanceof Array;function cg(t){var e=Zu(t);return null==t||"object"!==e&&"function"!==e}function dg(t,e){var o=e.prototype._init;e.prototype._init=function(){var e=this,o=Object.getOwnPropertyNames(t);if(t.$options.props)for(var n in t.$options.props)t.hasOwnProperty(n)||o.push(n);o.forEach((function(o){Object.defineProperty(e,o,{get:function(){return t[o]},set:function(e){t[o]=e},configurable:!0})}))};var n=new e;e.prototype._init=o;var s={};return Object.keys(n).forEach((function(t){void 0!==n[t]&&(s[t]=n[t])})),s}var ug=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function gg(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.name=e.name||t._componentTag||t.name;var o=t.prototype;Object.getOwnPropertyNames(o).forEach((function(t){if("constructor"!==t)if(ug.indexOf(t)>-1)e[t]=o[t];else{var n=Object.getOwnPropertyDescriptor(o,t);void 0!==n.value?"function"===typeof n.value?(e.methods||(e.methods={}))[t]=n.value:(e.mixins||(e.mixins=[])).push({data:function(){return tg({},t,n.value)}}):(n.get||n.set)&&((e.computed||(e.computed={}))[t]={get:n.get,set:n.set})}})),(e.mixins||(e.mixins=[])).push({data:function(){return dg(this,t)}});var n=t.__decorators__;n&&(n.forEach((function(t){return t(e)})),delete t.__decorators__);var s=Object.getPrototypeOf(t.prototype),i=s instanceof cu.Z?s.constructor:cu.Z,r=i.extend(e);return fg(r,t,i),ig()&&rg(r,t),r}var mg={prototype:!0,arguments:!0,callee:!0,caller:!0};function fg(t,e,o){Object.getOwnPropertyNames(e).forEach((function(n){if(!mg[n]){var s=Object.getOwnPropertyDescriptor(t,n);if(!s||s.configurable){var i=Object.getOwnPropertyDescriptor(e,n);if(!hg){if("cid"===n)return;var r=Object.getOwnPropertyDescriptor(o,n);if(!cg(i.value)&&r&&r.value===i.value)return}Object.defineProperty(t,n,i)}}}))}function pg(t){return"function"===typeof t?gg(t):function(e){return gg(e,t)}}pg.registerHooks=function(t){ug.push.apply(ug,eg(t))};var wg=function(t){Cu(o,t);var e=Eu(o);function o(){var t;return mu(this,o),t=e.apply(this,arguments),t.name="BaseEditorComponent",t.instance=null,t.row=null,t.col=null,t.prop=null,t.TD=null,t.originalValue=null,t.cellProperties=null,t.state=null,t.hot=null,t}return pu(o,[{key:"mounted",value:function(){var t=this;this.$data.hotCustomEditorClass=function(){var e=function(e){Cu(n,e);var o=Eu(n);function n(e){var s;return mu(this,n),s=o.call(this,e),t.$data.hotCustomEditorInstance=Su(s),s}return pu(n,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),n}(hu.editors.BaseEditor);return Object.getOwnPropertyNames(hu.editors.BaseEditor.prototype).forEach((function(o){"constructor"!==o&&(e.prototype[o]=function(){for(var e,n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=t[o]).call.apply(e,[this].concat(s))})})),e}()}},{key:"_fireCallbacks",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];(t=hu.editors.BaseEditor.prototype._fireCallbacks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"beginEditing",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.beginEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"cancelChanges",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.cancelChanges).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"checkEditorSection",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.checkEditorSection).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"close",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.close).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"discardEditor",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.discardEditor).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"enableFullEditMode",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.enableFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"extend",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.extend).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"finishEditing",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.finishEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"focus",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.focus).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getValue",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.getValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"init",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.init).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"isInFullEditMode",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.isInFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"isOpened",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.isOpened).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"isWaiting",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.isWaiting).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"open",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.open).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"prepare",value:function(t,e,o,n,s,i){return this.$data.hotInstance=i.instance,this.$data.row=t,this.$data.col=e,this.$data.prop=o,this.$data.TD=n,this.$data.originalValue=s,this.$data.cellProperties=i,hu.editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,t,e,o,n,s,i)}},{key:"saveValue",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.saveValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"setValue",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.setValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"addHook",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.addHook).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"removeHooksByKey",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.removeHooksByKey).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"clearHooks",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.clearHooks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCell",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.getEditedCell).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCellRect",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.getEditedCellRect).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCellsZIndex",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}},{key:"getEditedCellsLayerClass",value:function(){for(var t,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return(t=hu.editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(t,[this.$data.hotCustomEditorInstance].concat(o))}}]),o}(cu.Z);wg=Ju([pg({})],wg);var Cg=[[!1,"Tagcat","United Kingdom","Classic Vest","11/10/2020","01-2331942",!0,"172",2,2],[!0,"Zoomzone","Indonesia","Cycling Cap","03/05/2020","88-2768633",!0,"188",6,2],[!0,"Meeveo","United States","Full-Finger Gloves","27/03/2020","51-6775945",!0,"162",1,3],[!1,"Buzzdog","Philippines","HL Mountain Frame","29/08/2020","44-4028109",!0,"133",7,1],[!0,"Katz","India","Half-Finger Gloves","02/10/2020","08-2758492",!0,"87",1,3],[!1,"Jaxbean","China","HL Road Frame","28/09/2020","84-3557705",!1,"26",8,1],[!1,"Wikido","Brazil","HL Touring Frame","24/06/2020","20-9397637",!1,"110",4,1],[!1,"Browsedrive","United States","LL Mountain Frame","13/03/2020","36-0079556",!0,"50",4,4],[!1,"Twinder","United Kingdom","LL Road Frame","06/04/2020","41-1489542",!1,"160",6,1],[!1,"Jetwire","China","LL Touring Frame","01/02/2020","37-1531629",!0,"30",8,5],[!1,"Chatterpoint","China","Long-Sleeve Logo Jersey","14/07/2020","25-5083429",!0,"39",7,2],[!1,"Twinder","Egypt","Men's Bib-Shorts","31/08/2020","04-4281278",!1,"96",6,1],[!1,"Midel","United States","Men's Sports Shorts","27/06/2020","55-1711908",!0,"108",10,3],[!1,"Yodo","India","ML Mountain Frame","16/03/2020","58-8360815",!1,"46",1,1],[!1,"Camido","Russia","ML Mountain Frame-W","13/09/2020","10-3786104",!0,"97",8,3],[!1,"Eire","Thailand","ML Road Frame","10/04/2020","45-1186054",!0,"161",1,4],[!1,"Vinte","United Kingdom","ML Road Frame-W","22/01/2020","62-6202742",!0,"58",4,3],[!1,"Twitterlist","China","Mountain Bike Socks","09/11/2020","88-9646223",!0,"92",8,3],[!1,"Eidel","Bangladesh","Mountain-100","19/09/2020","45-5588112",!0,"5",6,5],[!1,"Trunyx","Nigeria","Mountain-200","09/03/2020","66-6271819",!0,"158",4,1],[!1,"Katz","Turkey","Mountain-300","05/03/2020","38-9245023",!1,"121",5,4],[!1,"Kaymbo","United States","Mountain-400-W","24/12/2020","44-5916927",!1,"61",5,4],[!1,"Ozu","Pakistan","Mountain-500","13/06/2020","31-5449914",!0,"155",2,2],[!1,"Rhynyx","India","Racing Socks","05/12/2020","19-9413869",!0,"162",2,4],[!1,"Flashset","Iran","Road-150","14/12/2020","25-9807605",!1,"46",7,1],[!1,"Yata","Congo (Kinshasa)","Road-250","12/06/2020","74-4291983",!0,"47",4,4],[!1,"Brainlounge","Vietnam","Road-350-W","10/03/2020","83-0980643",!0,"104",2,3],[!1,"Babblestorm","United States","Road-450","10/10/2020","19-2878430",!0,"101",6,4],[!1,"Youspan","Brazil","Road-550-W","16/12/2020","19-1838230",!0,"150",10,3],[!1,"Nlounge","China","Road-650","31/10/2020","32-2267938",!0,"42",4,2],[!1,"Twinte","India","Road-750","17/08/2020","79-2821972",!0,"144",9,3],[!1,"Oyonder","United Kingdom","Short-Sleeve Classic Jersey","04/12/2020","46-6597557",!0,"195",4,1],[!1,"Gigabox","Pakistan","Sport-100","03/02/2020","15-1793960",!0,"199",4,4],[!1,"Livetube","France","Touring-1000","16/05/2020","86-0811003",!0,"110",4,5],[!1,"Voomm","United Kingdom","Touring-2000","15/07/2020","95-3068680",!0,"51",4,4],[!1,"Voonyx","China","Touring-3000","27/11/2020","35-3085360",!1,"69",2,5],[!1,"Zoombeat","United States","Women's Mountain Shorts","03/11/2020","56-8673088",!1,"53",2,3],[!1,"Roomm","China","Women's Tights","16/03/2020","76-0085918",!0,"168",1,1],[!1,"Leenti","China","Mountain-400","16/05/2020","03-0893276",!1,"58",1,4],[!1,"Jetpulse","United States","Road-550","08/02/2020","79-9013306",!0,"152",9,3],[!1,"Katz","Peru","Road-350","15/02/2020","55-7799920",!0,"66",4,2],[!1,"Cogidoo","India","LL Mountain Front Wheel","04/06/2020","07-0881122",!1,"112",9,2],[!1,"Divavu","Colombia","Touring Rear Wheel","24/02/2020","58-6157387",!0,"50",10,4],[!1,"Mydeo","China","Touring Front Wheel","07/12/2020","12-2810010",!1,"31",3,5],[!1,"Browsebug","Japan","ML Mountain Front Wheel","14/01/2020","64-9249984",!0,"132",5,5],[!1,"Layo","China","HL Mountain Front Wheel","24/04/2020","45-0739652",!0,"45",1,5],[!1,"Snaptags","United Kingdom","LL Touring Handlebars","06/08/2020","09-5712761",!0,"197",4,2],[!1,"Cogilith","China","HL Touring Handlebars","31/05/2020","01-7345008",!0,"190",4,3],[!1,"Reallinks","United Kingdom","LL Road Front Wheel","14/05/2020","62-1065350",!0,"184",3,4],[!1,"Quaxo","United States","ML Road Front Wheel","23/03/2020","44-7241323",!0,"169",3,4],[!1,"Devify","China","HL Road Front Wheel","12/12/2020","52-0295699",!1,"152",4,4],[!1,"Youopia","Angola","LL Mountain Handlebars","01/04/2020","52-2650922",!1,"182",6,4],[!1,"Ainyx","China","Touring Pedal","27/02/2020","48-3618525",!0,"141",6,1],[!1,"Browsetype","Malaysia","ML Mountain Handlebars","28/04/2020","51-8893923",!0,"169",7,1],[!1,"Muxo","China","HL Mountain Handlebars","22/08/2020","68-5911361",!1,"39",7,1],[!1,"Bubbletube","China","LL Road Handlebars","04/10/2020","41-5880042",!0,"71",8,3],[!1,"Fadeo","Vietnam","ML Road Handlebars","23/04/2020","90-5913983",!0,"148",10,3],[!1,"Yadel","United Kingdom","HL Road Handlebars","18/04/2020","92-0960699",!0,"116",8,1],[!1,"Blognation","China","LL Headset","10/01/2020","06-9493898",!0,"96",10,1],[!1,"Devpoint","China","ML Headset","25/12/2020","69-5878565",!0,"35",4,2],[!1,"Aibox","United Kingdom","HL Headset","18/03/2020","13-1133017",!0,"16",8,2],[!1,"Brightdog","China","LL Mountain Pedal","11/09/2020","39-6530433",!0,"194",2,5],[!1,"Gabcube","Nigeria","ML Mountain Pedal","22/04/2020","96-6860388",!0,"24",1,3],[!1,"Muxo","China","HL Mountain Pedal","05/06/2020","30-0356137",!0,"170",4,4],[!1,"Tambee","China","ML Touring Seat/Saddle","22/02/2020","93-9058255",!0,"184",9,5],[!1,"Cogilith","India","LL Touring Seat/Saddle","06/04/2020","82-9268909",!1,"153",10,4],[!1,"Dynabox","Hong Kong","HL Touring Seat/Saddle","10/01/2020","20-6913815",!1,"88",10,1],[!1,"Shuffledrive","Sudan","LL Road Pedal","16/09/2020","08-8238817",!0,"57",9,2],[!1,"Fivechat","China","ML Road Pedal","26/08/2020","44-7370350",!1,"62",4,1],[!1,"Meembee","United States","HL Road Pedal","27/12/2020","01-3525949",!0,"123",2,4],[!1,"Dynazzy","United Kingdom","LL Mountain Seat/Saddle 1","15/12/2020","04-2414623",!0,"77",10,5],[!1,"Eare","China","ML Mountain Seat/Saddle 1","04/04/2020","15-1917509",!1,"199",9,4],[!1,"Yozio","China","HL Mountain Seat/Saddle 1","15/03/2020","06-2526845",!0,"149",8,2],[!1,"Quinu","Xi'an","425-777-7829","22/02/2020","83-1713558",!1,"191",9,5],[!1,"Jazzy","United Kingdom","ML Road Seat/Saddle 1","07/08/2020","00-8892524",!0,"150",10,2],[!1,"Thoughtsphere","China","HL Road Seat/Saddle 1","28/11/2020","39-5538991",!0,"130",7,3],[!1,"Leenti","China","ML Road Rear Wheel","29/12/2020","06-9002973",!0,"179",1,2],[!1,"Quaxo","United Kingdom","HL Road Rear Wheel","06/09/2020","73-6104901",!0,"98",5,3],[!1,"Tanoodle","Chile","LL Mountain Seat/Saddle 2","24/05/2020","68-7384479",!0,"175",2,3],[!1,"Feednation","China","ML Mountain Seat/Saddle 2","21/11/2020","26-7757763",!0,"11",1,3],[!1,"Kayveo","China","HL Mountain Seat/Saddle 2","21/06/2020","07-4873562",!1,"184",7,4],[!1,"Meevee","Saudi Arabia","LL Road Seat/Saddle 1","16/11/2020","46-5819554",!1,"27",9,3],[!1,"Twitterworks","China","ML Road Seat/Saddle 2","19/04/2020","01-2666826",!0,"186",3,2],[!1,"Wikizz","Tanzania","HL Road Seat/Saddle 2","08/03/2020","54-7090503",!0,"20",3,3],[!1,"Yoveo","United States","LL Mountain Tire","14/10/2020","78-7658520",!1,"153",2,1],[!1,"Yakidoo","China","ML Mountain Tire","12/10/2020","23-9926318",!0,"161",8,5],[!1,"Oyope","China","HL Mountain Tire","20/09/2020","20-0179517",!0,"98",10,5],[!1,"Skipstorm","United States","LL Road Tire","01/10/2020","02-9543343",!0,"30",7,3],[!1,"Minyx","United States","ML Road Tire","07/07/2020","98-3938169",!0,"73",10,2],[!1,"Miboo","China","HL Road Tire","25/07/2020","68-5197934",!0,"158",9,1],[!1,"Realfire","United States","Touring Tire","27/08/2020","39-8260460",!0,"122",5,2],[!1,"Shufflester","China","Mountain Tire Tube","08/06/2020","45-9776170",!0,"33",2,4],[!1,"Ntag","China","Road Tire Tube","06/12/2020","45-0858451",!0,"107",6,2],[!1,"Jabberbean","United States","Touring Tire Tube","26/04/2020","15-4247305",!0,"15",1,2],[!1,"Thoughtblab","China","LL Bottom Bracket","21/05/2020","15-8534931",!0,"168",5,2],[!1,"Jabbertype","China","Classic Vest","25/07/2020","23-1251557",!0,"135",4,2],[!1,"Buzzshare","United Kingdom","Cycling Cap","07/07/2020","86-5920601",!0,"11",1,4],[!1,"Roodel","United States","Full-Finger Gloves","13/01/2020","48-1055459",!0,"41",6,4],[!1,"Zoovu","China","Half-Finger Gloves","03/06/2020","12-7842022",!0,"144",6,1],[!1,"Photofeed","China","HL Mountain Frame","14/07/2020","94-5088099",!0,"106",1,4]],yg="selected",vg="odd";function bg(){return Cg}const Sg="handsontableEditor",Rg="handsontable";class Eg extends eu{static get EDITOR_TYPE(){return Rg}open(){super.open(),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Zt(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(t,e,o,n,s,i){super.prepare(t,e,o,n,s,i);const r=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown(t,e){const o=this.getSourceData(e.row,e.col);void 0!==o&&r.setValue(o),r.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Ee(l,i.handsontable),this.htOptions=l}beginEditing(t,e){const o=this.hot.getSettings().onBeginEditing;o&&!1===o()||super.beginEditing(t,e)}createElements(){super.createElements();const t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}finishEditing(t,e,o){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const t=this.htEditor.getInstance().getValue();void 0!==t&&this.setValue(t)}super.finishEditing(t,e,o)}assignHooks(){this.hot.addHook("afterDestroy",(()=>{this.htEditor&&this.htEditor.destroy()}))}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor");super.registerShortcuts();const o={group:Sg,relativeToGroup:Wo,position:"before"},n=(t,e)=>{const o=this.htEditor.getInstance();if(void 0!==t&&(t<0||o.flipped&&t>o.countRows()-1?o.deselectCell():o.selectCell(t,0),o.getData().length))return e.preventDefault(),ho(e),this.hot.listen(),this.TEXTAREA.focus(),!1};e.addShortcuts([{keys:[["ArrowUp"]],callback:t=>{const e=this.htEditor.getInstance();let o,s;return!e.getSelectedLast()&&e.flipped?o=e.countRows()-1:e.getSelectedLast()&&(e.flipped?(s=e.getSelectedLast()[0],o=Math.max(0,s-1)):(s=e.getSelectedLast()[0],o=s-1)),n(o,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:t=>{const e=this.htEditor.getInstance();let o,s;if(e.getSelectedLast()||e.flipped){if(e.getSelectedLast())if(e.flipped)o=e.getSelectedLast()[0]+1;else if(!e.flipped){const t=e.countRows()-1;s=e.getSelectedLast()[0],o=Math.min(t,s+1)}}else o=0;return n(o,t)},preventDefault:!1}],o)}unregisterShortcuts(){super.unregisterShortcuts();const t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(Sg)}}function Mg(t,e,o){return e=Tg(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Tg(t){var e=xg(t,"string");return"symbol"===typeof e?e:String(e)}function xg(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const Ig=new WeakMap,Hg="autocomplete";class Ag extends Eg{static get EDITOR_TYPE(){return Hg}constructor(t){super(t),Mg(this,"sortByRelevance",(function(t,e,o){const n=[],s=[],i=t.length;let r,l,a,h,c=e.length;if(0===i){for(a=0;a<c;a++)s.push(a);return s}for(a=0;a<c;a++){if(l=ut(U(e[a])),o)h=l.indexOf(t);else{const e=this.cellProperties.locale;h=l.toLocaleLowerCase(e).indexOf(t.toLocaleLowerCase(e))}-1!==h&&(r=l.length-h-i,n.push({baseIndex:a,index:h,charsLeft:r,value:l}))}for(n.sort(((t,e)=>{if(-1===e.index)return-1;if(-1===t.index)return 1;if(t.index<e.index)return-1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0})),a=0,c=n.length;a<c;a++)s.push(n[a].baseIndex);return s})),this.query=null,this.strippedChoices=[],this.rawChoices=[],Ig.set(this,{skipOne:!1,isMacOS:this.hot.rootWindow.navigator.platform.indexOf("Mac")>-1})}getValue(){const t=this.rawChoices.find((t=>{const e=this.stripValueIfNeeded(t);return e===this.TEXTAREA.value}));return z(t)?t:this.TEXTAREA.value}createElements(){super.createElements(),Mt(this.htContainer,"autocompleteEditor"),Mt(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}open(){const t=Ig.get(this);super.open();const e=this.htEditor.getInstance(),o=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();let n=oe();0===n&&t.isMacOS&&(n+=15),this.addHook("beforeKeyDown",(t=>this.onBeforeKeyDown(t))),e.updateSettings({colWidths:o?[Ut(this.TEXTAREA)-2]:void 0,width:o?Ut(this.TEXTAREA)+n:void 0,renderer:(t,e,o,n,s,i,r)=>{iu(t,e,o,n,s,i,r);const{filteringCaseSensitive:l,allowHtml:a,locale:h}=this.cellProperties,c=this.query;let d,u,g=U(i);g&&!a&&(d=!0===l?g.indexOf(c):g.toLocaleLowerCase(h).indexOf(c.toLocaleLowerCase(h)),-1!==d&&(u=g.substr(d,c.length),g=g.replace(u,`<strong>${u}</strong>`))),e.innerHTML=g},autoColumnSize:!0}),t.skipOne&&(t.skipOne=!1),this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}))}close(){this.removeHooksByKey("beforeKeyDown"),super.close()}discardEditor(t){super.discardEditor(t),this.hot.view.render()}queryChoices(t){const e=this.cellProperties.source;this.query=t,"function"===typeof e?e.call(this.cellProperties,t,(t=>{this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))})):Array.isArray(e)?(this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))):this.updateChoicesList([])}updateChoicesList(t){const e=Xt(this.TEXTAREA),o=qt(this.TEXTAREA),n=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let i=null,r=null,l=t;n&&(i=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const a=Array.isArray(i)?i.length:0;if(!1===s)a&&(r=i[0]);else{const t=[];for(let e=0,o=l.length;e<o;e++){if(n&&a<=e)break;a?t.push(l[i[e]]):t.push(l[e])}r=0,l=t}this.strippedChoices=l,this.htEditor.loadData(x([l])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(r),this.hot.listen(),Zt(this.TEXTAREA,e,e===o?void 0:o)}flipDropdownIfNeeded(){const t=Bt(this.hot.view._wt.wtTable.TABLE),e=t===this.hot.rootWindow,o=this.cellProperties.preventOverflow;if(e||!e&&(o||"horizontal"===o))return!1;const n=Nt(this.TEXTAREA),s=zt(this.TEXTAREA),i=this.getDropdownHeight(),r=t.scrollTop,l=zt(this.hot.view._wt.wtTable.THEAD),a=Nt(t),h=n.top-a.top-l+r,c=t.scrollHeight-h-l-s,d=i>c&&h>c;return d?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(d?h:c,i),d}limitDropdownIfNeeded(t,e){if(e>t){let o=0,n=0,s=0,i=null;do{s=this.htEditor.getRowHeight(n)||this.htEditor.view._wt.getSetting("defaultRowHeight"),o+=s,n+=1}while(o<t);i=o-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+e-i+"px"),this.setDropdownHeight(o-s)}}flipDropdown(t){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=-t+"px",this.htEditor.flipped=!0}unflipDropdown(){const t=this.htEditor.rootElement.style;t.position="absolute",t.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const t=this.htEditor.getColWidth(0)+oe(this.hot.rootDocument)+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(t){this.htEditor.updateSettings({height:t})}highlightBestMatchingChoice(t){"number"===typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const t=this.htEditor.getInstance().getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8}stripValueIfNeeded(t){return this.stripValuesIfNeeded([t])[0]}stripValuesIfNeeded(t){const{allowHtml:e}=this.cellProperties,o=A(t,(t=>U(t))),n=A(o,(t=>e?t:ut(t)));return n}allowKeyEventPropagation(t){const e=this.htEditor.getSelectedRangeLast(),o={row:e?e.from.row:-1};let n=!1;return t===oo.ARROW_DOWN&&o.row>0&&o.row<this.htEditor.countRows()-1&&(n=!0),t===oo.ARROW_UP&&o.row>-1&&(n=!0),n}onBeforeKeyDown(t){const e=Ig.get(this);if(e.skipOne=!1,so(t.keyCode)||t.keyCode===oo.BACKSPACE||t.keyCode===oo.DELETE||t.keyCode===oo.INSERT){let o=10;if(t.keyCode===oo.C&&(t.ctrlKey||t.metaKey))return;this.isOpened()||(o+=10),this.htEditor&&this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value),e.skipOne=!0}),o)}}}const Og="checkbox";class kg extends Kd{static get EDITOR_TYPE(){return Og}beginEditing(t,e){if(e&&"mouseup"===e.type){const t=this.TD.querySelector('input[type="checkbox"]');Et(t,"htBadValue")||t.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var Ng=o(1077);const Pg="date",_g="dateEditor";class Dg extends eu{static get EDITOR_TYPE(){return Pg}constructor(t){super(t),this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,this.$datePicker=null}init(){if("function"!==typeof E)throw new Error("You need to include moment.js to your project.");if("function"!==typeof Ng)throw new Error("You need to include Pikaday to your project.");super.init(),this.instance.addHook("afterDestroy",(()=>{this.parentDestroyed=!0,this.destroyElements()}))}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Mt(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);const t=new Bo(this);t.addEventListener(this.datePicker,"mousedown",(t=>t.stopPropagation()))}destroyElements(){const t=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}prepare(t,e,o,n,s,i){super.prepare(t,e,o,n,s,i)}open(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.hot.getShortcutManager(),o=e.getContext("editor");super.open(),this.showDatepicker(t),o.addShortcut({keys:[["Enter"]],callback:t=>{t.stopPropagation()},group:_g})}close(){var t;this._opened=!1,null!==(t=this.$datePicker)&&void 0!==t&&t.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout((()=>{this.instance._refreshBorders()}));const e=this.hot.getShortcutManager(),o=e.getContext("editor");o.removeShortcutsByGroup(_g),super.close()}finishEditing(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){const t=this.originalValue;void 0!==t&&this.setValue(t)}super.finishEditing(t,e)}showDatepicker(t){const e=this.TD.getBoundingClientRect(),o=this.cellProperties.dateFormat||this.defaultDateFormat,n=this.instance.view.isMouseDown(),s=!!t&&io(t.keyCode);let i;this.datePicker.style.display="block",this.$datePicker=new Ng(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+e.top+zt(this.TD)}px`;let r=this.hot.rootWindow.pageXOffset;r=this.hot.isRtl()?e.right-Ut(this.datePicker):e.left,this.datePickerStyle.left=`${r}px`,this.originalValue?(i=this.originalValue,E(i,o,!0).isValid()&&this.$datePicker.setMoment(E(i,o),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),s||n||this.setValue("")):this.cellProperties.defaultDate?(i=this.cellProperties.defaultDate,E(i,o,!0).isValid()&&this.$datePicker.setMoment(E(i,o),!0),s||n||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const t=this.TEXTAREA,e={};this.cellProperties&&this.cellProperties.datePickerConfig&&Me(e,this.cellProperties.datePickerConfig);const o=e.onSelect,n=e.onClose;return e.field=t,e.trigger=t,e.container=this.datePicker,e.bound=!1,e.format=e.format||this.defaultDateFormat,e.reposition=e.reposition||!1,e.isRTL=!1,e.onSelect=t=>{let e=t;isNaN(e.getTime())||(e=E(e).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(e),this.hideDatepicker(),o&&o()},e.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),n&&n()},e}}const Lg="dropdown";class Vg extends Ag{static get EDITOR_TYPE(){return Lg}prepare(t,e,o,n,s,i){super.prepare(t,e,o,n,s,i),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}Ro.getSingleton().add("beforeValidate",(function(t,e,o){const n=this.getCellMeta(e,this.propToCol(o));n.editor===Vg&&void 0===n.strict&&(n.filter=!1,n.strict=!0)}));const Bg="numeric";class Fg extends eu{static get EDITOR_TYPE(){return Bg}}const Wg="password";class jg extends eu{static get EDITOR_TYPE(){return Wg}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,It(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Ug="ht_editor_visible",zg="selectEditor",$g="select";class Gg extends Kd{static get EDITOR_TYPE(){return $g}init(){this.select=this.hot.rootDocument.createElement("SELECT"),Mt(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(t){this.select.value=t}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";const t=this.hot.getShortcutManager();t.setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Et(this.select,Ug)&&Tt(this.select,Ug),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>this.refreshDimensions())),this.addHook("afterRowResize",(()=>this.refreshDimensions()))}prepare(t,e,o,n,s,i){super.prepare(t,e,o,n,s,i);const r=this.cellProperties.selectOptions;let l;l="function"===typeof r?this.prepareOptions(r(this.row,this.col,this.prop)):this.prepareOptions(r),It(this.select),ke(l,((t,e)=>{const o=this.hot.rootDocument.createElement("OPTION");o.value=e,At(o,t),this.select.appendChild(o)}))}prepareOptions(t){let e={};if(Array.isArray(t))for(let o=0,n=t.length;o<n;o++)e[t[o]]=t[o];else"object"===typeof t&&(e=t);return e}refreshValue(){const t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){if(this.state!==Gd.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top:t,start:e,width:o,height:n}=this.getEditedCellRect(),s=this.select.style;s.height=`${n}px`,s.width=`${o}px`,s.top=`${t}px`,s[this.hot.isRtl()?"right":"left"]=`${e}px`,s.margin="0px",Mt(this.select,Ug)}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor"),o={group:zg};!1!==this.isInFullEditMode()&&e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const t=this.select.selectedIndex-1;t>=0&&(this.select[t].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const t=this.select.selectedIndex+1;t<=this.select.length-1&&(this.select[t].selected=!0)}}],o)}unregisterShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(zg)}}const Yg="time";class Kg extends eu{static get EDITOR_TYPE(){return Yg}prepare(t,e,o,n,s,i){super.prepare(t,e,o,n,s,i),this.TEXTAREA.dir="ltr"}}function Xg(){_o(Kd),_o(Ag),_o(kg),_o(Dg),_o(Vg),_o(Eg),_o(Fg),_o(jg),_o(Gg),_o(eu),_o(Kg)}const qg="html";function Qg(t,e,o,n,s,i,r){nu.apply(this,[t,e,o,n,s,i,r]),At(e,null===i||void 0===i?"":i,!1)}Qg.RENDERER_TYPE=qg;const Jg="autocomplete";function Zg(t,e,o,n,s,i,r){const{rootDocument:l}=t,a=r.allowHtml?Qg:iu,h=l.createElement("DIV");if(h.className="htAutocompleteArrow",h.appendChild(l.createTextNode(String.fromCharCode(9660))),a.apply(this,[t,e,o,n,s,i,r]),e.firstChild||e.appendChild(l.createTextNode(String.fromCharCode(160))),e.insertBefore(h,e.firstChild),Mt(e,"htAutocomplete"),!t.acArrowListener){const s=new Bo(t);t.acArrowListener=function(s){Et(s.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(o,n),e)},s.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",(()=>{s.destroy()}))}}Zg.RENDERER_TYPE=Jg;const tm=new WeakMap,em=new WeakMap,om="htBadValue",nm="data-row",sm="data-col",im="checkboxRenderer",rm="checkbox";function lm(t,e,o,n,s,i,r){const{rootDocument:l}=t;nu.apply(this,[t,e,o,n,s,i,r]),am(t);let a=hm(l);const h=r.label;let c=!1;if("undefined"===typeof r.checkedTemplate&&(r.checkedTemplate=!0),"undefined"===typeof r.uncheckedTemplate&&(r.uncheckedTemplate=!1),It(e),i===r.checkedTemplate||U(i).toLocaleLowerCase(r.locale)===U(r.checkedTemplate).toLocaleLowerCase(r.locale)?a.checked=!0:i===r.uncheckedTemplate||U(i).toLocaleLowerCase(r.locale)===U(r.uncheckedTemplate).toLocaleLowerCase(r.locale)?a.checked=!1:G(i)?Mt(a,"noValue"):(a.style.display="none",Mt(a,om),c=!0),a.setAttribute(nm,o),a.setAttribute(sm,n),!c&&h){let r="";if(h.value)r="function"===typeof h.value?h.value.call(this,o,n,s,i):h.value;else if(h.property){const e=t.getDataAtRowProp(o,h.property);r=null!==e?e:""}const c=cm(l,r,!0!==h.separated);"before"===h.position?h.separated?(e.appendChild(c),e.appendChild(a)):(c.appendChild(a),a=c):h.position&&"after"!==h.position||(h.separated?(e.appendChild(a),e.appendChild(c)):(c.insertBefore(a,c.firstChild),a=c))}function d(){const e=t.getShortcutManager(),o=e.getContext("grid"),n={group:im};o.addShortcuts([{keys:[["space"]],callback:()=>(u(),!g())},{keys:[["enter"]],callback:()=>(u(),!g()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(u(!0),!g()),relativeToGroup:jo,position:"before"}],n)}function u(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const o=t.getSelectedRange();if(o)for(let n=0;n<o.length;n++){const{row:s,col:i}=o[n].getTopStartCorner(),{row:r,col:l}=o[n].getBottomEndCorner(),a=[];for(let o=s;o<=r;o+=1)for(let n=i;n<=l;n+=1){const s=t.getCellMeta(o,n);if("checkbox"!==s.type)return;if(!0===s.readOnly)continue;"undefined"===typeof s.checkedTemplate&&(s.checkedTemplate=!0),"undefined"===typeof s.uncheckedTemplate&&(s.uncheckedTemplate=!1);const i=t.getDataAtCell(o,n);!1===e?[s.checkedTemplate,s.checkedTemplate.toString()].includes(i)?a.push([o,n,s.uncheckedTemplate]):[s.uncheckedTemplate,s.uncheckedTemplate.toString(),null,void 0].includes(i)&&a.push([o,n,s.checkedTemplate]):a.push([o,n,s.uncheckedTemplate])}a.length>0&&t.setDataAtCell(a)}}function g(){const e=t.getSelectedRange();if(e){for(let o=0;o<e.length;o++){const n=e[o].getTopStartCorner(),s=e[o].getBottomEndCorner();for(let e=n.row;e<=s.row;e++)for(let o=n.col;o<=s.col;o++){const n=t.getCellMeta(e,o);if("checkbox"!==n.type)return!1;const s=t.getCell(e,o);if(null===s||void 0===s)return!0;{const t=s.querySelectorAll("input[type=checkbox]");if(t.length>0&&!n.readOnly)return!0}}}return!1}}(!h||h&&!h.separated)&&e.appendChild(a),c&&e.appendChild(l.createTextNode("#bad-value#")),tm.has(t)||(tm.set(t,!0),d())}function am(t){let e=em.get(t);if(!e){const{rootElement:o}=t;e=new Bo(t),e.addEventListener(o,"click",(e=>um(e,t))),e.addEventListener(o,"mouseup",(e=>dm(e,t))),e.addEventListener(o,"change",(e=>gm(e,t))),em.set(t,e)}return e}function hm(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function cm(t,e,o){const n=t.createElement("label");return n.className="htCheckboxRendererLabel "+(o?"fullWidth":""),n.appendChild(t.createTextNode(e)),n.cloneNode(!0)}function dm(t,e){const{target:o}=t;mm(o)&&o.hasAttribute(nm)&&o.hasAttribute(sm)&&setTimeout(e.listen,10)}function um(t,e){const{target:o}=t;if(!mm(o))return;if(!o.hasAttribute(nm)||!o.hasAttribute(sm))return;const n=parseInt(o.getAttribute(nm),10),s=parseInt(o.getAttribute(sm),10),i=e.getCellMeta(n,s);i.readOnly&&t.preventDefault()}function gm(t,e){const{target:o}=t;if(!mm(o))return;if(!o.hasAttribute(nm)||!o.hasAttribute(sm))return;const n=parseInt(o.getAttribute(nm),10),s=parseInt(o.getAttribute(sm),10),i=e.getCellMeta(n,s);if(!i.readOnly){let o=null;o=t.target.checked?void 0===i.uncheckedTemplate||i.checkedTemplate:void 0!==i.uncheckedTemplate&&i.uncheckedTemplate,e.setDataAtCell(n,s,o)}}function mm(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}Ro.getSingleton().add("modifyAutoColumnSizeSeed",(function(t,e,o){const{label:n,type:s,row:i,column:r,prop:l}=e;if(s===rm){if(n){const{value:e,property:s}=n;let a=o;if(e)a="function"===typeof e?e(i,r,l,o):e;else if(s){const t=this.getDataAtRowProp(i,s);a=null!==t?t:o}t=a}return t}})),lm.RENDERER_TYPE=rm;var fm=o(204);const pm="numeric";function wm(t,e,o,n,s,i,r){let l=i;if(Jo(l)){const t=r.numericFormat,o=t&&t.culture||"-",n=t&&t.pattern,s=r.className||"",i=s.length?s.split(" "):[];if("undefined"!==typeof o&&!fm.languages()[o]){const t=o.replace("-",""),e=fm.allLanguages?fm.allLanguages[o]:fm[t];e&&fm.registerLanguage(e)}fm.setLanguage(o),l=fm(l).format(n||"0"),i.indexOf("htLeft")<0&&i.indexOf("htCenter")<0&&i.indexOf("htRight")<0&&i.indexOf("htJustify")<0&&i.push("htRight"),i.indexOf("htNumeric")<0&&i.push("htNumeric"),r.className=i.join(" "),e.dir="ltr"}iu(t,e,o,n,s,l,r)}wm.RENDERER_TYPE=pm;const Cm="password";function ym(t,e,o,n,s,i,r){iu.apply(this,[t,e,o,n,s,i,r]);const l=r.hashLength||e.innerHTML.length,a=r.hashSymbol||"*";let h="";tn(l-1,(()=>{h+=a})),At(e,h)}ym.RENDERER_TYPE=Cm;const vm="time";function bm(t,e,o,n,s,i,r){iu.apply(this,[t,e,o,n,s,i,r]),e.dir="ltr"}function Sm(){kn(Zg),kn(nu),kn(lm),kn(Qg),kn(wm),kn(ym),kn(iu),kn(bm)}bm.RENDERER_TYPE=vm;const Rm="autocomplete";function Em(t,e){let o=t;null!==o&&void 0!==o||(o=""),this.allowEmpty&&""===o?e(!0):this.strict&&this.source?"function"===typeof this.source?this.source(o,Mm(o,e)):Mm(o,e)(this.source):e(!0)}function Mm(t,e){const o=t;return function(t){let n=!1;for(let e=0,s=t.length;e<s;e++)if(o===t[e]){n=!0;break}e(n)}}function Tm(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}Em.VALIDATOR_TYPE=Rm;const xm="date";function Im(t,e){const o=No(Pg,this.instance);let n=t,s=!0;null!==n&&void 0!==n||(n="");let i=E(n,this.dateFormat||o.defaultDateFormat,!0).isValid(),r=E(new Date(n)).isValid()||i;if(this.allowEmpty&&""===n&&(r=!0,i=!0),r||(s=!1),!r&&i&&(s=!0),r&&!i)if(!0===this.correctFormat){const t=Hm(n,this.dateFormat),e=this.instance.toVisualRow(this.row),o=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(e,o,t,"dateValidator"),s=!0}else s=!1;e(s)}function Hm(t,e){const o=E(Tm(t)),n=E(t,e),s=t.search(/[A-z]/g)>-1;let i;return i=o.isValid()&&o.format("x")===n.format("x")||!n.isValid()||s?o:n,i.format(e)}Im.VALIDATOR_TYPE=xm;const Am="numeric";function Om(t,e){let o=t;null!==o&&void 0!==o||(o=""),this.allowEmpty&&""===o?e(!0):e(""!==o&&Jo(t))}Om.VALIDATOR_TYPE=Am;const km=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Nm="time";function Pm(t,e){const o=this.timeFormat||"h:mm:ss a";let n=!0,s=t;null===s&&(s=""),s=/^\d{3,}$/.test(s)?parseInt(s,10):s;const i=/^\d{1,2}$/.test(s);i&&(s+=":00");const r=E(s,km,!0).isValid()?E(s):E(s,o);let l=r.isValid(),a=E(s,o,!0).isValid()&&!i;if(this.allowEmpty&&""===s&&(l=!0,a=!0),l||(n=!1),!l&&a&&(n=!0),l&&!a)if(!0===this.correctFormat){const t=r.format(o),e=this.instance.toVisualRow(this.row),s=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(e,s,t,"timeValidator"),n=!0}else n=!1;e(n)}function _m(){Bn(Em),Bn(Im),Bn(Om),Bn(Pm)}Pm.VALIDATOR_TYPE=Nm;const Dm="autocomplete",Lm={CELL_TYPE:Dm,editor:Ag,renderer:Zg,validator:Em},Vm="checkbox",Bm={CELL_TYPE:Vm,editor:kg,renderer:lm},Fm="date",Wm={CELL_TYPE:Fm,editor:Dg,renderer:Zg,validator:Im},jm="dropdown",Um={CELL_TYPE:jm,editor:Vg,renderer:Zg,validator:Em},zm="handsontable",$m={CELL_TYPE:zm,editor:Eg,renderer:Zg},Gm="numeric",Ym={CELL_TYPE:Gm,editor:Fg,renderer:wm,validator:Om,dataType:"number"},Km="password",Xm={CELL_TYPE:Km,editor:jg,renderer:ym,copyable:!1},qm="time",Qm={CELL_TYPE:qm,editor:Kg,renderer:bm,validator:Pm};function Jm(){nd(Lm),nd(Bm),nd(Wm),nd(Um),nd($m),nd(Ym),nd(Xm),nd(lu),nd(Qm)}function Zm(t,e){tf(t,e),e.add(t)}function tf(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ef(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}const of=new Map([["plugin",Sn],["cell-type",Zc],["editor",Ho],["renderer",In],["validator",_n]]),nf="base",sf=new WeakMap,rf=[];let lf=null;var af=new WeakSet;class hf{static get PLUGIN_KEY(){return nf}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(t){Zm(this,af),Oe(this,"hot",t,{writable:!1}),sf.set(this,{hooks:{}}),lf=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",(()=>this.onAfterPluginsInitialized())),this.hot.addHook("afterUpdateSettings",(t=>this.onUpdateSettings(t))),this.hot.addHook("beforeInit",(()=>this.init()))}init(){this.pluginName=this.hot.getPluginName(this);const t=this.constructor.PLUGIN_DEPS,e=Array.isArray(t)?t:[];if(e.length>0){const t=[];if(e.forEach((e=>{const[o,n]=e.split(":");if(!of.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);of.get(o)(n)||t.push(` - ${n} (${o})`)})),t.length>0){const e=[`The ${this.pluginName} plugin requires the following modules:\n`,`${t.join("\n")}\n`].join("");rf.push(e)}}lf||(lf=vn()),lf.indexOf("UndoRedo")>=0&&lf.splice(lf.indexOf("UndoRedo"),1),lf.indexOf(this.pluginName)>=0&&lf.splice(lf.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}));const o=0===lf.length;if(o){if(rf.length>0){const t=[`${rf.join("\n")}\n`,"You have to import and register them manually."].join("");throw new Error(t)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}addHook(t,e){sf.get(this).hooks[t]=sf.get(this).hooks[t]||[];const o=sf.get(this).hooks[t];this.hot.addHook(t,e),o.push(e),sf.get(this).hooks[t]=o}removeHooks(t){O(sf.get(this).hooks[t]||[],(e=>{this.hot.removeHook(t,e)}))}clearHooks(){const t=sf.get(this).hooks;ke(t,((t,e)=>this.removeHooks(e))),t.length=0}callOnPluginsReady(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}onAfterPluginsInitialized(){O(this.pluginsInitializedCallbacks,(t=>t())),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(t){const e=ef(this,af,cf).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}updatePlugin(){}destroy(){this.eventManager&&this.eventManager.destroy(),this.clearHooks(),ke(this,((t,e)=>{"hot"!==e&&(this[e]=null)})),delete this.t,delete this.hot}}function cf(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if("boolean"===typeof e)return e;for(let o=0;o<e.length;o++)if(void 0!==t[e[o]])return!0;return!1}class df{constructor(t){this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}addRow(t,e){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const o={row:t};this.rows.push(o),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}addColumnHeadersRow(t){const e=this.hot.getColHeader(0);if(null!==e&&void 0!==e){const e={row:-1};this.rows.push(e),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),e.table=this.table.table}}addColumn(t,e){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const o={col:t};this.columns.push(o),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),o.table=this.table.table}getHeights(t){this.injected||this.injectTable(),O(this.rows,(e=>{t(e.row,zt(e.table)-1)}))}getWidths(t){this.injected||this.injectTable(),O(this.columns,(e=>{const{width:o}=e.table.getBoundingClientRect();t(e.col,Math.ceil(o))}))}setSettings(t){this.settings=t}setSetting(t,e){this.settings||(this.settings={}),this.settings[t]=e}getSettings(){return this.settings}getSetting(t){return this.settings?this.settings[t]:null}createColGroupsCol(){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1)),this.samples.forEach((e=>{O(e.strings,(e=>{t.appendChild(this.createColElement(e.col))}))})),t}createRow(t){const{rootDocument:e}=this.hot,o=e.createDocumentFragment(),n=e.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,n),o.appendChild(n)),this.samples.forEach((n=>{O(n.strings,(n=>{const s=n.col,i=this.hot.getCellMeta(t,s);i.col=s,i.row=t;const r=this.hot.getCellRenderer(i),l=e.createElement("td");l.setAttribute("ghost-table",1),r(this.hot,l,t,s,this.hot.colToProp(s),n.value,i),o.appendChild(l)}))})),o}appendColumnHeadersRow(){const{rootDocument:t}=this.hot,e=t.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){const n=t.createElement("th");o.push([-1,n]),e.appendChild(n)}this.samples.forEach((n=>{O(n.strings,(n=>{const s=n.col,i=t.createElement("th");o.push([s,i]),e.appendChild(i)}))})),this.table.tHead.appendChild(e),O(o,(t=>{const[e,o]=t;this.hot.view.appendColHeader(e,o)}))}createCol(t){const{rootDocument:e}=this.hot,o=e.createDocumentFragment();return this.samples.forEach((n=>{O(n.strings,(n=>{const s=n.row,i=this.hot.getCellMeta(s,t);i.col=t,i.row=s;const r=this.hot.getCellRenderer(i),l=e.createElement("td"),a=e.createElement("tr");l.setAttribute("ghost-table",1),r(this.hot,l,s,t,this.hot.colToProp(t),n.value,i),a.appendChild(l),o.appendChild(a)}))})),o}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(t){const e=this.hot.rootDocument.createElement("col");return e.style.width=`${this.hot.view._wt.wtTable.getStretchedColumnWidth(t)}px`,e}createTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,o=e.createDocumentFragment(),n=e.createElement("table"),s=e.createElement("thead"),i=e.createElement("tbody"),r=e.createElement("colgroup"),l=e.createElement("tr"),a=e.createElement("th");return this.isVertical()&&n.appendChild(r),this.isHorizontal()&&(l.appendChild(a),s.appendChild(l),n.style.tableLayout="auto",n.style.width="auto"),n.appendChild(s),this.isVertical()&&i.appendChild(l),n.appendChild(i),Mt(n,t),o.appendChild(n),{fragment:o,table:n,tHead:s,tBody:i,colGroup:r,tr:l,th:a}}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,o=e.createDocumentFragment(),n=e.createElement("div"),s=`htGhostTable htAutoSize ${t.trim()}`;return Mt(n,s),o.appendChild(n),{fragment:o,container:n}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}}var uf=df;class gf{static get SAMPLE_COUNT(){return 3}constructor(t){this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}getSampleCount(){return this.customSampleCount?this.customSampleCount:gf.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,e){return this.generateSamples("row",e,t)}generateColumnSamples(t,e){return this.generateSamples("col",e,t)}generateSamples(t,e,o){const n=new Map,{from:s,to:i}="number"===typeof o?{from:o,to:o}:o;return tn(s,i,(o=>{const s=this.generateSample(t,e,o);n.set(o,s)})),n}generateSample(t,e,o){if("row"!==t&&"col"!==t)throw new Error("Unsupported sample type");const n=new Map,s="row"===t?"col":"row",i=[];return tn(e.from,e.to,(e=>{const{value:r,bundleSeed:l}="row"===t?this.dataFactory(o,e):this.dataFactory(e,o),a="string"===typeof l&&l.length>0;let h;h=a?l:Ae(r)?`${Object.keys(r).length}`:Array.isArray(r)?`${r.length}`:`${U(r).length}`,n.has(h)||n.set(h,{needed:this.getSampleCount(),strings:[]});const c=n.get(h);if(c.needed){const t=i.indexOf(r)>-1;(!t||this.allowDuplicates||a)&&(c.strings.push({value:r,[s]:e}),i.push(r),c.needed-=1)}})),n}}var mf=gf;Ro.getSingleton().register("modifyAutoColumnSizeSeed");const ff="autoColumnSize",pf=10,wf=new WeakMap,Cf="autoColumnSize";class yf extends hf{static get PLUGIN_KEY(){return ff}static get PLUGIN_PRIORITY(){return pf}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){super(t),wf.set(this,{cachedColumnHeaders:[]}),this.ghostTable=new uf(this.hot),this.samplesGenerator=new mf(((t,e)=>{const o=this.hot.getCellMeta(t,e);let n="";o.spanned||(n=this.hot.getDataAtCell(t,e));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,o,n)),{value:n,bundleSeed:s}})),this.firstCalculation=!0,this.inProgress=!1,this.measuredColumns=0,this.columnWidthsMap=new vl,this.hot.columnIndexMapper.registerMap(Cf,this.columnWidthsMap),this.addHook("beforeColumnResize",((t,e,o)=>this.onBeforeColumnResize(t,e,o)))}isEnabled(){return!1!==this.hot.getSettings()[ff]&&!this.hot.getSettings().colWidths}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[ff];e&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return t.onAfterLoadData(...arguments)})),this.addHook("beforeChangeRender",(t=>this.onBeforeChange(t))),this.addHook("afterFormulasValuesUpdate",(t=>this.onAfterFormulasValuesUpdate(t))),this.addHook("beforeViewRender",(t=>this.onBeforeViewRender(t))),this.addHook("modifyColWidth",((t,e)=>this.getColumnWidth(e,t))),this.addHook("afterInit",(()=>this.onAfterInit())),super.enablePlugin()}updatePlugin(){const t=this.findColumnsWhereHeaderWasChanged();t.length&&(this.clearCache(t),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",((t,e,o)=>this.onBeforeColumnResize(t,e,o)))}calculateVisibleColumnsWidth(){const t=this.hot.countRows();if(!t)return;const e=this.hot.renderCall,o=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();-1!==o&&-1!==n&&this.calculateColumnsWidth({from:o,to:n},void 0,e)}calculateColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n="number"===typeof t?{from:t,to:t}:t,s="number"===typeof e?{from:e,to:e}:e;tn(n.from,n.to,(t=>{let e=this.hot.toPhysicalColumn(t);if(null===e&&(e=t),o||null===this.columnWidthsMap.getValueAtIndex(e)&&!this.hot._getColWidthFromSettings(e)){const e=this.samplesGenerator.generateColumnSamples(t,s);O(e,(t=>{let[e,o]=t;return this.ghostTable.addColumn(e,o)}))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((t,e)=>{const o=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(o,e)}))}),!0),this.measuredColumns=n.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=0;const o=this.hot.countCols()-1;let n=null;this.inProgress=!0;const s=()=>{if(!this.hot)return Wn(n),void(this.inProgress=!1);this.calculateColumnsWidth({from:e,to:Math.min(e+yf.CALCULATION_STEP,o)},t),e=e+yf.CALCULATION_STEP+1,e<o?n=Fn(s):(Wn(n),this.inProgress=!1,this.hot.view.adjustElementsSize())},i=this.getSyncCalculationLimit();this.firstCalculation&&i>=0&&(this.calculateColumnsWidth({from:0,to:i},t),this.firstCalculation=!1,e=i+1),e<o?s():this.inProgress=!1}setSamplingOptions(){const t=this.hot.getSettings()[ff],e=t&&Le(t,"samplingRatio")?t.samplingRatio:void 0,o=t&&Le(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const t=this.hot.getSettings()[ff];let e=yf.SYNC_CALCULATION_LIMIT;const o=this.hot.countCols()-1;return Ae(t)&&(e=t.syncLimit,ct(e)?e=on(o,e):e>>=0),Math.min(e,o)}getColumnWidth(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e;return void 0===n&&(n=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),o&&"number"===typeof n&&(n=Math.max(n,br.DEFAULT_WIDTH))),n}getFirstVisibleColumn(){const t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){const e=t.wtTable.getFirstVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){const e=t.wtTable.getFirstRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return-1}getLastVisibleColumn(){const t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){const e=t.wtTable.getLastVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){const e=t.wtTable.getLastRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return-1}findColumnsWhereHeaderWasChanged(){const t=this.hot.getColHeader(),{cachedColumnHeaders:e}=wf.get(this),o=I(t,((t,o,n)=>{const s=e.length;return(s-1<n||e[n]!==o)&&t.push(n),s-1<n?e.push(o):e[n]=o,t}),[]);return o}clearCache(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.batchExecution((()=>{O(t,(t=>{this.columnWidthsMap.setValueAtIndex(t,null)}))}),!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!H(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(t=>null===t)).length}onBeforeViewRender(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}onAfterLoadData(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout((()=>{this.hot&&this.recalculateAllColumnsWidth()}),0)}onBeforeChange(t){const e=A(t,(t=>{let[,e]=t;return this.hot.toPhysicalColumn(this.hot.propToCol(e))}));this.clearCache(Array.from(new Set(e)))}onBeforeColumnResize(t,e,o){let n=t;return o&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}onAfterInit(){wf.get(this).cachedColumnHeaders=this.hot.getColHeader()}onAfterFormulasValuesUpdate(t){const e=H(t,(t=>{var e;return z(null===(e=t.address)||void 0===e?void 0:e.col)})),o=A(e,(t=>t.address.col));this.clearCache(Array.from(new Set(o)))}destroy(){this.ghostTable.clean(),super.destroy()}}const vf={horizontal:"horizontal",vertical:"vertical"};function bf(t,e,o){let n,s,i;return e[0]===t[0]&&e[1]<t[1]?(i="left",n=o(e[0],e[1]),s=o(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(i="right",n=o(e[0],t[3]+1),s=o(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(i="up",n=o(e[0],e[1]),s=o(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(i="down",n=o(t[2]+1,e[1]),s=o(e[2],e[3])),n&&n.normalize(),s&&s.normalize(),{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:s}}function Sf(t){const e={};return!0===t?(e.directions=Object.keys(vf),e.autoInsertRow=!0):Ae(t)?(z(t.autoInsertRow)?t.direction===vf.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,z(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(vf)):"string"===typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}Ro.getSingleton().register("modifyAutofillRange"),Ro.getSingleton().register("beforeAutofill"),Ro.getSingleton().register("afterAutofill");const Rf="autofill",Ef=20,Mf=["fillHandle"],Tf="insert_row_below",xf=200;class If extends hf{static get PLUGIN_KEY(){return Rf}static get PLUGIN_PRIORITY(){return Ef}static get SETTING_KEYS(){return[Rf,...Mf]}constructor(t){super(t),this.eventManager=new Bo(this),this.addingStarted=!1,this.mouseDownOnCellCorner=!1,this.mouseDragOutside=!1,this.handleDraggedCells=0,this.directions=[],this.autoInsertRow=!1}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(t=>this.onAfterCellCornerMouseDown(t))),this.addHook("afterOnCellCornerDblClick",(t=>this.onCellCornerDblClick(t))),this.addHook("beforeOnCellMouseOver",((t,e)=>this.onBeforeCellMouseOver(e))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const t=this.hot.getSelectedRangeLast(),{row:e,col:o}=t.getTopStartCorner(),{row:n,col:s}=t.getBottomEndCorner(),i=this.hot.runHooks("modifyCopyableRange",[{startRow:e,startCol:o,endRow:n,endCol:s}]),r=[],l=[],a=[];return O(i,(t=>{for(let e=t.startRow;e<=t.endRow;e+=1)-1===r.indexOf(e)&&r.push(e);for(let e=t.startCol;e<=t.endCol;e+=1)-1===l.indexOf(e)&&l.push(e)})),O(r,(t=>{const e=[];O(l,(o=>{e.push(this.hot.getCopyableData(t,o))})),a.push(e)})),a}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[t,e,o,n]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),i=s.getTopStartCorner(),r=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[i.row,i.col,r.row,r.col],a=this.hot.runHooks("modifyAutofillRange",[Math.min(i.row,t),Math.min(i.col,e),Math.max(r.row,o),Math.max(r.col,n)],l),{directionOfDrag:h,startOfDragCoords:c,endOfDragCoords:d}=bf(l,a,((t,e)=>this.hot._createCellCoords(t,e)));if(c&&c.row>-1&&c.col>-1){const t=this.getSelectionData(),e=s.clone(),o=this.hot._createCellRange(c,c,d),n=this.hot.runHooks("beforeAutofill",t,e,o,h);if(!1===n)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let i=n;const r=n;if(["up","left"].indexOf(h)>-1&&(1!==r.length||0!==r[0].length))if(i=[],"up"===h){const t=d.row-c.row+1,e=t%r.length;for(let o=0;o<t;o++)i.push(r[(o+(r.length-e))%r.length])}else{const t=d.col-c.col+1,e=t%r[0].length;for(let o=0;o<r.length;o++){i.push([]);for(let n=0;n<t;n++)i[o].push(r[o][(n+(r[o].length-e))%r[o].length])}}this.hot.populateFromArray(c.row,c.col,i,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(a),this.hot.runHooks("afterAutofill",i,e,o,h),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}getCoordsOfDragAndDropBorders(t){const e=this.hot.getSelectedRangeLast(),o=e.getBottomEndCorner();let n=t;if(this.directions.includes(vf.vertical)&&this.directions.includes(vf.horizontal)){const s=e.getTopStartCorner();(o.col<=t.col||s.col>=t.col)&&(n=this.hot._createCellCoords(o.row,t.col)),(o.row<t.row||s.row>t.row)&&(n=this.hot._createCellCoords(t.row,o.col))}else if(this.directions.includes(vf.vertical))n=this.hot._createCellCoords(t.row,o.col);else{if(!this.directions.includes(vf.horizontal))return;n=this.hot._createCellCoords(o.row,t.col)}return this.reduceSelectionAreaIfNeeded(n)}showBorder(t){const e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}addRow(){this.hot._registerTimeout((()=>{this.hot.alter(Tf,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1}),xf)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.countRows();t[2]<o-1&&e[2]===o-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(t){const e=this.hot.getData(),o=this.hot.countRows();let n;for(let s=t[2]+1;s<o;s++){for(let n=t[1];n<=t[3];n++){const t=e[s][n];if(t)return-1}const o=e[s][t[1]-1],i=e[s][t[3]+1];(o||i)&&(n=s)}return n}addSelectionFromStartAreaToSpecificRowIndex(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}setSelection(t){this.hot.selectCell(...A(t,(t=>Math.max(t,0))),!1,!1)}selectAdjacent(){const t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(t){const{documentElement:e}=this.hot.rootDocument,o=Nt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+zt(this.hot.table),n=Nt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+Ut(this.hot.table);return t.clientY>o&&t.clientX<=n}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp())),this.eventManager.addEventListener(t,"mousemove",(t=>this.onMouseMove(t)))}onCellCornerDblClick(){const t=this.selectAdjacent();t&&this.fillIn()}onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}onBeforeCellMouseOver(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}onMouseUp(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}onMouseMove(t){const e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const t=Sf(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}destroy(){super.destroy()}}const Hf="autoRowSize",Af=40,Of="autoRowSize";class kf extends hf{static get PLUGIN_KEY(){return Hf}static get PLUGIN_PRIORITY(){return Af}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(t){super(t),this.rowHeightsMap=void 0,this.headerHeight=null,this.ghostTable=new uf(this.hot),this.samplesGenerator=new mf(((t,e)=>{let o;return t>=0?o=this.hot.getDataAtCell(t,e):-1===t&&(o=this.hot.getColHeader(e)),{value:o}})),this.firstCalculation=!0,this.inProgress=!1,this.measuredRows=0,this.rowHeightsMap=new vl,this.hot.rowIndexMapper.registerMap(Of,this.rowHeightsMap),this.addHook("beforeRowResize",((t,e,o)=>this.onBeforeRowResize(t,e,o)))}isEnabled(){const t=this.hot.getSettings()[Hf];return!0===t||Ae(t)}enablePlugin(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return t.onAfterLoadData(...arguments)})),this.addHook("beforeChangeRender",(t=>this.onBeforeChange(t))),this.addHook("beforeColumnResize",(()=>this.recalculateAllRowsHeight())),this.addHook("beforeViewRender",(t=>this.onBeforeViewRender(t))),this.addHook("modifyRowHeight",((t,e)=>this.getRowHeight(e,t))),this.addHook("modifyColumnHeaderHeight",(()=>this.getColumnHeaderHeight())),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",((t,e,o)=>this.onBeforeRowResize(t,e,o)))}calculateRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n="number"===typeof t?{from:t,to:t}:t,s="number"===typeof e?{from:e,to:e}:e;if(null!==this.hot.getColHeader(0)){const t=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(t.get(-1))}tn(n.from,n.to,(t=>{if(o||null===this.rowHeightsMap.getValueAtIndex(t)){const e=this.samplesGenerator.generateRowSamples(t,s);O(e,(t=>{let[e,o]=t;return this.ghostTable.addRow(e,o)}))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((t,e)=>{t<0?this.headerHeight=e:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(t),e)}))}),!0),this.measuredRows=n.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=0;const o=this.hot.countRows()-1;let n=null;this.inProgress=!0;const s=()=>{if(!this.hot)return Wn(n),void(this.inProgress=!1);this.calculateRowsHeight({from:e,to:Math.min(e+kf.CALCULATION_STEP,o)},t),e=e+kf.CALCULATION_STEP+1,e<o?n=Fn(s):(Wn(n),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},i=this.getSyncCalculationLimit();this.firstCalculation&&i>=0&&(this.calculateRowsHeight({from:0,to:i},t),this.firstCalculation=!1,e=i+1),e<o?s():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const t=this.hot.getSettings()[Hf],e=t&&Le(t,"samplingRatio")?t.samplingRatio:void 0,o=t&&Le(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),o&&this.samplesGenerator.setAllowDuplicates(o)}recalculateAllRowsHeight(){kt(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const t=this.hot.getSettings()[Hf];let e=kf.SYNC_CALCULATION_LIMIT;const o=this.hot.countRows()-1;return Ae(t)&&(e=t.syncLimit,ct(e)?e=on(o,e):e>>=0),Math.min(e,o)}getRowHeight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;const o=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t));let n=e;return null!==o&&o>(e||0)&&(n=o),n}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(t){const{from:e,to:o}="number"===typeof t?{from:t,to:t}:t;this.hot.batchExecution((()=>{tn(Math.min(e,o),Math.max(e,o),(t=>{this.rowHeightsMap.setValueAtIndex(t,null)}))}),!0)}isNeedRecalculate(){return!!H(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(t=>null===t)).length}onBeforeViewRender(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,o=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(-1!==o&&-1!==n){if(this.calculateRowsHeight({from:o,to:n},void 0,t),e){const t=this.hot.countRows()-1;this.calculateRowsHeight({from:t-e,to:t})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}onBeforeRowMove(t,e){this.clearCacheByRange({from:t,to:e}),this.calculateAllRowsHeight()}onBeforeRowResize(t,e,o){let n=t;return o&&(this.calculateRowsHeight(e,void 0,!0),n=this.getRowHeight(e)),n}onAfterLoadData(){this.hot.view?this.recalculateAllRowsHeight():setTimeout((()=>{this.hot&&this.recalculateAllRowsHeight()}),0)}onBeforeChange(t){let e=null;1===t.length?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}destroy(){this.ghostTable.clean(),super.destroy()}}const Nf=new Map([["indexesSequence",{getListWithInsertedItems:gl,getListWithRemovedItems:ml}],["physicallyIndexed",{getListWithInsertedItems:Cl,getListWithRemovedItems:yl}]]),Pf=t=>{if(!1===Nf.has(t))throw new Error(`Alter strategy with ID '${t}' does not exist.`);return Nf.get(t)},{getListWithInsertedItems:_f,getListWithRemovedItems:Df}=Pf("physicallyIndexed");class Lf extends ul{constructor(){super((t=>t))}insert(t,e){const o=pl(this.indexedValues,e);this.indexedValues=_f(o,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){const e=Df(this.indexedValues,t);this.indexedValues=fl(e,t),super.remove(t)}}var Vf=Lf;const{getListWithInsertedItems:Bf,getListWithRemovedItems:Ff}=Pf("physicallyIndexed");class Wf extends ul{constructor(){super((t=>t))}insert(t,e){this.indexedValues=Bf(this.indexedValues,t,e,((t,e)=>this.getNextValue(e))),super.insert(t,e)}remove(t){this.indexedValues=Ff(this.indexedValues,t),super.remove(t)}getNextValue(t){return Math.max(...this.getValues())+1+t}}var jf=Wf;const Uf="bindRowsWithHeaders",zf=210,$f="loose",Gf=new Map([["loose",Vf],["strict",jf]]);class Yf extends hf{static get PLUGIN_KEY(){return Uf}static get PLUGIN_PRIORITY(){return zf}constructor(t){super(t),this.headerIndexes=null}isEnabled(){return!!this.hot.getSettings()[Uf]}enablePlugin(){if(this.enabled)return;let t=this.hot.getSettings()[Uf];"string"!==typeof t&&(t=$f);const e=Gf.get(t);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new e),this.addHook("modifyRowHeader",(t=>this.onModifyRowHeader(t))),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}onModifyRowHeader(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}destroy(){super.destroy()}}function Kf(t,e,o){Xf(t,e),e.set(t,o)}function Xf(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qf(t,e,o){return e=Qf(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Qf(t){var e=Jf(t,"string");return"symbol"===typeof e?e:String(e)}function Jf(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Zf(t,e){var o=op(t,e,"get");return tp(t,o)}function tp(t,e){return e.get?e.get.call(t):e.value}function ep(t,e,o){var n=op(t,e,"set");return np(t,n,o),o}function op(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function np(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}const sp="collapsibleColumns",ip=290,rp=["nestedHeaders"],lp="collapsibleIndicator",ap=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var hp=new WeakMap;class cp extends hf{constructor(){super(...arguments),qf(this,"nestedHeadersPlugin",null),qf(this,"eventManager",new Bo(this)),qf(this,"headerStateManager",null),Kf(this,hp,{writable:!0,value:null})}static get PLUGIN_KEY(){return sp}static get PLUGIN_PRIORITY(){return ip}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[sp,...rp]}isEnabled(){return!!this.hot.getSettings()[sp]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();e||mo("You need to configure the Nested Headers plugin in order to use collapsible headers."),ep(this,hp,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(()=>this.onInit())),this.addHook("afterLoadData",(function(){return t.onAfterLoadData(...arguments)})),this.addHook("afterGetColHeader",(function(){return t.onAfterGetColHeader(...arguments)})),this.addHook("beforeOnCellMouseDown",((t,e,o)=>this.onBeforeOnCellMouseDown(t,e,o))),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:t}=this.hot.getSettings();"boolean"===typeof t?this.headerStateManager.mapState((t=>({collapsible:t.origColspan>1}))):Array.isArray(t)&&(this.headerStateManager.mapState((()=>({collapsible:!1}))),this.headerStateManager.mergeStateWith(t))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),ep(this,hp,null),this.nestedHeadersPlugin=null,this.clearButtons(),super.disablePlugin()}clearButtons(){if(!this.hot.view)return;const t=this.hot.view._wt.getSetting("columnHeaders").length,e=this.hot.view._wt.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(t){t&&t.parentNode.removeChild(t)};tn(0,t-1,(t=>{const i=e.childNodes[t],r=o.childNodes[t],l=n?n.childNodes[t]:null;tn(0,i.childNodes.length-1,(t=>{let e=i.childNodes[t].querySelector(`.${lp}`);s(e),r&&r.childNodes[t]&&(e=r.childNodes[t].querySelector(`.${lp}`),s(e)),n&&l&&l.childNodes[t]&&(e=l.childNodes[t].querySelector(`.${lp}`),s(e))}))}),!0)}expandSection(t){this.toggleCollapsibleSection([t],"expand")}collapseSection(t){this.toggleCollapsibleSection([t],"collapse")}toggleAllCollapsibleSections(t){const e=this.headerStateManager.mapNodes((e=>{const{collapsible:o,origColspan:n,headerLevel:s,columnIndex:i,isCollapsed:r}=e;if(!0===o&&n>1&&(r&&"expand"===t||!r&&"collapse"===t))return{row:this.headerStateManager.levelToRowCoords(s),col:i}}));this.toggleCollapsibleSection(e,t)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(t,e){if(!ap.has(e))throw new Error(`Unsupported action is passed (${e}).`);if(!Array.isArray(t))return;const o=H(t,(t=>{let{row:e}=t;return e<0}));let n=o.length>0;O(o,(t=>{var o;let{row:s,col:i}=t;const{collapsible:r,isCollapsed:l}=null!==(o=this.headerStateManager.getHeaderSettings(s,i))&&void 0!==o?o:{};if(!r||l&&"collapse"===e||!l&&"expand"===e)return n=!1,!1}));const s=[],i=[];n&&O(o,(t=>{let{row:o,col:n}=t;const{colspanCompensation:r,affectedColumns:l,rollbackModification:a}=this.headerStateManager.triggerNodeModification(e,o,n);r>0&&(i.push(...l),s.push(a))}));const r=this.getCollapsedColumns();let l=[];"collapse"===e?l=L([...r,...i]):"expand"===e&&(l=H(r,(t=>!i.includes(t))));const a=ap.get(e),h=this.hot.runHooks(a.beforeHook,r,l,n);if(!1===h)return void O(s,(t=>{t()}));this.hot.batchExecution((()=>{O(i,(t=>{Zf(this,hp).setValueAtIndex(this.hot.toPhysicalColumn(t),a.hideColumn)}))}),!0);const c=this.getCollapsedColumns().length!==r.length;this.hot.runHooks(a.afterHook,r,l,n,c),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return Zf(this,hp).getHiddenIndexes()}onAfterGetColHeader(t,e,o){var n;const{collapsible:s,origColspan:i,isCollapsed:r}=null!==(n=this.headerStateManager.getHeaderSettings(o,t))&&void 0!==n?n:{},l=s&&i>1&&t>=this.hot.getSettings().fixedColumnsStart;let a=e.querySelector(`.${lp}`);var h;l?(a||(a=this.hot.rootDocument.createElement("div"),Mt(a,lp),e.querySelector("div:first-child").appendChild(a)),Tt(a,["collapsed","expanded"]),r?(Mt(a,"collapsed"),Ot(a,"+")):(Mt(a,"expanded"),Ot(a,"-"))):null===(h=a)||void 0===h||h.remove()}onBeforeOnCellMouseDown(t,e){Et(t.target,lp)&&(Et(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Et(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),ho(t))}onInit(){this.updatePlugin()}onAfterLoadData(t,e){e||this.updatePlugin()}destroy(){ep(this,hp,null),super.destroy()}}const dp=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],up=!1,gp=!0,mp=!0;class fp{constructor(t,e){this.hot=t,this.sortingStates=new Ml,this.sortEmptyCells=up,this.indicator=gp,this.headerAction=mp,this.compareFunctionFactory=void 0,this.mapName=e,this.hot.columnIndexMapper.registerMap(e,this.sortingStates)}updateAllColumnsProperties(t){Ae(t)&&ke(t,((t,e)=>{dp.includes(e)&&(this[e]=t)}))}getAllColumnsProperties(){const t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"===typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}getSortOrderOfColumn(t){var e;return null===(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))||void 0===e?void 0:e.sortOrder}getIndexOfColumnInSortQueue(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex((e=>{let[o]=e;return o===t}))}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(t){return Ae(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))}getSortStates(){if(null===this.sortingStates)return[];const t=this.sortingStates.getEntries();return t.map((t=>{let[e,o]=t;return{column:this.hot.toVisualColumn(e),...o}}))}getColumnSortState(t){const e=this.getSortOrderOfColumn(t);if(z(e))return{column:t,sortOrder:e}}setSortStates(t){this.sortingStates.clear();for(let e=0;e<t.length;e+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[e].column),{sortOrder:t[e].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const pp="asc",wp="desc",Cp="colHeader";function yp(t){if(!1===Ae(t))return!1;const{column:e,sortOrder:o}=t;return Number.isInteger(e)&&[pp,wp].includes(o)}function vp(t){if(t.some((t=>!1===yp(t))))return!1;const e=t.map((t=>{let{column:e}=t;return e}));return new Set(e).size===e.length}function bp(t){if(t!==wp)return t===pp?wp:pp}function Sp(t){const e=t.querySelector(`.${Cp}`);return e}function Rp(t,e){if(t<0||!e.parentNode)return!1;const o=e.parentNode.parentNode.childNodes,n=Array.from(o).indexOf(e.parentNode)-o.length;return-1===n}function Ep(t,e,o){return-1===t&&e>=0&&!1===uo(o)}const Mp="ascending",Tp="descending",xp="indicatorDisabled",Ip="columnSorting",Hp="sortAction",Ap=new Map([[pp,Mp],[wp,Tp]]);function Op(t,e,o,n){const s=[Ip];if(n&&s.push(Hp),!1===o)return s.push(xp),s;const i=t.getSortOrderOfColumn(e);return z(i)&&s.push(Ap.get(i)),s}function kp(){return Array.from(Ap.values()).concat(Hp,xp,Ip)}const Np=0,Pp=-1,_p=1;function Dp(t,e){const o=Xp(e);for(var n=arguments.length,s=new Array(n>2?n-2:0),i=2;i<n;i++)s[i-2]=arguments[i];t.sort(o(...s))}function Lp(t,e,o){const n=e.locale;return function(e,s){const{sortEmptyCells:i}=o;return"string"===typeof e&&(e=e.toLocaleLowerCase(n)),"string"===typeof s&&(s=s.toLocaleLowerCase(n)),e===s?Np:G(e)?G(s)?Np:i&&"asc"===t?Pp:_p:G(s)?i&&"asc"===t?_p:Pp:isNaN(e)&&!isNaN(s)?"asc"===t?_p:Pp:!isNaN(e)&&isNaN(s)?"asc"===t?Pp:_p:(isNaN(e)||isNaN(s)||(e=parseFloat(e),s=parseFloat(s)),e<s?"asc"===t?Pp:_p:e>s?"asc"===t?_p:Pp:Np)}}const Vp="default";function Bp(t,e,o){return function(e,n){const s=parseFloat(e),i=parseFloat(n),{sortEmptyCells:r}=o;if(s===i||isNaN(s)&&isNaN(i))return Np;if(r){if(G(e))return"asc"===t?Pp:_p;if(G(n))return"asc"===t?_p:Pp}return isNaN(s)?_p:isNaN(i)?Pp:s<i?"asc"===t?Pp:_p:s>i?"asc"===t?_p:Pp:Np}}const Fp="numeric";function Wp(t,e,o){const n=e.checkedTemplate,s=e.uncheckedTemplate,{sortEmptyCells:i}=o;return function(r,l){const a=G(r),h=G(l),c=a?s:r,d=h?s:l,u=c===s||c===n,g=d===s||d===n;if(!1===i){if(a&&!1===h)return _p;if(!1===a&&h)return Pp}return!1===u&&g?"asc"===t?Pp:_p:u&&!1===g?"asc"===t?_p:Pp:!1===u&&!1===g?Lp(t,e,o)(r,l):c===s&&d===n?"asc"===t?Pp:_p:c===n&&d===s?"asc"===t?_p:Pp:Np}}const jp="checkbox";function Up(t,e,o){return function(n,s){const{sortEmptyCells:i}=o;if(n===s)return Np;if(G(n))return G(s)?Np:i&&"asc"===t?Pp:_p;if(G(s))return i&&"asc"===t?_p:Pp;const r=e.dateFormat,l=E(n,r),a=E(s,r);return l.isValid()?a.isValid()?a.isAfter(l)?"asc"===t?Pp:_p:a.isBefore(l)?"asc"===t?_p:Pp:Np:Pp:_p}}const zp="date",{register:$p,getItem:Gp,hasItem:Yp}=Mo("sorting.compareFunctionFactory"),{register:Kp,getItem:Xp}=Mo("sorting.mainSortComparator");function qp(t){return Yp(t)?Gp(t):Gp(Vp)}function Qp(t,e){return function(o,n){const[,...s]=o,[,...i]=n;return function(o){const n=t[o],r=e[o],l=s[o],a=i[o],h=r.columnSorting,c=h.compareFunctionFactory?h.compareFunctionFactory:qp(r.type),d=c(n,r,h)(l,a);return d}(0)}}$p(Fp,Bp),$p(jp,Wp),$p(zp,Up),$p(Vp,Lp);const Jp="columnSorting",Zp=50,tw="append",ew="replace";Kp(Jp,Qp),Ro.getSingleton().register("beforeColumnSort"),Ro.getSingleton().register("afterColumnSort");class ow extends hf{static get PLUGIN_KEY(){return Jp}static get PLUGIN_PRIORITY(){return Zp}constructor(t){super(t),this.columnStatesManager=null,this.columnMetaCache=null,this.pluginKey=Jp,this.indexesSequenceCache=null}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var t=this;this.enabled||(this.columnStatesManager=new fp(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new vl((t=>{let e=this.hot.toVisualColumn(t);return null===e&&(e=t),this.getMergedPluginSettings(e)})),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",((t,e)=>this.onAfterGetColHeader(t,e))),this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown(...arguments)})),this.addHook("afterOnCellMouseDown",((t,e)=>this.onAfterOnCellMouseDown(t,e))),this.addHook("afterInit",(()=>this.loadOrSortBySettings())),this.addHook("afterLoadData",(function(){return t.onAfterLoadData(...arguments)})),this.hot.view&&this.loadOrSortBySettings(),super.enablePlugin())}disablePlugin(){const t=(t,e)=>{const o=Sp(e);!1!==Rp(t,e)&&null!==o&&this.updateHeaderClasses(o)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("afterGetColHeader",t)})),this.hot.batchExecution((()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))}),!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,super.disablePlugin()}sort(t){const e=this.getSortConfig(),o=this.getNormalizedSortConfigs(t),n=this.areValidSortConfigs(o),s=this.hot.runHooks("beforeColumnSort",e,o,n);!1!==s&&(0===e.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new wl),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),n&&(this.columnStatesManager.setSortStates(o),this.sortByPresetSortStates(o),this.saveAllSortSettings(o)),this.hot.runHooks("afterColumnSort",e,n?o:e,n),n&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(t){return z(t)?this.columnStatesManager.getColumnSortState(t):this.columnStatesManager.getSortStates()}setSortConfig(t){const e=this.getNormalizedSortConfigs(t);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t]}areValidSortConfigs(t){const e=this.hot.countCols();return vp(t)&&t.every((t=>{let{column:o}=t;return o<=e&&o>=0}))}saveAllSortSettings(t){const e=this.columnStatesManager.getAllColumnsProperties(),o=t=>{let{column:e,...o}=t;return{column:this.hot.toPhysicalColumn(e),...o}};e.initialConfig=A(t,o),this.hot.runHooks("persistentStateSave","columnSorting",e)}getAllSavedSortSettings(){const t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);const e=t.value,o=t=>{let{column:e,...o}=t;return{column:this.hot.toVisualColumn(e),...o}};return z(e)&&Array.isArray(e.initialConfig)&&(e.initialConfig=A(e.initialConfig,o)),e}getColumnNextConfig(t){const e=this.columnStatesManager.getSortOrderOfColumn(t);if(z(e)){const o=bp(e);return z(o)?{column:t,sortOrder:o}:void 0}const o=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<o)return{column:t,sortOrder:bp()}}getNextSortConfig(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tw;const o=this.columnStatesManager.getIndexOfColumnInSortQueue(t),n=-1!==o,s=this.getSortConfig(),i=this.getColumnNextConfig(t);if(n){if($(i))return[...s.slice(0,o),...s.slice(o+1)];if(e===tw)return[...s.slice(0,o),...s.slice(o+1),i];if(e===ew)return[...s.slice(0,o),i,...s.slice(o+1)]}return z(i)?s.concat(i):s}getPluginColumnConfig(t){if(Ae(t)){const e=t[this.pluginKey];if(Ae(e))return e}return{}}getMergedPluginSettings(t){const e=this.hot.getSettings()[this.pluginKey],o=this.columnStatesManager.getAllColumnsProperties(),n=this.hot.getCellMeta(0,t),s=Object.getPrototypeOf(n);return Array.isArray(s.columns)?Object.assign(o,e,this.getPluginColumnConfig(s.columns[t])):ge(s.columns)?Object.assign(o,e,this.getPluginColumnConfig(s.columns(t))):Object.assign(o,e)}getFirstCellSettings(t){const e=this.hot.getCellMeta(0,t),o=Object.create(e);return o[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(t)),o}getNumberOfRowsToSort(t){const e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}sortByPresetSortStates(t){if(0===t.length)return void this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());const e=[],o=this.hot.countRows(),n=e=>A(t,(t=>this.hot.getDataAtCell(e,t.column)));for(let a=0;a<this.getNumberOfRowsToSort(o);a+=1)e.push([this.hot.toPhysicalRow(a)].concat(n(a)));const s=A(e,(t=>t[0]));Dp(e,this.pluginKey,A(t,(t=>t.sortOrder)),A(t,(t=>this.getFirstCellSettings(t.column))));for(let a=e.length;a<o;a+=1)e.push([a].concat(n(a)));const i=A(e,(t=>t[0])),r=new Map(A(s,((t,e)=>[t,i[e]]))),l=A(this.hot.rowIndexMapper.getIndexesSequence(),(t=>r.has(t)?r.get(t):t));this.hot.rowIndexMapper.setIndexesSequence(l)}loadOrSortBySettings(){const t=this.getAllSavedSortSettings();if(Ae(t))this.sortBySettings(t);else{const t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}sortBySettings(t){if(Ae(t)){this.columnStatesManager.updateAllColumnsProperties(t);const e=t.initialConfig;(Array.isArray(e)||Ae(e))&&this.sort(e)}else this.hot.render()}onAfterGetColHeader(t,e){const o=Sp(e);if(!1===Rp(t,e)||null===o)return;const n=this.getFirstCellSettings(t)[this.pluginKey],s=n.indicator,i=n.headerAction;this.updateHeaderClasses(o,this.columnStatesManager,t,s,i)}updateHeaderClasses(t){if(Tt(t,kp(t)),!1!==this.enabled){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];Mt(t,Op(...o))}}onUpdateSettings(t){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),z(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}onAfterLoadData(t){!0===t&&this.hot.view&&this.loadOrSortBySettings()}wasClickableHeaderClicked(t,e){const o=this.getFirstCellSettings(e)[this.pluginKey],n=o.headerAction;return n&&"SPAN"===t.target.nodeName}onBeforeOnCellMouseDown(t,e,o,n){!1!==Ep(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(n.column=!0)}onAfterOnCellMouseDown(t,e){!1!==Ep(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col)),this.sort(this.getColumnNextConfig(e.col)))}destroy(){var t;null===(t=this.columnStatesManager)||void 0===t||t.destroy(),super.destroy()}}class nw{constructor(t,e){this.plugin=t,this.hot=this.plugin.hot,this.endpoints=[],this.settings=e,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}getEndpoint(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(t){return this.parseSettings(t.call(this))}parseSettings(t){const e=[];let o=t;if(o||"function"!==typeof this.settings)return o||(o=this.settings),O(o,(t=>{const o={};this.assignSetting(t,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(t,o,"reversedRowCoords",!1),this.assignSetting(t,o,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,o,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,o,"sourceColumn",t.destinationColumn),this.assignSetting(t,o,"type","sum"),this.assignSetting(t,o,"forceNumeric",!1),this.assignSetting(t,o,"suppressDataTypeErrors",!0),this.assignSetting(t,o,"suppressDataTypeErrors",!0),this.assignSetting(t,o,"customFunction",null),this.assignSetting(t,o,"readOnly",!0),this.assignSetting(t,o,"roundFloat",!1),e.push(o)})),e;this.settingsType="function"}assignSetting(t,e,o,n){if("ranges"!==o||void 0!==t[o]){if("ranges"!==o||0!==t[o].length)if(void 0===t[o]){if(n instanceof Error)throw n;e[o]=n}else"destinationRow"===o&&e.reversedRowCoords?e[o]=this.hot.countRows()-t[o]-1:e[o]=t[o]}else e[o]=n}resetSetupBeforeStructureAlteration(t,e,o){if("function"!==this.settingsType)return;const n=t.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();O(s,(s=>{"row"===n&&s.destinationRow>=e&&("insert_row"===t?s.alterRowOffset=o:"remove_row"===t&&(s.alterRowOffset=-1*o)),"col"===n&&s.destinationColumn>=e&&("insert_col"===t?s.alterColumnOffset=o:"remove_col"===t&&(s.alterColumnOffset=-1*o))})),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(t,e,o,n,s){let i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const t=()=>(this.hot.removeHook("beforeViewRender",t),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",t)}const r=t.indexOf("row")>-1?"row":"col",l=t.indexOf("remove")>-1?-1:1,a=this.getAllEndpoints(),h=0===t.indexOf("move_row"),c=e;O(a,(t=>{"row"===r&&t.destinationRow>=c&&(t.alterRowOffset=l*o),"col"===r&&t.destinationColumn>=c&&(t.alterColumnOffset=l*o)})),this.resetAllEndpoints(a,!h),O(a,h?t=>{this.extendEndpointRanges(t,c,n[0],n.length),this.recreatePhysicalRanges(t),this.clearOffsetInformation(t)}:t=>{this.shiftEndpointCoordinates(t,c)}),i&&this.refreshAllEndpoints()}clearOffsetInformation(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}extendEndpointRanges(t,e,o,n){O(t.ranges,(t=>{t[1]&&(e>=t[0]&&e<=t[1]?o>t[1]?t[1]+=n:o<t[0]&&(t[0]-=n):o>=t[0]&&o<=t[1]&&(t[1]-=n,e<=t[0]&&(t[0]+=1,t[1]+=1)))}))}recreatePhysicalRanges(t){const e=t.ranges,o=[],n=[];O(e,(t=>{const e=[];if(t[1])for(let o=t[0];o<=t[1];o++)e.push(this.hot.toPhysicalRow(o));else e.push(this.hot.toPhysicalRow(t[0]));n.push(e)})),O(n,(t=>{let e=[];O(t,((n,s)=>{0===s?e.push(n):t[s]!==t[s-1]+1&&(e.push(t[s-1]),o.push(e),e=[],e.push(n)),s===t.length-1&&(e.push(n),o.push(e))}))})),t.ranges=o}shiftEndpointCoordinates(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,O(t.ranges,(o=>{O(o,((n,s)=>{n>=e&&(o[s]+=t.alterRowOffset||0)}))}))):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}resetAllEndpoints(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const o=t.some((t=>{const e=t.alterRowOffset||0,o=t.alterColumnOffset||0;return t.destinationRow+e>=this.hot.countRows()||t.destinationColumn+o>=this.hot.countCols()}));o||(this.cellsToSetCache=[],O(t,(t=>{this.resetEndpointValue(t,e)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],O(this.getAllEndpoints(),(t=>{this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(t){const e=[];this.cellsToSetCache=[],O(t,((t,o,n)=>{`${t[2]||""}`!==`${t[3]}`&&O(this.getAllEndpoints(),((t,s)=>{this.hot.propToCol(n[o][1])===t.sourceColumn&&-1===e.indexOf(s)&&e.push(s)}))})),O(e,(t=>{this.refreshEndpoint(this.getEndpoint(t))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}resetEndpointValue(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const o=t.alterRowOffset||0,n=t.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(t.destinationRow+(e?o:0)),this.hot.toVisualColumn(t.destinationColumn+(e?n:0)),""])}setEndpointValue(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const s=this.hot.toVisualRow(t.destinationRow);if(null!==s){const o=this.hot.getCellMeta(s,t.destinationColumn);"init"!==e&&o.readOnly===t.readOnly||(o.readOnly=t.readOnly,o.className="columnSummaryResult")}t.roundFloat&&!isNaN(t.result)&&(t.result=t.result.toFixed(t.roundFloat)),o?this.hot.setDataAtCell(n,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([n,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}throwOutOfBoundsWarning(){mo("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}var sw=nw;function iw(t){return null===t||void 0===t||isNaN(t)}const rw="columnSummary",lw=220;class aw extends hf{static get PLUGIN_KEY(){return rw}static get PLUGIN_PRIORITY(){return lw}constructor(t){super(t),this.endpoints=null}isEnabled(){return!!this.hot.getSettings()[rw]}enablePlugin(){var t=this;this.enabled||(this.settings=this.hot.getSettings()[rw],this.endpoints=new sw(this,this.settings),this.addHook("afterInit",(function(){return t.onAfterInit(...arguments)})),this.addHook("afterChange",(function(){return t.onAfterChange(...arguments)})),this.addHook("beforeCreateRow",((t,e,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,e,null,o))),this.addHook("beforeCreateCol",((t,e,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,e,null,o))),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupBeforeStructureAlteration("remove_row",...o)})),this.addHook("beforeRemoveCol",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupBeforeStructureAlteration("remove_col",...o)})),this.addHook("afterCreateRow",((t,e,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,e,null,o))),this.addHook("afterCreateCol",((t,e,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,e,null,o))),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupAfterStructureAlteration("remove_row",...o)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.endpoints.resetSetupAfterStructureAlteration("remove_col",...o)})),this.addHook("afterRowMove",(function(){return t.onAfterRowMove(...arguments)})),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":t.result=this.calculateMinMax(t,t.type);break;case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t);break;default:break}}calculateSum(t){let e=0;return ke(t.ranges,(o=>{e+=this.getPartialSum(o,t.sourceColumn)})),e}getPartialSum(t,e){let o=0,n=t[1]||t[0],s=null,i=0;do{if(s=this.getCellValue(n,e),s=iw(s)?null:s,null!==s){const t=(`${s}`.split(".")[1]||[]).length||1;t>i&&(i=t)}o+=s||0,n-=1}while(n>=t[0]);return Math.round(o*10**i)/10**i}calculateMinMax(t,e){let o=null;return ke(t.ranges,(n=>{const s=this.getPartialMinMax(n,t.sourceColumn,e);if(null===o&&null!==s&&(o=s),null!==s)switch(e){case"min":o=Math.min(o,s);break;case"max":o=Math.max(o,s);break;default:break}})),null===o?"Not enough data":o}getPartialMinMax(t,e,o){let n,s=null,i=t[1]||t[0];do{if(n=this.getCellValue(i,e),n=iw(n)?null:n,null===s)s=n;else if(null!==n)switch(o){case"min":s=Math.min(s,n);break;case"max":s=Math.max(s,n);break;default:break}i-=1}while(i>=t[0]);return s}countEmpty(t,e){let o,n=0,s=t[1]||t[0];do{o=this.getCellValue(s,e),o=iw(o)?null:o,null===o&&(n+=1),s-=1}while(s>=t[0]);return n}countEntries(t){let e=0;const o=t.ranges;return ke(o,(o=>{const n=void 0===o[1]?1:o[1]-o[0]+1,s=this.countEmpty(o,t.sourceColumn);e+=n,e-=s})),e}calculateAverage(t){const e=this.calculateSum(t),o=this.countEntries(t);return e/o}getCellValue(t,e){const o=this.hot.toVisualRow(t),n=this.hot.toVisualColumn(e);let s=this.hot.getSourceDataAtCell(t,e),i="";if(null!==o&&null!==n&&(i=this.hot.getCellMeta(o,n).className||""),i.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"===typeof s&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(j`ColumnSummary plugin: cell at (${t}, ${e}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}onAfterInit(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}onAfterChange(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}onAfterRowMove(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}}class hw{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(t,e){this.rootDocument=t,this.isRtl=e,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}setPosition(t,e){this.editorStyle.left=`${t}px`,this.editorStyle.top=`${e}px`}setSize(t,e){if(t&&e){const o=this.getInputElement();o.style.width=`${t}px`,o.style.height=`${e}px`}}getSize(){return{width:Ut(this.getInputElement()),height:zt(this.getInputElement())}}resetSize(){const t=this.getInputElement();t.style.width="",t.style.height=""}setReadOnlyState(t){const e=this.getInputElement();e.readOnly=t}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return"block"===this.editorStyle.display}setValue(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const e=t||"";this.getInputElement().value=e}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const t=this.rootDocument.createElement("div"),e=this.rootDocument.createElement("textarea");return t.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Mt(this.container,hw.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Mt(t,hw.CLASS_EDITOR),Mt(e,hw.CLASS_INPUT),t.appendChild(e),this.container.appendChild(t),t}getInputElement(){return this.editor.querySelector(`.${hw.CLASS_INPUT}`)}destroy(){const t=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,t&&t.removeChild(this.container)}}var cw=hw;const dw="---------";function uw(){return{name:dw}}function gw(t){return A(t,(t=>({start:t.getTopStartCorner(),end:t.getBottomEndCorner()})))}function mw(t){return Et(t,"htSeparator")}function fw(t){return Et(t,"htSubmenu")}function pw(t){return Et(t,"htDisabled")}function ww(t){return Et(t,"htSelectionDisabled")}function Cw(t){const e=t.getSelected();return e?e[0]<0?null:e:null}function yw(t,e){if(-1!==t.indexOf(e))return t;const o=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return`${o} ${e}`}function vw(t,e){if(-1!==t.indexOf(e))return t;const o=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return`${o} ${e}`}function bw(t,e){const o={};return O(t,(t=>{t.forAll(((t,n)=>{t>=0&&n>=0&&(o[t]||(o[t]=[]),o[t][n]=e(t,n))}))})),o}function Sw(t,e,o,n,s){O(t,(t=>{t.forAll(((t,i)=>{t>=0&&i>=0&&Rw(t,i,e,o,n,s)}))}))}function Rw(t,e,o,n,s,i){const r=s(t,e);let l=n;r.className&&(l="vertical"===o?yw(r.className,n):vw(r.className,n)),i(t,e,"className",l)}function Ew(t,e){let o=!1;return Array.isArray(t)&&O(t,(t=>(t.forAll(((t,n)=>{if(t>=0&&n>=0&&e(t,n))return o=!0,!1})),o))),o}function Mw(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function Tw(t,e){return!t.hidden||!("function"===typeof t.hidden&&t.hidden.call(e))}function xw(t,e){const o=t.slice(0);for(let n=0;n<o.length;){if(o[n].name!==e)break;o.shift()}return o}function Iw(t,e){let o=t.slice(0);return o.reverse(),o=xw(o,e),o.reverse(),o}function Hw(t){const e=[];return O(t,((t,o)=>{o>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)})),e}function Aw(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dw,o=t.slice(0);return o=xw(o,e),o=Iw(o,e),o=Hw(o),o}const Ow=250,kw=250;class Nw{constructor(t){this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(t)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout((()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")}),kw)}show(t){this.wasLastActionShow=!0,this.showDebounced(t)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ow;this.showDebounced=pe((t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)}),t)}destroy(){this.clearLocalHooks()}}Ie(Nw,dl);var Pw=Nw;const _w="comments",Dw=60,Lw=new WeakMap,Vw="comment",Bw="value",Fw="style",Ww="readOnly";class jw extends hf{static get PLUGIN_KEY(){return _w}static get PLUGIN_PRIORITY(){return Dw}constructor(t){super(t),this.editor=null,this.displaySwitch=null,this.eventManager=null,this.range={},this.preventEditorAutoSwitch=!1,Lw.set(this,{tempEditorDimensions:{},cellBelowCursor:null})}isEnabled(){return!!this.hot.getSettings()[_w]}enablePlugin(){this.enabled||(this.editor||(this.editor=new cw(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Bo(this)),this.displaySwitch||(this.displaySwitch=new Pw(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(t=>this.addToContextMenu(t))),this.addHook("afterRenderer",((t,e,o,n,s,i)=>this.onAfterRenderer(t,i))),this.addHook("afterScrollHorizontally",(()=>this.hide())),this.addHook("afterScrollVertically",(()=>this.hide())),this.addHook("afterBeginEditing",(()=>this.hide())),this.displaySwitch.addLocalHook("hide",(()=>this.hide())),this.displaySwitch.addLocalHook("show",((t,e)=>this.showAtCell(t,e))),this.registerListeners(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin(),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}disablePlugin(){super.disablePlugin()}registerListeners(){const{rootDocument:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",(t=>this.onMouseOver(t))),this.eventManager.addEventListener(t,"mousedown",(t=>this.onMouseDown(t))),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp())),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",(()=>this.onEditorBlur())),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",(t=>this.onEditorMouseDown(t))),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",(t=>this.onEditorMouseUp(t)))}setRange(t){this.range=t}clearRange(){this.range={}}targetIsCellWithComment(t){const e=Ct(t.target,"TD","TBODY");return!!(e&&Et(e,"htCommentCell")&&Ct(e,[this.hot.rootElement]))}targetIsCommentTextArea(t){return this.editor.getInputElement()===t.target}setComment(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const e=this.editor.getValue();let o="";null!==t&&void 0!==t?o=t:null!==e&&void 0!==e&&(o=e);const n=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(n,s,{[Bw]:o}),this.hot.render()}setCommentAtCell(t,e,o){this.setRange({from:this.hot._createCellCoords(t,e)}),this.setComment(o)}removeComment(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Vw),t&&this.hot.render(),this.hide()}removeCommentAtCell(t,e){let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(t,e)}),this.removeComment(o)}getComment(){const t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,Bw)}getCommentAtCell(t,e){return this.getCommentMeta(t,e,Bw)}show(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:e}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||e<0||e>this.hot.countSourceCols()-1)return!1;const o=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(o[Vw]?o[Vw][Bw]:""),this.editor.show(),this.refreshEditor(!0),!0}showAtCell(t,e){return this.setRange({from:this.hot._createCellCoords(t,e)}),this.show()}hide(){this.editor.hide()}refreshEditor(){var t,e;let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!o&&(!this.range.from||!this.editor.isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:s}=this.hot,{row:i,col:r}=this.range.from;let l=n.getRenderableFromVisualIndex(i),a=s.getRenderableFromVisualIndex(r);const h=null===l;this.editor.setPosition(0,0),null===l&&(l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),null===a&&(a=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(r,-1)));const c=null===l,d=null===a;l=null!==(t=l)&&void 0!==t?t:0,a=null!==(e=a)&&void 0!==e?e:0;const{rootWindow:u,view:{_wt:g}}=this.hot,{wtTable:m}=g,f=g.getCell({row:l,col:a},!0),p=this.getCommentMeta(i,r,Fw);p?this.editor.setSize(p.width,p.height):this.editor.resetSize();const w=d?0:m.getStretchedColumnWidth(a),C=h&&!c?zt(f):0,{left:y,top:v,width:b,height:S}=f.getBoundingClientRect(),{width:R,height:E}=this.editor.getSize(),{innerWidth:M,innerHeight:T}=this.hot.rootWindow,x=this.hot.rootDocument.documentElement;let I=y+u.scrollX+w,H=v+u.scrollY+C;this.hot.isRtl()&&(I-=R+w),this.hot.isLtr()&&y+b+R>M?I=y+u.scrollX-R-1:this.hot.isRtl()&&I<-(x.scrollWidth-x.clientWidth)&&(I=y+u.scrollX+w+1),v+E>T&&(H-=E-S+1),this.editor.setPosition(I,H),this.editor.setReadOnlyState(this.getCommentMeta(i,r,Ww))}checkSelectionCommentsConsistency(){const t=this.hot.getSelectedRangeLast();if(!t)return!1;let e=!1;const o=t.getTopStartCorner();return this.getCommentMeta(o.row,o.col,Bw)&&(e=!0),e}updateCommentMeta(t,e,o){const n=this.hot.getCellMeta(t,e)[Vw];let s;n?(s=Te(n),Me(s,o)):s=o,this.hot.setCellMeta(t,e,Vw,s)}getCommentMeta(t,e,o){const n=this.hot.getCellMeta(t,e);if(n[Vw])return n[Vw][o]}onMouseDown(t){if(this.hot.view&&this.hot.view._wt&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(t)){const e=Ct(t.target,"TD","TBODY");let o=null;e&&(o=this.hot.getCoords(e)),(!e||this.range.from&&o&&(this.range.from.row!==o.row||this.range.from.col!==o.col))&&this.hide()}}onMouseOver(t){const e=Lw.get(this),{rootDocument:o}=this.hot;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Et(t.target,"wtBorder")||e.cellBelowCursor===t.target)&&this.editor)if(e.cellBelowCursor=o.elementFromPoint(t.clientX,t.clientY),this.targetIsCellWithComment(t)){const e=this.hot._createCellRange(this.hot.getCoords(t.target));this.displaySwitch.show(e)}else vt(t.target,o)&&!this.targetIsCommentTextArea(t)&&this.displaySwitch.hide()}onMouseUp(){this.preventEditorAutoSwitch=!1}onAfterRenderer(t,e){e[Vw]&&e[Vw][Bw]&&Mt(t,e.commentedCellClassName)}onEditorBlur(){this.setComment()}onEditorMouseDown(t){const e=Lw.get(this);e.tempEditorDimensions={width:Ut(t.target),height:zt(t.target)}}onEditorMouseUp(t){const e=Lw.get(this),o=Ut(t.target),n=zt(t.target);o===e.tempEditorDimensions.width+1&&n===e.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,{[Fw]:{width:o,height:n}})}onContextMenuAddComment(){const t=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:t.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}onContextMenuRemoveComment(){const t=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,t.forAll(((t,e)=>{t>=0&&e>=0&&this.removeCommentAtCell(t,e,!1)})),this.hot.render()}onContextMenuMakeReadOnly(){const t=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,t.forAll(((t,e)=>{if(t>=0&&e>=0){const o=!!this.getCommentMeta(t,e,Ww);this.updateCommentMeta(t,e,{[Ww]:!o})}}))}addToContextMenu(t){const e=()=>this.hot.rowIndexMapper.getRenderableIndexesLength()>0&&this.hot.columnIndexMapper.getRenderableIndexesLength()>0;t.items.push({name:"---------"},{key:"commentsAddEdit",name:()=>this.checkSelectionCommentsConsistency()?this.hot.getTranslatedPhrase(Pa):this.hot.getTranslatedPhrase(Na),callback:()=>this.onContextMenuAddComment(),disabled:()=>!e()||!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner())},{key:"commentsRemove",name(){return this.getTranslatedPhrase(_a)},callback:()=>this.onContextMenuRemoveComment(),disabled:()=>!e()||!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner())},{key:"commentsReadOnly",name(){let t=this.getTranslatedPhrase(Da);const e=Ew(this.getSelectedRangeLast(),((t,e)=>{let o=this.getCellMeta(t,e)[Vw];if(o&&(o=o[Ww]),o)return!0}));return e&&(t=Mw(t)),t},callback:()=>this.onContextMenuMakeReadOnly(),disabled:()=>!e()||(!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner())||!this.checkSelectionCommentsConsistency())})}getDisplayDelaySetting(){const t=this.hot.getSettings()[_w];if(Ae(t))return t.displayDelay}destroy(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),super.destroy()}}o(7754);class Uw{constructor(t){this.hot=t,this.commands={},this.commonCallback=null}registerCommand(t,e){this.commands[t]=e}setCommonCallback(t){this.commonCallback=t}execute(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];const s=t.split(":"),i=s[0],r=2===s.length?s[1]:null;let l=this.commands[i];if(!l)throw new Error(`Menu command '${i}' not exists.`);if(r&&l.submenu&&(l=zw(r,l.submenu.items)),!0===l.disabled)return;if("function"===typeof l.disabled&&!0===l.disabled.call(this.hot))return;if(Le(l,"submenu"))return;const a=[];"function"===typeof l.callback&&a.push(l.callback),"function"===typeof this.commonCallback&&a.push(this.commonCallback),o.unshift(s.join(":")),O(a,(t=>t.apply(this.hot,o)))}}function zw(t,e){let o;return O(e,(e=>{const n=e.key?e.key.split(":"):null;if(Array.isArray(n)&&n[1]===t)return o=e,!1})),o}var $w=Uw;const Gw="alignment";function Yw(){return{key:Gw,name(){return this.getTranslatedPhrase(La)},disabled(){return 0===this.countRows()||0===this.countCols()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Gw}:left`,name(){let t=this.getTranslatedPhrase(Va);const e=Ew(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htLeft"))return!0}));return e&&(t=Mw(t)),t},callback(){const t=this.getSelectedRange(),e=bw(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,o,n),Sw(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${Gw}:center`,name(){let t=this.getTranslatedPhrase(Ba);const e=Ew(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htCenter"))return!0}));return e&&(t=Mw(t)),t},callback(){const t=this.getSelectedRange(),e=bw(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,o,n),Sw(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${Gw}:right`,name(){let t=this.getTranslatedPhrase(Fa);const e=Ew(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htRight"))return!0}));return e&&(t=Mw(t)),t},callback(){const t=this.getSelectedRange(),e=bw(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,o,n),Sw(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${Gw}:justify`,name(){let t=this.getTranslatedPhrase(Wa);const e=Ew(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htJustify"))return!0}));return e&&(t=Mw(t)),t},callback(){const t=this.getSelectedRange(),e=bw(t,((t,e)=>this.getCellMeta(t,e).className)),o="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,o,n),Sw(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{name:dw},{key:`${Gw}:top`,name(){let t=this.getTranslatedPhrase(ja);const e=Ew(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htTop"))return!0}));return e&&(t=Mw(t)),t},callback(){const t=this.getSelectedRange(),e=bw(t,((t,e)=>this.getCellMeta(t,e).className)),o="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,o,n),Sw(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${Gw}:middle`,name(){let t=this.getTranslatedPhrase(Ua);const e=Ew(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htMiddle"))return!0}));return e&&(t=Mw(t)),t},callback(){const t=this.getSelectedRange(),e=bw(t,((t,e)=>this.getCellMeta(t,e).className)),o="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,o,n),Sw(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1},{key:`${Gw}:bottom`,name(){let t=this.getTranslatedPhrase(za);const e=Ew(this.getSelectedRange(),((t,e)=>{const o=this.getCellMeta(t,e).className;if(o&&-1!==o.indexOf("htBottom"))return!0}));return e&&(t=Mw(t)),t},callback(){const t=this.getSelectedRange(),e=bw(t,((t,e)=>this.getCellMeta(t,e).className)),o="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,o,n),Sw(t,o,n,((t,e)=>this.getCellMeta(t,e)),((t,e,o,n)=>this.setCellMeta(t,e,o,n))),this.render()},disabled:!1}]}}}const Kw="clear_column";function Xw(){return{key:Kw,name(){return this.getTranslatedPhrase(Ra)},callback(t,e){const o=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,o,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=Cw(this);return!t||!this.selection.isSelectedByColumnHeader()}}}const qw="col_left";function Qw(){return{key:qw,name(){return this.getTranslatedPhrase(pa)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=Cw(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){const t=this.countCols();return 0===t}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Jw="col_right";function Zw(){return{key:Jw,name(){return this.getTranslatedPhrase(wa)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=Cw(this);return!t||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const tC="make_read_only";function eC(){return{key:tC,name(){let t=this.getTranslatedPhrase(Sa);const e=Ew(this.getSelectedRange(),((t,e)=>this.getCellMeta(t,e).readOnly));return e&&(t=Mw(t)),t},callback(){const t=this.getSelectedRange(),e=Ew(t,((t,e)=>this.getCellMeta(t,e).readOnly));O(t,(t=>{t.forAll(((t,o)=>{t>=0&&o>=0&&this.setCellMeta(t,o,"readOnly",!e)}))})),this.render()},disabled(){return!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))}}}const oC="redo";function nC(){return{key:oC,name(){return this.getTranslatedPhrase(ba)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const sC="remove_col";function iC(){return{key:sC,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,o,,n]=t[0];o-n!==0&&(e=1)}return this.getTranslatedPhrase(ya,e)},callback(){this.alter("remove_col",Gc(this.getSelected()),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=Cw(this);if(!t)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}}const rC="remove_row";function lC(){return{key:rC,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[o,,n]=t[0];o-n!==0&&(e=1)}return this.getTranslatedPhrase(Ca,e)},callback(){this.alter("remove_row",Yc(this.getSelected()),1,"ContextMenu.removeRow")},disabled(){const t=Cw(this);if(!t)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden(){return!this.getSettings().allowRemoveRow}}}const aC="row_above";function hC(){return{key:aC,name(){return this.getTranslatedPhrase(ma)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=Cw(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){const t=this.countRows();return 0===t}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const cC="row_below";function dC(){return{key:cC,name(){return this.getTranslatedPhrase(fa)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=Cw(this);return!t||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const uC="no_items";function gC(){return{key:uC,name(){return this.getTranslatedPhrase(ga)},disabled:!0,isCommand:!1}}const mC="undo";function fC(){return{key:mC,name(){return this.getTranslatedPhrase(va)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const pC=[aC,cC,qw,Jw,Kw,rC,sC,mC,oC,tC,Gw,dw,uC],wC={[dw]:uw,[uC]:gC,[aC]:hC,[cC]:dC,[qw]:Qw,[Jw]:Zw,[Kw]:Xw,[rC]:lC,[sC]:iC,[mC]:fC,[oC]:nC,[tC]:eC,[Gw]:Yw};function CC(){const t={};return ke(wC,((e,o)=>{t[o]=e()})),t}class yC{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.hot=t,this.predefinedItems=CC(),this.defaultOrderPattern=e}setPredefinedItems(t){const e={};this.defaultOrderPattern.length=0,ke(t,((t,o)=>{let n="";t.name===dw?(e[dw]=t,n=dw):isNaN(parseInt(o,10))?(t.key=void 0===t.key?o:t.key,e[o]=t,n=t.key):(e[t.key]=t,n=t.key),this.defaultOrderPattern.push(n)})),this.predefinedItems=e}getItems(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return vC(t,this.defaultOrderPattern,this.predefinedItems)}}function vC(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=[];let s=t;return s&&s.items?s=s.items:Array.isArray(s)||(s=e),Ae(s)?ke(s,((t,e)=>{let s=o["string"===typeof t?t:e];s||(s=t),Ae(t)?Ee(s,t):"string"===typeof s&&(s={name:s}),void 0===s.key&&(s.key=e),n.push(s)})):O(s,((t,e)=>{let s=o[t];!s&&pC.indexOf(t)>=0||(s||(s={name:t,key:`${e}`}),Ae(t)&&Ee(s,t),void 0===s.key&&(s.key=e),n.push(s))})),n}var bC=yC;class SC{constructor(t,e){const o=Pt(e),n=_t(e);let s,i,r,l,a,h;this.rootWindow=e,this.type=this.getSourceType(t),"literal"===this.type?(s=parseInt(t.top,10),r=parseInt(t.left,10),a=t.height||0,h=t.width||0,i=s,l=r,s+=o,r+=n):"event"===this.type&&(s=parseInt(t.pageY,10),r=parseInt(t.pageX,10),a=t.target.clientHeight,h=t.target.clientWidth,i=s-o,l=r-n),this.top=s,this.topRelative=i,this.left=r,this.leftRelative=l,this.scrollTop=o,this.scrollLeft=n,this.cellHeight=a,this.cellWidth=h}getSourceType(t){let e="literal";return t instanceof Event&&(e="event"),e}fitsAbove(t){return this.topRelative>=t.offsetHeight}fitsBelow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}fitsOnRight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}fitsOnLeft(t){return this.leftRelative>=t.offsetWidth}}var RC=SC;const EC=215,MC="menu",TC=MC;class xC{constructor(t,e){this.hot=t,this.options=e||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:EC,container:this.hot.rootDocument.documentElement},this.eventManager=new Bo(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}registerEvents(){let t=this.hot.rootWindow;while(t)this.eventManager.addEventListener(t.document,"mousedown",(t=>this.onDocumentMouseDown(t))),this.eventManager.addEventListener(t.document,"contextmenu",(t=>this.onDocumentContextMenu(t))),t=pt(t)}setMenuItems(t){this.menuItems=t}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset[t]=e}isSubMenu(){return null!==this.parentMenu}open(){var t=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=pe((t=>this.openSubMenu(t)),300),o=this.options.minWidth||EC;let n=!1,s=H(this.menuItems,(t=>(t.key===uC&&(n=!0),Tw(t,this.hot))));if(s.length<1&&!n)s.push(CC()[uC]);else if(0===s.length)return;s=Aw(s,dw);let i=!1;const r={data:s,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(t){return z(t)&&t<o?o:t},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:(t,e,o,n,s,i)=>this.menuItemRenderer(t,e,o,n,s,i)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:(t,o)=>{this.isAllSubMenusClosed()?e(o.row):this.openSubMenu(o.row)},rowHeights:t=>s[t].name===dw?1:23,afterOnCellContextMenu:t=>{t.preventDefault(),Ze()&&i&&this.hasSelectedItem()&&this.close(!0)},beforeOnCellMouseUp:t=>{this.hasSelectedItem()&&(i=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(t))},afterOnCellMouseUp:t=>{Ze()&&uo(t)||!i||!this.hasSelectedItem()||(qe()||Je()?setTimeout((()=>this.close(!0)),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new Wd(this.container,r),this.hotMenu.addHook("afterInit",(()=>this.onAfterInit())),this.hotMenu.addHook("afterSelection",(function(){return t.onAfterSelection(...arguments)})),this.hotMenu.init(),this.hotMenu.listen();const l=this.hotMenu.getShortcutManager(),a=l.addContext(TC),h={group:MC},c={...h,runOnlyIf:t=>!1===ae(t.target)||!1===this.container.contains(t.target)};l.setActiveContextName("menu"),a.addShortcuts([{keys:[["Escape"]],callback:()=>{this.keyEvent=!0,this.close(),this.keyEvent=!1}},{keys:[["ArrowDown"]],callback:()=>{const t=this.hotMenu.getSelectedLast();this.keyEvent=!0,t?this.selectNextCell(t[0],t[1]):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["ArrowUp"]],callback:()=>{const t=this.hotMenu.getSelectedLast();this.keyEvent=!0,t?this.selectPrevCell(t[0],t[1]):this.selectLastCell(),this.keyEvent=!1}},{keys:[["ArrowRight"]],callback:()=>{const t=this.hotMenu.getSelectedLast();if(this.keyEvent=!0,t){const e=this.openSubMenu(t[0]);e&&e.selectFirstCell()}this.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:()=>{const t=this.hotMenu.getSelectedLast();this.keyEvent=!0,t&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen()),this.keyEvent=!1}},{keys:[["Enter"]],callback:t=>{const e=this.hotMenu.getSelectedLast();this.keyEvent=!0,this.hotMenu.getSourceDataAtRow(e[0]).submenu||(this.executeCommand(t),this.close(!0)),this.keyEvent=!1}},{keys:[["PageUp"]],callback:()=>{const t=this.hotMenu.getSelectedLast();this.keyEvent=!0,t?this.hotMenu.selection.transformStart(-this.hotMenu.countVisibleRows(),0):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["PageDown"]],callback:()=>{const t=this.hotMenu.getSelectedLast();this.keyEvent=!0,t?this.hotMenu.selection.transformStart(this.hotMenu.countVisibleRows(),0):this.selectLastCell(),this.keyEvent=!1}}],c),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}close(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(t&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}openSubMenu(t){if(!this.hotMenu)return!1;const e=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!e||!fw(e))return!1;const o=this.hotMenu.getSourceDataAtRow(t),n=new xC(this.hot,{parent:this,name:o.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return n.setMenuItems(o.submenu.items),n.open(),n.setPosition(e.getBoundingClientRect()),this.hotSubMenus[o.key]=n,n}closeSubMenu(t){const e=this.hotMenu.getSourceDataAtRow(t),o=this.hotSubMenus[e.key];o&&(o.destroy(),delete this.hotSubMenus[e.key])}closeAllSubMenus(){O(this.hotMenu.getData(),((t,e)=>this.closeSubMenu(e)))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}destroy(){const t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(t){if(!this.isOpened()||!this.hasSelectedItem())return;const e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),this.isCommandPassive(e))return;const o=this.hot.getSelectedRange(),n=o?gw(o):[];this.runLocalHooks("executeCommand",e.key,n,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,n,t)}isCommandPassive(t){const{isCommand:e,name:o,disabled:n,submenu:s}=t,i=!0===n||"function"===typeof n&&!0===n.call(this.hot);return!1===e||o===dw||!0===i||s}setPosition(t){const e=new RC(t,this.container.ownerDocument.defaultView);this.options.keepInViewport?(e.fitsBelow(this.container)?this.setPositionBelowCursor(e):e.fitsAbove(this.container)?this.setPositionAboveCursor(e):this.setPositionBelowCursor(e),this.hot.isLtr()?this.setHorizontalPositionForLtr(e):this.setHorizontalPositionForRtl(e)):(this.setPositionBelowCursor(e),this.setPositionOnRightOfCursor(e))}setHorizontalPositionForRtl(t){t.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(t):this.setPositionOnRightOfCursor(t)}setHorizontalPositionForLtr(t){t.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(t):this.setPositionOnLeftOfCursor(t)}setPositionAboveCursor(t){let e=this.offset.above+t.top-this.container.offsetHeight;this.isSubMenu()&&(e=t.top+t.cellHeight-this.container.offsetHeight+3),this.container.style.top=`${e}px`}setPositionBelowCursor(t){let e=this.offset.below+t.top+1;this.isSubMenu()&&(e=t.top-1),this.container.style.top=`${e}px`}setPositionOnRightOfCursor(t){let e=t.left;if(this.isSubMenu()){const{right:o}=this.parentMenu.container.getBoundingClientRect();e+=t.cellWidth+o-(t.left+t.cellWidth)}else e+=this.offset.right;this.container.style.left=`${e}px`}setPositionOnLeftOfCursor(t){let e=this.offset.left+t.left-this.container.offsetWidth;if(this.isSubMenu()){const{left:o}=this.parentMenu.container.getBoundingClientRect();e-=t.left-o}this.container.style.left=`${e}px`}selectFirstCell(){const t=this.hotMenu.getCell(0,0);mw(t)||pw(t)||ww(t)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}selectLastCell(){const t=this.hotMenu.countRows()-1,e=this.hotMenu.getCell(t,0);mw(e)||pw(e)||ww(e)?this.selectPrevCell(t,0):(this.hotMenu.selectCell(t,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(t,0,!0,!1))}selectNextCell(t,e){const o=t+1,n=o<this.hotMenu.countRows()?this.hotMenu.getCell(o,e):null;n&&(mw(n)||pw(n)||ww(n)?this.selectNextCell(o,e):this.hotMenu.selectCell(o,e))}selectPrevCell(t,e){const o=t-1,n=o>=0?this.hotMenu.getCell(o,e):null;n&&(mw(n)||pw(n)||ww(n)?this.selectPrevCell(o,e):this.hotMenu.selectCell(o,e))}menuItemRenderer(t,e,o,n,s,i){const r=t.getSourceDataAtRow(o),l=this.hot.rootDocument.createElement("div"),a=t=>Le(t,"submenu"),h=t=>new RegExp(dw,"i").test(t.name),c=t=>!0===t.disabled||"function"===typeof t.disabled&&!0===t.disabled.call(this.hot),d=t=>t.disableSelection;let u=i;"function"===typeof u&&(u=u.call(this.hot)),It(e),Mt(l,"htItemWrapper"),e.appendChild(l),h(r)?Mt(e,"htSeparator"):"function"===typeof r.renderer?(Mt(e,"htCustomMenuRenderer"),e.appendChild(r.renderer(t,l,o,n,s,u))):At(l,u),c(r)?(Mt(e,"htDisabled"),this.eventManager.addEventListener(e,"mouseenter",(()=>t.deselectCell()))):d(r)?(Mt(e,"htSelectionDisabled"),this.eventManager.addEventListener(e,"mouseenter",(()=>t.deselectCell()))):a(r)?(Mt(e,"htSubmenu"),d(r)?this.eventManager.addEventListener(e,"mouseenter",(()=>t.deselectCell())):this.eventManager.addEventListener(e,"mouseenter",(()=>t.selectCell(o,n,void 0,void 0,!1,!1)))):(Tt(e,["htSubmenu","htDisabled"]),d(r)?this.eventManager.addEventListener(e,"mouseenter",(()=>t.deselectCell())):this.eventManager.addEventListener(e,"mouseenter",(()=>t.selectCell(o,n,void 0,void 0,!1,!1))))}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.options.container.ownerDocument;let o,n=t;return n&&(ge(n)&&(n=n.call(this.hot),n=null===n||$(n)?"":n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,o=e.querySelector(`.${this.options.className}.${n}`)),o||(o=e.createElement("div"),Mt(o,`htMenu ${this.options.className}`),n&&Mt(o,n),this.options.container.appendChild(o)),o}blockMainTableCallbacks(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}releaseMainTableCallbacks(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}onAfterInit(){const{wtTable:t}=this.hotMenu.view._wt,e=this.hotMenu.getSettings().data,o=t.hider.style,n=t.holder.style,s=parseInt(o.width,10),i=I(e,((t,e)=>t+(e.name===dw?1:26)),0);n.width=`${s+3}px`,n.height=`${i+3}px`,o.height=n.height}onAfterSelection(t,e,o,n,s){!1===this.keyEvent&&(s.value=!0)}onDocumentMouseDown(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!vt(t.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||vt(t.target,".htMenu")||this.close(!0))}onDocumentContextMenu(t){this.isOpened()&&Et(t.target,"htCore")&&vt(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}Ie(xC,dl);var IC=xC;const HC="contextMenu",AC=70;Ro.getSingleton().register("afterContextMenuDefaultOptions"),Ro.getSingleton().register("beforeContextMenuShow"),Ro.getSingleton().register("afterContextMenuShow"),Ro.getSingleton().register("afterContextMenuHide"),Ro.getSingleton().register("afterContextMenuExecute");class OC extends hf{static get PLUGIN_KEY(){return HC}static get PLUGIN_PRIORITY(){return AC}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[aC,cC,dw,qw,Jw,dw,rC,sC,dw,mC,oC,dw,tC,dw,Gw]}constructor(t){super(t),this.eventManager=new Bo(this),this.commandExecutor=new $w(this.hot),this.itemsFactory=null,this.menu=null}isEnabled(){return!!this.hot.getSettings()[HC]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[HC];"function"===typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new IC(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(()=>this.onMenuBeforeOpen())),this.menu.addLocalHook("afterOpen",(()=>this.onMenuAfterOpen())),this.menu.addLocalHook("afterClose",(()=>this.onMenuAfterClose())),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.executeCommand.call(t,...o)})),this.addHook("afterOnCellContextMenu",(t=>this.onAfterOnCellContextMenu(t))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),super.disablePlugin()}open(t){if(!this.menu)return;if(this.prepareMenuItems(),this.menu.open(),!this.menu.isOpened())return;let e=0,o=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){const{frameElement:n}=this.hot.rootWindow,{top:s,left:i}=n.getBoundingClientRect();e=s-Pt(t.view),o=i-_t(t.view)}else e=-1*Pt(this.menu.hotMenu.rootWindow),o=-1*_t(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(t.pageY,10)+e,left:parseInt(t.pageX,10)+o})}close(){this.menu&&(this.menu.close(),this.itemsFactory=null)}executeCommand(t){null===this.itemsFactory&&this.prepareMenuItems();for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];this.commandExecutor.execute(t,...o)}prepareMenuItems(){this.itemsFactory=new bC(this.hot,OC.DEFAULT_ITEMS);const t=this.hot.getSettings()[HC],e={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",e),this.itemsFactory.setPredefinedItems(e.items);const o=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",o),this.menu.setMenuItems(o),O(o,(t=>this.commandExecutor.registerCommand(t.key,t)))}onAfterOnCellContextMenu(t){const e=this.hot.getSettings(),o=e.rowHeaders,n=e.colHeaders;function s(t){return"TD"===t.nodeName||"TD"===t.parentNode.nodeName}const i=t.target;this.close(),Et(i,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),(o||n||s(i)||Et(i,"current")&&Et(i,"wtBorder"))&&this.open(t))}onMenuBeforeOpen(){this.hot.runHooks("beforeContextMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterContextMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function kC(t){return{key:"copy",name(){return this.getTranslatedPhrase(Ea)},callback(){t.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function NC(t){return{key:"copy_column_headers_only",name(){const t=this.getSelectedRangeLast(),e=t?Math.min(t.getWidth()-1,1):0;return this.getTranslatedPhrase(xa,e)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function PC(t){return{key:"copy_with_column_group_headers",name(){const t=this.getSelectedRangeLast(),e=t?Math.min(t.getWidth()-1,1):0;return this.getTranslatedPhrase(Ta,e)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function _C(t){return{key:"copy_with_column_headers",name(){const t=this.getSelectedRangeLast(),e=t?Math.min(t.getWidth()-1,1):0;return this.getTranslatedPhrase(Ma,e)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function DC(t){return{key:"cut",name(){return this.getTranslatedPhrase(Ia)},callback(){t.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}OC.SEPARATOR={name:dw};class LC{constructor(){this.data={}}setData(t,e){this.data[t]=e}getData(t){return this.data[t]||void 0}}class VC{constructor(){this.clipboardData=new LC}}class BC{constructor(t){this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new Bo(this),this.listenersCount=new WeakSet,this.container=t}useSecondaryElement(){const t=GC(this.container);this.listenersCount.has(t)||(this.listenersCount.add(t),zC(this.eventManager,t,this)),this.mainElement=t}setFocusableElement(t){this.listenersCount.has(t)||(this.listenersCount.add(t),zC(this.eventManager,t,this)),this.mainElement=t}getFocusableElement(){return this.mainElement}focus(){this.mainElement.value=" ",qe()||ce(this.mainElement)}}Ie(BC,dl);const FC=new WeakMap;function WC(t){const e=new BC(t);let o=FC.get(t);return o=isNaN(o)?0:o,FC.set(t,o+1),e}function jC(t){t.eventManager.clear()}const UC=(t,e)=>o=>e.runLocalHooks(t,o);function zC(t,e,o){t.addEventListener(e,"copy",UC("copy",o)),t.addEventListener(e,"cut",UC("cut",o)),t.addEventListener(e,"paste",UC("paste",o))}const $C=new WeakMap;function GC(t){const e=$C.get(t);if(e)return e.parentElement||t.appendChild(e),e;const o=t.defaultView?t:t.ownerDocument,n=o.createElement("textarea");return $C.set(t,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",t.appendChild(n),n}function YC(t){if(!(t instanceof BC))return;let e=FC.get(t.container);if(e=isNaN(e)?0:e,e>0&&(e-=1),jC(t),e<=0){e=0;const o=$C.get(t.container);o&&o.parentNode&&(o.parentNode.removeChild(o),$C.delete(t.container)),t.mainElement=null}FC.set(t.container,e)}function KC(t,e){qC(t,e),e.add(t)}function XC(t,e,o){qC(t,e),e.set(t,o)}function qC(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QC(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function JC(t,e){var o=ey(t,e,"get");return ZC(t,o)}function ZC(t,e){return e.get?e.get.call(t):e.value}function ty(t,e,o){var n=ey(t,e,"set");return oy(t,n,o),o}function ey(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function oy(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var ny=new WeakMap,sy=new WeakMap,iy=new WeakMap,ry=new WeakMap,ly=new WeakMap,ay=new WeakMap,hy=new WeakSet,cy=new WeakSet;class dy{constructor(t){let{countRows:e,countColumns:o,rowsLimit:n,columnsLimit:s,countColumnHeaders:i}=t;KC(this,cy),KC(this,hy),XC(this,ny,{writable:!0,value:void 0}),XC(this,sy,{writable:!0,value:void 0}),XC(this,iy,{writable:!0,value:void 0}),XC(this,ry,{writable:!0,value:void 0}),XC(this,ly,{writable:!0,value:void 0}),XC(this,ay,{writable:!0,value:void 0}),ty(this,sy,e),ty(this,iy,o),ty(this,ry,n),ty(this,ly,s),ty(this,ay,i)}setSelectedRange(t){ty(this,ny,t)}getCellsRange(){if(0===JC(this,sy).call(this)||0===JC(this,iy).call(this))return null;const{row:t,col:e}=JC(this,ny).getTopStartCorner(),{row:o,col:n}=JC(this,ny).getBottomEndCorner(),s=QC(this,cy,gy).call(this,t,o),i=QC(this,hy,uy).call(this,e,n),r=o!==s||n!==i;return{isRangeTrimmed:r,startRow:t,startCol:e,endRow:s,endCol:i}}getMostBottomColumnHeadersRange(){if(0===JC(this,iy).call(this)||0===JC(this,ay).call(this))return null;const{col:t}=JC(this,ny).getTopStartCorner(),{col:e}=JC(this,ny).getBottomEndCorner(),o=QC(this,hy,uy).call(this,t,e),n=e!==o;return{isRangeTrimmed:n,startRow:-1,startCol:t,endRow:-1,endCol:o}}getAllColumnHeadersRange(){if(0===JC(this,iy).call(this)||0===JC(this,ay).call(this))return null;const{col:t}=JC(this,ny).getTopStartCorner(),{col:e}=JC(this,ny).getBottomEndCorner(),o=QC(this,hy,uy).call(this,t,e),n=e!==o;return{isRangeTrimmed:n,startRow:-JC(this,ay).call(this),startCol:t,endRow:-1,endCol:o}}}function uy(t,e){return Math.min(e,Math.max(t+JC(this,ly).call(this)-1,t))}function gy(t,e){return Math.min(e,Math.max(t+JC(this,ry).call(this)-1,t))}function my(t){const e=[],o=[];return O(t,(t=>{const n=Math.min(t.startRow,t.endRow),s=Math.max(t.startRow,t.endRow);tn(n,s,(t=>{-1===e.indexOf(t)&&e.push(t)}));const i=Math.min(t.startCol,t.endCol),r=Math.max(t.startCol,t.endCol);tn(i,r,(t=>{-1===o.indexOf(t)&&o.push(t)}))})),{rows:e,columns:o}}function fy(t,e){wy(t,e),e.add(t)}function py(t,e,o){wy(t,e),e.set(t,o)}function wy(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cy(t,e,o){return e=yy(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function yy(t){var e=vy(t,"string");return"symbol"===typeof e?e:String(e)}function vy(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function by(t,e,o){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return o}function Sy(t,e){var o=My(t,e,"get");return Ry(t,o)}function Ry(t,e){return e.get?e.get.call(t):e.value}function Ey(t,e,o){var n=My(t,e,"set");return Ty(t,n,o),o}function My(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Ty(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}Ro.getSingleton().register("afterCopyLimit"),Ro.getSingleton().register("modifyCopyableRange"),Ro.getSingleton().register("beforeCut"),Ro.getSingleton().register("afterCut"),Ro.getSingleton().register("beforePaste"),Ro.getSingleton().register("afterPaste"),Ro.getSingleton().register("beforeCopy"),Ro.getSingleton().register("afterCopy");const xy="copyPaste",Iy=80,Hy=["fragmentSelection"],Ay=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Oy=new WeakMap,ky=new WeakMap,Ny=new WeakMap,Py=new WeakMap,_y=new WeakMap,Dy=new WeakMap,Ly=new WeakMap,Vy=new WeakSet;class By extends hf{constructor(){super(...arguments),fy(this,Vy),Cy(this,"columnsLimit",1/0),Cy(this,"rowsLimit",1/0),Cy(this,"pasteMode","overwrite"),Cy(this,"uiContainer",this.hot.rootDocument.body),py(this,Oy,{writable:!0,value:!1}),py(this,ky,{writable:!0,value:!1}),py(this,Ny,{writable:!0,value:!1}),py(this,Py,{writable:!0,value:"cells-only"}),py(this,_y,{writable:!0,value:!1}),py(this,Dy,{writable:!0,value:!1}),py(this,Ly,{writable:!0,value:new dy({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),Cy(this,"copyableRanges",[]),Cy(this,"focusableElement",void 0)}static get PLUGIN_KEY(){return xy}static get SETTING_KEYS(){return[xy,...Hy]}static get PLUGIN_PRIORITY(){return Iy}isEnabled(){return!!this.hot.getSettings()[xy]}enablePlugin(){if(this.enabled)return;const{[xy]:t}=this.hot.getSettings();var e,o;"object"===typeof t&&(this.pasteMode=null!==(e=t.pasteMode)&&void 0!==e?e:this.pasteMode,this.rowsLimit=isNaN(t.rowsLimit)?this.rowsLimit:t.rowsLimit,this.columnsLimit=isNaN(t.columnsLimit)?this.columnsLimit:t.columnsLimit,Ey(this,Oy,!!t.copyColumnHeaders),Ey(this,ky,!!t.copyColumnGroupHeaders),Ey(this,Ny,!!t.copyColumnHeadersOnly),this.uiContainer=null!==(o=t.uiContainer)&&void 0!==o?o:this.uiContainer);this.addHook("afterContextMenuDefaultOptions",(t=>this.onAfterContextMenuDefaultOptions(t))),this.addHook("afterOnCellMouseUp",(()=>this.onAfterOnCellMouseUp())),this.addHook("afterSelectionEnd",(()=>this.onAfterSelectionEnd())),this.addHook("beforeKeyDown",(()=>this.onBeforeKeyDown())),this.focusableElement=WC(this.uiContainer),this.focusableElement.addLocalHook("copy",(t=>this.onCopy(t))).addLocalHook("cut",(t=>this.onCut(t))).addLocalHook("paste",(t=>this.onPaste(t))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),super.updatePlugin()}disablePlugin(){this.focusableElement&&YC(this.focusableElement),super.disablePlugin()}copy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only";Ey(this,Py,t),Ey(this,_y,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Ey(this,Dy,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}getRangedCopyableData(t){return Md(this.getRangedData(t))}getRangedData(t){const e=[],{rows:o,columns:n}=my(t);return O(o,(t=>{const o=[];O(n,(e=>{t<0?o.push(this.hot.getColHeader(e,t)):o.push(this.hot.getCopyableData(t,e))})),e.push(o)})),e}paste(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t&&!e)return;const o=new VC;t&&o.clipboardData.setData("text/plain",t),e&&o.clipboardData.setData("text/html",e),this.getOrCreateFocusableElement(),this.onPaste(o)}setCopyableText(){const t=this.hot.getSelectedRangeLast();if(!t)return;Sy(this,Ly).setSelectedRange(t);const e=new Map([["headers",null],["cells",null]]);"column-headers-only"===Sy(this,Py)?e.set("headers",Sy(this,Ly).getMostBottomColumnHeadersRange()):("with-column-headers"===Sy(this,Py)?e.set("headers",Sy(this,Ly).getMostBottomColumnHeadersRange()):"with-column-group-headers"===Sy(this,Py)&&e.set("headers",Sy(this,Ly).getAllColumnHeadersRange()),e.set("cells",Sy(this,Ly).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter((t=>null!==t)).map((t=>{let{startRow:e,startCol:o,endRow:n,endCol:s}=t;return{startRow:e,startCol:o,endRow:n,endCol:s}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const o=e.get("cells");if(null!==o&&o.isRangeTrimmed){const{startRow:t,startCol:e,endRow:n,endCol:s}=o;this.hot.runHooks("afterCopyLimit",n-t+1,s-e+1,this.rowsLimit,this.columnsLimit)}}getOrCreateFocusableElement(){var t;const e=null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.TEXTAREA;e?this.focusableElement.setFocusableElement(e):this.focusableElement.useSecondaryElement()}isEditorOpened(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}populateValues(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!t.length)return;const o=t.length,n=t[0].length,s=[],{row:i,col:r}=e.getTopStartCorner(),{row:l,col:a}=e.getBottomEndCorner();let h=i,c=r,d=i,u=r;while(s.length<o||h<=l){const{skipRowOnPaste:e,visualRow:l}=this.hot.getCellMeta(h,r);if(h=l+1,!0===e)continue;d=l,c=r;const g=[],m=s.length%o;while(g.length<n||c<=a){const{skipColumnOnPaste:e,visualCol:o}=this.hot.getCellMeta(i,c);if(c=o+1,!0===e)continue;u=o;const s=g.length%n;g.push(t[m][s])}s.push(g)}return this.hot.populateFromArray(i,r,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[i,r,d,u]}onCopy(t){if(!this.hot.isListening()&&!Sy(this,_y)||this.isEditorOpened())return;this.setCopyableText(),Ey(this,_y,!1);const e=this.getRangedData(this.copyableRanges),o=by(this,Vy,Fy).call(this,this.copyableRanges),n=!!this.hot.runHooks("beforeCopy",e,this.copyableRanges,o);if(n){const n=Md(e);if(t&&t.clipboardData){const o=qo(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",n),t.clipboardData.setData("text/html",[Ay,o].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n);this.hot.runHooks("afterCopy",e,this.copyableRanges,o)}Ey(this,Py,"cells-only"),t.preventDefault()}onCut(t){if(!this.hot.isListening()&&!Sy(this,Dy)||this.isEditorOpened())return;this.setCopyableText(),Ey(this,Dy,!1);const e=this.getRangedData(this.copyableRanges),o=!!this.hot.runHooks("beforeCut",e,this.copyableRanges);if(o){const o=Md(e);if(t&&t.clipboardData){const n=qo(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",o),t.clipboardData.setData("text/html",[Ay,n].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",e,this.copyableRanges)}t.preventDefault()}onPaste(t){if(!this.hot.isListening()||this.isEditorOpened())return;let e;if(t&&t.preventDefault&&t.preventDefault(),t&&"undefined"!==typeof t.clipboardData){const o=gt(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(o&&/(<table)|(<TABLE)/g.test(o)){const t=Qo(o,this.hot.rootDocument);e=t.data}else e=t.clipboardData.getData("text/plain")}else"undefined"===typeof ClipboardEvent&&"undefined"!==typeof this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));if("string"===typeof e&&(e=Ed(e)),e&&0===e.length)return;if(!1===this.hot.runHooks("beforePaste",e,this.copyableRanges))return;const[o,n,s,i]=this.populateValues(e);this.hot.selectCell(o,n,Math.min(this.hot.countRows()-1,s),Math.min(this.hot.countCols()-1,i)),this.hot.runHooks("afterPaste",e,this.copyableRanges)}onAfterContextMenuDefaultOptions(t){t.items.push({name:"---------"},kC(this)),Sy(this,Oy)&&t.items.push(_C(this)),Sy(this,ky)&&t.items.push(PC(this)),Sy(this,Ny)&&t.items.push(NC(this)),t.items.push(DC(this))}onAfterOnCellMouseUp(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}onAfterSelectionEnd(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&Qt()||(this.setCopyableText(),this.focusableElement.focus()))}onBeforeKeyDown(){if(!this.hot.isListening()||this.isEditorOpened())return;const t=this.hot.rootDocument.activeElement,e=this.hot.getActiveEditor();!e||t!==this.focusableElement.getFocusableElement()&&t!==e.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}destroy(){this.focusableElement&&(YC(this.focusableElement),this.focusableElement=null),super.destroy()}}function Fy(t){const{rows:e}=my(t);let o=0;for(let n=0;n<e.length;n++){if(e[n]>=0)break;o+=1}return{columnHeadersCount:o}}function Wy(t,e){return`border_row${t}col${e}`}function jy(){return{width:1,color:"#000"}}function Uy(){return{hide:!0}}function zy(){return{width:1,color:"#000",cornerVisible:!1}}function $y(t){var e,o;(z(t.start)||z(t.left))&&(t.start=null!==(e=t.start)&&void 0!==e?e:t.left);(z(t.end)||z(t.right))&&(t.end=null!==(o=t.end)&&void 0!==o?o:t.right);return delete t.left,delete t.right,t}function Gy(t){return z(t.start)&&(t.left=t.start),z(t.end)&&(t.right=t.end),t}function Yy(t,e){return{id:Wy(t,e),border:zy(),row:t,col:e,top:Uy(),bottom:Uy(),start:Uy(),end:Uy()}}function Ky(t,e){return Le(e,"border")&&e.border&&(t.border=e.border),Le(e,"top")&&z(e.top)&&(e.top?(Ae(e.top)||(e.top=jy()),t.top=e.top):(e.top=Uy(),t.top=e.top)),Le(e,"bottom")&&z(e.bottom)&&(e.bottom?(Ae(e.bottom)||(e.bottom=jy()),t.bottom=e.bottom):(e.bottom=Uy(),t.bottom=e.bottom)),Le(e,"start")&&z(e.start)&&(e.start?(Ae(e.start)||(e.start=jy()),t.start=e.start):(e.start=Uy(),t.start=e.start)),Le(e,"end")&&z(e.end)&&(e.end?(Ae(e.end)||(e.end=jy()),t.end=e.end):(e.end=Uy(),t.end=e.end)),t}function Xy(t,e){let o=!1;return O(t.getSelectedRange(),(n=>{n.forAll(((n,s)=>{if(n<0||s<0)return;const i=t.getCellMeta(n,s).borders;if(i){if(!e)return o=!0,!1;if(!Le(i[e],"hide")||!1===i[e].hide)return o=!0,!1}}))})),o}function qy(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function Qy(t){return t.some((t=>z(t.left)||z(t.right)))}function Jy(t){return t.some((t=>z(t.start)||z(t.end)))}const Zy=new Map([["left","start"],["right","end"]]);function tv(t){var e;return null!==(e=Zy.get(t))&&void 0!==e?e:t}function ev(t){return{key:"borders:top",name(){let t=this.getTranslatedPhrase(Ga);const e=Xy(this,"top");return e&&(t=qy(t)),t},callback(e,o){const n=Xy(this,"top");t.prepareBorder(o,"top",n)}}}function ov(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(Ya);const o=Xy(this,e);return o&&(t=qy(t)),t},callback(o,n){const s=Xy(this,e);t.prepareBorder(n,e,s)}}}function nv(t){return{key:"borders:bottom",name(){let t=this.getTranslatedPhrase(Ka);const e=Xy(this,"bottom");return e&&(t=qy(t)),t},callback(e,o){const n=Xy(this,"bottom");t.prepareBorder(o,"bottom",n)}}}function sv(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(Xa);const o=Xy(this,e);return o&&(t=qy(t)),t},callback(o,n){const s=Xy(this,e);t.prepareBorder(n,e,s)}}}function iv(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(qa)},callback(e,o){t.prepareBorder(o,"noBorders")},disabled(){return!Xy(this)}}}function rv(t,e,o){return e=lv(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function lv(t){var e=av(t,"string");return"symbol"===typeof e?e:String(e)}function av(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const hv="customBorders",cv=90;class dv extends hf{constructor(){super(...arguments),rv(this,"savedBorders",[])}static get PLUGIN_KEY(){return hv}static get PLUGIN_PRIORITY(){return cv}isEnabled(){return!!this.hot.getSettings()[hv]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(t=>this.onAfterContextMenuDefaultOptions(t))),this.addHook("init",(()=>this.onAfterInit())),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(t,e){let o=["top","bottom","start","end"],n=null;e&&(this.checkSettingsCohesion([e]),o=Object.keys(e),n=$y(e));const s=zc(t),i=$c(s);O(t,(t=>{const[e,s,r,l]=i(t);for(let i=e;i<=r;i+=1)for(let t=s;t<=l;t+=1)O(o,(e=>{this.prepareBorderFromCustomAdded(i,t,n,tv(e))}))})),this.hot.view.render()}getBorders(t){if(!Array.isArray(t))return this.savedBorders;const e=zc(t),o=$c(e),n=[];return O(t,(t=>{const[e,s,i,r]=o(t);for(let o=e;o<=i;o+=1)for(let t=s;t<=r;t+=1)O(this.savedBorders,(e=>{e.row===o&&e.col===t&&n.push(Gy(e))}))})),n}clearBorders(t){t?this.setBorders(t):(O(this.savedBorders,(t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")})),this.savedBorders.length=0)}insertBorderIntoSettings(t,e){const o=this.checkSavedBorders(t);o||this.savedBorders.push(t);const n=this.hot._createCellRange(this.hot._createCellCoords(t.row,t.col)),s=this.checkCustomSelections(t,n,e);s||this.hot.selection.highlight.addCustomSelection({border:t,visualCellRange:n})}prepareBorderFromCustomAdded(t,e,o,n){const s=this.hot.countRows(),i=this.hot.countCols();if(t>=s||e>=i)return;let r=Yy(t,e);o&&(r=Ky(r,o),O(this.hot.selection.highlight.customSelections,(t=>{if(r.id===t.settings.id)return Object.assign(t.settings,o),r.id=t.settings.id,r.top=t.settings.top,r.bottom=t.settings.bottom,r.start=t.settings.start,r.end=t.settings.end,!1}))),this.hot.setCellMeta(t,e,"borders",Gy(r)),this.insertBorderIntoSettings(r,n)}prepareBorderFromCustomAddedRange(t,e){const o=Math.min(t.to.row,this.hot.countRows()-1),n=Math.min(t.to.col,this.hot.countCols()-1);tn(t.from.row,o,(o=>{tn(t.from.col,n,(n=>{const s=Yy(o,n);let i=0;o===t.from.row&&Le(e,"top")&&(i+=1,s.top=e.top),o===t.to.row&&Le(e,"bottom")&&(i+=1,s.bottom=e.bottom),n===t.from.col&&Le(e,"start")&&(i+=1,s.start=e.start),n===t.to.col&&Le(e,"end")&&(i+=1,s.end=e.end),i>0&&(this.hot.setCellMeta(o,n,"borders",Gy(s)),this.insertBorderIntoSettings(s))}))}))}removeAllBorders(t,e){const o=Wy(t,e);this.spliceBorder(o),this.clearBordersFromSelectionSettings(o),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}setBorder(t,e,o,n){let s=this.hot.getCellMeta(t,e).borders;if(s=s&&void 0!==s.border?$y(s):Yy(t,e),n){s[o]=Uy();const i=this.countHide(s);if(4===i)this.removeAllBorders(t,e);else{const i=this.checkCustomSelectionsFromContextMenu(s,o,n);i||this.insertBorderIntoSettings(s),this.hot.setCellMeta(t,e,"borders",Gy(s))}}else{s[o]=jy();const i=this.checkCustomSelectionsFromContextMenu(s,o,n);i||this.insertBorderIntoSettings(s),this.hot.setCellMeta(t,e,"borders",Gy(s))}}prepareBorder(t,e,o){O(t,(t=>{let{start:n,end:s}=t;if(n.row===s.row&&n.col===s.col)"noBorders"===e?this.removeAllBorders(n.row,n.col):this.setBorder(n.row,n.col,e,o);else switch(e){case"noBorders":tn(n.col,s.col,(t=>{tn(n.row,s.row,(e=>{this.removeAllBorders(e,t)}))}));break;case"top":tn(n.col,s.col,(t=>{this.setBorder(n.row,t,e,o)}));break;case"bottom":tn(n.col,s.col,(t=>{this.setBorder(s.row,t,e,o)}));break;case"start":tn(n.row,s.row,(t=>{this.setBorder(t,n.col,e,o)}));break;case"end":tn(n.row,s.row,(t=>{this.setBorder(t,s.col,e,o)}));break;default:break}}))}createCustomBorders(t){O(t,(t=>{const e=$y(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,e):this.prepareBorderFromCustomAdded(t.row,t.col,e)}))}countHide(t){const{top:e,bottom:o,start:n,end:s}=t,i=[e,o,n,s];return I(i,((t,e)=>{let o=t;return e&&e.hide&&(o+=1),o}),0)}clearBordersFromSelectionSettings(t){const e=A(this.hot.selection.highlight.customSelections,(t=>t.settings.id)).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear()}clearNullCellRange(){O(this.hot.selection.highlight.customSelections,((t,e)=>{if(null===t.cellRange)return this.hot.selection.highlight.customSelections[e].destroy(),this.hot.selection.highlight.customSelections.splice(e,1),!1}))}hideBorders(){O(this.savedBorders,(t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange()}))}spliceBorder(t){const e=A(this.savedBorders,(t=>t.id)).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}checkSavedBorders(t){let e=!1;const o=this.countHide(t);return 4===o?(this.spliceBorder(t.id),e=!0):O(this.savedBorders,((o,n)=>{if(t.id===o.id)return this.savedBorders[n]=t,e=!0,!1})),e}checkCustomSelectionsFromContextMenu(t,e,o){let n=!1;return O(this.hot.selection.highlight.customSelections,(s=>{if(t.id===s.settings.id)return ke(s.instanceBorders,(t=>{t.toggleHiddenClass(e,o)})),n=!0,!1})),n}checkCustomSelections(t,e,o){const n=this.countHide(t);let s=!1;return 4===n?(this.removeAllBorders(t.row,t.col),s=!0):O(this.hot.selection.highlight.customSelections,(n=>{if(t.id===n.settings.id)return n.visualCellRange=e,n.commit(),o&&ke(n.instanceBorders,(e=>{e.changeBorderStyle(o,t)})),s=!0,!1})),s}changeBorderSettings(){const t=this.hot.getSettings()[hv];if(Array.isArray(t)){const e=Te(t);this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)}else void 0!==t&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(t){const e=Qy(t),o=Jy(t);if(e&&o)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&e)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}onAfterContextMenuDefaultOptions(t){this.hot.getSettings()[hv]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase($a)},disabled(){return this.selection.isSelectedByCorner()},submenu:{items:[ev(this),ov(this),nv(this),sv(this),iv(this)]}})}onAfterInit(){this.changeBorderSettings()}destroy(){super.destroy()}}const uv="dragToScroll",gv=100;class mv extends hf{static get PLUGIN_KEY(){return uv}static get PLUGIN_PRIORITY(){return gv}constructor(t){super(t),this.eventManager=new Bo(this),this.boundaries=null,this.callback=null,this.listening=!1}isEnabled(){return!!this.hot.getSettings()[uv]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",(t=>this.setupListening(t))),this.addHook("afterOnCellCornerMouseDown",(t=>this.setupListening(t))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(t){this.boundaries=t}setCallback(t){this.callback=t}check(t,e){let o=0,n=0;e<this.boundaries.top?n=e-this.boundaries.top:e>this.boundaries.bottom&&(n=e-this.boundaries.bottom),t<this.boundaries.left?o=t-this.boundaries.left:t>this.boundaries.right&&(o=t-this.boundaries.right),this.callback(o,n)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:t}=this.hot;let e=t;while(e)this.eventManager.addEventListener(e.document,"contextmenu",(()=>this.unlisten())),this.eventManager.addEventListener(e.document,"mouseup",(()=>this.unlisten())),this.eventManager.addEventListener(e.document,"mousemove",(t=>this.onMouseMove(t))),e=pt(e)}unregisterEvents(){this.eventManager.clear()}setupListening(t){if(uo(t))return;const e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback(((t,o)=>{t<0?e.scrollLeft-=50:t>0&&(e.scrollLeft+=50),o<0?e.scrollTop-=20:o>0&&(e.scrollTop+=20)})),this.listen())}onMouseMove(t){this.isListening()&&this.check(t.clientX,t.clientY)}destroy(){super.destroy()}}Ro.getSingleton().register("afterDropdownMenuDefaultOptions"),Ro.getSingleton().register("beforeDropdownMenuShow"),Ro.getSingleton().register("afterDropdownMenuShow"),Ro.getSingleton().register("afterDropdownMenuHide"),Ro.getSingleton().register("afterDropdownMenuExecute");const fv="dropdownMenu",pv=230,wv="changeType";class Cv extends hf{static get PLUGIN_KEY(){return fv}static get PLUGIN_PRIORITY(){return pv}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[qw,Jw,dw,sC,dw,Kw,dw,tC,dw,Gw]}constructor(t){super(t),this.eventManager=new Bo(this),this.commandExecutor=new $w(this.hot),this.itemsFactory=null,this.menu=null,this.hot.addHook("afterGetColHeader",((t,e)=>this.onAfterGetColHeader(t,e)))}isEnabled(){return this.hot.getSettings()[fv]}enablePlugin(){var t=this;if(this.enabled)return;this.itemsFactory=new bC(this.hot,Cv.DEFAULT_ITEMS);const e=this.hot.getSettings()[fv],o={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"===typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),super.enablePlugin(),this.callOnPluginsReady((()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",o),this.itemsFactory.setPredefinedItems(o.items);const n=this.itemsFactory.getItems(e);this.menu&&this.menu.destroy(),this.menu=new IC(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",n),this.menu.setMenuItems(n),this.menu.addLocalHook("beforeOpen",(()=>this.onMenuBeforeOpen())),this.menu.addLocalHook("afterOpen",(()=>this.onMenuAfterOpen())),this.menu.addLocalHook("afterClose",(()=>this.onMenuAfterClose())),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return t.executeCommand.call(t,...o)})),O(n,(t=>this.commandExecutor.registerCommand(t.key,t)))}))}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),super.disablePlugin()}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",(t=>this.onTableClick(t)))}open(t){this.menu&&(this.menu.open(),t.width&&this.menu.setOffset("left",t.width),this.menu.setPosition(t))}close(){this.menu&&this.menu.close()}executeCommand(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];this.commandExecutor.execute(t,...o)}setListening(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}onTableClick(t){if(t.stopPropagation(),Et(t.target,wv)&&!this.menu.isOpened()){let e=0,o=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){const{frameElement:t}=this.hot.rootWindow,{top:n,left:s}=t.getBoundingClientRect();e=n,o=s}const n=t.target.getBoundingClientRect();this.open({left:n.left+o,top:n.top+t.target.offsetHeight+3+e,width:n.width,height:n.height})}}onAfterGetColHeader(t,e){const o=e.parentNode;if(!o)return;const n=o.parentNode.childNodes,s=Array.prototype.indexOf.call(n,o);if(t<0||s!==n.length-1)return;const i=e.querySelector(`.${wv}`);if(this.enabled&&i)return;if(!this.enabled)return void(i&&i.parentNode.removeChild(i));const r=this.hot.rootDocument.createElement("button");r.className=wv,r.type="button",r.onclick=function(){return!1},e.firstChild.insertBefore(r,e.firstChild.firstChild)}onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}Cv.SEPARATOR={name:dw};class yv{constructor(t){this.hot=t,this.options={}}setOptions(t){this.options=t}getData(){const{startRow:t,startCol:e,endRow:o,endCol:n}=this._getDataRange(),s=this.options,i=[];return tn(t,o,(t=>{const o=[];!s.exportHiddenRows&&this._isHiddenRow(t)||(tn(e,n,(e=>{!s.exportHiddenColumns&&this._isHiddenColumn(e)||o.push(this.hot.getDataAtCell(t,e))})),i.push(o))})),i}getRowHeaders(){const t=[];if(this.options.rowHeaders){const{startRow:e,endRow:o}=this._getDataRange(),n=this.hot.getRowHeader();tn(e,o,(e=>{!this.options.exportHiddenRows&&this._isHiddenRow(e)||t.push(n[e])}))}return t}getColumnHeaders(){const t=[];if(this.options.columnHeaders){const{startCol:e,endCol:o}=this._getDataRange(),n=this.hot.getColHeader();tn(e,o,(e=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(e)||t.push(n[e])}))}return t}_getDataRange(){const t=this.hot.countCols()-1,e=this.hot.countRows()-1;let[o=0,n=0,s=e,i=t]=this.options.range;return o=Math.max(o,0),n=Math.max(n,0),s=Math.min(s,e),i=Math.min(i,t),{startRow:o,startCol:n,endRow:s,endCol:i}}_isHiddenRow(t){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(t))}_isHiddenColumn(t){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(t))}}var vv=yv;class bv{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(t,e){this.dataProvider=t,this.options=this._mergeOptions(e),this.dataProvider.setOptions(this.options)}_mergeOptions(t){let e=xe(this.constructor.DEFAULT_OPTIONS);const o=new Date;return e=Ee(xe(bv.DEFAULT_OPTIONS),e),e=Ee(e,t),e.filename=dt(e.filename,{YYYY:o.getFullYear(),MM:`${o.getMonth()+1}`.padStart(2,"0"),DD:`${o.getDate()}`.padStart(2,"0")}),e}}var Sv=bv;const Rv=String.fromCharCode(13),Ev=String.fromCharCode(34),Mv=String.fromCharCode(10);class Tv extends Sv{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const t=this.options,e=this.dataProvider.getData();let o=this.dataProvider.getColumnHeaders();const n=o.length>0,s=this.dataProvider.getRowHeaders(),i=s.length>0;let r=t.bom?String.fromCharCode(65279):"";return n&&(o=A(o,(t=>this._escapeCell(t,!0))),i&&(r+=t.columnDelimiter),r+=o.join(t.columnDelimiter),r+=t.rowDelimiter),O(e,((e,o)=>{o>0&&(r+=t.rowDelimiter),i&&(r+=this._escapeCell(s[o])+t.columnDelimiter),r+=e.map((t=>this._escapeCell(t))).join(t.columnDelimiter)})),r}_escapeCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=U(t);return""!==o&&(e||o.indexOf(Rv)>=0||o.indexOf(Ev)>=0||o.indexOf(Mv)>=0||o.indexOf(this.options.columnDelimiter)>=0)&&(o=o.replace(new RegExp('"',"g"),'""'),o=`"${o}"`),o}}var xv=Tv;const Iv="csv",Hv={[Iv]:xv};function Av(t,e,o){return"function"===typeof Hv[t]?new Hv[t](e,o):null}const Ov="exportFile",kv=240;class Nv extends hf{static get PLUGIN_KEY(){return Ov}static get PLUGIN_PRIORITY(){return kv}isEnabled(){return!0}exportAsString(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}exportAsBlob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}downloadFile(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument:o,rootWindow:n}=this.hot,s=this._createTypeFormatter(t,e),i=this._createBlob(s),r=n.URL||n.webkitURL,l=o.createElement("a"),a=`${s.options.filename}.${s.options.fileExtension}`;if(void 0!==l.download){const t=r.createObjectURL(i);l.style.display="none",l.setAttribute("href",t),l.setAttribute("download",a),o.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),o.body.removeChild(l),setTimeout((()=>{r.revokeObjectURL(t)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(i,a)}_createTypeFormatter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Hv[t])throw new Error(`Export format type "${t}" is not supported.`);return Av(t,new vv(this.hot),e)}_createBlob(t){let e=null;return"undefined"!==typeof Blob&&(e=new Blob([t.export()],{type:`${t.options.mimeType};charset=${t.options.encoding}`})),e}}class Pv{constructor(t,e){let{id:o,stateless:n=!0}=e;this.hot=t,this.id=o,this.elements=[],this.hidden=!1,this.stateId=`Filters.component.${this.id}`,this.state=n?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Ml)}reset(){O(this.elements,(t=>t.reset()))}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(t){this.state&&this.setState(this.state.getValueAtIndex(t))}setState(){throw new Error("The state setting logic is not implemented")}saveState(t){this.state&&this.state.setValueAtIndex(t,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),O(this.elements,(t=>t.destroy())),this.state=null,this.elements=null,this.hot=null}}Ie(Pv,dl);var _v=Pv;const Dv={};function Lv(t,e){if(!Dv[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:o,descriptor:n}=Dv[t];let s=e;return n.inputValuesDecorator&&(s=n.inputValuesDecorator(s)),function(t){return o.apply(t.meta.instance,[].concat([t],[s]))}}function Vv(t){if(!Dv[t])throw Error(`Filter condition "${t}" does not exist.`);return Dv[t].descriptor}function Bv(t,e,o){o.key=t,Dv[t]={condition:e,descriptor:o}}const Fv="none";function Wv(){return!0}Bv(Fv,Wv,{name:ih,inputsCount:0,showOperators:!1});const jv="empty";function Uv(t){return G(t.value)}Bv(jv,Uv,{name:rh,inputsCount:0,showOperators:!0});const zv="not_empty";function $v(t,e){return!Lv(jv,e)(t)}Bv(zv,$v,{name:lh,inputsCount:0,showOperators:!0});const Gv="eq";function Yv(t,e){let[o]=e;return U(t.value).toLocaleLowerCase(t.meta.locale)===U(o)}Bv(Gv,Yv,{name:ah,inputsCount:1,showOperators:!0});const Kv="neq";function Xv(t,e){return!Lv(Gv,e)(t)}Bv(Kv,Xv,{name:hh,inputsCount:1,showOperators:!0});const qv="gt";function Qv(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>n}Bv(qv,Qv,{name:fh,inputsCount:1,showOperators:!0});const Jv="gte";function Zv(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value>=n}Bv(Jv,Zv,{name:ph,inputsCount:1,showOperators:!0});const tb="lt";function eb(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<n}Bv(tb,eb,{name:wh,inputsCount:1,showOperators:!0});const ob="lte";function nb(t,e){let[o]=e,n=o;return"numeric"===t.meta.type&&(n=parseFloat(n,10)),t.value<=n}Bv(ob,nb,{name:Ch,inputsCount:1,showOperators:!0});const sb="date_after";function ib(t,e){let[o]=e;const n=E(t.value,t.meta.dateFormat),s=E(o,t.meta.dateFormat);return!(!n.isValid()||!s.isValid())&&n.diff(s)>=0}Bv(sb,ib,{name:bh,inputsCount:1,showOperators:!0});const rb="date_before";function lb(t,e){let[o]=e;const n=E(t.value,t.meta.dateFormat),s=E(o,t.meta.dateFormat);return!(!n.isValid()||!s.isValid())&&n.diff(s)<=0}Bv(rb,lb,{name:Sh,inputsCount:1,showOperators:!0});const ab="between";function hb(t,e){let[o,n]=e,s=o,i=n;if("numeric"===t.meta.type){const t=parseFloat(s,10),e=parseFloat(i,10);s=Math.min(t,e),i=Math.max(t,e)}else if("date"===t.meta.type){const e=Lv(rb,[i]),o=Lv(sb,[s]);return e(t)&&o(t)}return t.value>=s&&t.value<=i}Bv(ab,hb,{name:yh,inputsCount:2,showOperators:!0});const cb="not_between";function db(t,e){return!Lv(ab,e)(t)}Bv(cb,db,{name:vh,inputsCount:2,showOperators:!0});const ub="begins_with";function gb(t,e){let[o]=e;return U(t.value).toLocaleLowerCase(t.meta.locale).startsWith(U(o))}Bv(ub,gb,{name:ch,inputsCount:1,showOperators:!0});const mb="ends_with";function fb(t,e){let[o]=e;return U(t.value).toLocaleLowerCase(t.meta.locale).endsWith(U(o))}Bv(mb,fb,{name:dh,inputsCount:1,showOperators:!0});const pb="contains";function wb(t,e){let[o]=e;return U(t.value).toLocaleLowerCase(t.meta.locale).indexOf(U(o))>=0}Bv(pb,wb,{name:uh,inputsCount:1,showOperators:!0});const Cb="not_contains";function yb(t,e){return!Lv(pb,e)(t)}Bv(Cb,yb,{name:gh,inputsCount:1,showOperators:!0});const vb="date_tomorrow";function bb(t){const e=E(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(E().subtract(-1,"days").startOf("day"),"d")}Bv(vb,bb,{name:Eh,inputsCount:0});const Sb="date_today";function Rb(t){const e=E(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(E().startOf("day"),"d")}Bv(Sb,Rb,{name:Rh,inputsCount:0});const Eb="date_yesterday";function Mb(t){const e=E(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(E().subtract(1,"days").startOf("day"),"d")}Bv(Eb,Mb,{name:Mh,inputsCount:0});const Tb="numeric",xb="text",Ib="date",Hb={[Tb]:[Fv,dw,jv,zv,dw,Gv,Kv,dw,qv,Jv,tb,ob,ab,cb],[xb]:[Fv,dw,jv,zv,dw,Gv,Kv,dw,ub,mb,dw,pb,Cb],[Ib]:[Fv,dw,jv,zv,dw,Gv,Kv,dw,rb,sb,ab,dw,vb,Sb,Eb]};function Ab(t){const e=[];let o=t;return Hb[o]||(o=xb),O(Hb[o],(t=>{let o;o=t===dw?{name:dw}:xe(Vv(t)),e.push(o)})),e}const Ob="built",kb="building",Nb=["click","input","keydown","keypress","keyup","focus","blur","change"];class Pb{static get DEFAULTS(){return xe({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(t,e){this.hot=t,this.eventManager=new Bo(this),this.options=Ee(Pb.DEFAULTS,e),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}setValue(t){this.options.value=t,this.update()}getValue(){return this.options.value}get element(){return this.buildState===kb?this._element:this.buildState===Ob?(this.update(),this._element):(this.buildState=kb,this.build(),this.buildState=Ob,this._element)}isBuilt(){return this.buildState===Ob}translateIfPossible(t){return"string"===typeof t&&t.startsWith(nh)?this.hot.getTranslatedPhrase(t):t}build(){const t=(t,e)=>{this.eventManager.addEventListener(t,e,(t=>this.runLocalHooks(e,t,this)))};if(this.buildState||(this.buildState=kb),this.options.className&&Mt(this._element,this.options.className),this.options.children.length)O(this.options.children,(t=>this._element.appendChild(t.element)));else if(this.options.wrapIt){const e=this.hot.rootDocument.createElement(this.options.tagName);ke(this.options,((t,o)=>{void 0!==e[o]&&"className"!==o&&"tagName"!==o&&"children"!==o&&(e[o]=this.translateIfPossible(t))})),this._element.appendChild(e),O(Nb,(o=>t(e,o)))}else O(Nb,(e=>t(this._element,e)))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}Ie(Pb,dl);var _b=Pb;const Db=new WeakMap;class Lb extends _b{static get DEFAULTS(){return xe({placeholder:"",type:"text",tagName:"input"})}constructor(t,e){super(t,Ee(Lb.DEFAULTS,e)),Db.set(this,{}),this.registerHooks()}registerHooks(){this.addLocalHook("click",(()=>this.onClick())),this.addLocalHook("keyup",(t=>this.onKeyup(t)))}build(){super.build();const t=Db.get(this),e=this.hot.rootDocument.createElement("div");t.input=this._element.firstChild,Mt(this._element,"htUIInput"),Mt(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){if(!this.isBuilt())return;const t=Db.get(this).input;t.type=this.options.type,t.placeholder=this.translateIfPossible(this.options.placeholder),t.value=this.translateIfPossible(this.options.value)}focus(){this.isBuilt()&&Db.get(this).input.focus()}onClick(){}onKeyup(t){this.options.value=t.target.value}}var Vb=Lb;const Bb=new WeakMap;class Fb extends _b{static get DEFAULTS(){return xe({className:"htUISelect",wrapIt:!1})}constructor(t,e){super(t,Ee(Fb.DEFAULTS,e)),Bb.set(this,{}),this.menu=null,this.items=[],this.registerHooks()}registerHooks(){this.addLocalHook("click",(()=>this.onClick()))}setItems(t){this.items=this.translateNames(t),this.menu&&this.menu.setMenuItems(this.items)}translateNames(t){return O(t,(t=>{t.name=this.translateIfPossible(t.name)})),t}build(){super.build(),this.menu=new IC(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);const t=new _b(this.hot,{className:"htUISelectCaption"}),e=new _b(this.hot,{className:"htUISelectDropdown"}),o=Bb.get(this);o.caption=t,o.captionElement=t.element,o.dropdown=e,O([t,e],(t=>this._element.appendChild(t.element))),this.menu.addLocalHook("select",(t=>this.onMenuSelect(t))),this.menu.addLocalHook("afterClose",(()=>this.onMenuClosed())),this.update()}update(){if(!this.isBuilt())return;let t;t=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(ih),Bb.get(this).captionElement.textContent=t,super.update()}openOptions(){const t=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}))}closeOptions(){this.menu&&this.menu.close()}onMenuSelect(t){t.name!==dw&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}onMenuClosed(){this.runLocalHooks("afterClose")}onClick(){this.openOptions()}destroy(){this.menu&&(this.menu.destroy(),this.menu=null);const{caption:t,dropdown:e}=Bb.get(this);t&&t.destroy(),e&&e.destroy(),super.destroy()}}var Wb=Fb;class jb extends _v{constructor(t,e){super(t,{id:e.id,stateless:!1}),this.name=e.name,this.addSeparator=e.addSeparator,this.elements.push(new Wb(this.hot,{menuContainer:e.menuContainer})),this.elements.push(new Vb(this.hot,{placeholder:Dh})),this.elements.push(new Vb(this.hot,{placeholder:Lh})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",(t=>this.onConditionSelect(t))),this.getSelectElement().addLocalHook("afterClose",(()=>this.onSelectUIClosed())),O(this.getInputElements(),(t=>{t.addLocalHook("keydown",(t=>this.onInputKeyDown(t)))}))}setState(t){if(this.reset(),!t)return;const e=xe(t.command);e.name.startsWith(sh)&&(e.name=this.hot.getTranslatedPhrase(e.name)),this.getSelectElement().setValue(e),O(t.args,((t,o)=>{if(o>e.inputsCount-1)return!1;const n=this.getInputElement(o);n.setValue(t),n[e.inputsCount>o?"show":"hide"](),o||setTimeout((()=>n.focus()),10)}))}getState(){const t=this.getSelectElement().getValue()||Vv(Fv),e=[];return O(this.getInputElements(),((o,n)=>{t.inputsCount>n&&e.push(o.getValue())})),{command:t,args:e}}updateState(t,e){const o=Vv(t?t.name:Fv);this.state.setValueAtIndex(e,{command:o,args:t?t.args:[]}),t||O(this.getInputElements(),(t=>t.setValue(null)))}getSelectElement(){return this.elements.filter((t=>t instanceof Wb))[0]}getInputElement(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}getInputElements(){return this.elements.filter((t=>t instanceof Vb))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,o,n,s,i)=>{Mt(e.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Mt(e.parentNode,"border");const r=this.hot.rootDocument.createElement("div");return Mt(r,"htFiltersMenuLabel"),r.textContent=i,e.appendChild(r),e.parentNode.hasAttribute("ghost-table")||O(this.elements,(t=>e.appendChild(t.element))),e}}}reset(){const t=this.hot.getPlugin("filters").getSelectedColumn();let e=[Vv(Fv)];if(null!==t){const{visualIndex:o}=t;e=Ab(this.hot.getDataType(0,o,this.hot.countRows(),o))}O(this.getInputElements(),(t=>t.hide())),this.getSelectElement().setItems(e),super.reset(),this.getSelectElement().setValue(e[0])}onConditionSelect(t){O(this.getInputElements(),((e,o)=>{e[t.inputsCount>o?"show":"hide"](),0===o&&setTimeout((()=>e.focus()),10)})),this.runLocalHooks("change",t)}onSelectUIClosed(){this.runLocalHooks("afterClose")}onInputKeyDown(t){ao(t.keyCode,"ENTER")?(this.runLocalHooks("accept"),ho(t)):ao(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ho(t))}}var Ub=jb;const zb={};function $b(t){if(!zb[t])throw Error(`Operation with id "${t}" does not exist.`);const e=zb[t].func;return function(t,o){return e(t,o)}}function Gb(t){return zb[t].name}function Yb(t,e,o){zb[t]={name:e,func:o}}const Kb="conjunction",Xb=Ih;function qb(t,e){return t.every((t=>t.func(e)))}Yb(Kb,Xb,qb);const Qb="disjunction",Jb=Hh;function Zb(t,e){return t.some((t=>t.func(e)))}Yb(Qb,Jb,Zb);const tS="disjunctionWithExtraCondition",eS=Hh;function oS(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some((t=>t.func(e)))&&t[t.length-1].func(e)}Yb(tS,eS,oS);const nS=new WeakMap;class sS extends _b{static get DEFAULTS(){return xe({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(t,e){super(t,Ee(sS.DEFAULTS,e)),nS.set(this,{})}build(){super.build();const t=nS.get(this);t.input=this._element.firstChild;const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),t.label=e,this._element.appendChild(e),this.update()}update(){if(!this.isBuilt())return;const t=nS.get(this);t.input.checked=this.options.checked,t.label.textContent=this.translateIfPossible(this.options.label.textContent)}isChecked(){return this.options.checked}setChecked(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.options.checked=t,this.update()}focus(){this.isBuilt()&&nS.get(this).input.focus()}}var iS=sS;const rS=0;class lS extends _v{constructor(t,e){super(t,{id:e.id,stateless:!1}),this.name=e.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(Mt(e.parentNode,"htFiltersMenuOperators"),e.parentNode.hasAttribute("ghost-table")||O(this.elements,(t=>e.appendChild(t.element))),e)}}buildOperatorsElement(){const t=[Kb,Qb];O(t,(e=>{const o=new iS(this.hot,{name:"operator",label:{htmlFor:e,textContent:Gb(e)},value:e,checked:e===t[rS],id:e});o.addLocalHook("change",(t=>this.onRadioInputChange(t))),this.elements.push(o)}))}setChecked(t){if(this.elements.length<t)throw Error(j`Radio button with index ${t} doesn't exist.`);O(this.elements,((e,o)=>{e.setChecked(o===t)}))}getActiveOperationId(){const t=this.elements.find((t=>t instanceof iS&&t.isChecked()));return t?t.getValue():Kb}getState(){return this.getActiveOperationId()}setState(t){this.reset(),t&&this.getActiveOperationId()!==t&&O(this.elements,(e=>{e.setChecked(e.getValue()===t)}))}updateState(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kb,e=arguments.length>1?arguments[1]:void 0,o=t;o===tS&&(o=Qb),this.state.setValueAtIndex(e,o)}reset(){this.setChecked(rS)}onRadioInputChange(t){this.setState(t.target.value)}}var aS=lS;zn();function hS(t,e){let o=t;return""===o&&(o=`(${e})`),o}const cS=new Set([1]).has(1),dS=cS&&"function"===typeof Array.from;function uS(t){let e=t;return cS&&(e=new Set(e)),function(t){let o;return o=cS?e.has(t):!!~e.indexOf(t),o}}function gS(t){return null===t||void 0===t?"":t}function mS(t){let e=t;return e=dS?Array.from(new Set(e)):L(e),e=e.sort(((t,e)=>"number"===typeof t&&"number"===typeof e?t-e:t===e?0:t>e?1:-1)),e}function fS(t,e,o,n){const s=[],i=t===e;let r;return i||(r=uS(e)),O(t,(t=>{let e=!1;(i||r(t))&&(e=!0);const l={checked:e,value:t,visualValue:hS(t,o)};n&&n(l),s.push(l)})),s}const pS=new WeakMap;class wS extends _b{static get DEFAULTS(){return xe({href:"#",tagName:"a"})}constructor(t,e){super(t,Ee(wS.DEFAULTS,e)),pS.set(this,{})}build(){super.build();const t=pS.get(this);t.link=this._element.firstChild}update(){this.isBuilt()&&(pS.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}var CS=wS;const yS=new WeakMap,vS="multipleSelect.itemBox";class bS extends _b{static get DEFAULTS(){return xe({className:"htUIMultipleSelect",value:[]})}constructor(t,e){super(t,Ee(bS.DEFAULTS,e)),yS.set(this,{}),this.searchInput=new Vb(this.hot,{placeholder:_h,className:"htUIMultipleSelectSearch"}),this.selectAllUI=new CS(this.hot,{textContent:Oh,className:"htUISelectAll"}),this.clearAllUI=new CS(this.hot,{textContent:kh,className:"htUIClearAll"}),this.items=[],this.itemsBox=null,this.registerHooks()}registerHooks(){this.searchInput.addLocalHook("keydown",(t=>this.onInputKeyDown(t))),this.searchInput.addLocalHook("input",(t=>this.onInput(t))),this.selectAllUI.addLocalHook("click",(t=>this.onSelectAllClick(t))),this.clearAllUI.addLocalHook("click",(t=>this.onClearAllClick(t)))}setItems(t){this.items=t,this.itemsBox&&this.itemsBox.loadData(this.items)}setLocale(t){this.locale=t}getLocale(){return this.locale}getItems(){return[...this.items]}getValue(){return ES(this.items)}isSelectedAllValues(){return this.items.length===this.getValue().length}build(){super.build();const{rootDocument:t}=this.hot,e=t.createElement("div"),o=new _b(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(o.element),this._element.appendChild(e);const n=e=>{if(!this._element)return;this.itemsBox&&this.itemsBox.destroy(),Mt(e,"htUIMultipleSelectHot"),this.itemsBox=new this.hot.constructor(e,{data:this.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(t,e,o,n,s,i)=>{t.title=i.instance.getDataAtRowProp(e,i.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>this.itemsBox.container.scrollWidth-oe(t),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"}),this.itemsBox.init();const o=this.itemsBox.getShortcutManager(),n=o.getContext("grid");n.addShortcut({keys:[["Escape"]],callback:t=>{this.runLocalHooks("keydown",t,this)},group:vS})};n(e),setTimeout((()=>n(e)),100)}reset(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}update(){this.isBuilt()&&(this.itemsBox.loadData(RS(this.items,this.options.value)),super.update())}destroy(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,super.destroy()}onInput(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let o;o=""===e?[...this.items]:H(this.items,(t=>`${t.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0)),this.itemsBox.loadData(o)}onInputKeyDown(t){this.runLocalHooks("keydown",t,this);const e=Ce(ao,t.keyCode);e("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(ho(t),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}onSelectAllClick(t){const e=[];t.preventDefault(),O(this.itemsBox.getSourceData(),((t,o)=>{t.checked=!0,e.push(nl(t,o)[0])})),this.itemsBox.setSourceDataAtCell(e)}onClearAllClick(t){const e=[];t.preventDefault(),O(this.itemsBox.getSourceData(),((t,o)=>{t.checked=!1,e.push(nl(t,o)[0])})),this.itemsBox.setSourceDataAtCell(e)}}var SS=bS;function RS(t,e){const o=uS(e);return A(t,(t=>(t.checked=o(t.value),t)))}function ES(t){const e=[];return O(t,(t=>{t.checked&&e.push(t.value)})),e}const MS="by_value";function TS(t,e){let[o]=e;return o(t.value)}Bv(MS,TS,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[uS(e)]},showOperators:!1});class xS extends _v{constructor(t,e){super(t,{id:e.id,stateless:!1}),this.name=e.name,this.elements.push(new SS(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",(t=>this.onInputKeyDown(t)))}setState(t){if(this.reset(),t&&t.command.key===MS){const e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0]),e.setLocale(t.locale)}}getState(){const t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?Fv:MS},args:[t.getValue()],itemsSnapshot:e}}updateState(t){const e=(e,o,n,s,i)=>{const[r]=H(o,(t=>t.name===MS)),l={},a=this.hot.getTranslatedPhrase(Ah);if(r){const o=mS(A(s(e,i),(t=>t.value)));n&&(r.args[0]=n);const h=[],c=fS(o,r.args[0],a,(t=>{t.checked&&h.push(t.value)})),d=t.editedConditionStack.column;l.locale=this.hot.getCellMeta(0,d).locale,l.args=[h],l.command=Vv(MS),l.itemsSnapshot=c}else l.args=[],l.command=Vv(Fv);this.state.setValueAtIndex(e,l)};e(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&e(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter((t=>t instanceof SS))[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,o,n,s,i)=>{Mt(e.parentNode,"htFiltersMenuValue");const r=this.hot.rootDocument.createElement("div");return Mt(r,"htFiltersMenuLabel"),r.textContent=i,e.appendChild(r),e.parentNode.hasAttribute("ghost-table")||O(this.elements,(t=>e.appendChild(t.element))),e}}}reset(){const t=this.hot.getTranslatedPhrase(Ah),e=mS(this._getColumnVisibleValues()),o=fS(e,e,t);this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(e);const n=this.hot.getPlugin("filters").getSelectedColumn();null!==n&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,n.visualIndex).locale)}onInputKeyDown(t){ao(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ho(t))}_getColumnVisibleValues(){const t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:A(this.hot.getDataAtCol(t.visualIndex),(t=>gS(t)))}}var IS=xS;class HS extends _v{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(t,e){super(t,{id:e.id,stateless:!0}),this.name=e.name,this.elements.push(new Vb(this.hot,{type:"button",value:Nh,className:"htUIButton htUIButtonOK",identifier:HS.BUTTON_OK})),this.elements.push(new Vb(this.hot,{type:"button",value:Ph,className:"htUIButton htUIButtonCancel",identifier:HS.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){O(this.elements,(t=>{t.addLocalHook("click",((t,e)=>this.onButtonClick(t,e)))}))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(Mt(e.parentNode,"htFiltersMenuActionBar"),e.parentNode.hasAttribute("ghost-table")||O(this.elements,(t=>e.appendChild(t.element))),e)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}onButtonClick(t,e){e.options.identifier===HS.BUTTON_OK?this.accept():this.cancel()}}var AS=HS;const OS="ConditionCollection.filteringStates";class kS{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.hot=t,this.isMapRegistrable=e,this.filteringStates=new Ml,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(OS,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(t,e){var o;const n=this.filteringStates.getValueAtIndex(e),s=null!==(o=null===n||void 0===n?void 0:n.conditions)&&void 0!==o?o:[],i=null===n||void 0===n?void 0:n.operation;return this.isMatchInConditions(s,t,i)}isMatchInConditions(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Kb;return!t.length||$b(o)(t,e)}addCondition(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Kb,n=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,t).locale,i=A(e.args,(t=>"string"===typeof t?t.toLocaleLowerCase(s):t)),r=e.name||e.command.key;this.runLocalHooks("beforeAdd",t);const l=this.getOperation(t);if(l){if(l!==o)throw Error(j`The column of index ${t} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if($(zb[o]))throw new Error(j`Unexpected operation named \`${o}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const a=this.getConditions(t);0===a.length?this.filteringStates.setValueAtIndex(t,{operation:o,conditions:[{name:r,args:i,func:Lv(r,i)}]},n):a.push({name:r,args:i,func:Lv(r,i)}),this.runLocalHooks("afterAdd",t)}getConditions(t){var e,o;return null!==(e=null===(o=this.filteringStates.getValueAtIndex(t))||void 0===o?void 0:o.conditions)&&void 0!==e?e:[]}getOperation(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}getFilteredColumns(){return this.filteringStates.getEntries().map((t=>{let[e]=t;return e}))}getColumnStackPosition(t){return this.getFilteredColumns().indexOf(t)}exportAllConditions(){return I(this.filteringStates.getEntries(),((t,e)=>{let[o,{operation:n,conditions:s}]=e;return t.push({column:o,operation:n,conditions:A(s,(t=>{let{name:e,args:o}=t;return{name:e,args:o}}))}),t}),[])}importAllConditions(t){this.clean(),O(t,(t=>{O(t.conditions,(e=>this.addCondition(t.column,e)))}))}removeConditions(t){this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(t,e){const o=this.getConditions(t);return e?o.some((t=>t.name===e)):o.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(OS),this.filteringStates=null,this.clearLocalHooks()}}Ie(kS,dl);var NS=kS;class PS{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];this.conditionCollection=t,this.columnDataFactory=e}filter(){let t=[];return O(this.conditionCollection.getFilteredColumns(),((e,o)=>{let n=this.columnDataFactory(e);o&&(n=this._getIntersectData(n,t)),t=this.filterByColumn(e,n)})),t}filterByColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=[];return O(e,(e=>{void 0!==e&&this.conditionCollection.isMatch(e,t)&&o.push(e)})),o}_getIntersectData(t,e){const o=[];return O(e,(e=>{const n=e.meta.visualRow;void 0!==t[n]&&(o[n]=t[n])})),o}}var _S=PS;class DS{constructor(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];this.hot=t,this.conditionCollection=e,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",(t=>this._onConditionBeforeModify(t))),this.conditionCollection.addLocalHook("afterRemove",(t=>this.updateStatesAtColumn(t))),this.conditionCollection.addLocalHook("afterAdd",(t=>this.updateStatesAtColumn(t))),this.conditionCollection.addLocalHook("beforeClean",(()=>this._onConditionBeforeClean())),this.conditionCollection.addLocalHook("afterClean",(()=>this._onConditionAfterClean()))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,O(this.changes,(t=>{this.updateStatesAtColumn(t)})),this.changes.length=0}_onConditionBeforeModify(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}updateStatesAtColumn(t,e){var o=this;if(this.grouping)return void(-1===this.changes.indexOf(t)&&this.changes.push(t));const n=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(t);-1===s&&(s=this.latestEditedColumnPosition);const i=n.slice(0,s),r=n.slice(s);r.length&&r[0].column===t&&r.shift();const l=ye((function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const s=new NS(o.hot,!1),i=[].concat(t,n);s.importAllConditions(i);const r=o.columnDataFactory(e);let l;l=s.isEmpty()?r:new _S(s,(t=>o.columnDataFactory(t))).filter(),l=A(l,(t=>t.meta.visualRow));const a=uS(l);return s.destroy(),H(r,(t=>a(t.meta.visualRow)))}))(i),a=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:a},dependentConditionStacks:r,filteredRowsFactory:l,conditionArgsChange:e})}_onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}_onConditionAfterClean(){O(this.latestOrderStack,(t=>{this.updateStatesAtColumn(t)}))}destroy(){this.clearLocalHooks(),ke(this,((t,e)=>{this[e]=null}))}}Ie(DS,dl);var LS=DS;const VS="filters",BS=250;class FS extends hf{static get PLUGIN_KEY(){return VS}static get PLUGIN_PRIORITY(){return BS}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(t){super(t),this.eventManager=new Bo(this),this.dropdownMenuPlugin=null,this.conditionCollection=null,this.conditionUpdateObserver=null,this.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),this.filtersRowsMap=null,this.hot.addHook("afterGetColHeader",((t,e)=>this.onAfterGetColHeader(t,e)))}isEnabled(){return!!this.hot.getSettings()[VS]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Tl),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,e=t&&t.uiContainer||this.hot.rootDocument.body,o=t=>(t.addLocalHook("accept",(()=>this.onActionBarSubmit("accept"))),t.addLocalHook("cancel",(()=>this.onActionBarSubmit("cancel"))),t.addLocalHook("change",(e=>this.onComponentChange(t,e))),t),n=()=>`${this.hot.getTranslatedPhrase(Th)}:`,s=()=>`${this.hot.getTranslatedPhrase(xh)}:`;if(!this.components.get("filter_by_condition")){const t=new Ub(this.hot,{id:"filter_by_condition",name:n,addSeparator:!1,menuContainer:e});t.addLocalHook("afterClose",(()=>this.onSelectUIClosed())),this.components.set("filter_by_condition",o(t))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new aS(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const t=new Ub(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:e});t.addLocalHook("afterClose",(()=>this.onSelectUIClosed())),this.components.set("filter_by_condition2",o(t))}this.components.get("filter_by_value")||this.components.set("filter_by_value",o(new IS(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",o(new AS(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new NS(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new LS(this.hot,this.conditionCollection,(t=>this.getDataMapAtColumn(t))),this.conditionUpdateObserver.addLocalHook("update",(t=>this.updateComponents(t)))),this.components.forEach((t=>t.show())),this.addHook("beforeDropdownMenuSetItems",(t=>this.onBeforeDropdownMenuSetItems(t))),this.addHook("afterDropdownMenuDefaultOptions",(t=>this.onAfterDropdownMenuDefaultOptions(t))),this.addHook("afterDropdownMenuShow",(()=>this.onAfterDropdownMenuShow())),this.addHook("afterDropdownMenuHide",(()=>this.onAfterDropdownMenuHide())),this.addHook("afterChange",(t=>this.onAfterChange(t))),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),super.enablePlugin()}disablePlugin(){var t;this.enabled&&(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(((t,e)=>{t.destroy(),this.components.set(e,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));super.disablePlugin()}addCondition(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Kb;const s=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(s,{command:{key:e},args:o},n)}removeConditions(t){const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}clearConditions(t){if(void 0===t)this.conditionCollection.clean();else{const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}filter(){const t=this._createDataFilter(),e=!this.conditionCollection.isEmpty();let o=[];const n=this.conditionCollection.exportAllConditions(),s=this.hot.runHooks("beforeFilter",n);if(!1!==s)if(e){const e=[];this.hot.batchExecution((()=>{this.filtersRowsMap.clear(),o=A(t.filter(),(t=>t.meta.visualRow));const n=uS(o);tn(this.hot.countSourceRows()-1,(t=>{n(t)||e.push(t)})),O(e,(t=>{this.filtersRowsMap.setValueAtIndex(t,!0)}))}),!0),o.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",n),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}getSelectedColumn(){var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}clearColumnSelection(){const t=this.getSelectedColumn();null!==t&&this.hot.selectCell(0,t.visualIndex)}getDataMapAtColumn(t){const e=this.hot.toVisualColumn(t),o=[];return O(this.hot.getSourceDataAtCol(e),((t,n)=>{var s;const{row:i,col:r,visualCol:l,visualRow:a,type:h,instance:c,dateFormat:d,locale:u}=this.hot.getCellMeta(n,e),g=null!==(s=this.hot.getDataAtCell(this.hot.toVisualRow(n),e))&&void 0!==s?s:t;o.push({meta:{row:i,col:r,visualCol:l,visualRow:a,type:h,instance:c,dateFormat:d,locale:u},value:gS(g)})})),o}onAfterChange(t){t&&O(t,(t=>{const[,e]=t,o=this.hot.propToCol(e);this.conditionCollection.hasConditions(o)&&this.updateValueComponentCondition(o)}))}updateValueComponentCondition(t){const e=this.hot.getDataAtCol(t),o=mS(e);this.conditionUpdateObserver.updateStatesAtColumn(t,o)}restoreComponents(t){var e;const o=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach((t=>{t.isHidden()||t.restoreState(o)})),this.updateDependentComponentsVisibility()}onAfterDropdownMenuShow(){this.restoreComponents(Array.from(this.components.values()))}onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}onBeforeDropdownMenuSetItems(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",(()=>{this.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})}))}onAfterDropdownMenuDefaultOptions(t){t.items.push({name:dw}),this.components.forEach((e=>{t.items.push(e.getMenuItemDescriptor())}))}getOperationBasedOnArguments(t,e,o,n){let s=t;return s===Qb&&e.command.key!==Fv&&o.command.key!==Fv&&n.command.key!==Fv?s=tS:n.command.key!==Fv&&(e.command.key!==Fv&&o.command.key!==Fv||(s=Kb)),s}onActionBarSubmit(t){var e;if("accept"===t){const t=this.getSelectedColumn();var o;if(null===t)return void(null===(o=this.dropdownMenuPlugin)||void 0===o||o.close());const{physicalIndex:e}=t,n=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),i=this.components.get("filter_by_value").getState(),r=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),n,s,i);this.conditionUpdateObserver.groupChanges();let l=this.conditionCollection.getColumnStackPosition(e);-1===l&&(l=void 0),this.conditionCollection.removeConditions(e),n.command.key!==Fv&&(this.conditionCollection.addCondition(e,n,r,l),s.command.key!==Fv&&this.conditionCollection.addCondition(e,s,r,l)),i.command.key!==Fv&&this.conditionCollection.addCondition(e,i,r,l),this.conditionUpdateObserver.flush(),this.components.forEach((t=>t.saveState(e))),this.filtersRowsMap.clear(),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}onComponentChange(t,e){this.updateDependentComponentsVisibility(),t.constructor!==Ub||e.inputsCount||this.setListeningDropdownMenu()}onSelectUIClosed(){this.setListeningDropdownMenu()}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const t=this.components.get("filter_by_condition"),{command:e}=t.getState(),o=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents(...o):this.hideComponents(...o)}onAfterGetColHeader(t,e){const o=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(o)?Mt(e,"htFiltersActive"):Tt(e,"htFiltersActive")}_createDataFilter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new _S(t,(t=>this.getDataMapAtColumn(t)))}updateComponents(t){var e;if(null===(e=this.dropdownMenuPlugin)||void 0===e||!e.enabled)return;const{editedConditionStack:{conditions:o,column:n}}=t,s=o.filter((t=>t.name===MS)),i=o.filter((t=>t.name!==MS));if(s.length>=2||i.length>=3)mo(j`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const e=this.conditionCollection.getOperation(n);this.components.get("filter_by_condition").updateState(i[0],n),this.components.get("filter_by_condition2").updateState(i[1],n),this.components.get("filter_operators").updateState(e,n),this.components.get("filter_by_value").updateState(t)}}getIndexesOfComponents(){const t=[];if(!this.dropdownMenuPlugin)return t;const e=this.dropdownMenuPlugin.menu;for(var o=arguments.length,n=new Array(o),s=0;s<o;s++)n[s]=arguments[s];return O(n,(o=>{O(e.menuItems,((e,n)=>{e.key===o.getMenuItemDescriptor().key&&t.push(n)}))})),t}changeComponentsVisibility(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const e=this.dropdownMenuPlugin.menu,o=e.hotMenu,n=o.getPlugin("hiddenRows");for(var s=arguments.length,i=new Array(s>1?s-1:0),r=1;r<s;r++)i[r-1]=arguments[r];const l=this.getIndexesOfComponents(...i);t?n.showRows(l):n.hideRows(l),o.render()}hideComponents(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.changeComponentsVisibility(!1,...e)}showComponents(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.changeComponentsVisibility(!0,...e)}destroy(){this.enabled&&(this.components.forEach(((t,e)=>{null!==t&&(t.destroy(),this.components.set(e,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}const WS="internal-use-in-handsontable",jS={licenseKey:WS,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function US(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:null===(e=t[eE])||void 0===e||null===(e=e.language)||void 0===e?void 0:e.langCode}}function zS(t){return Object.keys(t).reduce(((e,o)=>("hyperformula"!==o&&(e[o]=t[o]),e)),{})}function $S(t){var e;const o=t[eE],n=zS(null!==o&&void 0!==o&&null!==(e=o.engine)&&void 0!==e&&e.hyperformula?o.engine:{}),s=US(t);return{...jS,...n,...s}}function GS(t){var e;const o=t[eE],n=zS(null!==o&&void 0!==o&&null!==(e=o.engine)&&void 0!==e&&e.hyperformula?o.engine:{}),s=US(t);return{...n,...s}}function YS(t,e){return Object.keys(e).some((o=>void 0!==e[o]&&e[o]!==t[o]))}function KS(){const t="engine_relationship",e=Mo(eE);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function XS(){const t="shared_engine_usage",e=Mo(eE);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function qS(t){const e=t.getSettings(),o=e[eE],n=null===o||void 0===o?void 0:o.engine;if(!0===o)return null;if($(n))return null;var s;if("function"===typeof n.hyperformula||"function"===typeof n)return QS(null!==(s=n.hyperformula)&&void 0!==s?s:n,e,t);if("object"===typeof n&&$(n.hyperformula)){const e=KS(),o=XS().get(n);return e.has(n)||e.set(n,[]),e.get(n).push(t),o&&o.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:WS}),n.getConfig().leapYear1900===jS.leapYear1900&&!1!==He(n.getConfig().nullDate,jS.nullDate)||mo(j`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}function QS(t,e,o){const n=e[eE],s=$S(e),i=KS(),r=XS();tR(t,n.functions),eR(t,n.language);const l=t.buildEmpty(s);return i.set(l,[o]),r.set(l,[o.guid]),oR(l,n.namedExpressions),l.on("sheetAdded",(()=>{l.rebuildAndRecalculate()})),l.on("sheetRemoved",(()=>{l.rebuildAndRecalculate()})),l}function JS(t){var e;const o=KS(),n=0===o.size?[]:Array.from(null!==(e=o.get(t))&&void 0!==e?e:[]);return new Map(n.map((t=>[t.getPlugin("formulas").sheetId,t])))}function ZS(t,e){if(t){const o=KS(),n=o.get(t),s=XS(),i=s.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),0===n.length&&o.delete(t)),i&&i.includes(e.guid)&&(i.splice(i.indexOf(e.guid),1),0===i.length&&(s.delete(t),t.destroy()))}}function tR(t,e){e&&e.forEach((e=>{const{name:o,plugin:n,translations:s}=e;try{t.registerFunction(o,n,s)}catch(i){mo(i.message)}}))}function eR(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(o){mo(o.message)}}}function oR(t,e){e&&(t.suspendEvaluation(),e.forEach((e=>{const{name:o,expression:n,scope:s,options:i}=e;try{t.addNamedExpression(o,n,s,i)}catch(r){mo(r.message)}})),t.resumeEvaluation())}function nR(t,e){return!$(e)&&t.doesSheetExist(e)||(e=t.addSheet(e)),e}const sR="DD/MM/YYYY";function iR(t){return"string"===typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function rR(t){return iR(t)?t.substr(1):t}function lR(t){return"string"===typeof t&&t.startsWith("=")}function aR(t,e){return"string"===typeof t&&"date"===e}function hR(t,e){return E(t,e,!0).isValid()}function cR(t,e){return E(t,e,!0).format(sR)}function dR(t,e){return E(t,sR,!0).format(e)}function uR(t,e){const o=-1,n=new Date(Date.UTC(0,0,t+o));return E(n).format(e)}function gR(t,e,o){mR(t,e),e.set(t,o)}function mR(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fR(t,e){var o=CR(t,e,"get");return pR(t,o)}function pR(t,e){return e.get?e.get.call(t):e.value}function wR(t,e,o){var n=CR(t,e,"set");return yR(t,n,o),o}function CR(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function yR(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var vR=new WeakMap,bR=new WeakMap,SR=new WeakMap,RR=new WeakMap,ER=new WeakMap,MR=new WeakMap,TR=new WeakMap;class xR{constructor(t,e,o){gR(this,vR,{writable:!0,value:void 0}),gR(this,bR,{writable:!0,value:void 0}),gR(this,SR,{writable:!0,value:void 0}),gR(this,RR,{writable:!0,value:[]}),gR(this,ER,{writable:!0,value:[]}),gR(this,MR,{writable:!0,value:void 0}),gR(this,TR,{writable:!0,value:[]}),wR(this,vR,t),wR(this,bR,e),wR(this,SR,o)}setRemovedHfIndexes(t){return wR(this,TR,t.map((t=>{const e=fR(this,bR).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(e)}))),fR(this,TR)}getRemovedHfIndexes(){return fR(this,TR)}getHfIndexFromVisualIndex(t){const e=fR(this,bR).getIndexesSequence(),o=fR(this,bR).getNotTrimmedIndexes();return e.indexOf(o[t])}syncMoves(t){const e=1,o=`move${lt(fR(this,vR))}s`;fR(this,SR).getEngine().batch((()=>{t.forEach((t=>{const n=t.from!==t.to,s=t.from+1!==t.to;n&&s&&fR(this,SR).getEngine()[o](fR(this,SR).getSheetId(),t.from,e,t.to)}))}))}storeMovesInformation(t,e,o){!1!==o&&(wR(this,ER,t.map((t=>this.getHfIndexFromVisualIndex(t)))),wR(this,MR,this.getHfIndexFromVisualIndex(e)))}getMoveLine(t,e){const o=fR(this,bR).getNumberOfIndexes(),n=Array.from(Array(o).keys()).filter((e=>!1===t.includes(e)));var s;return 0===e?null!==(s=n[e])&&void 0!==s?s:0:n[e-1]+1}getInitiallyCalculatedMoves(t,e){let o=this.getMoveLine(t,e);const n=[];return t.forEach((t=>{const e={from:t,to:o};n.forEach((t=>{const o=t.from>t.to,n=t.to<=e.from,s=t.from>e.from;s&&n&&o&&(e.from+=1)})),e.from>=o&&(o+=1),n.push(e)})),n}adjustedCalculatedMoves(t){return t.forEach(((e,o)=>{const n=t.slice(o+1);n.forEach((t=>{const o=t.from<t.to;t.from>e.from&&o&&(t.from-=1)}))})),t}calculateAndSyncMoves(t,e){if(fR(this,SR).isPerformingUndoRedo())return;if(!1===t||!1===e)return;const o=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(fR(this,ER),fR(this,MR)));null===fR(this,SR).getSheetId()?fR(this,SR).getPostponeAction((()=>this.syncMoves(o))):this.syncMoves(o)}getIndexesChangeSyncMethod(){const t=`set${lt(fR(this,vR))}Order`;return e=>{if(fR(this,SR).isPerformingUndoRedo())return;const o=fR(this,bR).getIndexesSequence();if("update"===e){const e=fR(this,RR).map((t=>o.indexOf(t))),n=fR(this,SR).getEngine().getSheetDimensions(fR(this,SR).getSheetId());let s;s="row"===fR(this,vR)?n.height:n.width;const i=e.length;for(let t=i;t<s;t+=1)e.push(t);fR(this,SR).getEngine()[t](fR(this,SR).getSheetId(),e)}wR(this,RR,o)}}init(){wR(this,RR,fR(this,bR).getIndexesSequence())}}var IR=xR;function HR(t,e,o){AR(t,e),e.set(t,o)}function AR(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OR(t,e){var o=PR(t,e,"get");return kR(t,o)}function kR(t,e){return e.get?e.get.call(t):e.value}function NR(t,e,o){var n=PR(t,e,"set");return _R(t,n,o),o}function PR(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function _R(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var DR=new WeakMap,LR=new WeakMap,VR=new WeakMap,BR=new WeakMap,FR=new WeakMap,WR=new WeakMap,jR=new WeakMap;class UR{constructor(t,e,o){HR(this,DR,{writable:!0,value:void 0}),HR(this,LR,{writable:!0,value:void 0}),HR(this,VR,{writable:!0,value:void 0}),HR(this,BR,{writable:!0,value:!1}),HR(this,FR,{writable:!0,value:!1}),HR(this,WR,{writable:!0,value:null}),HR(this,jR,{writable:!0,value:null}),NR(this,DR,new IR("row",t,this)),NR(this,LR,new IR("column",e,this)),NR(this,VR,o)}getForAxis(t){return OR(this,"row"===t?DR:LR)}setPerformUndo(t){NR(this,BR,t)}setPerformRedo(t){NR(this,FR,t)}isPerformingUndoRedo(){return OR(this,BR)||OR(this,FR)}getSheetId(){return OR(this,jR)}getEngine(){return OR(this,WR)}getPostponeAction(){return OR(this,VR)}setupSyncEndpoint(t,e){NR(this,WR,t),NR(this,jR,e),OR(this,DR).init(),OR(this,LR).init()}}var zR=UR;function $R(t,e,o){return e=GR(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function GR(t){var e=YR(t,"string");return"symbol"===typeof e?e:String(e)}function YR(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function KR(t,e,o){XR(t,e),e.set(t,o)}function XR(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qR(t,e,o){var n=ZR(t,e,"set");return QR(t,n,o),o}function QR(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function JR(t,e){var o=ZR(t,e,"get");return tE(t,o)}function ZR(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function tE(t,e){return e.get?e.get.call(t):e.value}const eE="formulas",oE=["maxRows","maxColumns","language"],nE=260;Ro.getSingleton().register("afterNamedExpressionAdded"),Ro.getSingleton().register("afterNamedExpressionRemoved"),Ro.getSingleton().register("afterSheetAdded"),Ro.getSingleton().register("afterSheetRemoved"),Ro.getSingleton().register("afterSheetRenamed"),Ro.getSingleton().register("afterFormulasValuesUpdate");const sE=t=>"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t;var iE=new WeakMap,rE=new WeakMap,lE=new WeakMap;class aE extends hf{constructor(){var t;super(...arguments),t=this,KR(this,iE,{writable:!0,value:!1}),KR(this,rE,{writable:!0,value:!1}),KR(this,lE,{writable:!0,value:[["valuesUpdated",function(){return t.onEngineValuesUpdated(...arguments)}],["namedExpressionAdded",function(){return t.onEngineNamedExpressionsAdded(...arguments)}],["namedExpressionRemoved",function(){return t.onEngineNamedExpressionsRemoved(...arguments)}],["sheetAdded",function(){return t.onEngineSheetAdded(...arguments)}],["sheetRenamed",function(){return t.onEngineSheetRenamed(...arguments)}],["sheetRemoved",function(){return t.onEngineSheetRemoved(...arguments)}]]}),$R(this,"staticRegister",Mo("formulas")),$R(this,"engine",null),$R(this,"sheetName",null),$R(this,"indexSyncer",null),$R(this,"rowAxisSyncer",null),$R(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return eE}static get PLUGIN_PRIORITY(){return nE}static get SETTING_KEYS(){return[eE,...oE]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[eE]}enablePlugin(){var t,e=this;if(!this.enabled)if(this.engine=null!==(t=qS(this.hot))&&void 0!==t?t:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const t=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==t&&(this.sheetName=t)}this.addHook("beforeLoadData",(function(){return e.onBeforeLoadData(...arguments)})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData(...arguments)})),this.addHook("beforeUpdateData",(function(){return e.onBeforeLoadData(...arguments)})),this.addHook("afterUpdateData",(function(){return e.onAfterLoadData(...arguments)})),this.addHook("modifyData",(function(){return e.onModifyData(...arguments)})),this.addHook("modifySourceData",(function(){return e.onModifySourceData(...arguments)})),this.addHook("beforeValidate",(function(){return e.onBeforeValidate(...arguments)})),this.addHook("afterSetSourceDataAtCell",(function(){return e.onAfterSetSourceDataAtCell(...arguments)})),this.addHook("afterSetDataAtCell",(function(){return e.onAfterSetDataAtCell(...arguments)})),this.addHook("afterSetDataAtRowProp",(function(){return e.onAfterSetDataAtCell(...arguments)})),this.addHook("beforeCreateRow",(function(){return e.onBeforeCreateRow(...arguments)})),this.addHook("beforeCreateCol",(function(){return e.onBeforeCreateCol(...arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow(...arguments)})),this.addHook("afterCreateCol",(function(){return e.onAfterCreateCol(...arguments)})),this.addHook("beforeRemoveRow",(function(){return e.onBeforeRemoveRow(...arguments)})),this.addHook("beforeRemoveCol",(function(){return e.onBeforeRemoveCol(...arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow(...arguments)})),this.addHook("afterRemoveCol",(function(){return e.onAfterRemoveCol(...arguments)})),this.indexSyncer=new zR(this.hot.rowIndexMapper,this.hot.columnIndexMapper,(t=>{this.hot.addHookOnce("init",(()=>{t()}))})),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",((t,e,o,n)=>{this.rowAxisSyncer.storeMovesInformation(t,e,n)})),this.hot.addHook("beforeColumnMove",((t,e,o,n)=>{this.columnAxisSyncer.storeMovesInformation(t,e,n)})),this.hot.addHook("afterRowMove",((t,e,o,n,s)=>{this.rowAxisSyncer.calculateAndSyncMoves(n,s)})),this.hot.addHook("afterColumnMove",((t,e,o,n,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(n,s)})),this.hot.addHook("beforeColumnFreeze",((t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart,e)})),this.hot.addHook("afterColumnFreeze",((t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)})),this.hot.addHook("beforeColumnUnfreeze",((t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart-1,e)})),this.hot.addHook("afterColumnUnfreeze",((t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)})),this.addHook("afterCellMetaReset",(function(){return e.onAfterCellMetaReset(...arguments)})),this.addHook("beforeUndo",(()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()})),this.addHook("beforeRedo",(()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformUndo(!1)})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformRedo(!1)})),this.addHook("afterDetachChild",(function(){return e.onAfterDetachChild(...arguments)})),this.addHook("beforeAutofill",(function(){return e.onBeforeAutofill(...arguments)})),JR(this,lE).forEach((t=>{let[e,o]=t;return this.engine.on(e,o)})),super.enablePlugin()}else mo("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}disablePlugin(){JR(this,lE).forEach((t=>{let[e,o]=t;return this.engine.off(e,o)})),ZS(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(t){const e=GS(this.hot.getSettings());YS(this.engine.getConfig(),e)&&this.engine.updateConfig(e);const o=this.hot.getSettings()[eE];if(z(o)&&z(o.sheetName)&&o.sheetName!==this.sheetName&&this.switchSheet(o.sheetName),!t.data&&null===this.sheetName){const t=this.hot.getSettings()[eE].sheetName;t&&this.engine.doesSheetExist(t)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!==t&&void 0!==t?t:void 0,this.hot.getSourceDataArray())}super.updatePlugin(t)}destroy(){JR(this,lE).forEach((t=>{var e;let[o,n]=t;return null===(e=this.engine)||void 0===e?void 0:e.off(o,n)})),qR(this,lE,null),ZS(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(t,e){if(z(e)&&!il(e))return mo("The provided data should be an array of arrays."),!1;if(void 0!==t&&null!==t&&this.engine.doesSheetExist(t))return mo("Sheet with the provided name already exists."),!1;try{const o=this.engine.addSheet(null!==t&&void 0!==t?t:void 0);return e&&this.engine.setSheetContent(this.engine.getSheetId(o),e),o}catch(o){return mo(o.message),!1}}switchSheet(t){if(!this.engine.doesSheetExist(t))return void fo(`The sheet named \`${t}\` does not exist, switch aborted.`);this.sheetName=t;const e=this.engine.getSheetSerialized(this.sheetId);e.length>0&&this.hot.loadData(e,`${lt(eE)}.switchSheet`)}getCellType(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const n=this.hot.toPhysicalRow(t),s=this.hot.toPhysicalColumn(e);return null!==n&&null!==s?this.engine.getCellType({sheet:o,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)}):"EMPTY"}isFormulaCellType(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:o,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)})}renderDependentSheets(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=new Set;t.forEach((t=>{var e;const n=null===t||void 0===t||null===(e=t.address)||void 0===e?void 0:e.sheet;void 0!==n&&(o.has(n)||o.add(n))})),JS(this.engine).forEach(((t,n)=>{var s;(e||n!==this.sheetId)&&o.has(n)&&(t.render(),null===(s=t.view)||void 0===s||s.adjustElementsSize())}))}validateDependentCells(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const o=t=>{var e;const{row:o,col:n,sheet:s}=null!==(e=null===t||void 0===t?void 0:t.address)&&void 0!==e?e:{};return z(s)?`${s}:${o}x${n}`:""},n=new Set(e.map((t=>o(t))));t.forEach((t=>{var e,s;const{row:i,col:r}=null!==(e=t.address)&&void 0!==e?e:{};if(!1===z(i)||!1===z(r)||i>=this.hot.countRows()||r>=this.hot.countCols())return;const l=null===t||void 0===t||null===(s=t.address)||void 0===s?void 0:s.sheet,a=o(t);if(void 0!==l&&!n.has(a)){const t=JS(this.engine).get(l);if(!t)return;t.validateCell(t.getDataAtCell(i,r),t.getCellMeta(i,r),(()=>{}))}}))}syncChangeWithEngine(t,e,o){const n={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(n))return void mo(`Not possible to set cell data at ${JSON.stringify(n)}`);const s=this.hot.getCellMeta(t,e);return aR(o,s.type)&&(hR(o,s.dateFormat)?o=cR(o,s.dateFormat):!1===lR(o)&&(o=`'${o}`)),this.engine.setCellContents(n,o)}onBeforeValidate(t,e,o){const n=this.hot.propToCol(o);if(this.isFormulaCellType(e,n)){const t={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},o=this.hot.getCellMeta(e,n);let s=this.engine.getCellValue(t);return"date"===o.type&&Jo(s)&&(s=uR(s,o.dateFormat)),"object"===typeof s&&null!==s?s.value:s}return t}onBeforeAutofill(t,e,o){const{row:n,col:s}=e.getTopStartCorner(),{row:i,col:r}=e.getBottomEndCorner(),{row:l,col:a}=o.getTopStartCorner(),{row:h,col:c}=o.getBottomEndCorner(),d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId}},u={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(u))return!1;const g=this.engine.getFillRangeData(d,u),{row:m,col:f}=d.start,{row:p,col:w}=d.end,C=p-m+1,y=w-f+1;for(let v=0;v<g.length;v+=1)for(let t=0;t<g[v].length;t+=1){const e=g[v][t],o=v%C,n=t%y,s=this.hot.getCellMeta(o,n);aR(e,s.type)&&(e.startsWith("'")?g[v][t]=e.slice(1):!1===this.isFormulaCellType(o,n,this.sheetId)&&(g[v][t]=dR(e,s.dateFormat)))}return g}onBeforeLoadData(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";o.includes(lt(eE))||qR(this,rE,$(this.hot.getSettings().data))}onAfterCellMetaReset(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach(((o,n)=>{o.forEach(((o,s)=>{const i=this.hot.getCellMeta(n,s),r=i.dateFormat;aR(o,i.type)&&(e=!0,hR(o,r)?t[n][s]=cR(o,r):!1===this.isFormulaCellType(n,s)&&(t[n][s]=`'${o}`))}))})),!0===e&&(qR(this,iE,!0),this.engine.setSheetContent(this.sheetId,t),qR(this,iE,!1))}onAfterLoadData(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!o.includes(lt(eE)))if(this.sheetName=nR(this.engine,this.hot.getSettings()[eE].sheetName),JR(this,rE))this.switchSheet(this.sheetName);else{const t=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,t)){qR(this,iE,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),qR(this,iE,!1)}}}onModifyData(t,e,o,n){if("get"!==n||JR(this,iE)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(t);if(null===s||null===e)return;const i=this.isFormulaCellType(s,e);if(!i){const t=this.getCellType(s,e);if("ARRAY"!==t)return void(iR(o.value)&&(o.value=rR(o.value)))}const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let l=this.engine.getCellValue(r);const a=this.hot.getCellMeta(s,e);"date"===a.type&&Jo(l)&&(l=uR(l,a.dateFormat));const h="object"===typeof l&&null!==l?l.value:l;o.value=h}onModifySourceData(t,e,o,n){if("get"!==n||JR(this,iE)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(t),i=this.hot.propToCol(e);if(null===s||null===i)return;const r=this.isFormulaCellType(s,i);if(!r){const t=this.getCellType(s,i);if("ARRAY"!==t)return}const l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===l.width&&0===l.height)return;const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId};o.value=this.engine.getCellSerialized(a)}onAfterSetDataAtCell(t,e){if(sE(e))return;const o=[],n=[],s=this.engine.batch((()=>{t.forEach((t=>{let[e,s,,i]=t;const r=this.hot.propToCol(s),l=this.hot.toPhysicalRow(e),a=this.hot.toPhysicalColumn(r),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};null!==l&&null!==a?this.syncChangeWithEngine(e,r,i):o.push([e,r,i]),n.push({address:h})}))}));o.length&&this.hot.addHookOnce("afterChange",(()=>{const t=this.engine.batch((()=>{o.forEach((t=>{let[e,o,n]=t;this.syncChangeWithEngine(e,o,n)}))}));this.renderDependentSheets(t,!0)})),this.renderDependentSheets(s),this.validateDependentCells(s,n)}onAfterSetSourceDataAtCell(t,e){if(sE(e))return;const o=[],n=[];t.forEach((t=>{let[e,s,,i]=t;const r=this.hot.propToCol(s);if(!Jo(r))return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(l)?(n.push({address:l}),o.push(...this.engine.setCellContents(l,i))):mo(`Not possible to set source cell data at ${JSON.stringify(l)}`)})),this.renderDependentSheets(o),this.validateDependentCells(o,n)}onBeforeCreateRow(t,e){let o=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(o=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[o,e]))return!1}onBeforeCreateCol(t,e){let o=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(o=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[o,e]))return!1}onBeforeRemoveRow(t,e,o){const n=this.rowAxisSyncer.setRemovedHfIndexes(o),s=n.every((t=>this.engine.isItPossibleToRemoveRows(this.sheetId,[t,1])));return!1!==s&&void 0}onBeforeRemoveCol(t,e,o){const n=this.columnAxisSyncer.setRemovedHfIndexes(o),s=n.every((t=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[t,1])));return!1!==s&&void 0}onAfterCreateRow(t,e,o){if(sE(o))return;const n=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}onAfterCreateCol(t,e,o){if(sE(o))return;const n=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}onAfterRemoveRow(t,e,o,n){if(sE(n))return;const s=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),i=this.engine.batch((()=>{s.forEach((t=>{this.engine.removeRows(this.sheetId,[t,1])}))}));this.renderDependentSheets(i)}onAfterRemoveCol(t,e,o,n){if(sE(n))return;const s=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),i=this.engine.batch((()=>{s.forEach((t=>{this.engine.removeColumns(this.sheetId,[t,1])}))}));this.renderDependentSheets(i)}onAfterDetachChild(t,e,o){var n;qR(this,iE,!0);const s=this.hot.getSourceDataArray(o,0,o+((null===(n=e.__children)||void 0===n?void 0:n.length)||0),this.hot.countSourceCols());qR(this,iE,!1),s.forEach(((t,e)=>{t.forEach(((t,n)=>{this.engine.setCellContents({col:n,row:o+e,sheet:this.sheetId},[[t]])}))}))}onEngineValuesUpdated(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}onEngineNamedExpressionsAdded(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}onEngineNamedExpressionsRemoved(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}onEngineSheetAdded(t){this.hot.runHooks("afterSheetAdded",t)}onEngineSheetRenamed(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}onEngineSheetRemoved(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}}function hE(t){return{key:"hidden_columns_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[,o,,n]=t;o-n!==0&&(e=1)}return this.getTranslatedPhrase(Za,e)},callback(){const{from:e,to:o}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.col,o.col),0),s=Math.max(e.col,o.col),i=[];for(let t=n;t<=s;t+=1)i.push(t);t.hideColumns(i);const r=i[i.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(r,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function cE(t){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(th,t)},callback(){var o,n;if(0===e.length)return;let s=e[0],i=e[e.length-1];s=null!==(o=this.columnIndexMapper.getNearestNotHiddenIndex(s-1,-1))&&void 0!==o?o:0,i=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(i+1,1))&&void 0!==n?n:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0);const r=i-s+1===this.countCols();r||this.selectColumns(s,i)},disabled:!1,hidden(){const o=A(t.getHiddenColumns(),(t=>this.toPhysicalColumn(t)));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||o.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),s=n.getTopStartCorner().col,i=n.getBottomEndCorner().col,r=this.columnIndexMapper,l=r.getRenderableFromVisualIndex(s),a=r.getRenderableFromVisualIndex(i),h=r.getNotTrimmedIndexes(),c=[];if(s!==i){const t=i-s+1,e=a-l+1;if(t>e){const t=h.slice(s,i+1);c.push(...t.filter((t=>o.includes(t))))}}else if(0===l&&l<s)c.push(...h.slice(0,s));else if(null===l)c.push(...h.slice(0,this.countCols()));else{const t=this.countCols()-1,e=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(t,-1));a===e&&t>i&&c.push(...h.slice(i+1))}return O(c,(t=>{e.push(this.toVisualColumn(t))})),0===e.length}}}function dE(t,e,o){uE(t,e),e.set(t,o)}function uE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gE(t,e){var o=pE(t,e,"get");return mE(t,o)}function mE(t,e){return e.get?e.get.call(t):e.value}function fE(t,e,o){var n=pE(t,e,"set");return wE(t,n,o),o}function pE(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function wE(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}Ro.getSingleton().register("beforeHideColumns"),Ro.getSingleton().register("afterHideColumns"),Ro.getSingleton().register("beforeUnhideColumns"),Ro.getSingleton().register("afterUnhideColumns");const CE="hiddenColumns",yE=310;var vE=new WeakMap,bE=new WeakMap;class SE extends hf{constructor(){super(...arguments),dE(this,vE,{writable:!0,value:{}}),dE(this,bE,{writable:!0,value:null})}static get PLUGIN_KEY(){return CE}static get PLUGIN_PRIORITY(){return yE}isEnabled(){return!!this.hot.getSettings()[CE]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[CE];Ae(e)&&(fE(this,vE,e),$(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),fE(this,bE,new bl),gE(this,bE).addLocalHook("init",(()=>this.onMapInit())),this.hot.columnIndexMapper.registerMap(this.pluginName,gE(this,bE)),this.addHook("afterContextMenuDefaultOptions",(function(){return t.onAfterContextMenuDefaultOptions(...arguments)})),this.addHook("afterGetCellMeta",((t,e,o)=>this.onAfterGetCellMeta(t,e,o))),this.addHook("modifyColWidth",((t,e)=>this.onModifyColWidth(t,e))),this.addHook("afterGetColHeader",(function(){return t.onAfterGetColHeader(...arguments)})),this.addHook("modifyCopyableRange",(t=>this.onModifyCopyableRange(t))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),fE(this,vE,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(t){const e=this.getHiddenColumns(),o=this.isValidConfig(t);let n=e;const s=gE(this,bE).getValues().slice(),i=t.length>0;if(o&&i){const e=t.map((t=>this.hot.toPhysicalColumn(t)));O(e,(t=>{s[t]=!1})),n=I(s,((t,e,o)=>(e&&t.push(this.hot.toVisualColumn(o)),t)),[])}const r=this.hot.runHooks("beforeUnhideColumns",e,n,o&&i);!1!==r&&(o&&i&&gE(this,bE).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",e,n,o&&i,o&&n.length<e.length))}showColumn(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.showColumns(e)}hideColumns(t){const e=this.getHiddenColumns(),o=this.isValidConfig(t);let n=e;o&&(n=Array.from(new Set(e.concat(t))));const s=this.hot.runHooks("beforeHideColumns",e,n,o);!1!==s&&(o&&this.hot.batchExecution((()=>{O(t,(t=>{gE(this,bE).setValueAtIndex(this.hot.toPhysicalColumn(t),!0)}))}),!0),this.hot.runHooks("afterHideColumns",e,n,o,o&&n.length>e.length))}hideColumn(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.hideColumns(e)}getHiddenColumns(){return A(gE(this,bE).getHiddenIndexes(),(t=>this.hot.toVisualColumn(t)))}isHidden(t){return gE(this,bE).getValueAtIndex(this.hot.toPhysicalColumn(t))||!1}isValidConfig(t){const e=this.hot.countCols();return!!(Array.isArray(t)&&t.length>0)&&t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}resetCellsMeta(){O(this.hot.getCellsMeta(),(t=>{t&&(t.skipColumnOnPaste=!1)}))}onModifyColWidth(t,e){return this.isHidden(e)?0:gE(this,vE).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&"number"===typeof t&&this.hot.hasColHeaders()?t+15:void 0}onAfterGetCellMeta(t,e,o){if(!1===gE(this,vE).copyPasteEnabled&&this.isHidden(e)&&(o.skipColumnOnPaste=!0),this.isHidden(e-1))o.className=o.className||"",-1===o.className.indexOf("afterHiddenColumn")&&(o.className+=" afterHiddenColumn");else if(o.className){const t=o.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenColumn");e>-1&&t.splice(e,1),o.className=t.join(" ")}}}onModifyCopyableRange(t){if(gE(this,vE).copyPasteEnabled)return t;const e=[],o=(t,o,n,s)=>{e.push({startRow:t,endRow:o,startCol:n,endCol:s})};return O(t,(t=>{let e=!0,n=0;tn(t.startCol,t.endCol,(s=>{this.isHidden(s)?(e||o(t.startRow,t.endRow,n,s-1),e=!0):(e&&(n=s),s===t.endCol&&o(t.startRow,t.endRow,n,s),e=!1)}))})),e}onAfterGetColHeader(t,e){if(!gE(this,vE).indicators||t<0)return;const o=[];t>=1&&this.isHidden(t-1)&&o.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&o.push("beforeHiddenColumn"),Mt(e,o)}onAfterContextMenuDefaultOptions(t){t.items.push({name:dw},hE(this),cE(this))}onMapInit(){Array.isArray(gE(this,vE).columns)&&this.hideColumns(gE(this,vE).columns)}destroy(){fE(this,vE,null),fE(this,bE,null),super.destroy()}}function RE(t){return{key:"hidden_rows_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[o,,n]=t;o-n!==0&&(e=1)}return this.getTranslatedPhrase(eh,e)},callback(){const{from:e,to:o}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.row,o.row),0),s=Math.max(e.row,o.row),i=[];for(let t=n;t<=s;t+=1)i.push(t);t.hideRows(i);const r=i[i.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(r,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function EE(t){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(oh,t)},callback(){var o,n;if(0===e.length)return;let s=e[0],i=e[e.length-1];s=null!==(o=this.rowIndexMapper.getNearestNotHiddenIndex(s-1,-1))&&void 0!==o?o:0,i=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(i+1,1))&&void 0!==n?n:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0);const r=i-s+1===this.countRows();r||this.selectRows(s,i)},disabled:!1,hidden(){const o=A(t.getHiddenRows(),(t=>this.toPhysicalRow(t)));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||o.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),s=n.getTopStartCorner().row,i=n.getBottomEndCorner().row,r=this.rowIndexMapper,l=r.getRenderableFromVisualIndex(s),a=r.getRenderableFromVisualIndex(i),h=r.getNotTrimmedIndexes(),c=[];if(s!==i){const t=i-s+1,e=a-l+1;if(t>e){const t=h.slice(s,i+1);c.push(...t.filter((t=>o.includes(t))))}}else if(0===l&&l<s)c.push(...h.slice(0,s));else if(null===l)c.push(...h.slice(0,this.countRows()));else{const t=this.countRows()-1,e=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(t,-1));a===e&&t>i&&c.push(...h.slice(i+1))}return O(c,(t=>{e.push(this.toVisualRow(t))})),0===e.length}}}function ME(t,e,o){TE(t,e),e.set(t,o)}function TE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xE(t,e){var o=AE(t,e,"get");return IE(t,o)}function IE(t,e){return e.get?e.get.call(t):e.value}function HE(t,e,o){var n=AE(t,e,"set");return OE(t,n,o),o}function AE(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function OE(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}Ro.getSingleton().register("beforeHideRows"),Ro.getSingleton().register("afterHideRows"),Ro.getSingleton().register("beforeUnhideRows"),Ro.getSingleton().register("afterUnhideRows");const kE="hiddenRows",NE=320;var PE=new WeakMap,_E=new WeakMap;class DE extends hf{constructor(){super(...arguments),ME(this,PE,{writable:!0,value:{}}),ME(this,_E,{writable:!0,value:null})}static get PLUGIN_KEY(){return kE}static get PLUGIN_PRIORITY(){return NE}isEnabled(){return!!this.hot.getSettings()[kE]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[kE];Ae(e)&&(HE(this,PE,e),$(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),HE(this,_E,new bl),xE(this,_E).addLocalHook("init",(()=>this.onMapInit())),this.hot.rowIndexMapper.registerMap(this.pluginName,xE(this,_E)),this.addHook("afterContextMenuDefaultOptions",(function(){return t.onAfterContextMenuDefaultOptions(...arguments)})),this.addHook("afterGetCellMeta",((t,e,o)=>this.onAfterGetCellMeta(t,e,o))),this.addHook("modifyRowHeight",((t,e)=>this.onModifyRowHeight(t,e))),this.addHook("afterGetRowHeader",(function(){return t.onAfterGetRowHeader(...arguments)})),this.addHook("modifyCopyableRange",(t=>this.onModifyCopyableRange(t))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),HE(this,PE,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(t){const e=this.getHiddenRows(),o=this.isValidConfig(t);let n=e;const s=xE(this,_E).getValues().slice(),i=t.length>0;if(o&&i){const e=t.map((t=>this.hot.toPhysicalRow(t)));O(e,(t=>{s[t]=!1})),n=I(s,((t,e,o)=>(e&&t.push(this.hot.toVisualRow(o)),t)),[])}const r=this.hot.runHooks("beforeUnhideRows",e,n,o&&i);!1!==r&&(o&&i&&xE(this,_E).setValues(s),this.hot.runHooks("afterUnhideRows",e,n,o&&i,o&&n.length<e.length))}showRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.showRows(e)}hideRows(t){const e=this.getHiddenRows(),o=this.isValidConfig(t);let n=e;o&&(n=Array.from(new Set(e.concat(t))));const s=this.hot.runHooks("beforeHideRows",e,n,o);!1!==s&&(o&&this.hot.batchExecution((()=>{O(t,(t=>{xE(this,_E).setValueAtIndex(this.hot.toPhysicalRow(t),!0)}))}),!0),this.hot.runHooks("afterHideRows",e,n,o,o&&n.length>e.length))}hideRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.hideRows(e)}getHiddenRows(){return A(xE(this,_E).getHiddenIndexes(),(t=>this.hot.toVisualRow(t)))}isHidden(t){return xE(this,_E).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}isValidConfig(t){const e=this.hot.countRows();return!!(Array.isArray(t)&&t.length>0)&&t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}resetCellsMeta(){O(this.hot.getCellsMeta(),(t=>{t&&(t.skipRowOnPaste=!1)}))}onModifyRowHeight(t,e){return this.isHidden(e)?0:t}onAfterGetCellMeta(t,e,o){if(!1===xE(this,PE).copyPasteEnabled&&this.isHidden(t)&&(o.skipRowOnPaste=!0),this.isHidden(t-1))o.className=o.className||"",-1===o.className.indexOf("afterHiddenRow")&&(o.className+=" afterHiddenRow");else if(o.className){const t=o.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenRow");e>-1&&t.splice(e,1),o.className=t.join(" ")}}}onModifyCopyableRange(t){if(xE(this,PE).copyPasteEnabled)return t;const e=[],o=(t,o,n,s)=>{e.push({startRow:t,endRow:o,startCol:n,endCol:s})};return O(t,(t=>{let e=!0,n=0;tn(t.startRow,t.endRow,(s=>{this.isHidden(s)?(e||o(n,s-1,t.startCol,t.endCol),e=!0):(e&&(n=s),s===t.endRow&&o(n,s,t.startCol,t.endCol),e=!1)}))})),e}onAfterGetRowHeader(t,e){if(!xE(this,PE).indicators||t<0)return;const o=[];t>=1&&this.isHidden(t-1)&&o.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&o.push("beforeHiddenRow"),Mt(e,o)}onAfterContextMenuDefaultOptions(t){t.items.push({name:dw},RE(this),EE(this))}onMapInit(){Array.isArray(xE(this,PE).rows)&&this.hideRows(xE(this,PE).rows)}destroy(){HE(this,PE,null),HE(this,_E,null),super.destroy()}}function LE(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(Ha)},callback(e,o){const[{start:{col:n}}]=o;t.freezeColumn(n),this.render(),this.view.adjustElementsSize(!0)},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(e=!0),e}}}function VE(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(Aa)},callback(e,o){const[{start:{col:n}}]=o;t.unfreezeColumn(n),this.render(),this.view.adjustElementsSize(!0)},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(e=!0),e}}}Ro.getSingleton().register("beforeColumnFreeze"),Ro.getSingleton().register("afterColumnFreeze"),Ro.getSingleton().register("beforeColumnUnfreeze"),Ro.getSingleton().register("afterColumnUnfreeze");const BE="manualColumnFreeze",FE=110,WE=new WeakMap;class jE extends hf{static get PLUGIN_KEY(){return BE}static get PLUGIN_PRIORITY(){return FE}constructor(t){super(t),WE.set(this,{afterFirstUse:!1})}isEnabled(){return!!this.hot.getSettings()[BE]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(t=>this.addContextMenuEntry(t))),this.addHook("beforeColumnMove",((t,e)=>this.onBeforeColumnMove(t,e))),super.enablePlugin())}disablePlugin(){const t=WE.get(this);t.afterFirstUse=!1,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(t){const e=WE.get(this),o=this.hot.getSettings(),n=o.fixedColumnsStart<this.hot.countCols()&&t>o.fixedColumnsStart-1;e.afterFirstUse||(e.afterFirstUse=!0);const s=this.hot.runHooks("beforeColumnFreeze",t,n);!1!==s&&(n&&(this.hot.columnIndexMapper.moveIndexes(t,o.fixedColumnsStart),o._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",t,n))}unfreezeColumn(t){const e=WE.get(this),o=this.hot.getSettings(),n=o.fixedColumnsStart>0&&t<=o.fixedColumnsStart-1;e.afterFirstUse||(e.afterFirstUse=!0);const s=this.hot.runHooks("beforeColumnUnfreeze",t,n);!1!==s&&(n&&(o._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(t,o.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",t,n))}addContextMenuEntry(t){t.items.push({name:"---------"},LE(this),VE(this))}onBeforeColumnMove(t,e){const o=WE.get(this);if(o.afterFirstUse){const o=this.hot.getSettings().fixedColumnsStart;if(e<o)return!1;if(t.some((t=>t<o)))return!1}}}const UE=0,zE=1,$E=2,GE="px";class YE{constructor(t){this.hot=t,this._element=null,this.state=UE,this.inlineProperty=t.isRtl()?"right":"left"}appendTo(t){t.appendChild(this._element),this.state=$E}build(){this.state===UE&&(this._element=this.hot.rootDocument.createElement("div"),this.state=zE)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=UE}isAppended(){return this.state===$E}isBuilt(){return this.state>=zE}setPosition(t,e){Jo(t)&&(this._element.style.top=t+GE),Jo(e)&&(this._element.style[this.inlineProperty]=e+GE)}getPosition(){const t=this._element.style;return{top:t.top?parseInt(t.top,10):0,start:t[this.inlineProperty]?parseInt(t[this.inlineProperty],10):0}}setSize(t,e){Jo(t)&&(this._element.style.width=t+GE),Jo(e)&&(this._element.style.height=e+GE)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){Jo(t)&&(this._element.style.marginTop=t+GE),Jo(e)&&(this._element.style[`margin${lt(this.inlineProperty)}`]=e+GE)}getOffset(){const t=this._element.style,e=`margin${lt(this.inlineProperty)}`;return{top:t.marginTop?parseInt(t.marginTop,10):0,start:t[e]?parseInt(t[e],10):0}}}var KE=YE;const XE="ht__manualColumnMove--backlight";class qE extends KE{build(){super.build(),Mt(this._element,XE)}}var QE=qE;const JE="ht__manualColumnMove--guideline";class ZE extends KE{build(){super.build(),Mt(this._element,JE)}}var tM=ZE;Ro.getSingleton().register("beforeColumnMove"),Ro.getSingleton().register("afterColumnMove");const eM="manualColumnMove",oM=120,nM=new WeakMap,sM="ht__manualColumnMove",iM="show-ui",rM="on-moving--columns",lM="after-selection--columns";class aM extends hf{static get PLUGIN_KEY(){return eM}static get PLUGIN_PRIORITY(){return oM}constructor(t){super(t),nM.set(this,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),this.eventManager=new Bo(this),this.backlight=new QE(t),this.guideline=new tM(t)}isEnabled(){return!!this.hot.getSettings()[eM]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown(...arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return t.onBeforeOnCellMouseOver(...arguments)})),this.addHook("afterScrollVertically",(()=>this.onAfterScrollVertically())),this.addHook("afterLoadData",(function(){return t.onAfterLoadData(...arguments)})),this.buildPluginUI(),this.registerEvents(),Mt(this.hot.rootElement,sM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Tt(this.hot.rootElement,sM),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(t,e){return this.moveColumns([t],e)}moveColumns(t,e){const o=nM.get(this),n=o.cachedDropIndex,s=this.isMovePossible(t,e),i=this.hot.runHooks("beforeColumnMove",t,e,n,s);if(o.cachedDropIndex=void 0,!1===i)return;s&&this.hot.columnIndexMapper.moveIndexes(t,e);const r=s&&this.isColumnOrderChanged(t,e);return this.hot.runHooks("afterColumnMove",t,e,n,s,r),r}dragColumn(t,e){return this.dragColumns([t],e)}dragColumns(t,e){const o=this.countFinalIndex(t,e),n=nM.get(this);return n.cachedDropIndex=e,this.moveColumns(t,o)}isMovePossible(t,e){const o=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),n=t.length+e>o,s=e<0,i=t.some((t=>t<0)),r=t.some((t=>t>=o));return!(n||s||i||r)}isColumnOrderChanged(t,e){return t.some(((t,o)=>t-o!==e))}countFinalIndex(t,e){const o=I(t,((t,o)=>(o<e&&(t+=1),t)),0);return e-o}getColumnsWidth(t,e){const o=this.hot.columnIndexMapper;let n=0;for(let s=t;s<=e;s+=1){const t=o.getRenderableFromVisualIndex(s);s<0?n+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==t&&(n+=this.hot.view._wt.wtTable.getStretchedColumnWidth(t)||0)}return n}moveBySettingsOrLoad(){const t=this.hot.getSettings()[eM];if(Array.isArray(t))this.moveColumns(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(t){return t<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value?t.value:[]}prepareColumnsToMoving(t,e){const o=[];return tn(t,e,(t=>{o.push(t)})),o}refreshPositions(){const t=nM.get(this),e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(t.hoveredColumn)&&e>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1));const o=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,s="number"===typeof n.scrollX?n.scrollX:n.scrollLeft;let i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,t.hoveredColumn-1);const r=o.hider.offsetWidth,l=o.TBODY.offsetLeft,a=this.backlight.getOffset().start,h=this.backlight.getSize().width;let c=0,d=0;if(this.hot.isRtl()){const e=this.hot.rootWindow,o=Ut(this.hot.rootElement),i=e.innerWidth-t.rootElementOffset-o;d=e.innerWidth-t.target.eventPageX-i-(void 0===n.scrollX?s:0)}else d=t.target.eventPageX-(t.rootElementOffset-(void 0===n.scrollX?s:0));if(t.hasRowHeaders&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(t.hoveredColumn)&&(i+=s),i+=c,t.hoveredColumn<0)t.fixedColumnsStart>0?t.target.col=0:t.target.col=e>0?e-1:e;else if(t.target.TD.offsetWidth/2+i<=d){const e=t.hoveredColumn>=t.countCols?t.countCols-1:t.hoveredColumn;t.target.col=e+1,i+=t.target.TD.offsetWidth}else t.target.col=t.hoveredColumn;let u=d,g=i;d+h+a>=r?u=r-h-a:d+a<l+c&&(u=l+c+Math.abs(a)),i>=r-1?g=r-1:0===g?g=1:void 0!==n.scrollX&&t.hoveredColumn<t.fixedColumnsStart&&(g-=t.rootElementOffset<=n.scrollX?t.rootElementOffset:0),this.backlight.setPosition(null,u),this.guideline.setPosition(null,g)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",(t=>this.onMouseMove(t))),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp()))}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(t,e,o,n){const s=this.hot.view._wt.wtTable,i=this.hot.selection.isSelectedByColumnHeader(),r=this.hot.getSelectedRangeLast(),l=nM.get(this),a=Et(t.target,"sortAction");if(!r||!i||l.pressed||0!==t.button||a)return l.pressed=!1,l.columnsToMove.length=0,void Tt(this.hot.rootElement,[rM,iM]);const h=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();h&&c&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));const{from:d,to:u}=r,g=Math.min(d.col,u.col),m=Math.max(d.col,u.col);if(e.row<0&&e.col>=g&&e.col<=m){n.column=!0,l.pressed=!0,l.target.eventPageX=t.pageX,l.target.eventOffsetX=t.offsetX,l.hoveredColumn=e.col,l.target.TD=o,l.target.col=e.col,l.columnsToMove=this.prepareColumnsToMoving(g,m),l.hasRowHeaders=!!this.hot.getSettings().rowHeaders,l.countCols=this.hot.countCols(),l.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,l.rootElementOffset=Nt(this.hot.rootElement).left;const i=l.hasRowHeaders?-1:0,r=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,a=e.col<l.fixedColumnsStart,h=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),c=Math.abs(t.offsetX-(this.hot.isRtl()?t.target.offsetWidth:0)),d=this.getColumnsWidth(g,e.col-1)+c,u=this.getColumnsWidth(i,g-1)+(a?h:0)+d;this.backlight.setPosition(r,u),this.backlight.setSize(this.getColumnsWidth(g,m),s.hider.offsetHeight-r),this.backlight.setOffset(null,-d),Mt(this.hot.rootElement,rM)}else Tt(this.hot.rootElement,lM),l.pressed=!1,l.columnsToMove.length=0}onMouseMove(t){const e=nM.get(this);if(e.pressed){if(t.target===this.backlight.element){const t=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout((function(){this.backlight.setPosition(t)}))}e.target.eventPageX=t.pageX,this.refreshPositions()}}onBeforeOnCellMouseOver(t,e,o,n){const s=this.hot.getSelectedRangeLast(),i=nM.get(this);s&&i.pressed&&(i.columnsToMove.indexOf(e.col)>-1?Tt(this.hot.rootElement,iM):Mt(this.hot.rootElement,iM),n.row=!0,n.column=!0,n.cell=!0,i.hoveredColumn=e.col,i.target.TD=o)}onMouseUp(){const t=nM.get(this),e=t.target.col,o=t.columnsToMove.length;if(t.hoveredColumn=void 0,t.pressed=!1,t.backlightWidth=0,Tt(this.hot.rootElement,[rM,iM,lM]),this.hot.selection.isSelectedByColumnHeader()&&Mt(this.hot.rootElement,lM),o<1||void 0===e)return;const n=t.columnsToMove[0],s=this.hot.toPhysicalColumn(n),i=this.dragColumns(t.columnsToMove,e);if(t.columnsToMove.length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const t=this.hot.toVisualColumn(s),e=t+o-1;this.hot.selectColumns(t,e)}}onAfterScrollVertically(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,o=t.holder.scrollTop,n=e+o;this.backlight.setPosition(n),this.backlight.setSize(null,t.hider.offsetHeight-n)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const hM="manualColumnResize",cM=130,dM="manualColumnWidths",uM=new WeakMap;class gM extends hf{static get PLUGIN_KEY(){return hM}static get PLUGIN_PRIORITY(){return cM}constructor(t){super(t);const{rootDocument:e}=this.hot;this.currentTH=null,this.currentCol=null,this.selectedCols=[],this.currentWidth=null,this.newSize=null,this.startY=null,this.startWidth=null,this.startOffset=null,this.handle=e.createElement("DIV"),this.guide=e.createElement("DIV"),this.eventManager=new Bo(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.columnWidthsMap=void 0,uM.set(this,{config:void 0}),Mt(this.handle,"manualColumnResizer"),Mt(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[hM]}enablePlugin(){this.enabled||(this.columnWidthsMap=new vl,this.columnWidthsMap.addLocalHook("init",(()=>this.onMapInit())),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",((t,e)=>this.onModifyColWidth(t,e))),this.addHook("beforeStretchingColumnWidth",((t,e)=>this.onBeforeStretchingColumnWidth(t,e))),this.addHook("beforeColumnResize",((t,e,o)=>this.onBeforeColumnResize(t,e,o))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const t=uM.get(this);t.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",dM,this.columnWidthsMap.getValues())}loadManualColumnWidths(){const t={};return this.hot.runHooks("persistentStateLoad",dM,t),t.value}setManualSize(t,e){const o=Math.max(e,20),n=this.hot.toPhysicalColumn(t);return this.columnWidthsMap.setValueAtIndex(n,o),o}clearManualSize(t){const e=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(e,null)}onMapInit(){const t=uM.get(this),e=this.hot.getSettings()[hM],o=this.loadManualColumnWidths();"undefined"!==typeof o?this.hot.batchExecution((()=>{o.forEach(((t,e)=>{this.columnWidthsMap.setValueAtIndex(e,t)}))}),!0):Array.isArray(e)?(this.hot.batchExecution((()=>{e.forEach(((t,e)=>{this.columnWidthsMap.setValueAtIndex(e,t)}))}),!0),t.config=e):!0===e&&Array.isArray(t.config)&&this.hot.batchExecution((()=>{t.config.forEach(((t,e)=>{this.columnWidthsMap.setValueAtIndex(e,t)}))}),!0)}setupHandlePosition(t){if(!t.parentNode)return;this.currentTH=t;const{_wt:e}=this.hot.view,o=e.wtTable.getCoords(this.currentTH),n=o.col;if(n<0)return;const s=zt(this.currentTH),i=this.currentTH.getBoundingClientRect(),r=n<e.getSetting("fixedColumnsStart");let l;r&&(l=e.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),l||(l=e.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),this.selectedCols=[];const a=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&a){const t=this.hot.getSelectedRange();O(t,(t=>{const e=t.getTopStartCorner().col,o=t.getBottomEndCorner().col;tn(e,o,(t=>{this.selectedCols.includes(t)||this.selectedCols.push(t)}))}))}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=l.start-6,this.startWidth=parseInt(i.width,10),this.handle.style.top=`${l.top}px`,this.handle.style[this.inlineDir]=`${this.startOffset+this.startWidth}px`,this.handle.style.height=`${s}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style[this.inlineDir]=`${this.startOffset+this.currentWidth}px`}setupGuidePosition(){const t=parseInt(zt(this.handle),10),e=parseInt(this.handle.style.top,10)+t,o=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Mt(this.handle,"active"),Mt(this.guide,"active"),this.guide.style.top=`${e}px`,this.refreshGuidePosition(),this.guide.style.height=o-t+"px",this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){Tt(this.handle,"active"),Tt(this.guide,"active")}checkIfColumnHeader(t){return!!Ct(t,["THEAD"],this.hot.rootElement)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}onMouseOver(t){if(!de(t.target)&&!0!==this.isTriggeredByRMB&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const o=e.getAttribute("colspan");!e||null!==o&&"1"!==o||this.pressed||this.setupHandlePosition(e)}}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{const n=this.hot.runHooks("beforeColumnResize",this.newSize,e,!0);void 0!==n&&(this.newSize=n),"all"===this.hot.getSettings().stretchH?this.clearManualSize(e):this.setManualSize(e,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,e,!0),o&&t()};if(this.dblclick>=2){const o=this.selectedCols.length;o>1?(O(this.selectedCols,(t=>{e(t)})),t()):O(this.selectedCols,(t=>{e(t,!0)}))}this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(t){Et(t.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((()=>this.afterMouseDownTimeout()),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=t.pageX,this.newSize=this.startWidth)}onMouseMove(t){if(this.pressed){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+e,O(this.selectedCols,(t=>{this.newSize=this.setManualSize(t,this.currentWidth)})),this.refreshHandlePosition(),this.refreshGuidePosition()}}onMouseUp(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{this.hot.runHooks("beforeColumnResize",this.newSize,e,!1),o&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,e,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){const o=this.selectedCols.length;o>1?(O(this.selectedCols,(t=>{e(t)})),t()):O(this.selectedCols,(t=>{e(t,!0)}))}this.setupHandlePosition(this.currentTH)}}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate((()=>{this.isTriggeredByRMB=!1}))}bindEvents(){const{rootWindow:t,rootElement:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",(t=>this.onMouseOver(t))),this.eventManager.addEventListener(e,"mousedown",(t=>this.onMouseDown(t))),this.eventManager.addEventListener(t,"mousemove",(t=>this.onMouseMove(t))),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp())),this.eventManager.addEventListener(this.handle,"contextmenu",(()=>this.onContextMenu()))}onModifyColWidth(t,e){let o=t;if(this.enabled){const t=this.hot.toPhysicalColumn(e),n=this.columnWidthsMap.getValueAtIndex(t);this.hot.getSettings()[hM]&&n&&(o=n)}return o}onBeforeStretchingColumnWidth(t,e){let o=this.columnWidthsMap.getValueAtIndex(e);return null===o&&(o=t),o}onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}destroy(){super.destroy()}}const mM=0,fM=1,pM=2,wM="px";class CM{constructor(t){this.hot=t,this._element=null,this.state=mM}appendTo(t){t.appendChild(this._element),this.state=pM}build(){this.state===mM&&(this._element=this.hot.rootDocument.createElement("div"),this.state=fM)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=mM}isAppended(){return this.state===pM}isBuilt(){return this.state>=fM}setPosition(t,e){void 0!==t&&(this._element.style.top=t+wM),void 0!==e&&(this._element.style.left=e+wM)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(t,e){t&&(this._element.style.width=t+wM),e&&(this._element.style.height=e+wM)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){t&&(this._element.style.marginTop=t+wM),e&&(this._element.style.marginLeft=e+wM)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}var yM=CM;const vM="ht__manualRowMove--backlight";class bM extends yM{build(){super.build(),Mt(this._element,vM)}}var SM=bM;const RM="ht__manualRowMove--guideline";class EM extends yM{build(){super.build(),Mt(this._element,RM)}}var MM=EM;Ro.getSingleton().register("beforeRowMove"),Ro.getSingleton().register("afterRowMove");const TM="manualRowMove",xM=140,IM=new WeakMap,HM="ht__manualRowMove",AM="show-ui",OM="on-moving--rows",kM="after-selection--rows";class NM extends hf{static get PLUGIN_KEY(){return TM}static get PLUGIN_PRIORITY(){return xM}constructor(t){super(t),IM.set(this,{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),this.eventManager=new Bo(this),this.backlight=new SM(t),this.guideline=new MM(t)}isEnabled(){return!!this.hot.getSettings()[TM]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown(...arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return t.onBeforeOnCellMouseOver(...arguments)})),this.addHook("afterScrollHorizontally",(()=>this.onAfterScrollHorizontally())),this.addHook("afterLoadData",(function(){return t.onAfterLoadData(...arguments)})),this.buildPluginUI(),this.registerEvents(),Mt(this.hot.rootElement,HM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Tt(this.hot.rootElement,HM),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(t,e){return this.moveRows([t],e)}moveRows(t,e){const o=IM.get(this),n=o.cachedDropIndex,s=this.isMovePossible(t,e),i=this.hot.runHooks("beforeRowMove",t,e,n,s);if(o.cachedDropIndex=void 0,!1===i)return;s&&this.hot.rowIndexMapper.moveIndexes(t,e);const r=s&&this.isRowOrderChanged(t,e);return this.hot.runHooks("afterRowMove",t,e,n,s,r),r}dragRow(t,e){return this.dragRows([t],e)}dragRows(t,e){const o=this.countFinalIndex(t,e),n=IM.get(this);return n.cachedDropIndex=e,this.moveRows(t,o)}isMovePossible(t,e){const o=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),n=t.length+e>o,s=e<0,i=t.some((t=>t<0)),r=t.some((t=>t>=o));return!(n||s||i||r)}isRowOrderChanged(t,e){return t.some(((t,o)=>t-o!==e))}countFinalIndex(t,e){const o=I(t,((t,o)=>(o<e&&(t+=1),t)),0);return e-o}getRowsHeight(t,e){const o=this.hot.rowIndexMapper;let n=0;for(let s=t;s<=e;s++){const t=o.getRenderableFromVisualIndex(s);null!==t&&(n+=this.hot.view._wt.wtTable.getRowHeight(t)||23)}return n}moveBySettingsOrLoad(){const t=this.hot.getSettings()[TM];if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(t){return t<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(t){return t>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}prepareRowsToMoving(){const t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;const{from:o,to:n}=t,s=Math.min(o.row,n.row),i=Math.max(o.row,n.row);return tn(s,i,(t=>{e.push(t)})),e}refreshPositions(){const t=IM.get(this),e=t.target.coords,o=this.hot.view.getFirstFullyVisibleRow(),n=this.hot.view.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(e.row)&&o>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1)),this.isFixedRowBottom(e.row)&&n<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const i=this.hot.view._wt.wtTable,r=t.target.TD,l=this.hot.rootElement,a=Nt(l),h=Bt(l),c=i.holder.scrollTop;let d;d=this.hot.rootWindow===h?h.scrollY:h.scrollTop;const u=a.top-d,g=t.target.eventPageY-u+c,m=i.hider.offsetHeight,f=i.TBODY.offsetTop,p=this.backlight.getOffset().top,w=this.backlight.getSize().height,C=r.offsetHeight/2,y=r.offsetHeight;let v=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const b=g>=v+C;this.isFixedRowTop(e.row)&&(v+=i.holder.scrollTop),e.row<0?t.target.row=o>0?o-1:o:b?(t.target.row=e.row+1,v+=0===e.row?y-1:y):t.target.row=e.row;let S=g,R=v;g+w+p>=m?S=m-w-p:g+p<f&&(S=f+Math.abs(p)),v>=m-1&&(R=m-1),this.backlight.setPosition(S),this.guideline.setPosition(R)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",(t=>this.onMouseMove(t))),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp()))}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(t,e,o,n){const{wtTable:s,wtViewport:i}=this.hot.view._wt,r=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast(),a=IM.get(this);if(!l||!r||a.pressed||0!==t.button)return a.pressed=!1,a.rowsToMove.length=0,void Tt(this.hot.rootElement,[OM,AM]);const h=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();h&&c&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));const{from:d,to:u}=l,g=Math.min(d.row,u.row),m=Math.max(d.row,u.row);if(e.col<0&&e.row>=g&&e.row<=m){n.row=!0,a.pressed=!0,a.target.eventPageY=t.pageY,a.target.coords=e,a.target.TD=o,a.rowsToMove=this.prepareRowsToMoving();const r=s.holder.scrollLeft+i.getRowHeaderWidth();this.backlight.setPosition(null,r),this.backlight.setSize(s.hider.offsetWidth-r,this.getRowsHeight(g,m)),this.backlight.setOffset(-1*(this.getRowsHeight(g,e.row-1)+t.offsetY),null),Mt(this.hot.rootElement,OM),this.refreshPositions()}else Tt(this.hot.rootElement,kM),a.pressed=!1,a.rowsToMove.length=0}onMouseMove(t){const e=IM.get(this);if(e.pressed){if(t.target===this.backlight.element){const t=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout((function(){this.backlight.setPosition(null,t)}))}e.target.eventPageY=t.pageY,this.refreshPositions()}}onBeforeOnCellMouseOver(t,e,o,n){const s=this.hot.getSelectedRangeLast(),i=IM.get(this);s&&i.pressed&&(i.rowsToMove.indexOf(e.row)>-1?Tt(this.hot.rootElement,AM):Mt(this.hot.rootElement,AM),n.row=!0,n.column=!0,n.cell=!0,i.target.coords=e,i.target.TD=o)}onMouseUp(){const t=IM.get(this),e=t.target.row,o=t.rowsToMove.length;if(t.pressed=!1,t.backlightHeight=0,Tt(this.hot.rootElement,[OM,AM,kM]),this.hot.selection.isSelectedByRowHeader()&&Mt(this.hot.rootElement,kM),o<1||void 0===e)return;const n=t.rowsToMove[0],s=this.hot.toPhysicalRow(n),i=this.dragRows(t.rowsToMove,e);if(t.rowsToMove.length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const t=this.hot.toVisualRow(s),e=t+o-1;this.hot.selectRows(t,e)}}onAfterScrollHorizontally(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),o=t.holder.scrollLeft,n=e+o;this.backlight.setPosition(null,n),this.backlight.setSize(t.hider.offsetWidth-n)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const PM="manualRowResize",_M=30,DM="manualRowHeights",LM=new WeakMap;class VM extends hf{static get PLUGIN_KEY(){return PM}static get PLUGIN_PRIORITY(){return _M}constructor(t){super(t);const{rootDocument:e}=this.hot;this.currentTH=null,this.currentRow=null,this.selectedRows=[],this.currentHeight=null,this.newSize=null,this.startY=null,this.startHeight=null,this.startOffset=null,this.handle=e.createElement("DIV"),this.guide=e.createElement("DIV"),this.eventManager=new Bo(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.rowHeightsMap=void 0,LM.set(this,{config:void 0}),Mt(this.handle,"manualRowResizer"),Mt(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[PM]}enablePlugin(){this.enabled||(this.rowHeightsMap=new vl,this.rowHeightsMap.addLocalHook("init",(()=>this.onMapInit())),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",((t,e)=>this.onModifyRowHeight(t,e))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const t=LM.get(this);t.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",DM,this.rowHeightsMap.getValues())}loadManualRowHeights(){const t={};return this.hot.runHooks("persistentStateLoad",DM,t),t.value}setManualSize(t,e){const o=this.hot.toPhysicalRow(t),n=Math.max(e,Cr.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(o,n),n}setupHandlePosition(t){this.currentTH=t;const{view:e}=this.hot,{_wt:o}=e,n=o.wtTable.getCoords(this.currentTH),s=n.row;if(s<0)return;const i=Ut(this.currentTH),r=this.currentTH.getBoundingClientRect(),l=s<o.getSetting("fixedRowsTop"),a=s>=e.countNotHiddenRowIndexes(0,1)-o.getSetting("fixedRowsBottom");let h;l?h=o.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col):a&&(h=o.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col)),h||(h=o.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),this.selectedRows=[];const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&c){const t=this.hot.getSelectedRange();O(t,(t=>{const e=t.getTopStartCorner().row,o=t.getBottomStartCorner().row;tn(e,o,(t=>{this.selectedRows.includes(t)||this.selectedRows.push(t)}))}))}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=h.top-6,this.startHeight=parseInt(r.height,10),this.handle.style.top=`${this.startOffset+this.startHeight}px`,this.handle.style[this.inlineDir]=`${h.start}px`,this.handle.style.width=`${i}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style.top=`${this.startOffset+this.currentHeight}px`}setupGuidePosition(){const t=parseInt(Ut(this.handle),10),e=parseInt(this.handle.style[this.inlineDir],10)+t,o=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Mt(this.handle,"active"),Mt(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=`${e}px`,this.guide.style.width=o-t+"px",this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){Tt(this.handle,"active"),Tt(this.guide,"active")}checkIfRowHeader(t){var e;const o=Ct(t,["TH"],this.hot.rootElement);return o&&"TBODY"===(null===(e=t.parentNode)||void 0===e||null===(e=e.parentNode)||void 0===e?void 0:e.tagName)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}getActualRowHeight(t){const e=this.hot.view._wt.wtTable.getRowHeight(t);return void 0!==e&&this.newSize<e?e:this.newSize}onMouseOver(t){if(!de(t.target)&&!0!==this.isTriggeredByRMB&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(this.pressed||this.setupHandlePosition(e))}}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{const n=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!0);void 0!==n&&(this.newSize=n),this.setManualSize(e,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!0),o&&t()};if(this.dblclick>=2){const o=this.selectedRows.length;o>1?(O(this.selectedRows,(t=>{e(t)})),t()):O(this.selectedRows,(t=>{e(t,!0)}))}this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(t){Et(t.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((()=>this.afterMouseDownTimeout()),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=t.pageY,this.newSize=this.startHeight)}onMouseMove(t){this.pressed&&(this.currentHeight=this.startHeight+(t.pageY-this.startY),O(this.selectedRows,(t=>{this.newSize=this.setManualSize(t,this.currentHeight)})),this.refreshHandlePosition(),this.refreshGuidePosition())}onMouseUp(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,o)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!1),o&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){const o=this.selectedRows.length;o>1?(O(this.selectedRows,(t=>{e(t)})),t()):O(this.selectedRows,(t=>{e(t,!0)}))}this.setupHandlePosition(this.currentTH)}}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate((()=>{this.isTriggeredByRMB=!1}))}bindEvents(){const{rootElement:t,rootWindow:e}=this.hot;this.eventManager.addEventListener(t,"mouseover",(t=>this.onMouseOver(t))),this.eventManager.addEventListener(t,"mousedown",(t=>this.onMouseDown(t))),this.eventManager.addEventListener(e,"mousemove",(t=>this.onMouseMove(t))),this.eventManager.addEventListener(e,"mouseup",(()=>this.onMouseUp())),this.eventManager.addEventListener(this.handle,"contextmenu",(()=>this.onContextMenu()))}onModifyRowHeight(t,e){let o=t;if(this.enabled){const t=this.hot.toPhysicalRow(e),n=this.rowHeightsMap.getValueAtIndex(t);this.hot.getSettings()[PM]&&n&&(o=n)}return o}onMapInit(){const t=LM.get(this),e=this.hot.getSettings()[PM],o=this.loadManualRowHeights();this.hot.batchExecution((()=>{"undefined"!==typeof o?o.forEach(((t,e)=>{this.rowHeightsMap.setValueAtIndex(e,t)})):Array.isArray(e)?(e.forEach(((t,e)=>{this.rowHeightsMap.setValueAtIndex(e,t)})),t.config=e):!0===e&&Array.isArray(t.config)&&t.config.forEach(((t,e)=>{this.rowHeightsMap.setValueAtIndex(e,t)}))}),!0)}destroy(){super.destroy()}}class BM{constructor(t,e,o,n,s,i){this.row=t,this.col=e,this.rowspan=o,this.colspan=n,this.removed=!1,this.cellCoordsFactory=s,this.cellRangeFactory=i}static NEGATIVE_VALUES_WARNING(t){return j`The merged cell declared with {row: ${t.row}, col: ${t.col},\x20
      rowspan: ${t.rowspan}, colspan: ${t.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(t){return j`The merged cell declared at [${t.row}, ${t.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(t){return j`The merged cell declared at [${t.row}, ${t.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(t){return j`The merged cell declared at [${t.row}, ${t.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}static isSingleCell(t){return 1===t.colspan&&1===t.rowspan}static containsZeroSpan(t){return 0===t.colspan||0===t.rowspan}static isOutOfBounds(t,e,o){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=o||t.col+t.colspan-1>=o}normalize(t){const e=t.countRows(),o=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>o-1&&(this.col=o-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>o-1&&(this.colspan=o-this.col)}includes(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}includesHorizontally(t){return this.col<=t&&this.col+this.colspan-1>=t}includesVertically(t){return this.row<=t&&this.row+this.rowspan-1>=t}shift(t,e){const o=t[0]||t[1],n=e+Math.abs(t[0]||t[1])-1,s=t[0]?"colspan":"rowspan",i=t[0]?"col":"row",r=Math.min(e,n),l=Math.max(e,n),a=this[i],h=this[i]+this[s]-1;if(a>=e&&(this[i]+=o),o>0)e<=h&&e>a&&(this[s]+=o);else if(o<0){if(r<=a&&l>=h)return this.removed=!0,!1;if(a>=r&&a<=l){const t=l-a+1,e=Math.abs(o)-t;this[i]-=e+o,this[s]-=t}else if(a<=r&&h>=l)this[s]+=o;else if(a<=r&&h>=r&&h<l){const t=h-r+1;this[s]-=t}}return!0}isFarther(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}var FM=BM;function WM(t,e,o,n){e?e.row===o&&e.col===n?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}class jM{constructor(t){this.plugin=t,this.mergedCells=[],this.hot=t.hot}static IS_OVERLAPPING_WARNING(t){return j`The merged cell declared at [${t.row}, ${t.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(t,e){const o=this.mergedCells;let n=!1;return O(o,(o=>!(o.row<=t&&o.row+o.rowspan-1>=t&&o.col<=e&&o.col+o.colspan-1>=e)||(n=o,!1))),n}getByRange(t){const e=this.mergedCells;let o=!1;return O(e,(e=>!(e.row<=t.from.row&&e.row+e.rowspan-1>=t.to.row&&e.col<=t.from.col&&e.col+e.colspan-1>=t.to.col)||(o=e,o))),o}getWithinRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.mergedCells,n=[];let s=t;if(!s.includesRange){const t=this.hot._createCellCoords(s.from.row,s.from.col),e=this.hot._createCellCoords(s.to.row,s.to.col);s=this.hot._createCellRange(t,t,e)}return O(o,(t=>{const o=this.hot._createCellCoords(t.row,t.col),i=this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),r=this.hot._createCellRange(o,o,i);e?s.overlaps(r)&&n.push(t):s.includesRange(r)&&n.push(t)})),!!n.length&&n}add(t){const e=this.mergedCells,o=t.row,n=t.col,s=t.rowspan,i=t.colspan,r=new FM(o,n,s,i,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(o,n),a=this.isOverlapping(r);return l||a?(mo(jM.IS_OVERLAPPING_WARNING(r)),!1):(this.hot&&r.normalize(this.hot),e.push(r),r)}remove(t,e){const o=this.mergedCells,n=this.get(t,e),s=n?this.mergedCells.indexOf(n):-1;return!(!n||-1===s)&&(o.splice(s,1),n)}clear(){const t=this.mergedCells,e=[],o=[];O(t,(t=>{const o=this.hot.getCell(t.row,t.col);o&&e.push([o,this.get(t.row,t.col),t.row,t.col])})),this.mergedCells.length=0,O(e,((t,n)=>{tn(0,t.rowspan-1,(e=>{tn(0,t.colspan-1,(n=>{if(0!==n||0!==e){const s=this.hot.getCell(t.row+e,t.col+n);s&&o.push([s,null,null,null])}}))})),e[n][1]=null})),O(e,(t=>{WM(...t)})),O(o,(t=>{WM(...t)}))}isOverlapping(t){const e=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1));let o=!1;return O(this.mergedCells,(t=>{const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1));return!n.overlaps(e)||(o=!0,!1)})),o}isFirstRenderableMergedCell(t,e){const o=this.get(t,e);return o&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)===e}getFirstRenderableCoords(t,e){const o=this.get(t,e);if(!o||this.isFirstRenderableMergedCell(t,e))return this.hot._createCellCoords(t,e);const n=this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1);return this.hot._createCellCoords(n,s)}shiftCollections(t,e,o){const n=[0,0];switch(t){case"right":n[0]+=o;break;case"left":n[0]-=o;break;case"down":n[1]+=o;break;case"up":n[1]-=o;break;default:}O(this.mergedCells,(t=>{t.shift(n,e)})),en(this.mergedCells.length-1,0,(t=>{const e=this.mergedCells[t];e&&e.removed&&this.mergedCells.splice(this.mergedCells.indexOf(e),1)}))}}var UM=jM;class zM{constructor(t){this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}correctSelectionAreaSize(t){if(t[0]===t[2]&&t[1]===t[3]){const e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}getDirection(t,e){let o=null;return o=e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left",o}snapDragArea(t,e,o,n){const s=e.slice(0),i=this.getAutofillSize(t,e,o),[r,l,a,h]=t,c=["up","down"].indexOf(o)>-1,d=c?a-r+1:h-l+1,u=Math.floor(i/d)*d,g=i-u,m=this.getFarthestCollection(t,e,o,n);if(m)if("down"===o){const t=m.row+m.rowspan-r-g,e=s[2]+t;e>=this.plugin.hot.countRows()?s[2]-=g:s[2]+=g?t:0}else if("right"===o){const t=m.col+m.colspan-l-g,e=s[3]+t;e>=this.plugin.hot.countCols()?s[3]-=g:s[3]+=g?t:0}else if("up"===o){const t=a-g-m.row+1,e=s[0]+t;e<0?s[0]+=g:s[0]-=g?t:0}else if("left"===o){const t=h-g-m.col+1,e=s[1]+t;e<0?s[1]+=g:s[1]-=g?t:0}return this.updateCurrentFillCache({baseArea:t,dragDirection:o,foundMergedCells:n,fillSize:i,dragArea:s,cycleLength:d}),s}updateCurrentFillCache(t){this.currentFillData||(this.currentFillData={}),Ee(this.currentFillData,t)}getAutofillSize(t,e,o){const[n,s,i,r]=t,[l,a,h,c]=e;switch(o){case"up":return n-l;case"down":return h-i;case"left":return s-a;case"right":return c-r;default:return null}}getDragArea(t,e,o){const[n,s,i,r]=t,[l,a,h,c]=e;switch(o){case"up":return[l,a,n-1,r];case"down":return[i+1,s,h,r];case"left":return[l,a,i,s-1];case"right":return[n,r+1,h,c];default:return null}}getFarthestCollection(t,e,o,n){const[s,i,r,l]=t,a=["up","down"].indexOf(o)>-1,h=a?r:l,c=a?s:i,d=this.getAutofillSize(t,e,o),u=a?r-s+1:l-i+1,g=Math.floor(d/u)*u,m=d-g;let f=null,p=null,w=null;switch(o){case"up":f="includesVertically",w=h-m+1;break;case"left":f="includesHorizontally",w=h-m+1;break;case"down":f="includesVertically",w=c+m-1;break;case"right":f="includesHorizontally",w=c+m-1;break;default:}return O(n,(t=>{t[f](w)&&t.isFarther(p,o)&&(p=t)})),p}recreateAfterDataPopulation(t){if(!this.currentFillData)return;const e=this.getRangeFromChanges(t),o=this.currentFillData.foundMergedCells,n=this.currentFillData.dragDirection,s=(t,o)=>{switch(n){case"up":return t.row-o>=e.from.row;case"down":return t.row+t.rowspan-1+o<=e.to.row;case"left":return t.col-o>=e.from.column;case"right":return t.col+t.colspan-1+o<=e.to.column;default:return null}};let i=0,r=null,l=1;do{for(let t=0;t<o.length;t+=1){if(r=o[t],i=l*this.currentFillData.cycleLength,s(r,i))switch(n){case"up":this.plugin.mergedCellsCollection.add({row:r.row-i,rowspan:r.rowspan,col:r.col,colspan:r.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:r.row+i,rowspan:r.rowspan,col:r.col,colspan:r.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:r.row,rowspan:r.rowspan,col:r.col-i,colspan:r.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:r.row,rowspan:r.rowspan,col:r.col+i,colspan:r.colspan});break;default:}t===o.length-1&&(l+=1)}}while(s(r,i));this.currentFillData=null,this.plugin.hot.render(),o.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(t){const e={min:null,max:null},o={min:null,max:null};return O(t,(t=>{const n=t[0],s=this.plugin.hot.propToCol(t[1]);(null===e.min||n<e.min)&&(e.min=n),(null===e.max||n>e.max)&&(e.max=n),(null===o.min||s<o.min)&&(o.min=s),(null===o.max||s>o.max)&&(o.max=s)})),{from:{row:e.min,column:o.min},to:{row:e.max,column:o.max}}}dragAreaOverlapsCollections(t,e,o){const n=this.getDragArea(t,e,o),[s,i,r,l]=n,a=this.plugin.hot._createCellCoords(s,i),h=this.plugin.hot._createCellCoords(r,l),c=this.plugin.hot._createCellRange(a,a,h);return!!this.mergedCellsCollection.getWithinRange(c,!0)}}var $M=zM;class GM{constructor(t){this.plugin=t,this.hot=t.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}snapDelta(t,e,o){const n=e.to,s=n.row+t.row,i=n.col+t.col;t.row?this.jumpOverMergedCell(t,o,s):t.col&&this.jumpOverMergedCell(t,o,i)}jumpOverMergedCell(t,e,o){let n=t.row||t.col,s=null,i=null,r=null;t.row?(s=e.includesVertically(o),i=e.row,r=e.getLastRow()):t.col&&(s=e.includesHorizontally(o),i=e.col,r=e.getLastColumn()),0!==n&&(n>0?s&&o!==i&&(n+=r-o+1):s&&o!==r&&(n-=o-i+1),t.row?t.row=n:t.col&&(t.col=n))}getUpdatedSelectionRange(t,e){return this.hot._createCellRange(t.highlight,t.from,this.hot._createCellCoords(t.to.row+e.row,t.to.col+e.col))}getSelectedMergedCellClassName(t,e,o,n){const s=Math.min(o[0],o[2]),i=Math.min(o[1],o[3]),r=Math.max(o[0],o[2]),l=Math.max(o[1],o[3]);if(void 0===n)return;const a=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(t,e);if(!a)return;const h=this.plugin.mergedCellsCollection.get(t,e);if(!h)return;const c=h.getLastRow(),d=h.getLastColumn(),u=s<=h.row&&i<=h.col&&r>=c&&l>=d;return u?`${this.fullySelectedMergedCellClassName}-${n}`:this.plugin.selectionCalculations.isMergeCellFullySelected(h,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(t,e){const o=[];if(!e||!t)return!1;for(let n=0;n<t.rowspan;n+=1)for(let e=0;e<t.colspan;e+=1)o.push(this.hot._createCellCoords(t.row+n,t.col+e));for(let n=0;n<o.length;n+=1){const t=[];for(let s=0;s<e.length;s+=1)t[s]=e[s].includes(o[n]);if(!t.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const t=[];for(let e=0;e<=7;e+=1)t.push(`${this.fullySelectedMergedCellClassName}-${e}`);return t.push(`${this.fullySelectedMergedCellClassName}-multiple`),t}}var YM=GM;function KM(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const o=t.mergedCellsCollection.get(e[0],e[1]);if(o.row===e[0]&&o.col===e[1]&&o.row+o.rowspan-1===e[2]&&o.col+o.colspan-1===e[3])return this.getTranslatedPhrase(ka)}return this.getTranslatedPhrase(Oa)},callback(){t.toggleMergeOnSelection()},disabled(){const t=this.getSelectedLast();if(!t)return!0;const e=FM.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1});return e||this.selection.isSelectedByCorner()},hidden:!1}}Ro.getSingleton().register("beforeMergeCells"),Ro.getSingleton().register("afterMergeCells"),Ro.getSingleton().register("beforeUnmergeCells"),Ro.getSingleton().register("afterUnmergeCells");const XM="mergeCells",qM=150,QM=new WeakMap,JM=XM;class ZM extends hf{static get PLUGIN_KEY(){return XM}static get PLUGIN_PRIORITY(){return qM}constructor(t){super(t),QM.set(this,{lastDesiredCoords:null}),this.mergedCellsCollection=null,this.autofillCalculations=null,this.selectionCalculations=null}isEnabled(){return!!this.hot.getSettings()[XM]}enablePlugin(){var t=this;this.enabled||(this.mergedCellsCollection=new UM(this),this.autofillCalculations=new $M(this),this.selectionCalculations=new YM(this),this.addHook("afterInit",(function(){return t.onAfterInit(...arguments)})),this.addHook("modifyTransformStart",(function(){return t.onModifyTransformStart(...arguments)})),this.addHook("afterModifyTransformStart",(function(){return t.onAfterModifyTransformStart(...arguments)})),this.addHook("modifyTransformEnd",(function(){return t.onModifyTransformEnd(...arguments)})),this.addHook("modifyGetCellCoords",(function(){return t.onModifyGetCellCoords(...arguments)})),this.addHook("beforeSetRangeStart",(function(){return t.onBeforeSetRangeStart(...arguments)})),this.addHook("beforeSetRangeStartOnly",(function(){return t.onBeforeSetRangeStart(...arguments)})),this.addHook("beforeSetRangeEnd",(function(){return t.onBeforeSetRangeEnd(...arguments)})),this.addHook("afterIsMultipleSelection",(function(){return t.onAfterIsMultipleSelection(...arguments)})),this.addHook("afterRenderer",(function(){return t.onAfterRenderer(...arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return t.addMergeActionsToContextMenu(...arguments)})),this.addHook("afterGetCellMeta",(function(){return t.onAfterGetCellMeta(...arguments)})),this.addHook("afterViewportRowCalculatorOverride",(function(){return t.onAfterViewportRowCalculatorOverride(...arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return t.onAfterViewportColumnCalculatorOverride(...arguments)})),this.addHook("modifyAutofillRange",(function(){return t.onModifyAutofillRange(...arguments)})),this.addHook("afterCreateCol",(function(){return t.onAfterCreateCol(...arguments)})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol(...arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow(...arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow(...arguments)})),this.addHook("afterChange",(function(){return t.onAfterChange(...arguments)})),this.addHook("beforeDrawBorders",(function(){return t.onBeforeDrawAreaBorders(...arguments)})),this.addHook("afterDrawSelection",(function(){return t.onAfterDrawSelection(...arguments)})),this.addHook("beforeRemoveCellClassNames",(function(){return t.onBeforeRemoveCellClassNames(...arguments)})),this.addHook("beforeUndoStackChange",((t,e)=>{if("MergeCells"===e)return!1})),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const t=this.hot.getSettings()[XM];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),super.updatePlugin()}ifChromeForceRepaint(){if(!Ue())return;const t=[];let e=[];this.mergedCellsCollection.mergedCells.forEach((t=>{const{row:o,rowspan:n}=t;for(let s=o+1;s<o+n;s++)e.push(s)})),e=[...new Set(e)],e.forEach((e=>{const o=this.hot.rowIndexMapper.getRenderableFromVisualIndex(e);this.hot.view._wt.wtOverlays.getOverlays(!0).map((t=>"master"===(null===t||void 0===t?void 0:t.name)?t:t.clone.wtTable)).forEach((e=>{const n=e.getRow(o);n&&(n.style.background=Ft(n,"backgroundColor").replace(")",", 0.99)"),t.push(n))}))})),this.hot._registerTimeout((()=>{t.forEach((t=>{t.style.background=Ft(t,"backgroundColor").replace(", 0.99)",")")}))}),1)}validateSetting(t){let e=!0;return!!t&&(FM.containsNegativeValues(t)?(mo(FM.NEGATIVE_VALUES_WARNING(t)),e=!1):FM.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?(mo(FM.IS_OUT_OF_BOUNDS_WARNING(t)),e=!1):FM.isSingleCell(t)?(mo(FM.IS_SINGLE_CELL(t)),e=!1):FM.containsZeroSpan(t)&&(mo(FM.ZERO_SPAN_WARNING(t)),e=!1),e)}generateFromSettings(t){if(Array.isArray(t)){const e=[];if(O(t,(t=>{if(!this.validateSetting(t))return;const o=this.hot._createCellCoords(t.row,t.col),n=this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),s=this.hot._createCellRange(o,o,n);this.mergeRange(s,!0,!0),tn(t.row,t.row+t.rowspan-1,(o=>{tn(t.col,t.col+t.colspan-1,(n=>{!1===(o===t.row&&n===t.col)&&e.push([o,n,null])}))}))})),0===e.length)return;this.hot.setDataAtCell(e)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!e||this.validateSetting(t)}toggleMergeOnSelection(){const t=this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:e,to:o}=t;this.toggleMerge(t),this.hot.selectCell(e.row,e.col,o.row,o.col,!1)}mergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:e,to:o}=t;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,o.row,o.col,!1)}unmergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;const{from:e,to:o}=t;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,o.row,o.col,!1)}mergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=t.getTopStartCorner(),s=t.getBottomEndCorner(),i={row:n.row,col:n.col,rowspan:s.row-n.row+1,colspan:s.col-n.col+1},r=[];let l=null;if(!this.canMergeRange(i,e))return!1;this.hot.runHooks("beforeMergeCells",t,e),tn(0,i.rowspan-1,(t=>{tn(0,i.colspan-1,(e=>{let o=null;r[t]||(r[t]=[]),0===t&&0===e?o=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(i.row),this.hot.toPhysicalColumn(i.col)):this.hot.setCellMeta(i.row+t,i.col+e,"hidden",!0),r[t][e]=o}))})),this.hot.setCellMeta(i.row,i.col,"spanned",!0);const a=this.mergedCellsCollection.add(i);return!a||(o?l=[i.row,i.col,r]:this.hot.populateFromArray(i.row,i.col,r,void 0,void 0,this.pluginName),e||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",t,i,e),l)}unmergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.mergedCellsCollection.getWithinRange(t);o&&(this.hot.runHooks("beforeUnmergeCells",t,e),O(o,(t=>{this.mergedCellsCollection.remove(t.row,t.col),tn(0,t.rowspan-1,(e=>{tn(0,t.colspan-1,(o=>{this.hot.removeCellMeta(t.row+e,t.col+o,"hidden")}))})),this.hot.removeCellMeta(t.row,t.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",t,e),this.hot.render())}toggleMerge(t){const e=this.mergedCellsCollection.get(t.from.row,t.from.col),o=e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col;o?this.unmergeRange(t):this.mergeSelection(t)}merge(t,e,o,n){const s=this.hot._createCellCoords(t,e),i=this.hot._createCellCoords(o,n);this.mergeRange(this.hot._createCellRange(s,s,i))}unmerge(t,e,o,n){const s=this.hot._createCellCoords(t,e),i=this.hot._createCellCoords(o,n);this.unmergeRange(this.hot._createCellRange(s,s,i))}onAfterInit(){this.generateFromSettings(this.hot.getSettings()[XM]),this.hot.render()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid");e.addShortcut({keys:[["Control","m"]],callback:()=>{this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render()},runOnlyIf:t=>!t.altKey,group:JM})}unregisterShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(JM)}onAfterIsMultipleSelection(t){if(t){const t=this.mergedCellsCollection.mergedCells,e=this.hot.getSelectedRangeLast();for(let o=0;o<t.length;o+=1)if(e.from.row===t[o].row&&e.from.col===t[o].col&&e.to.row===t[o].row+t[o].rowspan-1&&e.to.col===t[o].col+t[o].colspan-1)return!1}return t}onModifyTransformStart(t){const e=QM.get(this),o=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},s=null;const i=this.hot._createCellCoords(o.highlight.row,o.highlight.col),r=this.mergedCellsCollection.get(i.row,i.col);if(e.lastDesiredCoords||(e.lastDesiredCoords=this.hot._createCellCoords(null,null)),r){const o=this.hot._createCellCoords(r.row,r.col),s=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),l=this.hot._createCellRange(o,o,s);l.includes(e.lastDesiredCoords)||(e.lastDesiredCoords=this.hot._createCellCoords(null,null)),n.row=e.lastDesiredCoords.row?e.lastDesiredCoords.row-i.row:n.row,n.col=e.lastDesiredCoords.col?e.lastDesiredCoords.col-i.col:n.col,t.row>0?n.row=r.row+r.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-r.row+t.row),t.col>0?n.col=r.col+r.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-r.col+t.col)}s=this.hot._createCellCoords(o.highlight.row+n.row,o.highlight.col+n.col);const l=this.mergedCellsCollection.get(s.row,s.col);if(l){const t=this.mergedCellsCollection.getFirstRenderableCoords(l.row,l.col);e.lastDesiredCoords=s,n={row:t.row-i.row,col:t.col-i.col}}0!==n.row&&(t.row=n.row),0!==n.col&&(t.col=n.col)}onModifyTransformEnd(t){const e=this.hot.getSelectedRangeLast(),o=xe(t),n=this.selectionCalculations.getUpdatedSelectionRange(e,t);let s=xe(o);const i=this.mergedCellsCollection.getWithinRange(n,!0);do{s=xe(o),this.selectionCalculations.getUpdatedSelectionRange(e,o),O(i,(t=>{this.selectionCalculations.snapDelta(o,e,t)}))}while(o.row!==s.row||o.col!==s.col);t.row=o.row,t.col=o.col}onModifyGetCellCoords(t,e){if(t<0||e<0)return;const o=this.mergedCellsCollection.get(t,e);if(!o)return;const{row:n,col:s,colspan:i,rowspan:r}=o;return[n,s,n+r-1,s+i-1]}addMergeActionsToContextMenu(t){t.items.push({name:"---------"},KM(this))}onAfterRenderer(t,e,o){const n=this.mergedCellsCollection.get(e,o),s=Ae(n)?xe(n):void 0;if(Ae(s)){const{rowIndexMapper:t,columnIndexMapper:n}=this.hot,{row:i,col:r,colspan:l,rowspan:a}=s,[h,c]=this.translateMergedCellToRenderable(i,a,r,l),d=t.getRenderableFromVisualIndex(e),u=n.getRenderableFromVisualIndex(o),g=h-d+1,m=c-u+1;s.row=t.getNearestNotHiddenIndex(s.row,1),s.col=n.getNearestNotHiddenIndex(s.col,1),s.rowspan=Math.min(s.rowspan,g),s.colspan=Math.min(s.colspan,m)}WM(t,s,e,o)}onBeforeSetRangeStart(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}onBeforeSetRangeEnd(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let o=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{o=!1;for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1){const s=this.mergedCellsCollection.mergedCells[n],i=s.getRange();e.expandByRange(i)&&(t.row=e.to.row,t.col=e.to.col,o=!0)}}while(o)}onAfterGetCellMeta(t,e,o){const n=this.mergedCellsCollection.get(t,e);n&&(n.row!==t||n.col!==e?o.copyable=!1:(o.rowspan=n.rowspan,o.colspan=n.colspan))}onAfterViewportRowCalculatorOverride(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}modifyViewportRowStart(t,e){const o=this.hot.rowIndexMapper,n=o.getVisualFromRenderableIndex(t.startRow);for(let s=0;s<e;s+=1){const i=this.mergedCellsCollection.get(n,s);if(Ae(i)){const n=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(i.row,1));if(n<t.startRow)return t.startRow=n,void this.modifyViewportRowStart(t,e)}}}modifyViewportRowEnd(t,e){const o=this.hot.rowIndexMapper,n=o.getVisualFromRenderableIndex(t.endRow);for(let s=0;s<e;s+=1){const i=this.mergedCellsCollection.get(n,s);if(Ae(i)){const n=i.row+i.rowspan-1,s=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1));if(s>t.endRow)return t.endRow=s,void this.modifyViewportRowEnd(t,e)}}}onAfterViewportColumnCalculatorOverride(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}modifyViewportColumnStart(t,e){const o=this.hot.columnIndexMapper,n=o.getVisualFromRenderableIndex(t.startColumn);for(let s=0;s<e;s+=1){const i=this.mergedCellsCollection.get(s,n);if(Ae(i)){const n=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(i.col,1));if(n<t.startColumn)return t.startColumn=n,void this.modifyViewportColumnStart(t,e)}}}modifyViewportColumnEnd(t,e){const o=this.hot.columnIndexMapper,n=o.getVisualFromRenderableIndex(t.endColumn);for(let s=0;s<e;s+=1){const i=this.mergedCellsCollection.get(s,n);if(Ae(i)){const n=i.col+i.colspan-1,s=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1));if(s>t.endColumn)return t.endColumn=s,void this.modifyViewportColumnEnd(t,e)}}}translateMergedCellToRenderable(t,e,o,n){const{rowIndexMapper:s,columnIndexMapper:i}=this.hot;let r,l;r=0===e?s.getNearestNotHiddenIndex(t,1):s.getNearestNotHiddenIndex(t+e-1,-1),l=0===n?i.getNearestNotHiddenIndex(o,1):i.getNearestNotHiddenIndex(o+n-1,-1);const a=t>=0?s.getRenderableFromVisualIndex(r):t,h=o>=0?i.getRenderableFromVisualIndex(l):o;return[a,h]}onModifyAutofillRange(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const o=this.autofillCalculations.getDirection(e,t);let n=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,n,o))return n=e,n;const s=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return s?(n=this.autofillCalculations.snapDragArea(e,n,o,s),n):n}onAfterCreateCol(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}onAfterRemoveCol(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}onAfterCreateRow(t,e,o){"auto"!==o&&this.mergedCellsCollection.shiftCollections("down",t,e)}onAfterRemoveRow(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}onAfterChange(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}onBeforeDrawAreaBorders(t,e){if(e&&"area"===e){const e=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getWithinRange(e);O(o,(o=>{e.getBottomEndCorner().row===o.getLastRow()&&e.getBottomEndCorner().col===o.getLastColumn()&&(t[2]=o.row,t[3]=o.col)}))}}onAfterModifyTransformStart(t,e,o){if(!this.enabled)return;const n=this.mergedCellsCollection.get(t.row,t.col);if(!n)return;const s=e>0,i=e<0,r=o<0,l=o>0,a=n.row+n.rowspan-1===this.hot.countRows()-1,h=0===n.row,c=n.col+n.colspan-1===this.hot.countCols()-1,d=0===n.col;(s&&a||i&&h||l&&c||r&&d)&&(t.row=n.row,t.col=n.col)}onAfterDrawSelection(t,e,o,n){if(o)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,o,n)}onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}function tT(t,e){return function(o,n){const[,...s]=o,[,...i]=n;return function o(n){const r=t[n],l=e[n],a=s[n],h=i[n],c=l.multiColumnSorting,d=c.compareFunctionFactory?c.compareFunctionFactory:qp(l.type),u=d(r,l,c)(a,h);if(u===Np){const t=n+1;if("undefined"!==typeof e[t])return o(t)}return u}(0)}}function eT(){mo(j`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const oT="sort";function nT(t,e,o){const n=[];return!1===o||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push(`${oT}-${t.getIndexOfColumnInSortQueue(e)+1}`),n}function sT(t){const e=t.className.split(" "),o=new RegExp(`^${oT}-[0-9]{1,2}$`);return e.filter((t=>o.test(t)))}const iT="multiColumnSorting",rT=170,lT="append",aT="columnSorting";Kp(iT,tT);class hT extends ow{static get PLUGIN_KEY(){return iT}static get PLUGIN_PRIORITY(){return rT}constructor(t){super(t),this.pluginKey=iT}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[aT]&&eT(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}sort(t){super.sort(t)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(t){return super.getSortConfig(t)}setSortConfig(t){super.setSortConfig(t)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}updateHeaderClasses(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),n=1;n<e;n++)o[n-1]=arguments[n];super.updateHeaderClasses(t,...o),Tt(t,sT(t)),!1!==this.enabled&&Mt(t,nT(...o))}onUpdateSettings(t){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[aT]&&eT(),super.onUpdateSettings(t)}onAfterOnCellMouseDown(t,e){!1!==Ep(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,lT))):this.sort(this.getColumnNextConfig(e.col)))}}const cT="multipleSelectionHandles",dT=160;class uT extends hf{static get PLUGIN_KEY(){return cT}static get PLUGIN_PRIORITY(){return dT}constructor(t){super(t),this.dragged=[],this.eventManager=null,this.lastSetCell=null}isEnabled(){return qe()}enablePlugin(){this.enabled||(this.eventManager||(this.eventManager=new Bo(this)),this.registerListeners(),super.enablePlugin())}registerListeners(){const t=this,{rootElement:e}=this.hot;function o(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;const o=t.dragged.indexOf(e);if(-1===o)return!1;0===o?t.dragged=t.dragged.slice(0,1):1===o&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(e,"touchstart",(e=>{let o;return Et(e.target,"topSelectionHandle-HitArea")?(o=t.hot.getSelectedRangeLast(),t.dragged.push("top"),t.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},e.preventDefault(),!1):Et(e.target,"bottomSelectionHandle-HitArea")?(o=t.hot.getSelectedRangeLast(),t.dragged.push("bottom"),t.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(e,"touchend",(e=>Et(e.target,"topSelectionHandle-HitArea")?(o.call(t,"top"),t.touchStartRange=void 0,e.preventDefault(),!1):Et(e.target,"bottomSelectionHandle-HitArea")?(o.call(t,"bottom"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0)),this.eventManager.addEventListener(e,"touchmove",(e=>{const{rootDocument:o}=this.hot;let n,s,i,r,l,a;if(0===t.dragged.length)return;const h=o.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY);h&&h!==t.lastSetCell&&("TD"!==h.nodeName&&"TH"!==h.nodeName||(n=t.hot.getCoords(h),-1===n.col&&(n.col=0),s=t.hot.getSelectedRangeLast(),i=s.getWidth(),r=s.getHeight(),l=s.getDirection(),1===i&&1===r&&t.hot.selection.setRangeEnd(n),a=t.getCurrentRangeCoords(s,n,t.touchStartRange.direction,l,t.dragged[0]),null!==a.start&&t.hot.selection.setRangeStart(a.start),t.hot.selection.setRangeEnd(a.end),t.lastSetCell=h),e.preventDefault())}))}getCurrentRangeCoords(t,e,o,n,s){const i=t.getTopStartCorner(),r=t.getBottomEndCorner(),l=t.getBottomStartCorner(),a=t.getTopEndCorner();let h={start:null,end:null};switch(o){case"NE-SW":switch(n){case"NE-SW":case"NW-SE":h="top"===s?{start:this.hot._createCellCoords(e.row,t.highlight.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,i.col)};break;case"SE-NW":"bottom"===s&&(h={start:this.hot._createCellCoords(r.row,e.col),end:this.hot._createCellCoords(e.row,i.col)});break;default:break}break;case"NW-SE":switch(n){case"NE-SW":"top"===s?h={start:e,end:l}:h.end=e;break;case"NW-SE":"top"===s?h={start:e,end:r}:h.end=e;break;case"SE-NW":"top"===s?h={start:e,end:i}:h.end=e;break;case"SW-NE":"top"===s?h={start:e,end:a}:h.end=e;break;default:break}break;case"SW-NE":switch(n){case"NW-SE":h="bottom"===s?{start:this.hot._createCellCoords(e.row,i.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(i.row,e.col),end:this.hot._createCellCoords(e.row,r.col)};break;case"SW-NE":h="top"===s?{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,r.col)}:{start:this.hot._createCellCoords(e.row,i.col),end:this.hot._createCellCoords(i.row,e.col)};break;case"SE-NW":"bottom"===s?h={start:this.hot._createCellCoords(e.row,a.col),end:this.hot._createCellCoords(i.row,e.col)}:"top"===s&&(h={start:l,end:e});break;default:break}break;case"SE-NW":switch(n){case"NW-SE":case"NE-SW":case"SW-NE":"top"===s&&(h.end=e);break;case"SE-NW":"top"===s?h.end=e:h={start:e,end:i};break;default:break}break;default:break}return h}isDragged(){return this.dragged.length>0}}function gT(){let{label:t="",colspan:e=1,origColspan:o=1,collapsible:n=!1,crossHiddenColumns:s=[],isCollapsed:i=!1,isHidden:r=!1,isRoot:l=!1,isPlaceholder:a=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:t,colspan:e,origColspan:o,collapsible:n,isCollapsed:i,crossHiddenColumns:s,isHidden:r,isRoot:l,isPlaceholder:a}}function mT(){return{label:"",isPlaceholder:!0}}function fT(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const o=[];if(0===e)return o;O(t,(t=>{const n=[];let s=0;o.push(n),O(t,(t=>{const o=gT();if(Ae(t)){const{label:e,colspan:n}=t;o.label=U(e),"number"===typeof n&&n>1&&(o.colspan=n,o.origColspan=n)}else o.label=U(t);s+=o.origColspan;let i=!1;if(s>=e&&(o.colspan=o.origColspan-(s-e),o.origColspan=o.colspan,i=!0),n.push(o),o.colspan>1)for(let e=0;e<o.colspan-1;e++)n.push(mT());return!i}))}));const n=Math.max(...A(o,(t=>t.length)));return O(o,(t=>{if(t.length<n){const e=A(new Array(n-t.length),(()=>gT()));t.splice(t.length,0,...e)}})),o}function pT(t,e,o){wT(t,e),e.set(t,o)}function wT(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CT(t,e){var o=bT(t,e,"get");return yT(t,o)}function yT(t,e){return e.get?e.get.call(t):e.value}function vT(t,e,o){var n=bT(t,e,"set");return ST(t,n,o),o}function bT(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function ST(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}const RT=["label","collapsible"];var ET=new WeakMap,MT=new WeakMap,TT=new WeakMap;class xT{constructor(){pT(this,ET,{writable:!0,value:[]}),pT(this,MT,{writable:!0,value:0}),pT(this,TT,{writable:!0,value:1/0})}setColumnsLimit(t){vT(this,TT,t)}setData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];vT(this,ET,fT(t,CT(this,TT))),vT(this,MT,CT(this,ET).length)}getData(){return CT(this,ET)}mergeWith(t){O(t,(t=>{let{row:e,col:o,...n}=t;const s=this.getHeaderSettings(e,o);null!==s&&Ee(s,n,RT)}))}map(t){O(CT(this,ET),(e=>{O(e,(e=>{const o=t({...e});Ae(o)&&Ee(e,o,RT)}))}))}getHeaderSettings(t,e){var o;if(t>=CT(this,MT)||t<0)return null;const n=CT(this,ET)[t];return e>=n.length?null:null!==(o=n[e])&&void 0!==o?o:null}getHeadersSettings(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const n=[];if(t>=CT(this,MT)||t<0)return n;const s=CT(this,ET)[t];let i=0;for(let r=e;r<s.length;r++){const t=s[r];if(t.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(i+=t.colspan,n.push(t),t.colspan>1&&(r+=t.colspan-1),i===o)break;if(i>o)throw new Error("The last column settings cannot overlap the other header layers")}return n}getLayersCount(){return CT(this,MT)}getColumnsCount(){return CT(this,MT)>0?CT(this,ET)[0].length:0}clear(){vT(this,ET,[]),vT(this,MT,0)}}function IT(t,e,o){return e=HT(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function HT(t){var e=AT(t,"string");return"symbol"===typeof e?e:String(e)}function AT(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}const OT="DF-pre-order";function kT(t,e){let o=t.call(e,this);for(let n=0;n<this.childs.length;n++){if(!1===o)return!1;o=kT.call(this.childs[n],t,e)}return o}const NT="DF-post-order";function PT(t,e){for(let o=0;o<this.childs.length;o++){const n=PT.call(this.childs[o],t,e);if(!1===n)return!1}return t.call(e,this)}const _T="BF";function DT(t,e){const o=[this];function n(){if(0===o.length)return;const s=o.shift();o.push(...s.childs),!1!==t.call(e,s)&&n()}n()}const LT=_T,VT=new Map([[OT,kT],[NT,PT],[_T,DT]]);class BT{constructor(t){IT(this,"data",{}),IT(this,"parent",null),IT(this,"childs",[]),this.data=t}addChild(t){t.parent=this,this.childs.push(t)}cloneTree(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const e=new BT({...t.data});for(let o=0;o<t.childs.length;o++)e.addChild(this.cloneTree(t.childs[o]));return e}replaceTreeWith(t){this.data={...t.data},this.childs=[];for(let e=0;e<t.childs.length;e++)this.addChild(t.childs[e])}walkDown(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:LT;if(!VT.has(e))throw new Error(`Traversal strategy "${e}" does not exist`);VT.get(e).call(this,t,this)}walkUp(t){const e=this,o=n=>{const s=t.call(e,n);!1!==s&&null!==n.parent&&o(n.parent)};o(this)}}function FT(t,e,o){WT(t,e),e.set(t,o)}function WT(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jT(t,e){var o=$T(t,e,"get");return UT(t,o)}function UT(t,e){return e.get?e.get.call(t):e.value}function zT(t,e,o){var n=$T(t,e,"set");return GT(t,n,o),o}function $T(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function GT(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}var YT=new WeakMap,KT=new WeakMap,XT=new WeakMap;class qT{constructor(t){FT(this,YT,{writable:!0,value:new Map}),FT(this,KT,{writable:!0,value:new Map}),FT(this,XT,{writable:!0,value:null}),zT(this,XT,t)}getRoots(){return Array.from(jT(this,YT).values())}getRootByColumn(t){let e;return jT(this,KT).has(t)&&(e=jT(this,YT).get(jT(this,KT).get(t))),e}getNode(t,e){const o=this.getRootByColumn(e);if(!o)return;const n=e-jT(this,KT).get(e);let s,i=0;return o.walkDown((o=>{const{data:{origColspan:r,headerLevel:l}}=o;if(t===l){if(n>=i&&n<=i+r-1)return s=o,s.data.isRoot=e===s.data.columnIndex,!1;i+=r}})),s}rebuildTreeIndex(){let t=0;jT(this,KT).clear(),O(jT(this,YT),(e=>{let[,{data:{colspan:o}}]=e;for(let n=t;n<t+o;n++)jT(this,KT).set(n,t);t+=o}))}buildTree(){this.clear();const t=jT(this,XT).getColumnsCount();let e=0;while(e<t){const t=jT(this,XT).getHeaderSettings(0,e),o=new BT;jT(this,YT).set(e,o),this.buildLeaves(o,e,0,t.origColspan),e+=t.origColspan}this.rebuildTreeIndex()}buildLeaves(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const s=jT(this,XT).getHeadersSettings(o,e,n);o+=1,O(s,(n=>{const s={...n,headerLevel:o-1,columnIndex:e};let i;1===o?(t.data=s,i=t):(i=new BT(s),t.addChild(i)),o<jT(this,XT).getLayersCount()&&this.buildLeaves(i,e,o,n.origColspan),e+=n.origColspan}))}clear(){jT(this,YT).clear(),jT(this,KT).clear()}}function QT(t,e){t.walkDown((t=>{let{data:o,childs:n}=t;if(!o.isHidden&&(e(o.columnIndex),0===n.length))for(let s=1;s<o.colspan;s++)e(o.columnIndex+s)}))}function JT(t,e){let{childs:o}=t;if(0!==o.length)return o[0].data[e]}function ZT(t){return JT(t,"origColspan")===t.data.origColspan}function tx(t){const{data:e,childs:o}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};const n=ZT(t);if(n)return tx(o[0]);e.isCollapsed=!1;const s=o.slice(1),i=new Set;let r=0;if(s.length>0)O(s,(t=>{t.replaceTreeWith(t.data.clonedTree),t.data.clonedTree=null;const e=t.data;r+=e.colspan,QT(t,(t=>{i.add(t)}))}));else{const{colspan:t,origColspan:o,columnIndex:n}=e;r=o-t;for(let e=1;e<o;e++)i.add(n+e)}return t.walkUp((t=>{const{data:e}=t;e.colspan+=r,e.colspan>=e.origColspan?(e.colspan=e.origColspan,e.isCollapsed=!1):ZT(t)&&(e.isCollapsed=JT(t,"isCollapsed"))})),{rollbackModification:()=>ex(t),affectedColumns:Array.from(i),colspanCompensation:r}}function ex(t){var e;const{data:o,childs:n}=t;if(o.isCollapsed||o.isHidden||o.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};const s=ZT(t);if(s)return ex(n[0]);o.isCollapsed=!0;const i=n.slice(1),r=new Set;if(i.length>0)O(i,(t=>{QT(t,(t=>{r.add(t)})),t.data.clonedTree=t.cloneTree(),t.walkDown((t=>{let{data:e}=t;e.isHidden=!0}))}));else{const{origColspan:t,columnIndex:e}=o;for(let o=1;o<t;o++){const t=e+o;r.add(t)}}const l=o.colspan-(null!==(e=JT(t,"colspan"))&&void 0!==e?e:1);return t.walkUp((t=>{const{data:e}=t;e.colspan-=l,e.colspan<=1?(e.colspan=1,e.isCollapsed=!0):ZT(t)&&(e.isCollapsed=JT(t,"isCollapsed"))})),{rollbackModification:()=>tx(t),affectedColumns:Array.from(r),colspanCompensation:l}}function ox(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(j`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:o}=t.data;if(o.includes(e))return;let n=!1;t.walkUp((t=>{const{data:{collapsible:e}}=t;if(e)return n=!0,!1})),n||t.walkUp((t=>{const{data:o}=t;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0}))}function nx(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(j`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:o}=t.data;if(!o.includes(e))return;let n=!1;t.walkUp((t=>{const{data:{collapsible:e}}=t;if(e)return n=!0,!1})),n||t.walkUp((t=>{const{data:o}=t;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1}))}const sx=new Map([["collapse",ex],["expand",tx],["hide-column",ox],["show-column",nx]]);function ix(t,e,o){if(!sx.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return sx.get(t)(e,o)}function rx(t){const e=[];return O(t,(t=>{t.walkDown((t=>{const o=t.data,{origColspan:n,columnIndex:s,headerLevel:i,crossHiddenColumns:r}=o,l=ax(e,i);let a=!1;for(let e=s;e<s+n;e++){const t=r.includes(e);if(t||a)l.push(mT(o));else{const t=lx(o);t.isRoot=!0,l.push(t),a=!0}}}))})),e}function lx(t){const{crossHiddenColumns:e,...o}=gT(t);return o}function ax(t,e){let o;return Array.isArray(t[e])?o=t[e]:(o=[],t[e]=o),o}function hx(t,e,o){cx(t,e),e.set(t,o)}function cx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dx(t,e,o){var n=mx(t,e,"set");return ux(t,n,o),o}function ux(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function gx(t,e){var o=mx(t,e,"get");return fx(t,o)}function mx(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function fx(t,e){return e.get?e.get.call(t):e.value}var px=new WeakMap,wx=new WeakMap,Cx=new WeakMap;class yx{constructor(){hx(this,px,{writable:!0,value:new xT}),hx(this,wx,{writable:!0,value:new qT(gx(this,px))}),hx(this,Cx,{writable:!0,value:[[]]})}setState(t){gx(this,px).setData(t);let e=!1;try{gx(this,wx).buildTree()}catch(o){gx(this,wx).clear(),gx(this,px).clear(),e=!0}return dx(this,Cx,rx(gx(this,wx).getRoots())),e}setColumnsLimit(t){gx(this,px).setColumnsLimit(t)}mergeStateWith(t){const e=A(t,(t=>{let{row:e,...o}=t;return{row:e<0?this.rowCoordsToLevel(e):e,...o}}));gx(this,px).mergeWith(e),gx(this,wx).buildTree(),dx(this,Cx,rx(gx(this,wx).getRoots()))}mapState(t){gx(this,px).map(t),gx(this,wx).buildTree(),dx(this,Cx,rx(gx(this,wx).getRoots()))}mapNodes(t){return I(gx(this,wx).getRoots(),((e,o)=>(o.walkDown((o=>{const n=t(o.data);void 0!==n&&e.push(n)})),e)),[])}triggerNodeModification(t,e,o){e<0&&(e=this.rowCoordsToLevel(e));const n=gx(this,wx).getNode(e,o);let s;return n&&(s=ix(t,n,o),dx(this,Cx,rx(gx(this,wx).getRoots()))),s}triggerColumnModification(t,e){return this.triggerNodeModification(t,-1,e)}rowCoordsToLevel(t){if(t>=0)return null;const e=t+Math.max(this.getLayersCount(),1);return e<0?null:e}levelToRowCoords(t){if(t<0)return null;const e=t-Math.max(this.getLayersCount(),1);return e>=0?null:e}getHeaderSettings(t,e){var o,n;return t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount()?null:null!==(o=null===(n=gx(this,Cx)[t])||void 0===n?void 0:n[e])&&void 0!==o?o:null}getHeaderTreeNodeData(t,e){if(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())return null;const o=gx(this,wx).getNode(t,e);return o?{...o.data}:null}findLeftMostColumnIndex(t,e){var o;const{isRoot:n}=null!==(o=this.getHeaderSettings(t,e))&&void 0!==o?o:{isRoot:!0};if(n)return e;let s=e-1;while(s>=0){var i;const{isRoot:e}=null!==(i=this.getHeaderSettings(t,s))&&void 0!==i?i:{isRoot:!0};if(e)break;s-=1}return s}getLayersCount(){return gx(this,px).getLayersCount()}getColumnsCount(){return gx(this,px).getColumnsCount()}clear(){dx(this,Cx,[]),gx(this,px).clear(),gx(this,wx).clear()}}function vx(t,e,o){return e=bx(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function bx(t){var e=Sx(t,"string");return"symbol"===typeof e?e:String(e)}function Sx(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}class Rx{constructor(t,e){vx(this,"hot",void 0),vx(this,"nestedHeaderSettingsGetter",void 0),vx(this,"layersCount",0),vx(this,"container",void 0),vx(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=e,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(t){return this.layersCount=t,this}getWidth(t){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length;this.widthsMap.clear();for(let o=0;o<e;o++){const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),n=this.hot.toPhysicalColumn(e);this.widthsMap.setValueAtIndex(n,t[o].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(t){const{rootDocument:e,columnIndexMapper:o}=this.hot,n=e.createDocumentFragment(),s=e.createElement("table"),i=!!this.hot.getSettings().dropdownMenu,r=o.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const t=e.createElement("tr");for(let n=0;n<r;n++){let s=o.getVisualFromRenderableIndex(n);null===s&&(s=n);const r=e.createElement("th"),a=this.nestedHeaderSettingsGetter(l,s);if(a&&(!a.isPlaceholder||a.isHidden)){let e=a.label;i&&(e+='<button class="changeType"></button>'),At(r,e),r.colSpan=a.colspan,t.appendChild(r)}}s.appendChild(t)}n.appendChild(s),t.appendChild(n)}clear(){this.widthsMap.clear(),this.container=null}}var Ex=Rx;function Mx(t,e,o){return e=Tx(e),e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function Tx(t){var e=xx(t,"string");return"symbol"===typeof e?e:String(e)}function xx(t,e){if("object"!==typeof t||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var n=o.call(t,e||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ix(t,e,o){Hx(t,e),e.set(t,o)}function Hx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ax(t,e,o){var n=Nx(t,e,"set");return Ox(t,n,o),o}function Ox(t,e,o){if(e.set)e.set.call(t,o);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=o}}function kx(t,e){var o=Nx(t,e,"get");return Px(t,o)}function Nx(t,e,o){if(!e.has(t))throw new TypeError("attempted to "+o+" private field on non-instance");return e.get(t)}function Px(t,e){return e.get?e.get.call(t):e.value}const _x="nestedHeaders",Dx=280;var Lx=new WeakMap,Vx=new WeakMap;class Bx extends hf{constructor(){super(...arguments),Ix(this,Lx,{writable:!0,value:new yx}),Ix(this,Vx,{writable:!0,value:null}),Mx(this,"ghostTable",new Ex(this.hot,((t,e)=>this.getHeaderSettings(t,e)))),Mx(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return _x}static get PLUGIN_PRIORITY(){return Dx}isEnabled(){return!!this.hot.getSettings()[_x]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();Array.isArray(e)&&Array.isArray(e[0])||mo(j`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",(()=>this.onInit())),this.addHook("afterLoadData",(function(){return t.onAfterLoadData(...arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown(...arguments)})),this.addHook("afterOnCellMouseDown",(function(){return t.onAfterOnCellMouseDown(...arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return t.onBeforeOnCellMouseOver(...arguments)})),this.addHook("afterGetColumnHeaderRenderers",(t=>this.onAfterGetColumnHeaderRenderers(t))),this.addHook("modifyColWidth",(function(){return t.onModifyColWidth(...arguments)})),this.addHook("modifyColumnHeaderValue",(function(){return t.onModifyColumnHeaderValue(...arguments)})),this.addHook("beforeHighlightingColumnHeader",(function(){return t.onBeforeHighlightingColumnHeader(...arguments)})),this.addHook("beforeCopy",(function(){return t.onBeforeCopy(...arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return t.onAfterViewportColumnCalculatorOverride(...arguments)})),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:t}=this.hot.getSettings();kx(this,Lx).setColumnsLimit(this.hot.countCols()),Array.isArray(t)&&(this.detectedOverlappedHeaders=kx(this,Lx).setState(t)),this.detectedOverlappedHeaders&&mo(j`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(((t,e)=>{const o=!0===t?"hide-column":"show-column";kx(this,Lx).triggerColumnModification(o,e)})),!kx(this,Vx)&&this.enabled&&Ax(this,Vx,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((t=>{t.forEach((t=>{let{op:e,index:o,newValue:n}=t;if("replace"===e){const t=!0===n?"hide-column":"show-column";kx(this,Lx).triggerColumnModification(t,o)}})),this.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),kx(this,Lx).clear(),kx(this,Vx).unsubscribe(),Ax(this,Vx,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return kx(this,Lx)}getLayersCount(){return kx(this,Lx).getLayersCount()}getHeaderSettings(t,e){return kx(this,Lx).getHeaderSettings(t,e)}clearColspans(){if(!this.hot.view)return;const{_wt:t}=this.hot.view,e=t.getSetting("columnHeaders").length,o=t.wtTable.THEAD,n=t.wtOverlays.topOverlay.clone.wtTable.THEAD,s=t.wtOverlays.topInlineStartCornerOverlay?t.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let i=0;i<e;i++){const t=o.childNodes[i];if(!t)break;const e=n.childNodes[i],r=s?s.childNodes[i]:null;for(let o=0,n=t.childNodes.length;o<n;o++)t.childNodes[o].removeAttribute("colspan"),Tt(t.childNodes[o],"hiddenHeader"),e&&e.childNodes[o]&&(e.childNodes[o].removeAttribute("colspan"),Tt(e.childNodes[o],"hiddenHeader")),s&&r&&r.childNodes[o]&&(r.childNodes[o].removeAttribute("colspan"),Tt(r.childNodes[o],"hiddenHeader"))}}headerRendererFactory(t){var e=this;const o=this.hot.view._wt.getSetting("fixedColumnsStart");return(n,s)=>{var i;const{columnIndexMapper:r,view:l}=this.hot;let a=r.getVisualFromRenderableIndex(n);null===a&&(a=n),s.removeAttribute("colspan"),Tt(s,"hiddenHeader");const{colspan:h,isHidden:c,isPlaceholder:d}=null!==(i=kx(this,Lx).getHeaderSettings(t,a))&&void 0!==i?i:{label:""};if(d||c)Mt(s,"hiddenHeader");else if(h>1){var u,g;const{wtOverlays:t}=l._wt,e=null===(u=t.topInlineStartCornerOverlay)||void 0===u?void 0:u.clone.wtTable.THEAD.contains(s),i=null===(g=t.inlineStartOverlay)||void 0===g?void 0:g.clone.wtTable.THEAD.contains(s),r=e||i?Math.min(h,o-n):h;r>1&&s.setAttribute("colspan",r)}this.hot.view.appendColHeader(a,s,(function(){return e.getColumnHeaderValue(...arguments)}),t)}}getColumnHeaderValue(t,e){var o;const{isHidden:n,isPlaceholder:s}=null!==(o=kx(this,Lx).getHeaderSettings(e,t))&&void 0!==o?o:{};return s||n?"":this.hot.getColHeader(t,e)}onBeforeHighlightingColumnHeader(t,e,o){const n=kx(this,Lx).getHeaderTreeNodeData(e,t);if(!n)return t;const{classNames:s,columnCursor:i,selectionType:r,selectionWidth:l}=o,{isRoot:a,colspan:h}=kx(this,Lx).getHeaderSettings(e,t);if(r===sc){if(!a)return n.columnIndex}else r===tc&&(h>l-i||!a)&&(s.length=0);return t}onBeforeCopy(t,e,o){let{columnHeadersCount:n}=o;if(0!==n)for(let i=0;i<e.length;i++){const{startRow:o,startCol:n,endRow:r,endCol:l}=e[i],a=r-o+1,h=n-l+1;if(o>=0||1===h)break;for(let e=n;e<=l;e++)for(let i=o;i<=r;i++){var s;const o=a+i,r=e-n;if(0===r)continue;const l=null===(s=kx(this,Lx).getHeaderTreeNodeData(i,e))||void 0===s?void 0:s.isRoot;!1===l&&(t[o][r]="")}}}onBeforeOnCellMouseDown(t,e,o,n){const s=this._getHeaderTreeNodeDataByCoords(e);s&&(n.column=!0)}onAfterOnCellMouseDown(t,e){const o=this._getHeaderTreeNodeDataByCoords(e);if(!o)return;const{selection:n}=this.hot,s=n.isSelected()?n.getSelectedRange().current():null,i=[],{columnIndex:r,origColspan:l}=o,a=!n.inInSelection(e);t.shiftKey&&s?e.col<s.from.col?i.push(s.getTopEndCorner().col,r,e.row):e.col>s.from.col?i.push(s.getTopStartCorner().col,r+l-1,e.row):i.push(r,r+l-1,e.row):(go(t)||uo(t)&&a)&&i.push(r,r+l-1,e.row),n.selectColumns(...i)}onBeforeOnCellMouseOver(t,e,o,n){if(!this.hot.view.isMouseDown())return;const s=this._getHeaderTreeNodeDataByCoords(e);if(!s)return;const{columnIndex:i,origColspan:r}=s,l=this.hot.getSelectedRangeLast(),a=l.getTopStartCorner(),h=l.getBottomEndCorner(),{from:c}=l;n.column=!0,n.cell=!0;const d=[];e.col<c.col?d.push(h.col,i):e.col>c.col?d.push(a.col,i+r-1):d.push(i,i+r-1),this.hot.selectColumns(...d)}onAfterGetColumnHeaderRenderers(t){t.length=0;for(let e=0;e<kx(this,Lx).getLayersCount();e++)t.push(this.headerRendererFactory(e))}onAfterViewportColumnCalculatorOverride(t){const e=kx(this,Lx).getLayersCount();let o=t.startColumn,n=!!e;for(let s=0;s<e;s++){const e=kx(this,Lx).findLeftMostColumnIndex(s,t.startColumn),i=this.hot.columnIndexMapper.getRenderableFromVisualIndex(e);if(e>=0&&(n=!1),Jo(i)&&i<t.startColumn){o=i;break}}t.startColumn=n?kx(this,Lx).getHeaderTreeNodeData(0,o).columnIndex:o}onModifyColWidth(t,e){const o=this.ghostTable.getWidth(e);return t>o?t:o}onModifyColumnHeaderValue(t,e,o){var n;const{label:s}=null!==(n=kx(this,Lx).getHeaderTreeNodeData(o,e))&&void 0!==n?n:{label:""};return s}onInit(){this.updatePlugin()}onAfterLoadData(t,e){e||this.updatePlugin()}destroy(){Ax(this,Lx,null),null!==kx(this,Vx)&&(kx(this,Vx).unsubscribe(),Ax(this,Vx,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(t){if(!(t.row>=0||t.col<0))return kx(this,Lx).getHeaderTreeNodeData(t.row,t.col)}}class Fx{constructor(t,e){this.hot=e,this.data=null,this.plugin=t,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}setData(t){this.data=t}getData(){return this.data}getRawSourceData(){let t=null;return this.plugin.disableCoreAPIModifiers(),t=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),t}updateWithData(t){this.setData(t),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},tn(0,this.data.length-1,(t=>{this.cacheNode(this.data[t],0,null)}))}cacheNode(t,e,o){this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:o,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&O(t.__children,(o=>{this.cacheNode(o,e+1,t)}))}getDataObject(t){return null===t||void 0===t?null:this.cache.rows[t]}readTreeNodes(t,e,o,n){let s=!1,i=e;if(isNaN(i)&&i.end)return i;let r=t;return r||(r={__children:this.data},s=!0,i-=1),null!==o&&void 0!==o&&i===o?{result:r,end:!0}:null!==n&&void 0!==n&&r===n?{result:i,end:!0}:(i+=1,r.__children&&O(r.__children,(t=>{if(this.parentReference.set(t,s?null:r),i=this.readTreeNodes(t,i,o,n),isNaN(i)&&i.end)return!1})),i)}mockParent(){const t=this.mockNode();return t.__children=this.data,t}mockNode(){const t={};return ke(this.data[0],((e,o)=>{t[o]=null})),t}getRowIndex(t){return null===t||void 0===t?null:this.cache.nodeInfo.get(t).row}getRowIndexWithinParent(t){let e=null;e=isNaN(t)?t:this.getDataObject(t);const o=this.getRowParent(t);return null===o||void 0===o?this.data.indexOf(e):o.__children.indexOf(e)}countAllRows(){const t={__children:this.data};return this.countChildren(t)}countChildren(t){let e=0,o=t;return isNaN(o)||(o=this.getDataObject(o)),o&&o.__children?(O(o.__children,(t=>{e+=1,t.__children&&(e+=this.countChildren(t))})),e):0}getRowParent(t){let e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}getRowObjectParent(t){return t&&"object"===typeof t?this.cache.nodeInfo.get(t).parent:null}getRowLevel(t){let e=null;return e=isNaN(t)?t:this.getDataObject(t),e?this.getRowObjectLevel(e):null}getRowObjectLevel(t){return null===t||void 0===t?null:this.cache.nodeInfo.get(t).level}hasChildren(t){let e=t;return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)}isChild(t){return null!==this.getRowParent(t)}getChild(t,e){var o;return(null===(o=t.__children)||void 0===o?void 0:o[e])||null}isRowHighestLevel(t){return!this.isChild(t)}isParent(t){var e;let o=t;return isNaN(o)||(o=this.getDataObject(o)),o&&!!o.__children&&0!==(null===(e=o.__children)||void 0===e?void 0:e.length)}addChild(t,e){let o=e;this.hot.runHooks("beforeAddChild",t,o);let n=null;t&&(n=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",n+this.countChildren(t)+1,1);let s=t;t||(s=this.mockParent()),s.__children||(s.__children=[]),o||(o=this.mockNode()),s.__children.push(o),this.rewriteCache();const i=this.getRowIndex(o);this.hot.rowIndexMapper.insertIndexes(i,1),this.hot.runHooks("afterCreateRow",i,1),this.hot.runHooks("afterAddChild",t,o)}addChildAtIndex(t,e,o){let n,s=o;if(s||(s=this.mockNode()),this.hot.runHooks("beforeAddChild",t,s,e),t){const o=this.getRowIndex(t),i=o+e+1;this.hot.runHooks("beforeCreateRow",i,1),t.__children.splice(e,null,s),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(i,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",i,1),n=i}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",e,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),n=this.getRowIndex(this.data[e]);s=this.getDataObject(n),this.hot.runHooks("afterAddChild",t,s,e)}addSibling(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const o=this.translateTrimmedRow(t),n=this.getRowParent(o),s=this.getRowIndexWithinParent(o);switch(e){case"below":this.addChildAtIndex(n,s+1,null);break;case"above":this.addChildAtIndex(n,s,null);break;default:break}}detachFromParent(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=null;const n=[];Array.isArray(t)?(tn(t[0],t[2],(t=>{const e=this.translateTrimmedRow(t);n.push(this.getDataObject(e))})),tn(0,n.length-2,(t=>{this.detachFromParent(n[t],!1)})),o=n[n.length-1]):o=t;const s=this.getRowIndex(o),i=this.countChildren(o),r=this.getRowIndexWithinParent(o),l=this.getRowParent(o),a=this.getRowParent(l),h=this.getRowIndex(a);let c=null;if(this.hot.runHooks("beforeDetachChild",l,o),null!==r&&void 0!==r){const t=Array.from(new Array(s+i+1).keys()).splice(-1*(i+1));if(this.hot.runHooks("beforeRemoveRow",s,i+1,t,this.plugin.pluginName),l.__children.splice(r,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,i+1,t,this.plugin.pluginName),a){c=h+this.countChildren(a);const t=this.getChild(a,this.countChildren(a)-1),e=this.getRowIndex(t);this.hot.runHooks("beforeCreateRow",e+1,i+1,this.plugin.pluginName),a.__children.push(o)}else c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c-2,i+1,this.plugin.pluginName),this.data.push(o)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",c-2,i+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,o,this.getRowIndex(o)),e&&this.hot.render()}filterData(t,e,o){const n=[];O(o,(t=>{n.push(this.getDataObject(t))})),O(n,(t=>{const e=this.getRowIndexWithinParent(t),o=this.getRowParent(t);null===o?this.data.splice(e,1):o.__children.splice(e,1)})),this.rewriteCache()}spliceData(t,e,o){const n=this.getDataObject(t-1);let s=null,i=t;n&&n.__children&&0===n.__children.length?(s=n,i=0):t<this.countAllRows()&&(s=this.getRowParent(t),i=this.getRowIndexWithinParent(t)),s?o?s.__children.splice(i,e,...o):s.__children.splice(i,e):o?this.data.splice(i,e,...o):this.data.splice(i,e),this.rewriteCache()}syncRowWithRawSource(t){let e=t,o=null;do{o=this.getRowParent(o),null!==o&&(e=o)}while(null!==o);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(e),"__children",e.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(t,e,o,n){const s=e===this.hot.countRows(),i=this.getRowParent(t),r=this.getRowIndexWithinParent(t),l=i.__children.slice(r,r+1),a=t>e;let h=s?this.getRowParent(e-1):this.getRowParent(e);null!==h&&void 0!==h||(h=this.getRowParent(e-1)),null!==h&&void 0!==h||(h=this.getDataObject(e-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(e),h.__children=[]);const c=s||o||n?h.__children.length:this.getRowIndexWithinParent(e),d=i===h;h.__children.splice(c,0,l[0]),i.__children.splice(r+(a&&d?1:0),1),this.syncRowWithRawSource(i),d||this.syncRowWithRawSource(h)}translateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}untranslateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(t):t}}var Wx=Fx;class jx{constructor(t,e){this.hot=e,this.plugin=t}}var Ux=jx;class zx extends Ux{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(t,e){super(t,e),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(t,e){const o=this.hot.toPhysicalRow(t),n=this.dataManager.getRowLevel(o),s=this.dataManager.getDataObject(o),i=e.getElementsByTagName("DIV")[0],r=i.querySelector("span.rowHeader"),l=i.querySelectorAll('[class^="ht_nesting"]');if(O(l,(t=>{t&&i.removeChild(t)})),Mt(e,zx.CSS_CLASSES.indicatorContainer),n){const{rootDocument:t}=this.hot,e=r.cloneNode(!0);i.innerHTML="",tn(0,n-1,(()=>{const e=t.createElement("SPAN");Mt(e,zx.CSS_CLASSES.emptyIndicator),i.appendChild(e)})),i.appendChild(e)}if(this.dataManager.hasChildren(s)){const t=this.hot.rootDocument.createElement("DIV");Mt(e,zx.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(o)?Mt(t,`${zx.CSS_CLASSES.button} ${zx.CSS_CLASSES.expandButton}`):Mt(t,`${zx.CSS_CLASSES.button} ${zx.CSS_CLASSES.collapseButton}`),i.appendChild(t)}}updateRowHeaderWidth(t){let e=t;e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}var $x=zx;class Gx extends Ux{constructor(t,e){var o;super(t,e),o=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,t)},shiftStash:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null!==e&&void 0!==e||(e=1/0),O(o.lastCollapsedRows,((s,i)=>{s>=t&&s<e&&(o.lastCollapsedRows[i]=s+n)}))},applyStash:function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];o.collapseMultipleChildren(o.lastCollapsedRows,t),o.lastCollapsedRows=void 0},trimStash:(t,e)=>{tn(t,t+e-1,(t=>{const e=this.lastCollapsedRows.indexOf(t);e>-1&&this.lastCollapsedRows.splice(e,1)}))}}}collapseChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];let s=null,i=null,r=null;return isNaN(t)?(s=t,i=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(t),i=t),this.dataManager.hasChildren(s)&&O(s.__children,(t=>{n.push(this.dataManager.getRowIndex(t))})),r=this.collapseRows(n,!0,!1),o&&this.trimRows(r),e&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(i)&&this.collapsedRows.push(i),r}collapseMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];O(t,(t=>{n.push(...this.collapseChildren(t,!1,!1))})),o&&this.trimRows(n),e&&this.renderAndAdjust()}collapseRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([t],e)}collapseRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=[];return O(t,(t=>{n.push(t),e&&this.collapseChildRows(t,n)})),o&&this.trimRows(n),n}collapseChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){const o=this.dataManager.getDataObject(t);O(o.__children,(t=>{const o=this.dataManager.getRowIndex(t);e.push(o),this.collapseChildRows(o,e)}))}o&&this.trimRows(e)}expandRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([t],e)}expandRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=[];return O(t,(t=>{n.push(t),e&&this.expandChildRows(t,n)})),o&&this.untrimRows(n),n}expandChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){const o=this.dataManager.getDataObject(t);O(o.__children,(t=>{if(!this.isAnyParentCollapsed(t)){const o=this.dataManager.getRowIndex(t);e.push(o),this.expandChildRows(o,e)}}))}o&&this.untrimRows(e)}expandChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];let s=null,i=null,r=null;return isNaN(t)?(s=t,i=this.dataManager.getRowIndex(t)):(s=this.dataManager.getDataObject(t),i=t),this.collapsedRows.splice(this.collapsedRows.indexOf(i),1),this.dataManager.hasChildren(s)&&O(s.__children,(t=>{const e=this.dataManager.getRowIndex(t);n.push(e)})),r=this.expandRows(n,!0,!1),o&&this.untrimRows(r),e&&this.renderAndAdjust(),r}expandMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];O(t,(t=>{n.push(...this.expandChildren(t,!1,!1))})),o&&this.untrimRows(n),e&&this.renderAndAdjust()}collapseAll(){const t=this.dataManager.getData(),e=[];O(t,(t=>{this.dataManager.hasChildren(t)&&e.push(t)})),this.collapseMultipleChildren(e),this.renderAndAdjust()}expandAll(){const t=this.dataManager.getData(),e=[];O(t,(t=>{this.dataManager.hasChildren(t)&&e.push(t)})),this.expandMultipleChildren(e),this.renderAndAdjust()}trimRows(t){this.hot.batchExecution((()=>{O(t,(t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)}))}),!0)}untrimRows(t){this.hot.batchExecution((()=>{O(t,(t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)}))}),!0)}areChildrenCollapsed(t){let e=isNaN(t)?t:this.dataManager.getDataObject(t),o=!0;return null===e&&(e={__children:this.dataManager.data}),this.dataManager.hasChildren(e)&&O(e.__children,(t=>{const e=this.dataManager.getRowIndex(t);if(!this.plugin.collapsedRowsMap.getValueAtIndex(e))return o=!1,!1})),o}isAnyParentCollapsed(t){let e=t;while(null!==e){e=this.dataManager.getRowParent(e);const t=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(t)>-1)return!0}return!1}toggleState(t,e){if(e.col>=0)return;const o=this.translateTrimmedRow(e.row);Et(t.target,$x.CSS_CLASSES.button)&&(this.areChildrenCollapsed(o)?this.expandChildren(o):this.collapseChildren(o),ho(t))}translateTrimmedRow(t){return this.hot.toPhysicalRow(t)}untranslateTrimmedRow(t){return this.hot.toVisualRow(t)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}var Yx=Gx;const Kx=new WeakMap;class Xx extends Ux{constructor(t,e){super(t,e),Kx.set(this,{row_above:(t,e)=>{const o=e[e.length-1];this.dataManager.addSibling(o.start.row,"above")},row_below:(t,e)=>{const o=e[e.length-1];this.dataManager.addSibling(o.start.row,"below")}}),this.dataManager=this.plugin.dataManager}appendOptions(t){const e=[{key:"add_child",name(){return this.getTranslatedPhrase(Qa)},callback:()=>{const t=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),e=this.dataManager.getDataObject(t);this.dataManager.addChild(e)},disabled:()=>{const t=this.hot.getSelectedLast();return!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Ja)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const t=this.hot.getSelectedLast(),e=this.dataManager.translateTrimmedRow(t[0]),o=this.dataManager.getRowParent(e);return!o||!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return tn(0,t.items.length-1,(o=>{if(0===o)return O(e,((e,n)=>{t.items.splice(o+n,0,e)})),!1})),this.modifyRowInsertingOptions(t)}modifyRowInsertingOptions(t){const e=Kx.get(this);return tn(0,t.items.length-1,(o=>{const n=e[t.items[o].key];null!==n&&void 0!==n&&(t.items[o].callback=n)})),t}}var qx=Xx;class Qx{constructor(t){this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}onBeforeRowMove(t,e,o,n){const s=this.displayAPICompatibilityWarning({rows:t,finalIndex:e,dropIndex:o,movePossible:n});if(s)return!1;this.movedToCollapsed=!1;const i=o===this.hot.countRows(),r=i?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(o);let l=!0;const a=t.map((t=>{if(!l)return!1;const e=this.dataManager.translateTrimmedRow(t);return l=this.shouldAllowMoving(e,r),e})),h=-1===a.indexOf(r);if(!l||!h)return!1;const c=this.getBaseParent(a),d=this.getTargetParent(i,r),u=c===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(a,r,u),this.moveRows(a,r,d),this.dataManager.rewriteCache(),this.moveCellsMeta(a,r),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",t,e,o,n,n&&this.isRowOrderChanged(t,e)),this.hot.render(),this.selectCells(t,o),!1}displayAPICompatibilityWarning(t){const{rows:e,finalIndex:o,dropIndex:n,movePossible:s}=t;let i=!1;return $(n)&&(mo(j`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",e,o,n,s,!1),i=!0),i}shouldAllowMoving(t,e){return!(this.dataManager.isParent(t)||this.dataManager.isRowHighestLevel(t)||t===e||0===e)}getBaseParent(t){return this.dataManager.getRowParent(t[0])}getTargetParent(t,e){let o=this.dataManager.getRowParent(t?e-1:e);return null!==o&&void 0!==o||(o=this.dataManager.getRowParent(e-1)),o}shiftCollapsibleParentsLocations(t,e,o){o||(Math.max(...t)<=e?this.collapsingUI.collapsedRowsStash.shiftStash(t[0],e,-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(e,t[0],t.length))}moveRows(t,e,o){const n=e===this.dataManager.getRowIndex(o)+this.dataManager.countChildren(o)+1;this.hot.batchRender((()=>{t.forEach((t=>{this.dataManager.moveRow(t,e,this.movedToCollapsed,n)}))}))}moveCellsMeta(t,e){const o=[],n=Math.max(...t)<e;t.forEach((t=>{o.push(this.hot.getCellMetaAtRow(t))})),this.hot.spliceCellsMeta(t[0],t.length),this.hot.spliceCellsMeta(e-(n?o.length:0),0,...o)}selectCells(t,e){const o=t.length;let n=0,s=0,i=null,r=null;if(this.movedToCollapsed){let i=null;i=t[o-1]<e?this.dataManager.translateTrimmedRow(e-o):this.dataManager.translateTrimmedRow(e);const r=this.dataManager.getRowParent(null===i?this.hot.countSourceRows()-1:i-1),l=this.dataManager.getRowIndex(r);n=this.dataManager.untranslateTrimmedRow(l),s=n}else t[o-1]<e?(s=e-1,n=s-o+1):(n=e,s=n+o-1);i=this.hot.selection,r=this.hot.countCols()-1,i.setRangeStart(this.hot._createCellCoords(n,0)),i.setRangeEnd(this.hot._createCellCoords(s,r),!0)}isRowOrderChanged(t,e){return t.some(((t,o)=>t-o!==e))}}const Jx="nestedRows",Zx=300,tI=new WeakMap,eI="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";class oI extends hf{static get PLUGIN_KEY(){return Jx}static get PLUGIN_PRIORITY(){return Zx}constructor(t){super(t),this.dataManager=null,this.headersUI=null,this.collapsedRowsMap=null,tI.set(this,{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1})}isEnabled(){return!!this.hot.getSettings()[Jx]}enablePlugin(){var t=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Tl),this.dataManager=new Wx(this,this.hot),this.collapsingUI=new Yx(this,this.hot),this.headersUI=new $x(this,this.hot),this.contextMenuUI=new qx(this,this.hot),this.rowMoveController=new Qx(this),this.addHook("afterInit",(function(){return t.onAfterInit(...arguments)})),this.addHook("beforeViewRender",(function(){return t.onBeforeViewRender(...arguments)})),this.addHook("modifyRowData",(function(){return t.onModifyRowData(...arguments)})),this.addHook("modifySourceLength",(function(){return t.onModifySourceLength(...arguments)})),this.addHook("beforeDataSplice",(function(){return t.onBeforeDataSplice(...arguments)})),this.addHook("filterData",(function(){return t.onFilterData(...arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return t.onAfterContextMenuDefaultOptions(...arguments)})),this.addHook("afterGetRowHeader",(function(){return t.onAfterGetRowHeader(...arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown(...arguments)})),this.addHook("beforeRemoveRow",(function(){return t.onBeforeRemoveRow(...arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow(...arguments)})),this.addHook("beforeAddChild",(function(){return t.onBeforeAddChild(...arguments)})),this.addHook("afterAddChild",(function(){return t.onAfterAddChild(...arguments)})),this.addHook("beforeDetachChild",(function(){return t.onBeforeDetachChild(...arguments)})),this.addHook("afterDetachChild",(function(){return t.onAfterDetachChild(...arguments)})),this.addHook("modifyRowHeaderWidth",(function(){return t.onModifyRowHeaderWidth(...arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow(...arguments)})),this.addHook("beforeRowMove",(function(){return t.onBeforeRowMove(...arguments)})),this.addHook("beforeLoadData",(t=>this.onBeforeLoadData(t))),this.addHook("beforeUpdateData",(t=>this.onBeforeLoadData(t))),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),super.disablePlugin()}updatePlugin(){this.disablePlugin();const t=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(t),super.updatePlugin()}onBeforeRowMove(t,e,o,n){return this.rowMoveController.onBeforeRowMove(t,e,o,n)}disableCoreAPIModifiers(){const t=tI.get(this);t.skipCoreAPIModifiers=!0}enableCoreAPIModifiers(){const t=tI.get(this);t.skipCoreAPIModifiers=!1}onBeforeOnCellMouseDown(t,e,o){this.collapsingUI.toggleState(t,e,o)}onModifyRowData(t){const e=tI.get(this);if(!e.skipCoreAPIModifiers)return this.dataManager.getDataObject(t)}onModifySourceLength(){const t=tI.get(this);if(!t.skipCoreAPIModifiers)return this.dataManager.countAllRows()}onBeforeDataSplice(t,e,o){const n=tI.get(this);return!(!n.skipCoreAPIModifiers&&!this.dataManager.isRowHighestLevel(t))||(this.dataManager.spliceData(t,e,o),!1)}onFilterData(t,e,o){const n=tI.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(o[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(o[0],null,-1*e),this.dataManager.filterData(t,e,o),n.skipRender=!0,this.dataManager.getData().slice()}onAfterContextMenuDefaultOptions(t){return this.contextMenuUI.appendOptions(t)}onAfterGetRowHeader(t,e){this.headersUI.appendLevelIndicators(t,e)}onModifyRowHeaderWidth(t){return this.headersUI.rowHeaderWidthCache||t}onAfterRemoveRow(t,e,o,n){if(n===this.pluginName)return;const s=tI.get(this);setTimeout((()=>{s.skipRender=null,this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()}),0)}onBeforeRemoveRow(t,e,o){const n=Array.from(o.reduce(((t,e)=>{if(this.dataManager.isParent(e)){const o=this.dataManager.getDataObject(e).__children;return t.add(e),Array.isArray(o)&&o.forEach((e=>t.add(this.dataManager.getRowIndex(e)))),t}return t.add(e)}),new Set));o.length=0,o.push(...n)}onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterAddChild(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterDetachChild(t,e,o){this.collapsingUI.collapsedRowsStash.shiftStash(o,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onAfterCreateRow(){this.dataManager.rewriteCache()}onAfterInit(){const t=Math.max(...this.dataManager.cache.levels);t>0&&this.headersUI.updateRowHeaderWidth(t)}onBeforeViewRender(t,e){const o=tI.get(this);o.skipRender&&(e.skipRender=!0)}destroy(){super.destroy()}onBeforeLoadData(t){if(!rl(t))return fo(eI),this.hot.getSettings()[Jx]=!1,void this.disablePlugin();this.dataManager.setData(t),this.dataManager.rewriteCache()}}class nI{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;this.rootWindow=e,this.prefix=t,this.savedKeys=[],this.loadSavedKeys()}saveValue(t,e){this.rootWindow.localStorage.setItem(`${this.prefix}_${t}`,JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}loadValue(t,e){const o="undefined"===typeof t?e:t,n=this.rootWindow.localStorage.getItem(`${this.prefix}_${o}`);return null===n?void 0:JSON.parse(n)}reset(t){this.rootWindow.localStorage.removeItem(`${this.prefix}_${t}`)}resetAll(){O(this.savedKeys,((t,e)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[e]}`)})),this.clearSavedKeys()}loadSavedKeys(){const t=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),e="string"===typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}var sI=nI;Ro.getSingleton().register("persistentStateSave"),Ro.getSingleton().register("persistentStateLoad"),Ro.getSingleton().register("persistentStateReset");const iI="persistentState",rI=0;class lI extends hf{static get PLUGIN_KEY(){return iI}static get PLUGIN_PRIORITY(){return rI}constructor(t){super(t),this.storage=void 0}isEnabled(){return!!this.hot.getSettings()[iI]}enablePlugin(){this.enabled||(this.storage||(this.storage=new sI(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",((t,e)=>this.saveValue(t,e))),this.addHook("persistentStateLoad",((t,e)=>this.loadValue(t,e))),this.addHook("persistentStateReset",(()=>this.resetValue())),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(t,e){e.value=this.storage.loadValue(t)}saveValue(t,e){this.storage.saveValue(t,e)}resetValue(t){"undefined"===typeof t?this.storage.resetAll():this.storage.reset(t)}destroy(){super.destroy()}}const aI="search",hI=190,cI="htSearchResult",dI=function(t,e,o,n,s){t.getCellMeta(e,o).isSearchResult=s},uI=function(t,e,o){return!($(t)||null===t||!t.toLocaleLowerCase||0===t.length)&&(!$(e)&&null!==e&&-1!==e.toString().toLocaleLowerCase(o.locale).indexOf(t.toLocaleLowerCase(o.locale)))};class gI extends hf{static get PLUGIN_KEY(){return aI}static get PLUGIN_PRIORITY(){return hI}constructor(t){super(t),this.callback=dI,this.queryMethod=uI,this.searchResultClass=cI}isEnabled(){return this.hot.getSettings()[aI]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[aI];this.updatePluginSettings(e),this.addHook("beforeRenderer",(function(){return t.onBeforeRenderer(...arguments)})),super.enablePlugin()}disablePlugin(){var t=this;const e=function(){return t.onBeforeRenderer(...arguments)};this.hot.addHook("beforeRenderer",e),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("beforeRenderer",e)})),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const n=this.hot.countRows(),s=this.hot.countCols(),i=[],r=this.hot;return tn(0,n-1,(n=>{tn(0,s-1,(s=>{const l=this.hot.getDataAtCell(n,s),a=this.hot.getCellMeta(n,s),h=a.search.callback||e,c=a.search.queryMethod||o,d=c(t,l,a);if(d){const t={row:n,col:s,data:l};i.push(t)}h&&h(r,n,s,l,d)}))})),i}getCallback(){return this.callback}setCallback(t){this.callback=t}getQueryMethod(){return this.queryMethod}setQueryMethod(t){this.queryMethod=t}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(t){this.searchResultClass=t}updatePluginSettings(t){Ae(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}onBeforeRenderer(t,e,o,n,s,i){const r=i.className||[];let l=[];"string"===typeof r?l=r.split(" "):l.push(...r),this.isEnabled()&&i.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),i.className=l.join(" ")}destroy(){super.destroy()}}const mI="touchScroll",fI=200;class pI extends hf{static get PLUGIN_KEY(){return mI}static get PLUGIN_PRIORITY(){return fI}static get SETTING_KEYS(){return!0}constructor(t){super(t),this.scrollbars=[],this.clones=[],this.lockedCollection=!1,this.freezeOverlays=!1}isEnabled(){return jn()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",(()=>this.onAfterViewRender())),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",(()=>this.onBeforeTouchScroll())),this.addHook("afterMomentumScroll",(()=>this.onAfterMomentumScroll()))}onAfterViewRender(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:o,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(o),n&&this.scrollbars.push(n),s&&s.clone&&this.scrollbars.push(s),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),n&&this.clones.push(n.clone.wtTable.holder.parentNode),s&&s.clone&&this.clones.push(s.clone.wtTable.holder.parentNode)}onBeforeTouchScroll(){this.freezeOverlays=!0,O(this.clones,(t=>{Mt(t,"hide-tween")}))}onAfterMomentumScroll(){this.freezeOverlays=!1,O(this.clones,(t=>{Tt(t,"hide-tween"),Mt(t,"show-tween")})),this.hot._registerTimeout((()=>{O(this.clones,(t=>{Tt(t,"show-tween")}))}),400),O(this.scrollbars,(t=>{t.refresh(),t.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}const wI="trimRows",CI=330;class yI extends hf{static get PLUGIN_KEY(){return wI}static get PLUGIN_PRIORITY(){return CI}constructor(t){super(t),this.trimmedRowsMap=null}isEnabled(){return!!this.hot.getSettings()[wI]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Tl),this.trimmedRowsMap.addLocalHook("init",(()=>this.onMapInit())),super.enablePlugin())}updatePlugin(){const t=this.hot.getSettings()[wI];Array.isArray(t)&&this.hot.batchExecution((()=>{this.trimmedRowsMap.clear(),O(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(t){const e=this.getTrimmedRows(),o=this.isValidConfig(t);let n=e;o&&(n=Array.from(new Set(e.concat(t))));const s=this.hot.runHooks("beforeTrimRow",e,n,o);!1!==s&&(o&&this.hot.batchExecution((()=>{O(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),this.hot.runHooks("afterTrimRow",e,n,o,o&&n.length>e.length))}trimRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.trimRows(e)}untrimRows(t){const e=this.getTrimmedRows(),o=this.isValidConfig(t);let n=e;const s=this.trimmedRowsMap.getValues().slice(),i=t.length>0;o&&i&&(O(t,(t=>{s[t]=!1})),n=I(s,((t,e,o)=>(e&&t.push(o),t)),[]));const r=this.hot.runHooks("beforeUntrimRow",e,n,o&&i);!1!==r&&(o&&i&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",e,n,o&&i,o&&n.length<e.length))}untrimRow(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];this.untrimRows(e)}isTrimmed(t){return this.trimmedRowsMap.getValueAtIndex(t)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(t){const e=this.hot.countSourceRows();return t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}onMapInit(){const t=this.hot.getSettings()[wI];Array.isArray(t)&&this.hot.batchExecution((()=>{O(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0)}destroy(){super.destroy()}}const vI="undoRedo",bI="undoRedo";function SI(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",(function(o,n){const s=o&&o.length;if(!s)return;const i=o.find((t=>{const[,,e,o]=t;return e!==o}));if(!i)return;const r=()=>{const e=o.reduce(((t,e)=>(t.push([...e]),t)),[]);O(e,(e=>{e[1]=t.propToCol(e[1])}));const n=s>1?this.getSelected():[[e[0][0],e[0][1]]];return new SI.ChangeAction(e,n)};e.done(r,n)})),t.addHook("afterCreateRow",((t,o,n)=>{e.done((()=>new SI.CreateRowAction(t,o)),n)})),t.addHook("beforeRemoveRow",((o,n,s,i)=>{const r=()=>{const s=t.toPhysicalRow(o),i=Te(e.instance.getSourceData(s,0,s+n-1,e.instance.countSourceCols()-1));return new SI.RemoveRowAction(s,i,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(r,i)})),t.addHook("afterCreateCol",((t,o,n)=>{e.done((()=>new SI.CreateColumnAction(t,o)),n)})),t.addHook("beforeRemoveCol",((o,n,s,i)=>{const r=()=>{const s=e.instance.getSourceDataArray(),i=(e.instance.countCols()+o)%e.instance.countCols(),r=[],l=[],a=[];tn(s.length-1,(e=>{const o=[],l=s[e];tn(i,i+(n-1),(e=>{o.push(l[t.toPhysicalColumn(e)])})),r.push(o)})),tn(n-1,(e=>{a.push(t.toPhysicalColumn(i+e))})),Array.isArray(t.getSettings().colHeaders)&&tn(n-1,(e=>{l.push(t.getSettings().colHeaders[t.toPhysicalColumn(i+e)]||null)}));const h=t.columnIndexMapper.getIndexesSequence(),c=t.rowIndexMapper.getIndexesSequence();return new SI.RemoveColumnAction(i,a,r,l,h,c,t.getSettings().fixedColumnsStart)};e.done(r,i)})),t.addHook("beforeCellAlignment",((t,o,n,s)=>{e.done((()=>new SI.CellAlignmentAction(t,o,n,s)))})),t.addHook("beforeFilter",(t=>{e.done((()=>new SI.FiltersAction(t)))})),t.addHook("beforeRowMove",((t,o)=>{!1!==t&&e.done((()=>new SI.RowMoveAction(t,o)))})),t.addHook("beforeMergeCells",((o,n)=>{n||e.done((()=>new SI.MergeCellsAction(t,o)))})),t.addHook("afterUnmergeCells",((o,n)=>{n||e.done((()=>new SI.UnmergeCellsAction(t,o)))})),t.addHook("afterInit",(()=>{e.init()}))}SI.prototype.done=function(t,e){if(this.ignoreNewActions)return;const o="UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e;if(o)return;const n=this.doneActions.slice(),s=this.instance.runHooks("beforeUndoStackChange",n,e);if(!1===s)return;const i=t(),r=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",r),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice())},SI.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const o=Te(e),n=this.instance.runHooks("beforeUndo",o);if(!1===n)return;this.ignoreNewActions=!0;const s=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),e.undo(this.instance,(()=>{s.ignoreNewActions=!1,s.undoneActions.push(e)})),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",o)}},SI.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const o=Te(e),n=this.instance.runHooks("beforeRedo",o);if(!1===n)return;this.ignoreNewActions=!0;const s=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),e.redo(this.instance,(()=>{s.ignoreNewActions=!1,s.doneActions.push(e)})),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",o)}},SI.prototype.isUndoAvailable=function(){return this.doneActions.length>0},SI.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},SI.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},SI.prototype.isEnabled=function(){return this.enabled},SI.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,TI(t),this.registerShortcuts(),t.addHook("afterChange",MI)},SI.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,xI(t),this.unregisterShortcuts(),t.removeHook("afterChange",MI)},SI.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},SI.Action=function(){},SI.Action.prototype.undo=function(){},SI.Action.prototype.redo=function(){},SI.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"},Re(SI.ChangeAction,SI.Action),SI.ChangeAction.prototype.undo=function(t,e){const o=Te(this.changes),n=t.countEmptyRows(!0),s=t.countEmptyCols(!0);for(let i=0,r=o.length;i<r;i++)o[i].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(o,null,null,"UndoRedo.undo");for(let i=0,r=o.length;i<r;i++){const[e,r]=o[i];t.getSettings().minSpareRows&&e+1+t.getSettings().minSpareRows===t.countRows()&&n===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(e+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&r+1+t.getSettings().minSpareCols===t.countCols()&&s===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(r+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)},SI.ChangeAction.prototype.redo=function(t,e){const o=Te(this.changes);for(let n=0,s=o.length;n<s;n++)o[n].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(o,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)},SI.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},Re(SI.CreateRowAction,SI.Action),SI.CreateRowAction.prototype.undo=function(t,e){const o=t.countRows(),n=t.getSettings().minSpareRows;this.index>=o&&this.index-n<o&&(this.index-=n),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},SI.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},SI.RemoveRowAction=function(t,e,o,n,s){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=o,this.fixedRowsTop=n,this.rowIndexesSequence=s},Re(SI.RemoveRowAction,SI.Action),SI.RemoveRowAction.prototype.undo=function(t,e){const o=t.getSettings(),n=[];o.fixedRowsBottom=this.fixedRowsBottom,o.fixedRowsTop=this.fixedRowsTop,this.data.forEach(((t,e)=>{Object.keys(t).forEach((o=>{const s=parseInt(o,10);n.push([this.index+e,isNaN(s)?o:s,t[o]])}))})),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(n,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},SI.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},SI.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},Re(SI.CreateColumnAction,SI.Action),SI.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},SI.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},SI.RemoveColumnAction=function(t,e,o,n,s,i,r){this.index=t,this.indexes=e,this.data=o,this.amount=this.data[0].length,this.headers=n,this.columnPositions=s.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=r},Re(SI.RemoveColumnAction,SI.Action),SI.RemoveColumnAction.prototype.undo=function(t,e){const o=t.getSettings();o.fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),s=(t,e,o)=>o[this.indexes.indexOf(n[e])],i=this.data.length,r=[];for(let h=0;h<i;h++)r.push(A(this.data[h],s));const l=A(this.headers,s),a=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),O(t.getSourceDataArray(),((t,e)=>{O(n,((o,n)=>{t[o]=r[e][n],a.push([e,o,t[o]])}))})),t.setSourceDataAtCell(a,void 0,void 0,"UndoRedo.undo"),"undefined"!==typeof this.headers&&O(l,((e,o)=>{t.getSettings().colHeaders[n[o]]=e})),t.batchExecution((()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)}),!0),t.addHookOnce("afterViewRender",e),t.render()},SI.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},SI.CellAlignmentAction=function(t,e,o,n){this.stateBefore=t,this.range=e,this.type=o,this.alignment=n},SI.CellAlignmentAction.prototype.undo=function(t,e){O(this.range,(e=>{e.forAll(((e,o)=>{e>=0&&o>=0&&t.setCellMeta(e,o,"className",this.stateBefore[e][o]||" htLeft")}))})),t.addHookOnce("afterViewRender",e),t.render()},SI.CellAlignmentAction.prototype.redo=function(t,e){Sw(this.range,this.type,this.alignment,((e,o)=>t.getCellMeta(e,o)),((e,o,n,s)=>t.setCellMeta(e,o,n,s))),t.addHookOnce("afterViewRender",e),t.render()},SI.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},Re(SI.FiltersAction,SI.Action),SI.FiltersAction.prototype.undo=function(t,e){const o=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),o.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),o.filter()},SI.FiltersAction.prototype.redo=function(t,e){const o=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),o.conditionCollection.importAllConditions(this.conditionsStack),o.filter()};class RI extends SI.Action{constructor(t,e){super(),this.cellRange=e;const o=this.cellRange.getTopStartCorner(),n=this.cellRange.getBottomEndCorner();this.rangeData=t.getData(o.row,o.col,n.row,n.col)}undo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.unmergeRange(this.cellRange,!0);const n=this.cellRange.getTopStartCorner();t.populateFromArray(n.row,n.col,this.rangeData,void 0,void 0,"MergeCells")}redo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.mergeRange(this.cellRange)}}SI.MergeCellsAction=RI;class EI extends SI.Action{constructor(t,e){super(),this.cellRange=e}undo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.mergeRange(this.cellRange,!0)}redo(t,e){const o=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),o.unmergeRange(this.cellRange,!0),t.render()}}function MI(t,e){const o=this;if("loadData"===e)return o.undoRedo.clear()}function TI(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function xI(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}SI.UnmergeCellsAction=EI,SI.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"},Re(SI.RowMoveAction,SI.Action),SI.RowMoveAction.prototype.undo=function(t,e){const o=t.getPlugin("manualRowMove"),n=[].concat(this.rows),s=n.filter((t=>t>this.finalIndex)),i=n.filter((t=>t<=this.finalIndex)),r=s.sort(((t,e)=>e-t)).concat(i.sort(((t,e)=>t-e)));t.addHookOnce("afterViewRender",e);for(let l=0;l<r.length;l+=1){const e=t.toVisualRow(r[l]);o.moveRow(e,r[l])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},SI.RowMoveAction.prototype.redo=function(t,e){const o=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),o.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},SI.prototype.init=function(){const t=this.instance.getSettings().undo,e="undefined"===typeof t||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},SI.prototype.registerShortcuts=function(){const t=this.instance.getShortcutManager(),e=t.getContext("grid"),o=t=>!t.altKey,n={runOnlyIf:o,group:vI};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],n)},SI.prototype.unregisterShortcuts=function(){const t=this.instance.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(vI)};const II=Ro.getSingleton();II.add("afterUpdateSettings",(function(){var t;null===(t=this.getPlugin("undoRedo"))||void 0===t||t.init()})),II.register("beforeUndo"),II.register("afterUndo"),II.register("beforeRedo"),II.register("afterRedo"),SI.PLUGIN_KEY=bI,SI.SETTING_KEYS=!0;var HI,AI,OI,kI,NI,PI=SI;function _I(){Rn(yf),Rn(If),Rn(kf),Rn(Yf),Rn(cp),Rn(ow),Rn(aw),Rn(jw),Rn(OC),Rn(By),Rn(dv),Rn(mv),Rn(Cv),Rn(Nv),Rn(FS),Rn(aE),Rn(SE),Rn(DE),Rn(jE),Rn(aM),Rn(gM),Rn(NM),Rn(VM),Rn(ZM),Rn(hT),Rn(uT),Rn(Bx),Rn(oI),Rn(lI),Rn(gI),Rn(pI),Rn(yI),Rn(PI)}function DI(){Xg(),Sm(),_m(),Jm(),_I()}function LI(t){const e="undefined"!==typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){const o=this.first();let n,s=o.data("handsontable");if("string"!==typeof e){const n=e||{};return s?s.updateSettings(n):(s=new t.Core(o[0],n),o.data("handsontable",s),s.init()),o}if(s){if("undefined"===typeof s[e])throw new Error(`Handsontable do not provide action: ${e}`);for(var i=arguments.length,r=new Array(i>1?i-1:0),l=1;l<i;l++)r[l-1]=arguments[l];n=s[e].call(s,...r),"destroy"===e&&o.removeData()}return n})}DI(),LI(hu),hu.__GhostTable=uf,hu._getListenersCounter=Fo,hu._getRegisteredMapsCounter=Ol,hu.EventManager=Bo;const VI=[n,h,f,w,m,l,s,g,a,i,c,u],BI=[r,d];hu.helper={},hu.dom={},O(VI,(t=>{O(Object.getOwnPropertyNames(t),(e=>{"_"!==e.charAt(0)&&(hu.helper[e]=t[e])}))})),O(BI,(t=>{O(Object.getOwnPropertyNames(t),(e=>{"_"!==e.charAt(0)&&(hu.dom[e]=t[e])}))})),hu.cellTypes=null!==(HI=hu.cellTypes)&&void 0!==HI?HI:{},O(td(),(t=>{hu.cellTypes[t]=od(t)})),hu.cellTypes.registerCellType=nd,hu.cellTypes.getCellType=od,hu.editors=null!==(AI=hu.editors)&&void 0!==AI?AI:{},O(Ao(),(t=>{hu.editors[`${lt(t)}Editor`]=Po(t)})),hu.editors.registerEditor=_o,hu.editors.getEditor=Po,hu.renderers=null!==(OI=hu.renderers)&&void 0!==OI?OI:{},O(Hn(),(t=>{const e=On(t);"base"===t&&(hu.renderers.cellDecorator=e),hu.renderers[`${lt(t)}Renderer`]=e})),hu.renderers.registerRenderer=kn,hu.renderers.getRenderer=On,hu.validators=null!==(kI=hu.validators)&&void 0!==kI?kI:{},O(Dn(),(t=>{hu.validators[`${lt(t)}Validator`]=Vn(t)})),hu.validators.registerValidator=Bn,hu.validators.getValidator=Vn,hu.plugins=null!==(NI=hu.plugins)&&void 0!==NI?NI:{},O(vn(),(t=>{hu.plugins[t]=bn(t)})),hu.plugins[`${lt(hf.PLUGIN_KEY)}Plugin`]=hf,hu.plugins.registerPlugin=Rn,hu.plugins.getPlugin=bn;var FI=hu,WI=function(t,e){var o=e.className;void 0!==o&&FI.dom.addClass(t,o)},jI=function(t,e,o,n,s,i,r){var l=document.createElement("div");l.style.width="".concat(10*i,"px"),WI(e,r),FI.dom.addClass(l,"progressBar"),FI.dom.empty(e),e.appendChild(l)},UI=function(t,e,o,n,s,i,r){FI.renderers.TextRenderer.apply(this,[t,e,o,n,s,"★".repeat(i),r])},zI=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]),$I=function(t,e,o,n,s,i){if(0===o){var r=t.parentElement;null!==r&&(i.instance.getDataAtRowProp(e,"0")?FI.dom.addClass(r,yg):FI.dom.removeClass(r,yg),e%2===0?FI.dom.addClass(r,vg):FI.dom.removeClass(r,vg))}},GI=function(t,e){var o=document.createElement("input");o.type="checkbox",t>=0&&this.getDataAtRowProp(t,"0")&&(o.checked=!0),FI.dom.empty(e),e.appendChild(o)};function YI(t,e){if(!(t<0)){var o=this.isRtl()?"htRight":"htLeft";e.firstChild&&(zI.has(t.toString())?(FI.dom.removeClass(e.firstChild,o),FI.dom.addClass(e.firstChild,zI.get(t.toString()))):FI.dom.addClass(e.firstChild,o))}}var KI=function(t,e){var o=t.target;-1===e.col&&t.target&&"INPUT"===o.nodeName&&(t.preventDefault(),this.setDataAtRowProp(e.row,"0",!o.checked))},XI={name:"DataGrid",data:function(){return{hotSettings:{height:450,dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,afterOnCellMouseDown:KI,afterGetColHeader:YI,afterGetRowHeader:GI,beforeRenderer:$I,colWidths:[140,192,100,90,90,110,97,100,126],colHeaders:["Company name","Name","Sell date","In stock","Qty","Progress","Rating","Order ID","Country"],columns:[{data:1,type:"text"},{data:3,type:"text"},{data:4,type:"date",allowInvalid:!1},{data:6,type:"checkbox",className:"htCenter"},{data:7,type:"numeric"},{data:8,renderer:jI,readOnly:!0,className:"htMiddle"},{data:9,renderer:UI,readOnly:!0,className:"star htCenter"},{data:5,type:"text"},{data:2,type:"text"}],licenseKey:"non-commercial-and-evaluation"},data:bg()}},components:{HotTable:Qu}},qI=XI,QI=o(9917),JI=(0,QI.Z)(qI,b,S,!1,null,null,null),ZI=JI.exports,tH={name:"App",components:{DataGrid:ZI}},eH=tH,oH=(0,QI.Z)(eH,y,v,!1,null,null,null),nH=oH.exports;console.log("Handsontable: v".concat(FI.version," (").concat(FI.buildDate,") Wrapper: v").concat(Qu.version," Vue: v").concat(C.ZP.version)),C.ZP.config.silent=!0,new C.ZP({render:function(t){return t(nH)}}).$mount("#app")},5131:function(t,e,o){var n={"./af":4466,"./af.js":4466,"./ar":9252,"./ar-dz":6520,"./ar-dz.js":6520,"./ar-kw":2358,"./ar-kw.js":2358,"./ar-ly":3229,"./ar-ly.js":3229,"./ar-ma":1707,"./ar-ma.js":1707,"./ar-sa":3237,"./ar-sa.js":3237,"./ar-tn":8206,"./ar-tn.js":8206,"./ar.js":9252,"./az":9665,"./az.js":9665,"./be":2888,"./be.js":2888,"./bg":5945,"./bg.js":5945,"./bm":6375,"./bm.js":6375,"./bn":758,"./bn-bd":533,"./bn-bd.js":533,"./bn.js":758,"./bo":5502,"./bo.js":5502,"./br":70,"./br.js":70,"./bs":295,"./bs.js":295,"./ca":6647,"./ca.js":6647,"./cs":4343,"./cs.js":4343,"./cv":9886,"./cv.js":9886,"./cy":2985,"./cy.js":2985,"./da":139,"./da.js":139,"./de":472,"./de-at":994,"./de-at.js":994,"./de-ch":4824,"./de-ch.js":4824,"./de.js":472,"./dv":9271,"./dv.js":9271,"./el":5195,"./el.js":5195,"./en-au":8847,"./en-au.js":8847,"./en-ca":1348,"./en-ca.js":1348,"./en-gb":9053,"./en-gb.js":9053,"./en-ie":1853,"./en-ie.js":1853,"./en-il":4135,"./en-il.js":4135,"./en-in":7122,"./en-in.js":7122,"./en-nz":3011,"./en-nz.js":3011,"./en-sg":6714,"./en-sg.js":6714,"./eo":197,"./eo.js":197,"./es":4293,"./es-do":8029,"./es-do.js":8029,"./es-mx":1154,"./es-mx.js":1154,"./es-us":8357,"./es-us.js":8357,"./es.js":4293,"./et":6720,"./et.js":6720,"./eu":5808,"./eu.js":5808,"./fa":4924,"./fa.js":4924,"./fi":5949,"./fi.js":5949,"./fil":6108,"./fil.js":6108,"./fo":2687,"./fo.js":2687,"./fr":6724,"./fr-ca":9466,"./fr-ca.js":9466,"./fr-ch":867,"./fr-ch.js":867,"./fr.js":6724,"./fy":9550,"./fy.js":9550,"./ga":4735,"./ga.js":4735,"./gd":9878,"./gd.js":9878,"./gl":9787,"./gl.js":9787,"./gom-deva":6492,"./gom-deva.js":6492,"./gom-latn":5339,"./gom-latn.js":5339,"./gu":836,"./gu.js":836,"./he":9315,"./he.js":9315,"./hi":3724,"./hi.js":3724,"./hr":3730,"./hr.js":3730,"./hu":7657,"./hu.js":7657,"./hy-am":1918,"./hy-am.js":1918,"./id":2215,"./id.js":2215,"./is":4095,"./is.js":4095,"./it":2446,"./it-ch":1947,"./it-ch.js":1947,"./it.js":2446,"./ja":9545,"./ja.js":9545,"./jv":1437,"./jv.js":1437,"./ka":1330,"./ka.js":1330,"./kk":8900,"./kk.js":8900,"./km":5620,"./km.js":5620,"./kn":7081,"./kn.js":7081,"./ko":8130,"./ko.js":8130,"./ku":5295,"./ku.js":5295,"./ky":8578,"./ky.js":8578,"./lb":8773,"./lb.js":8773,"./lo":6366,"./lo.js":6366,"./lt":2532,"./lt.js":2532,"./lv":3902,"./lv.js":3902,"./me":3636,"./me.js":3636,"./mi":4059,"./mi.js":4059,"./mk":6005,"./mk.js":6005,"./ml":2982,"./ml.js":2982,"./mn":5543,"./mn.js":5543,"./mr":4898,"./mr.js":4898,"./ms":4145,"./ms-my":8766,"./ms-my.js":8766,"./ms.js":4145,"./mt":4780,"./mt.js":4780,"./my":3445,"./my.js":3445,"./nb":4372,"./nb.js":4372,"./ne":2862,"./ne.js":2862,"./nl":2254,"./nl-be":3293,"./nl-be.js":3293,"./nl.js":2254,"./nn":6986,"./nn.js":6986,"./oc-lnc":6623,"./oc-lnc.js":6623,"./pa-in":3802,"./pa-in.js":3802,"./pl":2560,"./pl.js":2560,"./pt":6467,"./pt-br":3595,"./pt-br.js":3595,"./pt.js":6467,"./ro":5092,"./ro.js":5092,"./ru":2238,"./ru.js":2238,"./sd":5555,"./sd.js":5555,"./se":7291,"./se.js":7291,"./si":3013,"./si.js":3013,"./sk":7005,"./sk.js":7005,"./sl":284,"./sl.js":284,"./sq":7274,"./sq.js":7274,"./sr":1344,"./sr-cyrl":1521,"./sr-cyrl.js":1521,"./sr.js":1344,"./ss":9573,"./ss.js":9573,"./sv":8865,"./sv.js":8865,"./sw":1769,"./sw.js":1769,"./ta":1108,"./ta.js":1108,"./te":2002,"./te.js":2002,"./tet":3164,"./tet.js":3164,"./tg":6599,"./tg.js":6599,"./th":1806,"./th.js":1806,"./tk":2315,"./tk.js":2315,"./tl-ph":3296,"./tl-ph.js":3296,"./tlh":3102,"./tlh.js":3102,"./tr":5886,"./tr.js":5886,"./tzl":6963,"./tzl.js":6963,"./tzm":1203,"./tzm-latn":4676,"./tzm-latn.js":4676,"./tzm.js":1203,"./ug-cn":1444,"./ug-cn.js":1444,"./uk":2676,"./uk.js":2676,"./ur":5026,"./ur.js":5026,"./uz":9895,"./uz-latn":1873,"./uz-latn.js":1873,"./uz.js":9895,"./vi":5646,"./vi.js":5646,"./x-pseudo":7377,"./x-pseudo.js":7377,"./yo":9632,"./yo.js":9632,"./zh-cn":5665,"./zh-cn.js":5665,"./zh-hk":627,"./zh-hk.js":627,"./zh-mo":7922,"./zh-mo.js":7922,"./zh-tw":8973,"./zh-tw.js":8973};function s(t){var e=i(t);return o(e)}function i(t){if(!o.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}s.keys=function(){return Object.keys(n)},s.resolve=i,t.exports=s,s.id=5131}},e={};function o(n){var s=e[n];if(void 0!==s)return s.exports;var i=e[n]={id:n,loaded:!1,exports:{}};return t[n].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}o.m=t,function(){var t=[];o.O=function(e,n,s,i){if(!n){var r=1/0;for(c=0;c<t.length;c++){n=t[c][0],s=t[c][1],i=t[c][2];for(var l=!0,a=0;a<n.length;a++)(!1&i||r>=i)&&Object.keys(o.O).every((function(t){return o.O[t](n[a])}))?n.splice(a--,1):(l=!1,i<r&&(r=i));if(l){t.splice(c--,1);var h=s();void 0!==h&&(e=h)}}return e}i=i||0;for(var c=t.length;c>0&&t[c-1][2]>i;c--)t[c]=t[c-1];t[c]=[n,s,i]}}(),function(){o.d=function(t,e){for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){o.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={143:0};o.O.j=function(e){return 0===t[e]};var e=function(e,n){var s,i,r=n[0],l=n[1],a=n[2],h=0;if(r.some((function(e){return 0!==t[e]}))){for(s in l)o.o(l,s)&&(o.m[s]=l[s]);if(a)var c=a(o)}for(e&&e(n);h<r.length;h++)i=r[h],o.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return o.O(c)},n=self["webpackChunkvue_template"]=self["webpackChunkvue_template"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(1093)}));n=o.O(n)})();
//# sourceMappingURL=app.529bd059.js.map