(function(){var t={1093:function(t,e,n){"use strict";var r={};n.r(r),n.d(r,{cancelAnimationFrame:function(){return A},getComparisonFunction:function(){return H},hasCaptionProblem:function(){return _},isClassListSupported:function(){return T},isGetComputedStyleSupported:function(){return M},isPassiveEventSupported:function(){return N},isTextContentSupported:function(){return j},isTouchSupported:function(){return I},requestAnimationFrame:function(){return P}});var o={};n.r(o),n.d(o,{arrayAvg:function(){return K},arrayEach:function(){return U},arrayFilter:function(){return F},arrayFlatten:function(){return X},arrayMap:function(){return W},arrayMax:function(){return G},arrayMin:function(){return Y},arrayReduce:function(){return V},arraySum:function(){return z},arrayUnique:function(){return $},extendArray:function(){return L},getDifferenceOfArrays:function(){return q},getIntersectionOfArrays:function(){return Q},getUnionOfArrays:function(){return J},pivot:function(){return B},stringToArray:function(){return Z},to2dArray:function(){return D}});var i={};n.r(i),n.d(i,{clone:function(){return ut},createObjectPropListener:function(){return gt},deepClone:function(){return st},deepExtend:function(){return lt},deepObjectSize:function(){return mt},defineGetter:function(){return dt},duckSchema:function(){return ot},extend:function(){return at},getProperty:function(){return yt},hasOwnProperty:function(){return bt},inherit:function(){return it},isObject:function(){return ht},isObjectEqual:function(){return ft},mixin:function(){return ct},objectEach:function(){return pt},setProperty:function(){return vt}});var a={};n.r(a),n.d(a,{isChrome:function(){return Rt},isChromeWebKit:function(){return Et},isEdge:function(){return Mt},isEdgeWebKit:function(){return At},isFirefox:function(){return Pt},isFirefoxWebKit:function(){return Tt},isIE:function(){return It},isIE9:function(){return xt},isIOS:function(){return Nt},isIpadOS:function(){return Dt},isLinuxOS:function(){return Vt},isMSBrowser:function(){return _t},isMacOS:function(){return Bt},isMobileBrowser:function(){return Ht},isSafari:function(){return jt},isWindowsOS:function(){return Lt},setBrowserMeta:function(){return Ot},setPlatformMeta:function(){return kt}});var l={};n.r(l),n.d(l,{_injectProductInfo:function(){return me},isDefined:function(){return Zt},isEmpty:function(){return ee},isRegExp:function(){return ne},isUndefined:function(){return te},stringify:function(){return Jt}});var s={};n.r(s),n.d(s,{equalsIgnoreCase:function(){return we},isPercentValue:function(){return Ce},randomString:function(){return Se},sanitize:function(){return Re},stripTags:function(){return ke},substitute:function(){return Oe},toUpperCaseFirst:function(){return be}});var u={};n.r(u),n.d(u,{HTML_CHARACTERS:function(){return qe},addClass:function(){return Ge},addEvent:function(){return yn},clearTextSelection:function(){return wn},closest:function(){return Ne},closestDown:function(){return De},empty:function(){return Xe},fastInnerHTML:function(){return Qe},fastInnerText:function(){return Je},getCaretPosition:function(){return mn},getComputedStyle:function(){return cn},getCssTransform:function(){return Pn},getFrameElement:function(){return xe},getParent:function(){return Ie},getParentWindow:function(){return _e},getScrollLeft:function(){return on},getScrollTop:function(){return rn},getScrollableElement:function(){return an},getScrollbarWidth:function(){return On},getSelectionEndPosition:function(){return gn},getSelectionText:function(){return bn},getStyle:function(){return sn},getTrimmingContainer:function(){return ln},getWindowScrollLeft:function(){return nn},getWindowScrollTop:function(){return en},hasAccessToParentWindow:function(){return He},hasClass:function(){return ze},hasHorizontalScrollbar:function(){return Rn},hasVerticalScrollbar:function(){return kn},index:function(){return Be},innerHeight:function(){return dn},innerWidth:function(){return pn},isChildOf:function(){return Le},isDetached:function(){return In},isInput:function(){return jn},isOutsideInput:function(){return Mn},isVisible:function(){return Ze},matchesCSSRules:function(){return un},observeVisibilityChangeOnce:function(){return xn},offset:function(){return tn},outerHeight:function(){return hn},outerWidth:function(){return fn},overlayContainsElement:function(){return Ve},removeClass:function(){return Ye},removeEvent:function(){return vn},removeTextNodes:function(){return Ke},resetCssTransform:function(){return Tn},selectElementIfAllowed:function(){return An},setCaretPosition:function(){return Sn},setOverlayPosition:function(){return En}});var c={};n.r(c),n.d(c,{curry:function(){return Vn},curryRight:function(){return Fn},debounce:function(){return Dn},fastCall:function(){return Wn},isFunction:function(){return _n},partial:function(){return Bn},pipe:function(){return Ln},throttle:function(){return Hn},throttleAfterHits:function(){return Nn}});var f={};n.r(f),n.d(f,{KEY_CODES:function(){return zn},isCtrlKey:function(){return Xn},isCtrlMetaKey:function(){return $n},isFunctionKey:function(){return Kn},isKey:function(){return qn},isPrintableChar:function(){return Yn}});var h={};n.r(h),n.d(h,{isImmediatePropagationStopped:function(){return Jn},isLeftClick:function(){return tr},isRightClick:function(){return Zn},stopImmediatePropagation:function(){return Qn}});var d={};n.r(d),n.d(d,{_dataToHTML:function(){return ko},htmlToGridSettings:function(){return Ro},instanceToHTML:function(){return Oo}});var p={};n.r(p),n.d(p,{isNumeric:function(){return xo},isNumericLike:function(){return _o},rangeEach:function(){return Ho},rangeEachReverse:function(){return No},valueAccordingPercent:function(){return Do}});var y={};n.r(y),n.d(y,{countFirstRowKeys:function(){return Vv},createEmptySpreadsheetData:function(){return Lv},createSpreadsheetData:function(){return Nv},createSpreadsheetObjectData:function(){return Dv},dataRowToChangesArray:function(){return Bv},isArrayOfArrays:function(){return Fv},isArrayOfObjects:function(){return Wv},spreadsheetColumnIndex:function(){return Hv},spreadsheetColumnLabel:function(){return _v}});var v={};n.r(v),n.d(v,{CONTEXTMENU_ITEMS_ADD_COMMENT:function(){return Zw},CONTEXTMENU_ITEMS_ALIGNMENT:function(){return rS},CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:function(){return cS},CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:function(){return iS},CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:function(){return lS},CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:function(){return oS},CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:function(){return uS},CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:function(){return aS},CONTEXTMENU_ITEMS_ALIGNMENT_TOP:function(){return sS},CONTEXTMENU_ITEMS_BORDERS:function(){return fS},CONTEXTMENU_ITEMS_BORDERS_BOTTOM:function(){return pS},CONTEXTMENU_ITEMS_BORDERS_LEFT:function(){return yS},CONTEXTMENU_ITEMS_BORDERS_RIGHT:function(){return dS},CONTEXTMENU_ITEMS_BORDERS_TOP:function(){return hS},CONTEXTMENU_ITEMS_CLEAR_COLUMN:function(){return Uw},CONTEXTMENU_ITEMS_COPY:function(){return zw},CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:function(){return Kw},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:function(){return Yw},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:function(){return Gw},CONTEXTMENU_ITEMS_CUT:function(){return Xw},CONTEXTMENU_ITEMS_EDIT_COMMENT:function(){return tS},CONTEXTMENU_ITEMS_FREEZE_COLUMN:function(){return $w},CONTEXTMENU_ITEMS_HIDE_COLUMN:function(){return bS},CONTEXTMENU_ITEMS_HIDE_ROW:function(){return SS},CONTEXTMENU_ITEMS_INSERT_LEFT:function(){return Nw},CONTEXTMENU_ITEMS_INSERT_RIGHT:function(){return Dw},CONTEXTMENU_ITEMS_MERGE_CELLS:function(){return Qw},CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:function(){return gS},CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:function(){return mS},CONTEXTMENU_ITEMS_NO_ITEMS:function(){return xw},CONTEXTMENU_ITEMS_READ_ONLY:function(){return Ww},CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:function(){return nS},CONTEXTMENU_ITEMS_REDO:function(){return Fw},CONTEXTMENU_ITEMS_REMOVE_BORDERS:function(){return vS},CONTEXTMENU_ITEMS_REMOVE_COLUMN:function(){return Bw},CONTEXTMENU_ITEMS_REMOVE_COMMENT:function(){return eS},CONTEXTMENU_ITEMS_REMOVE_ROW:function(){return Lw},CONTEXTMENU_ITEMS_ROW_ABOVE:function(){return _w},CONTEXTMENU_ITEMS_ROW_BELOW:function(){return Hw},CONTEXTMENU_ITEMS_SHOW_COLUMN:function(){return wS},CONTEXTMENU_ITEMS_SHOW_ROW:function(){return CS},CONTEXTMENU_ITEMS_UNDO:function(){return Vw},CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:function(){return qw},CONTEXTMENU_ITEMS_UNMERGE_CELLS:function(){return Jw},CONTEXT_MENU_ITEMS_NAMESPACE:function(){return Aw},FILTERS_BUTTONS_CANCEL:function(){return tC},FILTERS_BUTTONS_CLEAR:function(){return JS},FILTERS_BUTTONS_OK:function(){return ZS},FILTERS_BUTTONS_PLACEHOLDER_SEARCH:function(){return eC},FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:function(){return rC},FILTERS_BUTTONS_PLACEHOLDER_VALUE:function(){return nC},FILTERS_BUTTONS_SELECT_ALL:function(){return QS},FILTERS_CONDITIONS_AFTER:function(){return FS},FILTERS_CONDITIONS_BEFORE:function(){return WS},FILTERS_CONDITIONS_BEGINS_WITH:function(){return MS},FILTERS_CONDITIONS_BETWEEN:function(){return BS},FILTERS_CONDITIONS_BY_VALUE:function(){return _S},FILTERS_CONDITIONS_CONTAINS:function(){return IS},FILTERS_CONDITIONS_EMPTY:function(){return ES},FILTERS_CONDITIONS_ENDS_WITH:function(){return AS},FILTERS_CONDITIONS_EQUAL:function(){return TS},FILTERS_CONDITIONS_GREATER_THAN:function(){return HS},FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:function(){return NS},FILTERS_CONDITIONS_LESS_THAN:function(){return DS},FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:function(){return LS},FILTERS_CONDITIONS_NAMESPACE:function(){return kS},FILTERS_CONDITIONS_NONE:function(){return RS},FILTERS_CONDITIONS_NOT_BETWEEN:function(){return VS},FILTERS_CONDITIONS_NOT_CONTAIN:function(){return xS},FILTERS_CONDITIONS_NOT_EMPTY:function(){return PS},FILTERS_CONDITIONS_NOT_EQUAL:function(){return jS},FILTERS_CONDITIONS_TODAY:function(){return US},FILTERS_CONDITIONS_TOMORROW:function(){return zS},FILTERS_CONDITIONS_YESTERDAY:function(){return GS},FILTERS_DIVS_FILTER_BY_CONDITION:function(){return YS},FILTERS_DIVS_FILTER_BY_VALUE:function(){return KS},FILTERS_LABELS_CONJUNCTION:function(){return XS},FILTERS_LABELS_DISJUNCTION:function(){return $S},FILTERS_NAMESPACE:function(){return OS},FILTERS_VALUES_BLANK_CELLS:function(){return qS}});var m={};n.r(m),n.d(m,{getNormalizedDate:function(){return A_}});var g,b,w,S=n(6427),C=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("DataGrid")],1)},O=[],k=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"example"}},[e("hot-table",{ref:"hotTableComponent",attrs:{data:t.data,settings:t.hotSettings}})],1)},R=[];n(5006),n(6925),n(4453),n(1021),n(8669),n(757),n(9821),n(5270),n(8127),n(3671),n(3953),n(3460),n(9455),n(5477),n(2966),n(7786),n(957),n(809),n(3251),n(2996),n(1634),n(4750),n(9028),n(1330),n(3696),n(4423),n(4182),n(1965),n(8323),n(5867),n(2329),n(8786),n(924),n(6565);function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function P(t){return window.requestAnimationFrame(t)}function T(){return!!document.documentElement.classList}function j(){return!!document.createTextNode("test").textContent}function M(){return!!window.getComputedStyle}function A(t){window.cancelAnimationFrame(t)}function I(){return"ontouchstart"in window}function x(){var t=document.createElement("TABLE");t.style.borderSpacing="0",t.style.borderWidth="0",t.style.padding="0";var e=document.createElement("TBODY");t.appendChild(e),e.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding="0",n.style.margin="0",t.insertBefore(n,e),document.body.appendChild(t),g=t.offsetHeight<2*t.lastChild.offsetHeight,document.body.removeChild(t)}function _(){return void 0===g&&x(),g}function H(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return b||(b="object"===("undefined"===typeof Intl?"undefined":E(Intl))?new Intl.Collator(t,e).compare:"function"===typeof String.prototype.localeCompare?function(t,e){return"".concat(t).localeCompare(e)}:function(t,e){return t===e?0:t>e?-1:1},b)}function N(){if(void 0!==w)return w;try{var t={get passive(){w=!0}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(e){w=!1}return w}n(7682),n(6139),n(3455),n(3378);function D(t){var e=t.length,n=0;while(n<e)t[n]=[t[n]],n+=1}function L(t,e){var n=e.length,r=0;while(r<n)t.push(e[r]),r+=1}function B(t){var e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;for(var n=t.length,r=t[0].length,o=0;o<n;o++)for(var i=0;i<r;i++)e[i]||(e[i]=[]),e[i][o]=t[o][i];return e}function V(t,e,n,r){var o=-1,i=t,a=n;Array.isArray(t)||(i=Array.from(t));var l=i.length;r&&l&&(o+=1,a=i[o]),o+=1;while(o<l)a=e(a,i[o],o,i),o+=1;return a}function F(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));var o=r.length,i=[],a=-1;while(n<o){var l=r[n];e(l,n,r)&&(a+=1,i[a]=l),n+=1}return i}function W(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));var o=r.length,i=[],a=-1;while(n<o){var l=r[n];a+=1,i[a]=e(l,n,r),n+=1}return i}function U(t,e){var n=0,r=t;Array.isArray(t)||(r=Array.from(t));var o=r.length;while(n<o){if(!1===e(r[n],n,r))break;n+=1}return t}function z(t){return V(t,(function(t,e){return t+e}),0)}function G(t){return V(t,(function(t,e){return t>e?t:e}),Array.isArray(t)?t[0]:void 0)}function Y(t){return V(t,(function(t,e){return t<e?t:e}),Array.isArray(t)?t[0]:void 0)}function K(t){return t.length?z(t)/t.length:0}function X(t){return V(t,(function(t,e){return t.concat(Array.isArray(e)?X(e):e)}),[])}function $(t){var e=[];return U(t,(function(t){-1===e.indexOf(t)&&e.push(t)})),e}function q(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=[].concat(e),o=r[0],i=r.slice(1),a=o;return U(i,(function(t){a=a.filter((function(e){return!t.includes(e)}))})),a}function Q(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=[].concat(e),o=r[0],i=r.slice(1),a=o;return U(i,(function(t){a=a.filter((function(e){return t.includes(e)}))})),a}function J(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=[].concat(e),o=r[0],i=r.slice(1),a=new Set(o);return U(i,(function(t){U(t,(function(t){a.has(t)||a.add(t)}))})),Array.from(a)}function Z(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}function tt(t,e,n){return e=et(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function et(t){var e=nt(t,"string");return"symbol"===rt(e)?e:String(e)}function nt(t,e){if("object"!==rt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function ot(t){var e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},pt(t,(function(t,n){"__children"!==n&&(t&&"object"===rt(t)&&!Array.isArray(t)?e[n]=ot(t):Array.isArray(t)?t.length&&"object"===rt(t[0])&&!Array.isArray(t[0])?e[n]=[ot(t[0])]:e[n]=[]:e[n]=null)}))),e}function it(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function at(t,e,n){var r=Array.isArray(n);return pt(e,(function(e,o){(!1===r||n.includes(o))&&(t[o]=e)})),t}function lt(t,e){pt(e,(function(n,r){e[r]&&"object"===rt(e[r])?(t[r]||(Array.isArray(e[r])?t[r]=[]:"[object Date]"===Object.prototype.toString.call(e[r])?t[r]=e[r]:t[r]={}),lt(t[r],e[r])):t[r]=e[r]}))}function st(t){return"object"===rt(t)?JSON.parse(JSON.stringify(t)):t}function ut(t){var e={};return pt(t,(function(t,n){e[n]=t})),e}function ct(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return U(n,(function(e){t.MIXINS.push(e.MIXIN_NAME),pt(e,(function(e,n){if(void 0!==t.prototype[n])throw new Error("Mixin conflict. Property '".concat(n,"' already exist and cannot be overwritten."));if("function"===typeof e)t.prototype[n]=e;else{var r=function(t,e){var n="_".concat(t),r=function(t){var e=t;return(Array.isArray(e)||ht(e))&&(e=st(e)),e};return function(){return void 0===this[n]&&(this[n]=r(e)),this[n]}},o=function(t){var e="_".concat(t);return function(t){this[e]=t}};Object.defineProperty(t.prototype,n,{get:r(n,e),set:o(n),configurable:!0})}}))})),t}function ft(t,e){return JSON.stringify(t)===JSON.stringify(e)}function ht(t){return"[object Object]"===Object.prototype.toString.call(t)}function dt(t,e,n,r){r.value=n,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(t,e,r)}function pt(t,e){for(var n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&!1===e(t[n],n,t))break;return t}function yt(t,e){var n=e.split("."),r=t;return pt(n,(function(t){if(r=r[t],void 0===r)return r=void 0,!1})),r}function vt(t,e,n){var r=e.split("."),o=t;r.forEach((function(t,e){e!==r.length-1?(bt(o,t)||(o[t]={}),o=o[t]):o[t]=n}))}function mt(t){if(!ht(t))return 0;var e=function t(e){var n=0;return ht(e)?pt(e,(function(e,r){"__children"!==r&&(n+=t(e))})):n+=1,n};return e(t)}function gt(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",r="_".concat(n),o=(e={_touched:!1},tt(e,r,t),tt(e,"isTouched",(function(){return this._touched})),e);return Object.defineProperty(o,n,{get:function(){return this[r]},set:function(t){this._touched=!0,this[r]=t},enumerable:!0,configurable:!0}),o}function bt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var wt=function(t){var e={value:!1,test:function(n,r){e.value=t(n,r)}};return e},St={chrome:wt((function(t,e){return/Chrome/.test(t)&&/Google/.test(e)})),chromeWebKit:wt((function(t){return/CriOS/.test(t)})),edge:wt((function(t){return/Edge/.test(t)})),edgeWebKit:wt((function(t){return/EdgiOS/.test(t)})),firefox:wt((function(t){return/Firefox/.test(t)})),firefoxWebKit:wt((function(t){return/FxiOS/.test(t)})),ie:wt((function(t){return/Trident/.test(t)})),ie9:wt((function(){return!!document.documentMode})),mobile:wt((function(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)})),safari:wt((function(t,e){return/Safari/.test(t)&&/Apple Computer/.test(e)}))},Ct={mac:wt((function(t){return/^Mac/.test(t)})),win:wt((function(t){return/^Win/.test(t)})),linux:wt((function(t){return/^Linux/.test(t)})),ios:wt((function(t){return/iPhone|iPad|iPod/i.test(t)}))};function Ot(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.userAgent,n=void 0===e?navigator.userAgent:e,r=t.vendor,o=void 0===r?navigator.vendor:r;pt(St,(function(t){var e=t.test;e(n,o)}))}function kt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.platform,n=void 0===e?navigator.platform:e;pt(Ct,(function(t){var e=t.test;e(n)}))}function Rt(){return St.chrome.value}function Et(){return St.chromeWebKit.value}function Pt(){return St.firefox.value}function Tt(){return St.firefoxWebKit.value}function jt(){return St.safari.value}function Mt(){return St.edge.value}function At(){return St.edgeWebKit.value}function It(){return St.ie.value}function xt(){return St.ie9.value}function _t(){return St.ie.value||St.edge.value}function Ht(){return St.mobile.value}function Nt(){return Ct.ios.value}function Dt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator,e=t.maxTouchPoints;return e>2&&Ct.mac.value}function Lt(){return Ct.win.value}function Bt(){return Ct.mac.value}function Vt(){return Ct.linux.value}Ot(),kt();var Ft,Wt,Ut,zt,Gt,Yt,Kt=n(9757),Xt=(n(520),n(9981),n(2168),n(8289));function $t(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var o=V(t,(function(t,e,r){var o=e.replace(/\r?\n\s*/g,""),i=n[r]?n[r]:"";return t+o+i}),"");return o.trim()}function qt(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Qt(t){return Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qt(t)}function Jt(t){var e;switch(Qt(t)){case"string":case"number":e="".concat(t);break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Zt(t){return"undefined"!==typeof t}function te(t){return"undefined"===typeof t}function ee(t){return null===t||""===t||te(t)}function ne(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var re,oe,ie,ae="length",le=function(t){return parseInt(t,16)},se=function(t){return parseInt(t,10)},ue=function(t,e,n){return t["substr"](e,n)},ce=function(t){return t["codePointAt"](0)-65},fe=function(t){return"".concat(t).replace(/\-/g,"")},he=function(t){return le(ue(fe(t),le("12"),ce("F")))/(le(ue(fe(t),ce("B"),~~![][ae]))||9)},de=function(){return"undefined"!==typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},pe=!1,ye={invalid:function(){return $t(Ft||(Ft=qt(["\n    The license key for Handsontable is invalid. \n    If you need any help, contact us at support@handsontable.com."],["\n    The license key for Handsontable is invalid.\\x20\n    If you need any help, contact us at support@handsontable.com."])))},expired:function(t){var e=t.keyValidityDate,n=t.hotVersion;return $t(Wt||(Wt=qt(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior \n    to ",". If you need any help, contact us at sales@handsontable.com."],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior\\x20\n    to ",". If you need any help, contact us at sales@handsontable.com."])),e,n,e)},missing:function(){return $t(Ut||(Ut=qt(["\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact \n    us at support@handsontable.com."],["\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20\n    us at support@handsontable.com."])))},non_commercial:function(){return""}},ve={invalid:function(){return $t(zt||(zt=qt(['\n    The license key for Handsontable is invalid. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to \n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is invalid.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20\n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},expired:function(t){var e=t.keyValidityDate,n=t.hotVersion;return $t(Gt||(Gt=qt(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your \n    license key or downgrade to a version released prior to ','. If you need any \n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20\n    license key or downgrade to a version released prior to ','. If you need any\\x20\n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'])),e,n,e)},missing:function(){return $t(Yt||(Yt=qt(['\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: \'non-commercial-and-evaluation\'. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in \n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: \'non-commercial-and-evaluation\'.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20\n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},non_commercial:function(){return""}};function me(t,e){var n,r=!ee(t),o="string"===typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),i="13.0.0",a="invalid",l="invalid";t=fe(t||"");var s=ge(t);if(r||o||s)if(s){var u=Xt("22/06/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),f=he(t);n=Xt(864e5*(f+1),"x").format("MMMM DD, YYYY"),c>f?(a="expired",l="expired"):(a="valid",l="valid")}else o?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(de()&&(a="valid",l="valid"),!pe&&"valid"!==a){var h=ye[a]({keyValidityDate:n,hotVersion:i});h&&console["non_commercial"===a?"info":"warn"](ye[a]({keyValidityDate:n,hotVersion:i})),pe=!0}if("valid"!==l&&e.parentNode){var d=ve[l]({keyValidityDate:n,hotVersion:i});if(d){var p=document.createElement("div");p.className="hot-display-license-info",p.innerHTML=ve[l]({keyValidityDate:n,hotVersion:i}),e.parentNode.insertBefore(p,e.nextSibling)}}}function ge(t){var e=[][ae],n=e;if(t[ae]!==ce("Z"))return!1;for(var r="",o="B<H4P+".split(""),i=ce(o.shift());i;i=ce(o.shift()||"A"))--i<""[ae]?n|=(se("".concat(se(le(r)+(le(ue(t,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:r=ue(t,i,i?1===o[ae]?9:8:6);return n===e}function be(t){return t[0].toUpperCase()+t.substr(1)}function we(){for(var t=[],e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=n.length;while(o){o-=1;var i=Jt(n[o]).toLowerCase();-1===t.indexOf(i)&&t.push(i)}return 1===t.length}function Se(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function Ce(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function Oe(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(t).replace(/(?:\\)?\[([^[\]]+)]/g,(function(t,n){return"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[n]?"":e[n]}))}function ke(t){return Re("".concat(t),{ALLOWED_TAGS:[]})}function Re(t,e){return Kt.sanitize(t,e)}function Ee(t){return Me(t)||je(t)||Te(t)||Pe()}function Pe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Te(t,e){if(t){if("string"===typeof t)return Ae(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ae(t,e):void 0}}function je(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Me(t){if(Array.isArray(t))return Ae(t)}function Ae(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ie(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null,o=t;while(null!==o){if(n===e){r=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(n+=1,o=o.parentNode)}return r}function xe(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function _e(t){return xe(t)&&t.parent}function He(t){return!!Object.getPrototypeOf(t.parent)}function Ne(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=Node,o=r.ELEMENT_NODE,i=r.DOCUMENT_FRAGMENT_NODE,a=t;while(null!==a&&void 0!==a&&a!==n){var l=a,s=l.nodeType,u=l.nodeName;if(s===o&&(e.includes(u)||e.includes(a)))return a;var c=a,f=c.host;a=f&&s===i?f:a.parentNode}return null}function De(t,e,n){var r=[],o=t;while(o){if(o=Ne(o,e,n),!o||n&&!n.contains(o))break;r.push(o),o=o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o.parentNode}var i=r.length;return i?r[i-1]:null}function Le(t,e){var n=t.parentNode,r=[];"string"===typeof e?r=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);while(null!==n){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Be(t){var e=0,n=t;if(n.previousSibling)while(n=n.previousSibling)e+=1;return e}function Ve(t,e,n){var r=n.parentElement.querySelector(".ht_clone_".concat(t));return r?r.contains(e):null}function Fe(t){return t&&t.length?t.filter((function(t){return!!t})):[]}if(T()){var We=function(t){var e=t.createElement("div");return e.classList.add("test","test2"),e.classList.contains("test2")};re=function(t,e){return void 0!==t.classList&&"string"===typeof e&&""!==e&&t.classList.contains(e)},oe=function(t,e){var n=t.ownerDocument,r=e;if("string"===typeof r&&(r=r.split(" ")),r=Fe(r),r.length>0)if(We(n)){var o;(o=t.classList).add.apply(o,Ee(r))}else{var i=0;while(r[i])t.classList.add(r[i]),i+=1}},ie=function(t,e){var n=t.ownerDocument,r=e;if("string"===typeof r&&(r=r.split(" ")),r=Fe(r),r.length>0)if(We(n)){var o;(o=t.classList).remove.apply(o,Ee(r))}else{var i=0;while(r[i])t.classList.remove(r[i]),i+=1}}}else{var Ue=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};re=function(t,e){return void 0!==t.className&&Ue(e).test(t.className)},oe=function(t,e){var n=t.className,r=e;if("string"===typeof r&&(r=r.split(" ")),r=Fe(r),""===n)n=r.join(" ");else for(var o=0;o<r.length;o++)r[o]&&!Ue(r[o]).test(n)&&(n+=" ".concat(r[o]));t.className=n},ie=function(t,e){var n=0,r=t.className,o=e;"string"===typeof o&&(o=o.split(" ")),o=Fe(o);while(o[n])r=r.replace(Ue(o[n])," ").trim(),n+=1;t.className!==r&&(t.className=r)}}function ze(t,e){return re(t,e)}function Ge(t,e){oe(t,e)}function Ye(t,e){ie(t,e)}function Ke(t){if(3===t.nodeType)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1)for(var e=t.childNodes,n=e.length-1;n>=0;n--)Ke(e[n])}function Xe(t){var e;while(e=t.lastChild)t.removeChild(e)}var $e,qe=/(<(.*)>|&(.*);)/;function Qe(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];qe.test(e)?t.innerHTML=n?Re(e):e:Je(t,e)}function Je(t,e){var n=t.firstChild;n&&3===n.nodeType&&null===n.nextSibling?j?n.textContent=e:n.data=e:(Xe(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Ze(t){var e=t.ownerDocument.documentElement,n=t;while(n!==e){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return Ze(n.host.impl);if(n.host)return Ze(n.host);throw new Error("Lost in Web Components world")}return!1}if(n.style&&"none"===n.style.display)return!1;n=n.parentNode}return!0}function tn(t){var e,n,r,o,i=t.ownerDocument,a=i.defaultView,l=i.documentElement,s=t;if(_()&&s.firstChild&&"CAPTION"===s.firstChild.nodeName)return o=s.getBoundingClientRect(),{top:o.top+(a.pageYOffset||l.scrollTop)-(l.clientTop||0),left:o.left+(a.pageXOffset||l.scrollLeft)-(l.clientLeft||0)};e=s.offsetLeft,n=s.offsetTop,r=s;while(s=s.offsetParent){if(s===i.body)break;e+=s.offsetLeft,n+=s.offsetTop,r=s}return r&&"fixed"===r.style.position&&(e+=a.pageXOffset||l.scrollLeft,n+=a.pageYOffset||l.scrollTop),{left:e,top:n}}function en(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.scrollY;return void 0===e&&(e=t.document.documentElement.scrollTop),e}function nn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.scrollX;return void 0===e&&(e=t.document.documentElement.scrollLeft),e}function rn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?en(e):t.scrollTop}function on(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?nn(e):t.scrollLeft}function an(t){var e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);var r=["auto","scroll"],o=M(),i=t.parentNode;while(i&&i.style&&e.body!==i){var a=i.style,l=a.overflow,s=a.overflowX,u=a.overflowY;if([l,s,u].includes("scroll"))return i;if(o){var c=n.getComputedStyle(i);if(l=c.overflow,s=c.overflowX,u=c.overflowY,r.includes(l)||r.includes(s)||r.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(r.includes(u)||r.includes(l)))return i;if(i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(l)))return i;i=i.parentNode}return n}function ln(t){var e=t.ownerDocument,n=e.defaultView,r=t.parentNode;while(r&&r.style&&e.body!==r){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;var o=cn(r,n),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return r;r=r.parentNode}return n}function sn(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(t){if(t===n)return"width"===e?"".concat(n.innerWidth,"px"):"height"===e?"".concat(n.innerHeight,"px"):void 0;var r=t.style[e];if(""!==r&&void 0!==r)return r;var o=cn(t,n);return""!==o[e]&&void 0!==o[e]?o[e]:void 0}}function un(t,e){var n=e.selectorText,r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function cn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function fn(t){return t.offsetWidth}function hn(t){return _()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName?t.offsetHeight+t.firstChild.offsetHeight:t.offsetHeight}function dn(t){return t.clientHeight||t.innerHeight}function pn(t){return t.clientWidth||t.innerWidth}function yn(t,e,n){t.addEventListener(e,n,!1)}function vn(t,e,n){t.removeEventListener(e,n,!1)}function mn(t){var e=t.ownerDocument;if(t.selectionStart)return t.selectionStart;if(e.selection){t.focus();var n=e.selection.createRange();if(null===n)return 0;var r=t.createTextRange(),o=r.duplicate();return r.moveToBookmark(n.getBookmark()),o.setEndPoint("EndToStart",r),o.text.length}return 0}function gn(t){var e=t.ownerDocument;if(t.selectionEnd)return t.selectionEnd;if(e.selection){var n=e.selection.createRange();if(null===n)return 0;var r=t.createTextRange();return r.text.indexOf(n.text)+n.text.length}return 0}function bn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.document,n="";return t.getSelection?n=t.getSelection().toString():e.selection&&"Control"!==e.selection.type&&(n=e.selection.createRange().text),n}function wn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.document;t.getSelection?t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges():e.selection&&e.selection.empty()}function Sn(t,e,n){if(void 0===n&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch(i){var r=t.parentNode,o=r.style.display;r.style.display="block",t.setSelectionRange(e,n),r.style.display=o}}}function Cn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";var n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);var r=e.offsetWidth;n.style.overflow="scroll";var o=e.offsetWidth;return r===o&&(o=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-o}function On(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===$e&&($e=Cn(t)),$e}function kn(t){return t.offsetWidth!==t.clientWidth}function Rn(t){return t.offsetHeight!==t.clientHeight}function En(t,e,n){xt()?(t.style.top=n,t.style.left=e):jt()?t.style["-webkit-transform"]="translate3d(".concat(e,",").concat(n,",0)"):t.style.transform="translate3d(".concat(e,",").concat(n,",0)")}function Pn(t){var e;return t.style.transform&&""!==(e=t.style.transform)?["transform",e]:t.style["-webkit-transform"]&&""!==(e=t.style["-webkit-transform"])?["-webkit-transform",e]:-1}function Tn(t){t.style.transform&&""!==t.style.transform?t.style.transform="":t.style["-webkit-transform"]&&""!==t.style["-webkit-transform"]&&(t.style["-webkit-transform"]="")}function jn(t){var e=["INPUT","SELECT","TEXTAREA"];return t&&(e.indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function Mn(t){return jn(t)&&!1===t.hasAttribute("data-hot-input")}function An(t){var e=t.ownerDocument.activeElement;Mn(e)||t.select()}function In(t){return!t.parentNode}function xn(t,e){var n=new IntersectionObserver((function(n,r){n.forEach((function(n){n.isIntersecting&&null!==t.offsetParent&&(e(),r.unobserve(t))}))}),{root:t.ownerDocument.body});n.observe(t)}function _n(t){return"function"===typeof t}function Hn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0,r={lastCallThrottled:!0},o=null;function i(){for(var i=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];var u=Date.now(),c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);var f=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,l)):(o&&clearTimeout(o),o=setTimeout((function(){r.lastCallThrottled=!1,t.apply(i,l),n=0,o=void 0}),f)),r}return i}function Nn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=Hn(t,e),o=n;function i(){o=n}function a(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return o?(o-=1,t.apply(this,n)):r.apply(this,n)}return a.clearHits=i,a}function Dn(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;function o(){for(var o=this,i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout((function(){e=t.apply(o,a)}),n),e}return o}function Ln(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],o=e.slice(1);return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return V(o,(function(t,e){return e(t)}),r.apply(this,e))}}function Bn(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t.apply(this,n.concat(r))}}function Vn(t){var e=t.length;function n(r){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var l,s=r.concat(i);return l=s.length>=e?t.apply(this,s):n(s),l}}return n([])}function Fn(t){var e=t.length;function n(r){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var l,s=r.concat(i.reverse());return l=s.length>=e?t.apply(this,s):n(s),l}}return n([])}function Wn(t,e,n,r,o,i,a,l){return Zt(l)?t.call(e,n,r,o,i,a,l):Zt(a)?t.call(e,n,r,o,i,a):Zt(i)?t.call(e,n,r,o,i):Zt(o)?t.call(e,n,r,o):Zt(r)?t.call(e,n,r):Zt(n)?t.call(e,n):t.call(e)}n(682),n(2783),n(6268);var Un,zn={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Pt()?182:174,AUDIO_MUTE:Pt()?181:173,AUDIO_UP:Pt()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Gn=[zn.ALT,zn.ARROW_DOWN,zn.ARROW_LEFT,zn.ARROW_RIGHT,zn.ARROW_UP,zn.AUDIO_DOWN,zn.AUDIO_MUTE,zn.AUDIO_UP,zn.BACKSPACE,zn.CAPS_LOCK,zn.DELETE,zn.END,zn.ENTER,zn.ESCAPE,zn.F1,zn.F2,zn.F3,zn.F4,zn.F5,zn.F6,zn.F7,zn.F8,zn.F9,zn.F10,zn.F11,zn.F12,zn.F13,zn.F14,zn.F15,zn.F16,zn.F17,zn.F18,zn.F19,zn.HOME,zn.INSERT,zn.MEDIA_NEXT,zn.MEDIA_PLAY_PAUSE,zn.MEDIA_PREV,zn.MEDIA_STOP,zn.NULL,zn.NUM_LOCK,zn.PAGE_DOWN,zn.PAGE_UP,zn.PAUSE,zn.SCROLL_LOCK,zn.SHIFT,zn.TAB];function Yn(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function Kn(t){return Gn.includes(t)}function Xn(t){var e=[];return Bt()?e.push(zn.COMMAND_LEFT,zn.COMMAND_RIGHT,zn.COMMAND_FIREFOX):e.push(zn.CONTROL),e.includes(t)}function $n(t){return[zn.CONTROL,zn.COMMAND_LEFT,zn.COMMAND_RIGHT,zn.COMMAND_FIREFOX].includes(t)}function qn(t,e){var n=e.split("|"),r=!1;return U(n,(function(e){if(t===zn[e])return r=!0,!1})),r}function Qn(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Jn(t){return!1===t.isImmediatePropagationEnabled}function Zn(t){return 2===t.button}function tr(t){return 0===t.button}function er(){var t;Zt(console)&&(t=console).warn.apply(t,arguments)}function nr(){var t;Zt(console)&&(t=console).error.apply(t,arguments)}function rr(t){return rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rr(t)}function or(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ir(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lr(r.key),r)}}function ar(t,e,n){return e&&ir(t.prototype,e),n&&ir(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function lr(t){var e=sr(t,"string");return"symbol"===rr(e)?e:String(e)}function sr(t,e){if("object"!==rr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==rr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ur(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var cr=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],fr=$t(Un||(Un=ur(['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. \n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to \n  learn about the migration path.'],['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20\n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20\n  learn about the migration path.']))),hr=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),dr=new Map([]),pr=function(){function t(){or(this,t),this.globalBucket=this.createEmptyBucket()}return ar(t,[{key:"createEmptyBucket",value:function(){var t=Object.create(null);return U(cr,(function(e){return t[e]=[]})),t}},{key:"getBucket",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}},{key:"add",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))U(e,(function(e){return n.add(t,e,r)}));else{hr.has(t)&&er(Oe(fr,{hookName:t,removedInVersion:hr.get(t)})),dr.has(t)&&er(dr.get(t));var o=this.getBucket(r);if("undefined"===typeof o[t]&&(this.register(t),o[t]=[]),e.skip=!1,-1===o[t].indexOf(e)){var i=!1;e.initialHook&&U(o[t],(function(n,r){if(n.initialHook)return o[t][r]=e,i=!0,!1})),i||o[t].push(e)}}return this}},{key:"once",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?U(e,(function(e){return n.once(t,e,r)})):(e.runOnce=!0,this.add(t,e,r))}},{key:"remove",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(n);return"undefined"!==typeof r[t]&&r[t].indexOf(e)>=0&&(e.skip=!0,!0)}},{key:"has",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(e);return!(void 0===n[t]||!n[t].length)}},{key:"run",value:function(t,e,n,r,o,i,a,l){var s=this.globalBucket[e],u=s?s.length:0,c=0;if(u)while(c<u)if(s[c]&&!s[c].skip){var f=Wn(s[c],t,n,r,o,i,a,l);void 0!==f&&(n=f),s[c]&&s[c].runOnce&&this.remove(e,s[c]),c+=1}else c+=1;var h=this.getBucket(t)[e],d=h?h.length:0,p=0;if(d)while(p<d)if(h[p]&&!h[p].skip){var y=Wn(h[p],t,n,r,o,i,a,l);void 0!==y&&(n=y),h[p]&&h[p].runOnce&&this.remove(e,h[p],t),p+=1}else p+=1;return n}},{key:"destroy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;pt(this.getBucket(t),(function(t,e,n){return n[e].length=0}))}},{key:"register",value:function(t){this.isRegistered(t)||cr.push(t)}},{key:"deregister",value:function(t){this.isRegistered(t)&&cr.splice(cr.indexOf(t),1)}},{key:"isDeprecated",value:function(t){return dr.has(t)||hr.has(t)}},{key:"isRegistered",value:function(t){return cr.indexOf(t)>=0}},{key:"getRegistered",value:function(){return cr}}],[{key:"getSingleton",value:function(){return vr()}}]),t}(),yr=new pr;function vr(){return yr}var mr=pr;function gr(t){return Cr(t)||Sr(t)||wr(t)||br()}function br(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function wr(t,e){if(t){if("string"===typeof t)return Or(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Or(t,e):void 0}}function Sr(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Cr(t){if(Array.isArray(t))return Or(t)}function Or(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var kr=new Map;function Rr(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";kr.has(t)||kr.set(t,new Map);var e=kr.get(t);function n(t,n){e.set(t,n)}function r(t){return e.get(t)}function o(t){return e.has(t)}function i(){return gr(e.keys())}function a(){return gr(e.values())}return{register:n,getItem:r,hasItem:o,getNames:i,getValues:a}}var Er=new WeakMap,Pr=Rr("editors"),Tr=Pr.register,jr=Pr.getItem,Mr=Pr.hasItem,Ar=Pr.getNames;Pr.getValues;function Ir(t){var e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new n(t)),e[t.guid]},mr.getSingleton().add("afterDestroy",(function(){e[this.guid]=null}))}function xr(t,e){var n;if("function"===typeof t)Er.get(t)||Hr(null,t),n=Er.get(t);else{if("string"!==typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');n=jr(t)}if(!n)throw Error('No editor registered under name "'.concat(t,'"'));return n.getInstance(e)}function _r(t){if("function"===typeof t)return t;if(!Mr(t))throw Error('No registered editor found under "'.concat(t,'" name'));return jr(t).getConstructor()}function Hr(t,e){t&&"string"!==typeof t&&(e=t,t=e.EDITOR_TYPE);var n=new Ir(e);"string"===typeof t&&Tr(t,n),Er.set(e,n)}function Nr(t){return Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nr(t)}function Dr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vr(r.key),r)}}function Br(t,e,n){return e&&Lr(t.prototype,e),n&&Lr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Vr(t){var e=Fr(t,"string");return"symbol"===Nr(e)?e:String(e)}function Fr(t,e){if("object"!==Nr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Nr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Wr=0,Ur=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Dr(this,t),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}return Br(t,[{key:"addEventListener",value:function(t,e,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(t){n.call(this,zr(t))}return"boolean"===typeof o||N()||(o=!1),this.context.eventListeners.push({element:t,event:e,callback:n,callbackProxy:i,options:o,eventManager:this}),t.addEventListener(e,i,o),Wr+=1,function(){r.removeEventListener(t,e,n)}}},{key:"removeEventListener",value:function(t,e,n){var r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.context.eventListeners.length;while(i)if(i-=1,r=this.context.eventListeners[i],r.event===e&&r.element===t){if(n&&n!==r.callback)continue;if(o&&r.eventManager!==this)continue;this.context.eventListeners.splice(i,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Wr-=1}}},{key:"clearEvents",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.context){var e=this.context.eventListeners.length;while(e){e-=1;var n=this.context.eventListeners[e];t&&n.eventManager!==this||(this.context.eventListeners.splice(e,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),Wr-=1)}}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(t,e){var n=t.document,r=t;n||(n=t.ownerDocument?t.ownerDocument:t,r=n.defaultView);var o,i={bubbles:!0,cancelable:"mousemove"!==e,view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(e,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||n.body.parentNode)):o=n.createEventObject(),t.dispatchEvent?t.dispatchEvent(o):t.fireEvent("on".concat(e),o)}}]),t}();function zr(t){var e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Qn(this)},t}var Gr=Ur;function Yr(){return Wr}function Kr(t){return Kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kr(t)}function Xr(t,e){return Zr(t)||Jr(t,e)||qr(t,e)||$r()}function $r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function qr(t,e){if(t){if("string"===typeof t)return Qr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qr(t,e):void 0}}function Qr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Jr(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Zr(t){if(Array.isArray(t))return t}function to(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function eo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?to(Object(n),!0).forEach((function(e){no(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):to(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function no(t,e,n){return e=ao(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ro(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ao(r.key),r)}}function io(t,e,n){return e&&oo(t.prototype,e),n&&oo(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ao(t){var e=lo(t,"string");return"symbol"===Kr(e)?e:String(e)}function lo(t,e){if("object"!==Kr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Kr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var so="editorManager.navigation",uo="editorManager.handlingEditor",co=function(){function t(e,n,r){var o=this;ro(this,t),this.instance=e,this.tableMeta=n,this.selection=r,this.eventManager=new Gr(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",(function(t){return o.onAfterDocumentKeyDown(t)})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(function(t){!o.destroyed&&o.instance.isListening()&&o.openEditor("",t)})),this.instance.view._wt.update("onCellDblClick",(function(t,e,n){return o.onCellDblClick(t,e,n)}))}return io(t,[{key:"registerShortcuts",value:function(){var t=this,e=this.instance.getShortcutManager(),n=e.getContext("grid"),r=e.getContext("editor"),o={group:uo};r.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(n,r){t.closeEditorAndSaveChanges(e.isCtrlPressed()),t.moveSelectionAfterEnter(r.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){t.closeEditorAndRestoreOriginalValue(e.isCtrlPressed()),t.activeEditor.focus()}}],o),n.addShortcuts([{keys:[["F2"]],callback:function(e){t.openEditor(null,e,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){t.instance.emptySelectedCells(),t.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(e,n){t.instance.getSettings().enterBeginsEditing?t.cellProperties.readOnly?t.moveSelectionAfterEnter():t.openEditor(null,e,!0):t.moveSelectionAfterEnter(n.includes("shift")),Qn(e)}}],eo(eo({},o),{},{runOnlyIf:function(){return Zt(t.instance.getSelected())}}))}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(t){this.lock||this.closeEditor(t)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var t=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,(function(e){e&&t.prepareEditor()}));else{var e=this.instance.getSelectedRangeLast().highlight,n=e.row,r=e.col,o=this.instance.runHooks("modifyGetCellCoords",n,r),i=n,a=r;if(Array.isArray(o)){var l=Xr(o,2);i=l[0],a=l[1]}this.cellProperties=this.instance.getCellMeta(i,a);var s=this.instance.rootDocument.activeElement;if(s&&Mn(s)&&s.blur(),this.isCellEditable()){var u=this.instance.getCell(n,r,!0);if(u){var c=this.instance.getCellEditor(this.cellProperties),f=this.instance.colToProp(a),h=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(i),a);this.activeEditor=xr(c,this.instance),this.activeEditor.prepare(n,r,f,u,h,this.cellProperties)}}else this.clearActiveEditor()}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.isCellEditable()){if(!this.activeEditor){var r=this.instance.getSelectedRangeLast().highlight,o=r.row,i=r.col,a=this.instance.rowIndexMapper.getRenderableFromVisualIndex(o),l=this.instance.columnIndexMapper.getRenderableFromVisualIndex(i);this.instance.view.scrollViewport(this.instance._createCellCoords(a,l)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))}else this.clearActiveEditor()}},{key:"closeEditor",value:function(t,e,n){this.activeEditor?this.activeEditor.finishEditing(t,e,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(t){this.closeEditor(!1,t)}},{key:"closeEditorAndRestoreOriginalValue",value:function(t){this.closeEditor(!0,t)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var t=this.instance.getCellEditor(this.cellProperties),e=this.instance.getSelectedRangeLast().highlight,n=e.row,r=e.col,o=this.instance,i=o.rowIndexMapper,a=o.columnIndexMapper,l=i.isHidden(this.instance.toPhysicalRow(n))||a.isHidden(this.instance.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!t||l)}},{key:"moveSelectionAfterEnter",value:function(t){var e="function"===typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;t?this.selection.transformStart(-e.row,-e.col):this.selection.transformStart(e.row,e.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(t){var e=this;if(this.instance.isListening()){var n=t.keyCode;if(this.selection.isSelected()){var r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Kn(n)&&!$n(n)&&!r&&!this.isEditorOpened()){var o=this.instance.getShortcutManager(),i=o.getContext("editor"),a={runOnlyIf:function(){return Zt(e.instance.getSelected())},group:so};i.addShortcuts([{keys:[["ArrowUp"]],callback:function(){e.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){e.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){e.instance.selection.transformStart(0,-1*e.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){e.instance.selection.transformStart(0,e.instance.getDirectionFactor())}}],a),this.openEditor("",t)}}}}},{key:"onCellDblClick",value:function(t,e,n){"TD"===n.nodeName&&this.openEditor(null,t,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),t}(),fo=new WeakMap;co.getInstance=function(t,e,n){var r=fo.get(t);return r||(r=new co(t,e,n),fo.set(t,r)),r};var ho=co;n(2104),n(891),n(538),n(4945),n(3101);function po(t){return go(t)||mo(t)||vo(t)||yo()}function yo(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function vo(t,e){if(t){if("string"===typeof t)return bo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bo(t,e):void 0}}function mo(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function go(t){if(Array.isArray(t))return bo(t)}function bo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var wo={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},So=new RegExp(Object.keys(wo).map((function(t){return"(".concat(t,")")})).join("|"),"gi");function Co(t){return"TABLE"===(t&&t.nodeName||"")}function Oo(t){for(var e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],o=t.getData.apply(t,r),i=o.length,a=i>0?o[0].length:0,l=["<table>","</table>"],s=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,f=e?1:0,h=0;h<i;h+=1){for(var d=e&&0===h,p=[],y=0;y<a;y+=1){var v=!d&&n&&0===y,m="";if(d)m="<th>".concat(t.getColHeader(y-c),"</th>");else if(v)m="<th>".concat(t.getRowHeader(h-f),"</th>");else{var g=o[h][y],b=t.getCellMeta(h-f,y-c),w=b.hidden,S=b.rowspan,C=b.colspan;if(!w){var O=[];if(S&&O.push('rowspan="'.concat(S,'"')),C&&O.push('colspan="'.concat(C,'"')),ee(g))m="<td ".concat(O.join(" "),"></td>");else{var k=g.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");m="<td ".concat(O.join(" "),">").concat(k,"</td>")}}}p.push(m)}var R=["<tr>"].concat(p,["</tr>"]).join("");d?s.splice(1,0,R):u.splice(-1,0,R)}return l.splice(1,0,s.join(""),u.join("")),l.join("")}function ko(t){for(var e=t.length,n=["<table>"],r=0;r<e;r+=1){var o=t[r],i=o.length,a=[];0===r&&n.push("<tbody>");for(var l=0;l<i;l+=1){var s=o[l],u=ee(s)?"":s.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,(function(t){return'<span style="mso-spacerun: yes">'.concat("&nbsp;".repeat(t.length-1)," </span>")})).replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}n.push.apply(n,["<tr>"].concat(a,["</tr>"])),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function Ro(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n={},r=e.createDocumentFragment(),o=e.createElement("div");r.appendChild(o);var i=t;if("string"===typeof i){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(function(t){var e=t.match(/<td\b[^>]*?>/g)[0],n=t.substring(e.length,t.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),r="</td>";return"".concat(e).concat(n).concat(r)}));o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(i&&Co(i)){var l=o.querySelector('meta[name$="enerator"]'),s=null!==i.querySelector("tbody th"),u=i.querySelector("tr"),c=u?Array.from(u.cells).reduce((function(t,e){return t+e.colSpan}),0)-(s?1:0):0,f=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],d=!1,p=0,y=0;if(i.tHead){var v=Array.from(i.tHead.rows).filter((function(t){var e=null!==t.querySelector("td");return e&&h.push(t),!e}));p=v.length,d=p>0,p>1?n.nestedHeaders=Array.from(v).reduce((function(t,e){var n=Array.from(e.cells).reduce((function(t,e,n){if(s&&0===n)return t;var r=e.colSpan,o=e.innerHTML,i=r>1?{label:o,colspan:r}:o;return t.push(i),t}),[]);return t.push(n),t}),[]):d&&(n.colHeaders=Array.from(v[0].children).reduce((function(t,e,n){return s&&0===n||t.push(e.innerHTML),t}),[]))}h.length&&(n.fixedRowsTop=h.length),f.length&&(n.fixedRowsBottom=f.length);var m=[].concat(h,po(Array.from(i.tBodies).reduce((function(t,e){return t.push.apply(t,po(Array.from(e.rows))),t}),[])),po(f));y=m.length;for(var g=new Array(y),b=0;b<y;b++)g[b]=new Array(c);for(var w=[],S=[],C=0;C<y;C++)for(var O=m[C],k=Array.from(O.cells),R=k.length,E=0;E<R;E++){var P=k[E],T=P.nodeName,j=P.innerHTML,M=P.rowSpan,A=P.colSpan,I=g[C].findIndex((function(t){return void 0===t}));if("TD"===T){if(M>1||A>1){for(var x=C;x<C+M;x++)if(x<y)for(var _=I;_<I+A;_++)g[x][_]=null;var H=P.getAttribute("style"),N=H&&H.includes("mso-ignore:colspan");N||w.push({col:I,row:C,rowspan:M,colspan:A})}var D="";D=l&&/excel/gi.test(l.content)?j.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):j.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),g[C][I]=D.replace(So,(function(t){return wo[t]}))}else S.push(j)}return w.length&&(n.mergeCells=w),S.length&&(n.rowHeaders=S),g.length&&(n.data=g),n}}function Eo(t){return Mo(t)||jo(t)||To(t)||Po()}function Po(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function To(t,e){if(t){if("string"===typeof t)return Ao(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ao(t,e):void 0}}function jo(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Mo(t){if(Array.isArray(t))return Ao(t)}function Ao(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Io(t){return Io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Io(t)}function xo(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Io(t);if("number"===n)return!isNaN(t)&&isFinite(t);if("string"===n){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);var r=Array.from(new Set(["."].concat(Eo(e)))).map((function(t){return"\\".concat(t)})).join("|");return new RegExp("^[+-]?\\s*(((".concat(r,")?\\d+((").concat(r,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(t.trim())}return"object"===n&&(!!t&&"number"===typeof t.valueOf()&&!(t instanceof Date))}function _o(t){return xo(t,[","])}function Ho(t,e,n){var r=-1;"function"===typeof e?(n=e,e=t):r=t-1;while(++r<=e)if(!1===n(r))break}function No(t,e,n){var r=t+1;"function"===typeof e&&(n=e,e=0);while(--r>=e)if(!1===n(r))break}function Do(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Lo(t){return Fo(t)||Vo(t)||zo(t)||Bo()}function Bo(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Vo(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Fo(t){if(Array.isArray(t))return Go(t)}function Wo(t,e){return Ko(t)||Yo(t,e)||zo(t,e)||Uo()}function Uo(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function zo(t,e){if(t){if("string"===typeof t)return Go(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Go(t,e):void 0}}function Go(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Yo(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Ko(t){if(Array.isArray(t))return t}var Xo="asc",$o="desc",qo=new Map([[Xo,[-1,1]],[$o,[1,-1]]]),Qo=function(t){return"The priority '".concat(t,"' is already declared in a map.")},Jo=function(t){return"The priority '".concat(t,"' is not a number.")};function Zo(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.errorPriorityExists,n=t.errorPriorityNaN,r=new Map;function o(t,o){if(!xo(t))throw new Error(n(t));if(r.has(t))throw new Error(e(t));r.set(t,o)}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xo,e=qo.get(t)||qo.get(Xo),n=Wo(e,2),o=n[0],i=n[1];return Lo(r).sort((function(t,e){return t[0]<e[0]?o:i})).map((function(t){return t[1]}))}return e=_n(e)?e:Qo,n=_n(n)?n:Jo,{addItem:o,getItems:i}}n(5565);function ti(t){return ri(t)||ni(t)||ai(t)||ei()}function ei(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ni(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function ri(t){if(Array.isArray(t))return li(t)}function oi(t,e){return ui(t)||si(t,e)||ai(t,e)||ii()}function ii(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ai(t,e){if(t){if("string"===typeof t)return li(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?li(t,e):void 0}}function li(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function si(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ui(t){if(Array.isArray(t))return t}var ci=function(t){return"The id '".concat(t,"' is already declared in a map.")};function fi(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.errorIdExists,n=new Map;function r(t,r){if(u(t))throw new Error(e(t));n.set(t,r)}function o(t){return n.delete(t)}function i(){n.clear()}function a(t){var e=s().find((function(e){var n=oi(e,2),r=n[0],o=n[1];return t===o&&r}))||[null],n=oi(e,1),r=n[0];return r}function l(t){return n.get(t)}function s(){return ti(n)}function u(t){return n.has(t)}return e=_n(e)?e:ci,{addItem:r,clear:i,getId:a,getItem:l,getItems:s,hasItem:u,removeItem:o}}function hi(t){return vi(t)||yi(t)||pi(t)||di()}function di(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pi(t,e){if(t){if("string"===typeof t)return mi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mi(t,e):void 0}}function yi(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function vi(t){if(Array.isArray(t))return mi(t)}function mi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var gi=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function bi(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.errorItemExists,n=new Set;function r(t){if(n.has(t))throw new Error(e(t));n.add(t)}function o(){return hi(n)}function i(){n.clear()}return e=_n(e)?e:gi,{addItem:r,clear:i,getItems:o}}function wi(t,e){return Oi(t)||Ci(t,e)||Ei(t,e)||Si()}function Si(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ci(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Oi(t){if(Array.isArray(t))return t}function ki(t){return Ti(t)||Pi(t)||Ei(t)||Ri()}function Ri(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ei(t,e){if(t){if("string"===typeof t)return ji(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ji(t,e):void 0}}function Pi(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Ti(t){if(Array.isArray(t))return ji(t)}function ji(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Mi=function(t){return'There is already registered "'.concat(t,'" plugin.')},Ai=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},Ii=function(t){return'The priority "'.concat(t,'" is not a number.')},xi=Zo({errorPriorityExists:Ai,errorPriorityNaN:Ii}),_i=bi({errorItemExists:Mi}),Hi=fi({errorIdExists:Mi});function Ni(){return[].concat(ki(xi.getItems()),ki(_i.getItems()))}function Di(t){var e=be(t);return Hi.getItem(e)}function Li(t){return!!Di(t)}function Bi(t,e,n){var r=Fi(t,e,n),o=wi(r,3);t=o[0],e=o[1],n=o[2],void 0===Di(t)&&Vi(t,e,n)}function Vi(t,e,n){var r=be(t);if(Hi.hasItem(r))throw new Error(Mi(r));void 0===n?_i.addItem(r):xi.addItem(n,r),Hi.addItem(r,e)}function Fi(t,e,n){return"function"===typeof t&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}var Wi=Rr("renderers"),Ui=Wi.register,zi=Wi.getItem,Gi=Wi.hasItem,Yi=Wi.getNames;Wi.getValues;function Ki(t){if("function"===typeof t)return t;if(!Gi(t))throw Error('No registered renderer found under "'.concat(t,'" name'));return zi(t)}function Xi(t,e){"string"!==typeof t&&(e=t,t=e.RENDERER_TYPE),Ui(t,e)}var $i=Rr("validators"),qi=$i.register,Qi=$i.getItem,Ji=$i.hasItem,Zi=$i.getNames;$i.getValues;function ta(t){if("function"===typeof t)return t;if(!Ji(t))throw Error('No registered validator found under "'.concat(t,'" name'));return Qi(t)}function ea(t,e){"string"!==typeof t&&(e=t,t=e.VALIDATOR_TYPE),qi(t,e)}n(3462),n(4038);function na(t){return na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},na(t)}function ra(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,aa(r.key),r)}}function ia(t,e,n){return e&&oa(t.prototype,e),n&&oa(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function aa(t){var e=la(t,"string");return"symbol"===na(e)?e:String(e)}function la(t,e){if("object"!==na(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==na(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var sa=new WeakMap,ua=function(){function t(e,n,r,o,i,a){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;ra(this,t),this.wtSettings=r,this.domBindings=n,this.wtTable=i,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=e,sa.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return ia(t,[{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",(function(e){return t.onContextMenu(e)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",(function(e){return t.onMouseOut(e)}));var e=function(){t.eventManager.addEventListener(t.wtTable.holder,"touchstart",(function(e){return t.onTouchStart(e)})),t.eventManager.addEventListener(t.wtTable.holder,"touchend",(function(e){return t.onTouchEnd(e)})),t.momentumScrolling||(t.momentumScrolling={}),t.eventManager.addEventListener(t.wtTable.holder,"scroll",(function(){clearTimeout(t.momentumScrolling._timeout),t.momentumScrolling.ongoing||t.wtSettings.getSetting("onBeforeTouchScroll"),t.momentumScrolling.ongoing=!0,t.momentumScrolling._timeout=setTimeout((function(){t.touchApplied||(t.momentumScrolling.ongoing=!1,t.wtSettings.getSetting("onAfterMomentumScroll"))}),200)}))},n=function(){t.eventManager.addEventListener(t.wtTable.holder,"mouseup",(function(e){return t.onMouseUp(e)})),t.eventManager.addEventListener(t.wtTable.holder,"mousedown",(function(e){return t.onMouseDown(e)}))};Ht()?e():(I()&&e(),n())}},{key:"selectedCellWasTouched",value:function(t){var e=sa.get(this),n=this.parentCell(t),r=n.coords;if(e.selectedCellBeforeTouchEnd&&r){var o=[r.row,e.selectedCellBeforeTouchEnd.from.row],i=o[0],a=o[1],l=[r.col,e.selectedCellBeforeTouchEnd.from.col],s=l[0],u=l[1];return i===a&&s===u}return!1}},{key:"parentCell",value:function(t){var e={},n=this.wtTable.TABLE,r=De(t,["TD","TH"],n);return r?(e.coords=this.wtTable.getCoords(r),e.TD=r):ze(t,"wtBorder")&&ze(t,"current")?(e.coords=this.selections.getCell().cellRange.highlight,e.TD=this.wtTable.getCell(e.coords)):ze(t,"wtBorder")&&ze(t,"area")&&this.selections.createOrGetArea().cellRange&&(e.coords=this.selections.createOrGetArea().cellRange.to,e.TD=this.wtTable.getCell(e.coords)),e}},{key:"onMouseDown",value:function(t){var e=sa.get(this),n=this.domBindings.rootDocument.activeElement,r=Bn(Ie,t.target),o=t.target;if(o!==n&&r(0)!==n&&r(1)!==n){var i=this.parentCell(o);ze(o,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",t,o):i.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,i.coords,i.TD),(0===t.button||this.touchApplied)&&i.TD&&(e.dblClickOrigin[0]=i.TD,clearTimeout(e.dblClickTimeout[0]),e.dblClickTimeout[0]=setTimeout((function(){e.dblClickOrigin[0]=null}),1e3))}}},{key:"onContextMenu",value:function(t){if(this.wtSettings.has("onCellContextMenu")){var e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}},{key:"onMouseOver",value:function(t){if(this.wtSettings.has("onCellMouseOver")){var e=this.wtTable.TABLE,n=De(t.target,["TD","TH"],e),r=this.parent||this;n&&n!==r.lastMouseOver&&Le(n,e)&&(r.lastMouseOver=n,this.callListener("onCellMouseOver",t,this.wtTable.getCoords(n),n))}}},{key:"onMouseOut",value:function(t){if(this.wtSettings.has("onCellMouseOut")){var e=this.wtTable.TABLE,n=De(t.target,["TD","TH"],e),r=De(t.relatedTarget,["TD","TH"],e),o=this.parent||this;n&&n!==r&&Le(n,e)&&(this.callListener("onCellMouseOut",t,this.wtTable.getCoords(n),n),null===r&&(o.lastMouseOver=null))}}},{key:"onMouseUp",value:function(t){var e=sa.get(this),n=this.parentCell(t.target);n.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,n.coords,n.TD),(0===t.button||this.touchApplied)&&(n.TD===e.dblClickOrigin[0]&&n.TD===e.dblClickOrigin[1]?(ze(t.target,"corner")?this.callListener("onCellCornerDblClick",t,n.coords,n.TD):this.callListener("onCellDblClick",t,n.coords,n.TD),e.dblClickOrigin[0]=null,e.dblClickOrigin[1]=null):n.TD===e.dblClickOrigin[0]&&(e.dblClickOrigin[1]=n.TD,clearTimeout(e.dblClickTimeout[1]),e.dblClickTimeout[1]=setTimeout((function(){e.dblClickOrigin[1]=null}),500)))}},{key:"onTouchStart",value:function(t){var e=sa.get(this);e.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(t)}},{key:"onTouchEnd",value:function(t){var e,n=t.target,r=null===(e=this.parentCell(n))||void 0===e?void 0:e.coords,o=Zt(r)&&r.row>=0&&r.col>=0,i=t.cancelable&&o&&this.wtSettings.getSetting("isDataViewInstance");if(i){var a=["A","BUTTON","INPUT"];Nt()&&(Et()||Tt())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?t.preventDefault():this.selectedCellWasTouched(n)||t.preventDefault()}this.onMouseUp(t),this.touchApplied=!1}},{key:"callListener",value:function(t,e,n,r){var o=this.wtSettings.getSettingPure(t);o&&o(e,n,r,this.facadeGetter())}},{key:"destroy",value:function(){var t=sa.get(this);clearTimeout(t.dblClickTimeout[0]),clearTimeout(t.dblClickTimeout[1]),this.eventManager.destroy()}}]),t}(),ca=ua;function fa(t){return fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fa(t)}function ha(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function da(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ya(r.key),r)}}function pa(t,e,n){return e&&da(t.prototype,e),n&&da(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ya(t){var e=va(t,"string");return"symbol"===fa(e)?e:String(e)}function va(t,e){if("object"!==fa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==fa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ma=function(){function t(e,n,r){ha(this,t),this.offset=e,this.total=n,this.countTH=r}return pa(t,[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]),t}(),ga=ma;function ba(t){return ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ba(t)}function wa(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Oa(r.key),r)}}function Ca(t,e,n){return e&&Sa(t.prototype,e),n&&Sa(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Oa(t){var e=ka(t,"string");return"symbol"===ba(e)?e:String(e)}function ka(t,e){if("object"!==ba(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ba(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Ra=function(){function t(e,n,r){wa(this,t),this.offset=e,this.total=n,this.countTH=r}return Ca(t,[{key:"offsetted",value:function(t){return t+this.offset}},{key:"unOffsetted",value:function(t){return t-this.offset}},{key:"renderedToSource",value:function(t){return this.offsetted(t)}},{key:"sourceToRendered",value:function(t){return this.unOffsetted(t)}},{key:"offsettedTH",value:function(t){return t-this.countTH}},{key:"unOffsettedTH",value:function(t){return t+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(t){return this.renderedToSource(this.offsettedTH(t))}},{key:"sourceRowToVisibleColHeadedRow",value:function(t){return this.unOffsettedTH(this.sourceToRendered(t))}}]),t}(),Ea=Ra,Pa=0,Ta=1,ja=2;function Ma(t){return Ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ma(t)}function Aa(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ia(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_a(r.key),r)}}function xa(t,e,n){return e&&Ia(t.prototype,e),n&&Ia(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _a(t){var e=Ha(t,"string");return"symbol"===Ma(e)?e:String(e)}function Ha(t,e){if("object"!==Ma(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ma(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Na=function(){function t(){Aa(this,t),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return xa(t,[{key:"setSize",value:function(t){this.currentSize=this.nextSize,this.nextSize=t}},{key:"setOffset",value:function(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}]),t}();function Da(t){return Da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Da(t)}function La(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ba(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Fa(r.key),r)}}function Va(t,e,n){return e&&Ba(t.prototype,e),n&&Ba(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fa(t){var e=Wa(t,"string");return"symbol"===Da(e)?e:String(e)}function Wa(t,e){if("object"!==Da(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Da(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Ua=function(){function t(){La(this,t),this.size=new Na,this.workingSpace=Pa,this.sharedSize=null}return Va(t,[{key:"setSize",value:function(t){this.size.setSize(t)}},{key:"setOffset",value:function(t){this.size.setOffset(t)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof Na}},{key:"isPlaceOn",value:function(t){return this.workingSpace===t}},{key:"append",value:function(t){this.workingSpace=Ta,t.workingSpace=ja,this.sharedSize=t.getViewSize()}},{key:"prepend",value:function(t){this.workingSpace=ja,t.workingSpace=Ta,this.sharedSize=t.getViewSize()}}]),t}();function za(t){return za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},za(t)}function Ga(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ya(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Xa(r.key),r)}}function Ka(t,e,n){return e&&Ya(t.prototype,e),n&&Ya(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Xa(t){var e=$a(t,"string");return"symbol"===za(e)?e:String(e)}function $a(t,e){if("object"!==za(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==za(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var qa=function(){function t(e,n,r){Ga(this,t),this.rootNode=e,this.nodesPool=n,this.sizeSet=new Ua,this.childNodeType=r.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return Ka(t,[{key:"setSize",value:function(t){return this.sizeSet.setSize(t),this}},{key:"setOffset",value:function(t){return this.sizeSet.setOffset(t),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}},{key:"getCurrentNode",value:function(){var t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}},{key:"getRenderedChildCount",value:function(){var t=this.rootNode,e=this.sizeSet,n=0;if(this.isSharedViewSet()){var r=t.firstElementChild;while(r){if(r.tagName===this.childNodeType)n+=1;else if(e.isPlaceOn(Ta))break;r=r.nextElementSibling}}else n=t.childElementCount;return n}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;var t=this.rootNode,e=this.sizeSet,n=this.isSharedViewSet(),r=e.getViewSize(),o=r.nextSize,i=this.getRenderedChildCount();while(i<o){var a=this.nodesPool();!n||n&&e.isPlaceOn(ja)?t.appendChild(a):t.insertBefore(a,t.firstChild),i+=1}var l=n&&e.isPlaceOn(Ta);while(i>o)t.removeChild(l?t.firstChild:t.lastChild),i-=1}},{key:"render",value:function(){var t=this.rootNode,e=this.sizeSet,n=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(ja)&&(n+=e.sharedSize.nextSize);var r=t.childNodes[n];if(r.tagName!==this.childNodeType){var o=this.nodesPool();t.replaceChild(o,r),r=o}this.collectedNodes.push(r),this.visualIndex+=1}},{key:"end",value:function(){}}]),t}();function Qa(t){return Qa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qa(t)}function Ja(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Za(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,el(r.key),r)}}function tl(t,e,n){return e&&Za(t.prototype,e),n&&Za(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function el(t){var e=nl(t,"string");return"symbol"===Qa(e)?e:String(e)}function nl(t,e){if("object"!==Qa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Qa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function rl(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ol(t,e)}function ol(t,e){return ol=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ol(t,e)}function il(t){var e=sl();return function(){var n,r=ul(t);if(e){var o=ul(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return al(this,n)}}function al(t,e){if(e&&("object"===Qa(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ll(t)}function ll(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sl(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function ul(t){return ul=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ul(t)}var cl=function(t){rl(n,t);var e=il(n);function n(){return Ja(this,n),e.apply(this,arguments)}return tl(n,[{key:"prependView",value:function(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}]),n}(qa);function fl(t){return fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fl(t)}function hl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yl(r.key),r)}}function pl(t,e,n){return e&&dl(t.prototype,e),n&&dl(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function yl(t){var e=vl(t,"string");return"symbol"===fl(e)?e:String(e)}function vl(t,e){if("object"!==fl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==fl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ml=function(){function t(e){hl(this,t),this.nodeType=e.toUpperCase()}return pl(t,[{key:"setRootDocument",value:function(t){this.rootDocument=t}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),t}();function gl(t){return gl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gl(t)}function bl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Cl(r.key),r)}}function Sl(t,e,n){return e&&wl(t.prototype,e),n&&wl(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cl(t){var e=Ol(t,"string");return"symbol"===gl(e)?e:String(e)}function Ol(t,e){if("object"!==gl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==gl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var kl=function(){function t(e,n){bl(this,t),this.nodesPool="string"===typeof e?new ml(e):null,this.nodeType=e,this.rootNode=n,this.table=null,this.renderedNodes=0}return Sl(t,[{key:"setTable",value:function(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),t}();function Rl(t){return Rl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rl(t)}function El(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,jl(r.key),r)}}function Tl(t,e,n){return e&&Pl(t.prototype,e),n&&Pl(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function jl(t){var e=Ml(t,"string");return"symbol"===Rl(e)?e:String(e)}function Ml(t,e){if("object"!==Rl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Rl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Al(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Il(t,e)}function Il(t,e){return Il=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Il(t,e)}function xl(t){var e=Nl();return function(){var n,r=Dl(t);if(e){var o=Dl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _l(this,n)}}function _l(t,e){if(e&&("object"===Rl(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Hl(t)}function Hl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Nl(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Dl(t){return Dl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Dl(t)}var Ll=function(t){Al(n,t);var e=xl(n);function n(){var t;return El(this,n),t=e.call(this,"TH"),t.orderViews=new WeakMap,t.sourceRowIndex=0,t}return Tl(n,[{key:"obtainOrderView",value:function(t){var e,n=this;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new cl(t,(function(t){return n.nodesPool.obtain(n.sourceRowIndex,t)}),this.nodeType),this.orderViews.set(t,e)),e}},{key:"render",value:function(){for(var t=this.table,e=t.rowsToRender,n=t.rowHeaderFunctions,r=t.rowHeadersCount,o=t.rows,i=t.cells,a=0;a<e;a++){var l=this.table.renderedRowToSource(a),s=o.getRenderedNode(a);this.sourceRowIndex=l;var u=this.obtainOrderView(s),c=i.obtainOrderView(s);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(var f=0;f<r;f++){u.render();var h=u.getCurrentNode();h.className="",h.removeAttribute("style"),n[f](l,h,f)}u.end()}}}]),n}(kl);function Bl(t){return Bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bl(t)}function Vl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ul(r.key),r)}}function Wl(t,e,n){return e&&Fl(t.prototype,e),n&&Fl(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ul(t){var e=zl(t,"string");return"symbol"===Bl(e)?e:String(e)}function zl(t,e){if("object"!==Bl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Bl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Gl(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yl(t,e)}function Yl(t,e){return Yl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Yl(t,e)}function Kl(t){var e=ql();return function(){var n,r=Ql(t);if(e){var o=Ql(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Xl(this,n)}}function Xl(t,e){if(e&&("object"===Bl(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return $l(t)}function $l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ql(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Ql(t){return Ql=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ql(t)}var Jl=function(t){Gl(n,t);var e=Kl(n);function n(t){return Vl(this,n),e.call(this,null,t)}return Wl(n,[{key:"adjust",value:function(){var t=this.table,e=t.columnHeadersCount,n=t.rowHeadersCount,r=this.rootNode.firstChild;if(e){for(var o=this.table.columnsToRender,i=o+n,a=0,l=e;a<l;a++){r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;while(this.renderedNodes<i)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;while(this.renderedNodes>i)r.removeChild(r.lastChild),this.renderedNodes-=1}var s=this.rootNode.childNodes.length;if(s>e)for(var u=e;u<s;u++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Xe(r)}},{key:"render",value:function(){for(var t=this.table.columnHeadersCount,e=0;e<t;e+=1)for(var n=this.table,r=n.columnHeaderFunctions,o=n.columnsToRender,i=n.rowHeadersCount,a=this.rootNode.childNodes[e],l=-1*i;l<o;l+=1){var s=this.table.renderedColumnToSource(l),u=a.childNodes[l+i];u.className="",u.removeAttribute("style"),r[e](s,u,e)}}}]),n}(kl);function Zl(t){return Zl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zl(t)}function ts(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function es(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,rs(r.key),r)}}function ns(t,e,n){return e&&es(t.prototype,e),n&&es(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function rs(t){var e=os(t,"string");return"symbol"===Zl(e)?e:String(e)}function os(t,e){if("object"!==Zl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Zl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function is(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&as(t,e)}function as(t,e){return as=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},as(t,e)}function ls(t){var e=cs();return function(){var n,r=fs(t);if(e){var o=fs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ss(this,n)}}function ss(t,e){if(e&&("object"===Zl(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return us(t)}function us(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cs(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function fs(t){return fs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fs(t)}var hs,ds=function(t){is(n,t);var e=ls(n);function n(t){return ts(this,n),e.call(this,null,t)}return ns(n,[{key:"adjust",value:function(){var t=this.table,e=t.columnsToRender,n=t.rowHeadersCount,r=e+n;while(this.renderedNodes<r)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;while(this.renderedNodes>r)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var t=this.table,e=t.columnsToRender,n=t.rowHeadersCount,r=0;r<n;r++){var o=this.table.renderedColumnToSource(r),i=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[r].style.width="".concat(i,"px")}for(var a=0;a<e;a++){var l=this.table.renderedColumnToSource(a),s=this.table.columnUtils.getStretchedColumnWidth(l);this.rootNode.childNodes[a+n].style.width="".concat(s,"px")}var u=this.rootNode.firstChild;u&&Ge(u,"rowHeader")}}]),n}(kl);function ps(t){return ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ps(t)}function ys(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function vs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ms(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bs(r.key),r)}}function gs(t,e,n){return e&&ms(t.prototype,e),n&&ms(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function bs(t){var e=ws(t,"string");return"symbol"===ps(e)?e:String(e)}function ws(t,e){if("object"!==ps(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ps(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ss(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cs(t,e)}function Cs(t,e){return Cs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Cs(t,e)}function Os(t){var e=Es();return function(){var n,r=Ps(t);if(e){var o=Ps(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ks(this,n)}}function ks(t,e){if(e&&("object"===ps(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Rs(t)}function Rs(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Es(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Ps(t){return Ps=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ps(t)}var Ts=!1,js=function(t){Ss(n,t);var e=Os(n);function n(t){var r;return vs(this,n),r=e.call(this,"TR",t),r.orderView=new qa(t,(function(t){return r.nodesPool.obtain(t)}),r.nodeType),r}return gs(n,[{key:"getRenderedNode",value:function(t){return this.orderView.getNode(t)}},{key:"render",value:function(){var t=this.table.rowsToRender;!Ts&&t>1e3&&(Ts=!0,er($t(hs||(hs=ys(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting \n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20\n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.']))))),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(var e=0;e<t;e++)this.orderView.render();this.orderView.end()}}]),n}(kl);function Ms(t){return Ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ms(t)}function As(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Is(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_s(r.key),r)}}function xs(t,e,n){return e&&Is(t.prototype,e),n&&Is(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _s(t){var e=Hs(t,"string");return"symbol"===Ms(e)?e:String(e)}function Hs(t,e){if("object"!==Ms(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ms(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ns(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ds(t,e)}function Ds(t,e){return Ds=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ds(t,e)}function Ls(t){var e=Fs();return function(){var n,r=Ws(t);if(e){var o=Ws(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Bs(this,n)}}function Bs(t,e){if(e&&("object"===Ms(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Vs(t)}function Vs(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fs(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Ws(t){return Ws=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ws(t)}var Us=function(t){Ns(n,t);var e=Ls(n);function n(){var t;return As(this,n),t=e.call(this,"TD"),t.orderViews=new WeakMap,t.sourceRowIndex=0,t}return xs(n,[{key:"obtainOrderView",value:function(t){var e,n=this;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new cl(t,(function(t){return n.nodesPool.obtain(n.sourceRowIndex,t)}),this.nodeType),this.orderViews.set(t,e)),e}},{key:"render",value:function(){for(var t=this.table,e=t.rowsToRender,n=t.columnsToRender,r=t.rows,o=t.rowHeaders,i=0;i<e;i++){var a=this.table.renderedRowToSource(i),l=r.getRenderedNode(i);this.sourceRowIndex=a;var s=this.obtainOrderView(l),u=o.obtainOrderView(l);s.prependView(u).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var c=0;c<n;c++){s.render();var f=s.getCurrentNode(),h=this.table.renderedColumnToSource(c);ze(f,"hide")||(f.className=""),f.removeAttribute("style"),f.removeAttribute("dir"),this.table.cellRenderer(a,h,f)}s.end()}}}]),n}(kl);function zs(t){return zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zs(t)}function Gs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ys(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Xs(r.key),r)}}function Ks(t,e,n){return e&&Ys(t.prototype,e),n&&Ys(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Xs(t){var e=$s(t,"string");return"symbol"===zs(e)?e:String(e)}function $s(t,e){if("object"!==zs(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==zs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var qs=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.cellRenderer;Gs(this,t),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=r}return Ks(t,[{key:"setAxisUtils",value:function(t,e){this.rowUtils=t,this.columnUtils=e}},{key:"setViewportSize",value:function(t,e){this.rowsToRender=t,this.columnsToRender=e}},{key:"setFilters",value:function(t,e){this.rowFilter=t,this.columnFilter=e}},{key:"setHeaderContentRenderers",value:function(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}},{key:"setRenderers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.rowHeaders,n=t.columnHeaders,r=t.colGroup,o=t.rows,i=t.cells;e.setTable(this),n.setTable(this),r.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=o,this.cells=i}},{key:"renderedRowToSource",value:function(t){return this.rowFilter.renderedToSource(t)}},{key:"renderedColumnToSource",value:function(t){return this.columnFilter.renderedToSource(t)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var t=this.rowsToRender,e=this.rows,n=0;n<t;n++){var r=e.getRenderedNode(n);if(r.firstChild){var o=this.renderedRowToSource(n),i=this.rowUtils.getHeight(o);r.firstChild.style.height=i?"".concat(i-1,"px"):""}}}}]),t}();function Qs(t){return Qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qs(t)}function Js(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,eu(r.key),r)}}function tu(t,e,n){return e&&Zs(t.prototype,e),n&&Zs(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function eu(t){var e=nu(t,"string");return"symbol"===Qs(e)?e:String(e)}function nu(t,e){if("object"!==Qs(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Qs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ru=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.TABLE,r=e.THEAD,o=e.COLGROUP,i=e.TBODY,a=e.rowUtils,l=e.columnUtils,s=e.cellRenderer;Js(this,t),this.renderer=new qs(n,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new Ll,columnHeaders:new Jl(r),colGroup:new ds(o),rows:new js(i),cells:new Us}),this.renderer.setAxisUtils(a,l)}return tu(t,[{key:"setFilters",value:function(t,e){return this.renderer.setFilters(t,e),this}},{key:"setViewportSize",value:function(t,e){return this.renderer.setViewportSize(t,e),this}},{key:"setHeaderContentRenderers",value:function(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),t}();function ou(t){return ou="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ou(t)}function iu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function au(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,su(r.key),r)}}function lu(t,e,n){return e&&au(t.prototype,e),n&&au(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function su(t){var e=uu(t,"string");return"symbol"===ou(e)?e:String(e)}function uu(t,e){if("object"!==ou(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ou(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var cu=function(){function t(e,n){iu(this,t),this.dataAccessObject=e,this.wtSettings=n,this.headerWidths=new Map}return lu(t,[{key:"getWidth",value:function(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(t){var e=this.dataAccessObject.wtViewport.columnsRenderCalculator,n=this.getWidth(t);if(e){var r=e.getStretchedColumnWidth(t,n);r&&(n=r)}return n}},{key:"getHeaderHeight",value:function(t){var e=this.wtSettings.getSetting("defaultRowHeight"),n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==n&&(e=e?Math.max(e,n):n),e}},{key:"getHeaderWidth",value:function(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}},{key:"calculateWidths",value:function(){var t=this.wtSettings,e=this.dataAccessObject,n=e.wtTable,r=e.wtViewport,o=e.cloneSource,i=o?o.wtTable.holder:n.holder,a=i.offsetHeight<i.scrollHeight?On():0,l=t.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-a),l=t.getSetting("onModifyRowHeaderWidth",l),null!==l&&void 0!==l)for(var s=t.getSetting("rowHeaders").length,u=t.getSetting("defaultColumnWidth"),c=0;c<s;c++){var f=Array.isArray(l)?l[c]:l;f=null===f||void 0===f?u:f,this.headerWidths.set(c,f)}}}]),t}();function fu(t){return fu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fu(t)}function hu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function du(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yu(r.key),r)}}function pu(t,e,n){return e&&du(t.prototype,e),n&&du(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function yu(t){var e=vu(t,"string");return"symbol"===fu(e)?e:String(e)}function vu(t,e){if("object"!==fu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==fu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var mu=function(){function t(e,n){hu(this,t),this.dataAccessObject=e,this.wtSettings=n}return pu(t,[{key:"getHeight",value:function(t){var e=this.wtSettings.getSetting("rowHeight",t),n=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==n&&(e=void 0===e?n:Math.max(e,n)),e}}]),t}(),gu="top",bu="bottom",wu="inline_start",Su="top_inline_start_corner",Cu="bottom_inline_start_corner",Ou=[gu,bu,wu,Su,Cu],ku=new Map([[gu,"ht_clone_".concat(gu)],[bu,"ht_clone_".concat(bu)],[wu,"ht_clone_".concat(wu," ht_clone_left")],[Su,"ht_clone_".concat(Su," ht_clone_top_left_corner")],[Cu,"ht_clone_".concat(Cu," ht_clone_bottom_left_corner")]]);function Ru(t){return Ru="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ru(t)}function Eu(t){return ju(t)||Tu(t)||Iu(t)||Pu()}function Pu(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Tu(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function ju(t){if(Array.isArray(t))return xu(t)}function Mu(t,e){return Hu(t)||_u(t,e)||Iu(t,e)||Au()}function Au(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Iu(t,e){if(t){if("string"===typeof t)return xu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xu(t,e):void 0}}function xu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _u(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Hu(t){if(Array.isArray(t))return t}function Nu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Du(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vu(r.key),r)}}function Lu(t,e,n){return e&&Du(t.prototype,e),n&&Du(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Bu(t,e,n){return e=Vu(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vu(t){var e=Fu(t,"string");return"symbol"===Ru(e)?e:String(e)}function Fu(t,e){if("object"!==Ru(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ru(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Wu=function(){function t(e,n,r,o,i){var a=this;Nu(this,t),Bu(this,"wtSettings",null),Bu(this,"domBindings",void 0),Bu(this,"TBODY",null),Bu(this,"THEAD",null),Bu(this,"COLGROUP",null),Bu(this,"hasTableHeight",!0),Bu(this,"hasTableWidth",!0),Bu(this,"isTableVisible",!1),Bu(this,"tableOffset",0),Bu(this,"holderOffset",0),this.domBindings=r,this.isMaster="master"===i,this.name=i,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,Ke(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var l=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(function(){return a._modifyRowHeaderWidth(l)})),this.rowUtils=new mu(this.dataAccessObject,this.wtSettings),this.columnUtils=new cu(this.dataAccessObject,this.wtSettings),this.tableRenderer=new ru({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return Lu(t,[{key:"is",value:function(t){return this.name===t}},{key:"fixTableDomTree",value:function(){var t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(t){var e,n=t.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&ze(n,"wtHolder")||(e=this.domBindings.rootDocument.createElement("div"),e.className="wtSpreader",n&&n.insertBefore(e,t),e.appendChild(t)),e.style.position="relative",e}},{key:"createHider",value:function(t){var e,n=t.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&ze(n,"wtHolder")||(e=this.domBindings.rootDocument.createElement("div"),e.className="wtHider",n&&n.insertBefore(e,t),e.appendChild(t)),e}},{key:"createHolder",value:function(t){var e,n=t.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&ze(n,"wtHolder")||(e=this.domBindings.rootDocument.createElement("div"),e.style.position="relative",e.className="wtHolder",n&&n.insertBefore(e,t),this.isMaster&&(e.parentNode.className+="ht_master handsontable",e.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),e.appendChild(t)),e}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.wtSettings,n=this.dataAccessObject,r=n.wtOverlays,o=n.wtViewport,i=e.getSetting("totalRows"),a=e.getSetting("totalColumns"),l=e.getSetting("rowHeaders"),s=l.length,u=e.getSetting("columnHeaders"),c=u.length,f=!1,h=t;if(this.isMaster&&(this.holderOffset=tn(this.holder),h=o.createRenderCalculators(h),s&&!e.getSetting("fixedColumnsStart"))){var d=r.inlineStartOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=0!==d,p!==this.correctHeaderWidth&&(h=!1)}if(this.isMaster&&(f=r.updateStateOfRendering()),h)this.isMaster&&o.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=tn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var y=i>0?this.getFirstRenderedRow():0,v=a>0?this.getFirstRenderedColumn():0;this.rowFilter=new Ea(y,i,c),this.columnFilter=new ga(v,a,s);var m,g=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var b={};this.wtSettings.getSetting("beforeDraw",!0,b),g=!0!==b.skipRender}if(g)if(this.tableRenderer.setHeaderContentRenderers(l,u),(this.is(bu)||this.is(Cu))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(m=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(bu))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var w=fn(this.hider),S=fn(this.TABLE);0!==w&&S!==w&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),m!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(bu)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}var C=!1;return this.isMaster&&(C=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(C=r.bottomOverlay.resetFixedPosition()||C),C=r.inlineStartOverlay.resetFixedPosition()||C,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),C?(r.refreshAll(),r.adjustElementsSize()):this.refreshSelections(h),f&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(t){var e,n,r,o=this.columnFilter.renderedToSource(t),i=this.wtSettings.getSetting("columnHeaders").length,a=this.wtSettings.getSetting("defaultRowHeight"),l=this.wtSettings.getSetting("columnHeaderHeight")||[];while(i)i-=1,e=this.getColumnHeaderHeight(i),n=this.getColumnHeader(o,i),n&&(r=dn(n),(!e&&a<r||e<r)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=r),Array.isArray(l)?null!==l[i]&&void 0!==l[i]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(l[i]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]||l))}},{key:"adjustColumnHeaderHeights",value:function(){for(var t=this.wtSettings,e=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=t.getSetting("columnHeaders"),o=0,i=r.length;o<i;o++)if(n[o]){if(!e[o]||0===e[o].childNodes.length)return;e[o].childNodes[0].style.height="".concat(n[o],"px")}}},{key:"resetOversizedRows",value:function(){var t=this.wtSettings,e=this.dataAccessObject.wtViewport;if((this.isMaster||this.is(bu))&&!t.getSetting("externalRowCalculator"))for(var n=this.getRenderedRowsCount(),r=0;r<n;r++){var o=this.rowFilter.renderedToSource(r);e.oversizedRows&&e.oversizedRows[o]&&(e.oversizedRows[o]=void 0)}}},{key:"removeClassFromCells",value:function(t){for(var e=this.TABLE.querySelectorAll(".".concat(t)),n=0,r=e.length;n<r;n++)Ye(e[n],t)}},{key:"refreshSelections",value:function(t){var e=this.wtSettings,n=this.dataAccessObject.selections;if(n){var r=Array.from(n),o=r.length;if(t){for(var i=[],a=0;a<o;a++){for(var l=r[a].settings,s=l.highlightHeaderClassName,u=l.highlightRowClassName,c=l.highlightColumnClassName,f=r[a].classNames,h=f.length,d=0;d<h;d++)i.includes(f[d])||i.push(f[d]);s&&!i.includes(s)&&i.push(s),u&&!i.includes(u)&&i.push(u),c&&!i.includes(c)&&i.push(c)}var p=e.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(p))for(var y=0;y<p.length;y++)i.push(p[y]);for(var v=i.length,m=0;m<v;m++)this.removeClassFromCells(i[m])}for(var g=0;g<o;g++)r[g].draw(this.facadeGetter(),t)}}},{key:"getCell",value:function(t){var e=t.row,n=t.col,r=this.wtSettings.getSetting("onModifyGetCellCoords",e,n);if(r&&Array.isArray(r)){var o=Mu(r,2);e=o[0],n=o[1]}if(this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;var i=this.getRow(e);if(!i&&e>=0)throw new Error("TR was expected to be rendered but is not");var a=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!a&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}},{key:"getRow",value:function(t){var e,n,r=null,o=null;t<0?(r=null===(e=this.rowFilter)||void 0===e?void 0:e.sourceRowToVisibleColHeadedRow(t),o=this.THEAD):(r=null===(n=this.rowFilter)||void 0===n?void 0:n.sourceToRendered(t),o=this.TBODY);return void 0!==r&&void 0!==o&&(!(o.childNodes.length<r+1)&&o.childNodes[r])}},{key:"getColumnHeader",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.THEAD.childNodes[e];return null===n||void 0===n?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}},{key:"getColumnHeaders",value:function(t){var e=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach((function(t){var r=t.childNodes[n];r&&e.push(r)})),e}},{key:"getRowHeader",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0!==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)){var n=this.wtSettings.getSetting("rowHeaders").length;if(!(e>=n)){var r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)];return null===r||void 0===r?void 0:r.childNodes[e]}}}},{key:"getRowHeaders",value:function(t){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return[];for(var e=[],n=this.wtSettings.getSetting("rowHeaders").length,r=0;r<n;r++){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],i=null===o||void 0===o?void 0:o.childNodes[r];i&&e.push(i)}return e}},{key:"getCoords",value:function(t){var e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=Ne(e,["TD","TH"])),null===e)return null;var n=e.parentNode,r=n.parentNode,o=Be(n),i=e.cellIndex;if(Ve(Su,e,this.wtRootElement)||Ve(gu,e,this.wtRootElement))"THEAD"===r.nodeName&&(o-=r.childNodes.length);else if(Ve(Cu,e,this.wtRootElement)||Ve(bu,e,this.wtRootElement)){var a=this.wtSettings.getSetting("totalRows");o=a-r.childNodes.length+o}else o=r===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter.renderedToSource(o);return i=Ve(Su,e,this.wtRootElement)||Ve(wu,e,this.wtRootElement)||Ve(Cu,e,this.wtRootElement)?this.columnFilter.offsettedTH(i):this.columnFilter.visibleRowHeadedColumnToSourceColumn(i),this.wot.createCellCoords(o,i)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var t,e,n,r,o,i=this.TBODY.childNodes.length,a=i*this.wtSettings.getSetting("defaultRowHeight"),l=dn(this.TBODY)-1;if(a!==l||this.wtSettings.getSetting("fixedRowsBottom"))while(i)i-=1,n=this.rowFilter.renderedToSource(i),t=this.getRowHeight(n),r=this.getTrForRow(n),o=r.querySelector("th"),e=o?dn(o):dn(r)-1,(!t&&this.wtSettings.getSetting("defaultRowHeight")<e||t<e)&&(e+=1,this.dataAccessObject.wtViewport.oversizedRows[n]=e)}}},{key:"getTrForRow",value:function(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}},{key:"isColumnHeaderRendered",value:function(t){if(t>=0)return!1;var e=this.wtSettings.getSetting("rowHeaders"),n=e.length;return Math.abs(t)<=n}},{key:"isRowHeaderRendered",value:function(t){if(t>=0)return!1;var e=this.wtSettings.getSetting("columnHeaders"),n=e.length;return Math.abs(t)<=n}},{key:"isRowBeforeRenderedRows",value:function(t){var e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}},{key:"isRowAfterRenderedRows",value:function(t){return t>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(t){var e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}},{key:"isColumnAfterRenderedColumns",value:function(t){return this.columnFilter&&t>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(t){return this.columnFilter&&t>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(t){return this.rowFilter&&t>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(t){return this.rowUtils.getHeight(t)}},{key:"getColumnHeaderHeight",value:function(t){return this.columnUtils.getHeaderHeight(t)}},{key:"getColumnWidth",value:function(t){return this.columnUtils.getWidth(t)}},{key:"getStretchedColumnWidth",value:function(t){return this.columnUtils.getStretchedColumnWidth(t)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return fn(this.TABLE)}},{key:"getHeight",value:function(){return hn(this.TABLE)}},{key:"getTotalWidth",value:function(){var t=fn(this.hider);return 0!==t?t:this.getWidth()}},{key:"getTotalHeight",value:function(){var t=hn(this.hider);return 0!==t?t:this.getHeight()}},{key:"isVisible",value:function(){return Ze(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(t){var e=_n(t)?t():null;return Array.isArray(e)?(e=Eu(e),e[e.length-1]=this._correctRowHeaderWidth(e[e.length-1])):e=this._correctRowHeaderWidth(e),e}},{key:"_correctRowHeaderWidth",value:function(t){var e=t;return"number"!==typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}]),t}(),Uu=Wu,zu="stickyRowsTop",Gu={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return 0===t?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};dt(Gu,"MIXIN_NAME",zu,{writable:!1,enumerable:!1});var Yu=Gu,Ku="calculatedColumns",Xu={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};dt(Xu,"MIXIN_NAME",Ku,{writable:!1,enumerable:!1});var $u=Xu;function qu(t){return qu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qu(t)}function Qu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Zu(r.key),r)}}function Ju(t,e,n){return e&&Qu(t.prototype,e),n&&Qu(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zu(t){var e=tc(t,"string");return"symbol"===qu(e)?e:String(e)}function tc(t,e){if("object"!==qu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==qu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ec(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nc(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rc(t,e)}function rc(t,e){return rc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},rc(t,e)}function oc(t){var e=lc();return function(){var n,r=sc(t);if(e){var o=sc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ic(this,n)}}function ic(t,e){if(e&&("object"===qu(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ac(t)}function ac(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lc(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function sc(t){return sc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sc(t)}var uc=function(t){nc(n,t);var e=oc(n);function n(t,r,o,i){return ec(this,n),e.call(this,t,r,o,i,gu)}return Ju(n)}(Uu);ct(uc,Yu),ct(uc,$u);var cc=uc;function fc(t){return fc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fc(t)}function hc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vc(r.key),r)}}function pc(t,e,n){return e&&dc(t.prototype,e),n&&dc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function yc(t,e,n){return e=vc(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vc(t){var e=mc(t,"string");return"symbol"===fc(e)?e:String(e)}function mc(t,e){if("object"!==fc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==fc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var gc=function(){function t(e){hc(this,t),yc(this,"dataAccessObject",void 0),yc(this,"lastScrolledColumnPos",-1),yc(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}return pc(t,[{key:"scrollViewport",value:function(t,e,n,r,o){var i=this.scrollViewportHorizontally(t.col,n,o),a=this.scrollViewportVertically(t.row,e,r);return i||a}},{key:"scrollViewportHorizontally",value:function(t,e,n){var r=this.dataAccessObject,o=r.drawn,i=r.totalColumns;if(!o||!Number.isInteger(t)||t<0||t>i)return!1;var a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn(),s=void 0===e&&void 0===n,u=this.dataAccessObject,c=u.fixedColumnsStart,f=u.inlineStartOverlay;if(s&&t<c)return!1;var h=!1;return-1===a?h=f.scrollTo(t,s?t>this.lastScrolledColumnPos:e):(s&&(t<a||t>l)||!s)&&(h=f.scrollTo(t,s?t>l:e)),h&&(this.lastScrolledColumnPos=t),h}},{key:"scrollViewportVertically",value:function(t,e,n){var r=this.dataAccessObject,o=r.drawn,i=r.totalRows;if(!o||!Number.isInteger(t)||t<0||t>i)return!1;var a=this.getFirstVisibleRow(),l=this.getLastVisibleRow(),s=void 0===e&&void 0===n,u=this.dataAccessObject,c=u.fixedRowsBottom,f=u.fixedRowsTop,h=u.topOverlay;if(s&&(t<f||t>i-c-1))return!1;var d=!1;return-1===a?d=h.scrollTo(t,s?t>this.lastScrolledRowPos:n):(s&&(t<a||t>l)||!s)&&(d=h.scrollTo(t,s?t>l:n)),d&&(this.lastScrolledRowPos=t),d}},{key:"getFirstVisibleRow",value:function(){var t=this.dataAccessObject,e=t.topOverlay,n=t.wtTable,r=t.wtViewport,o=t.totalRows,i=t.fixedRowsTop,a=t.rootWindow,l=n.getFirstVisibleRow();if(e.mainTableScrollableElement===a){var s=tn(n.wtRootElement),u=dn(n.hider),c=dn(a),f=rn(a,a);if(s.top+u-c<=f){var h=r.getColumnHeaderHeight();h+=e.sumCellSizes(0,i);for(var d=o;d>0;d--)if(h+=e.sumCellSizes(d-1,d),s.top+u-h<=f){l=d;break}}}return l}},{key:"getLastVisibleRow",value:function(){var t=this.dataAccessObject,e=t.topOverlay,n=t.wtTable,r=t.wtViewport,o=t.totalRows,i=t.rootWindow,a=n.getLastVisibleRow();if(e.mainTableScrollableElement===i){var l=tn(n.wtRootElement),s=rn(i,i);if(l.top>s)for(var u=dn(i),c=r.getColumnHeaderHeight(),f=1;f<=o;f++)if(c+=e.sumCellSizes(f-1,f),l.top+c-s>=u){a=f-2;break}}return a}},{key:"getFirstVisibleColumn",value:function(){var t=this.dataAccessObject,e=t.inlineStartOverlay,n=t.wtTable,r=t.wtViewport,o=t.totalColumns,i=t.rootWindow,a=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===i){var l=tn(n.wtRootElement),s=pn(n.hider),u=pn(i),c=Math.abs(on(i,i));if(l.left+s-u<=c)for(var f=r.getRowHeaderWidth(),h=o;h>0;h--)if(f+=e.sumCellSizes(h-1,h),l.left+s-f<=c){a=h;break}}return a}},{key:"getLastVisibleColumn",value:function(){var t=this.dataAccessObject,e=t.wtSettings,n=t.inlineStartOverlay,r=t.wtTable,o=t.wtViewport,i=t.totalColumns,a=t.rootWindow,l=r.getLastVisibleColumn();if(n.mainTableScrollableElement===a){var s=e.getSetting("rtlMode"),u=null;if(s){var c=r.TABLE.getBoundingClientRect(),f=this.dataAccessObject.rootWindow.document,h=f.documentElement.offsetWidth;u=Math.abs(c.right-h)}else{var d=tn(r.wtRootElement);u=d.left}var p=Math.abs(on(a,a));if(u>p)for(var y=pn(a),v=o.getRowHeaderWidth(),m=1;m<=i;m++)if(v+=n.sumCellSizes(m-1,m),u+v-p>=y){l=m-2;break}}return l}}]),t}(),bc=gc;function wc(t){return wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wc(t)}function Sc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Pc(r.key),r)}}function Oc(t,e,n){return e&&Cc(t.prototype,e),n&&Cc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function kc(t,e,n){Rc(t,e),e.set(t,n)}function Rc(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ec(t,e,n){return e=Pc(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pc(t){var e=Tc(t,"string");return"symbol"===wc(e)?e:String(e)}function Tc(t,e){if("object"!==wc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==wc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function jc(t,e){var n=Ic(t,e,"get");return Mc(t,n)}function Mc(t,e){return e.get?e.get.call(t):e.value}function Ac(t,e,n){var r=Ic(t,e,"set");return xc(t,r,n),n}function Ic(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function xc(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var _c=new WeakMap,Hc=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Sc(this,t),Ec(this,"row",null),Ec(this,"col",null),kc(this,_c,{writable:!0,value:!1}),Ac(this,_c,r),"undefined"!==typeof e&&"undefined"!==typeof n&&(this.row=e,this.col=n)}return Oc(t,[{key:"isValid",value:function(t){return!(this.row<0||this.col<0)&&!(this.row>=t.getSetting("totalRows")||this.col>=t.getSetting("totalColumns"))}},{key:"isEqual",value:function(t){return t===this||this.row===t.row&&this.col===t.col}},{key:"isSouthEastOf",value:function(t){return this.row>=t.row&&(jc(this,_c)?this.col<=t.col:this.col>=t.col)}},{key:"isNorthWestOf",value:function(t){return this.row<=t.row&&(jc(this,_c)?this.col>=t.col:this.col<=t.col)}},{key:"isSouthWestOf",value:function(t){return this.row>=t.row&&(jc(this,_c)?this.col>=t.col:this.col<=t.col)}},{key:"isNorthEastOf",value:function(t){return this.row<=t.row&&(jc(this,_c)?this.col<=t.col:this.col>=t.col)}},{key:"normalize",value:function(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new t(this.row,this.col,jc(this,_c))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),t}(),Nc=Hc;function Dc(t){return Dc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dc(t)}function Lc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zc(r.key),r)}}function Vc(t,e,n){return e&&Bc(t.prototype,e),n&&Bc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fc(t,e,n){Wc(t,e),e.set(t,n)}function Wc(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uc(t,e,n){return e=zc(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zc(t){var e=Gc(t,"string");return"symbol"===Dc(e)?e:String(e)}function Gc(t,e){if("object"!==Dc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Dc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Yc(t,e){var n=$c(t,e,"get");return Kc(t,n)}function Kc(t,e){return e.get?e.get.call(t):e.value}function Xc(t,e,n){var r=$c(t,e,"set");return qc(t,r,n),n}function $c(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function qc(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Qc=new WeakMap,Jc=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Lc(this,t),Uc(this,"highlight",null),Uc(this,"from",null),Uc(this,"to",null),Fc(this,Qc,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=n.clone(),this.to=r.clone(),Xc(this,Qc,o)}return Vc(t,[{key:"setHighlight",value:function(t){return this.highlight=t.clone().normalize(),this}},{key:"setFrom",value:function(t){return this.from=t.clone(),this}},{key:"setTo",value:function(t){return this.to=t.clone(),this}},{key:"isValid",value:function(t){return this.from.isValid(t)&&this.to.isValid(t)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(t){var e=t.row,n=t.col,r=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<=e&&o.row>=e&&r.col<=n&&o.col>=n}},{key:"includesRange",value:function(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}},{key:"isEqual",value:function(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}},{key:"overlaps",value:function(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}},{key:"isNorthWestOf",value:function(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}},{key:"isOverlappingHorizontally",value:function(t){return this.getOuterTopRightCorner().col>=t.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=t.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=t.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=t.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(t){return this.getOuterBottomRightCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=t.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=t.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=t.getOuterTopRightCorner().row}},{key:"expand",value:function(t){var e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>n.row||t.col>n.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(n.row,t.row),Math.max(n.col,t.col)),!0)}},{key:"expandByRange",value:function(t){if(this.includesRange(t)||!this.overlaps(t))return!1;var e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=this.getDirection(),o=t.getOuterTopStartCorner(),i=t.getOuterBottomEndCorner(),a=Math.min(e.row,o.row),l=Math.min(e.col,o.col),s=Math.max(n.row,i.row),u=Math.max(n.col,i.col),c=this._createCellCoords(a,l),f=this._createCellCoords(s,u);return this.from=c,this.to=f,this.setDirection(r),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(t){switch(t){case"NW-SE":var e=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=e[0],this.to=e[1];break;case"NE-SW":var n=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var r=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=r[0],this.to=r[1];break;case"SW-NE":var o=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=o[0],this.to=o[1];break;default:break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var t=this.getDirection();switch(t){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}},{key:"flipDirectionHorizontally",value:function(){var t=this.getDirection();switch(t){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return Yc(this,Qc)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return Yc(this,Qc)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return Yc(this,Qc)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return Yc(this,Qc)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return Yc(this,Qc)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return Yc(this,Qc)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return Yc(this,Qc)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return Yc(this,Qc)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(t,e){return!!(e&&e.includes(t)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(e.from.row,e.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(e.from.row,e.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(e.to.row,e.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(e.to.row,e.to.col))))||(t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner()))}},{key:"getOppositeCorner",value:function(t,e){if(!(t instanceof Nc))return!1;if(e){var n=e.from,r=e.to;if(e.includes(t)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(n.row,r.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(r.row,n.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterTopStartCorner()}}return t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0}},{key:"getBordersSharedWith",value:function(t){if(!this.includesRange(t))return[];var e={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},r=[];return e.top===n.top&&r.push("top"),e.right===n.right&&r.push("right"),e.bottom===n.bottom&&r.push("bottom"),e.left===n.left&&r.push("left"),r}},{key:"getInner",value:function(){for(var t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),n=[],r=t.row;r<=e.row;r++)for(var o=t.col;o<=e.col;o++)this.from.row===r&&this.from.col===o||this.to.row===r&&this.to.col===o||n.push(this._createCellCoords(r,o));return n}},{key:"getAll",value:function(){for(var t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),n=[],r=t.row;r<=e.row;r++)for(var o=t.col;o<=e.col;o++)t.row===r&&t.col===o?n.push(t):e.row===r&&e.col===o?n.push(e):n.push(this._createCellCoords(r,o));return n}},{key:"forAll",value:function(t){for(var e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=e.row;r<=n.row;r++)for(var o=e.col;o<=n.col;o++){var i=t(r,o);if(!1===i)return}}},{key:"clone",value:function(){return new t(this.highlight,this.from,this.to,Yc(this,Qc))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(t,e){return new Nc(t,e,Yc(this,Qc))}}]),t}(),Zc=Jc;function tf(t){return tf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(t)}function ef(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,af(r.key),r)}}function rf(t,e,n){return e&&nf(t.prototype,e),n&&nf(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function of(t,e,n){return e=af(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function af(t){var e=lf(t,"string");return"symbol"===tf(e)?e:String(e)}function lf(t,e){if("object"!==tf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==tf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var sf=function(){function t(e,n){ef(this,t),of(this,"wtTable",void 0),of(this,"wtScroll",void 0),of(this,"wtViewport",void 0),of(this,"wtOverlays",void 0),of(this,"selections",void 0),of(this,"wtEvent",void 0),of(this,"guid","wt_".concat(Se())),of(this,"drawInterrupted",!1),of(this,"drawn",!1),of(this,"domBindings",void 0),of(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new bc(this.createScrollDao())}return rf(t,[{key:"eventManager",get:function(){return new Gr(this)}},{key:"findOriginalHeaders",value:function(){var t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var e=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;e<n;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,n){Je(n,t[e])}])}}},{key:"createCellCoords",value:function(t,e){return new Nc(t,e,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(t,e,n){return new Zc(t,e,n,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}},{key:"getCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return this.wtTable.getCell(t);var n=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<r&&t.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<i&&t.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);if(t.row<n&&t.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}},{key:"scrollViewport",value:function(t,e,n,r,o){return!(t.col<0||t.row<0)&&this.wtScroll.scrollViewport(t,e,n,r,o)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selections(){return t.selections},get drawn(){return t.drawn},set drawn(e){t.drawn=e},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count}}}}]),t}();function uf(t){return uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uf(t)}function cf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Sf(r.key),r)}}function ff(t,e,n){return e&&cf(t.prototype,e),n&&cf(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function hf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function df(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pf(t,e)}function pf(t,e){return pf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},pf(t,e)}function yf(t){var e=gf();return function(){var n,r=bf(t);if(e){var o=bf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vf(this,n)}}function vf(t,e){if(e&&("object"===uf(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return mf(t)}function mf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gf(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function bf(t){return bf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bf(t)}function wf(t,e,n){return e=Sf(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sf(t){var e=Cf(t,"string");return"symbol"===uf(e)?e:String(e)}function Cf(t,e){if("object"!==uf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==uf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Of=function(t){df(n,t);var e=yf(n);function n(t,r,o){var i;hf(this,n),i=e.call(this,t,r),wf(mf(i),"cloneSource",void 0),wf(mf(i),"cloneOverlay",void 0);var a=i.wtSettings.getSetting("facade",mf(i));return i.cloneSource=o.source,i.cloneOverlay=o.overlay,i.wtTable=i.cloneOverlay.createTable(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=o.viewport,i.selections=o.selections,i.wtEvent=new ca(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections,o.event),i.findOriginalHeaders(),i}return ff(n)}(sf);function kf(t){return kf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kf(t)}function Rf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ef(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,jf(r.key),r)}}function Pf(t,e,n){return e&&Ef(t.prototype,e),n&&Ef(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tf(t,e,n){return e=jf(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jf(t){var e=Mf(t,"string");return"symbol"===kf(e)?e:String(e)}function Mf(t,e){if("object"!==kf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==kf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Af=function(){function t(e,n,r,o,i){Rf(this,t),Tf(this,"wtSettings",null),dt(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=n,this.wtSettings=o;var a=this.wot.wtTable,l=a.TABLE,s=a.hider,u=a.spreader,c=a.holder,f=a.wtRootElement;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=l,this.hider=s,this.spreader=u,this.holder=c,this.wtRootElement=f,this.trimmingContainer=ln(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return Pf(t,[{key:"updateStateOfRendering",value:function(){var t=this.needFullRender;this.needFullRender=this.shouldBeRendered();var e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=ln(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var t=this.wot.wtTable,e=this.domBindings.rootWindow;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=an(t.TABLE)}},{key:"getRelativeCellPosition",value:function(t,e,n){if(!1!==this.clone.wtTable.holder.contains(t)){var r=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),i=e<this.wtSettings.getSetting("fixedRowsTop"),a=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,s={start:this.getRelativeStartPosition(l),top:l.offsetTop},u={start:this.getRelativeStartPosition(t),top:t.offsetTop},c=null;return c=r?this.getRelativeCellPositionWithinWindow(i,o,u,s):this.getRelativeCellPositionWithinHolder(i,a,o,u,s),c}er("The provided element is not a child of the ".concat(this.type," overlay"))}},{key:"getRelativeStartPosition",value:function(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(t,e,n,r){var o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),i=0,a=0;if(e){var l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+On())),i=l<=0?-1*l:0}else i=r.start;if(t){var s=this.clone.wtTable.TABLE.getBoundingClientRect();a=s.top-o.top}else a=r.top;return{start:n.start+i,top:n.top+a}}},{key:"getRelativeCellPositionWithinHolder",value:function(t,e,n,r,o){var i={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},a=0,l=0;if(n||(a=i.horizontal-o.start),e){var s=this.wot.wtTable.wtRootElement.getBoundingClientRect(),u=this.clone.wtTable.TABLE.getBoundingClientRect();l=-1*u.top+s.top}else t||(l=i.vertical-o.top);return{start:r.start-a,top:r.top-l}}},{key:"makeClone",value:function(){if(-1===Ou.indexOf(this.type))throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var t=this.wot.wtTable,e=this.domBindings,n=e.rootDocument,r=e.rootWindow,o=n.createElement("DIV"),i=n.createElement("TABLE"),a=t.wtRootElement.parentNode;o.className="".concat(ku.get(this.type)," handsontable"),o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,i.className=t.TABLE.className,o.appendChild(i),a.appendChild(o);var l=this.wtSettings.getSetting("preventOverflow");return!0===l||"horizontal"===l&&this.type===gu||"vertical"===l&&this.type===wu?this.mainTableScrollableElement=r:"hidden"===r.getComputedStyle(a).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=an(t.TABLE),new Of(i,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}},{key:"reset",value:function(){if(this.clone){var t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,n=t.style,r=e.style,o=t.parentNode.style;U([n,r,o],(function(t){t.width="",t.height=""}))}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),t}();function If(t){return If="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},If(t)}function xf(t,e,n){return xf=Wf()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=Function.bind.apply(t,r),i=new o;return n&&Lf(i,n.prototype),i},xf.apply(null,arguments)}function _f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Gf(r.key),r)}}function Nf(t,e,n){return e&&Hf(t.prototype,e),n&&Hf(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Df(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lf(t,e)}function Lf(t,e){return Lf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Lf(t,e)}function Bf(t){var e=Wf();return function(){var n,r=Uf(t);if(e){var o=Uf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Vf(this,n)}}function Vf(t,e){if(e&&("object"===If(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ff(t)}function Ff(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Wf(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Uf(t){return Uf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Uf(t)}function zf(t,e,n){return e=Gf(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gf(t){var e=Yf(t,"string");return"symbol"===If(e)?e:String(e)}function Yf(t,e){if("object"!==If(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==If(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Kf=function(t){Df(n,t);var e=Bf(n);function n(t,r,o,i){var a;return _f(this,n),a=e.call(this,t,r,gu,o,i),zf(Ff(a),"cachedFixedRowsTop",-1),a.cachedFixedRowsTop=a.wtSettings.getSetting("fixedRowsTop"),a}return Nf(n,[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return xf(cc,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var t=this.clone.wtTable.holder.parentNode,e=this.domBindings.rootWindow,n=this.wtSettings.getSetting("preventOverflow"),r=0,o=!1;if(this.trimmingContainer!==e||n&&"vertical"===n)r=this.getScrollPosition(),Tn(t);else{var i=this.wot.wtTable,a=i.hider.getBoundingClientRect(),l=Math.ceil(a.bottom),s=t.offsetHeight;o=l===s,r=this.getOverlayOffset(),En(t,"0px","".concat(r,"px"))}var u=this.adjustHeaderBordersPosition(r,o);return this.adjustElementsSize(),u}},{key:"setScrollPosition",value:function(t){var e=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo(nn(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(t,e){var n=this.wtSettings.getSetting("defaultRowHeight"),r=t,o=0;while(r<e){var i=this.wot.wtTable.getRowHeight(r);o+=void 0===i?n:i,r+=1}return o}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable,e=this.domBindings,n=e.rootDocument,r=e.rootWindow,o=On(n),i=this.clone.wtTable.holder.parentNode,a=i.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===l){var s=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(s-=o),s=Math.min(s,t.wtRootElement.scrollWidth),a.width="".concat(s,"px")}else a.width="";this.clone.wtTable.holder.style.width=a.width;var u=hn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height="".concat(u,"px")}},{key:"adjustRootChildrenSize",value:function(){var t,e=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(t=null===n||void 0===n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==t?t:0);this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height="".concat(parseInt(e.parentNode.style.height,10)+o,"px")}},{key:"applyToDOM",value:function(){var t=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var t=this.isRtl()?"right":"left",e=this.clone.wtTable.spreader;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):e.style[t]=""}},{key:"scrollTo",value:function(t,e){var n=this.wot,r=this.wtSettings,o=n.cloneSource?n.cloneSource:n,i=o.wtTable.holder,a=this.getTableParentOffset(),l=0;if(e){var s=this.wot.wtTable.getRowHeight(t),u=this.wot.wtViewport.getViewportHeight();s>u&&(e=!1)}if(e&&i.offsetHeight!==i.clientHeight&&(l=On(this.domBindings.rootDocument)),e){var c=r.getSetting("fixedRowsBottom"),f=r.getSetting("totalRows");a+=this.sumCellSizes(0,t+1),a-=n.wtViewport.getViewportHeight()-this.sumCellSizes(f-c,f),a+=1}else a+=this.sumCellSizes(r.getSetting("fixedRowsTop"),t);return a+=l,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return rn(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var t=this.domBindings.rootWindow,e=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){var r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),i=r-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>i&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("totalColumns");r?Ye(n,"emptyColumns"):Ge(n,"emptyColumns");var o=!1;if(!e){var i=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==i,l=this.wtSettings.getSetting("columnHeaders");if((a||0===i)&&l.length>0){var s=ze(n,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),t||0===this.wtSettings.getSetting("totalRows")?(Ge(n,"innerBorderTop"),o=!s):(Ye(n,"innerBorderTop"),o=s)}}return o}}]),n}(Af),Xf="stickyRowsBottom",$f={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return 0===t||0===e?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};dt($f,"MIXIN_NAME",Xf,{writable:!1,enumerable:!1});var qf=$f;function Qf(t){return Qf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qf(t)}function Jf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,th(r.key),r)}}function Zf(t,e,n){return e&&Jf(t.prototype,e),n&&Jf(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function th(t){var e=eh(t,"string");return"symbol"===Qf(e)?e:String(e)}function eh(t,e){if("object"!==Qf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Qf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function nh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rh(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oh(t,e)}function oh(t,e){return oh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},oh(t,e)}function ih(t){var e=sh();return function(){var n,r=uh(t);if(e){var o=uh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ah(this,n)}}function ah(t,e){if(e&&("object"===Qf(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return lh(t)}function lh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sh(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function uh(t){return uh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},uh(t)}var ch=function(t){rh(n,t);var e=ih(n);function n(t,r,o,i){return nh(this,n),e.call(this,t,r,o,i,bu)}return Zf(n)}(Uu);ct(ch,qf),ct(ch,$u);var fh=ch;function hh(t){return hh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hh(t)}function dh(t,e,n){return dh=Ch()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=Function.bind.apply(t,r),i=new o;return n&&gh(i,n.prototype),i},dh.apply(null,arguments)}function ph(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Rh(r.key),r)}}function vh(t,e,n){return e&&yh(t.prototype,e),n&&yh(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function mh(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gh(t,e)}function gh(t,e){return gh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},gh(t,e)}function bh(t){var e=Ch();return function(){var n,r=Oh(t);if(e){var o=Oh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wh(this,n)}}function wh(t,e){if(e&&("object"===hh(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Sh(t)}function Sh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ch(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Oh(t){return Oh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Oh(t)}function kh(t,e,n){return e=Rh(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rh(t){var e=Eh(t,"string");return"symbol"===hh(e)?e:String(e)}function Eh(t,e){if("object"!==hh(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==hh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Ph=function(t){mh(n,t);var e=bh(n);function n(t,r,o,i){var a;return ph(this,n),a=e.call(this,t,r,bu,o,i),kh(Sh(a),"cachedFixedRowsBottom",-1),a.cachedFixedRowsBottom=a.wtSettings.getSetting("fixedRowsBottom"),a}return vh(n,[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return dh(fh,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var t=this.domBindings.rootWindow,e=this.clone.wtTable.holder.parentNode;e.style.top="";var n=0,r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||r&&"vertical"===r?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),e.style.bottom="".concat(n,"px"));var o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}},{key:"repositionOverlay",value:function(){var t=this.wot,e=t.wtTable,n=t.wtViewport,r=this.domBindings.rootDocument,o=this.clone.wtTable.holder.parentNode,i=0;n.hasVerticalScroll()||(i+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(i+=On(r)),o.style.bottom="".concat(i,"px")}},{key:"setScrollPosition",value:function(t){var e=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===e?(e.scrollTo(nn(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(t,e){var n=this.wot,r=n.wtTable,o=n.wtSettings,i=o.getSetting("defaultRowHeight"),a=t,l=0;while(a<e){var s=r.getRowHeight(a);l+=void 0===s?i:s,a+=1}return l}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var t=this.wot,e=t.wtTable,n=t.wtViewport,r=this.domBindings,o=r.rootDocument,i=r.rootWindow,a=On(o),l=this.clone.wtTable.holder.parentNode,s=l.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||"horizontal"===u){var c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=a),c=Math.min(c,e.wtRootElement.scrollWidth),s.width="".concat(c,"px")}else s.width="";this.clone.wtTable.holder.style.width=s.width;var f=hn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(f=0),s.height="".concat(f,"px")}},{key:"adjustRootChildrenSize",value:function(){var t=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}},{key:"applyToDOM",value:function(){var t=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var t=this.isRtl()?"right":"left",e=this.clone.wtTable.spreader;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):e.style[t]=""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),r=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=r.wtTable.holder,i=0;e&&o.offsetHeight!==o.clientHeight&&(i=On(this.domBindings.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return rn(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var t=this.domBindings.rootWindow,e=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){var r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),i=r-o,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+r,0),n>i&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==e,r=this.wtSettings.getSetting("columnHeaders"),o=!1;if((n||0===e)&&r.length>0){var i=this.wot.wtTable.holder.parentNode,a=ze(i,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?(Ge(i,"innerBorderBottom"),o=!a):(Ye(i,"innerBorderBottom"),o=a)}return o}}]),n}(Af),Th="calculatedRows",jh={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};dt(jh,"MIXIN_NAME",Th,{writable:!1,enumerable:!1});var Mh=jh,Ah="stickyColumnsStart",Ih={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return 0===t?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};dt(Ih,"MIXIN_NAME",Ah,{writable:!1,enumerable:!1});var xh=Ih;function _h(t){return _h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_h(t)}function Hh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Dh(r.key),r)}}function Nh(t,e,n){return e&&Hh(t.prototype,e),n&&Hh(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Dh(t){var e=Lh(t,"string");return"symbol"===_h(e)?e:String(e)}function Lh(t,e){if("object"!==_h(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==_h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Bh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vh(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fh(t,e)}function Fh(t,e){return Fh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Fh(t,e)}function Wh(t){var e=Gh();return function(){var n,r=Yh(t);if(e){var o=Yh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Uh(this,n)}}function Uh(t,e){if(e&&("object"===_h(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return zh(t)}function zh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gh(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Yh(t){return Yh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yh(t)}var Kh=function(t){Vh(n,t);var e=Wh(n);function n(t,r,o,i){return Bh(this,n),e.call(this,t,r,o,i,wu)}return Nh(n)}(Uu);ct(Kh,Mh),ct(Kh,xh);var Xh=Kh;function $h(t){return $h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$h(t)}function qh(t,e,n){return qh=ld()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=Function.bind.apply(t,r),i=new o;return n&&rd(i,n.prototype),i},qh.apply(null,arguments)}function Qh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,td(r.key),r)}}function Zh(t,e,n){return e&&Jh(t.prototype,e),n&&Jh(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function td(t){var e=ed(t,"string");return"symbol"===$h(e)?e:String(e)}function ed(t,e){if("object"!==$h(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==$h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function nd(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rd(t,e)}function rd(t,e){return rd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},rd(t,e)}function od(t){var e=ld();return function(){var n,r=sd(t);if(e){var o=sd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return id(this,n)}}function id(t,e){if(e&&("object"===$h(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ad(t)}function ad(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ld(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function sd(t){return sd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sd(t)}var ud=function(t){nd(n,t);var e=od(n);function n(t,r,o,i){return Qh(this,n),e.call(this,t,r,wu,o,i)}return Zh(n,[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return qh(Xh,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var t=this.wot.wtTable;if(!this.needFullRender||!t.holder.parentNode)return!1;var e=this.domBindings.rootWindow,n=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow"),o=0;this.trimmingContainer!==e||r&&"horizontal"===r?(o=this.getScrollPosition(),Tn(n)):(o=this.getOverlayOffset()*(this.isRtl()?-1:1),En(n,"".concat(o,"px"),"0px"));var i=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),i}},{key:"setScrollPosition",value:function(t){var e=this.domBindings.rootWindow,n=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,en(e)),n=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(t,e){var n=this.wtSettings.getSetting("defaultColumnWidth"),r=t,o=0;while(r<e)o+=this.wot.wtTable.getStretchedColumnWidth(r)||n,r+=1;return o}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var t=this.wot.wtTable,e=this.domBindings,n=e.rootDocument,r=e.rootWindow,o=On(n),i=this.clone.wtTable.holder.parentNode,a=i.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"vertical"===l){var s=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(s-=o),s=Math.min(s,t.wtRootElement.scrollHeight),a.height="".concat(s,"px")}else a.height="";this.clone.wtTable.holder.style.height=a.height;var u=fn(this.clone.wtTable.TABLE);a.width="".concat(u,"px")}},{key:"adjustRootChildrenSize",value:function(){var t,e=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),o=Math.abs(null!==(t=null===n||void 0===n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==t?t:0);this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width="".concat(parseInt(e.parentNode.style.width,10)+o,"px")}},{key:"applyToDOM",value:function(){var t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[e]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(t,e){var n=this.getTableParentOffset(),r=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=r.wtTable.holder,i=0;if(e){var a=this.wot.wtTable.getColumnWidth(t),l=this.wot.wtViewport.getViewportWidth();a>l&&(e=!1)}return e&&o.offsetWidth!==o.clientWidth&&(i=On(this.domBindings.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var t=this.wtSettings.getSetting("preventOverflow"),e=0;return t||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}},{key:"getScrollPosition",value:function(){return Math.abs(on(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var t=this.domBindings.rootWindow,e=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===t&&(!e||"horizontal"!==e)){n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var r=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),i=r-o;n>i&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(t){var e=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),r=this.wtSettings.getSetting("fixedColumnsStart"),o=this.wtSettings.getSetting("totalRows");o?Ye(e,"emptyRows"):Ge(e,"emptyRows");var i=!1;if(r&&!n.length)Ge(e,"innerBorderLeft innerBorderInlineStart");else if(!r&&n.length){var a=ze(e,"innerBorderInlineStart");t?(Ge(e,"innerBorderLeft innerBorderInlineStart"),i=!a):(Ye(e,"innerBorderLeft innerBorderInlineStart"),i=a)}return i}}]),n}(Af);function cd(t){return cd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cd(t)}function fd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dd(r.key),r)}}function hd(t,e,n){return e&&fd(t.prototype,e),n&&fd(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function dd(t){var e=pd(t,"string");return"symbol"===cd(e)?e:String(e)}function pd(t,e){if("object"!==cd(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==cd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function yd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vd(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&md(t,e)}function md(t,e){return md=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},md(t,e)}function gd(t){var e=Sd();return function(){var n,r=Cd(t);if(e){var o=Cd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bd(this,n)}}function bd(t,e){if(e&&("object"===cd(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return wd(t)}function wd(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Sd(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Cd(t){return Cd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Cd(t)}var Od=function(t){vd(n,t);var e=gd(n);function n(t,r,o,i){return yd(this,n),e.call(this,t,r,o,i,Su)}return hd(n)}(Uu);ct(Od,Yu),ct(Od,xh);var kd=Od;function Rd(t){return Rd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rd(t)}function Ed(t,e,n){return Ed=Hd()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=Function.bind.apply(t,r),i=new o;return n&&Ad(i,n.prototype),i},Ed.apply(null,arguments)}function Pd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Td(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ld(r.key),r)}}function jd(t,e,n){return e&&Td(t.prototype,e),n&&Td(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Md(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ad(t,e)}function Ad(t,e){return Ad=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ad(t,e)}function Id(t){var e=Hd();return function(){var n,r=Nd(t);if(e){var o=Nd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xd(this,n)}}function xd(t,e){if(e&&("object"===Rd(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _d(t)}function _d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Hd(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Nd(t){return Nd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Nd(t)}function Dd(t,e,n){return e=Ld(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ld(t){var e=Bd(t,"string");return"symbol"===Rd(e)?e:String(e)}function Bd(t,e){if("object"!==Rd(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Rd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Vd=function(t){Md(n,t);var e=Id(n);function n(t,r,o,i,a,l){var s;return Pd(this,n),s=e.call(this,t,r,Su,o,i),Dd(_d(s),"topOverlay",void 0),Dd(_d(s),"inlineStartOverlay",void 0),s.topOverlay=a,s.inlineStartOverlay=l,s}return jd(n,[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Ed(kd,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var e=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),n=this.topOverlay.getOverlayOffset();En(t,"".concat(e,"px"),"".concat(n,"px"))}else Tn(t);var r=hn(this.clone.wtTable.TABLE),o=fn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),t.style.height="".concat(r,"px"),t.style.width="".concat(o,"px"),!1}}]),n}(Af);function Fd(t){return Fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fd(t)}function Wd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zd(r.key),r)}}function Ud(t,e,n){return e&&Wd(t.prototype,e),n&&Wd(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function zd(t){var e=Gd(t,"string");return"symbol"===Fd(e)?e:String(e)}function Gd(t,e){if("object"!==Fd(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Fd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Yd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Kd(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xd(t,e)}function Xd(t,e){return Xd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xd(t,e)}function $d(t){var e=Jd();return function(){var n,r=Zd(t);if(e){var o=Zd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qd(this,n)}}function qd(t,e){if(e&&("object"===Fd(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Qd(t)}function Qd(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jd(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Zd(t){return Zd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zd(t)}var tp=function(t){Kd(n,t);var e=$d(n);function n(t,r,o,i){return Yd(this,n),e.call(this,t,r,o,i,Cu)}return Ud(n)}(Uu);ct(tp,qf),ct(tp,xh);var ep=tp;function np(t){return np="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},np(t)}function rp(t,e,n){return rp=pp()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=Function.bind.apply(t,r),i=new o;return n&&cp(i,n.prototype),i},rp.apply(null,arguments)}function op(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ip(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lp(r.key),r)}}function ap(t,e,n){return e&&ip(t.prototype,e),n&&ip(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function lp(t){var e=sp(t,"string");return"symbol"===np(e)?e:String(e)}function sp(t,e){if("object"!==np(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==np(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function up(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cp(t,e)}function cp(t,e){return cp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},cp(t,e)}function fp(t){var e=pp();return function(){var n,r=yp(t);if(e){var o=yp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hp(this,n)}}function hp(t,e){if(e&&("object"===np(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return dp(t)}function dp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pp(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function yp(t){return yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yp(t)}var vp=function(t){up(n,t);var e=fp(n);function n(t,r,o,i,a,l){var s;return op(this,n),s=e.call(this,t,r,Cu,o,i),s.bottomOverlay=a,s.inlineStartOverlay=l,s}return ap(n,[{key:"createTable",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return rp(ep,e)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var t=this.wot;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var n=this.inlineStartOverlay.getOverlayOffset(),r=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]="".concat(n,"px"),e.style.bottom="".concat(r,"px")}else Tn(e),this.repositionOverlay();var o=hn(this.clone.wtTable.TABLE),i=fn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(o=0),e.style.height="".concat(o,"px"),e.style.width="".concat(i,"px"),!1}},{key:"repositionOverlay",value:function(){var t=this.wot,e=t.wtTable,n=t.wtViewport,r=this.domBindings.rootDocument,o=this.clone.wtTable.holder.parentNode,i=0;n.hasVerticalScroll()||(i+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(i+=On(r)),o.style.bottom="".concat(i,"px")}}]),n}(Af);function mp(t){return mp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mp(t)}function gp(t,e,n){return gp=bp()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=Function.bind.apply(t,r),i=new o;return n&&wp(i,n.prototype),i},gp.apply(null,arguments)}function bp(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function wp(t,e){return wp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},wp(t,e)}function Sp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Rp(r.key),r)}}function Op(t,e,n){return e&&Cp(t.prototype,e),n&&Cp(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function kp(t,e,n){return e=Rp(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rp(t){var e=Ep(t,"string");return"symbol"===mp(e)?e:String(e)}function Ep(t,e){if("object"!==mp(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==mp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Pp=function(){function t(e,n,r,o,i,a){var l=this;Sp(this,t),kp(this,"wot",null),kp(this,"topOverlay",null),kp(this,"bottomOverlay",null),kp(this,"inlineStartOverlay",null),kp(this,"topInlineStartCornerOverlay",null),kp(this,"bottomInlineStartCornerOverlay",null),kp(this,"browserLineHeight",void 0),kp(this,"wtSettings",null),kp(this,"resizeObserver",new ResizeObserver((function(t){P((function(){Array.isArray(t)&&t.length&&l.wtSettings.getSetting("onContainerElementResize")}))}))),this.wot=e,this.wtSettings=o,this.domBindings=r,this.facadeGetter=n,this.wtTable=a;var s=this.domBindings,u=s.rootDocument,c=s.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=On(u);var f="hidden"===c.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=f?a.holder:an(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}return Op(t,[{key:"getOverlays",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return t&&e.push(this.wtTable),e}},{key:"initBrowserLineHeight",value:function(){var t=this.domBindings,e=t.rootWindow,n=t.rootDocument,r=e.getComputedStyle(n.body),o=parseInt(r.lineHeight,10),i=1.2*parseInt(r.fontSize,10);this.browserLineHeight=o||i}},{key:"initOverlays",value:function(){var t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=gp(Kf,t),this.bottomOverlay=gp(Ph,t),this.inlineStartOverlay=gp(ud,t),this.topInlineStartCornerOverlay=gp(Vd,t.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=gp(vp,t.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var t=this.topOverlay.updateStateOfRendering();return t=this.bottomOverlay.updateStateOfRendering()||t,t=this.inlineStartOverlay.updateStateOfRendering()||t,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(t=this.topInlineStartCornerOverlay.updateStateOfRendering()||t),this.bottomOverlay.needFullRender&&(t=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||t)),t}},{key:"refreshAll",value:function(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var t=this,e=this.domBindings,n=e.rootDocument,r=e.rootWindow,o=this.topOverlay.mainTableScrollableElement,i=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",(function(e){return t.onKeyDown(e)})),this.eventManager.addEventListener(n.documentElement,"keyup",(function(){return t.onKeyUp()})),this.eventManager.addEventListener(n,"visibilitychange",(function(){return t.onKeyUp()})),this.eventManager.addEventListener(o,"scroll",(function(e){return t.onTableScroll(e)}),{passive:!0}),o!==i&&this.eventManager.addEventListener(i,"scroll",(function(e){return t.onTableScroll(e)}),{passive:!0});var a=r.devicePixelRatio&&r.devicePixelRatio>1,l=this.scrollableElement===r,s=this.wtSettings.getSetting("preventWheel"),u={passive:l};(s||a||!Rt())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(function(e){return t.onCloneWheel(e,s)}),u);var c,f=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];f.forEach((function(e){if(e&&e.needFullRender){var n=e.clone.wtTable.holder;t.eventManager.addEventListener(n,"wheel",(function(e){return t.onCloneWheel(e,s)}),u)}})),this.eventManager.addEventListener(r,"resize",(function(){clearTimeout(c),c=setTimeout((function(){t.wtSettings.getSetting("onWindowResize")}),200)})),l||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(t){var e=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=t.target;this.keyPressed&&(r!==e&&o!==e&&!t.target.contains(r)||n!==e&&o!==e&&!t.target.contains(n))||this.syncScrollPositions(t)}},{key:"onCloneWheel",value:function(t,e){var n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=t.target,a=o!==n&&i!==n&&!i.contains(o),l=r!==n&&i!==n&&!i.contains(r);if(!this.keyPressed||!a&&!l){var s=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==n&&s)&&t.preventDefault()}}},{key:"onKeyDown",value:function(t){this.keyPressed=qn(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(t){var e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,n=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(n+=n*this.browserLineHeight,e+=e*this.browserLineHeight);var r=this.scrollVertically(e),o=this.scrollHorizontally(n);return r||o}},{key:"scrollVertically",value:function(t){var e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(t){var e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var t=this.domBindings.rootWindow,e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,r=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],o=r[0],i=r[1];if(this.horizontalScrolling=e.scrollLeft!==o||this.lastScrollX!==t.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=o;var a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var t=this.topOverlay.mainTableScrollableElement,e=t.scrollLeft,n=t.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var t=this.wtTable,e=this.domBindings.rootWindow;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=an(t.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.updateLastSpreaderSize();e&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}},{key:"updateLastSpreaderSize",value:function(){var t=this.wtTable.spreader,e=t.clientWidth,n=t.clientHeight,r=e!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=n),r}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.wot.wtViewport,n=this.wtTable,r=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),i=e.getRowHeaderWidth(),a=e.getColumnHeaderHeight(),l=n.hider.style;if(l.width="".concat(i+this.inlineStartOverlay.sumCellSizes(0,r),"px"),l.height="".concat(a+this.topOverlay.sumCellSizes(0,o)+1,"px"),this.scrollbarSize>0){var s=n.wtRootElement,u=s.scrollHeight,c=s.scrollWidth,f=n.holder,h=f.scrollHeight,d=f.scrollWidth;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<d,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.inlineStartOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(t){if(!t)return null;var e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],n=null;return U(e,(function(e){e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(n=e.clone)})),n}},{key:"syncOverlayTableClassNames",value:function(){var t=this.wtTable.TABLE,e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];U(e,(function(e){e&&(e.clone.wtTable.TABLE.className=t.className)}))}}]),t}(),Tp=Pp;function jp(t){return jp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jp(t)}function Mp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ap(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_p(r.key),r)}}function Ip(t,e,n){return e&&Ap(t.prototype,e),n&&Ap(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function xp(t,e,n){return e=_p(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _p(t){var e=Hp(t,"string");return"symbol"===jp(e)?e:String(e)}function Hp(t,e){if("object"!==jp(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==jp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Np=function(){function t(e){var n=this;Mp(this,t),xp(this,"settings",{}),xp(this,"defaults",Object.freeze(this.getDefaults())),pt(this.defaults,(function(t,r){if(void 0!==e[r])n.settings[r]=e[r];else{if(void 0===t)throw new Error('A required setting "'.concat(r,'" was not provided'));n.settings[r]=t}}))}return Ip(t,[{key:"getDefaults",value:function(){var t=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return t.getSetting("fixedColumnsStart")>0||t.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return t.getSetting("fixedRowsTop")>0||t.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return t.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,n,r){var o=t.getSetting("data",e,n);Je(r,void 0===o||null===o?"":o)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(t){return t},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(t){return t},onBeforeHighlightingColumnHeader:function(t){return t},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(t,e){var n=this;return void 0===e?pt(t,(function(t,e){n.settings[e]=t})):this.settings[t]=e,this}},{key:"getSetting",value:function(t,e,n,r,o){return"function"===typeof this.settings[t]?this.settings[t](e,n,r,o):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}},{key:"getSettingPure",value:function(t){return this.settings[t]}},{key:"has",value:function(t){return!!this.settings[t]}}]),t}();function Dp(t){return Dp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dp(t)}function Lp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Fp(r.key),r)}}function Vp(t,e,n){return e&&Bp(t.prototype,e),n&&Bp(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fp(t){var e=Wp(t,"string");return"symbol"===Dp(e)?e:String(e)}function Wp(t,e){if("object"!==Dp(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Dp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Up(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zp(t,e)}function zp(t,e){return zp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},zp(t,e)}function Gp(t){var e=Xp();return function(){var n,r=$p(t);if(e){var o=$p(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Yp(this,n)}}function Yp(t,e){if(e&&("object"===Dp(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Kp(t)}function Kp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xp(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function $p(t){return $p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$p(t)}var qp=function(t){Up(n,t);var e=Gp(n);function n(t,r,o,i){return Lp(this,n),e.call(this,t,r,o,i,"master")}return Vp(n,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var t=ln(this.wtRootElement),e=this.domBindings.rootWindow;if(t===e){var n=this.wtSettings.getSetting("preventOverflow");n||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var r=t.parentElement,o=sn(t,"height",e),i=sn(t,"overflow",e),a=this.holder.style,l=t.scrollWidth,s=t.scrollHeight,u=t.getBoundingClientRect(),c=u.width,f=u.height,h=["auto","hidden","scroll"];if(r&&h.includes(i)){var d=t.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",t.nextElementSibling?r.insertBefore(d,t.nextElementSibling):r.appendChild(d);var p=parseInt(cn(d,e).height,10);r.removeChild(d),0===p&&(f=0)}f=Math.min(f,s),a.height="auto"===o?"auto":"".concat(f,"px"),c=Math.min(c,l),a.width="".concat(c,"px"),a.overflow="",this.hasTableHeight="auto"===a.height||f>0,this.hasTableWidth=c>0}this.isTableVisible=Ze(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var t=this.wtSettings,e=this.dataAccessObject.wtViewport,n="master",r=t.getSetting("columnHeaders"),o=r.length;if(o&&!e.hasOversizedColumnHeadersMarked[n]){for(var i=t.getSetting("rowHeaders"),a=i.length,l=this.getRenderedColumnsCount(),s=0;s<o;s++)for(var u=-1*a;u<l;u++)this.markIfOversizedColumnHeader(u);e.hasOversizedColumnHeadersMarked[n]=!0}}}]),n}(Uu);ct(qp,Mh),ct(qp,$u);var Qp=qp,Jp=1,Zp=2;function ty(t){return ty="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ty(t)}function ey(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ny(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,oy(r.key),r)}}function ry(t,e,n){return e&&ny(t.prototype,e),n&&ny(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function oy(t){var e=iy(t,"string");return"symbol"===ty(e)?e:String(e)}function iy(t,e){if("object"!==ty(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ty(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ay=new WeakMap,ly=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.viewportSize,r=e.scrollOffset,o=e.totalItems,i=e.itemSizeFn,a=e.overrideFn,l=e.calculationType,s=e.scrollbarHeight;ey(this,t),ay.set(this,{viewportHeight:n,scrollOffset:r,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:l,horizontalScrollbarHeight:s}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return ry(t,[{key:"calculate",value:function(){for(var e,n=ay.get(this),r=n.calculationType,o=n.overrideFn,i=n.rowHeightFn,a=n.scrollOffset,l=Math.max(n.scrollOffset,0),s=n.totalRows,u=n.viewportHeight,c=n.horizontalScrollbarHeight||0,f=0,h=!0,d=[],p=0,y=0,v=0;v<s;v++)if(e=i(v),isNaN(e)&&(e=t.DEFAULT_HEIGHT),f<=l&&r!==Zp&&(this.startRow=v,p=e),f>=l&&f+(r===Zp?e:0)<=l+u-c&&(null===this.startRow&&(this.startRow=v,p=e),this.endRow=v),d.push(f),f+=e,y=e,r!==Zp&&(this.endRow=v),f>=l+u-c){h=!1;break}var m=a+u-c,g=r===Zp?p:0,b=r===Zp?0:y;if(m<g||a>d.at(-1)+b?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===s-1&&h){this.startRow=this.endRow;while(this.startRow>0){var w=d[this.endRow]+e-d[this.startRow-1];if((w<=u-c||r!==Zp)&&(this.startRow-=1),w>=u-c)break}}r===Jp&&null!==this.startRow&&o&&o(this),this.startPosition=d[this.startRow],void 0===this.startPosition&&(this.startPosition=null),s<this.endRow&&(this.endRow=s-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),t}(),sy=ly;function uy(t){return uy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uy(t)}function cy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dy(r.key),r)}}function hy(t,e,n){return e&&fy(t.prototype,e),n&&fy(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function dy(t){var e=py(t,"string");return"symbol"===uy(e)?e:String(e)}function py(t,e){if("object"!==uy(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==uy(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var yy=new WeakMap,vy=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.viewportSize,r=e.scrollOffset,o=e.totalItems,i=e.itemSizeFn,a=e.overrideFn,l=e.calculationType,s=e.stretchMode,u=e.stretchingItemWidthFn,c=void 0===u?function(t){return t}:u,f=e.inlineStartOffset;cy(this,t),yy.set(this,{viewportWidth:n,scrollOffset:r,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:l,stretchingColumnWidthFn:c,inlineStartOffset:f}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=s,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return hy(t,[{key:"calculate",value:function(){for(var t,e=0,n=!0,r=[],o=0,i=0,a=yy.get(this),l=a.calculationType,s=a.overrideFn,u=a.scrollOffset,c=Math.max(a.scrollOffset,0),f=a.totalColumns,h=a.viewportWidth,d=c>0?h+1:h,p=0;p<f;p++)if(t=this._getColumnWidth(p),e<=c&&l!==Zp&&(this.startColumn=p,o=t),e>=c&&e+(l===Zp?t:0)<=c+d&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=p,o=t),this.endColumn=p),r.push(e),e+=t,i=t,l!==Zp&&(this.endColumn=p),e>=c+h){n=!1;break}var y=u+h-d,v=l===Zp?0:i,m=l===Zp?o:0;if(y<-1*a.inlineStartOffset||u>r.at(-1)+v||-1*a.scrollOffset-a.viewportWidth>-1*m?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===f-1&&n){this.startColumn=this.endColumn;while(this.startColumn>0){var g=r[this.endColumn]+t-r[this.startColumn-1];if((g<=h||l!==Zp)&&(this.startColumn-=1),g>h)break}}l===Jp&&null!==this.startColumn&&s&&s(this),this.startPosition=r[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),f<this.endColumn&&(this.endColumn=f-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(t){if("none"!==this.stretch){var e=t;this.totalTargetWidth=e;for(var n=yy.get(this),r=n.totalColumns,o=0,i=0;i<r;i++){var a=this._getColumnWidth(i),l=n.stretchingColumnWidthFn(void 0,i);"number"===typeof l?e-=l:o+=a}var s=e-o;if("all"===this.stretch&&s>0)this.stretchAllRatio=e/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&e!==1/0){var u=this._getColumnWidth(r-1),c=s+u;this.stretchLastWidth=c>=0?c:u}}}},{key:"getStretchedColumnWidth",value:function(t,e){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(t,e):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(t)),n}},{key:"_getStretchedAllColumnWidth",value:function(t,e){var n=0,r=yy.get(this),o=r.totalColumns;if(!this.stretchAllColumnsWidth[t]){var i=Math.round(e*this.stretchAllRatio),a=r.stretchingColumnWidthFn(i,t);this.stretchAllColumnsWidth[t]=void 0===a?i:isNaN(a)?this._getColumnWidth(t):a}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var l=0;l<this.stretchAllColumnsWidth.length;l++)n+=this.stretchAllColumnsWidth[l];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[t]}},{key:"_getStretchedLastColumnWidth",value:function(t){var e=yy.get(this),n=e.totalColumns;return t===n-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(e){var n=yy.get(this).columnWidthFn(e);return isNaN(n)&&(n=t.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),t}(),my=vy;function gy(t){return gy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gy(t)}function by(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Cy(r.key),r)}}function Sy(t,e,n){return e&&wy(t.prototype,e),n&&wy(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cy(t){var e=Oy(t,"string");return"symbol"===gy(e)?e:String(e)}function Oy(t,e){if("object"!==gy(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==gy(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ky=function(){function t(e,n,r,o,i){var a=this;by(this,t),this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(function(){a.clientHeight=a.getWorkspaceHeight()}))}return Sy(t,[{key:"getWorkspaceHeight",value:function(){var t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer,n=0;if(e===this.domBindings.rootWindow)n=t.documentElement.clientHeight;else{var r=hn(e);n=r>0&&e.clientHeight>0?e.clientHeight:1/0}return n}},{key:"getWorkspaceWidth",value:function(){var t,e,n=this.wtSettings,r=this.domBindings,o=r.rootDocument,i=r.rootWindow,a=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=o.documentElement.offsetWidth,s=n.getSetting("totalColumns"),u=n.getSetting("preventOverflow"),c=n.getSetting("rtlMode"),f=this.wtTable.TABLE.getBoundingClientRect(),h=c?f.right-l:f.left,d=l-h;if(u)return fn(this.wtTable.wtRootElement);if(t=n.getSetting("freezeOverlays")?Math.min(d,l):Math.min(this.getContainerFillWidth(),d,l),a===i&&s>0&&this.sumColumnWidths(0,s-1)>t)return o.documentElement.clientWidth;if(a!==i&&(e=sn(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),"scroll"===e||"hidden"===e||"auto"===e))return Math.max(t,a.clientWidth);var p=n.getSetting("stretchH");return"none"!==p&&p?t:Math.max(t,fn(this.wtTable.TABLE))}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(t,e){var n=0,r=t;while(r<e)n+=this.wtTable.getColumnWidth(r),r+=1;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);var n=e.offsetWidth;return this.containerWidth=n,t.removeChild(e),n}},{key:"getWorkspaceOffset",value:function(){return tn(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var t=this.wtSettings.getSetting("columnHeaders");return t.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=hn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var t=this.getWorkspaceHeight();if(t===1/0)return t;var e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}},{key:"getRowHeaderWidth",value:function(){var t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(var n=0,r=e.length;n<r;n++)this.rowHeaderWidth+=t[n]||t}if(isNaN(this.rowHeaderWidth))if(e.length){var o=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var i=0,a=e.length;i<a;i++)o?(this.rowHeaderWidth+=fn(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var t=this.getWorkspaceWidth();if(t===1/0)return t;var e=this.getRowHeaderWidth();return e>0?t-e:t}},{key:"createRowsCalculator",value:function(){var t,e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jp,o=this.wtSettings,i=this.wtTable;this.rowHeaderWidth=NaN,t=o.getSetting("renderAllRows")&&r===Jp?1/0:this.getViewportHeight();var a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,l=o.getSetting("fixedRowsTop"),s=o.getSetting("fixedRowsBottom"),u=o.getSetting("totalRows");return l&&a>=0&&(n=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=n,t-=n),s&&this.dataAccessObject.bottomOverlay.clone&&(n=this.dataAccessObject.bottomOverlay.sumCellSizes(u-s,u),t-=n),e=i.holder.clientHeight===i.holder.offsetHeight?0:On(this.domBindings.rootDocument),new sy({viewportSize:t,scrollOffset:a,totalItems:o.getSetting("totalRows"),itemSizeFn:function(t){return i.getRowHeight(t)},overrideFn:o.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:e})}},{key:"createColumnsCalculator",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jp,e=this.wtSettings,n=this.wtTable,r=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var i=e.getSetting("fixedColumnsStart");if(i&&o>=0){var a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,i);o+=a,r-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(r-=On(this.domBindings.rootDocument)),new my({viewportSize:r,scrollOffset:o,totalItems:e.getSetting("totalColumns"),itemSizeFn:function(t){return n.getColumnWidth(t)},overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),calculationType:t,stretchMode:e.getSetting("stretchH"),stretchingItemWidthFn:function(t,n){return e.getSetting("onBeforeStretchingColumnWidth",t,n)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=t;if(e){var n=this.createRowsCalculator(Zp),r=this.createColumnsCalculator(Zp);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(r)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(Jp),this.columnsRenderCalculator=this.createColumnsCalculator(Jp)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(Zp),this.columnsVisibleCalculator=this.createColumnsCalculator(Zp)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(t){if(!this.rowsVisibleCalculator)return!1;var e=t.startRow,n=t.endRow,r=t.isVisibleInTrimmingContainer;if(null===e&&null===n)return!r;var o=this.rowsRenderCalculator,i=o.startRow,a=o.endRow;return!(e<i||e===i&&e>0)&&!(n>a||n===a&&n<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(t){if(!this.columnsVisibleCalculator)return!1;var e=t.startColumn,n=t.endColumn,r=t.isVisibleInTrimmingContainer;if(null===e&&null===n)return!r;var o=this.columnsRenderCalculator,i=o.startColumn,a=o.endColumn;return!(e<i||e===i&&e>0)&&!(n>a||n===a&&n<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){pt(this.hasOversizedColumnHeadersMarked,(function(t,e,n){n[e]=void 0}))}}]),t}(),Ry=ky;function Ey(t){return Ey="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ey(t)}function Py(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ty(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,My(r.key),r)}}function jy(t,e,n){return e&&Ty(t.prototype,e),n&&Ty(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function My(t){var e=Ay(t,"string");return"symbol"===Ey(e)?e:String(e)}function Ay(t,e){if("object"!==Ey(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ey(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Iy(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xy(t,e)}function xy(t,e){return xy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},xy(t,e)}function _y(t){var e=Dy();return function(){var n,r=Ly(t);if(e){var o=Ly(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Hy(this,n)}}function Hy(t,e){if(e&&("object"===Ey(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ny(t)}function Ny(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Dy(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Ly(t){return Ly=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ly(t)}var By=function(t){Iy(n,t);var e=_y(n);function n(t,r){var o;Py(this,n),o=e.call(this,t,new Np(r));var i=o.wtSettings.getSetting("facade",Ny(o));return o.wtTable=new Qp(o.getTableDao(),i,o.domBindings,o.wtSettings),o.wtViewport=new Ry(o.getViewportDao(),o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.selections=o.wtSettings.getSetting("selections"),o.wtEvent=new ca(i,o.domBindings,o.wtSettings,o.eventManager,o.wtTable,o.selections),o.wtOverlays=new Tp(Ny(o),i,o.domBindings,o.wtSettings,o.eventManager,o.wtTable),o.exportSettingsAsClassNames(),o.findOriginalHeaders(),o}return jy(n,[{key:"exportSettingsAsClassNames",value:function(){var t=this,e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];pt(e,(function(e,o){t.wtSettings.getSetting(o).length&&r.push(e),n.push(e)})),Ye(this.wtTable.wtRootElement.parentNode,n),Ge(this.wtTable.wtRootElement.parentNode,r)}},{key:"getViewportDao",value:function(){var t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}]),n}(sf);function Vy(t){return Vy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vy(t)}function Fy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zy(r.key),r)}}function Uy(t,e,n){return e&&Wy(t.prototype,e),n&&Wy(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function zy(t){var e=Gy(t,"string");return"symbol"===Vy(e)?e:String(e)}function Gy(t,e){if("object"!==Vy(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Vy(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Yy=function(){function t(e){Fy(this,t),e instanceof sf?this._wot=e:this._initFromSettings(e)}return Uy(t,[{key:"_initFromSettings",value:function(e){e.facade=function(e){var n=new t(e);return function(){return n}},this._wot=new By(e.table,e)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(t){this._wot.drawn=t}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(t){this._wot.drawInterrupted=t}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(t){this._wot.lastMouseOver=t}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(t){this._wot.momentumScrolling=t}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(t){this._wot.touchApplied=t}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(t){this._wot.eventListeners=t}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(t,e){return this._wot.createCellCoords(t,e)}},{key:"createCellRange",value:function(t,e,n){return this._wot.createCellRange(t,e,n)}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}},{key:"getCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}},{key:"scrollViewport",value:function(t,e,n,r,o){return this._wot.scrollViewport(t,e,n,r,o)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return this._wot.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return this._wot.scrollViewportVertically(t,e,n)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(t,e){return this._wot.wtSettings.update(t,e),this}},{key:"getSetting",value:function(t,e,n,r,o){return this._wot.wtSettings.getSetting(t,e,n,r,o)}},{key:"hasSetting",value:function(t){return this._wot.wtSettings.hasSetting(t)}},{key:"destroy",value:function(){this._wot.destroy()}}]),t}();function Ky(t){var e=t.isShiftKey,n=t.isLeftClick,r=t.isRightClick,o=t.coords,i=t.selection,a=t.controller,l=t.cellCoordsFactory,s=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),c=i.isSelectedByRowHeader();if(e&&s)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||c)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(l(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(l(s.to.row,o.col)):c&&o.col<0&&!a.row?i.setRangeEnd(l(o.row,s.to.col)):(!u&&!c&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(s.from.row,0),o.row,o.col):(!u&&!c&&o.row<0||c&&o.row<0)&&!a.column&&i.selectColumns(Math.max(s.from.col,0),o.col,o.row);else{var f=!i.inInSelection(o),h=n||r&&f;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function Xy(t){var e=t.isLeftClick,n=t.coords,r=t.selection,o=t.controller,i=t.cellCoordsFactory;if(e){var a=r.isSelectedByRowHeader(),l=r.isSelectedByColumnHeader(),s=r.tableProps.countCols(),u=r.tableProps.countRows();l&&!o.column?r.setRangeEnd(i(u-1,n.col)):a&&!o.row?r.setRangeEnd(i(n.row,s-1)):o.cell||r.setRangeEnd(n)}}var $y=new Map([["mousedown",Ky],["mouseover",Xy],["touchstart",Ky]]);function qy(t,e){var n=e.coords,r=e.selection,o=e.controller,i=e.cellCoordsFactory;$y.get(t.type)({coords:n,selection:r,controller:o,cellCoordsFactory:i,isShiftKey:t.shiftKey,isLeftClick:tr(t)||"touchstart"===t.type,isRightClick:Zn(t)})}var Qy=new WeakMap,Jy=Symbol("rootInstance");function Zy(t){Qy.set(t,!0)}function tv(t){return t===Jy}function ev(t){return Qy.has(t)}function nv(t){return nv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nv(t)}function rv(t,e){return av(t)||iv(t,e)||uv(t,e)||ov()}function ov(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function iv(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function av(t){if(Array.isArray(t))return t}function lv(t){return fv(t)||cv(t)||uv(t)||sv()}function sv(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function uv(t,e){if(t){if("string"===typeof t)return hv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hv(t,e):void 0}}function cv(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function fv(t){if(Array.isArray(t))return hv(t)}function hv(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function dv(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bv(r.key),r)}}function yv(t,e,n){return e&&pv(t.prototype,e),n&&pv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function vv(t,e,n){mv(t,e),e.set(t,n)}function mv(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gv(t,e,n){return e=bv(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bv(t){var e=wv(t,"string");return"symbol"===nv(e)?e:String(e)}function wv(t,e){if("object"!==nv(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==nv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Sv(t,e){var n=kv(t,e,"get");return Cv(t,n)}function Cv(t,e){return e.get?e.get.call(t):e.value}function Ov(t,e,n){var r=kv(t,e,"set");return Rv(t,r,n),n}function kv(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Rv(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ev=new WeakMap,Pv=new WeakMap,Tv=new WeakMap,jv=function(){function t(e){dv(this,t),gv(this,"instance",void 0),gv(this,"eventManager",void 0),gv(this,"settings",void 0),gv(this,"THEAD",void 0),gv(this,"TBODY",void 0),gv(this,"_wt",void 0),gv(this,"activeWt",void 0),vv(this,Pv,{writable:!0,value:0}),vv(this,Tv,{writable:!0,value:0}),gv(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new Gr(this.instance),this.settings=this.instance.getSettings(),Ev.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return yv(t,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(t)}},{key:"getCellAtCoords",value:function(t,e){var n=this._wt.getCell(t,e);return n<0?null:n}},{key:"scrollViewport",value:function(t,e,n,r,o){return this._wt.scrollViewport(t,e,n,r,o)}},{key:"scrollViewportHorizontally",value:function(t,e,n){return this._wt.scrollViewportHorizontally(t,e,n)}},{key:"scrollViewportVertically",value:function(t,e,n){return this._wt.scrollViewportVertically(t,e,n)}},{key:"createElements",value:function(){var t=Ev.get(this),e=this.instance,n=e.rootElement,r=e.rootDocument,o=n.getAttribute("style");o&&n.setAttribute("data-originalstyle",o),Ge(n,"handsontable"),t.table=r.createElement("TABLE"),Ge(t.table,"htCore"),this.instance.getSettings().tableClassName&&Ge(t.table,this.instance.getSettings().tableClassName),this.THEAD=r.createElement("THEAD"),t.table.appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),t.table.appendChild(this.TBODY),this.instance.table=t.table,this.instance.container.insertBefore(t.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var t=this,e=Ev.get(this),n=this.instance,r=n.rootElement,o=n.rootDocument,i=n.selection,a=o.documentElement;this.eventManager.addEventListener(r,"mousedown",(function(n){if(e.selectionMouseDown=!0,!t.isTextSelectionAllowed(n.target)){var r=t.instance.rootWindow;wn(r),n.preventDefault(),r.focus()}})),this.eventManager.addEventListener(r,"mouseup",(function(){e.selectionMouseDown=!1})),this.eventManager.addEventListener(r,"mousemove",(function(n){e.selectionMouseDown&&!t.isTextSelectionAllowed(n.target)&&(t.settings.fragmentSelection&&wn(t.instance.rootWindow),n.preventDefault())})),this.eventManager.addEventListener(a,"keyup",(function(t){i.isInProgress()&&!t.shiftKey&&i.finish()})),this.eventManager.addEventListener(a,"mouseup",(function(n){i.isInProgress()&&tr(n)&&i.finish(),e.mouseDown=!1,!Mn(o.activeElement)&&(i.isSelected()||i.isSelectedByAnyHeader()||r.contains(n.target)||Zn(n))||t.instance.unlisten()})),this.eventManager.addEventListener(a,"contextmenu",(function(t){i.isInProgress()&&Zn(t)&&(i.finish(),e.mouseDown=!1)})),this.eventManager.addEventListener(a,"touchend",(function(){i.isInProgress()&&i.finish(),e.mouseDown=!1})),this.eventManager.addEventListener(a,"mousedown",(function(n){var i=n.target,l=n.x||n.clientX,s=n.y||n.clientY,u=n.target;if(!e.mouseDown&&r&&t.instance.view){var c=t.instance.view._wt.wtTable.holder;if(u===c){var f=On(o);if(o.elementFromPoint(l+f,s)!==c||o.elementFromPoint(l,s+f)!==c)return}else while(u!==a){if(null===u){if(n.isTargetWebComponent)break;return}if(u===r)return;u=u.parentNode}var h="function"===typeof t.settings.outsideClickDeselects?t.settings.outsideClickDeselects(i):t.settings.outsideClickDeselects;h?t.instance.deselectCell():t.instance.destroyEditor(!1,!1)}})),this.eventManager.addEventListener(e.table,"selectstart",(function(e){t.settings.fragmentSelection||jn(e.target)||e.preventDefault()}))}},{key:"translateFromRenderableToVisualCoords",value:function(t){var e,n=t.row,r=t.col;return(e=this.instance)._createCellCoords.apply(e,lv(this.translateFromRenderableToVisualIndex(n,r)))}},{key:"translateFromRenderableToVisualIndex",value:function(t,e){var n=t>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t,r=e>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===n&&(n=t),null===r&&(r=e),[n,r]}},{key:"countRenderableIndexes",value:function(t,e){var n=Math.min(t.getNotTrimmedIndexesLength(),e),r=t.getNearestNotHiddenIndex(n-1,-1);return null===r?0:t.getRenderableFromVisualIndex(r)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(t,e){return this.countNotHiddenIndexes(t,e,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(t,e){return this.countNotHiddenIndexes(t,e,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(t,e,n,r){if(isNaN(t)||t<0)return 0;var o=n.getNearestNotHiddenIndex(t,e),i=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(i))return 0;var a=0;return e<0?a=i+1:e>0&&(a=r-i),a}},{key:"countNotHiddenFixedColumnsStart",value:function(){var t=this.instance.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var t=this.instance.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var t=this.instance.countRows(),e=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>t&&this.instance.countRenderedCols()>e}},{key:"initializeWalkontable",value:function(){var t=this,e=Ev.get(this),n={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e.table,isDataViewInstance:function(){return ev(t.instance)},preventOverflow:function(){return t.settings.preventOverflow},preventWheel:function(){return t.settings.preventWheel},stretchH:function(){return t.settings.stretchH},data:function(e,n){var r;return(r=t.instance).getDataAtCell.apply(r,lv(t.translateFromRenderableToVisualIndex(e,n)))},totalRows:function(){return t.countRenderableRows()},totalColumns:function(){return t.countRenderableColumns()},fixedColumnsStart:function(){return t.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return t.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return t.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return t.settings.fixedColumnsStart>0||n.rowHeaders().length>0},shouldRenderTopOverlay:function(){return t.settings.fixedRowsTop>0||n.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return t.settings.fixedRowsBottom>0},minSpareRows:function(){return t.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var e=[];return t.instance.hasRowHeaders()&&e.push((function(e,n){var r=e>=0?t.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e;t.appendRowHeader(r,n)})),t.instance.runHooks("afterGetRowHeaderRenderers",e),Ov(t,Tv,e.length),e},columnHeaders:function(){var e=[];return t.instance.hasColHeaders()&&e.push((function(e,n){var r=e>=0?t.instance.columnIndexMapper.getVisualFromRenderableIndex(e):e;t.appendColHeader(r,n)})),t.instance.runHooks("afterGetColumnHeaderRenderers",e),Ov(t,Pv,e.length),e},columnWidth:function(e){var n=t.instance.columnIndexMapper.getVisualFromRenderableIndex(e);return t.instance.getColWidth(null===n?e:n)},rowHeight:function(e){var n=t.instance.rowIndexMapper.getVisualFromRenderableIndex(e);return t.instance.getRowHeight(null===n?e:n)},cellRenderer:function(e,n,r){var o=t.translateFromRenderableToVisualIndex(e,n),i=rv(o,2),a=i[0],l=i[1],s=t.instance.runHooks("modifyGetCellCoords",a,l),u=a,c=l;if(Array.isArray(s)){var f=rv(s,2);u=f[0],c=f[1]}var h=t.instance.getCellMeta(u,c),d=t.instance.colToProp(c),p=t.instance.getDataAtRowProp(u,d);t.instance.hasHook("beforeValueRender")&&(p=t.instance.runHooks("beforeValueRender",p,h)),t.instance.runHooks("beforeRenderer",r,a,l,d,p,h),t.instance.getCellRenderer(h)(t.instance,r,a,l,d,p,h),t.instance.runHooks("afterRenderer",r,a,l,d,p,h)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return t.settings.fragmentSelection},onWindowResize:function(){t.instance&&!t.instance.isDestroyed&&t.instance.refreshDimensions()},onContainerElementResize:function(){t.instance&&!t.instance.isDestroyed&&t.instance.refreshDimensions()},onCellMouseDown:function(n,r,o,i){var a=t.translateFromRenderableToVisualCoords(r),l={row:!1,column:!1,cell:!1};t.instance.listen(),t.activeWt=i,e.mouseDown=!0,t.instance.runHooks("beforeOnCellMouseDown",n,a,o,l),Jn(n)||(qy(n,{coords:a,selection:t.instance.selection,controller:l,cellCoordsFactory:function(e,n){return t.instance._createCellCoords(e,n)}}),t.instance.runHooks("afterOnCellMouseDown",n,a,o),t.activeWt=t._wt)},onCellContextMenu:function(n,r,o,i){var a=t.translateFromRenderableToVisualCoords(r);t.activeWt=i,e.mouseDown=!1,t.instance.selection.isInProgress()&&t.instance.selection.finish(),t.instance.runHooks("beforeOnCellContextMenu",n,a,o),Jn(n)||(t.instance.runHooks("afterOnCellContextMenu",n,a,o),t.activeWt=t._wt)},onCellMouseOut:function(e,n,r,o){var i=t.translateFromRenderableToVisualCoords(n);t.activeWt=o,t.instance.runHooks("beforeOnCellMouseOut",e,i,r),Jn(e)||(t.instance.runHooks("afterOnCellMouseOut",e,i,r),t.activeWt=t._wt)},onCellMouseOver:function(n,r,o,i){var a=t.translateFromRenderableToVisualCoords(r),l={row:!1,column:!1,cell:!1};t.activeWt=i,t.instance.runHooks("beforeOnCellMouseOver",n,a,o,l),Jn(n)||(e.mouseDown&&qy(n,{coords:a,selection:t.instance.selection,controller:l,cellCoordsFactory:function(e,n){return t.instance._createCellCoords(e,n)}}),t.instance.runHooks("afterOnCellMouseOver",n,a,o),t.activeWt=t._wt)},onCellMouseUp:function(e,n,r,o){var i=t.translateFromRenderableToVisualCoords(n);t.activeWt=o,t.instance.runHooks("beforeOnCellMouseUp",e,i,r),Jn(e)||t.instance.isDestroyed||(t.instance.runHooks("afterOnCellMouseUp",e,i,r),t.activeWt=t._wt)},onCellCornerMouseDown:function(e){e.preventDefault(),t.instance.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:function(e){e.preventDefault(),t.instance.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:function(e,n){return t.beforeRender(e,n)},onDraw:function(e){return t.afterRender(e)},onScrollVertically:function(){return t.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return t.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return t.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(e,n,r){var o=t.instance.rowIndexMapper,i=o.getVisualFromRenderableIndex(e),a=t.instance.runHooks("beforeHighlightingRowHeader",i,n,r);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,1))},onBeforeHighlightingColumnHeader:function(e,n,r){var o=t.instance.columnIndexMapper,i=o.getVisualFromRenderableIndex(e),a=t.instance.runHooks("beforeHighlightingColumnHeader",i,n,r);return o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,1))},onAfterDrawSelection:function(e,n,r){var o,i=t.translateFromRenderableToVisualIndex(e,n),a=rv(i,2),l=a[0],s=a[1],u=t.instance.selection.getSelectedRange(),c=u.size();if(c>0){var f=(null!==r&&void 0!==r?r:0)+1-c,h=u.peekByIndex(f);o=[h.from.row,h.from.col,h.to.row,h.to.col]}return t.instance.runHooks("afterDrawSelection",l,s,o,r)},onBeforeDrawBorders:function(e,n){var r=rv(e,4),o=r[0],i=r[1],a=r[2],l=r[3],s=[t.instance.rowIndexMapper.getVisualFromRenderableIndex(o),t.instance.columnIndexMapper.getVisualFromRenderableIndex(i),t.instance.rowIndexMapper.getVisualFromRenderableIndex(a),t.instance.columnIndexMapper.getVisualFromRenderableIndex(l)];return t.instance.runHooks("beforeDrawBorders",s,n)},onBeforeTouchScroll:function(){return t.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return t.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(e,n){var r=t.instance.columnIndexMapper.getVisualFromRenderableIndex(n);return t.instance.runHooks("beforeStretchingColumnWidth",e,r)},onModifyRowHeaderWidth:function(e){return t.instance.runHooks("modifyRowHeaderWidth",e)},onModifyGetCellCoords:function(e,n,r){var o=t.instance.rowIndexMapper,i=t.instance.columnIndexMapper,a=n>=0?i.getVisualFromRenderableIndex(n):n,l=e>=0?o.getVisualFromRenderableIndex(e):e,s=t.instance.runHooks("modifyGetCellCoords",l,a,r);if(Array.isArray(s)){var u=rv(s,4),c=u[0],f=u[1],h=u[2],d=u[3];return[c>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(c,1)):c,f>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(f,1)):f,h>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1)):h,d>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(d,-1)):d]}},viewportRowCalculatorOverride:function(e){var n=t.settings.viewportRowRenderingOffset;if("auto"===n&&t.settings.fixedRowsTop&&(n=10),n>0||"auto"===n){var r=t.countRenderableRows(),o=e.startRow,i=e.endRow;if("number"===typeof n)e.startRow=Math.max(o-n,0),e.endRow=Math.min(i+n,r-1);else if("auto"===n){var a=Math.ceil(i/r*12);e.startRow=Math.max(o-a,0),e.endRow=Math.min(i+a,r-1)}}t.instance.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:function(e){var n=t.settings.viewportColumnRenderingOffset;if("auto"===n&&t.settings.fixedColumnsStart&&(n=10),n>0||"auto"===n){var r=t.countRenderableColumns(),o=e.startColumn,i=e.endColumn;if("number"===typeof n&&(e.startColumn=Math.max(o-n,0),e.endColumn=Math.min(i+n,r-1)),"auto"===n){var a=Math.ceil(i/r*6);e.startColumn=Math.max(o-a,0),e.endColumn=Math.min(i+a,r-1)}}t.instance.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:function(){return t.settings.rowHeaderWidth},columnHeaderHeight:function(){var e=t.instance.runHooks("modifyColumnHeaderHeight");return t.settings.columnHeaderHeight||e}};this.instance.runHooks("beforeInitWalkontable",n),this._wt=new Yy(n),this.activeWt=this._wt;var r=this._wt.wtTable.spreader,o=this.instance.rootElement.getBoundingClientRect(),i=o.width,a=o.height;this.setLastSize(i,a),this.eventManager.addEventListener(r,"mousedown",(function(t){t.target===r&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(r,"contextmenu",(function(t){t.target===r&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(function(){t.settings.observeDOMVisibility&&t._wt.drawInterrupted&&(t.instance.forceFullRender=!0,t.render())}))}},{key:"isTextSelectionAllowed",value:function(t){if(jn(t))return!0;var e=Le(t,this.instance.view._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}},{key:"isMouseDown",value:function(){return Ev.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var t,e;return null!==(t=null===(e=this.instance.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&void 0!==t&&t}},{key:"isCellEdited",value:function(){var t=this.instance.getActiveEditor();return t&&t.isOpened()}},{key:"beforeRender",value:function(t,e){t&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,e)}},{key:"afterRender",value:function(t){t&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(t,e){if(e.firstChild){var n=e.firstChild;if(!ze(n,"relative"))return Xe(e),void this.appendRowHeader(t,e);this.updateCellHeader(n.querySelector(".rowHeader"),t,this.instance.getRowHeader)}else{var r=this.instance,o=r.rootDocument,i=r.getRowHeader,a=o.createElement("div"),l=o.createElement("span");a.className="relative",l.className="rowHeader",this.updateCellHeader(l,t,i),a.appendChild(l),e.appendChild(a)}this.instance.runHooks("afterGetRowHeader",t,e)}},{key:"appendColHeader",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.instance.getColHeader,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e.firstChild){var o=e.firstChild;ze(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),t,n,r):(Xe(e),this.appendColHeader(t,e,n,r))}else{var i=this.instance.rootDocument,a=i.createElement("div"),l=i.createElement("span");a.className="relative",l.className="colHeader",this.updateCellHeader(l,t,n,r),a.appendChild(l),e.appendChild(a)}this.instance.runHooks("afterGetColHeader",t,e,r)}},{key:"updateCellHeader",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e,i=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&(ze(t,"colHeader")?o=i.wtTable.columnFilter.sourceToRendered(e):ze(t,"rowHeader")&&(o=i.wtTable.rowFilter.sourceToRendered(e))),o>-1?Qe(t,n(e,r)):(Je(t,String.fromCharCode(160)),Ge(t,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(t){var e=this._wt.wtViewport.getWorkspaceWidth(),n=e-t;return n>0?n:0}},{key:"maximumVisibleElementHeight",value:function(t){var e=this._wt.wtViewport.getWorkspaceHeight(),n=e-t;return n>0?n:0}},{key:"setLastSize",value:function(t,e){var n=Ev.get(this),r=[t,e];n.lastWidth=r[0],n.lastHeight=r[1]}},{key:"getLastSize",value:function(){var t=Ev.get(this);return{width:t.lastWidth,height:t.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return Sv(this,Pv)}},{key:"getRowHeadersCount",value:function(){return Sv(this,Tv)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),t}(),Mv=jv;function Av(t){return Av="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Av(t)}var Iv="ABCDEFGHIJKLMNOPQRSTUVWXYZ",xv=Iv.length;function _v(t){var e,n=t+1,r="";while(n>0)e=(n-1)%xv,r=String.fromCharCode(65+e)+r,n=parseInt((n-e)/xv,10);return r}function Hv(t){var e=0;if(t)for(var n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=Math.pow(xv,r)*(Iv.indexOf(t[n])+1);return e-=1,e}function Nv(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(t=0;t<n;t++){var i=[];for(e=0;e<r;e++)i.push(_v(e)+(t+1));o.push(i)}return o}function Dv(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(t=0;t<n;t++){var i={};for(e=0;e<r;e++)i["prop".concat(e)]=_v(e)+(t+1);o.push(i)}return o}function Lv(t,e){for(var n,r=[],o=0;o<t;o++){n=[];for(var i=0;i<e;i++)n.push("");r.push(n)}return r}function Bv(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t,r=[];return Array.isArray(t)&&Array.isArray(t[0])||(n=[t]),n.forEach((function(t,n){Array.isArray(t)?t.forEach((function(t,o){r.push([n+e,o,t])})):Object.keys(t).forEach((function(o){r.push([n+e,o,t[o]])}))})),r}function Vv(t){var e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&ht(t[0])&&(e=mt(t[0]))),e}function Fv(t){return!!(Array.isArray(t)&&t.length&&t.every((function(t){return Array.isArray(t)})))}function Wv(t){return!!(Array.isArray(t)&&t.length&&t.every((function(t){return"object"===Av(t)&&!Array.isArray(t)&&null!==t})))}function Uv(t){return Uv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uv(t)}function zv(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Kv(r.key),r)}}function Yv(t,e,n){return e&&Gv(t.prototype,e),n&&Gv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Kv(t){var e=Xv(t,"string");return"symbol"===Uv(e)?e:String(e)}function Xv(t,e){if("object"!==Uv(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Uv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var $v=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];zv(this,t),this.hot=e,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return Yv(t,[{key:"modifyRowData",value:function(t){var e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}},{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}},{key:"setData",value:function(t){this.data=t}},{key:"getAtColumn",value:function(t){var e=this,n=[];return U(this.data,(function(r,o){var i=e.getAtCell(o,t);n.push(i)})),n}},{key:"getAtRow",value:function(t,e,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=void 0===e&&void 0===n,a=null,l=null;if(a=this.modifyRowData(t),Array.isArray(a))l=[],i?a.forEach((function(e,n){l[n]=r.getAtPhysicalCell(t,n,a)})):Ho(e,n,(function(n){l[n-e]=r.getAtPhysicalCell(t,n,a)}));else if(ht(a)||_n(a))if(l=o?[]:{},!i||o){var s=0,u=this.countFirstRowKeys()-1;Ho(s,u,(function(i){var c=r.colToProp(i);if(i>=(e||s)&&i<=(n||u)&&!Number.isInteger(c)){var f=r.getAtPhysicalCell(t,c,a);o?l.push(f):vt(l,c,f)}}))}else pt(a,(function(e,n){vt(l,n,r.getAtPhysicalCell(t,n,a))}));return l}},{key:"setAtCell",value:function(t,e,n){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var r=gt(n);this.hot.runHooks("modifySourceData",t,e,r,"set"),r.isTouched()&&(n=r.value)}Number.isInteger(e)?this.data[t][e]=n:vt(this.data[t],e,n)}}},{key:"getAtPhysicalCell",value:function(t,e,n){var r=null;if(n&&(r="string"===typeof e?yt(n,e):"function"===typeof e?e(n):n[e]),this.hot.hasHook("modifySourceData")){var o=gt(r);this.hot.runHooks("modifySourceData",t,e,o,"get"),o.isTouched()&&(r=o.value)}return r}},{key:"getAtCell",value:function(t,e){var n=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),n)}},{key:"getByRange",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,i=null,a=null,l=null,s=null;null===e||null===n?(o=!0,i=0,l=this.countRows()-1):(i=Math.min(e.row,n.row),a=Math.min(e.col,n.col),l=Math.max(e.row,n.row),s=Math.max(e.col,n.col));var u=[];return Ho(i,l,(function(e){u.push(o?t.getAtRow(e,void 0,void 0,r):t.getAtRow(e,a,s,r))})),u}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}},{key:"countFirstRowKeys",value:function(){return Vv(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),t}(),qv=$v,Qv=(n(8529),"localHooks"),Jv={_localHooks:Object.create(null),addLocalHook:function(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks:function(t,e,n,r,o,i,a){if(this._localHooks[t])for(var l=this._localHooks[t].length,s=0;s<l;s++)Wn(this._localHooks[t][s],this,e,n,r,o,i,a)},clearLocalHooks:function(){return this._localHooks={},this}};dt(Jv,"MIXIN_NAME",Qv,{writable:!1,enumerable:!1});var Zv=Jv;function tm(t){return tm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tm(t)}function em(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nm(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,om(r.key),r)}}function rm(t,e,n){return e&&nm(t.prototype,e),n&&nm(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function om(t){var e=im(t,"string");return"symbol"===tm(e)?e:String(e)}function im(t,e){if("object"!==tm(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==tm(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var am=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;em(this,t),this.indexedValues=[],this.initValueOrFn=e}return rm(t,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(t){var e=this.indexedValues;if(t<e.length)return e[t]}},{key:"setValues",value:function(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,_n(this.initValueOrFn)?Ho(e-1,(function(e){return t.indexedValues.push(t.initValueOrFn(e))})):Ho(e-1,(function(){return t.indexedValues.push(t.initValueOrFn)})),this.runLocalHooks("change")}},{key:"init",value:function(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),t}();function lm(t){return fm(t)||cm(t)||um(t)||sm()}function sm(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function um(t,e){if(t){if("string"===typeof t)return hm(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hm(t,e):void 0}}function cm(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function fm(t){if(Array.isArray(t))return hm(t)}function hm(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function dm(t,e,n){return[].concat(lm(t.slice(0,e)),lm(n),lm(t.slice(e)))}function pm(t,e){return F(t,(function(t){return!1===e.includes(t)}))}function ym(t,e){return W(t,(function(t){return t-e.filter((function(e){return e<t})).length}))}function vm(t,e){var n=e[0],r=e.length;return W(t,(function(t){return t>=n?t+r:t}))}function mm(t){return mm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mm(t)}function gm(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bm(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Sm(r.key),r)}}function wm(t,e,n){return e&&bm(t.prototype,e),n&&bm(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Sm(t){var e=Cm(t,"string");return"symbol"===mm(e)?e:String(e)}function Cm(t,e){if("object"!==mm(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==mm(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Om(){return Om="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=km(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Om.apply(this,arguments)}function km(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Am(t),null===t)break;return t}function Rm(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Em(t,e)}function Em(t,e){return Em=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Em(t,e)}function Pm(t){var e=Mm();return function(){var n,r=Am(t);if(e){var o=Am(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Tm(this,n)}}function Tm(t,e){if(e&&("object"===mm(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return jm(t)}function jm(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Mm(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Am(t){return Am=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Am(t)}ct(am,Zv);var Im=function(t){Rm(n,t);var e=Pm(n);function n(){return gm(this,n),e.call(this,(function(t){return t}))}return wm(n,[{key:"insert",value:function(t,e){var r=vm(this.indexedValues,e);this.indexedValues=dm(r,t,e),Om(Am(n.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){var e=pm(this.indexedValues,t);this.indexedValues=ym(e,t),Om(Am(n.prototype),"remove",this).call(this,t)}}]),n}(am);function xm(t){return Dm(t)||Nm(t)||Hm(t)||_m()}function _m(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Hm(t,e){if(t){if("string"===typeof t)return Lm(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lm(t,e):void 0}}function Nm(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Dm(t){if(Array.isArray(t))return Lm(t)}function Lm(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Bm(t,e,n,r){var o=n.length?n[0]:void 0;return[].concat(xm(t.slice(0,o)),xm(n.map((function(t,e){return _n(r)?r(t,e):r}))),xm(void 0===o?[]:t.slice(o)))}function Vm(t,e){return F(t,(function(t,n){return!1===e.includes(n)}))}function Fm(t){return Fm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fm(t)}function Wm(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Um(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Gm(r.key),r)}}function zm(t,e,n){return e&&Um(t.prototype,e),n&&Um(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gm(t){var e=Ym(t,"string");return"symbol"===Fm(e)?e:String(e)}function Ym(t,e){if("object"!==Fm(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Fm(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Km(){return Km="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Xm(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Km.apply(this,arguments)}function Xm(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=eg(t),null===t)break;return t}function $m(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qm(t,e)}function qm(t,e){return qm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},qm(t,e)}function Qm(t){var e=tg();return function(){var n,r=eg(t);if(e){var o=eg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jm(this,n)}}function Jm(t,e){if(e&&("object"===Fm(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Zm(t)}function Zm(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tg(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function eg(t){return eg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},eg(t)}var ng=function(t){$m(n,t);var e=Qm(n);function n(){return Wm(this,n),e.apply(this,arguments)}return zm(n,[{key:"insert",value:function(t,e){this.indexedValues=Bm(this.indexedValues,t,e,this.initValueOrFn),Km(eg(n.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){this.indexedValues=Vm(this.indexedValues,t),Km(eg(n.prototype),"remove",this).call(this,t)}}]),n}(am);function rg(t){return rg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rg(t)}function og(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ig(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lg(r.key),r)}}function ag(t,e,n){return e&&ig(t.prototype,e),n&&ig(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function lg(t){var e=sg(t,"string");return"symbol"===rg(e)?e:String(e)}function sg(t,e){if("object"!==rg(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==rg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ug(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cg(t,e)}function cg(t,e){return cg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},cg(t,e)}function fg(t){var e=pg();return function(){var n,r=yg(t);if(e){var o=yg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hg(this,n)}}function hg(t,e){if(e&&("object"===rg(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return dg(t)}function dg(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pg(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function yg(t){return yg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yg(t)}var vg=function(t){ug(n,t);var e=fg(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return og(this,n),e.call(this,t)}return ag(n,[{key:"getHiddenIndexes",value:function(){return V(this.getValues(),(function(t,e,n){return e&&t.push(n),t}),[])}}]),n}(ng);function mg(t){return mg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mg(t)}function gg(t){return Cg(t)||Sg(t)||wg(t)||bg()}function bg(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function wg(t,e){if(t){if("string"===typeof t)return Og(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Og(t,e):void 0}}function Sg(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Cg(t){if(Array.isArray(t))return Og(t)}function Og(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function kg(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Dg(r.key),r)}}function Eg(t,e,n){return e&&Rg(t.prototype,e),n&&Rg(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Pg(){return Pg="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Tg(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Pg.apply(this,arguments)}function Tg(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Hg(t),null===t)break;return t}function jg(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mg(t,e)}function Mg(t,e){return Mg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Mg(t,e)}function Ag(t){var e=_g();return function(){var n,r=Hg(t);if(e){var o=Hg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ig(this,n)}}function Ig(t,e){if(e&&("object"===mg(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return xg(t)}function xg(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _g(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Hg(t){return Hg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Hg(t)}function Ng(t,e,n){return e=Dg(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dg(t){var e=Lg(t,"string");return"symbol"===mg(e)?e:String(e)}function Lg(t,e){if("object"!==mg(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==mg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Bg=function(t){jg(n,t);var e=Ag(n);function n(){var t;kg(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),Ng(xg(t),"orderOfIndexes",[]),t}return Eg(n,[{key:"getValues",value:function(){var t=this;return this.orderOfIndexes.map((function(e){return t.indexedValues[e]}))}},{key:"setValues",value:function(t){this.orderOfIndexes=gg(Array(t.length).keys()),Pg(Hg(n.prototype),"setValues",this).call(this,t)}},{key:"setValueAtIndex",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(n,0,t),this.runLocalHooks("change"),!0)}},{key:"clearValue",value:function(t){this.orderOfIndexes=pm(this.orderOfIndexes,[t]),_n(this.initValueOrFn)?Pg(Hg(n.prototype),"setValueAtIndex",this).call(this,t,this.initValueOrFn(t)):Pg(Hg(n.prototype),"setValueAtIndex",this).call(this,t,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,Pg(Hg(n.prototype),"setDefaultValues",this).call(this,t)}},{key:"insert",value:function(t,e){this.indexedValues=Bm(this.indexedValues,t,e,this.initValueOrFn),this.orderOfIndexes=vm(this.orderOfIndexes,e),Pg(Hg(n.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){this.indexedValues=Vm(this.indexedValues,t),this.orderOfIndexes=pm(this.orderOfIndexes,t),this.orderOfIndexes=ym(this.orderOfIndexes,t),Pg(Hg(n.prototype),"remove",this).call(this,t)}},{key:"getEntries",value:function(){var t=this;return this.orderOfIndexes.map((function(e){return[e,t.getValueAtIndex(e)]}))}}]),n}(am);function Vg(t){return Vg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vg(t)}function Fg(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zg(r.key),r)}}function Ug(t,e,n){return e&&Wg(t.prototype,e),n&&Wg(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function zg(t){var e=Gg(t,"string");return"symbol"===Vg(e)?e:String(e)}function Gg(t,e){if("object"!==Vg(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Vg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Yg(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Kg(t,e)}function Kg(t,e){return Kg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Kg(t,e)}function Xg(t){var e=Qg();return function(){var n,r=Jg(t);if(e){var o=Jg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $g(this,n)}}function $g(t,e){if(e&&("object"===Vg(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return qg(t)}function qg(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qg(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Jg(t){return Jg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jg(t)}var Zg=function(t){Yg(n,t);var e=Xg(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Fg(this,n),e.call(this,t)}return Ug(n,[{key:"getTrimmedIndexes",value:function(){return V(this.getValues(),(function(t,e,n){return e&&t.push(n),t}),[])}}]),n}(ng),tb=new Map([["hiding",vg],["index",am],["linkedPhysicalIndexToValue",Bg],["physicalIndexToValue",ng],["trimming",Zg]]);function eb(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!tb.has(t))throw new Error('The provided map type ("'.concat(t,'") does not exist.'));return new(tb.get(t))(e)}function nb(t){return nb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nb(t)}function rb(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ob(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ab(r.key),r)}}function ib(t,e,n){return e&&ob(t.prototype,e),n&&ob(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ab(t){var e=lb(t,"string");return"symbol"===nb(e)?e:String(e)}function lb(t,e){if("object"!==nb(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==nb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var sb=0,ub=function(){function t(){rb(this,t),this.collection=new Map}return ib(t,[{key:"register",value:function(t,e){var n=this;!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",(function(){return n.runLocalHooks("change",e)})),sb+=1)}},{key:"unregister",value:function(t){var e=this.collection.get(t);Zt(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),sb-=1)}},{key:"unregisterAll",value:function(){var t=this;this.collection.forEach((function(e,n){return t.unregister(n)})),this.collection.clear()}},{key:"get",value:function(t){return te(t)?Array.from(this.collection.values()):this.collection.get(t)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(t){this.collection.forEach((function(e){e.remove(t)}))}},{key:"insertToEvery",value:function(t,e){this.collection.forEach((function(n){n.insert(t,e)}))}},{key:"initEvery",value:function(t){this.collection.forEach((function(e){e.init(t)}))}}]),t}();function cb(){return sb}function fb(t){return fb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fb(t)}function hb(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function db(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yb(r.key),r)}}function pb(t,e,n){return e&&db(t.prototype,e),n&&db(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function yb(t){var e=vb(t,"string");return"symbol"===fb(e)?e:String(e)}function vb(t,e){if("object"!==fb(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==fb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function mb(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gb(t,e)}function gb(t,e){return gb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},gb(t,e)}function bb(t){var e=Cb();return function(){var n,r=Ob(t);if(e){var o=Ob(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wb(this,n)}}function wb(t,e){if(e&&("object"===fb(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Sb(t)}function Sb(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Cb(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Ob(t){return Ob=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ob(t)}ct(ub,Zv);var kb=function(t){mb(n,t);var e=bb(n);function n(t,r){var o;return hb(this,n),o=e.call(this),o.mergedValuesCache=[],o.aggregationFunction=t,o.fallbackValue=r,o}return pb(n,[{key:"getMergedValues",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===t)return this.mergedValuesCache;if(0===this.getLength())return[];for(var e=W(this.get(),(function(t){return t.getValues()})),n=[],r=Zt(e[0])&&e[0].length||0,o=0;o<r;o+=1){for(var i=[],a=0;a<this.getLength();a+=1)i.push(e[a][o]);n.push(i)}return W(n,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(t,e){var n=this.getMergedValues(e)[t];return Zt(n)?n:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),n}(ub);function Rb(t){return Rb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rb(t)}function Eb(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,jb(r.key),r)}}function Tb(t,e,n){return e&&Pb(t.prototype,e),n&&Pb(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function jb(t){var e=Mb(t,"string");return"symbol"===Rb(e)?e:String(e)}function Mb(t,e){if("object"!==Rb(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Rb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ab(t,e,n){Ib(t,e),e.set(t,n)}function Ib(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xb(t,e,n){var r=Nb(t,e,"set");return _b(t,r,n),n}function _b(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Hb(t,e){var n=Nb(t,e,"get");return Db(t,n)}function Nb(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Db(t,e){return e.get?e.get.call(t):e.value}var Lb=new WeakMap,Bb=function(){function t(){Eb(this,t),Ab(this,Lb,{writable:!0,value:[]})}return Tb(t,[{key:"subscribe",value:function(t){return this.addLocalHook("change",t),this._write(Hb(this,Lb)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(t){return t.length>0&&this.runLocalHooks("change",t),this}},{key:"_writeInitialChanges",value:function(t){xb(this,Lb,t)}}]),t}();function Vb(t,e){for(var n=[],r=0,o=0;r<t.length&&o<e.length;r++,o++)t[r]!==e[o]&&n.push({op:"replace",index:o,oldValue:t[r],newValue:e[o]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;o<t.length;o++)n.push({op:"remove",index:o,oldValue:t[o],newValue:void 0});return n}function Fb(t){return Fb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fb(t)}function Wb(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ub(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Gb(r.key),r)}}function zb(t,e,n){return e&&Ub(t.prototype,e),n&&Ub(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gb(t){var e=Yb(t,"string");return"symbol"===Fb(e)?e:String(e)}function Yb(t,e){if("object"!==Fb(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Fb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Kb(t,e,n){Xb(t,e),e.set(t,n)}function Xb(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $b(t,e){var n=Jb(t,e,"get");return qb(t,n)}function qb(t,e){return e.get?e.get.call(t):e.value}function Qb(t,e,n){var r=Jb(t,e,"set");return Zb(t,r,n),n}function Jb(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Zb(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}ct(Bb,Zv);var tw=new WeakMap,ew=new WeakMap,nw=new WeakMap,rw=new WeakMap,ow=new WeakMap,iw=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.initialIndexValue;Wb(this,t),Kb(this,tw,{writable:!0,value:new Set}),Kb(this,ew,{writable:!0,value:[]}),Kb(this,nw,{writable:!0,value:[]}),Kb(this,rw,{writable:!0,value:!1}),Kb(this,ow,{writable:!0,value:!1}),Qb(this,ow,null!==n&&void 0!==n&&n)}return zb(t,[{key:"createObserver",value:function(){var t=this,e=new Bb;return $b(this,tw).add(e),e.addLocalHook("unsubscribe",(function(){$b(t,tw).delete(e)})),e._writeInitialChanges(Vb($b(this,ew),$b(this,nw))),e}},{key:"emit",value:function(t){var e=$b(this,nw);$b(this,rw)&&$b(this,ew).length===t.length||(0===t.length?t=new Array(e.length).fill($b(this,ow)):Qb(this,ew,new Array(t.length).fill($b(this,ow))),$b(this,rw)||(Qb(this,rw,!0),e=$b(this,ew)));var n=Vb(e,t);$b(this,tw).forEach((function(t){return t._write(n)})),Qb(this,nw,t)}}]),t}();function aw(t){return aw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aw(t)}function lw(t){return fw(t)||cw(t)||uw(t)||sw()}function sw(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function uw(t,e){if(t){if("string"===typeof t)return hw(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hw(t,e):void 0}}function cw(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function fw(t){if(Array.isArray(t))return hw(t)}function hw(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function dw(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pw(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vw(r.key),r)}}function yw(t,e,n){return e&&pw(t.prototype,e),n&&pw(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function vw(t){var e=mw(t,"string");return"symbol"===aw(e)?e:String(e)}function mw(t,e){if("object"!==aw(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==aw(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}new Set;var gw,bw=function(){function t(){var e=this;dw(this,t),this.indexesSequence=new Im,this.trimmingMapsCollection=new kb((function(t){return t.some((function(t){return!0===t}))}),!1),this.hidingMapsCollection=new kb((function(t){return t.some((function(t){return!0===t}))}),!1),this.variousMapsCollection=new ub,this.hidingChangesObservable=new iw({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",(function(){e.indexesSequenceChanged=!0,e.updateCache(),e.runLocalHooks("indexesSequenceChange",e.indexesChangeSource),e.runLocalHooks("change",e.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(function(t){e.trimmedIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",t,e.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(function(t){e.hiddenIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",t,e.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(function(t){e.runLocalHooks("change",t,e.variousMapsCollection)}))}return yw(t,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(t){if("hiding"!==t)throw new Error('Unsupported index map type "'.concat(t,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(t,e,n){return this.registerMap(t,eb(e,n))}},{key:"registerMap",value:function(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error('Map with name "'.concat(t,'" has been already registered.'));e instanceof Zg?this.trimmingMapsCollection.register(t,e):e instanceof vg?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);var n=this.getNumberOfIndexes();return n>0&&e.init(n),e}},{key:"unregisterMap",value:function(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(t){var e=this.notTrimmedIndexesCache[t];return Zt(e)?e:null}},{key:"getPhysicalFromRenderableIndex",value:function(t){var e=this.renderablePhysicalIndexesCache[t];return Zt(e)?e:null}},{key:"getVisualFromPhysicalIndex",value:function(t){var e=this.fromPhysicalToVisualIndexesCache.get(t);return Zt(e)?e:null}},{key:"getVisualFromRenderableIndex",value:function(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}},{key:"getRenderableFromVisualIndex",value:function(t){var e=this.fromVisualToRenderableIndexesCache.get(t);return Zt(e)?e:null}},{key:"getNearestNotHiddenIndex",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getPhysicalFromVisualIndex(t);if(null===r)return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;var o=Array.from(this.fromVisualToRenderableIndexesCache.keys()),i=-1;return i=e>0?o.findIndex((function(e){return e>t})):o.reverse().findIndex((function(e){return e<t})),-1===i?n?this.getNearestNotHiddenIndex(t,-e,!1):null:o[i]}},{key:"initToLength",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=lw(new Array(t).keys()),this.notHiddenIndexesCache=lw(new Array(t).keys()),this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(t){var e=this.getNumberOfIndexes();if(t<e){var n=lw(Array(this.getNumberOfIndexes()-t).keys()).map((function(e){return e+t}));this.removeIndexes(n)}else this.insertIndexes(e,t-e)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(t){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(t),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}},{key:"getNotTrimmedIndexes",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e)return this.notTrimmedIndexesCache;var n=this.getIndexesSequence();return n.filter((function(e){return!1===t.isTrimmed(e)}))}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e)return this.notHiddenIndexesCache;var n=this.getIndexesSequence();return n.filter((function(e){return!1===t.isHidden(e)}))}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e)return this.renderablePhysicalIndexesCache;var n=this.getNotTrimmedIndexes();return n.filter((function(e){return!1===t.isHidden(e)}))}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(t,e){var n=this;"number"===typeof t&&(t=[t]);var r=W(t,(function(t){return n.getPhysicalFromVisualIndex(t)})),o=this.getNotTrimmedIndexesLength(),i=t.length,a=pm(this.getIndexesSequence(),r),l=a.filter((function(t){return!1===n.isTrimmed(t)})),s=a.indexOf(l[l.length-1])+1;if(e+i<o){var u=l[e];s=a.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(dm(a,s,r)),this.indexesChangeSource=void 0}},{key:"isTrimmed",value:function(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}},{key:"isHidden",value:function(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}},{key:"insertIndexes",value:function(t,e){var n=this.getNotTrimmedIndexes()[t],r=Zt(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),i=W(new Array(e).fill(r),(function(t,e){return t+e}));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,i),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,i),this.hidingMapsCollection.insertToEvery(o,i),this.variousMapsCollection.insertToEvery(o,i),this.resumeOperations()}},{key:"removeIndexes",value:function(t){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}},{key:"updateCache",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var e=0;e<t;e+=1){var n=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(n,e)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var e=0;e<t;e+=1){var n=this.getPhysicalFromRenderableIndex(e),r=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(r,e)}}}]),t}();function ww(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Sw(t,e){return pt(e,(function(e,n){te(t[n])&&(t[n]=e)})),t}function Cw(t){var e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,n=e.exec(t);return n?"".concat(n[1].toLowerCase(),"-").concat(n[2].toUpperCase()):t}function Ow(t){Zt(t)&&nr($t(gw||(gw=ww(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],['Language with code "','" was not found. You should register particular language\\x20\n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'])),t))}function kw(t,e){var n=Array.isArray(t)&&Number.isInteger(e);return n?t[e]:t}ct(bw,Zv);var Rw=Rr("phraseFormatters"),Ew=Rw.register,Pw=Rw.getValues;function Tw(t,e){Ew(t,e)}function jw(){return Pw()}Tw("pluralize",kw);var Mw,Aw="ContextMenu:items",Iw=Aw,xw="".concat(Iw,".noItems"),_w="".concat(Iw,".insertRowAbove"),Hw="".concat(Iw,".insertRowBelow"),Nw="".concat(Iw,".insertColumnOnTheLeft"),Dw="".concat(Iw,".insertColumnOnTheRight"),Lw="".concat(Iw,".removeRow"),Bw="".concat(Iw,".removeColumn"),Vw="".concat(Iw,".undo"),Fw="".concat(Iw,".redo"),Ww="".concat(Iw,".readOnly"),Uw="".concat(Iw,".clearColumn"),zw="".concat(Iw,".copy"),Gw="".concat(Iw,".copyWithHeaders"),Yw="".concat(Iw,".copyWithGroupHeaders"),Kw="".concat(Iw,".copyHeadersOnly"),Xw="".concat(Iw,".cut"),$w="".concat(Iw,".freezeColumn"),qw="".concat(Iw,".unfreezeColumn"),Qw="".concat(Iw,".mergeCells"),Jw="".concat(Iw,".unmergeCells"),Zw="".concat(Iw,".addComment"),tS="".concat(Iw,".editComment"),eS="".concat(Iw,".removeComment"),nS="".concat(Iw,".readOnlyComment"),rS="".concat(Iw,".align"),oS="".concat(Iw,".align.left"),iS="".concat(Iw,".align.center"),aS="".concat(Iw,".align.right"),lS="".concat(Iw,".align.justify"),sS="".concat(Iw,".align.top"),uS="".concat(Iw,".align.middle"),cS="".concat(Iw,".align.bottom"),fS="".concat(Iw,".borders"),hS="".concat(Iw,".borders.top"),dS="".concat(Iw,".borders.right"),pS="".concat(Iw,".borders.bottom"),yS="".concat(Iw,".borders.left"),vS="".concat(Iw,".borders.remove"),mS="".concat(Iw,".nestedHeaders.insertChildRow"),gS="".concat(Iw,".nestedHeaders.detachFromParent"),bS="".concat(Iw,".hideColumn"),wS="".concat(Iw,".showColumn"),SS="".concat(Iw,".hideRow"),CS="".concat(Iw,".showRow"),OS="Filters:",kS="".concat(OS,"conditions"),RS="".concat(kS,".none"),ES="".concat(kS,".isEmpty"),PS="".concat(kS,".isNotEmpty"),TS="".concat(kS,".isEqualTo"),jS="".concat(kS,".isNotEqualTo"),MS="".concat(kS,".beginsWith"),AS="".concat(kS,".endsWith"),IS="".concat(kS,".contains"),xS="".concat(kS,".doesNotContain"),_S="".concat(kS,".byValue"),HS="".concat(kS,".greaterThan"),NS="".concat(kS,".greaterThanOrEqualTo"),DS="".concat(kS,".lessThan"),LS="".concat(kS,".lessThanOrEqualTo"),BS="".concat(kS,".isBetween"),VS="".concat(kS,".isNotBetween"),FS="".concat(kS,".after"),WS="".concat(kS,".before"),US="".concat(kS,".today"),zS="".concat(kS,".tomorrow"),GS="".concat(kS,".yesterday"),YS="".concat(OS,"labels.filterByCondition"),KS="".concat(OS,"labels.filterByValue"),XS="".concat(OS,"labels.conjunction"),$S="".concat(OS,"labels.disjunction"),qS="".concat(OS,"values.blankCells"),QS="".concat(OS,"buttons.selectAll"),JS="".concat(OS,"buttons.clear"),ZS="".concat(OS,"buttons.ok"),tC="".concat(OS,"buttons.cancel"),eC="".concat(OS,"buttons.placeholder.search"),nC="".concat(OS,"buttons.placeholder.value"),rC="".concat(OS,"buttons.placeholder.secondValue");function oC(t){return oC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oC(t)}function iC(t,e,n){return e=aC(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aC(t){var e=lC(t,"string");return"symbol"===oC(e)?e:String(e)}function lC(t,e){if("object"!==oC(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==oC(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}
/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */var sC=(Mw={languageCode:"en-US"},iC(Mw,xw,"No available options"),iC(Mw,_w,"Insert row above"),iC(Mw,Hw,"Insert row below"),iC(Mw,Nw,"Insert column left"),iC(Mw,Dw,"Insert column right"),iC(Mw,Lw,["Remove row","Remove rows"]),iC(Mw,Bw,["Remove column","Remove columns"]),iC(Mw,Vw,"Undo"),iC(Mw,Fw,"Redo"),iC(Mw,Ww,"Read only"),iC(Mw,Uw,"Clear column"),iC(Mw,rS,"Alignment"),iC(Mw,oS,"Left"),iC(Mw,iS,"Center"),iC(Mw,aS,"Right"),iC(Mw,lS,"Justify"),iC(Mw,sS,"Top"),iC(Mw,uS,"Middle"),iC(Mw,cS,"Bottom"),iC(Mw,$w,"Freeze column"),iC(Mw,qw,"Unfreeze column"),iC(Mw,fS,"Borders"),iC(Mw,hS,"Top"),iC(Mw,dS,"Right"),iC(Mw,pS,"Bottom"),iC(Mw,yS,"Left"),iC(Mw,vS,"Remove border(s)"),iC(Mw,Zw,"Add comment"),iC(Mw,tS,"Edit comment"),iC(Mw,eS,"Delete comment"),iC(Mw,nS,"Read-only comment"),iC(Mw,Qw,"Merge cells"),iC(Mw,Jw,"Unmerge cells"),iC(Mw,zw,"Copy"),iC(Mw,Gw,["Copy with header","Copy with headers"]),iC(Mw,Yw,["Copy with group header","Copy with group headers"]),iC(Mw,Kw,["Copy header only","Copy headers only"]),iC(Mw,Xw,"Cut"),iC(Mw,mS,"Insert child row"),iC(Mw,gS,"Detach from parent"),iC(Mw,bS,["Hide column","Hide columns"]),iC(Mw,wS,["Show column","Show columns"]),iC(Mw,SS,["Hide row","Hide rows"]),iC(Mw,CS,["Show row","Show rows"]),iC(Mw,RS,"None"),iC(Mw,ES,"Is empty"),iC(Mw,PS,"Is not empty"),iC(Mw,TS,"Is equal to"),iC(Mw,jS,"Is not equal to"),iC(Mw,MS,"Begins with"),iC(Mw,AS,"Ends with"),iC(Mw,IS,"Contains"),iC(Mw,xS,"Does not contain"),iC(Mw,HS,"Greater than"),iC(Mw,NS,"Greater than or equal to"),iC(Mw,DS,"Less than"),iC(Mw,LS,"Less than or equal to"),iC(Mw,BS,"Is between"),iC(Mw,VS,"Is not between"),iC(Mw,FS,"After"),iC(Mw,WS,"Before"),iC(Mw,US,"Today"),iC(Mw,zS,"Tomorrow"),iC(Mw,GS,"Yesterday"),iC(Mw,qS,"Blank cells"),iC(Mw,YS,"Filter by condition"),iC(Mw,KS,"Filter by value"),iC(Mw,XS,"And"),iC(Mw,$S,"Or"),iC(Mw,QS,"Select all"),iC(Mw,JS,"Clear"),iC(Mw,ZS,"OK"),iC(Mw,tC,"Cancel"),iC(Mw,eC,"Search"),iC(Mw,nC,"Value"),iC(Mw,rC,"Second value"),Mw),uC=sC,cC=uC.languageCode,fC=Rr("languagesDictionaries"),hC=fC.register,dC=fC.getItem,pC=fC.hasItem,yC=fC.getValues;function vC(t,e){var n=t,r=e;return ht(t)&&(r=t,n=r.languageCode),mC(n,r),hC(n,st(r)),st(r)}function mC(t,e){t!==cC&&Sw(e,dC(cC))}function gC(t){return bC(t)?st(dC(t)):null}function bC(t){return pC(t)}function wC(){return yC()}function SC(t,e,n){var r=gC(t);if(null===r)return null;var o=r[e];if(te(o))return null;var i=CC(o,n);return Array.isArray(i)?i[0]:i}function CC(t,e){var n=t;return U(jw(),(function(r){n=r(t,e)})),n}function OC(t){var e=Cw(t);return bC(e)||(e=cC,Ow(t)),e}vC(uC);var kC="active-header",RC="area",EC="cell",PC="fill",TC="header",jC="custom-selection";n(2538);function MC(t){return MC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},MC(t)}function AC(t,e){return NC(t)||HC(t,e)||xC(t,e)||IC()}function IC(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xC(t,e){if(t){if("string"===typeof t)return _C(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_C(t,e):void 0}}function _C(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function HC(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function NC(t){if(Array.isArray(t))return t}function DC(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LC(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,VC(r.key),r)}}function BC(t,e,n){return e&&LC(t.prototype,e),n&&LC(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function VC(t){var e=FC(t,"string");return"symbol"===MC(e)?e:String(e)}function FC(t,e){if("object"!==MC(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==MC(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var WC=function(){function t(e,n){DC(this,t),n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}return BC(t,[{key:"registerListeners",value:function(){var t=this,e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",(function(){return t.onMouseDown()})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()}));for(var n=function(e){var n=t.main.childNodes[e];t.eventManager.addEventListener(n,"mouseenter",(function(n){return t.onMouseEnter(n,t.main.childNodes[e])}))},r=0,o=this.main.childNodes.length;r<o;r++)n(r)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(t,e){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){t.preventDefault(),Qn(t);var n=this,r=this.wot.rootDocument.body,o=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(r,"mousemove",a)}function i(t){return t.clientY<Math.floor(o.top)||(t.clientY>Math.ceil(o.top+o.height)||(t.clientX<Math.floor(o.left)||(t.clientX>Math.ceil(o.left+o.width)||void 0)))}function a(t){i(t)&&(n.eventManager.removeEventListener(r,"mousemove",a),e.style.display="block")}}},{key:"createBorders",value:function(t){var e=this.wot.rootDocument;this.main=e.createElement("div");var n=["top","start","bottom","end","corner"],r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(var o=0;o<5;o++){var i=n[o],a=e.createElement("div");a.className="wtBorder ".concat(this.settings.className||""),this.settings[i]&&this.settings[i].hide&&(a.className+=" hidden"),r=a.style,r.backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:t.border.color,r.height=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(t.border.width,"px"),r.width=this.settings[i]&&this.settings[i].width?"".concat(this.settings[i].width,"px"):"".concat(t.border.width,"px"),this.main.appendChild(a)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ht()&&this.createMultipleSelectorHandles(),this.disappear();var l=this.wot.wtTable,s=l.bordersHolder;s||(s=e.createElement("div"),s.className="htBorders",l.bordersHolder=s,l.spreader.appendChild(s)),s.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var t=this,e=this.wot.rootDocument;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};var n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var o={position:"absolute",height:"".concat(r,"px"),width:"".concat(r,"px"),"border-radius":"".concat(parseInt(r/1.5,10),"px")};pt(o,(function(e,n){t.selectionHandles.styles.bottomHitArea[n]=e,t.selectionHandles.styles.topHitArea[n]=e}));var i={position:"absolute",height:"".concat(n,"px"),width:"".concat(n,"px"),"border-radius":"".concat(parseInt(n/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};pt(i,(function(e,n){t.selectionHandles.styles.bottom[n]=e,t.selectionHandles.styles.top[n]=e})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(t,e){var n=this.wot.selections.createOrGetArea();return!(!n.cellRange||t===n.cellRange.to.row&&e===n.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(t,e,n,r,o,i){var a=this.wot.wtSettings.getSetting("rtlMode"),l=a?"right":"left",s=this.selectionHandles.styles,u=s.top,c=s.topHitArea,f=s.bottom,h=s.bottomHitArea,d=parseInt(u.borderWidth,10),p=parseInt(u.width,10),y=parseInt(c.width,10),v=this.wot.wtTable.getWidth(),m=this.wot.wtTable.getHeight();u.top="".concat(parseInt(n-p-1,10),"px"),u[l]="".concat(parseInt(r-p-1,10),"px"),c.top="".concat(parseInt(n-y/4*3,10),"px"),c[l]="".concat(parseInt(r-y/4*3,10),"px");var g=Math.min(parseInt(r+o,10),v-p-2*d),b=Math.min(parseInt(r+o-y/4,10),v-y-2*d);f[l]="".concat(g,"px"),h[l]="".concat(b,"px");var w=Math.min(parseInt(n+i,10),m-p-2*d),S=Math.min(parseInt(n+i-y/4,10),m-y-2*d);f.top="".concat(w,"px"),h.top="".concat(S,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(t,e)?(f.display="none",h.display="none"):(f.display="block",h.display="block")):(u.display="none",f.display="none",c.display="none",h.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}},{key:"appear",value:function(t){if(!this.disabled){for(var e,n,r,o,i,a,l=this.wot,s=l.wtTable,u=l.rootDocument,c=l.rootWindow,f=s.getRenderedRowsCount(),h=0;h<f;h+=1){var d=s.rowFilter.renderedToSource(h);if(d>=t[0]&&d<=t[2]){e=d,i=t[0];break}}for(var p=f-1;p>=0;p-=1){var y=s.rowFilter.renderedToSource(p);if(y>=t[0]&&y<=t[2]){n=y;break}}for(var v=s.getRenderedColumnsCount(),m=0;m<v;m+=1){var g=s.columnFilter.renderedToSource(m);if(g>=t[1]&&g<=t[3]){r=g,a=t[1];break}}for(var b=v-1;b>=0;b-=1){var w=s.columnFilter.renderedToSource(b);if(w>=t[1]&&w<=t[3]){o=w;break}}if(void 0!==e&&void 0!==r){var S=s.getCell(this.wot.createCellCoords(e,r)),C=e!==n||r!==o,O=C?s.getCell(this.wot.createCellCoords(n,o)):S,k=tn(S),R=C?tn(O):k,E=tn(s.TABLE),P=fn(s.TABLE),T=k.top,j=k.left,M=this.wot.wtSettings.getSetting("rtlMode"),A=0,I=0;if(M){var x=fn(S),_=c.innerWidth-E.left-P;I=j+x-R.left,A=c.innerWidth-j-x-_-1}else I=R.left+fn(O)-j,A=j-E.left-1;if(this.isEntireColumnSelected(e,n)){var H=this.getDimensionsFromHeader("columns",r,o,i,E),N=null;if(H){var D=AC(H,3);N=D[0],A=D[1],I=D[2]}N&&(S=N)}var L=T-E.top-1,B=R.top+hn(O)-T;if(this.isEntireRowSelected(r,o)){var V=this.getDimensionsFromHeader("rows",e,n,a,E),F=null;if(V){var W=AC(V,3);F=W[0],L=W[1],B=W[2]}F&&(S=F)}var U=cn(S,c);parseInt(U.borderTopWidth,10)>0&&(L+=1,B=B>0?B-1:0),parseInt(U[M?"borderRightWidth":"borderLeftWidth"],10)>0&&(A+=1,I=I>0?I-1:0);var z=M?"right":"left";this.topStyle.top="".concat(L,"px"),this.topStyle[z]="".concat(A,"px"),this.topStyle.width="".concat(I,"px"),this.topStyle.display="block",this.startStyle.top="".concat(L,"px"),this.startStyle[z]="".concat(A,"px"),this.startStyle.height="".concat(B,"px"),this.startStyle.display="block";var G=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(L+B-G,"px"),this.bottomStyle[z]="".concat(A,"px"),this.bottomStyle.width="".concat(I,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(L,"px"),this.endStyle[z]="".concat(A+I-G,"px"),this.endStyle.height="".concat(B+1,"px"),this.endStyle.display="block";var Y=this.settings.border.cornerVisible;Y="function"===typeof Y?Y(this.settings.layerLevel):Y;var K=this.wot.getSetting("onModifyGetCellCoords",n,o),X=n,$=o;if(K&&Array.isArray(K)){var q=AC(K,4);X=q[2],$=q[3]}if(Ht()||!Y||this.isPartRange(X,$))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(L+B+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[z]="".concat(A+I+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var Q=ln(s.TABLE),J=Q===c;J&&(Q=u.documentElement);var Z=parseInt(this.cornerDefaultStyle.width,10)/2,tt=parseInt(this.cornerDefaultStyle.height,10)/2;if(o===this.wot.getSetting("totalColumns")-1){var et=J?O.getBoundingClientRect().left:O.offsetLeft,nt=!1,rt=0;M?(rt=et-parseInt(this.cornerDefaultStyle.width,10)/2,nt=rt<0):(rt=et+fn(O)+parseInt(this.cornerDefaultStyle.width,10)/2,nt=rt>=pn(Q)),nt&&(this.cornerStyle[z]="".concat(Math.floor(A+I+this.cornerCenterPointOffset-Z),"px"),this.cornerStyle[M?"borderLeftWidth":"borderRightWidth"]=0)}if(n===this.wot.getSetting("totalRows")-1){var ot=J?O.getBoundingClientRect().top:O.offsetTop,it=ot+hn(O)+parseInt(this.cornerDefaultStyle.height,10)/2,at=it>=dn(Q);at&&(this.cornerStyle.top="".concat(Math.floor(L+B+this.cornerCenterPointOffset-tt),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}Ht()&&this.updateMultipleSelectionHandlesPosition(n,o,L,A,I,B)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(t,e,n,r,o){var i=this.wot.wtTable,a=i.wtRootElement.parentNode,l=null,s=null,u=null,c=null,f=null,h=null,d=null,p=null;switch(t){case"rows":l=function(){return i.getRowHeader.apply(i,arguments)},s=function(){return hn.apply(void 0,arguments)},u="ht__selection--rows",h="top";break;case"columns":l=function(){return i.getColumnHeader.apply(i,arguments)},s=function(){return fn.apply(void 0,arguments)},u="ht__selection--columns",h="left";break;default:}if(a.classList.contains(u)){var y=this.wot.getSetting("columnHeaders").length;if(d=l(e,y-r),p=l(n,y-r),!d||!p)return!1;var v=tn(d),m=tn(p);return d&&p&&(c=v[h]-o[h]-1,f=m[h]+s(p)-v[h]),[d,c,f]}return!1}},{key:"changeBorderStyle",value:function(t,e){var n=this[t].style,r=e[t];!r||r.hide?Ge(this[t],"hidden"):(ze(this[t],"hidden")&&Ye(this[t],"hidden"),n.backgroundColor=r.color,"top"!==t&&"bottom"!==t||(n.height="".concat(r.width,"px")),"start"!==t&&"end"!==t||(n.width="".concat(r.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(t){var e={width:1,color:"#000"},n=this[t].style;n.backgroundColor=e.color,n.width="".concat(e.width,"px"),n.height="".concat(e.width,"px")}},{key:"toggleHiddenClass",value:function(t,e){this.changeBorderToDefaultStyle(t),e?Ge(this[t],"hidden"):Ye(this[t],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ht()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),t}(),UC=WC;function zC(t,e){return $C(t)||XC(t,e)||YC(t,e)||GC()}function GC(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function YC(t,e){if(t){if("string"===typeof t)return KC(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?KC(t,e):void 0}}function KC(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function XC(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function $C(t){if(Array.isArray(t))return t}function qC(t){return qC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qC(t)}function QC(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function JC(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,tO(r.key),r)}}function ZC(t,e,n){return e&&JC(t.prototype,e),n&&JC(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function tO(t){var e=eO(t,"string");return"symbol"===qC(e)?e:String(e)}function eO(t,e){if("object"!==qC(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==qC(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var nO=function(){function t(e,n){QC(this,t),this.settings=e,this.cellRange=n||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return ZC(t,[{key:"getBorder",value:function(t){return this.instanceBorders[t.guid]||(this.instanceBorders[t.guid]=new UC(t,this.settings)),this.instanceBorders[t.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}},{key:"replace",value:function(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}},{key:"addClassAtCoords",value:function(t,e,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=t.wtTable.getCell(this.settings.createCellCoords(e,n));if("object"===qC(i)){var a=r;o&&(a=this.classNameGenerator(i),this.classNames.includes(a)||this.classNames.push(a)),Ge(i,a)}return this}},{key:"linearClassNameGenerator",value:function(t,e){return function n(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===e||0===o)return t;var i=o>=0?o:e,a=t;i-=1;var l=0===i?t:"".concat(t,"-").concat(i);if(ze(r,l)){var s=i+1;a="".concat(t,"-").concat(s)}else a=n(r,i);return a}}},{key:"draw",value:function(t){if(this.isEmpty())this.settings.border&&this.getBorder(t).disappear();else{var e=t.wtTable.getRenderedRowsCount(),n=t.wtTable.getRenderedColumnsCount(),r=this.getCorners(),o=zC(r,4),i=o[0],a=o[1],l=o[2],s=o[3],u=this.settings,c=u.highlightHeaderClassName,f=u.highlightColumnClassName,h=u.highlightRowClassName,d=u.highlightOnlyClosestHeader,p=u.selectionType,y=void 0===p||["active-header","header"].includes(p);if(y&&null!==a&&null!==s)for(var v=0,m=0;m<n;m+=1){var g=t.wtTable.columnFilter.renderedToSource(m);if(g>=a&&g<=s){var b=t.wtTable.getColumnHeaders(g),w=b.length-1;d&&b.length>1&&(b=[b[w]]);for(var S=0;S<b.length;S+=1){var C=[],O=b[S];c&&C.push(c),f&&C.push(f),S=d?w:S;var k=t.getSetting("onBeforeHighlightingColumnHeader",g,S,{selectionType:p,columnCursor:v,selectionWidth:s-a+1,classNames:C});k!==g&&(O=t.wtTable.getColumnHeader(k,S)),Ge(O,C)}v+=1}}if(null!==i&&null!==l)for(var R=0,E=0;E<e;E+=1){var P=t.wtTable.rowFilter.renderedToSource(E);if(y&&P>=i&&P<=l){var T=t.wtTable.getRowHeaders(P),j=T.length-1;d&&T.length>1&&(T=[T[j]]);for(var M=0;M<T.length;M+=1){var A=[],I=T[M];c&&A.push(c),h&&A.push(h),M=d?j:M;var x=t.getSetting("onBeforeHighlightingRowHeader",P,M,{selectionType:p,rowCursor:R,selectionHeight:l-i+1,classNames:A});x!==P&&(I=t.wtTable.getRowHeader(x,M)),Ge(I,A)}R+=1}if(null!==a&&null!==s)for(var _=0;_<n;_+=1){var H=t.wtTable.columnFilter.renderedToSource(_);P>=i&&P<=l&&H>=a&&H<=s?this.settings.className&&this.addClassAtCoords(t,P,H,this.settings.className,this.settings.markIntersections):P>=i&&P<=l?h&&this.addClassAtCoords(t,P,H,h):H>=a&&H<=s&&f&&this.addClassAtCoords(t,P,H,f);var N=t.getSetting("onAfterDrawSelection",P,H,this.settings.layerLevel);"string"===typeof N&&this.addClassAtCoords(t,P,H,N)}}t.getSetting("onBeforeDrawBorders",r,this.settings.className),this.settings.border&&this.getBorder(t).appear(r)}}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach((function(t){return t.destroy()}))}}]),t}(),rO=nO;function oO(t){return oO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oO(t)}function iO(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aO(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,gO(r.key),r)}}function lO(t,e,n){return e&&aO(t.prototype,e),n&&aO(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function sO(){return sO="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=uO(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},sO.apply(this,arguments)}function uO(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=vO(t),null===t)break;return t}function cO(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fO(t,e)}function fO(t,e){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},fO(t,e)}function hO(t){var e=yO();return function(){var n,r=vO(t);if(e){var o=vO(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dO(this,n)}}function dO(t,e){if(e&&("object"===oO(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return pO(t)}function pO(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yO(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function vO(t){return vO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vO(t)}function mO(t,e,n){return e=gO(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gO(t){var e=bO(t,"string");return"symbol"===oO(e)?e:String(e)}function bO(t,e){if("object"!==oO(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==oO(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var wO=function(t){cO(n,t);var e=hO(n);function n(t,r){var o;return iO(this,n),o=e.call(this,t,null),mO(pO(o),"visualCellRange",null),o.visualCellRange=r||null,o.commit(),o}return lO(n,[{key:"add",value:function(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}},{key:"clear",value:function(){return this.visualCellRange=null,sO(vO(n.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(t){var e=t.from,n=t.to,r=this.getNearestNotHiddenCoords(e,1),o=this.getNearestNotHiddenCoords(n,-1);if(null===r||null===o)return null;if(r.row>o.row||r.col>o.col){var i="header"===this.settings.type||"active-header"===this.settings.type;if(!i)return null;r=e,o=n}return this.settings.createCellRange(r,r,o)}},{key:"getNearestNotHiddenCoords",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),t.row,e);if(null===r)return null;var o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),t.col,n);return null===o?null:this.settings.createCellCoords(r,o)}},{key:"getNearestNotHiddenIndex",value:function(t,e,n){if(e<0)return e;var r=t.getNearestNotHiddenIndex(e,n),o="header"===this.settings.type||"active-header"===this.settings.type;return o&&null===r?-1:r}},{key:"commit",value:function(){if(null===this.visualCellRange)return this;var t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===t?null:this.createRenderableCellRange(t.from,t.to),this}},{key:"syncWith",value:function(t){var e="N-S"===t.getVerticalDirection()?1:-1,n="W-E"===t.getHorizontalDirection()?1:-1,r=this.getNearestNotHiddenCoords(t.from.clone().normalize(),e,n);if(null!==r&&t.overlaps(r)){if(null===this.cellRange){var o=this.settings.visualToRenderableCoords(r);this.cellRange=this.settings.createCellRange(o)}return t.setHighlight(r),this}return t.setHighlight(t.from),this}},{key:"getCorners",value:function(){var t=this.cellRange,e=t.from,n=t.to,r=null===e.row||null===n.row,o=null===e.col||null===n.col,i=this.settings.createCellCoords(r?null:Math.min(e.row,n.row),o?null:Math.min(e.col,n.col)),a=this.settings.createCellCoords(r?null:Math.max(e.row,n.row),o?null:Math.max(e.col,n.col));return[i.row,i.col,a.row,a.col]}},{key:"getVisualCorners",value:function(){var t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}},{key:"createRenderableCellRange",value:function(t,e){var n=this.settings.visualToRenderableCoords(t),r=this.settings.visualToRenderableCoords(e);return this.settings.createCellRange(n,n,r)}}]),n}(rO),SO=wO;function CO(t){return CO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},CO(t)}var OO=["activeHeaderClassName"];function kO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function RO(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?kO(Object(n),!0).forEach((function(e){EO(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kO(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function EO(t,e,n){return e=PO(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PO(t){var e=TO(t,"string");return"symbol"===CO(e)?e:String(e)}function TO(t,e){if("object"!==CO(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==CO(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function jO(t,e){if(null==t)return{};var n,r,o=MO(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function MO(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function AO(t){var e=t.activeHeaderClassName,n=jO(t,OO),r=new SO(RO(RO({highlightHeaderClassName:e},n),{},{selectionType:kC}));return r}var IO=AO;function xO(t){return xO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xO(t)}var _O=["layerLevel","areaCornerVisible"];function HO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function NO(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?HO(Object(n),!0).forEach((function(e){DO(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):HO(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function DO(t,e,n){return e=LO(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LO(t){var e=BO(t,"string");return"symbol"===xO(e)?e:String(e)}function BO(t,e){if("object"!==xO(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==xO(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function VO(t,e){if(null==t)return{};var n,r,o=FO(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function FO(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function WO(t){var e=t.layerLevel,n=t.areaCornerVisible,r=VO(t,_O),o=new SO(NO(NO({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:n}},r),{},{selectionType:RC}));return o}var UO=WO;function zO(t){return zO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zO(t)}var GO=["cellCornerVisible"];function YO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function KO(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?YO(Object(n),!0).forEach((function(e){XO(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):YO(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function XO(t,e,n){return e=$O(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $O(t){var e=qO(t,"string");return"symbol"===zO(e)?e:String(e)}function qO(t,e){if("object"!==zO(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==zO(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function QO(t,e){if(null==t)return{};var n,r,o=JO(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function JO(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function ZO(t){var e=t.cellCornerVisible,n=QO(t,GO),r=new SO(KO(KO({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e}},n),{},{selectionType:EC}));return r}var tk=ZO;function ek(t){return ek="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ek(t)}var nk=["border","visualCellRange"];function rk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ok(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rk(Object(n),!0).forEach((function(e){ik(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rk(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ik(t,e,n){return e=ak(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ak(t){var e=lk(t,"string");return"symbol"===ek(e)?e:String(e)}function lk(t,e){if("object"!==ek(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ek(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function sk(t,e){if(null==t)return{};var n,r,o=uk(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function uk(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function ck(t){var e=t.border,n=t.visualCellRange,r=sk(t,nk),o=new SO(ok(ok(ok({},e),r),{},{selectionType:jC}),n);return o}var fk=ck;n(9988);function hk(t){return hk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hk(t)}function dk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function pk(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?dk(Object(n),!0).forEach((function(e){yk(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dk(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function yk(t,e,n){return e=vk(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vk(t){var e=mk(t,"string");return"symbol"===hk(e)?e:String(e)}function mk(t,e){if("object"!==hk(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==hk(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function gk(t){if(null==t)throw new TypeError("Cannot destructure "+t)}function bk(t){var e=Object.assign({},(gk(t),t)),n=new SO(pk(pk({className:"fill",border:{width:1,color:"#ff0000"}},e),{},{selectionType:PC}));return n}var wk=bk;function Sk(t){return Sk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sk(t)}var Ck=["headerClassName","rowClassName","columnClassName"];function Ok(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function kk(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ok(Object(n),!0).forEach((function(e){Rk(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ok(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Rk(t,e,n){return e=Ek(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ek(t){var e=Pk(t,"string");return"symbol"===Sk(e)?e:String(e)}function Pk(t,e){if("object"!==Sk(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Sk(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Tk(t,e){if(null==t)return{};var n,r,o=jk(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function jk(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function Mk(t){var e=t.headerClassName,n=t.rowClassName,r=t.columnClassName,o=Tk(t,Ck),i=new SO(kk(kk({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:n,highlightColumnClassName:r},o),{},{highlightOnlyClosestHeader:!0,selectionType:TC}));return i}var Ak=Mk;function Ik(t){return Ik="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ik(t)}function xk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xk(Object(n),!0).forEach((function(e){Hk(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xk(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Hk(t,e,n){return e=Nk(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nk(t){var e=Dk(t,"string");return"symbol"===Ik(e)?e:String(e)}function Dk(t,e){if("object"!==Ik(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ik(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Lk=Rr("highlight/types"),Bk=Lk.register,Vk=Lk.getItem;function Fk(t,e){return Vk(t)(_k({type:t},e))}function Wk(t){return Wk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wk(t)}function Uk(t){return Kk(t)||Yk(t)||Gk(t)||zk()}function zk(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Gk(t,e){if(t){if("string"===typeof t)return Xk(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xk(t,e):void 0}}function Yk(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Kk(t){if(Array.isArray(t))return Xk(t)}function Xk(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function qk(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$k(Object(n),!0).forEach((function(e){Qk(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Qk(t,e,n){return e=eR(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jk(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zk(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,eR(r.key),r)}}function tR(t,e,n){return e&&Zk(t.prototype,e),n&&Zk(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function eR(t){var e=nR(t,"string");return"symbol"===Wk(e)?e:String(e)}function nR(t,e){if("object"!==Wk(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Wk(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Bk(kC,IO),Bk(RC,UO),Bk(EC,tk),Bk(jC,fk),Bk(PC,wk),Bk(TC,Ak);var rR=function(t){function e(t){Jk(this,e),this.options=t,this.layerLevel=0,this.cell=Fk(EC,t),this.fill=Fk(PC,t),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return tR(e,[{key:"isEnabledFor",value:function(t,e){var n=t;t===EC&&(n="current");var r=this.options.disabledCellSelection(e.row,e.col);return"string"===typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(n)}},{key:"useLayerLevel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var t,e=this.layerLevel;return this.areas.has(e)?t=this.areas.get(e):(t=Fk(RC,qk({layerLevel:e},this.options)),this.areas.set(e,t)),t}},{key:"getAreas",value:function(){return Uk(this.areas.values())}},{key:"createOrGetHeader",value:function(){var t,e=this.layerLevel;return this.headers.has(e)?t=this.headers.get(e):(t=Fk(TC,qk({},this.options)),this.headers.set(e,t)),t}},{key:"getHeaders",value:function(){return Uk(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var t,e=this.layerLevel;return this.activeHeaders.has(e)?t=this.activeHeaders.get(e):(t=Fk(kC,qk({},this.options)),this.activeHeaders.set(e,t)),t}},{key:"getActiveHeaders",value:function(){return Uk(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Uk(this.customSelections.values())}},{key:"addCustomSelection",value:function(t){this.customSelections.push(Fk(jC,qk(qk({},this.options),t)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),U(this.areas.values(),(function(t){t.clear()})),U(this.headers.values(),(function(t){t.clear()})),U(this.activeHeaders.values(),(function(t){t.clear()}))}},{key:t,value:function(){return[this.cell,this.fill].concat(Uk(this.areas.values()),Uk(this.headers.values()),Uk(this.activeHeaders.values()),Uk(this.customSelections))[Symbol.iterator]()}}]),e}(Symbol.iterator),oR=rR;function iR(t){return iR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iR(t)}function aR(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lR(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,uR(r.key),r)}}function sR(t,e,n){return e&&lR(t.prototype,e),n&&lR(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function uR(t){var e=cR(t,"string");return"symbol"===iR(e)?e:String(e)}function cR(t,e){if("object"!==iR(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==iR(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var fR=function(t){function e(t){aR(this,e),this.ranges=[],this.createCellRange=t}return sR(e,[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}},{key:"add",value:function(t){return this.ranges.push(this.createCellRange(t)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(t){return this.ranges.some((function(e){return e.includes(t)}))}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.size()+e-1;return n>=0&&(t=this.ranges[n]),t}},{key:t,value:function(){return this.ranges[Symbol.iterator]()}}]),e}(Symbol.iterator),hR=fR;function dR(t){return dR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dR(t)}function pR(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yR(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mR(r.key),r)}}function vR(t,e,n){return e&&yR(t.prototype,e),n&&yR(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function mR(t){var e=gR(t,"string");return"symbol"===dR(e)?e:String(e)}function gR(t,e){if("object"!==dR(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==dR(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var bR=function(){function t(e,n){pR(this,t),this.range=e,this.options=n}return vR(t,[{key:"transformStart",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.options.createCellCoords(t,e),o=this.range.current().highlight,i=this.options.visualToRenderableCoords(o),a=i.row,l=i.col,s=o,u=0,c=0;if(this.runLocalHooks("beforeTransformStart",r),null!==a&&null!==l){var f=this.options.countRows(),h=this.options.countCols(),d=this.options.fixedRowsBottom(),p=this.options.minSpareRows(),y=this.options.minSpareCols(),v=this.options.autoWrapRow(),m=this.options.autoWrapCol();a+t>f-1?n&&p>0&&!(d&&a>=f-d-1)?(this.runLocalHooks("insertRowRequire",f),f=this.options.countRows()):m&&(r.row=1-f,r.col=l+r.col===h-1?1-h:1):m&&a+r.row<0&&l+r.col>=0&&(r.row=f-1,r.col=l+r.col===0?h-1:-1),l+r.col>h-1?n&&y>0?(this.runLocalHooks("insertColRequire",h),h=this.options.countCols()):v&&(r.row=a+r.row===f-1?1-f:1,r.col=1-h):v&&l+r.col<0&&a+r.row>=0&&(r.row=a+r.row===0?f-1:-1,r.col=h-1);var g=this.options.createCellCoords(a+r.row,l+r.col);u=0,c=0,g.row<0?(u=-1,g.row=0):g.row>0&&g.row>=f&&(u=1,g.row=f-1),g.col<0?(c=-1,g.col=0):g.col>0&&g.col>=h&&(c=1,g.col=h-1),s=this.options.renderableToVisualCoords(g)}return this.runLocalHooks("afterTransformStart",s,u,c),s}},{key:"transformEnd",value:function(t,e){var n=this.options.createCellCoords(t,e),r=this.range.current(),o=r.to,i=0,a=0;this.runLocalHooks("beforeTransformEnd",n);var l=this.options.visualToRenderableCoords(r.highlight),s=l.row,u=l.col;if(null!==s&&null!==u){var c=this.options.countRows(),f=this.options.countCols(),h=this.options.visualToRenderableCoords(r.to),d=h.row,p=h.col,y=this.options.createCellCoords(d+n.row,p+n.col);i=0,a=0,y.row<0?(i=-1,y.row=0):y.row>0&&y.row>=c&&(i=1,y.row=c-1),y.col<0?(a=-1,y.col=0):y.col>0&&y.col>=f&&(a=1,y.col=f-1),o=this.options.renderableToVisualCoords(y)}return this.runLocalHooks("afterTransformEnd",o,i,a),o}}]),t}();ct(bR,Zv);var wR=bR;function SR(t,e){return ER(t)||RR(t,e)||OR(t,e)||CR()}function CR(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function OR(t,e){if(t){if("string"===typeof t)return kR(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kR(t,e):void 0}}function kR(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function RR(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function ER(t){if(Array.isArray(t))return t}function PR(t){return PR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},PR(t)}var TR,jR=0,MR=1,AR=2,IR=3,xR=[IR,AR],_R=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],HR=Symbol("root"),NR=Symbol("child");function DR(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:HR;if(e!==HR&&e!==NR)throw new Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(t),r=e===HR,o=jR;if(n){var i=t[0];if(0===t.length)o=MR;else if(r&&i instanceof Zc)o=IR;else if(r&&Array.isArray(i))o=DR(i,NR);else if(t.length>=2&&t.length<=4){var a=!t.some((function(t,e){return!_R[e].includes(PR(t))}));a&&(o=AR)}}return o}function LR(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.keepDirection,r=void 0!==n&&n,o=e.propToCol;if(!xR.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(e){var n=t===IR,i=n?e.from.row:e[0],a=n?e.from.col:e[1],l=n?e.to.row:e[2],s=n?e.to.col:e[3];if("function"===typeof o&&("string"===typeof a&&(a=o(a)),"string"===typeof s&&(s=o(s))),te(l)&&(l=i),te(s)&&(s=a),!r){var u=i,c=a,f=l,h=s;i=Math.min(u,f),a=Math.min(c,h),l=Math.max(u,f),s=Math.max(c,h)}return[i,a,l,s]}}function BR(t){var e=DR(t);if(e===jR||e===MR)return[];var n=LR(e),r=new Set;U(t,(function(t){var e=n(t),o=SR(e,4),i=o[1],a=o[3],l=Math.max(i,0),s=a-l+1;U(Array.from(new Array(s),(function(t,e){return l+e})),(function(t){r.has(t)||r.add(t)}))}));var o=Array.from(r).sort((function(t,e){return t-e})),i=V(o,(function(t,e,n,r){return 0!==n&&e===r[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t}),[]);return i}function VR(t){var e=DR(t);if(e===jR||e===MR)return[];var n=LR(e),r=new Set;U(t,(function(t){var e=n(t),o=SR(e,3),i=o[0],a=o[2],l=Math.max(i,0),s=a-l+1;U(Array.from(new Array(s),(function(t,e){return l+e})),(function(t){r.has(t)||r.add(t)}))}));var o=Array.from(r).sort((function(t,e){return t-e})),i=V(o,(function(t,e,n,r){return 0!==n&&e===r[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t}),[]);return i}function FR(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return"number"===typeof t&&t>=0&&t<e}function WR(t){return WR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},WR(t)}function UR(t,e){return XR(t)||KR(t,e)||GR(t,e)||zR()}function zR(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function GR(t,e){if(t){if("string"===typeof t)return YR(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?YR(t,e):void 0}}function YR(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function KR(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function XR(t){if(Array.isArray(t))return t}function $R(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function qR(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QR(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ZR(r.key),r)}}function JR(t,e,n){return e&&QR(t.prototype,e),n&&QR(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZR(t){var e=tE(t,"string");return"symbol"===WR(e)?e:String(e)}function tE(t,e){if("object"!==WR(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==WR(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var eE=function(){function t(e,n){var r=this;qR(this,t),this.settings=e,this.tableProps=n,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new hR((function(t,e,n){return r.tableProps.createCellRange(t,e,n)})),this.highlight=new oR({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:function(t,e){return r.tableProps.isDisabledCellSelection(t,e)},cellCornerVisible:function(){return r.isCellCornerVisible.apply(r,arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible.apply(r,arguments)},visualToRenderableCoords:function(t){return r.tableProps.visualToRenderableCoords(t)},renderableToVisualCoords:function(t){return r.tableProps.renderableToVisualCoords(t)},createCellCoords:function(t,e){return r.tableProps.createCellCoords(t,e)},createCellRange:function(t,e,n){return r.tableProps.createCellRange(t,e,n)},rowIndexMapper:function(){return r.tableProps.rowIndexMapper()},columnIndexMapper:function(){return r.tableProps.columnIndexMapper()}}),this.transformation=new wR(this.selectedRange,{countRows:function(){return r.tableProps.countRowsTranslated()},countCols:function(){return r.tableProps.countColsTranslated()},visualToRenderableCoords:function(t){return r.tableProps.visualToRenderableCoords(t)},renderableToVisualCoords:function(t){return r.tableProps.renderableToVisualCoords(t)},createCellCoords:function(t,e){return r.tableProps.createCellCoords(t,e)},fixedRowsBottom:function(){return e.fixedRowsBottom},minSpareRows:function(){return e.minSpareRows},minSpareCols:function(){return e.minSpareCols},autoWrapRow:function(){return e.autoWrapRow},autoWrapCol:function(){return e.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformStart"].concat(e))})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformStart"].concat(e))})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformEnd"].concat(e))})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformEnd"].concat(e))})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["insertRowRequire"].concat(e))})),this.transformation.addLocalHook("insertColRequire",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.runLocalHooks.apply(r,["insertColRequire"].concat(e))}))}return JR(t,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="multiple"===this.settings.selectionMode,o=te(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,i=t.row<0,a=t.col<0,l=i&&a,s=t.clone();this.selectedByCorner=l,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),s),(!r||r&&!o&&te(e))&&this.selectedRange.clear(),this.selectedRange.add(s),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!l&&a&&this.selectedByRowHeader.add(this.getLayerLevel()),!l&&i&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(t)}},{key:"setRangeStartOnly",value:function(t,e){this.setRangeStart(t,e,!0)}},{key:"setRangeEnd",value:function(t){if(!this.selectedRange.isEmpty()){var e=t.clone();this.runLocalHooks("beforeSetRangeEnd",e),this.begin();var n=this.selectedRange.current();"single"!==this.settings.selectionMode&&n.setTo(this.tableProps.createCellCoords(e.row,e.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(EC,n.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(n);var r=this.getLayerLevel();r<this.highlight.layerLevel&&(U(this.highlight.getAreas(),(function(t){t.clear()})),U(this.highlight.getHeaders(),(function(t){t.clear()})),U(this.highlight.getActiveHeaders(),(function(t){t.clear()}))),this.highlight.useLayerLevel(r);var o=this.highlight.createOrGetArea(),i=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();if(o.clear(),i.clear(),a.clear(),this.highlight.isEnabledFor(RC,n.highlight)&&(this.isMultiple()||r>=1)&&(o.add(n.from).add(n.to).commit(),1===r)){var l=this.selectedRange.previous();this.highlight.useLayerLevel(r-1).createOrGetArea().add(l.from).commit().syncWith(l),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(TC,n.highlight)){var s=0===this.tableProps.countRowsTranslated(),u=0===this.tableProps.countColsTranslated(),c=n;if((s||u)&&(c=n.clone()),s&&(c.from.row=-1),u&&(c.from.col=-1),"single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&c.from.normalize(),i.add(c.from).commit()):i.add(c.from).add(c.to).commit(),this.isEntireRowSelected()){var f=this.tableProps.countCols()===n.getWidth();f&&a.add(this.tableProps.createCellCoords(n.from.row,-1)).add(this.tableProps.createCellCoords(n.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var h=this.tableProps.countRows()===n.getHeight();h&&a.add(this.tableProps.createCellCoords(-1,n.from.col)).add(this.tableProps.createCellCoords(-1,n.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",t)}}},{key:"isMultiple",value:function(){var t=gt(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}},{key:"transformStart",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(t,e,n))}},{key:"transformEnd",value:function(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&this.isEntireRowSelected(t)}},{key:"isEntireRowSelected",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t)}},{key:"isSelectedByColumnHeader",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(t)}},{key:"isEntireColumnSelected",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(t){return this.selectedRange.includes(t)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.tableProps.countRows(),r=this.tableProps.countCols();if(t||e||0!==n&&0!==r){var o=this.tableProps.createCellCoords(e?-1:0,t?-1:0),i=this.tableProps.createCellCoords(n-1,r-1);this.clear(),this.setRangeStartOnly(o),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(i),this.finish()}}},{key:"selectCells",value:function(t){var e=this,n=DR(t);if(n===MR)return!1;if(n===jR)throw new Error($t(TR||(TR=$R(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, \n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."],["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20\n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."]))));var r=LR(n,{propToCol:function(t){return e.tableProps.propToCol(t)},keepDirection:!0}),o=this.tableProps.countRows(),i=this.tableProps.countCols(),a=!t.some((function(t){var e=r(t),n=UR(e,4),a=n[0],l=n[1],s=n[2],u=n[3],c=FR(a,o)&&FR(l,i)&&FR(s,o)&&FR(u,i);return!c}));return a&&(this.clear(),U(t,(function(t){var n=r(t),o=UR(n,4),i=o[0],a=o[1],l=o[2],s=o[3];e.setRangeStartOnly(e.tableProps.createCellCoords(i,a),!1),e.setRangeEnd(e.tableProps.createCellCoords(l,s)),e.finish()}))),a}},{key:"selectColumns",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r="string"===typeof t?this.tableProps.propToCol(t):t,o="string"===typeof e?this.tableProps.propToCol(e):e,i=this.tableProps.countCols(),a=this.tableProps.countRows(),l=FR(r,i)&&FR(o,i);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(n,r)),this.setRangeEnd(this.tableProps.createCellCoords(a-1,o)),this.finish()),l}},{key:"selectRows",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this.tableProps.countRows(),o=this.tableProps.countCols(),i=FR(t,r)&&FR(e,r);return i&&(this.setRangeStartOnly(this.tableProps.createCellCoords(t,n)),this.setRangeEnd(this.tableProps.createCellCoords(e,o-1)),this.finish()),i}},{key:"refresh",value:function(){var t=this.highlight.getCustomSelections();if(t.forEach((function(t){t.commit()})),this.isSelected()){var e=this.highlight.getCell(),n=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(var r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);var o=this.highlight.createOrGetArea(),i=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();o.commit(),i.commit(),a.commit()}this.highlight.useLayerLevel(n)}}}]),t}();ct(eE,Zv);var nE=eE,rE=Rr("cellTypes"),oE=rE.register,iE=rE.getItem,aE=rE.hasItem,lE=rE.getNames;rE.getValues;function sE(t){if(!aE(t))throw Error('You declared cell type "'.concat(t,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method'));return iE(t)}function uE(t,e){"string"!==typeof t&&(e=t,t=e.CELL_TYPE);var n=e,r=n.editor,o=n.renderer,i=n.validator;r&&Hr(t,r),o&&Xi(t,o),i&&ea(t,i),oE(t,e)}function cE(t,e){var n;return"CELL_TYPE"!==t&&((null===(n=e._automaticallyAssignedMetaProps)||void 0===n?void 0:n.has(t))||!bt(e,t))}function fE(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r="string"===typeof e.type?sE(e.type):e.type;if(t._automaticallyAssignedMetaProps&&pt(e,(function(e,n){t._automaticallyAssignedMetaProps.delete(n)})),ht(r)){n!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);var o={};pt(r,(function(e,r){var i;cE(r,n)&&(o[r]=e,null===(i=t._automaticallyAssignedMetaProps)||void 0===i||i.add(r))})),at(t,o)}}function hE(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}it(n,t);for(var r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function dE(t){return Number.isInteger(t)&&t>=0}function pE(t,e){if(!t())throw new Error("Assertion failed: ".concat(e))}function yE(t){return null===t||void 0===t}function vE(t){return vE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vE(t)}var mE=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),!1===ee(r))return!1;return!0},isEmptyRow:function(t){var e,n,r,o;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),!1===ee(r))return"object"===vE(r)&&(o=this.getCellMeta(t,e),ft(this.getSchema()[o.prop],r));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function gE(t){return gE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gE(t)}function bE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function wE(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bE(Object(n),!0).forEach((function(e){SE(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bE(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function SE(t,e,n){return e=kE(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kE(r.key),r)}}function OE(t,e,n){return e&&CE(t.prototype,e),n&&CE(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function kE(t){var e=RE(t,"string");return"symbol"===gE(e)?e:String(e)}function RE(t,e){if("object"!==gE(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==gE(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function EE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PE(){return OE((function t(){EE(this,t)}))}var TE=function(){function t(e){EE(this,t),this.metaCtor=PE(),this.meta=this.metaCtor.prototype,at(this.meta,mE()),this.meta.instance=e}return OE(t,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(t){var e;at(this.meta,t),fE(this.meta,wE(wE({},t),{},{type:null!==(e=t.type)&&void 0!==e?e:this.meta.type}),t)}}]),t}();function jE(t){return jE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jE(t)}function ME(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,xE(r.key),r)}}function IE(t,e,n){return e&&AE(t.prototype,e),n&&AE(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function xE(t){var e=_E(t,"string");return"symbol"===jE(e)?e:String(e)}function _E(t,e){if("object"!==jE(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==jE(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var HE=function(){function t(e){ME(this,t);var n=e.getMetaConstructor();this.meta=new n}return IE(t,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(t){at(this.meta,t),fE(this.meta,t,t)}}]),t}();function NE(t){return NE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NE(t)}function DE(t){return FE(t)||VE(t)||BE(t)||LE()}function LE(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function BE(t,e){if(t){if("string"===typeof t)return WE(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?WE(t,e):void 0}}function VE(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function FE(t){if(Array.isArray(t))return WE(t)}function WE(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function UE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,YE(r.key),r)}}function GE(t,e,n){return e&&zE(t.prototype,e),n&&zE(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function YE(t){var e=KE(t,"string");return"symbol"===NE(e)?e:String(e)}function KE(t,e){if("object"!==NE(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==NE(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var XE=function(t){function e(t){UE(this,e),this.valueFactory=t,this.data=[],this.index=[],this.holes=new Set}return GE(e,[{key:"obtain",value:function(t){pE((function(){return dE(t)}),"Expecting an unsigned number.");var e,n=this._getStorageIndexByKey(t);if(n>=0)e=this.data[n],void 0===e&&(e=this.valueFactory(t),this.data[n]=e);else if(e=this.valueFactory(t),this.holes.size>0){var r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=e,this.index[t]=r}else this.data.push(e),this.index[t]=this.data.length-1;return e}},{key:"insert",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;pE((function(){return dE(t)||yE(t)}),"Expecting an unsigned number or null/undefined argument.");for(var n=[],r=this.data.length,o=0;o<e;o++)n.push(r+o),this.data.push(void 0);var i=yE(t)?this.index.length:t;this.index=[].concat(DE(this.index.slice(0,i)),n,DE(this.index.slice(i)))}},{key:"remove",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;pE((function(){return dE(t)||yE(t)}),"Expecting an unsigned number or null/undefined argument.");for(var n=this.index.splice(yE(t)?this.index.length-e:t,e),r=0;r<n.length;r++){var o=n[r];"number"===typeof o&&this.holes.add(o)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var t=this;return F(this.data,(function(e,n){return!t.holes.has(n)}))[Symbol.iterator]()}},{key:"entries",value:function(){for(var t=[],e=0;e<this.data.length;e++){var n=this._getKeyByStorageIndex(e);-1!==n&&t.push([n,this.data[e]])}var r=0;return{next:function(){if(r<t.length){var e=t[r];return r+=1,{value:e,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(t){return this.index.length>t?this.index[t]:-1}},{key:"_getKeyByStorageIndex",value:function(t){return this.index.indexOf(t)}},{key:t,value:function(){return this.entries()}}]),e}(Symbol.iterator);function $E(t){return $E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$E(t)}function qE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ZE(r.key),r)}}function JE(t,e,n){return e&&QE(t.prototype,e),n&&QE(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZE(t){var e=tP(t,"string");return"symbol"===$E(e)?e:String(e)}function tP(t,e){if("object"!==$E(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==$E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var eP=["data","width"],nP=function(){function t(e){var n=this;qE(this,t),this.globalMeta=e,this.metas=new XE((function(){return n._createMeta()}))}return JE(t,[{key:"updateMeta",value:function(t,e){var n=this.getMeta(t);at(n,e),fE(n,e)}},{key:"createColumn",value:function(t,e){this.metas.insert(t,e)}},{key:"removeColumn",value:function(t,e){this.metas.remove(t,e)}},{key:"getMeta",value:function(t){return this.metas.obtain(t)}},{key:"getMetaConstructor",value:function(t){return this.metas.obtain(t).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return hE(this.globalMeta.getMetaConstructor(),eP).prototype}}]),t}();function rP(t){return rP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rP(t)}function oP(t){return sP(t)||lP(t)||aP(t)||iP()}function iP(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function aP(t,e){if(t){if("string"===typeof t)return uP(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uP(t,e):void 0}}function lP(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function sP(t){if(Array.isArray(t))return uP(t)}function uP(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function cP(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dP(r.key),r)}}function hP(t,e,n){return e&&fP(t.prototype,e),n&&fP(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function dP(t){var e=pP(t,"string");return"symbol"===rP(e)?e:String(e)}function pP(t,e){if("object"!==rP(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==rP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var yP=function(){function t(e){var n=this;cP(this,t),this.columnMeta=e,this.metas=new XE((function(){return n._createRow()}))}return hP(t,[{key:"updateMeta",value:function(t,e,n){var r=this.getMeta(t,e);at(r,n),fE(r,n)}},{key:"createRow",value:function(t,e){this.metas.insert(t,e)}},{key:"createColumn",value:function(t,e){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(t,e)}},{key:"removeRow",value:function(t,e){this.metas.remove(t,e)}},{key:"removeColumn",value:function(t,e){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(t,e)}},{key:"getMeta",value:function(t,e,n){var r=this.metas.obtain(t).obtain(e);return void 0===n?r:r[n]}},{key:"setMeta",value:function(t,e,n,r){var o,i=this.metas.obtain(t).obtain(e);null===(o=i._automaticallyAssignedMetaProps)||void 0===o||o.delete(n),i[n]=r}},{key:"removeMeta",value:function(t,e,n){var r=this.metas.obtain(t).obtain(e);delete r[n]}},{key:"getMetas",value:function(){for(var t=[],e=Array.from(this.metas.values()),n=0;n<e.length;n++)t.push.apply(t,oP(e[n].values()));return t}},{key:"getMetasAtRow",value:function(t){pE((function(){return dE(t)}),"Expecting an unsigned number.");var e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var t=this;return new XE((function(e){return t._createMeta(e)}))}},{key:"_createMeta",value:function(t){var e=this.columnMeta.getMetaConstructor(t);return new e}}]),t}();function vP(t){return vP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vP(t)}function mP(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wP(r.key),r)}}function bP(t,e,n){return e&&gP(t.prototype,e),n&&gP(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function wP(t){var e=SP(t,"string");return"symbol"===vP(e)?e:String(e)}function SP(t,e){if("object"!==vP(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==vP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var CP=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];mP(this,t),this.hot=e,this.globalMeta=new TE(e),this.tableMeta=new HE(this.globalMeta),this.columnMeta=new nP(this.globalMeta),this.cellMeta=new yP(this.columnMeta),o.forEach((function(t){return new t(n)})),this.globalMeta.updateMeta(r)}return bP(t,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(t){this.globalMeta.updateMeta(t)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(t){this.tableMeta.updateMeta(t)}},{key:"getColumnMeta",value:function(t){return this.columnMeta.getMeta(t)}},{key:"updateColumnMeta",value:function(t,e){this.columnMeta.updateMeta(t,e)}},{key:"getCellMeta",value:function(t,e,n){var r=n.visualRow,o=n.visualColumn,i=this.cellMeta.getMeta(t,e);return i.visualRow=r,i.visualCol=o,i.row=t,i.col=e,this.runLocalHooks("afterGetCellMeta",i),i}},{key:"getCellMetaKeyValue",value:function(t,e,n){if("string"!==typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,n)}},{key:"setCellMeta",value:function(t,e,n,r){this.cellMeta.setMeta(t,e,n,r)}},{key:"updateCellMeta",value:function(t,e,n){this.cellMeta.updateMeta(t,e,n)}},{key:"removeCellMeta",value:function(t,e,n){this.cellMeta.removeMeta(t,e,n)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(t){return this.cellMeta.getMetasAtRow(t)}},{key:"createRow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}},{key:"removeRow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}},{key:"createColumn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}},{key:"removeColumn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),t}();function OP(t){return OP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OP(t)}function kP(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function RP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,PP(r.key),r)}}function EP(t,e,n){return e&&RP(t.prototype,e),n&&RP(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function PP(t){var e=TP(t,"string");return"symbol"===OP(e)?e:String(e)}function TP(t,e){if("object"!==OP(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==OP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}ct(CP,Zv);var jP=function(){function t(e){var n=this;kP(this,t),this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",(function(t){return n.extendCellMeta(t)})),mr.getSingleton().add("beforeRender",(function(t){t&&n.metaSyncMemo.clear()}),this.metaManager.hot)}return EP(t,[{key:"extendCellMeta",value:function(t){var e,n=t.row,r=t.col;if(null===(e=this.metaSyncMemo.get(n))||void 0===e||!e.has(r)){var o=t.visualRow,i=t.visualCol,a=this.metaManager.hot,l=a.colToProp(i);t.prop=l,a.runHooks("beforeGetCellMeta",o,i,t);var s,u=bt(t,"type")?t.type:null,c=_n(t.cells)?t.cells(n,r,l):null;if(u)if(c)c.type=null!==(s=c.type)&&void 0!==s?s:u;else c={type:u};c&&this.metaManager.updateCellMeta(n,r,c),a.runHooks("afterGetCellMeta",o,i,t),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(r)}}}]),t}();function MP(t){return MP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},MP(t)}function AP(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function IP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_P(r.key),r)}}function xP(t,e,n){return e&&IP(t.prototype,e),n&&IP(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _P(t){var e=HP(t,"string");return"symbol"===MP(e)?e:String(e)}function HP(t,e){if("object"!==MP(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==MP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var NP=function(){function t(e){AP(this,t),this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(t){var e=this.metaManager.hot.isRtl();if(e&&"fixedColumnsLeft"===t)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(t,e,n){if(!n)throw new Error("The `".concat(t,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return xP(t,[{key:"extendMetaProps",value:function(){var t=this;this.propDescriptors.forEach((function(e,n){var r=e.target,o=e.onChange,i=void 0===o?function(){}:o,a="string"===typeof r,l=a?r:n,s="_".concat(l);t.metaManager.globalMeta.meta[s]=t.metaManager.globalMeta.meta[l],t.installPropWatcher(n,s,i),a&&t.installPropWatcher(r,s,i)}))}},{key:"installPropWatcher",value:function(t,e,n){var r=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get:function(){return this[e]},set:function(o){var i=!r.usageTracker.has(t);r.usageTracker.add(t),n.call(r,t,o,i),this[e]=o},enumerable:!0,configurable:!0})}}]),t}(),DP=(n(9714),/^(\r\n|\n\r|\r|\n)/),LP=/^[^\t\r\n]+/,BP=/^\t/;function VP(t){var e=[[""]];if(0===t.length)return e;var n,r=0,o=0;while(t.length>0){if(n===t.length)break;if(n=t.length,t.match(BP))t=t.replace(BP,""),r+=1,e[o][r]="";else if(t.match(DP))t=t.replace(DP,""),r=0,o+=1,e[o]=[""];else{var i="";if(t.startsWith('"')){var a=0,l=!0;while(l){var s=t.slice(0,1);'"'===s&&(a+=1),i+=s,t=t.slice(1),(0===t.length||t.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(function(t){return new Array(Math.floor(t.length/2)).fill('"').join("")}))}else{var u=t.match(LP);i=u?u[0]:"",t=t.slice(i.length)}e[o][r]=i}}return e}function FP(t){var e,n,r,o,i,a="";for(e=0,n=t.length;e<n;e+=1){for(o=t[e].length,r=0;r<o;r+=1)r>0&&(a+="\t"),i=t[e][r],"string"===typeof i?i.indexOf("\n")>-1?a+='"'.concat(i.replace(/"/g,'""'),'"'):a+=i:a+=null===i||void 0===i?"":i;e!==n-1&&(a+="\n")}return a}function WP(t){return YP(t)||GP(t)||zP(t)||UP()}function UP(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function zP(t,e){if(t){if("string"===typeof t)return KP(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?KP(t,e):void 0}}function GP(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function YP(t){if(Array.isArray(t))return KP(t)}function KP(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function XP(t){return XP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},XP(t)}function $P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qP(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,JP(r.key),r)}}function QP(t,e,n){return e&&qP(t.prototype,e),n&&qP(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function JP(t){var e=ZP(t,"string");return"symbol"===XP(e)?e:String(e)}function ZP(t,e){if("object"!==XP(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==XP(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var tT=function(){function t(e,n,r){$P(this,t),this.instance=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return QP(t,[{key:"createMap",value:function(){var t=this.getSchema();if("undefined"===typeof t)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var e,n=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,n){var r=0,o=0,i=!1;if("function"===typeof n){var a=mt(t);r=a>0?a:this.countFirstRowKeys(),i=!0}else{var l=this.tableMeta.maxCols;r=Math.min(l,n.length)}for(e=0;e<r;e++){var s=i?n(e):n[e];if(ht(s)){if("undefined"!==typeof s.data){var u=i?o:e;this.colToPropCache[u]=s.data,this.propToColCache.set(s.data,u)}o+=1}}}else this.recursiveDuckColumns(t)}},{key:"countFirstRowKeys",value:function(){return Vv(this.dataSource)}},{key:"recursiveDuckColumns",value:function(t,e,n){var r,o=this,i=e,a=n;return"undefined"===typeof i&&(i=0,a=""),"object"!==XP(t)||Array.isArray(t)||pt(t,(function(t,e){null===t?(r=a+e,o.colToPropCache.push(r),o.propToColCache.set(r,i),i+=1):i=o.recursiveDuckColumns(t,i,"".concat(e,"."))})),i}},{key:"colToProp",value:function(t){if(!1===Number.isInteger(t))return t;var e=this.instance.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&Zt(this.colToPropCache[e])?this.colToPropCache[e]:e}},{key:"propToCol",value:function(t){var e=this.propToColCache.get(t);if(Zt(e))return this.instance.toVisualColumn(e);var n=this.instance.toVisualColumn(t);return null===n?t:n}},{key:"getSchema",value:function(){var t=this.tableMeta.dataSchema;return t?"function"===typeof t?t():t:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?ot(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.source,i=r.mode,a=void 0===i?"above":i,l=this.instance.countSourceRows(),s=l,u=0,c=t;("number"!==typeof c||c>=l)&&(c=l),c<this.instance.countRows()&&(s=this.instance.toPhysicalRow(c));var f=this.instance.runHooks("beforeCreateRow",c,n,o);if(!1===f||null===s)return{delta:0};var h=this.tableMeta.maxRows,d=this.getSchema().length,p=[],y=function(){var t=null;"array"===e.instance.dataType?e.tableMeta.dataSchema?t=st(e.getSchema()):(t=[],Ho(d-1,(function(){return t.push(null)}))):"function"===e.instance.dataType?t=e.tableMeta.dataSchema(c+u):(t={},lt(t,e.getSchema())),p.push(t),u+=1};while(u<n&&l+u<h)y();this.instance.rowIndexMapper.insertIndexes(c,u),"below"===a&&(s=Math.min(s+1,l)),this.spliceData(s,0,p);var v=this.instance.toVisualRow(s);return this.instance.countSourceRows()===p.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),u>0&&(void 0===t||null===t?this.metaManager.createRow(null,u):"auto"!==o&&this.metaManager.createRow(s,n)),this.instance.runHooks("afterCreateRow",v,u,o),this.instance.forceFullRender=!0,{delta:u,startPhysicalIndex:s}}},{key:"createCol",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.source,o=n.mode,i=void 0===o?"start":o;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var a=this.dataSource,l=this.tableMeta.maxCols,s=this.instance.countSourceCols(),u=t;("number"!==typeof u||u>=s)&&(u=s);var c=this.instance.runHooks("beforeCreateCol",u,e,r);if(!1===c)return{delta:0};var f=s;u<this.instance.countCols()&&(f=this.instance.toPhysicalColumn(u));var h=this.instance.countSourceRows(),d=this.instance.countCols(),p=0,y=f;"end"===i&&(y=Math.min(y+1,s));var v=y;while(p<e&&d<l){if("number"!==typeof u||u>=d)if(h>0)for(var m=0;m<h;m+=1)"undefined"===typeof a[m]&&(a[m]=[]),a[m].push(null);else a.push([null]);else for(var g=0;g<h;g++)a[g].splice(y,0,null);p+=1,y+=1,d+=1}this.instance.columnIndexMapper.insertIndexes(u,p),p>0&&(void 0===t||null===t?this.metaManager.createColumn(null,p):"auto"!==r&&this.metaManager.createColumn(v,e));var b=this.instance.toVisualColumn(v);return this.instance.runHooks("afterCreateCol",b,p,r),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:p,startPhysicalIndex:v}}},{key:"removeRow",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(t)?t:-n,i=this.visualRowsToPhysical(o,n),a=this.instance.countSourceRows();o=(a+o)%a;var l=this.instance.runHooks("beforeRemoveRow",o,i.length,i,r);if(!1===l)return!1;var s=i.length;if(this.filterData(o,s,i),o<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(i);var u=Zt(this.tableMeta.columns)||Zt(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===u&&this.instance.columnIndexMapper.setIndexesSequence([])}var c=i.slice(0).sort((function(t,e){return e-t}));return c.forEach((function(t){e.metaManager.removeRow(t,1)})),this.instance.runHooks("afterRemoveRow",o,s,i,r),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var r="number"!==typeof t?-e:t;r=(this.instance.countCols()+r)%this.instance.countCols();var o=this.visualColumnsToPhysical(r,e),i=o.slice(0).sort((function(t,e){return e-t})),a=this.instance.runHooks("beforeRemoveCol",r,e,o,n);if(!1===a)return!1;for(var l=!0,s=i.length,u=this.dataSource,c=0;c<s;c++)l&&o[0]!==o[c]-c&&(l=!1);if(l)for(var f=0,h=this.instance.countSourceRows();f<h;f++)u[f].splice(o[0],e),0===f&&this.metaManager.removeColumn(o[0],e);else for(var d=0,p=this.instance.countSourceRows();d<p;d++)for(var y=0;y<s;y++)u[d].splice(i[y],1),0===d&&this.metaManager.removeColumn(i[y],1);return r<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(o),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",r,e,o,n),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(t,e,n){for(var r=this.instance.getDataAtCol(t),o=r.slice(e,e+n),i=r.slice(e+n),a=arguments.length,l=new Array(a>3?a-3:0),s=3;s<a;s++)l[s-3]=arguments[s];L(l,i);var u=0;while(u<n)l.push(null),u+=1;return D(l),this.instance.populateFromArray(e,t,l,null,null,"spliceCol"),o}},{key:"spliceRow",value:function(t,e,n){for(var r=this.instance.getSourceDataAtRow(t),o=r.slice(e,e+n),i=r.slice(e+n),a=arguments.length,l=new Array(a>3?a-3:0),s=3;s<a;s++)l[s-3]=arguments[s];L(l,i);var u=0;while(u<n)l.push(null),u+=1;return this.instance.populateFromArray(t,e,[l],null,null,"spliceRow"),o}},{key:"spliceData",value:function(t,e,n){var r=this,o=this.instance.runHooks("beforeDataSplice",t,e,n);if(!1!==o){var i=[].concat(WP(this.dataSource.slice(0,t)),WP(n),WP(this.dataSource.slice(t)));this.dataSource.length=0,i.forEach((function(t){return r.dataSource.push(t)}))}}},{key:"filterData",value:function(t,e,n){var r=this.instance.runHooks("filterData",t,e,n);!1===Array.isArray(r)&&(r=this.dataSource.filter((function(t,e){return-1===n.indexOf(e)}))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}},{key:"get",value:function(t,e){var n=this.instance.toPhysicalRow(t),r=this.dataSource[n],o=this.instance.runHooks("modifyRowData",n);r=isNaN(o)?o:r;var i=null;if(r&&r.hasOwnProperty&&bt(r,e))i=r[e];else if("string"===typeof e&&e.indexOf(".")>-1){var a=e.split("."),l=r;if(!l)return null;for(var s=0,u=a.length;s<u;s++)if(l=l[a[s]],"undefined"===typeof l)return null;i=l}else"function"===typeof e&&(i=e(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var c=gt(i);this.instance.runHooks("modifyData",n,this.propToCol(e),c,"get"),c.isTouched()&&(i=c.value)}return i}},{key:"getCopyable",value:function(t,e){return this.instance.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}},{key:"set",value:function(t,e,n){var r=this.instance.toPhysicalRow(t),o=n,i=this.dataSource[r],a=this.instance.runHooks("modifyRowData",r);if(i=isNaN(a)?a:i,this.instance.hasHook("modifyData")){var l=gt(o);this.instance.runHooks("modifyData",r,this.propToCol(e),l,"set"),l.isTouched()&&(o=l.value)}if(i&&i.hasOwnProperty&&bt(i,e))i[e]=o;else if("string"===typeof e&&e.indexOf(".")>-1){var s,u=e.split("."),c=i,f=0;for(f=0,s=u.length-1;f<s;f++)"undefined"===typeof c[u[f]]&&(c[u[f]]={}),c=c[u[f]];c[u[f]]=o}else"function"===typeof e?e(this.dataSource.slice(r,r+1)[0],o):i[e]=o}},{key:"visualRowsToPhysical",value:function(t,e){var n,r=this.instance.countSourceRows(),o=[],i=(r+t)%r,a=e;while(i<r&&a)n=this.instance.toPhysicalRow(i),o.push(n),a-=1,i+=1;return o}},{key:"visualColumnsToPhysical",value:function(t,e){var n=this.instance.countCols(),r=[],o=(n+t)%n,i=e;while(o<n&&i){var a=this.instance.toPhysicalColumn(o);r.push(a),i-=1,o+=1}return r}},{key:"clear",value:function(){for(var t=0;t<this.instance.countSourceRows();t++)for(var e=0;e<this.instance.countCols();e++)this.set(t,this.colToProp(e),"")}},{key:"getLength",value:function(){var t,e=this.tableMeta.maxRows;t=e<0||0===e?0:e||1/0;var n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,t)}},{key:"getAll",value:function(){var e={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-n.row!==0||this.instance.countSourceRows()?this.getRange(e,n,t.DESTINATION_RENDERER):[]}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(e,n,r){var o,i,a,l=[],s=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(0===s||0===u)return[];var c=r===t.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(s-1,0),Math.max(e.row,n.row)),h=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=f;o++){a=[];var d=o>=0?this.instance.toPhysicalRow(o):o;for(i=Math.min(e.col,n.col);i<=h;i++){if(null===d)break;a.push(c.call(this,o,this.colToProp(i)))}null!==d&&l.push(a)}return l}},{key:"getText",value:function(e,n){return FP(this.getRange(e,n,t.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(e,n){return FP(this.getRange(e,n,t.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),t}(),eT=tT;function nT(t){return nT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nT(t)}function rT(t,e,n,r){var o=r.hotInstance,i=r.dataMap,a=r.dataSource,l=r.internalSource,s=r.source,u=r.metaManager,c=r.firstRun,f=be(l),h=o.getSettings();Array.isArray(h.dataSchema)?o.dataType="array":_n(h.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),t=o.runHooks("before".concat(f),t,c,s);var d=new eT(o,t,u);if(e(d),"object"===nT(t)&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error("".concat(l," only accepts array of objects or array of arrays (").concat(nT(t)," given)"));var p,y=d.getSchema();t=[];var v=0,m=0;for(v=0,m=h.startRows;v<m;v++)if("object"!==o.dataType&&"function"!==o.dataType||!h.dataSchema)if("array"===o.dataType)p=st(y[0]),t.push(p);else{p=[];for(var g=0,b=h.startCols;g<b;g++)p.push(null);t.push(p)}else p=st(y),t.push(p)}Array.isArray(t[0])&&(o.dataType="array"),h.data=t,d.dataSource=t,a.data=t,a.dataType=o.dataType,a.colToProp=d.colToProp.bind(d),a.propToCol=d.propToCol.bind(d),a.countCachedColumns=d.countCachedColumns.bind(d),n(d),o.runHooks("after".concat(f),t,c,s),c||(o.runHooks("afterChange",null,l),o.render())}var oT,iT=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),aT=function(t){return t.map((function(t){var e=t.toLowerCase();return iT.has(e)?iT.get(e):e})).sort().join("+")},lT=function(t){return t.split("+")},sT=function(t){return t.toLowerCase()};function uT(t){return hT(t)||fT(t)||yT(t)||cT()}function cT(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fT(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function hT(t){if(Array.isArray(t))return vT(t)}function dT(t,e){return gT(t)||mT(t,e)||yT(t,e)||pT()}function pT(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function yT(t,e){if(t){if("string"===typeof t)return vT(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vT(t,e):void 0}}function vT(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function mT(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function gT(t){if(Array.isArray(t))return t}function bT(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var wT=function(t){var e=fi({errorIdExists:function(e){return'The "'.concat(e,'" shortcut is already registered in the "').concat(t,'" context.')}}),n=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.keys,r=t.callback,o=t.group,i=t.runOnlyIf,a=void 0===i?function(){return!0}:i,l=t.captureCtrl,s=void 0!==l&&l,u=t.preventDefault,c=void 0===u||u,f=t.stopPropagation,h=void 0!==f&&f,d=t.relativeToGroup,p=t.position;if(te(o))throw new Error("You need to define the shortcut's group.");if(!1===_n(r))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(n))throw new Error($t(oT||(oT=bT(["Pass the shortcut's keys as an array of arrays, \n      using the KeyboardEvent.key properties: \n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."],["Pass the shortcut\\'s keys as an array of arrays,\\x20\n      using the KeyboardEvent.key properties:\\x20\n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."]))));var y={callback:r,group:o,runOnlyIf:a,captureCtrl:s,preventDefault:c,stopPropagation:h};if(Zt(d)){var v=[d,p];y.relativeToGroup=v[0],y.position=v[1]}n.forEach((function(t){var n=aT(t),r=e.hasItem(n);if(r){var o=e.getItem(n),i=o.findIndex((function(t){return t.group===d}));-1!==i?"before"===p?i-=1:i+=1:i=o.length,o.splice(i,0,y)}else e.addItem(n,[y])}))},r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach((function(t){pt(e,(function(n,r){!1===Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=e[r])})),n(t)}))},o=function(t){var n=aT(t);e.removeItem(n)},i=function(t){var n=e.getItems();n.forEach((function(e){var n=dT(e,2),r=n[0],i=n[1],a=i.filter((function(e){return e.group!==t}));0===a.length?o(lT(r)):(i.length=0,i.push.apply(i,uT(a)))}))},a=function(t){var n=aT(t),r=e.getItem(n);return Zt(r)?r.slice():[]},l=function(t){var n=aT(t);return e.hasItem(n)};return{addShortcut:n,addShortcuts:r,getShortcuts:a,hasShortcut:l,removeShortcutsByKeys:o,removeShortcutsByGroup:i}};function ST(){var t=new Set;return{press:function(e){t.add(e)},release:function(e){t.delete(e)},releaseAll:function(){t.clear()},isPressed:function(e){return t.has(e)}}}var CT=["meta","alt","shift","control"],OT=ST();function kT(t,e,n,r,o){var i=function(t){return CT.includes(t)},a=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return t.altKey&&n.push("alt"),e&&(t.ctrlKey||t.metaKey)?n.push("control/meta"):(t.ctrlKey&&n.push("control"),t.metaKey&&n.push("meta")),t.shiftKey&&n.push("shift"),n},l=function(t){if(!1!==e(t)){var l=n(t);if(229!==t.keyCode&&!1!==l&&!Jn(t)){var s=sT(t.key),u=[];i(s)?OT.press(s):u=a(t);var c=[s].concat(u),f=o(t,c);!f&&(Bt()&&u.includes("meta")||!Bt()&&u.includes("control"))&&o(t,[s].concat(a(t,!0))),r(t)}}},s=function(t){if(!1!==e(t)){var n=sT(t.key);!1!==i(n)&&OT.release(n)}},u=function(){OT.releaseAll()},c=function(){var e=t;while(e)e.document.documentElement.addEventListener("keydown",l),e.document.documentElement.addEventListener("keyup",s),e.document.documentElement.addEventListener("blur",u),e=_e(e)},f=function(){var e=t;while(e)e.document.documentElement.removeEventListener("keydown",l),e.document.documentElement.removeEventListener("keyup",s),e.document.documentElement.removeEventListener("blur",u),e=_e(e)};return{mount:c,unmount:f,isPressed:function(t){return OT.isPressed(t)},releasePressedKeys:function(){return OT.releaseAll()}}}var RT=function(t){var e=t.ownerWindow,n=t.handleEvent,r=t.beforeKeyDown,o=t.afterKeyDown,i=fi({errorIdExists:function(t){return'The "'.concat(t,'" context name is already registered.')}}),a="grid",l=function(t){var e=wT(t);return i.addItem(t,e),e},s=function(){return a},u=function(t){return i.getItem(t)},c=function(t){a=t},f=!1,h=kT(e,n,r,o,(function(t,e){var n=u(s()),r=!1;if(!n.hasShortcut(e))return r;for(var o=n.getShortcuts(e),i=0;i<o.length;i++){var a=o[i],l=a.callback,c=a.runOnlyIf,h=a.preventDefault,d=a.stopPropagation,p=a.captureCtrl;if(!1!==c(t)&&(f=p,r=!1===l(t,e),f=!1,h&&t.preventDefault(),d&&t.stopPropagation(),r))break}return r}));return h.mount(),{addContext:l,getActiveContextName:s,getContext:u,setActiveContextName:c,isCtrlPressed:function(){return!f&&(h.isPressed("control")||h.isPressed("meta"))},releasePressedKeys:function(){return h.releasePressedKeys()},destroy:function(){return h.unmount()}}};function ET(t){return ET="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ET(t)}function PT(t,e){return MT(t)||jT(t,e)||xT(t,e)||TT()}function TT(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function jT(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function MT(t){if(Array.isArray(t))return t}function AT(t){return HT(t)||_T(t)||xT(t)||IT()}function IT(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xT(t,e){if(t){if("string"===typeof t)return NT(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?NT(t,e):void 0}}function _T(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function HT(t){if(Array.isArray(t))return NT(t)}function NT(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var DT="gridDefault",LT=null;new Set;function BT(t,e){var n,r,o,i,a,l=this,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=!1,c=this,f=new Gr(c),h=!0;tv(s)&&Zy(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var d=null!==(n=null===e||void 0===e?void 0:e.layoutDirection)&&void 0!==n?n:"inherit",p=["rtl","ltr"].includes(d)?d:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",p),this.isRtl=function(){return"rtl"===p},this.isLtr=function(){return!c.isRtl()},this.getDirectionFactor=function(){return c.isLtr()?1:-1},e.language=OC(e.language);var y=new CP(c,e,[jP,NP]),v=y.getTableMeta(),m=y.getGlobalMeta(),g=fi();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),ev(this)&&me(e.licenseKey,t),this.guid="ht_".concat(Se()),this.columnIndexMapper=new bw,this.rowIndexMapper=new bw,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(function(t){c.runHooks("afterColumnSequenceChange",t)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(function(t){c.runHooks("afterRowSequenceChange",t)})),o=new qv(c),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);var b=function(t){var e=t.row,n=t.col;return c._createCellCoords(e>=0?c.rowIndexMapper.getRenderableFromVisualIndex(e):e,n>=0?c.columnIndexMapper.getRenderableFromVisualIndex(n):n)},w=function(t){var e=t.row,n=t.col;return c._createCellCoords(e>=0?c.rowIndexMapper.getVisualFromRenderableIndex(e):e,n>=0?c.columnIndexMapper.getVisualFromRenderableIndex(n):n)},S=new nE(v,{rowIndexMapper:function(){return c.rowIndexMapper},columnIndexMapper:function(){return c.columnIndexMapper},countCols:function(){return c.countCols()},countRows:function(){return c.countRows()},propToCol:function(t){return r.propToCol(t)},isEditorOpened:function(){return!!c.getActiveEditor()&&c.getActiveEditor().isOpened()},countColsTranslated:function(){return l.view.countRenderableColumns()},countRowsTranslated:function(){return l.view.countRenderableRows()},getShortcutManager:function(){return c.getShortcutManager()},createCellCoords:function(t,e){return c._createCellCoords(t,e)},createCellRange:function(t,e,n){return c._createCellRange(t,e,n)},visualToRenderableCoords:b,renderableToVisualCoords:w,isDisabledCellSelection:function(t,e){return c.getCellMeta(t,e).disableVisualSelection}});this.selection=S;var C=function(t){var e=t.hiddenIndexesChanged;e&&l.selection.refresh()};function O(t){var e=Cw(t);bC(e)?(c.runHooks("beforeLanguageChange",e),m.language=e,c.runHooks("afterLanguageChange",e)):Ow(t)}function k(t,e){var n="className"===t?c.rootElement:c.table;if(h)Ge(n,e);else{var r=[],o=[];m[t]&&(r=Array.isArray(m[t])?m[t]:Z(m[t])),e&&(o=Array.isArray(e)?e:Z(e));var i=q(r,o),a=q(o,r);i.length&&Ye(n,i),a.length&&Ge(n,a)}m[t]=e}function R(){var t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function E(t){var e=t.replace(",",".");return!1===isNaN(parseFloat(e))?parseFloat(e):t}function P(t,e,n){if(t.length){var o=c.getActiveEditor(),i=new R,a=!0;i.onQueueEmpty=function(t){o&&a&&o.cancelChanges(),n(t)};for(var l=t.length-1;l>=0;l--){var s=PT(t[l],4),u=s[0],f=s[1],h=s[3],d=r.propToCol(f),p=c.getCellMeta(u,d);"numeric"===p.type&&"string"===typeof h&&_o(h)&&(t[l][3]=E(h)),c.getCellValidator(p)&&(i.addValidatorToQueue(),c.validateCell(t[l][3],p,function(e,n){return function(r){if("boolean"!==typeof r)throw new Error("Validation error: result is not boolean");if(!1===r&&!1===n.allowInvalid){a=!1,t.splice(e,1),n.valid=!0;var o=c.getCell(n.visualRow,n.visualCol);null!==o&&Ye(o,v.invalidCellClassName)}i.removeValidatorFormQueue()}}(l,p),e))}i.checkIfQueueIsEmpty()}}function T(t,e){var n=t.length-1;if(!(n<0)){for(;n>=0;n--){var o=!1;if(null!==t[n]){if(null!==t[n][2]&&void 0!==t[n][2]||null!==t[n][3]&&void 0!==t[n][3]){if(v.allowInsertRow)while(t[n][0]>c.countRows()-1){var l=r.createRow(void 0,void 0,{source:e}),s=l.delta;if(0===s){o=!0;break}}if("array"===c.dataType&&(!v.columns||0===v.columns.length)&&v.allowInsertColumn)while(r.propToCol(t[n][1])>c.countCols()-1){var u=r.createCol(void 0,void 0,{source:e}),f=u.delta;if(0===f){o=!0;break}}o||r.set(t[n][0],t[n][1],t[n][3])}}else t.splice(n,1)}c.forceFullRender=!0,i.adjustRowsAndCols(),c.runHooks("beforeChangeRender",t,e),a.lockEditor(),c._refreshBorders(null),a.unlockEditor(),c.view.adjustElementsSize(),c.runHooks("afterChange",t,e||"edit");var h=c.getActiveEditor();h&&Zt(h.refreshValue)&&h.refreshValue()}}function j(t,e,n){return Array.isArray(t)?t:[[t,e,n]]}function M(t,e){var n=c.getActiveEditor(),r=c.runHooks("beforeChange",t,e||"edit"),o=t.filter((function(t){return null!==t}));return!1===r||0===o.length?(n&&n.cancelChanges(),[]):o}this.columnIndexMapper.addLocalHook("cacheUpdated",C),this.rowIndexMapper.addLocalHook("cacheUpdated",C),this.selection.addLocalHook("beforeSetRangeStart",(function(t){l.runHooks("beforeSetRangeStart",t)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(function(t){l.runHooks("beforeSetRangeStartOnly",t)})),this.selection.addLocalHook("beforeSetRangeEnd",(function(t){l.runHooks("beforeSetRangeEnd",t),t.row<0&&(t.row=l.view._wt.wtTable.getFirstVisibleRow()),t.col<0&&(t.col=l.view._wt.wtTable.getFirstVisibleColumn())})),this.selection.addLocalHook("afterSetRangeEnd",(function(t){var e=gt(!1),n=l.selection.getSelectedRange(),r=n.current(),o=r.from,i=r.to,a=n.size()-1;l.runHooks("afterSelection",o.row,o.col,i.row,i.col,e,a),l.runHooks("afterSelectionByProp",o.row,c.colToProp(o.col),i.row,c.colToProp(i.col),e,a);var s=l.selection.isSelectedByAnyHeader(),f=l.selection.selectedRange.current(),h=!0;u&&(h=!1),e.isTouched()&&(h=!e.value);var d=l.selection.isSelectedByRowHeader(),p=l.selection.isSelectedByColumnHeader();!1!==h&&(s?d?l.view.scrollViewportVertically(c.rowIndexMapper.getRenderableFromVisualIndex(t.row)):p&&l.view.scrollViewportHorizontally(c.columnIndexMapper.getRenderableFromVisualIndex(t.col)):f&&!l.selection.isMultiple()?l.view.scrollViewport(b(f.from)):l.view.scrollViewport(b(t))),d&&p?Ge(l.rootElement,["ht__selection--rows","ht__selection--columns"]):d?(Ye(l.rootElement,"ht__selection--columns"),Ge(l.rootElement,"ht__selection--rows")):p?(Ye(l.rootElement,"ht__selection--rows"),Ge(l.rootElement,"ht__selection--columns")):Ye(l.rootElement,["ht__selection--rows","ht__selection--columns"]),l._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(function(t){var e=t.length-1,n=t[e],r=n.from,o=n.to;l.runHooks("afterSelectionEnd",r.row,r.col,o.row,o.col,e),l.runHooks("afterSelectionEndByProp",r.row,c.colToProp(r.col),o.row,c.colToProp(o.col),e)})),this.selection.addLocalHook("afterIsMultipleSelection",(function(t){var e=l.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)})),this.selection.addLocalHook("beforeModifyTransformStart",(function(t){l.runHooks("modifyTransformStart",t)})),this.selection.addLocalHook("afterModifyTransformStart",(function(t,e,n){l.runHooks("afterModifyTransformStart",t,e,n)})),this.selection.addLocalHook("beforeModifyTransformEnd",(function(t){l.runHooks("modifyTransformEnd",t)})),this.selection.addLocalHook("afterModifyTransformEnd",(function(t,e,n){l.runHooks("afterModifyTransformEnd",t,e,n)})),this.selection.addLocalHook("afterDeselect",(function(){a.destroyEditor(),l._refreshBorders(),Ye(l.rootElement,["ht__selection--rows","ht__selection--columns"]),l.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(function(t){l.alter("insert_row_above",t,1,"auto")})),this.selection.addLocalHook("insertColRequire",(function(t){l.alter("insert_col_start",t,1,"auto")})),i={alter:function(t,e){var n,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,u=function(t){if(0===t.length)return[];var e=AT(t);e.sort((function(t,e){var n=PT(t,1),r=n[0],o=PT(e,1),i=o[0];return r===i?0:r>i?1:-1}));var n=V(e,(function(t,e){var n=PT(e,2),r=n[0],o=n[1],i=t[t.length-1],a=PT(i,2),l=a[0],s=a[1],u=l+s;if(r<=u){var c=Math.max(o-(u-r),0);i[1]+=c}else t.push([r,o]);return t}),[e[0]]);return n};switch(t){case"insert_row_below":case"insert_row_above":var f=c.countSourceRows();if(v.maxRows===f)return;var h="insert_row_below"===t?"below":"above";e=null!==(n=e)&&void 0!==n?n:"below"===h?f:0;var d=r.createRow(e,a,{source:l,mode:h}),p=d.delta,y=d.startPhysicalIndex;if(p){var m=S.selectedRange.current(),g=null===m||void 0===m?void 0:m.from,b=null===g||void 0===g?void 0:g.row,w=c.toVisualRow(y);if(S.isSelectedByCorner())c.selectAll();else if(Zt(b)&&b>=w){var C=m.to,O=C.row,k=C.col,R=g.col;S.isSelectedByRowHeader()&&(R=-1),S.getSelectedRange().pop(),S.setRangeStartOnly(c._createCellCoords(b+p,R),!0),S.setRangeEnd(c._createCellCoords(O+p,k))}else c._refreshBorders()}break;case"insert_col_start":case"insert_col_end":var E="insert_col_end"===t?"end":"start";e=null!==(o=e)&&void 0!==o?o:"end"===E?c.countSourceCols():0;var P=r.createCol(e,a,{source:l,mode:E}),T=P.delta,j=P.startPhysicalIndex;if(T){if(Array.isArray(v.colHeaders)){var M=[c.toVisualColumn(j),0];M.length+=T,Array.prototype.splice.apply(v.colHeaders,M)}var A=S.selectedRange.current(),I=null===A||void 0===A?void 0:A.from,x=null===I||void 0===I?void 0:I.col,_=c.toVisualColumn(j);if(S.isSelectedByCorner())c.selectAll();else if(Zt(x)&&x>=_){var H=A.to,N=H.row,D=H.col,L=I.row;S.isSelectedByColumnHeader()&&(L=-1),S.getSelectedRange().pop(),S.setRangeStartOnly(c._createCellCoords(L,x+T),!0),S.setRangeEnd(c._createCellCoords(N,D+T))}else c._refreshBorders()}break;case"remove_row":var B=function(t){var e=0;U(t,(function(t){var n=PT(t,2),o=n[0],i=n[1],a=ee(o)?c.countRows()-1:Math.max(o-e,0);Number.isInteger(o)&&(o=Math.max(o-e,0));var s=r.removeRow(o,i,l);if(s){var u=c.countRows(),f=v.fixedRowsTop;f>=a+1&&(v.fixedRowsTop-=Math.min(i,f-a));var h=v.fixedRowsBottom;h&&a>=u-h&&(v.fixedRowsBottom-=Math.min(i,h)),e+=i}}))};Array.isArray(e)?B(u(e)):B([[e,a]]),i.adjustRowsAndCols(),c._refreshBorders();break;case"remove_col":var F=function(t){var e=0;U(t,(function(t){var n=PT(t,2),o=n[0],i=n[1],a=ee(o)?c.countCols()-1:Math.max(o-e,0),s=c.toPhysicalColumn(a);Number.isInteger(o)&&(o=Math.max(o-e,0));var u=r.removeCol(o,i,l);if(u){var f=v.fixedColumnsStart;f>=a+1&&(v.fixedColumnsStart-=Math.min(i,f-a)),Array.isArray(v.colHeaders)&&("undefined"===typeof s&&(s=-1),v.colHeaders.splice(s,i)),e+=i}}))};Array.isArray(e)?F(u(e)):F([[e,a]]),i.adjustRowsAndCols(),c._refreshBorders();break;default:throw new Error('There is no such action "'.concat(t,'"'))}s||i.adjustRowsAndCols()},adjustRowsAndCols:function(){var t,e=v.minRows,n=v.minSpareRows,o=v.minCols,i=v.minSpareCols;if(0===c.countRows()&&0===c.countCols()&&S.deselect(),e){var a=c.countRows();a<e&&r.createRow(a,e-a,{source:"auto"})}if(n){var l=c.countEmptyRows(!0);if(l<n){var s=n-l,u=Math.min(s,v.maxRows-c.countSourceRows());r.createRow(c.countRows(),u,{source:"auto"})}}(o||i)&&(t=c.countEmptyCols(!0));var f=c.countCols();if(o&&!v.columns&&f<o){var h=o-f;t+=h,r.createCol(f,h,{source:"auto"})}if(i&&!v.columns&&"array"===c.dataType&&t<i){f=c.countCols();var d=i-t,p=Math.min(d,v.maxCols-f);r.createCol(f,p,{source:"auto"})}if(S.isSelected()){var y=c.countRows(),m=c.countCols();U(S.selectedRange,(function(t){var e=!1,n=t.from.row,r=t.from.col,o=t.to.row,i=t.to.col;n>y-1?(n=y-1,e=!0,o>n&&(o=n)):o>y-1&&(o=y-1,e=!0,n>o&&(n=o)),r>m-1?(r=m-1,e=!0,i>r&&(i=r)):i>m-1&&(i=m-1,e=!0,r>i&&(r=i)),e&&c.selectCell(n,r,o,i)}))}c.view&&c.view.adjustElementsSize()},populateFromArray:function(t,e,n,r,o){var i,a,l,s,u=[],f={},h=[],d=t.row,p=t.col;if(a=e.length,0===a)return!1;var y=0,m=0;switch(ht(n)&&(y=n.col-p+1,m=n.row-d+1),o){case"shift_down":var g=B(e),b=g.length,w=Math.max(b,y),S=c.getData().slice(d),C=B(S).slice(p,p+w);for(l=0;l<w;l+=1)if(l<b){for(i=0,a=g[l].length;i<m-a;i+=1)g[l].push(g[l][i%a]);l<C.length?h.push(g[l].concat(C[l])):h.push(g[l].concat(new Array(S.length).fill(null)))}else h.push(g[l%b].concat(C[l]));c.populateFromArray(d,p,B(h));break;case"shift_right":var O=e.length,k=Math.max(O,m),R=c.getData().slice(d).map((function(t){return t.slice(p)}));for(i=0;i<k;i+=1)if(i<O){for(l=0,s=e[i].length;l<y-s;l+=1)e[i].push(e[i][l%s]);var E;if(i<R.length)for(var P=0;P<R[i].length;P+=1)e[i].push(R[i][P]);else(E=e[i]).push.apply(E,AT(new Array(R[0].length).fill(null)))}else e.push(e[i%a].slice(0,k).concat(R[i]));c.populateFromArray(d,p,e);break;case"overwrite":default:f.row=t.row,f.col=t.col;var T,j=0,M=0,A=!0,I=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e[t%e.length];return null!==n?r[n%r.length]:r},x=e.length,_=n?n.row-t.row+1:0;for(a=n?_:Math.max(x,_),i=0;i<a;i++){if(n&&f.row>n.row&&_>x||!v.allowInsertRow&&f.row>c.countRows()-1||f.row>=v.maxRows)break;var H=i-j,N=I(H).length,D=n?n.col-t.col+1:0;if(s=n?D:Math.max(N,D),f.col=t.col,T=c.getCellMeta(f.row,f.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!T.skipRowOnPaste){for(M=0,l=0;l<s;l++){if(n&&f.col>n.col&&D>N||!v.allowInsertColumn&&f.col>c.countCols()-1||f.col>=v.maxCols)break;if(T=c.getCellMeta(f.row,f.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!T.skipColumnOnPaste)if(T.readOnly&&"UndoRedo.undo"!==r)f.col+=1;else{var L=l-M,V=I(H,L),F=c.getDataAtCell(f.row,f.col);if(null!==V&&"object"===ET(V))if(Array.isArray(V)&&null===F&&(F=[]),null===F||"object"!==ET(F))A=!1;else{var W=ot(Array.isArray(F)?F:F[0]||F),U=ot(Array.isArray(V)?V:V[0]||V);ft(W,U)||Array.isArray(W)&&Array.isArray(U)?V=st(V):A=!1}else null!==F&&"object"===ET(F)&&(A=!1);A&&u.push([f.row,f.col,V]),A=!0,f.col+=1}else M+=1,f.col+=1,s+=1}f.row+=1}else j+=1,f.row+=1,a+=1}c.setDataAtCell(u,null,null,r||"populateFromArray");break}}},this.init=function(){o.setData(v.data),c.runHooks("beforeInit"),(Ht()||Dt())&&Ge(c.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new Mv(this),a=ho.getInstance(c,v,S),c.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&null===c.rootElement.offsetParent&&xn(c.rootElement,(function(){c.view._wt.wtOverlays.updateLastSpreaderSize(),c.render(),c.view.adjustElementsSize()})),"object"===ET(h)&&(c.runHooks("afterChange",h[0],h[1]),h=!1),c.runHooks("afterInit")},this._createCellCoords=function(t,e){return c.view._wt.createCellCoords(t,e)},this._createCellRange=function(t,e,n){return c.view._wt.createCellRange(t,e,n)},this.validateCell=function(t,e,n,r){var o=c.getCellValidator(e);function i(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(r&&!0!==e.hidden){var o=e.visualCol,i=e.visualRow,a=c.getCell(i,o,!0);if(a&&"TH"!==a.nodeName){var l=c.rowIndexMapper.getRenderableFromVisualIndex(i),s=c.columnIndexMapper.getRenderableFromVisualIndex(o);c.view._wt.getSetting("cellRenderer",l,s,a)}n(t)}else n(t)}ne(o)&&(o=function(t){return function(e,n){n(t.test(e))}}(o)),_n(o)?(t=c.runHooks("beforeValidate",t,e.visualRow,e.prop,r),c._registerImmediate((function(){o.call(e,t,(function(n){c&&(n=c.runHooks("afterValidate",n,t,e.visualRow,e.prop,r),e.valid=n,i(n),c.runHooks("postAfterValidate",n,t,e.visualRow,e.prop,r))}))}))):c._registerImmediate((function(){e.valid=!0,i(e.valid,!1)}))},this.setDataAtCell=function(t,e,n,i){var a,l,s,u=j(t,e,n),f=[],h=i;for(a=0,l=u.length;a<l;a++){if("object"!==ET(u[a]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!==typeof u[a][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");s=u[a][1]>=this.countCols()?u[a][1]:r.colToProp(u[a][1]),f.push([u[a][0],s,o.getAtCell(this.toPhysicalRow(u[a][0]),u[a][1]),u[a][2]])}h||"object"!==ET(t)||(h=e);var d=M(f,i);c.runHooks("afterSetDataAtCell",d,h),P(d,h,(function(){T(d,h)}))},this.setDataAtRowProp=function(t,e,n,r){var i,a,l=j(t,e,n),s=[],u=r;for(i=0,a=l.length;i<a;i++)s.push([l[i][0],l[i][1],o.getAtCell(this.toPhysicalRow(l[i][0]),l[i][1]),l[i][2]]);u||"object"!==ET(t)||(u=e);var f=M(s,r);c.runHooks("afterSetDataAtRowProp",f,u),P(f,u,(function(){T(f,u)}))},this.listen=function(){c&&!c.isListening()&&(LT=c.guid,c.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(LT=null,c.runHooks("afterUnlisten"))},this.isListening=function(){return LT===c.guid},this.destroyEditor=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];c._refreshBorders(t,e)},this.populateFromArray=function(t,e,n,r,o,a,l){if("object"!==ET(n)||"object"!==ET(n[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");var s="number"===typeof r?c._createCellCoords(r,o):null;return i.populateFromArray(c._createCellCoords(t,e),n,s,a,l)},this.spliceCol=function(t,e,n){for(var o,i=arguments.length,a=new Array(i>3?i-3:0),l=3;l<i;l++)a[l-3]=arguments[l];return(o=r).spliceCol.apply(o,[t,e,n].concat(a))},this.spliceRow=function(t,e,n){for(var o,i=arguments.length,a=new Array(i>3?i-3:0),l=3;l<i;l++)a[l-3]=arguments[l];return(o=r).spliceRow.apply(o,[t,e,n].concat(a))},this.getSelected=function(){if(S.isSelected())return W(S.getSelectedRange(),(function(t){var e=t.from,n=t.to;return[e.row,e.col,n.row,n.col]}))},this.getSelectedLast=function(){var t,e=this.getSelected();return e&&e.length>0&&(t=e[e.length-1]),t},this.getSelectedRange=function(){if(S.isSelected())return Array.from(S.getSelectedRange())},this.getSelectedRangeLast=function(){var t,e=this.getSelectedRange();return e&&e.length>0&&(t=e[e.length-1]),t},this.emptySelectedCells=function(t){var e=this;if(S.isSelected()&&0!==this.countRows()&&0!==this.countCols()){var n=[];U(S.getSelectedRange(),(function(t){var r=t.getTopStartCorner(),o=t.getBottomEndCorner();Ho(r.row,o.row,(function(t){Ho(r.col,o.col,(function(r){e.getCellMeta(t,r).readOnly||n.push([t,r,null])}))}))})),n.length>0&&this.setDataAtCell(n,t)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var t=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(t,0),this.isRenderSuspended()||t!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(a.lockEditor(),this._refreshBorders(null),a.unlockEditor()))},this.batchRender=function(t){this.suspendRender();var e=t();return this.resumeRender(),e},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(e,0),(!this.isExecutionSuspended()&&e===this.executionSuspendedCounter||t)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();var n=t();return this.resumeExecution(e),n},this.batch=function(t){this.suspendRender(),this.suspendExecution();var e=t();return this.resumeExecution(),this.resumeRender(),e},this.refreshDimensions=function(){if(c.view){var t=c.view.getLastSize(),e=t.width,n=t.height,r=c.rootElement.getBoundingClientRect(),o=r.width,i=r.height,a=o!==e||i!==n,l=!1===c.runHooks("beforeRefreshDimensions",{width:e,height:n},{width:o,height:i},a);l||((a||c.view._wt.wtOverlays.scrollableElement===c.rootWindow)&&(c.view.setLastSize(o,i),c.render()),c.runHooks("afterRefreshDimensions",{width:e,height:n},{width:o,height:i},a))}},this.updateData=function(t,e){var n=this;rT(t,(function(t){r=t}),(function(t){r=t,c.columnIndexMapper.fitToLength(n.getInitialColumnCount()),c.rowIndexMapper.fitToLength(n.countSourceRows()),i.adjustRowsAndCols()}),{hotInstance:c,dataMap:r,dataSource:o,internalSource:"updateData",source:e,metaManager:y,firstRun:h})},this.loadData=function(t,e){rT(t,(function(t){r=t}),(function(){y.clearCellsCache(),c.initIndexMappers(),i.adjustRowsAndCols(),h&&(h=[null,"loadData"])}),{hotInstance:c,dataMap:r,dataSource:o,internalSource:"loadData",source:e,metaManager:y,firstRun:h})},this.getInitialColumnCount=function(){var t=v.columns,e=0;if(Array.isArray(t))e=t.length;else if(_n(t))if("array"===c.dataType)for(var n=this.countSourceCols(),o=0;o<n;o+=1)t(o)&&(e+=1);else"object"!==c.dataType&&"function"!==c.dataType||(e=r.colToPropCache.length);else if(Zt(v.dataSchema)){var i=r.getSchema();e=Array.isArray(i)?i.length:mt(i)}else e=this.countSourceCols();return e},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(t,e,n,o){return te(t)?r.getAll():r.getRange(c._createCellCoords(t,e),c._createCellCoords(n,o),r.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,n,o){return r.getCopyableText(c._createCellCoords(t,e),c._createCellCoords(n,o))},this.getCopyableData=function(t,e){return r.getCopyable(t,r.colToProp(e))},this.getSchema=function(){return r.getSchema()},this.updateSettings=function(t){var e,n,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=(h?c.loadData:c.updateData).bind(this),s=!1;if(Zt(t.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Zt(t.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Zt(t.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(e in t)"data"===e||("language"===e?O(t.language):"className"===e?k("className",t.className):"tableClassName"===e&&c.table?(k("tableClassName",t.tableClassName),c.view._wt.wtOverlays.syncOverlayTableClassNames()):mr.getSingleton().isRegistered(e)||mr.getSingleton().isDeprecated(e)?(_n(t[e])||Array.isArray(t[e]))&&(t[e].initialHook=!0,c.addHook(e,t[e])):!o&&bt(t,e)&&(m[e]=t[e]));void 0===t.data&&void 0===v.data?l(null,"updateSettings"):void 0!==t.data?l(t.data,"updateSettings"):void 0!==t.columns&&(r.createMap(),c.initIndexMappers());var u=c.countCols(),f=v.columns;if(f&&_n(f)&&(s=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||y.clearCache(),u>0)for(e=0,n=0;e<u;e++){if(f){var d=s?f(e):f[n];d&&y.updateColumnMeta(n,d)}n+=1}Zt(t.cell)&&pt(t.cell,(function(t){c.setCellMetaObject(t.row,t.col,t)})),c.runHooks("afterCellMetaReset");var p=c.rootElement.style.height;""!==p&&(p=parseInt(c.rootElement.style.height,10));var g=t.height;if(_n(g)&&(g=g()),o){var b=c.rootElement.getAttribute("style");b&&c.rootElement.setAttribute("data-initialstyle",c.rootElement.getAttribute("style"))}if(null===g){var w=c.rootElement.getAttribute("data-initialstyle");w&&(w.indexOf("height")>-1||w.indexOf("overflow")>-1)?c.rootElement.setAttribute("style",w):(c.rootElement.style.height="",c.rootElement.style.overflow="")}else void 0!==g&&(c.rootElement.style.height=isNaN(g)?"".concat(g):"".concat(g,"px"),c.rootElement.style.overflow="hidden");if("undefined"!==typeof t.width){var S=t.width;_n(S)&&(S=S()),c.rootElement.style.width=isNaN(S)?"".concat(S):"".concat(S,"px")}o||(c.view&&(c.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),c.view._wt.exportSettingsAsClassNames()),c.runHooks("afterUpdateSettings",t)),i.adjustRowsAndCols(),c.view&&!h&&(c.forceFullRender=!0,a.lockEditor(),c._refreshBorders(null),c.view._wt.wtOverlays.adjustElementsSize(),a.unlockEditor()),o||!c.view||""!==p&&""!==g&&void 0!==g||p===g||c.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var t=c.getSelectedLast();if(v.getValue){if(_n(v.getValue))return v.getValue.call(c);if(t)return c.getData()[t[0][0]][v.getValue]}else if(t)return c.getDataAtCell(t[0],t[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,n,r,o){i.alter(t,e,n,r,o)},this.getCell=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e,o=t;if(e>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(e)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(e)}if(t>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(t)))return null;o=this.rowIndexMapper.getRenderableFromVisualIndex(t)}return null===o||null===r?null:c.view.getCellAtCoords(c._createCellCoords(o,r),n)},this.getCoords=function(t){var e=this.view._wt.wtTable.getCoords(t);if(null===e)return null;var n=e.row,r=e.col,o=n,i=r;return n>=0&&(o=this.rowIndexMapper.getVisualFromRenderableIndex(n)),r>=0&&(i=this.columnIndexMapper.getVisualFromRenderableIndex(r)),c._createCellCoords(o,i)},this.colToProp=function(t){return r.colToProp(t)},this.propToCol=function(t){return r.propToCol(t)},this.toVisualRow=function(t){return l.rowIndexMapper.getVisualFromPhysicalIndex(t)},this.toVisualColumn=function(t){return l.columnIndexMapper.getVisualFromPhysicalIndex(t)},this.toPhysicalRow=function(t){return l.rowIndexMapper.getPhysicalFromVisualIndex(t)},this.toPhysicalColumn=function(t){return l.columnIndexMapper.getPhysicalFromVisualIndex(t)},this.getDataAtCell=function(t,e){return r.get(t,r.colToProp(e))},this.getDataAtRowProp=function(t,e){return r.get(t,e)},this.getDataAtCol=function(t){for(var e=[],n=r.getRange(c._createCellCoords(0,t),c._createCellCoords(v.data.length-1,t),r.DESTINATION_RENDERER),o=0;o<n.length;o+=1)for(var i=0;i<n[o].length;i+=1)e.push(n[o][i]);return e},this.getDataAtProp=function(t){for(var e=[],n=r.getRange(c._createCellCoords(0,r.propToCol(t)),c._createCellCoords(v.data.length-1,r.propToCol(t)),r.DESTINATION_RENDERER),o=0;o<n.length;o+=1)for(var i=0;i<n[o].length;i+=1)e.push(n[o][i]);return e},this.getSourceData=function(t,e,n,r){var i;return i=void 0===t?o.getData():o.getByRange(c._createCellCoords(t,e),c._createCellCoords(n,r)),i},this.getSourceDataArray=function(t,e,n,r){var i;return i=void 0===t?o.getData(!0):o.getByRange(c._createCellCoords(t,e),c._createCellCoords(n,r),!0),i},this.getSourceDataAtCol=function(t){return o.getAtColumn(t)},this.setSourceDataAtCell=function(t,e,n,r){var i=j(t,e,n),a=this.hasHook("afterSetSourceDataAtCell"),l=[];a&&U(i,(function(t){var e=PT(t,3),n=e[0],r=e[1],i=e[2];l.push([n,r,o.getAtCell(n,r),i])})),U(i,(function(t){var e=PT(t,3),n=e[0],r=e[1],i=e[2];o.setAtCell(n,r,i)})),a&&this.runHooks("afterSetSourceDataAtCell",l,r),this.render();var s=c.getActiveEditor();s&&Zt(s.refreshValue)&&s.refreshValue()},this.getSourceDataAtRow=function(t){return o.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return o.getAtCell(t,e)},this.getDataAtRow=function(t){var e=r.getRange(c._createCellCoords(t,0),c._createCellCoords(t,this.countCols()-1),r.DESTINATION_RENDERER);return e[0]||[]},this.getDataType=function(t,e,n,r){var o=this,i=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,n,r],a=i[0],l=i[1],s=i[2],u=i[3],c=null,f=null;void 0===s&&(s=a),void 0===u&&(u=l);var h="mixed";return Ho(Math.max(Math.min(a,s),0),Math.max(a,s),(function(t){var e=!0;return Ho(Math.max(Math.min(l,u),0),Math.max(l,u),(function(n){var r=o.getCellMeta(t,n);return f=r.type,c?e=c===f:c=f,e})),h=e?f:"mixed",e})),h},this.removeCellMeta=function(t,e,n){var r=[this.toPhysicalRow(t),this.toPhysicalColumn(e)],o=r[0],i=r[1],a=y.getCellMetaKeyValue(o,i,n),l=c.runHooks("beforeRemoveCellMeta",t,e,n,a);!1!==l&&(y.removeCellMeta(o,i,n),c.runHooks("afterRemoveCellMeta",t,e,n,a)),a=null},this.spliceCellsMeta=function(t){for(var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];if(o.length>0&&!Array.isArray(o[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");n>0&&y.removeRow(this.toPhysicalRow(t),n),o.length>0&&U(o.reverse(),(function(n){y.createRow(e.toPhysicalRow(t)),U(n,(function(n,r){return e.setCellMetaObject(t,r,n)}))})),c.render()},this.setCellMetaObject=function(t,e,n){var r=this;"object"===ET(n)&&pt(n,(function(n,o){r.setCellMeta(t,e,o,n)}))},this.setCellMeta=function(t,e,n,r){var o=c.runHooks("beforeSetCellMeta",t,e,n,r);if(!1!==o){var i=t,a=e;t<this.countRows()&&(i=this.toPhysicalRow(t)),e<this.countCols()&&(a=this.toPhysicalColumn(e)),y.setCellMeta(i,a,n,r),c.runHooks("afterSetCellMeta",t,e,n,r)}},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(t,e){var n=this.toPhysicalRow(t),r=this.toPhysicalColumn(e);return null===n&&(n=t),null===r&&(r=e),y.getCellMeta(n,r,{visualRow:t,visualColumn:e})},this.getCellMetaAtRow=function(t){return y.getCellsMetaAtRow(t)},this.isColumnModificationAllowed=function(){return!("object"===c.dataType||v.columns)},this.getCellRenderer=function(t,e){var n="number"===typeof t?c.getCellMeta(t,e).renderer:t.renderer;return"string"===typeof n?Ki(n):te(n)?Ki("text"):n},this.getCellEditor=function(t,e){var n="number"===typeof t?c.getCellMeta(t,e).editor:t.editor;return"string"===typeof n?_r(n):te(n)?_r("text"):n},this.getCellValidator=function(t,e){var n="number"===typeof t?c.getCellMeta(t,e).validator:t.validator;return"string"===typeof n?ta(n):n},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,n){var r=new R;t&&(r.onQueueEmpty=t);var o=c.countRows()-1;while(o>=0)if(void 0===e||-1!==e.indexOf(o)){var i=c.countCols()-1;while(i>=0)void 0===n||-1!==n.indexOf(i)?(r.addValidatorToQueue(),c.validateCell(c.getDataAtCell(o,i),c.getCellMeta(o,i),(function(t){if("boolean"!==typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(r.valid=!1),r.removeValidatorFormQueue()}),"validateCells"),i-=1):i-=1;o-=1}else o-=1;r.checkIfQueueIsEmpty()},this.getRowHeader=function(t){var e=v.rowHeaders,n=t;return void 0!==n&&(n=c.runHooks("modifyRowHeader",n)),void 0===n?(e=[],Ho(c.countRows()-1,(function(t){e.push(c.getRowHeader(t))}))):Array.isArray(e)&&void 0!==e[n]?e=e[n]:_n(e)?e=e(n):e&&"string"!==typeof e&&"number"!==typeof e&&(e=n+1),e},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(void 0!==v.colHeaders&&null!==v.colHeaders)return!!v.colHeaders;for(var t=0,e=c.countCols();t<e;t++)if(c.getColHeader(t))return!0;return!1},this.getColHeader=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=c.runHooks("modifyColHeader",t);if(void 0===n){for(var r=[],o=c.countCols(),i=0;i<o;i++)r.push(c.getColHeader(i));return r}var a=v.colHeaders,l=function(t){for(var e=[],n=c.countCols(),r=0;r<n;r++)_n(v.columns)&&v.columns(r)&&e.push(r);return e[t]},s=c.toPhysicalColumn(n),u=l(s);return!1===v.colHeaders?a=null:v.columns&&_n(v.columns)&&v.columns(u)&&v.columns(u).title?a=v.columns(u).title:v.columns&&v.columns[s]&&v.columns[s].title?a=v.columns[s].title:Array.isArray(v.colHeaders)&&void 0!==v.colHeaders[s]?a=v.colHeaders[s]:_n(v.colHeaders)?a=v.colHeaders(s):v.colHeaders&&"string"!==typeof v.colHeaders&&"number"!==typeof v.colHeaders&&(a=_v(n)),a=c.runHooks("modifyColumnHeaderValue",a,t,e),a},this._getColWidthFromSettings=function(t){var e;if(t>=0){var n=c.getCellMeta(0,t);e=n.width}if(void 0!==e&&e!==v.width||(e=v.colWidths),void 0!==e&&null!==e){switch(ET(e)){case"object":e=e[t];break;case"function":e=e(t);break;default:break}"string"===typeof e&&(e=parseInt(e,10))}return e},this.getColWidth=function(t){var e=c._getColWidthFromSettings(t);return e=c.runHooks("modifyColWidth",e,t),void 0===e&&(e=my.DEFAULT_WIDTH),e},this._getRowHeightFromSettings=function(t){var e=v.rowHeights;if(void 0!==e&&null!==e){switch(ET(e)){case"object":e=e[t];break;case"function":e=e(t);break;default:break}"string"===typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t){var e=c._getRowHeightFromSettings(t);return e=c.runHooks("modifyRowHeight",e,t),e},this.countSourceRows=function(){return o.countRows()},this.countSourceCols=function(){return o.countFirstRowKeys()},this.countRows=function(){return r.getLength()},this.countCols=function(){var t=v.maxCols,e=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(t,e)},this.countRenderedRows=function(){return c.view._wt.drawn?c.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return c.view._wt.drawn?c.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return c.view._wt.drawn?c.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return c.view._wt.drawn?c.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return No(c.countRows()-1,(function(n){if(c.isEmptyRow(n))e+=1;else if(!0===t)return!1})),e},this.countEmptyCols=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return No(c.countCols()-1,(function(n){if(c.isEmptyCol(n))e+=1;else if(!0===t)return!1})),e},this.isEmptyRow=function(t){return v.isEmptyRow.call(c,t)},this.isEmptyCol=function(t){return v.isEmptyCol.call(c,t)},this.selectCell=function(t,e,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!te(t)&&!te(e)&&this.selectCells([[t,e,n,r]],o,i)},this.selectCells=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===e&&(u=!0);var r=S.selectCells(t);return r&&n&&c.listen(),u=!1,r},this.selectColumns=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return S.selectColumns(t,e)},this.selectRows=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return S.selectRows(t,e)},this.deselectCell=function(){S.deselect()},this.selectAll=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=t&&this.hasRowHeaders(),n=t&&this.hasColHeaders();u=!0,S.selectAll(e,n),u=!1};var A=function(t,e){return t.getNearestNotHiddenIndex(e,1,!0)};function I(t){return function(){throw new Error('The "'.concat(t,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.scrollViewportTo=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!n,a=!r,l=t,s=e;if(o){var u=Number.isInteger(t),f=Number.isInteger(e),h=u?A(this.rowIndexMapper,t):void 0,d=f?A(this.columnIndexMapper,e):void 0;if(null===h||null===d)return!1;l=u?c.rowIndexMapper.getRenderableFromVisualIndex(h):void 0,s=f?c.columnIndexMapper.getRenderableFromVisualIndex(d):void 0}var p=Number.isInteger(l),y=Number.isInteger(s);return p&&y?c.view.scrollViewport(c._createCellCoords(l,s),i,r,n,a):p&&!1===y?c.view.scrollViewportVertically(l,i,n):!(!y||!1!==p)&&c.view.scrollViewportHorizontally(s,r,a)},this.destroy=function(){if(c._clearTimeouts(),c._clearImmediates(),c.view&&c.view.destroy(),o&&o.destroy(),o=null,this.getShortcutManager().destroy(),y.clearCache(),ev(c)){var t=this.rootDocument.querySelector(".hot-display-license-info");t&&t.parentNode.removeChild(t)}Xe(c.rootElement),f.destroy(),a&&a.destroy(),c.batchExecution((function(){c.rowIndexMapper.unregisterAll(),c.columnIndexMapper.unregisterAll(),g.getItems().forEach((function(t){var e=PT(t,2),n=e[1];n.destroy()})),g.clear(),c.runHooks("afterDestroy")}),!0),mr.getSingleton().destroy(c),pt(c,(function(t,e,n){_n(t)?n[e]=I(e):"guid"!==e&&(n[e]=null)})),c.isDestroyed=!0,r&&r.destroy(),r=null,i=null,S=null,a=null,c=null},this.getActiveEditor=function(){return a.getActiveEditor()},this.getPlugin=function(t){var e=be(t);return"UndoRedo"===e?this.undoRedo:g.getItem(e)},this.getPluginName=function(t){return t===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:g.getId(t)},this.getInstance=function(){return c},this.addHook=function(t,e){mr.getSingleton().add(t,e,c)},this.hasHook=function(t){return mr.getSingleton().has(t,c)||mr.getSingleton().has(t)},this.addHookOnce=function(t,e){mr.getSingleton().once(t,e,c)},this.removeHook=function(t,e){mr.getSingleton().remove(t,e,c)},this.runHooks=function(t,e,n,r,o,i,a){return mr.getSingleton().run(c,t,e,n,r,o,i,a)},this.getTranslatedPhrase=function(t,e){return SC(v.language,t,e)},this.toHTML=function(){return Oo(l)},this.toTableElement=function(){var t=l.rootDocument.createElement("div");return t.insertAdjacentHTML("afterbegin",Oo(l)),t.firstElementChild},this.timeouts=[],this._registerTimeout=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t;"function"===typeof n&&(n=setTimeout(n,e)),this.timeouts.push(n)},this._clearTimeouts=function(){U(this.timeouts,(function(t){clearTimeout(t)}))},this.immediates=[],this._registerImmediate=function(t){this.immediates.push(setImmediate(t))},this._clearImmediates=function(){U(this.immediates,(function(t){clearImmediate(t)}))},this._refreshBorders=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];a.destroyEditor(t),c.view.render(),e&&S.isSelected()&&a.prepareEditor()},this.isRtl=function(){return"rtl"===c.rootWindow.getComputedStyle(c.rootElement).direction},this.isLtr=function(){return!c.isRtl()},this.getDirectionFactor=function(){return c.isLtr()?1:-1};var x=RT({handleEvent:function(t){var e=c.isListening(),n=void 0!==(null===t||void 0===t?void 0:t.key);return e&&n},beforeKeyDown:function(t){return l.runHooks("beforeKeyDown",t)},afterKeyDown:function(t){l.isDestroyed||c.runHooks("afterDocumentKeyDown",t)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",(function(t){!1===t.ctrlKey&&!1===t.metaKey&&x.releasePressedKeys()})),this.getShortcutManager=function(){return x};var _=x.addContext("grid"),H={runOnlyIf:function(){return Zt(c.getSelected())&&c.countRenderedRows()>0&&c.countRenderedCols()>0},group:DT};x.setActiveContextName("grid"),_.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){c.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var t=c.getSelectedRange(),e=t[t.length-1].highlight,n=e.row,r=e.col,o=c.getDataAtCell(n,r),i=new Map,a=0;a<t.length;a++)t[a].forAll((function(t,e){if(t>=0&&e>=0&&(t!==n||e!==r)){var a=c.getCellMeta(t,e),l=a.readOnly;l||i.set("".concat(t,"x").concat(e),[t,e,o])}}));c.setDataAtCell(Array.from(i.values()))},runOnlyIf:function(){return c.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){S.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){S.setRangeStart(c._createCellCoords(c.rowIndexMapper.getNearestNotHiddenIndex(0,1),c.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){S.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var t=c.getSelectedRangeLast(),e=t.from,n=t.to,r=c.rowIndexMapper.getNearestNotHiddenIndex(0,1);S.setRangeStart(e.clone()),S.setRangeEnd(c._createCellCoords(r,n.col))},runOnlyIf:function(){return!(c.selection.isSelectedByCorner()||c.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){S.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){S.setRangeStart(c._createCellCoords(c.rowIndexMapper.getNearestNotHiddenIndex(c.countRows()-1,-1),c.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){S.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var t=c.getSelectedRangeLast(),e=t.from,n=t.to,r=c.rowIndexMapper.getNearestNotHiddenIndex(c.countRows()-1,-1);S.setRangeStart(e.clone()),S.setRangeEnd(c._createCellCoords(r,n.col))},runOnlyIf:function(){return!(c.selection.isSelectedByCorner()||c.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){S.transformStart(0,-1*c.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var t,e=c.getSelectedRangeLast().highlight.row,n=(t=c.columnIndexMapper).getNearestNotHiddenIndex.apply(t,AT(c.isRtl()?[c.countCols()-1,-1]:[0,1]));S.setRangeStart(c._createCellCoords(e,n))}},{keys:[["ArrowLeft","Shift"]],callback:function(){S.transformEnd(0,-1*c.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var t,e=c.getSelectedRangeLast(),n=e.from,r=e.to,o=(t=c.columnIndexMapper).getNearestNotHiddenIndex.apply(t,AT(c.isRtl()?[c.countCols()-1,-1]:[0,1]));S.setRangeStart(n.clone()),S.setRangeEnd(c._createCellCoords(r.row,o))},runOnlyIf:function(){return!(c.selection.isSelectedByCorner()||c.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){S.transformStart(0,c.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var t,e=c.getSelectedRangeLast().highlight.row,n=(t=c.columnIndexMapper).getNearestNotHiddenIndex.apply(t,AT(c.isRtl()?[0,1]:[c.countCols()-1,-1]));S.setRangeStart(c._createCellCoords(e,n))}},{keys:[["ArrowRight","Shift"]],callback:function(){S.transformEnd(0,c.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var t,e=c.getSelectedRangeLast(),n=e.from,r=e.to,o=(t=c.columnIndexMapper).getNearestNotHiddenIndex.apply(t,AT(c.isRtl()?[0,1]:[c.countCols()-1,-1]));S.setRangeStart(n.clone()),S.setRangeEnd(c._createCellCoords(r.row,o))},runOnlyIf:function(){return!(c.selection.isSelectedByCorner()||c.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var t=parseInt(c.getSettings().fixedColumnsStart,10),e=c.getSelectedRangeLast().highlight.row,n=c.columnIndexMapper.getNearestNotHiddenIndex(t,1);S.setRangeStart(c._createCellCoords(e,n))},runOnlyIf:function(){return c.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){S.setRangeEnd(c._createCellCoords(S.selectedRange.current().from.row,c.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var t=parseInt(c.getSettings().fixedRowsTop,10),e=parseInt(c.getSettings().fixedColumnsStart,10),n=c.rowIndexMapper.getNearestNotHiddenIndex(t,1),r=c.columnIndexMapper.getNearestNotHiddenIndex(e,1);S.setRangeStart(c._createCellCoords(n,r))},runOnlyIf:function(){return c.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){S.setRangeStart(c._createCellCoords(c.getSelectedRangeLast().highlight.row,c.columnIndexMapper.getNearestNotHiddenIndex(c.countCols()-1,-1)))},runOnlyIf:function(){return c.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){S.setRangeEnd(c._createCellCoords(S.selectedRange.current().from.row,c.columnIndexMapper.getNearestNotHiddenIndex(c.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var t=parseInt(c.getSettings().fixedRowsBottom,10),e=c.rowIndexMapper.getNearestNotHiddenIndex(c.countRows()-t-1,-1),n=c.columnIndexMapper.getNearestNotHiddenIndex(c.countCols()-1,-1);S.setRangeStart(c._createCellCoords(e,n))},runOnlyIf:function(){return c.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){S.transformStart(-c.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var t=c.getSelectedRangeLast(),e=t.to,n=Math.max(e.row-c.countVisibleRows(),0),r=c.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(null!==r){var o=c._createCellCoords(r,e.col),i=e.row-c.view.getFirstFullyVisibleRow(),a=Math.max(o.row-i,0);S.setRangeEnd(o),c.scrollViewportTo(a)}}},{keys:[["PageDown"]],callback:function(){S.transformStart(c.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var t=c.getSelectedRangeLast(),e=t.to,n=Math.min(e.row+c.countVisibleRows(),c.countRows()-1),r=c.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(null!==r){var o=c._createCellCoords(r,e.col),i=e.row-c.view.getFirstFullyVisibleRow(),a=Math.min(o.row-i,c.countRows()-1);S.setRangeEnd(o),c.scrollViewportTo(a)}}},{keys:[["Tab"]],callback:function(t){var e="function"===typeof v.tabMoves?v.tabMoves(t):v.tabMoves;S.transformStart(e.row,e.col,!0)}},{keys:[["Shift","Tab"]],callback:function(t){var e="function"===typeof v.tabMoves?v.tabMoves(t):v.tabMoves;S.transformStart(-e.row,-e.col)}}],H),Ni().forEach((function(t){var e=Di(t);g.addItem(t,new e(l))})),mr.getSingleton().run(c,"construct")}var VT="hooksRefRegisterer",FT={_hooksStorage:Object.create(null),addHook:function(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey:function(t){var e=this;U(this._hooksStorage[t]||[],(function(n){e.hot.removeHook(t,n)}))},clearHooks:function(){var t=this;pt(this._hooksStorage,(function(e,n){return t.removeHooksByKey(n)})),this._hooksStorage={}}};dt(FT,"MIXIN_NAME",VT,{writable:!1,enumerable:!1});var WT=FT;function UT(t){return UT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},UT(t)}function zT(t,e){return $T(t)||XT(t,e)||YT(t,e)||GT()}function GT(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function YT(t,e){if(t){if("string"===typeof t)return KT(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?KT(t,e):void 0}}function KT(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function XT(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function $T(t){if(Array.isArray(t))return t}function qT(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&QT(t,e)}function QT(t,e){return QT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},QT(t,e)}function JT(t){var e=ej();return function(){var n,r=nj(t);if(e){var o=nj(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ZT(this,n)}}function ZT(t,e){if(e&&("object"===UT(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return tj(t)}function tj(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ej(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function nj(t){return nj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},nj(t)}function rj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oj(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,aj(r.key),r)}}function ij(t,e,n){return e&&oj(t.prototype,e),n&&oj(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function aj(t){var e=lj(t,"string");return"symbol"===UT(e)?e:String(e)}function lj(t,e){if("object"!==UT(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==UT(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var sj="base",uj=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),cj="baseEditor",fj=function(){function t(e){rj(this,t),this.hot=e,this.instance=e,this.state=uj.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return ij(t,[{key:"_fireCallbacks",value:function(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(t,e,n,r,o,i){this.TD=r,this.row=t,this.col=e,this.prop=n,this.originalValue=o,this.cellProperties=i,this.state=uj.VIRGIN}},{key:"extend",value:function(){return function(t){qT(n,t);var e=JT(n);function n(){return rj(this,n),e.apply(this,arguments)}return ij(n)}(this.constructor)}},{key:"saveValue",value:function(t,e){var n,r,o,i,a=this;if(e){var l=this.hot.getSelectedLast();n=Math.max(Math.min(l[0],l[2]),0),r=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),i=Math.max(l[1],l[3])}else{var s=[this.row,this.col,null,null];n=s[0],r=s[1],o=s[2],i=s[3]}var u=this.hot.runHooks("modifyGetCellCoords",n,r);if(Array.isArray(u)){var c=zT(u,2);n=c[0],r=c[1]}var f=this.hot.getShortcutManager(),h=f.getContext("editor"),d={runOnlyIf:function(){return Zt(a.hot.getSelected())},group:cj};this.isInFullEditMode()&&h.addShortcuts([{keys:[["ArrowUp"]],callback:function(){a.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){a.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){a.hot.selection.transformStart(0,-1*a.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){a.hot.selection.transformStart(0,a.hot.getDirectionFactor())}}],d),this.hot.populateFromArray(n,r,t,o,i,"edit")}},{key:"beginEditing",value:function(t,e){if(this.state===uj.VIRGIN){var n=this.hot,r=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(r,o)),this.state=uj.EDITING,this.isInFullEditMode()){var i="string"===typeof t?t:Jt(this.originalValue);this.setValue(i)}this.open(e),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(t,e,n){var r,o=this;if(n){var i=this._closeCallback;this._closeCallback=function(t){i&&i(t),n(t),o.hot.view.render()}}if(!this.isWaiting()){var a=this.hot.getShortcutManager(),l=a.getContext("editor");if(l.removeShortcutsByGroup(cj),l.removeShortcutsByGroup(so),this.state!==uj.VIRGIN){if(this.state===uj.EDITING){if(t)return this.cancelChanges(),void this.hot.view.render();var s=this.getValue();r=this.cellProperties.trimWhitespace?[["string"===typeof s?String.prototype.trim.call(s||""):s]]:[[s]],this.state=uj.WAITING,this.saveValue(r,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(function(t){o.state=uj.FINISHED,o.discardEditor(t)})):(this.state=uj.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((function(){o._fireCallbacks(!0)}))}}},{key:"cancelChanges",value:function(){this.state=uj.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(t){if(this.state===uj.FINISHED)if(!1===t&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=uj.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=uj.VIRGIN,this._fireCallbacks(!0);var e=this.hot.getShortcutManager();e.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===uj.WAITING}},{key:"getEditedCellRect",value:function(){var t,e=this.getEditedCell();if(e){var n=this.hot.view._wt,r=n.wtOverlays,o=n.wtViewport,i=this.hot.rootWindow,a=tn(e),l=fn(e),s=tn(this.hot.rootElement),u=fn(this.hot.rootElement),c=r.topOverlay.holder,f=r.inlineStartOverlay.holder,h=c!==i?c.scrollTop:0,d=f!==i?f.scrollLeft:0,p=i.innerWidth-s.left-u,y=null!==(t=r.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt,v=y.wtTable,m=v.name,g=["master","inline_start"].includes(m)?h:0,b=["master","top","bottom"].includes(m)?d:0,w=a.top===s.top?0:1,S=a.top-s.top-w-g,C=0;C=this.hot.isRtl()?i.innerWidth-a.left-l-p-1+b:a.left-s.left-1-b,["top","top_inline_start_corner"].includes(m)&&(S+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(C+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));var O=this.hot.hasColHeaders(),k=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),R=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),E=this.hot.rowIndexMapper.getRenderableIndexesLength(),P=E-this.hot.view._wt.getSetting("fixedRowsBottom");(O&&k<=0||k===P)&&(S+=1),R<=0&&(C+=1);var T=o.rowsRenderCalculator.startPosition,j=o.columnsRenderCalculator.startPosition,M=Math.abs(r.inlineStartOverlay.getScrollPosition()),A=r.topOverlay.getScrollPosition(),I=On(this.hot.rootDocument),x=e.offsetTop+T-A,_=0;if(this.hot.isRtl()){var H=e.offsetLeft;_=H>=0?v.getWidth()-e.offsetLeft:Math.abs(H),_+=j-M-l}else _=e.offsetLeft+j-M;var N=cn(this.TD,this.hot.rootWindow),D=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",L=parseInt(N[D],10)>0?0:1,B=parseInt(N.borderTopWidth,10)>0?0:1,V=fn(e)+L,F=hn(e)+B,W=kn(c)?I:0,U=Rn(f)?I:0,z=this.hot.view.maximumVisibleElementWidth(_)-W+L,G=Math.max(this.hot.view.maximumVisibleElementHeight(x)-U+B,23);return{top:S,start:C,height:F,maxHeight:G,width:V,maxWidth:z}}}},{key:"getEditedCellsLayerClass",value:function(){var t=this.checkEditorSection();switch(t){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var t=this.hot.countRows(),e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}],[{key:"EDITOR_TYPE",get:function(){return sj}}]),t}();function hj(){var t,e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=document.body,r=document.createTextNode(""),o=document.createElement("SPAN"),i=function(t,e,n){t.addEventListener(e,n,!1)},a=function(t,e,n){t.removeEventListener(e,n,!1)},l=function(i){var a,l;i?/^[a-zA-Z \.,\\\/\|0-9]$/.test(i)||(i="."):i="",void 0!==r.textContent?r.textContent=t.value+i:r.data=t.value+i,o.style.position="absolute",o.style.fontSize=f(t).fontSize,o.style.fontFamily=f(t).fontFamily,o.style.whiteSpace="pre",n.appendChild(o),a=o.clientWidth+2,n.removeChild(o),t.style.height=e.minHeight+"px",e.minWidth>a?t.style.width=e.minWidth+"px":a>e.maxWidth?t.style.width=e.maxWidth+"px":t.style.width=a+"px",l=t.scrollHeight?t.scrollHeight-1:0,e.minHeight>l?t.style.height=e.minHeight+"px":e.maxHeight<l?(t.style.height=e.maxHeight+"px",t.style.overflowY="visible"):t.style.height=l+"px"},s=function(){window.setTimeout(l,0)},u=function(n){if(n&&n.minHeight)if("inherit"==n.minHeight)e.minHeight=t.clientHeight;else{var i=parseInt(n.minHeight);isNaN(i)||(e.minHeight=i)}if(n&&n.maxHeight)if("inherit"==n.maxHeight)e.maxHeight=t.clientHeight;else{var a=parseInt(n.maxHeight);isNaN(a)||(e.maxHeight=a)}if(n&&n.minWidth)if("inherit"==n.minWidth)e.minWidth=t.clientWidth;else{var l=parseInt(n.minWidth);isNaN(l)||(e.minWidth=l)}if(n&&n.maxWidth)if("inherit"==n.maxWidth)e.maxWidth=t.clientWidth;else{var s=parseInt(n.maxWidth);isNaN(s)||(e.maxWidth=s)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))},c=function(n,r,o){t=n,u(r),"TEXTAREA"==t.nodeName&&(t.style.resize="none",t.style.overflowY="",t.style.height=e.minHeight+"px",t.style.minWidth=e.minWidth+"px",t.style.maxWidth=e.maxWidth+"px",t.style.overflowY="hidden"),o&&(i(t,"change",l),i(t,"cut",s),i(t,"paste",s),i(t,"drop",s),i(t,"keydown",s),i(t,"focus",l),i(t,"compositionstart",s),i(t,"compositionupdate",s),i(t,"compositionend",s)),l()};function f(t){return t.currentStyle||document.defaultView.getComputedStyle(t)}return{init:function(t,e,n){c(t,e,n)},unObserve:function(){a(t,"change",l),a(t,"cut",s),a(t,"paste",s),a(t,"drop",s),a(t,"keydown",s),a(t,"focus",l),a(t,"compositionstart",s),a(t,"compositionupdate",s),a(t,"compositionend",s)},resize:l}}function dj(t,e){for(var n=mn(e),r=e.value.split("\n"),o=n,i=0,a=0;a<r.length;a++){var l=r[a];0!==a&&(i+=r[a-1].length+1);var s=i+l.length;if("home"===t?o=i:"end"===t&&(o=s),n<=s)break}Sn(e,o)}function pj(t){return pj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pj(t)}function yj(t,e){return wj(t)||bj(t,e)||mj(t,e)||vj()}function vj(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function mj(t,e){if(t){if("string"===typeof t)return gj(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gj(t,e):void 0}}function gj(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function bj(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function wj(t){if(Array.isArray(t))return t}function Sj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cj(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kj(r.key),r)}}function Oj(t,e,n){return e&&Cj(t.prototype,e),n&&Cj(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function kj(t){var e=Rj(t,"string");return"symbol"===pj(e)?e:String(e)}function Rj(t,e){if("object"!==pj(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==pj(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ej(){return Ej="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Pj(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ej.apply(this,arguments)}function Pj(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=_j(t),null===t)break;return t}function Tj(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jj(t,e)}function jj(t,e){return jj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},jj(t,e)}function Mj(t){var e=xj();return function(){var n,r=_j(t);if(e){var o=_j(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Aj(this,n)}}function Aj(t,e){if(e&&("object"===pj(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ij(t)}function Ij(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xj(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function _j(t){return _j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_j(t)}ct(fj,WT);var Hj="ht_editor_visible",Nj="ht_editor_hidden",Dj="textEditor",Lj="text",Bj=function(t){Tj(n,t);var e=Mj(n);function n(t){var r;return Sj(this,n),r=e.call(this,t),r.eventManager=new Gr(Ij(r)),r.autoResize=hj(),r.TEXTAREA=void 0,r.textareaStyle=void 0,r.TEXTAREA_PARENT=void 0,r.textareaParentStyle=void 0,r.layerClass=void 0,r.createElements(),r.bindEvents(),r.hot.addHookOnce("afterDestroy",(function(){return r.destroy()})),r}return Oj(n,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(t){this.TEXTAREA.value=t}},{key:"open",value:function(){var t=this;this.refreshDimensions(),this.showEditableElement();var e=this.hot.getShortcutManager();e.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",(function(e){return t.onAfterDocumentKeyDown(e)})),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(t,e,r,o,i,a){var l=this.state;if(Ej(_j(n.prototype),"prepare",this).call(this,t,e,r,o,i,a),!a.readOnly){this.refreshDimensions(!0);var s=a.allowInvalid,u=a.fragmentSelection;s&&(this.TEXTAREA.value=""),l!==uj.FINISHED&&this.hideEditableElement();var c=!u;c&&!Ht()&&this.focus()}}},{key:"beginEditing",value:function(t,e){this.state===uj.VIRGIN&&(this.TEXTAREA.value="",Ej(_j(n.prototype),"beginEditing",this).call(this,t,e))}},{key:"focus",value:function(){this.TEXTAREA.select(),Sn(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var t=this.hot.rootDocument;this.TEXTAREA=t.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Ge(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),Ge(this.TEXTAREA_PARENT,"handsontableInputHolder"),ze(this.TEXTAREA_PARENT,this.layerClass)&&Ye(this.TEXTAREA_PARENT,this.layerClass),Ge(this.TEXTAREA_PARENT,Nj),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(It()||Mt())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ye(this.TEXTAREA_PARENT,this.layerClass),Ge(this.TEXTAREA_PARENT,Nj)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var t=this.TEXTAREA_PARENT.childNodes,e=!1;Ho(t.length-1,(function(n){var r=t[n];if(ze(r,"handsontableEditor"))return e=!0,!1})),ze(this.TEXTAREA_PARENT,Nj)&&Ye(this.TEXTAREA_PARENT,Nj),e?(this.layerClass=Hj,Ge(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Ge(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===uj.EDITING||t)if(this.TD=this.getEditedCell(),this.TD){var e=this.getEditedCellRect(),n=e.top,r=e.start,o=e.width,i=e.maxWidth,a=e.height,l=e.maxHeight;this.textareaParentStyle.top="".concat(n,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(r,"px"),this.showEditableElement();var s=cn(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=s.fontSize,this.TEXTAREA.style.fontFamily=s.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var u=cn(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),f=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),h=o-c,d=a-f,p=i-c,y=l-f;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(h,p),minHeight:Math.min(d,y),maxWidth:p,maxHeight:y},!0)}else t||this.close()}},{key:"bindEvents",value:function(){var t=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",(function(t){return t.stopPropagation()})),this.eventManager.addEventListener(this.TEXTAREA,"paste",(function(t){return t.stopPropagation()})),Nt()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(function(){return t.finishEditing(!1)})),this.addHook("afterScrollHorizontally",(function(){return t.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return t.refreshDimensions()})),this.addHook("afterColumnResize",(function(){t.refreshDimensions(),t.focus()})),this.addHook("afterRowResize",(function(){t.refreshDimensions(),t.focus()}))}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var t=this,e=this.hot.getShortcutManager(),n=e.getContext("editor"),r={runOnlyIf:function(){return Zt(t.hot.getSelected())},group:Dj},o=function(){t.hot.rootDocument.execCommand("insertText",!1,"\n")};n.addShortcuts([{keys:[["Tab"]],callback:function(e){var n=t.hot.getSettings(),r="function"===typeof n.tabMoves?n.tabMoves(e):n.tabMoves;t.hot.selection.transformStart(r.row,r.col,!0)}},{keys:[["Shift","Tab"]],callback:function(e){var n=t.hot.getSettings(),r="function"===typeof n.tabMoves?n.tabMoves(e):n.tabMoves;t.hot.selection.transformStart(-r.row,-r.col)}},{keys:[["Control","Enter"]],callback:function(){return o(),!1},runOnlyIf:function(e){return!t.hot.selection.isMultiple()&&!e.altKey},relativeToGroup:uo,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return o(),!1},runOnlyIf:function(){return!t.hot.selection.isMultiple()},relativeToGroup:uo,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return o(),!1},relativeToGroup:uo,position:"before"},{keys:[["PageUp"]],callback:function(){t.hot.selection.transformStart(-t.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){t.hot.selection.transformStart(t.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(e,n){var r=yj(n,1),o=r[0];dj(o,t.TEXTAREA)}},{keys:[["End"]],callback:function(e,n){var r=yj(n,1),o=r[0];dj(o,t.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){t.hot._registerTimeout((function(){t.autoResize.resize()}),10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){t.hot._registerTimeout((function(){t.autoResize.resize()}),10)}}],r)}},{key:"unregisterShortcuts",value:function(){var t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(so),e.removeShortcutsByGroup(Dj),e.removeShortcutsByGroup(cj)}},{key:"onAfterDocumentKeyDown",value:function(t){var e=[zn.ARROW_UP,zn.ARROW_RIGHT,zn.ARROW_DOWN,zn.ARROW_LEFT];-1===e.indexOf(t.keyCode)&&this.autoResize.resize(String.fromCharCode(t.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return Lj}}]),n}(fj),Vj="base";function Fj(t,e,n,r,o,i,a){var l=[],s=[];a.className&&Ge(e,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),!1===a.valid&&a.invalidCellClassName?l.push(a.invalidCellClassName):s.push(a.invalidCellClassName),!1===a.wordWrap&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!i&&a.placeholder&&l.push(a.placeholderCellClassName),Ye(e,s),Ge(e,l)}Fj.RENDERER_TYPE=Vj;var Wj="text";function Uj(t,e,n,r,o,i,a){Fj.apply(this,[t,e,n,r,o,i,a]);var l=i;if(!l&&a.placeholder&&(l=a.placeholder),l=Jt(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){Xe(e);var s=t.rootDocument.createElement("TEMPLATE");s.setAttribute("bind","{{}}"),s.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=t.getSourceDataAtRow(n),e.appendChild(s)}else Je(e,l)}Uj.RENDERER_TYPE=Wj;var zj="text",Gj={CELL_TYPE:zj,editor:Bj,renderer:Uj};function Yj(t,e){var n=new BT(t,e||{},Jy);return n.init(),n}uE(Gj),Yj.editors={BaseEditor:fj},Yj.Core=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new BT(t,e,Jy)},Yj.DefaultSettings=mE(),Yj.hooks=mr.getSingleton(),Yj.CellCoords=Nc,Yj.CellRange=Zc,Yj.packageName="handsontable",Yj.buildDate="22/06/2023 11:55:10",Yj.version="13.0.0",Yj.languages={dictionaryKeys:v,getLanguageDictionary:gC,getLanguagesDictionaries:wC,registerLanguageDictionary:vC,getTranslatedPhrase:SC};var Kj=Yj,Xj=n(1711);function $j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function qj(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$j(Object(n),!0).forEach((function(e){eM(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$j(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Qj(t){return Qj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qj(t)}function Jj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zj(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,cM(r.key),r)}}function tM(t,e,n){return e&&Zj(t.prototype,e),n&&Zj(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function eM(t,e,n){return e=cM(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nM(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oM(t,e)}function rM(t){return rM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},rM(t)}function oM(t,e){return oM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},oM(t,e)}function iM(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function aM(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lM(t,e){if(e&&("object"===typeof e||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return aM(t)}function sM(t){var e=iM();return function(){var n,r=rM(t);if(e){var o=rM(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lM(this,n)}}function uM(t,e){if("object"!==typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function cM(t){var e=uM(t,"string");return"symbol"===typeof e?e:String(e)}var fM=Symbol("unassigned"),hM=null,dM="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function pM(t){t.hotInstance&&(t.hotInstance.addHook("beforeChange",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeCreateCol",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveRow",(function(){t.__internalEdit=!0})),t.hotInstance.addHook("beforeRemoveCol",(function(){t.__internalEdit=!0})))}function yM(t){var e=Kj.hooks.getRegistered(),n={};for(var r in Object.assign(n,Kj.DefaultSettings),n)n[r]={default:fM};for(var o=0;o<e.length;o++)n[e[o]]={default:fM};return n.settings={default:fM},"HotTable"===t&&(n.id={type:String,default:"hot-"+Math.random().toString(36).substring(5)},n.wrapperRendererCacheSize={type:Number,default:3e3}),n}function vM(t){var e={},n=t["settings"];if(n!==fM)for(var r in n)n.hasOwnProperty(r)&&n[r]!==fM&&(e[r]=n[r]);for(var o in t)t.hasOwnProperty(o)&&"settings"!==o&&t[o]!==fM&&(e[o]=t[o]);return e}function mM(t,e){var n=vM(t),r=t.settings?t.settings:n,o=t.settings?n:null,i={};for(var a in r)!r.hasOwnProperty(a)||void 0===r[a]||e&&"data"!==a&&SM(e[a],r[a])||(i[a]=r[a]);for(var l in o)!o.hasOwnProperty(l)||"id"===l||"settings"===l||"wrapperRendererCacheSize"===l||void 0===o[l]||e&&"data"!==l&&SM(e[l],o[l])||(i[l]=o[l]);return i}function gM(t,e){var n=null;return t.every((function(t,r){return!t.data||!t.data.attrs||void 0===t.data.attrs[e]||(n=t,!1)})),n}function bM(t){return t.filter((function(t){return"HotColumn"===t.$options.name}))}function wM(t,e,n,r){var o=e.$el?e.$el.ownerDocument:document,i={propsData:n,parent:e,data:r};hM||(hM=o.createElement("DIV"),hM.id="vueHotComponents",o.body.appendChild(hM));var a=o.createElement("DIV");return hM.appendChild(a),new t.componentOptions.Ctor(i).$mount(a)}function SM(t,e){return JSON.stringify(t)===JSON.stringify(e)}var CM="13.0.0";"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self&&self;function OM(t,e){return e={exports:{}},t(e,e.exports),e.exports}var kM=OM((function(t,e){(function(t,n){var r=e;n(r)})(0,(function(t){var e=Symbol("newer"),n=Symbol("older");function r(t,e){"number"!==typeof t&&(e=t,t=0),this.size=0,this.limit=t,this.oldest=this.newest=void 0,this._keymap=new Map,e&&(this.assign(e),t<1&&(this.limit=this.size))}function o(t,r){this.key=t,this.value=r,this[e]=void 0,this[n]=void 0}t.LRUMap=r,r.prototype._markEntryAsUsed=function(t){t!==this.newest&&(t[e]&&(t===this.oldest&&(this.oldest=t[e]),t[e][n]=t[n]),t[n]&&(t[n][e]=t[e]),t[e]=void 0,t[n]=this.newest,this.newest&&(this.newest[e]=t),this.newest=t)},r.prototype.assign=function(t){var r,i=this.limit||Number.MAX_VALUE;this._keymap.clear();for(var a=t[Symbol.iterator](),l=a.next();!l.done;l=a.next()){var s=new o(l.value[0],l.value[1]);if(this._keymap.set(s.key,s),r?(r[e]=s,s[n]=r):this.oldest=s,r=s,0==i--)throw new Error("overflow")}this.newest=r,this.size=this._keymap.size},r.prototype.get=function(t){var e=this._keymap.get(t);if(e)return this._markEntryAsUsed(e),e.value},r.prototype.set=function(t,r){var i=this._keymap.get(t);return i?(i.value=r,this._markEntryAsUsed(i),this):(this._keymap.set(t,i=new o(t,r)),this.newest?(this.newest[e]=i,i[n]=this.newest):this.oldest=i,this.newest=i,++this.size,this.size>this.limit&&this.shift(),this)},r.prototype.shift=function(){var t=this.oldest;if(t)return this.oldest[e]?(this.oldest=this.oldest[e],this.oldest[n]=void 0):(this.oldest=void 0,this.newest=void 0),t[e]=t[n]=void 0,this._keymap["delete"](t.key),--this.size,[t.key,t.value]},r.prototype.has=function(t){return this._keymap.has(t)}}))})),RM=kM.LRUMap,EM={name:"HotTable",props:yM("HotTable"),watch:{mergedHotSettings:function(t){this.hotInstance&&void 0!==t&&(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())}},data:function(){var t=this,e=new RM(this.wrapperRendererCacheSize);return e.shift=function(){var t=RM.prototype.shift.call(this);return t[1].component.$destroy(),t},{__internalEdit:!1,miscCache:{currentSourceColumns:null},__hotInstance:null,columnSettings:null,rendererCache:e,editorCache:new Map,get hotInstance(){return!t.__hotInstance||t.__hotInstance&&!t.__hotInstance.isDestroyed?t.__hotInstance:(console.warn(dM),null)},set hotInstance(e){t.__hotInstance=e}}},computed:{mergedHotSettings:function(){return mM(this.$props,this.hotInstance?this.hotInstance.getSettings():void 0)}},methods:{hotInit:function(){var t=this.getGlobalRendererVNode(),e=this.getGlobalEditorVNode(),n=mM(this.$props);n.columns=this.columnSettings?this.columnSettings:n.columns,e&&(n.editor=this.getEditorClass(e,this),e.child.$destroy()),t&&(n.renderer=this.getRendererWrapper(t,this),t.child.$destroy()),this.hotInstance=new Kj.Core(this.$el,n),this.hotInstance.init(),pM(this),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var t=this;if(this.hotInstance){var e,n=this.hotInstance.getSourceData(),r=[],o=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),a=this.hotInstance.isColumnModificationAllowed(),l=0;if(n&&n.length!==i&&n.length<i)for(var s=n.length;s<i;s++)r.push(s);if(a)if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),n&&n[0]&&(null===(e=n[0])||void 0===e?void 0:e.length)!==l&&n[0].length<l)for(var u=n[0].length;u<l;u++)o.push(u);this.hotInstance.batch((function(){r.length>0?t.hotInstance.rowIndexMapper.removeIndexes(r):t.hotInstance.rowIndexMapper.insertIndexes(i-1,n.length-i),a&&0!==n.length&&(o.length>0?t.hotInstance.columnIndexMapper.removeIndexes(o):t.hotInstance.columnIndexMapper.insertIndexes(l-1,n[0].length-l))}))}},getGlobalRendererVNode:function(){var t=this.$slots["default"]||[];return gM(t,"hot-renderer")},getGlobalEditorVNode:function(){var t=this.$slots["default"]||[];return gM(t,"hot-editor")},getColumnSettings:function(){var t=bM(this.$children),e=!1,n=t.map((function(t){return t.usesRendererComponent&&(e=!0),qj({},t.columnSettings)}));return e&&this.settings&&(!1!==this.settings.autoColumnSize||this.settings.autoRowSize)&&(!1!==this.autoColumnSize||this.autoRowSize)&&console.warn("Your `hot-table` configuration includes both `hot-column` and `autoRowSize`/`autoColumnSize`, which are not compatible with each other in this version of `@handsontable/vue`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment."),n.length?n:void 0},getRendererWrapper:function(t,e){var n=this;return function(r,o,i,a,l,s,u){if(o&&!o.getAttribute("ghost-table")){var c=n.rendererCache,f={hotInstance:r,TD:o,row:i,col:a,prop:l,value:s,cellProperties:u,isRenderer:!0};if(c&&!c.has("".concat(i,"-").concat(a))){var h=wM(t,e,t.componentOptions.propsData,f);c.set("".concat(i,"-").concat(a),{component:h,lastUsedTD:null})}var d=c.get("".concat(i,"-").concat(a)),p=d.component,y=d.lastUsedTD;if(Object.assign(p.$data,f),!p.$el.parentElement||y!==o){while(o.firstChild)o.removeChild(o.firstChild);o.appendChild(p.$el),d.lastUsedTD=o}}return o}},getEditorClass:function(t,e){var n=t.key?t.key.toString():null,r=t.componentOptions.Ctor.options.name,o=n?"".concat(r,":").concat(n):r,i=this.editorCache,a=null;return i.has(o)?a=i.get(o):(a=wM(t,e,t.componentOptions.propsData,{isEditor:!0}),i.set(o,a)),a.$data.hotCustomEditorClass}},mounted:function(){return this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeDestroy:function(){this.hotInstance&&this.hotInstance.destroy()},version:CM};function PM(t,e,n,r,o,i,a,l,s,u){"boolean"!==typeof a&&(s=l,l=a,a=!1);const c="function"===typeof n?n.options:n;let f;if(t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,o&&(c.functional=!0)),r&&(c._scopeId=r),i?(f=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,s(t)),t&&t._registeredComponents&&t._registeredComponents.add(i)},c._ssrRegister=f):e&&(f=a?function(t){e.call(this,u(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,l(t))}),f)if(c.functional){const t=c.render;c.render=function(e,n){return f.call(n),t(e,n)}}else{const t=c.beforeCreate;c.beforeCreate=t?[].concat(t,f):[f]}return n}var TM=EM,jM=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:t.id}},[t._t("default")],2)},MM=[],AM=void 0,IM=void 0,xM=void 0,_M=!1,HM=PM({render:jM,staticRenderFns:MM},AM,TM,IM,_M,xM,!1,void 0,void 0,void 0);yM("HotColumn");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function NM(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(o=t[l])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}function DM(t){return DM="function"===typeof Symbol&&"symbol"===Qj(Symbol.iterator)?function(t){return Qj(t)}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":Qj(t)},DM(t)}function LM(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BM(t){return VM(t)||FM(t)||WM()}function VM(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function FM(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function WM(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function UM(){return"undefined"!==typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function zM(t,e){GM(t,e),Object.getOwnPropertyNames(e.prototype).forEach((function(n){GM(t.prototype,e.prototype,n)})),Object.getOwnPropertyNames(e).forEach((function(n){GM(t,e,n)}))}function GM(t,e,n){var r=n?Reflect.getOwnMetadataKeys(e,n):Reflect.getOwnMetadataKeys(e);r.forEach((function(r){var o=n?Reflect.getOwnMetadata(r,e,n):Reflect.getOwnMetadata(r,e);n?Reflect.defineMetadata(r,o,t,n):Reflect.defineMetadata(r,o,t)}))}var YM={__proto__:[]},KM=YM instanceof Array;function XM(t){var e=DM(t);return null==t||"object"!==e&&"function"!==e}function $M(t,e){var n=e.prototype._init;e.prototype._init=function(){var e=this,n=Object.getOwnPropertyNames(t);if(t.$options.props)for(var r in t.$options.props)t.hasOwnProperty(r)||n.push(r);n.forEach((function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){t[n]=e},configurable:!0})}))};var r=new e;e.prototype._init=n;var o={};return Object.keys(r).forEach((function(t){void 0!==r[t]&&(o[t]=r[t])})),o}var qM=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function QM(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.name=e.name||t._componentTag||t.name;var n=t.prototype;Object.getOwnPropertyNames(n).forEach((function(t){if("constructor"!==t)if(qM.indexOf(t)>-1)e[t]=n[t];else{var r=Object.getOwnPropertyDescriptor(n,t);void 0!==r.value?"function"===typeof r.value?(e.methods||(e.methods={}))[t]=r.value:(e.mixins||(e.mixins=[])).push({data:function(){return LM({},t,r.value)}}):(r.get||r.set)&&((e.computed||(e.computed={}))[t]={get:r.get,set:r.set})}})),(e.mixins||(e.mixins=[])).push({data:function(){return $M(this,t)}});var r=t.__decorators__;r&&(r.forEach((function(t){return t(e)})),delete t.__decorators__);var o=Object.getPrototypeOf(t.prototype),i=o instanceof Xj.Z?o.constructor:Xj.Z,a=i.extend(e);return ZM(a,t,i),UM()&&zM(a,t),a}var JM={prototype:!0,arguments:!0,callee:!0,caller:!0};function ZM(t,e,n){Object.getOwnPropertyNames(e).forEach((function(r){if(!JM[r]){var o=Object.getOwnPropertyDescriptor(t,r);if(!o||o.configurable){var i=Object.getOwnPropertyDescriptor(e,r);if(!KM){if("cid"===r)return;var a=Object.getOwnPropertyDescriptor(n,r);if(!XM(i.value)&&a&&a.value===i.value)return}Object.defineProperty(t,r,i)}}}))}function tA(t){return"function"===typeof t?QM(t):function(e){return QM(e,t)}}tA.registerHooks=function(t){qM.push.apply(qM,BM(t))};var eA=function(t){nM(n,t);var e=sM(n);function n(){var t;return Jj(this,n),t=e.apply(this,arguments),t.name="BaseEditorComponent",t.instance=null,t.row=null,t.col=null,t.prop=null,t.TD=null,t.originalValue=null,t.cellProperties=null,t.state=null,t.hot=null,t}return tM(n,[{key:"mounted",value:function(){var t=this;this.$data.hotCustomEditorClass=function(){var e=function(e){nM(r,e);var n=sM(r);function r(e){var o;return Jj(this,r),o=n.call(this,e),t.$data.hotCustomEditorInstance=aM(o),o}return tM(r,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),r}(Kj.editors.BaseEditor);return Object.getOwnPropertyNames(Kj.editors.BaseEditor.prototype).forEach((function(n){"constructor"!==n&&(e.prototype[n]=function(){for(var e,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t[n]).call.apply(e,[this].concat(o))})})),e}()}},{key:"_fireCallbacks",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=Kj.editors.BaseEditor.prototype._fireCallbacks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"beginEditing",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.beginEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"cancelChanges",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.cancelChanges).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"checkEditorSection",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.checkEditorSection).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"close",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.close).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"discardEditor",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.discardEditor).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"enableFullEditMode",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.enableFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"extend",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.extend).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"finishEditing",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.finishEditing).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"focus",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.focus).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getValue",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.getValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"init",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.init).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isInFullEditMode",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.isInFullEditMode).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isOpened",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.isOpened).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"isWaiting",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.isWaiting).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"open",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.open).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"prepare",value:function(t,e,n,r,o,i){return this.$data.hotInstance=i.instance,this.$data.row=t,this.$data.col=e,this.$data.prop=n,this.$data.TD=r,this.$data.originalValue=o,this.$data.cellProperties=i,Kj.editors.BaseEditor.prototype.prepare.call(this.$data.hotCustomEditorInstance,t,e,n,r,o,i)}},{key:"saveValue",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.saveValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"setValue",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.setValue).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"addHook",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.addHook).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"removeHooksByKey",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.removeHooksByKey).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"clearHooks",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.clearHooks).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCell",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.getEditedCell).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellRect",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.getEditedCellRect).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsZIndex",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.getEditedCellsZIndex).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}},{key:"getEditedCellsLayerClass",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=Kj.editors.BaseEditor.prototype.getEditedCellsLayerClass).call.apply(t,[this.$data.hotCustomEditorInstance].concat(n))}}]),n}(Xj.Z);eA=NM([tA({})],eA);var nA=[[!1,"Tagcat","United Kingdom","Classic Vest","11/10/2020","01-2331942",!0,"172",2,2],[!0,"Zoomzone","Indonesia","Cycling Cap","03/05/2020","88-2768633",!0,"188",6,2],[!0,"Meeveo","United States","Full-Finger Gloves","27/03/2020","51-6775945",!0,"162",1,3],[!1,"Buzzdog","Philippines","HL Mountain Frame","29/08/2020","44-4028109",!0,"133",7,1],[!0,"Katz","India","Half-Finger Gloves","02/10/2020","08-2758492",!0,"87",1,3],[!1,"Jaxbean","China","HL Road Frame","28/09/2020","84-3557705",!1,"26",8,1],[!1,"Wikido","Brazil","HL Touring Frame","24/06/2020","20-9397637",!1,"110",4,1],[!1,"Browsedrive","United States","LL Mountain Frame","13/03/2020","36-0079556",!0,"50",4,4],[!1,"Twinder","United Kingdom","LL Road Frame","06/04/2020","41-1489542",!1,"160",6,1],[!1,"Jetwire","China","LL Touring Frame","01/02/2020","37-1531629",!0,"30",8,5],[!1,"Chatterpoint","China","Long-Sleeve Logo Jersey","14/07/2020","25-5083429",!0,"39",7,2],[!1,"Twinder","Egypt","Men's Bib-Shorts","31/08/2020","04-4281278",!1,"96",6,1],[!1,"Midel","United States","Men's Sports Shorts","27/06/2020","55-1711908",!0,"108",10,3],[!1,"Yodo","India","ML Mountain Frame","16/03/2020","58-8360815",!1,"46",1,1],[!1,"Camido","Russia","ML Mountain Frame-W","13/09/2020","10-3786104",!0,"97",8,3],[!1,"Eire","Thailand","ML Road Frame","10/04/2020","45-1186054",!0,"161",1,4],[!1,"Vinte","United Kingdom","ML Road Frame-W","22/01/2020","62-6202742",!0,"58",4,3],[!1,"Twitterlist","China","Mountain Bike Socks","09/11/2020","88-9646223",!0,"92",8,3],[!1,"Eidel","Bangladesh","Mountain-100","19/09/2020","45-5588112",!0,"5",6,5],[!1,"Trunyx","Nigeria","Mountain-200","09/03/2020","66-6271819",!0,"158",4,1],[!1,"Katz","Turkey","Mountain-300","05/03/2020","38-9245023",!1,"121",5,4],[!1,"Kaymbo","United States","Mountain-400-W","24/12/2020","44-5916927",!1,"61",5,4],[!1,"Ozu","Pakistan","Mountain-500","13/06/2020","31-5449914",!0,"155",2,2],[!1,"Rhynyx","India","Racing Socks","05/12/2020","19-9413869",!0,"162",2,4],[!1,"Flashset","Iran","Road-150","14/12/2020","25-9807605",!1,"46",7,1],[!1,"Yata","Congo (Kinshasa)","Road-250","12/06/2020","74-4291983",!0,"47",4,4],[!1,"Brainlounge","Vietnam","Road-350-W","10/03/2020","83-0980643",!0,"104",2,3],[!1,"Babblestorm","United States","Road-450","10/10/2020","19-2878430",!0,"101",6,4],[!1,"Youspan","Brazil","Road-550-W","16/12/2020","19-1838230",!0,"150",10,3],[!1,"Nlounge","China","Road-650","31/10/2020","32-2267938",!0,"42",4,2],[!1,"Twinte","India","Road-750","17/08/2020","79-2821972",!0,"144",9,3],[!1,"Oyonder","United Kingdom","Short-Sleeve Classic Jersey","04/12/2020","46-6597557",!0,"195",4,1],[!1,"Gigabox","Pakistan","Sport-100","03/02/2020","15-1793960",!0,"199",4,4],[!1,"Livetube","France","Touring-1000","16/05/2020","86-0811003",!0,"110",4,5],[!1,"Voomm","United Kingdom","Touring-2000","15/07/2020","95-3068680",!0,"51",4,4],[!1,"Voonyx","China","Touring-3000","27/11/2020","35-3085360",!1,"69",2,5],[!1,"Zoombeat","United States","Women's Mountain Shorts","03/11/2020","56-8673088",!1,"53",2,3],[!1,"Roomm","China","Women's Tights","16/03/2020","76-0085918",!0,"168",1,1],[!1,"Leenti","China","Mountain-400","16/05/2020","03-0893276",!1,"58",1,4],[!1,"Jetpulse","United States","Road-550","08/02/2020","79-9013306",!0,"152",9,3],[!1,"Katz","Peru","Road-350","15/02/2020","55-7799920",!0,"66",4,2],[!1,"Cogidoo","India","LL Mountain Front Wheel","04/06/2020","07-0881122",!1,"112",9,2],[!1,"Divavu","Colombia","Touring Rear Wheel","24/02/2020","58-6157387",!0,"50",10,4],[!1,"Mydeo","China","Touring Front Wheel","07/12/2020","12-2810010",!1,"31",3,5],[!1,"Browsebug","Japan","ML Mountain Front Wheel","14/01/2020","64-9249984",!0,"132",5,5],[!1,"Layo","China","HL Mountain Front Wheel","24/04/2020","45-0739652",!0,"45",1,5],[!1,"Snaptags","United Kingdom","LL Touring Handlebars","06/08/2020","09-5712761",!0,"197",4,2],[!1,"Cogilith","China","HL Touring Handlebars","31/05/2020","01-7345008",!0,"190",4,3],[!1,"Reallinks","United Kingdom","LL Road Front Wheel","14/05/2020","62-1065350",!0,"184",3,4],[!1,"Quaxo","United States","ML Road Front Wheel","23/03/2020","44-7241323",!0,"169",3,4],[!1,"Devify","China","HL Road Front Wheel","12/12/2020","52-0295699",!1,"152",4,4],[!1,"Youopia","Angola","LL Mountain Handlebars","01/04/2020","52-2650922",!1,"182",6,4],[!1,"Ainyx","China","Touring Pedal","27/02/2020","48-3618525",!0,"141",6,1],[!1,"Browsetype","Malaysia","ML Mountain Handlebars","28/04/2020","51-8893923",!0,"169",7,1],[!1,"Muxo","China","HL Mountain Handlebars","22/08/2020","68-5911361",!1,"39",7,1],[!1,"Bubbletube","China","LL Road Handlebars","04/10/2020","41-5880042",!0,"71",8,3],[!1,"Fadeo","Vietnam","ML Road Handlebars","23/04/2020","90-5913983",!0,"148",10,3],[!1,"Yadel","United Kingdom","HL Road Handlebars","18/04/2020","92-0960699",!0,"116",8,1],[!1,"Blognation","China","LL Headset","10/01/2020","06-9493898",!0,"96",10,1],[!1,"Devpoint","China","ML Headset","25/12/2020","69-5878565",!0,"35",4,2],[!1,"Aibox","United Kingdom","HL Headset","18/03/2020","13-1133017",!0,"16",8,2],[!1,"Brightdog","China","LL Mountain Pedal","11/09/2020","39-6530433",!0,"194",2,5],[!1,"Gabcube","Nigeria","ML Mountain Pedal","22/04/2020","96-6860388",!0,"24",1,3],[!1,"Muxo","China","HL Mountain Pedal","05/06/2020","30-0356137",!0,"170",4,4],[!1,"Tambee","China","ML Touring Seat/Saddle","22/02/2020","93-9058255",!0,"184",9,5],[!1,"Cogilith","India","LL Touring Seat/Saddle","06/04/2020","82-9268909",!1,"153",10,4],[!1,"Dynabox","Hong Kong","HL Touring Seat/Saddle","10/01/2020","20-6913815",!1,"88",10,1],[!1,"Shuffledrive","Sudan","LL Road Pedal","16/09/2020","08-8238817",!0,"57",9,2],[!1,"Fivechat","China","ML Road Pedal","26/08/2020","44-7370350",!1,"62",4,1],[!1,"Meembee","United States","HL Road Pedal","27/12/2020","01-3525949",!0,"123",2,4],[!1,"Dynazzy","United Kingdom","LL Mountain Seat/Saddle 1","15/12/2020","04-2414623",!0,"77",10,5],[!1,"Eare","China","ML Mountain Seat/Saddle 1","04/04/2020","15-1917509",!1,"199",9,4],[!1,"Yozio","China","HL Mountain Seat/Saddle 1","15/03/2020","06-2526845",!0,"149",8,2],[!1,"Quinu","Xi'an","425-777-7829","22/02/2020","83-1713558",!1,"191",9,5],[!1,"Jazzy","United Kingdom","ML Road Seat/Saddle 1","07/08/2020","00-8892524",!0,"150",10,2],[!1,"Thoughtsphere","China","HL Road Seat/Saddle 1","28/11/2020","39-5538991",!0,"130",7,3],[!1,"Leenti","China","ML Road Rear Wheel","29/12/2020","06-9002973",!0,"179",1,2],[!1,"Quaxo","United Kingdom","HL Road Rear Wheel","06/09/2020","73-6104901",!0,"98",5,3],[!1,"Tanoodle","Chile","LL Mountain Seat/Saddle 2","24/05/2020","68-7384479",!0,"175",2,3],[!1,"Feednation","China","ML Mountain Seat/Saddle 2","21/11/2020","26-7757763",!0,"11",1,3],[!1,"Kayveo","China","HL Mountain Seat/Saddle 2","21/06/2020","07-4873562",!1,"184",7,4],[!1,"Meevee","Saudi Arabia","LL Road Seat/Saddle 1","16/11/2020","46-5819554",!1,"27",9,3],[!1,"Twitterworks","China","ML Road Seat/Saddle 2","19/04/2020","01-2666826",!0,"186",3,2],[!1,"Wikizz","Tanzania","HL Road Seat/Saddle 2","08/03/2020","54-7090503",!0,"20",3,3],[!1,"Yoveo","United States","LL Mountain Tire","14/10/2020","78-7658520",!1,"153",2,1],[!1,"Yakidoo","China","ML Mountain Tire","12/10/2020","23-9926318",!0,"161",8,5],[!1,"Oyope","China","HL Mountain Tire","20/09/2020","20-0179517",!0,"98",10,5],[!1,"Skipstorm","United States","LL Road Tire","01/10/2020","02-9543343",!0,"30",7,3],[!1,"Minyx","United States","ML Road Tire","07/07/2020","98-3938169",!0,"73",10,2],[!1,"Miboo","China","HL Road Tire","25/07/2020","68-5197934",!0,"158",9,1],[!1,"Realfire","United States","Touring Tire","27/08/2020","39-8260460",!0,"122",5,2],[!1,"Shufflester","China","Mountain Tire Tube","08/06/2020","45-9776170",!0,"33",2,4],[!1,"Ntag","China","Road Tire Tube","06/12/2020","45-0858451",!0,"107",6,2],[!1,"Jabberbean","United States","Touring Tire Tube","26/04/2020","15-4247305",!0,"15",1,2],[!1,"Thoughtblab","China","LL Bottom Bracket","21/05/2020","15-8534931",!0,"168",5,2],[!1,"Jabbertype","China","Classic Vest","25/07/2020","23-1251557",!0,"135",4,2],[!1,"Buzzshare","United Kingdom","Cycling Cap","07/07/2020","86-5920601",!0,"11",1,4],[!1,"Roodel","United States","Full-Finger Gloves","13/01/2020","48-1055459",!0,"41",6,4],[!1,"Zoovu","China","Half-Finger Gloves","03/06/2020","12-7842022",!0,"144",6,1],[!1,"Photofeed","China","HL Mountain Frame","14/07/2020","94-5088099",!0,"106",1,4]],rA="selected",oA="odd";function iA(){return nA}n(3093);function aA(t){return aA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aA(t)}function lA(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sA(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,cA(r.key),r)}}function uA(t,e,n){return e&&sA(t.prototype,e),n&&sA(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function cA(t){var e=fA(t,"string");return"symbol"===aA(e)?e:String(e)}function fA(t,e){if("object"!==aA(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==aA(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function hA(){return hA="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=dA(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},hA.apply(this,arguments)}function dA(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=wA(t),null===t)break;return t}function pA(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yA(t,e)}function yA(t,e){return yA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},yA(t,e)}function vA(t){var e=bA();return function(){var n,r=wA(t);if(e){var o=wA(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mA(this,n)}}function mA(t,e){if(e&&("object"===aA(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return gA(t)}function gA(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bA(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function wA(t){return wA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wA(t)}var SA="handsontableEditor",CA="handsontable",OA=function(t){pA(n,t);var e=vA(n);function n(){return lA(this,n),e.apply(this,arguments)}return uA(n,[{key:"open",value:function(){hA(wA(n.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Sn(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),hA(wA(n.prototype),"close",this).call(this)}},{key:"prepare",value:function(t,e,r,o,i,a){hA(wA(n.prototype),"prepare",this).call(this,t,e,r,o,i,a);var l=this,s={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(t,e){var n=this.getSourceData(e.row,e.col);void 0!==n&&l.setValue(n),l.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&at(s,a.handsontable),this.htOptions=s}},{key:"beginEditing",value:function(t,e){var r=this.hot.getSettings().onBeginEditing;r&&!1===r()||hA(wA(n.prototype),"beginEditing",this).call(this,t,e)}},{key:"createElements",value:function(){hA(wA(n.prototype),"createElements",this).call(this);var t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}},{key:"finishEditing",value:function(t,e,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var o=this.htEditor.getInstance().getValue();void 0!==o&&this.setValue(o)}hA(wA(n.prototype),"finishEditing",this).call(this,t,e,r)}},{key:"assignHooks",value:function(){var t=this;this.hot.addHook("afterDestroy",(function(){t.htEditor&&t.htEditor.destroy()}))}},{key:"registerShortcuts",value:function(){var t=this,e=this.hot.getShortcutManager(),r=e.getContext("editor");hA(wA(n.prototype),"registerShortcuts",this).call(this);var o={group:SA,relativeToGroup:so,position:"before"},i=function(e,n){var r=t.htEditor.getInstance();if(void 0!==e&&(e<0||r.flipped&&e>r.countRows()-1?r.deselectCell():r.selectCell(e,0),r.getData().length))return n.preventDefault(),Qn(n),t.hot.listen(),t.TEXTAREA.focus(),!1};r.addShortcuts([{keys:[["ArrowUp"]],callback:function(e){var n,r,o=t.htEditor.getInstance();return!o.getSelectedLast()&&o.flipped?n=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(r=o.getSelectedLast()[0],n=Math.max(0,r-1)):(r=o.getSelectedLast()[0],n=r-1)),i(n,e)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(e){var n,r,o=t.htEditor.getInstance();if(o.getSelectedLast()||o.flipped){if(o.getSelectedLast())if(o.flipped)n=o.getSelectedLast()[0]+1;else if(!o.flipped){var a=o.countRows()-1;r=o.getSelectedLast()[0],n=Math.min(a,r+1)}}else n=0;return i(n,e)},preventDefault:!1}],o)}},{key:"unregisterShortcuts",value:function(){hA(wA(n.prototype),"unregisterShortcuts",this).call(this);var t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(SA)}}],[{key:"EDITOR_TYPE",get:function(){return CA}}]),n}(Bj);function kA(t){return kA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kA(t)}function RA(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function EA(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,LA(r.key),r)}}function PA(t,e,n){return e&&EA(t.prototype,e),n&&EA(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function TA(){return TA="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=jA(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},TA.apply(this,arguments)}function jA(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=NA(t),null===t)break;return t}function MA(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&AA(t,e)}function AA(t,e){return AA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},AA(t,e)}function IA(t){var e=HA();return function(){var n,r=NA(t);if(e){var o=NA(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xA(this,n)}}function xA(t,e){if(e&&("object"===kA(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _A(t)}function _A(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function HA(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function NA(t){return NA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},NA(t)}function DA(t,e,n){return e=LA(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LA(t){var e=BA(t,"string");return"symbol"===kA(e)?e:String(e)}function BA(t,e){if("object"!==kA(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==kA(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var VA=new WeakMap,FA="autocomplete",WA=function(t){MA(n,t);var e=IA(n);function n(t){var r;return RA(this,n),r=e.call(this,t),DA(_A(r),"sortByRelevance",(function(t,e,n){var r,o,i,a,l=[],s=[],u=t.length,c=e.length;if(0===u){for(i=0;i<c;i++)s.push(i);return s}for(i=0;i<c;i++){if(o=ke(Jt(e[i])),n)a=o.indexOf(t);else{var f=this.cellProperties.locale;a=o.toLocaleLowerCase(f).indexOf(t.toLocaleLowerCase(f))}-1!==a&&(r=o.length-a-u,l.push({baseIndex:i,index:a,charsLeft:r,value:o}))}for(l.sort((function(t,e){if(-1===e.index)return-1;if(-1===t.index)return 1;if(t.index<e.index)return-1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0})),i=0,c=l.length;i<c;i++)s.push(l[i].baseIndex);return s})),r.query=null,r.strippedChoices=[],r.rawChoices=[],VA.set(_A(r),{skipOne:!1,isMacOS:r.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),r}return PA(n,[{key:"getValue",value:function(){var t=this,e=this.rawChoices.find((function(e){var n=t.stripValueIfNeeded(e);return n===t.TEXTAREA.value}));return Zt(e)?e:this.TEXTAREA.value}},{key:"createElements",value:function(){TA(NA(n.prototype),"createElements",this).call(this),Ge(this.htContainer,"autocompleteEditor"),Ge(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}},{key:"open",value:function(){var t=this,e=VA.get(this);TA(NA(n.prototype),"open",this).call(this);var r=this.htEditor.getInstance(),o=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var i=On();0===i&&e.isMacOS&&(i+=15),this.addHook("beforeKeyDown",(function(e){return t.onBeforeKeyDown(e)})),r.updateSettings({colWidths:o?[fn(this.TEXTAREA)-2]:void 0,width:o?fn(this.TEXTAREA)+i:void 0,renderer:function(e,n,r,o,i,a,l){Uj(e,n,r,o,i,a,l);var s,u,c=t.cellProperties,f=c.filteringCaseSensitive,h=c.allowHtml,d=c.locale,p=t.query,y=Jt(a);y&&!h&&(s=!0===f?y.indexOf(p):y.toLocaleLowerCase(d).indexOf(p.toLocaleLowerCase(d)),-1!==s&&(u=y.substr(s,p.length),y=y.replace(u,"<strong>".concat(u,"</strong>")))),n.innerHTML=y},autoColumnSize:!0}),e.skipOne&&(e.skipOne=!1),this.hot._registerTimeout((function(){t.queryChoices(t.TEXTAREA.value)}))}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),TA(NA(n.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(t){TA(NA(n.prototype),"discardEditor",this).call(this,t),this.hot.view.render()}},{key:"queryChoices",value:function(t){var e=this,n=this.cellProperties.source;this.query=t,"function"===typeof n?n.call(this.cellProperties,t,(function(t){e.rawChoices=t,e.updateChoicesList(e.stripValuesIfNeeded(t))})):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(t){var e=mn(this.TEXTAREA),n=gn(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,i=null,a=null,l=t;r&&(i=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));var s=Array.isArray(i)?i.length:0;if(!1===o)s&&(a=i[0]);else{for(var u=[],c=0,f=l.length;c<f;c++){if(r&&s<=c)break;s?u.push(l[i[c]]):u.push(l[c])}a=0,l=u}this.strippedChoices=l,this.htEditor.loadData(B([l])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(a),this.hot.listen(),Sn(this.TEXTAREA,e,e===n?void 0:n)}},{key:"flipDropdownIfNeeded",value:function(){var t=ln(this.hot.view._wt.wtTable.TABLE),e=t===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(e||!e&&(n||"horizontal"===n))return!1;var r=tn(this.TEXTAREA),o=hn(this.TEXTAREA),i=this.getDropdownHeight(),a=t.scrollTop,l=hn(this.hot.view._wt.wtTable.THEAD),s=tn(t),u=r.top-s.top-l+a,c=t.scrollHeight-u-l-o,f=i>c&&u>c;return f?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(f?u:c,i),f}},{key:"limitDropdownIfNeeded",value:function(t,e){if(e>t){var n=0,r=0,o=0,i=null;do{o=this.htEditor.getRowHeight(r)||this.htEditor.view._wt.getSetting("defaultRowHeight"),n+=o,r+=1}while(n<t);i=n-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+e-i,"px")),this.setDropdownHeight(n-o)}}},{key:"flipDropdown",value:function(t){var e=this.htEditor.rootElement.style;e.position="absolute",e.top="".concat(-t,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var t=this.htEditor.rootElement.style;t.position="absolute",t.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var t=this.htEditor.getColWidth(0)+On(this.hot.rootDocument)+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(t){this.htEditor.updateSettings({height:t})}},{key:"highlightBestMatchingChoice",value:function(t){"number"===typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var t=this.htEditor.getInstance().getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8}},{key:"stripValueIfNeeded",value:function(t){return this.stripValuesIfNeeded([t])[0]}},{key:"stripValuesIfNeeded",value:function(t){var e=this.cellProperties.allowHtml,n=W(t,(function(t){return Jt(t)})),r=W(n,(function(t){return e?t:ke(t)}));return r}},{key:"allowKeyEventPropagation",value:function(t){var e=this.htEditor.getSelectedRangeLast(),n={row:e?e.from.row:-1},r=!1;return t===zn.ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(r=!0),t===zn.ARROW_UP&&n.row>-1&&(r=!0),r}},{key:"onBeforeKeyDown",value:function(t){var e=this,n=VA.get(this);if(n.skipOne=!1,Yn(t.keyCode)||t.keyCode===zn.BACKSPACE||t.keyCode===zn.DELETE||t.keyCode===zn.INSERT){var r=10;if(t.keyCode===zn.C&&(t.ctrlKey||t.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout((function(){e.queryChoices(e.TEXTAREA.value),n.skipOne=!0}),r)}}}],[{key:"EDITOR_TYPE",get:function(){return FA}}]),n}(OA);function UA(t){return UA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},UA(t)}function zA(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function GA(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,KA(r.key),r)}}function YA(t,e,n){return e&&GA(t.prototype,e),n&&GA(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function KA(t){var e=XA(t,"string");return"symbol"===UA(e)?e:String(e)}function XA(t,e){if("object"!==UA(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==UA(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function $A(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qA(t,e)}function qA(t,e){return qA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},qA(t,e)}function QA(t){var e=tI();return function(){var n,r=eI(t);if(e){var o=eI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return JA(this,n)}}function JA(t,e){if(e&&("object"===UA(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ZA(t)}function ZA(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tI(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function eI(t){return eI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},eI(t)}var nI="checkbox",rI=function(t){$A(n,t);var e=QA(n);function n(){return zA(this,n),e.apply(this,arguments)}return YA(n,[{key:"beginEditing",value:function(t,e){if(e&&"mouseup"===e.type){var n=this.TD.querySelector('input[type="checkbox"]');ze(n,"htBadValue")||n.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return nI}}]),n}(fj),oI=n(1077);function iI(t){return iI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iI(t)}function aI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,uI(r.key),r)}}function sI(t,e,n){return e&&lI(t.prototype,e),n&&lI(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function uI(t){var e=cI(t,"string");return"symbol"===iI(e)?e:String(e)}function cI(t,e){if("object"!==iI(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==iI(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function fI(){return fI="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=hI(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},fI.apply(this,arguments)}function hI(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=bI(t),null===t)break;return t}function dI(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pI(t,e)}function pI(t,e){return pI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},pI(t,e)}function yI(t){var e=gI();return function(){var n,r=bI(t);if(e){var o=bI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vI(this,n)}}function vI(t,e){if(e&&("object"===iI(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return mI(t)}function mI(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function gI(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function bI(t){return bI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bI(t)}var wI="date",SI="dateEditor",CI=function(t){dI(n,t);var e=yI(n);function n(t){var r;return aI(this,n),r=e.call(this,t),r.defaultDateFormat="DD/MM/YYYY",r.isCellEdited=!1,r.parentDestroyed=!1,r.$datePicker=null,r}return sI(n,[{key:"init",value:function(){var t=this;if("function"!==typeof Xt)throw new Error("You need to include moment.js to your project.");if("function"!==typeof oI)throw new Error("You need to include Pikaday to your project.");fI(bI(n.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",(function(){t.parentDestroyed=!0,t.destroyElements()}))}},{key:"createElements",value:function(){fI(bI(n.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Ge(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var t=new Gr(this);t.addEventListener(this.datePicker,"mousedown",(function(t){return t.stopPropagation()}))}},{key:"destroyElements",value:function(){var t=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}},{key:"prepare",value:function(t,e,r,o,i,a){fI(bI(n.prototype),"prepare",this).call(this,t,e,r,o,i,a)}},{key:"open",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.hot.getShortcutManager(),r=e.getContext("editor");fI(bI(n.prototype),"open",this).call(this),this.showDatepicker(t),r.addShortcut({keys:[["Enter"]],callback:function(t){t.stopPropagation()},group:SI})}},{key:"close",value:function(){var t,e=this;this._opened=!1,null!==(t=this.$datePicker)&&void 0!==t&&t.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout((function(){e.instance._refreshBorders()}));var r=this.hot.getShortcutManager(),o=r.getContext("editor");o.removeShortcutsByGroup(SI),fI(bI(n.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){var r=this.originalValue;void 0!==r&&this.setValue(r)}fI(bI(n.prototype),"finishEditing",this).call(this,t,e)}},{key:"showDatepicker",value:function(t){var e,n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.instance.view.isMouseDown(),i=!!t&&Kn(t.keyCode);this.datePicker.style.display="block",this.$datePicker=new oI(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+n.top+hn(this.TD),"px");var a=this.hot.rootWindow.pageXOffset;a=this.hot.isRtl()?n.right-fn(this.datePicker):n.left,this.datePickerStyle.left="".concat(a,"px"),this.originalValue?(e=this.originalValue,Xt(e,r,!0).isValid()&&this.$datePicker.setMoment(Xt(e,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),i||o||this.setValue("")):this.cellProperties.defaultDate?(e=this.cellProperties.defaultDate,Xt(e,r,!0).isValid()&&this.$datePicker.setMoment(Xt(e,r),!0),i||o||this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var t=this,e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&lt(n,this.cellProperties.datePickerConfig);var r=n.onSelect,o=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=function(e){var n=e;isNaN(n.getTime())||(n=Xt(n).format(t.cellProperties.dateFormat||t.defaultDateFormat)),t.setValue(n),t.hideDatepicker(),r&&r()},n.onClose=function(){t.parentDestroyed||t.finishEditing(!1),o&&o()},n}}],[{key:"EDITOR_TYPE",get:function(){return wI}}]),n}(Bj);function OI(t){return OI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OI(t)}function kI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function RI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,PI(r.key),r)}}function EI(t,e,n){return e&&RI(t.prototype,e),n&&RI(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function PI(t){var e=TI(t,"string");return"symbol"===OI(e)?e:String(e)}function TI(t,e){if("object"!==OI(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==OI(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function jI(){return jI="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=MI(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},jI.apply(this,arguments)}function MI(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=DI(t),null===t)break;return t}function AI(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&II(t,e)}function II(t,e){return II=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},II(t,e)}function xI(t){var e=NI();return function(){var n,r=DI(t);if(e){var o=DI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _I(this,n)}}function _I(t,e){if(e&&("object"===OI(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return HI(t)}function HI(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function NI(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function DI(t){return DI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},DI(t)}var LI="dropdown",BI=function(t){AI(n,t);var e=xI(n);function n(){return kI(this,n),e.apply(this,arguments)}return EI(n,[{key:"prepare",value:function(t,e,r,o,i,a){jI(DI(n.prototype),"prepare",this).call(this,t,e,r,o,i,a),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return LI}}]),n}(WA);function VI(t){return VI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},VI(t)}function FI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zI(r.key),r)}}function UI(t,e,n){return e&&WI(t.prototype,e),n&&WI(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function zI(t){var e=GI(t,"string");return"symbol"===VI(e)?e:String(e)}function GI(t,e){if("object"!==VI(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==VI(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function YI(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&KI(t,e)}function KI(t,e){return KI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},KI(t,e)}function XI(t){var e=QI();return function(){var n,r=JI(t);if(e){var o=JI(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $I(this,n)}}function $I(t,e){if(e&&("object"===VI(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return qI(t)}function qI(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function QI(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function JI(t){return JI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},JI(t)}mr.getSingleton().add("beforeValidate",(function(t,e,n){var r=this.getCellMeta(e,this.propToCol(n));r.editor===BI&&void 0===r.strict&&(r.filter=!1,r.strict=!0)}));var ZI="numeric",tx=function(t){YI(n,t);var e=XI(n);function n(){return FI(this,n),e.apply(this,arguments)}return UI(n,null,[{key:"EDITOR_TYPE",get:function(){return ZI}}]),n}(Bj);function ex(t){return ex="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ex(t)}function nx(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ix(r.key),r)}}function ox(t,e,n){return e&&rx(t.prototype,e),n&&rx(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ix(t){var e=ax(t,"string");return"symbol"===ex(e)?e:String(e)}function ax(t,e){if("object"!==ex(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ex(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function lx(){return lx="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=sx(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},lx.apply(this,arguments)}function sx(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=yx(t),null===t)break;return t}function ux(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cx(t,e)}function cx(t,e){return cx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},cx(t,e)}function fx(t){var e=px();return function(){var n,r=yx(t);if(e){var o=yx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hx(this,n)}}function hx(t,e){if(e&&("object"===ex(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return dx(t)}function dx(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function px(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function yx(t){return yx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yx(t)}var vx="password",mx=function(t){ux(n,t);var e=fx(n);function n(){return nx(this,n),e.apply(this,arguments)}return ox(n,[{key:"createElements",value:function(){lx(yx(n.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Xe(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return vx}}]),n}(Bj);function gx(t){return gx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gx(t)}function bx(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Cx(r.key),r)}}function Sx(t,e,n){return e&&wx(t.prototype,e),n&&wx(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cx(t){var e=Ox(t,"string");return"symbol"===gx(e)?e:String(e)}function Ox(t,e){if("object"!==gx(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==gx(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function kx(){return kx="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Rx(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},kx.apply(this,arguments)}function Rx(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Ix(t),null===t)break;return t}function Ex(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Px(t,e)}function Px(t,e){return Px=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Px(t,e)}function Tx(t){var e=Ax();return function(){var n,r=Ix(t);if(e){var o=Ix(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jx(this,n)}}function jx(t,e){if(e&&("object"===gx(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Mx(t)}function Mx(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ax(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Ix(t){return Ix=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ix(t)}var xx="ht_editor_visible",_x="selectEditor",Hx="select",Nx=function(t){Ex(n,t);var e=Tx(n);function n(){return bx(this,n),e.apply(this,arguments)}return Sx(n,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Ge(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(t){this.select.value=t}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var t=this.hot.getShortcutManager();t.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",ze(this.select,xx)&&Ye(this.select,xx),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var t=this;this.addHook("afterScrollHorizontally",(function(){return t.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return t.refreshDimensions()})),this.addHook("afterColumnResize",(function(){return t.refreshDimensions()})),this.addHook("afterRowResize",(function(){return t.refreshDimensions()}))}},{key:"prepare",value:function(t,e,r,o,i,a){var l=this;kx(Ix(n.prototype),"prepare",this).call(this,t,e,r,o,i,a);var s,u=this.cellProperties.selectOptions;s="function"===typeof u?this.prepareOptions(u(this.row,this.col,this.prop)):this.prepareOptions(u),Xe(this.select),pt(s,(function(t,e){var n=l.hot.rootDocument.createElement("OPTION");n.value=e,Qe(n,t),l.select.appendChild(n)}))}},{key:"prepareOptions",value:function(t){var e={};if(Array.isArray(t))for(var n=0,r=t.length;n<r;n++)e[t[n]]=t[n];else"object"===gx(t)&&(e=t);return e}},{key:"refreshValue",value:function(){var t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===uj.EDITING)if(this.TD=this.getEditedCell(),this.TD){var t=this.getEditedCellRect(),e=t.top,n=t.start,r=t.width,o=t.height,i=this.select.style;i.height="".concat(o,"px"),i.width="".concat(r,"px"),i.top="".concat(e,"px"),i[this.hot.isRtl()?"right":"left"]="".concat(n,"px"),i.margin="0px",Ge(this.select,xx)}else this.close()}},{key:"registerShortcuts",value:function(){var t=this,e=this.hot.getShortcutManager(),n=e.getContext("editor"),r={group:_x};!1!==this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var e=t.select.selectedIndex-1;e>=0&&(t.select[e].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var e=t.select.selectedIndex+1;e<=t.select.length-1&&(t.select[e].selected=!0)}}],r)}},{key:"unregisterShortcuts",value:function(){var t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(_x)}}],[{key:"EDITOR_TYPE",get:function(){return Hx}}]),n}(fj);function Dx(t){return Dx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dx(t)}function Lx(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bx(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Fx(r.key),r)}}function Vx(t,e,n){return e&&Bx(t.prototype,e),n&&Bx(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fx(t){var e=Wx(t,"string");return"symbol"===Dx(e)?e:String(e)}function Wx(t,e){if("object"!==Dx(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Dx(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Ux(){return Ux="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=zx(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ux.apply(this,arguments)}function zx(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Qx(t),null===t)break;return t}function Gx(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yx(t,e)}function Yx(t,e){return Yx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Yx(t,e)}function Kx(t){var e=qx();return function(){var n,r=Qx(t);if(e){var o=Qx(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Xx(this,n)}}function Xx(t,e){if(e&&("object"===Dx(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return $x(t)}function $x(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qx(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Qx(t){return Qx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qx(t)}var Jx="time",Zx=function(t){Gx(n,t);var e=Kx(n);function n(){return Lx(this,n),e.apply(this,arguments)}return Vx(n,[{key:"prepare",value:function(t,e,r,o,i,a){Ux(Qx(n.prototype),"prepare",this).call(this,t,e,r,o,i,a),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return Jx}}]),n}(Bj);function t_(){Hr(fj),Hr(WA),Hr(rI),Hr(CI),Hr(BI),Hr(OA),Hr(tx),Hr(mx),Hr(Nx),Hr(Bj),Hr(Zx)}var e_="html";function n_(t,e,n,r,o,i,a){Fj.apply(this,[t,e,n,r,o,i,a]),Qe(e,null===i||void 0===i?"":i,!1)}n_.RENDERER_TYPE=e_;var r_="autocomplete";function o_(t,e,n,r,o,i,a){var l=t.rootDocument,s=a.allowHtml?n_:Uj,u=l.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(l.createTextNode(String.fromCharCode(9660))),s.apply(this,[t,e,n,r,o,i,a]),e.firstChild||e.appendChild(l.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),Ge(e,"htAutocomplete"),!t.acArrowListener){var c=new Gr(t);t.acArrowListener=function(o){ze(o.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},c.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",(function(){c.destroy()}))}}o_.RENDERER_TYPE=r_;var i_=new WeakMap,a_=new WeakMap,l_="htBadValue",s_="data-row",u_="data-col",c_="checkboxRenderer",f_="checkbox";function h_(t,e,n,r,o,i,a){var l=t.rootDocument;Fj.apply(this,[t,e,n,r,o,i,a]),d_(t);var s=p_(l),u=a.label,c=!1;if("undefined"===typeof a.checkedTemplate&&(a.checkedTemplate=!0),"undefined"===typeof a.uncheckedTemplate&&(a.uncheckedTemplate=!1),Xe(e),i===a.checkedTemplate||Jt(i).toLocaleLowerCase(a.locale)===Jt(a.checkedTemplate).toLocaleLowerCase(a.locale)?s.checked=!0:i===a.uncheckedTemplate||Jt(i).toLocaleLowerCase(a.locale)===Jt(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?s.checked=!1:ee(i)?Ge(s,"noValue"):(s.style.display="none",Ge(s,l_),c=!0),s.setAttribute(s_,n),s.setAttribute(u_,r),!c&&u){var f="";if(u.value)f="function"===typeof u.value?u.value.call(this,n,r,o,i):u.value;else if(u.property){var h=t.getDataAtRowProp(n,u.property);f=null!==h?h:""}var d=y_(l,f,!0!==u.separated);"before"===u.position?u.separated?(e.appendChild(d),e.appendChild(s)):(d.appendChild(s),s=d):u.position&&"after"!==u.position||(u.separated?(e.appendChild(s),e.appendChild(d)):(d.insertBefore(s,d.firstChild),s=d))}function p(){var e=t.getShortcutManager(),n=e.getContext("grid"),r={group:c_};n.addShortcuts([{keys:[["space"]],callback:function(){return y(),!v()}},{keys:[["enter"]],callback:function(){return y(),!v()},runOnlyIf:function(){return t.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return y(!0),!v()},relativeToGroup:uo,position:"before"}],r)}function y(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t.getSelectedRange();if(n)for(var r=0;r<n.length;r++){for(var o=n[r].getTopStartCorner(),i=o.row,a=o.col,l=n[r].getBottomEndCorner(),s=l.row,u=l.col,c=[],f=i;f<=s;f+=1)for(var h=a;h<=u;h+=1){var d=t.getCellMeta(f,h);if("checkbox"!==d.type)return;if(!0!==d.readOnly){"undefined"===typeof d.checkedTemplate&&(d.checkedTemplate=!0),"undefined"===typeof d.uncheckedTemplate&&(d.uncheckedTemplate=!1);var p=t.getDataAtCell(f,h);!1===e?[d.checkedTemplate,d.checkedTemplate.toString()].includes(p)?c.push([f,h,d.uncheckedTemplate]):[d.uncheckedTemplate,d.uncheckedTemplate.toString(),null,void 0].includes(p)&&c.push([f,h,d.checkedTemplate]):c.push([f,h,d.uncheckedTemplate])}}c.length>0&&t.setDataAtCell(c)}}function v(){var e=t.getSelectedRange();if(e){for(var n=0;n<e.length;n++)for(var r=e[n].getTopStartCorner(),o=e[n].getBottomEndCorner(),i=r.row;i<=o.row;i++)for(var a=r.col;a<=o.col;a++){var l=t.getCellMeta(i,a);if("checkbox"!==l.type)return!1;var s=t.getCell(i,a);if(null===s||void 0===s)return!0;var u=s.querySelectorAll("input[type=checkbox]");if(u.length>0&&!l.readOnly)return!0}return!1}}(!u||u&&!u.separated)&&e.appendChild(s),c&&e.appendChild(l.createTextNode("#bad-value#")),i_.has(t)||(i_.set(t,!0),p())}function d_(t){var e=a_.get(t);if(!e){var n=t.rootElement;e=new Gr(t),e.addEventListener(n,"click",(function(e){return m_(e,t)})),e.addEventListener(n,"mouseup",(function(e){return v_(e,t)})),e.addEventListener(n,"change",(function(e){return g_(e,t)})),a_.set(t,e)}return e}function p_(t){var e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function y_(t,e,n){var r=t.createElement("label");return r.className="htCheckboxRendererLabel ".concat(n?"fullWidth":""),r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function v_(t,e){var n=t.target;b_(n)&&n.hasAttribute(s_)&&n.hasAttribute(u_)&&setTimeout(e.listen,10)}function m_(t,e){var n=t.target;if(b_(n)&&n.hasAttribute(s_)&&n.hasAttribute(u_)){var r=parseInt(n.getAttribute(s_),10),o=parseInt(n.getAttribute(u_),10),i=e.getCellMeta(r,o);i.readOnly&&t.preventDefault()}}function g_(t,e){var n=t.target;if(b_(n)&&n.hasAttribute(s_)&&n.hasAttribute(u_)){var r=parseInt(n.getAttribute(s_),10),o=parseInt(n.getAttribute(u_),10),i=e.getCellMeta(r,o);if(!i.readOnly){var a=null;a=t.target.checked?void 0===i.uncheckedTemplate||i.checkedTemplate:void 0!==i.uncheckedTemplate&&i.uncheckedTemplate,e.setDataAtCell(r,o,a)}}}function b_(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}mr.getSingleton().add("modifyAutoColumnSizeSeed",(function(t,e,n){var r=e.label,o=e.type,i=e.row,a=e.column,l=e.prop;if(o===f_){if(r){var s=r.value,u=r.property,c=n;if(s)c="function"===typeof s?s(i,a,l,n):s;else if(u){var f=this.getDataAtRowProp(i,u);c=null!==f?f:n}t=c}return t}})),h_.RENDERER_TYPE=f_;var w_=n(204),S_="numeric";function C_(t,e,n,r,o,i,a){var l=i;if(xo(l)){var s=a.numericFormat,u=s&&s.culture||"-",c=s&&s.pattern,f=a.className||"",h=f.length?f.split(" "):[];if("undefined"!==typeof u&&!w_.languages()[u]){var d=u.replace("-",""),p=w_.allLanguages?w_.allLanguages[u]:w_[d];p&&w_.registerLanguage(p)}w_.setLanguage(u),l=w_(l).format(c||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),e.dir="ltr"}Uj(t,e,n,r,o,l,a)}C_.RENDERER_TYPE=S_;var O_="password";function k_(t,e,n,r,o,i,a){Uj.apply(this,[t,e,n,r,o,i,a]);var l=a.hashLength||e.innerHTML.length,s=a.hashSymbol||"*",u="";Ho(l-1,(function(){u+=s})),Qe(e,u)}k_.RENDERER_TYPE=O_;var R_="time";function E_(t,e,n,r,o,i,a){Uj.apply(this,[t,e,n,r,o,i,a]),e.dir="ltr"}function P_(){Xi(o_),Xi(Fj),Xi(h_),Xi(n_),Xi(C_),Xi(k_),Xi(Uj),Xi(E_)}E_.RENDERER_TYPE=R_;var T_="autocomplete";function j_(t,e){var n=t;null!==n&&void 0!==n||(n=""),this.allowEmpty&&""===n?e(!0):this.strict&&this.source?"function"===typeof this.source?this.source(n,M_(n,e)):M_(n,e)(this.source):e(!0)}function M_(t,e){var n=t;return function(t){for(var r=!1,o=0,i=t.length;o<i;o++)if(n===t[o]){r=!0;break}e(r)}}j_.VALIDATOR_TYPE=T_;n(782);function A_(t){var e=new Date(t);return isNaN(new Date("".concat(t,"T00:00")).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}var I_="date";function x_(t,e){var n=xr(wI,this.instance),r=t,o=!0;null!==r&&void 0!==r||(r="");var i=Xt(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),a=Xt(new Date(r)).isValid()||i;if(this.allowEmpty&&""===r&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(!0===this.correctFormat){var l=__(r,this.dateFormat),s=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(s,u,l,"dateValidator"),o=!0}else o=!1;e(o)}function __(t,e){var n,r=Xt(A_(t)),o=Xt(t,e),i=t.search(/[A-z]/g)>-1;return n=r.isValid()&&r.format("x")===o.format("x")||!o.isValid()||i?r:o,n.format(e)}x_.VALIDATOR_TYPE=I_;var H_="numeric";function N_(t,e){var n=t;null!==n&&void 0!==n||(n=""),this.allowEmpty&&""===n?e(!0):e(""!==n&&xo(t))}N_.VALIDATOR_TYPE=H_;var D_=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],L_="time";function B_(t,e){var n=this.timeFormat||"h:mm:ss a",r=!0,o=t;null===o&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=Xt(o,D_,!0).isValid()?Xt(o):Xt(o,n),l=a.isValid(),s=Xt(o,n,!0).isValid()&&!i;if(this.allowEmpty&&""===o&&(l=!0,s=!0),l||(r=!1),!l&&s&&(r=!0),l&&!s)if(!0===this.correctFormat){var u=a.format(n),c=this.instance.toVisualRow(this.row),f=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,f,u,"timeValidator"),r=!0}else r=!1;e(r)}function V_(){ea(j_),ea(x_),ea(N_),ea(B_)}B_.VALIDATOR_TYPE=L_;var F_="autocomplete",W_={CELL_TYPE:F_,editor:WA,renderer:o_,validator:j_},U_="checkbox",z_={CELL_TYPE:U_,editor:rI,renderer:h_},G_="date",Y_={CELL_TYPE:G_,editor:CI,renderer:o_,validator:x_},K_="dropdown",X_={CELL_TYPE:K_,editor:BI,renderer:o_,validator:j_},$_="handsontable",q_={CELL_TYPE:$_,editor:OA,renderer:o_},Q_="numeric",J_={CELL_TYPE:Q_,editor:tx,renderer:C_,validator:N_,dataType:"number"},Z_="password",tH={CELL_TYPE:Z_,editor:mx,renderer:k_,copyable:!1},eH="time",nH={CELL_TYPE:eH,editor:Zx,renderer:E_,validator:B_};function rH(){uE(W_),uE(z_),uE(Y_),uE(X_),uE(q_),uE(J_),uE(tH),uE(Gj),uE(nH)}n(9859);function oH(t){return oH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oH(t)}function iH(t,e){return cH(t)||uH(t,e)||lH(t,e)||aH()}function aH(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function lH(t,e){if(t){if("string"===typeof t)return sH(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sH(t,e):void 0}}function sH(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function uH(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function cH(t){if(Array.isArray(t))return t}function fH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hH(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pH(r.key),r)}}function dH(t,e,n){return e&&hH(t.prototype,e),n&&hH(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function pH(t){var e=yH(t,"string");return"symbol"===oH(e)?e:String(e)}function yH(t,e){if("object"!==oH(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==oH(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function vH(t,e){mH(t,e),e.add(t)}function mH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gH(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var bH=new Map([["plugin",Li],["cell-type",aE],["editor",Mr],["renderer",Gi],["validator",Ji]]),wH="base",SH=new WeakMap,CH=[],OH=null,kH=new WeakSet,RH=function(){function t(e){var n=this;fH(this,t),vH(this,kH),dt(this,"hot",e,{writable:!1}),SH.set(this,{hooks:{}}),OH=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",(function(){return n.onAfterPluginsInitialized()})),this.hot.addHook("afterUpdateSettings",(function(t){return n.onUpdateSettings(t)})),this.hot.addHook("beforeInit",(function(){return n.init()}))}return dH(t,[{key:"init",value:function(){var t=this;this.pluginName=this.hot.getPluginName(this);var e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){var r=[];if(n.forEach((function(t){var e=t.split(":"),n=iH(e,2),o=n[0],i=n[1];if(!bH.has(o))throw new Error('Unknown plugin dependency type "'.concat(o,'" was found.'));bH.get(o)(i)||r.push(" - ".concat(i," (").concat(o,")"))})),r.length>0){var o=["The ".concat(this.pluginName," plugin requires the following modules:\n"),"".concat(r.join("\n"),"\n")].join("");CH.push(o)}}OH||(OH=Ni()),OH.indexOf("UndoRedo")>=0&&OH.splice(OH.indexOf("UndoRedo"),1),OH.indexOf(this.pluginName)>=0&&OH.splice(OH.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(function(){t.isEnabled&&t.isEnabled()&&t.enablePlugin()}));var i=0===OH.length;if(i){if(CH.length>0){var a=["".concat(CH.join("\n"),"\n"),"You have to import and register them manually."].join("");throw new Error(a)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(t,e){SH.get(this).hooks[t]=SH.get(this).hooks[t]||[];var n=SH.get(this).hooks[t];this.hot.addHook(t,e),n.push(e),SH.get(this).hooks[t]=n}},{key:"removeHooks",value:function(t){var e=this;U(SH.get(this).hooks[t]||[],(function(n){e.hot.removeHook(t,n)}))}},{key:"clearHooks",value:function(){var t=this,e=SH.get(this).hooks;pt(e,(function(e,n){return t.removeHooks(n)})),e.length=0}},{key:"callOnPluginsReady",value:function(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}},{key:"onAfterPluginsInitialized",value:function(){U(this.pluginsInitializedCallbacks,(function(t){return t()})),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(t){var e=gH(this,kH,EH).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var t=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),pt(this,(function(e,n){"hot"!==n&&(t[n]=null)})),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return wH}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),t}();function EH(t){if(!t)return!1;var e=this.constructor.SETTING_KEYS;if("boolean"===typeof e)return e;for(var n=0;n<e.length;n++)if(void 0!==t[e[n]])return!0;return!1}function PH(t){return PH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},PH(t)}function TH(t,e){return xH(t)||IH(t,e)||MH(t,e)||jH()}function jH(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function MH(t,e){if(t){if("string"===typeof t)return AH(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?AH(t,e):void 0}}function AH(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function IH(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function xH(t){if(Array.isArray(t))return t}function _H(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function HH(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,DH(r.key),r)}}function NH(t,e,n){return e&&HH(t.prototype,e),n&&HH(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function DH(t){var e=LH(t,"string");return"symbol"===PH(e)?e:String(e)}function LH(t,e){if("object"!==PH(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==PH(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var BH=function(){function t(e){_H(this,t),this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return NH(t,[{key:"addRow",value:function(t,e){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:t};this.rows.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(t){var e=this.hot.getColHeader(0);if(null!==e&&void 0!==e){var n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}},{key:"addColumn",value:function(t,e){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:t};this.columns.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(t){this.injected||this.injectTable(),U(this.rows,(function(e){t(e.row,hn(e.table)-1)}))}},{key:"getWidths",value:function(t){this.injected||this.injectTable(),U(this.columns,(function(e){var n=e.table.getBoundingClientRect(),r=n.width;t(e.col,Math.ceil(r))}))}},{key:"setSettings",value:function(t){this.settings=t}},{key:"setSetting",value:function(t,e){this.settings||(this.settings={}),this.settings[t]=e}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(t){return this.settings?this.settings[t]:null}},{key:"createColGroupsCol",value:function(){var t=this,e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1)),this.samples.forEach((function(n){U(n.strings,(function(n){e.appendChild(t.createColElement(n.col))}))})),e}},{key:"createRow",value:function(t){var e=this,n=this.hot.rootDocument,r=n.createDocumentFragment(),o=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,o),r.appendChild(o)),this.samples.forEach((function(o){U(o.strings,(function(o){var i=o.col,a=e.hot.getCellMeta(t,i);a.col=i,a.row=t;var l=e.hot.getCellRenderer(a),s=n.createElement("td");s.setAttribute("ghost-table",1),l(e.hot,s,t,i,e.hot.colToProp(i),o.value,a),r.appendChild(s)}))})),r}},{key:"appendColumnHeadersRow",value:function(){var t=this,e=this.hot.rootDocument,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){var o=e.createElement("th");r.push([-1,o]),n.appendChild(o)}this.samples.forEach((function(t){U(t.strings,(function(t){var o=t.col,i=e.createElement("th");r.push([o,i]),n.appendChild(i)}))})),this.table.tHead.appendChild(n),U(r,(function(e){var n=TH(e,2),r=n[0],o=n[1];t.hot.view.appendColHeader(r,o)}))}},{key:"createCol",value:function(t){var e=this,n=this.hot.rootDocument,r=n.createDocumentFragment();return this.samples.forEach((function(o){U(o.strings,(function(o){var i=o.row,a=e.hot.getCellMeta(i,t);a.col=t,a.row=i;var l=e.hot.getCellRenderer(a),s=n.createElement("td"),u=n.createElement("tr");s.setAttribute("ghost-table",1),l(e.hot,s,i,t,e.hot.colToProp(t),o.value,a),u.appendChild(s),r.appendChild(u)}))})),r}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(t){var e=this.hot.rootDocument.createElement("col");return e.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(t),"px"),e}},{key:"createTable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.hot.rootDocument,n=e.createDocumentFragment(),r=e.createElement("table"),o=e.createElement("thead"),i=e.createElement("tbody"),a=e.createElement("colgroup"),l=e.createElement("tr"),s=e.createElement("th");return this.isVertical()&&r.appendChild(a),this.isHorizontal()&&(l.appendChild(s),o.appendChild(l),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&i.appendChild(l),r.appendChild(i),Ge(r,t),n.appendChild(r),{fragment:n,table:r,tHead:o,tBody:i,colGroup:a,tr:l,th:s}}},{key:"createContainer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.hot.rootDocument,n=e.createDocumentFragment(),r=e.createElement("div"),o="htGhostTable htAutoSize ".concat(t.trim());return Ge(r,o),n.appendChild(r),{fragment:n,container:r}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}]),t}(),VH=BH;function FH(t){return FH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FH(t)}function WH(t,e,n){return e=YH(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zH(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,YH(r.key),r)}}function GH(t,e,n){return e&&zH(t.prototype,e),n&&zH(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function YH(t){var e=KH(t,"string");return"symbol"===FH(e)?e:String(e)}function KH(t,e){if("object"!==FH(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==FH(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var XH=function(){function t(e){UH(this,t),this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}return GH(t,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:t.SAMPLE_COUNT}},{key:"setSampleCount",value:function(t){this.customSampleCount=t}},{key:"setAllowDuplicates",value:function(t){this.allowDuplicates=t}},{key:"generateRowSamples",value:function(t,e){return this.generateSamples("row",e,t)}},{key:"generateColumnSamples",value:function(t,e){return this.generateSamples("col",e,t)}},{key:"generateSamples",value:function(t,e,n){var r=this,o=new Map,i="number"===typeof n?{from:n,to:n}:n,a=i.from,l=i.to;return Ho(a,l,(function(n){var i=r.generateSample(t,e,n);o.set(n,i)})),o}},{key:"generateSample",value:function(t,e,n){var r=this;if("row"!==t&&"col"!==t)throw new Error("Unsupported sample type");var o=new Map,i="row"===t?"col":"row",a=[];return Ho(e.from,e.to,(function(e){var l,s="row"===t?r.dataFactory(n,e):r.dataFactory(e,n),u=s.value,c=s.bundleSeed,f="string"===typeof c&&c.length>0;l=f?c:ht(u)?"".concat(Object.keys(u).length):Array.isArray(u)?"".concat(u.length):"".concat(Jt(u).length),o.has(l)||o.set(l,{needed:r.getSampleCount(),strings:[]});var h=o.get(l);if(h.needed){var d=a.indexOf(u)>-1;(!d||r.allowDuplicates||f)&&(h.strings.push(WH({value:u},i,e)),a.push(u),h.needed-=1)}})),o}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),t}(),$H=XH;function qH(t){return qH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qH(t)}function QH(t,e){return nN(t)||eN(t,e)||ZH(t,e)||JH()}function JH(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ZH(t,e){if(t){if("string"===typeof t)return tN(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tN(t,e):void 0}}function tN(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function eN(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function nN(t){if(Array.isArray(t))return t}function rN(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oN(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,aN(r.key),r)}}function iN(t,e,n){return e&&oN(t.prototype,e),n&&oN(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function aN(t){var e=lN(t,"string");return"symbol"===qH(e)?e:String(e)}function lN(t,e){if("object"!==qH(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==qH(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function sN(){return sN="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=uN(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},sN.apply(this,arguments)}function uN(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=vN(t),null===t)break;return t}function cN(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fN(t,e)}function fN(t,e){return fN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},fN(t,e)}function hN(t){var e=yN();return function(){var n,r=vN(t);if(e){var o=vN(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dN(this,n)}}function dN(t,e){if(e&&("object"===qH(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return pN(t)}function pN(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yN(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function vN(t){return vN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vN(t)}mr.getSingleton().register("modifyAutoColumnSizeSeed");var mN="autoColumnSize",gN=10,bN=new WeakMap,wN="autoColumnSize",SN=function(t){cN(n,t);var e=hN(n);function n(t){var r;return rN(this,n),r=e.call(this,t),bN.set(pN(r),{cachedColumnHeaders:[]}),r.ghostTable=new VH(r.hot),r.samplesGenerator=new $H((function(t,e){var n=r.hot.getCellMeta(t,e),o="";n.spanned||(o=r.hot.getDataAtCell(t,e));var i="";return r.hot.hasHook("modifyAutoColumnSizeSeed")&&(i=r.hot.runHooks("modifyAutoColumnSizeSeed",i,n,o)),{value:o,bundleSeed:i}})),r.firstCalculation=!0,r.inProgress=!1,r.measuredColumns=0,r.columnWidthsMap=new ng,r.hot.columnIndexMapper.registerMap(wN,r.columnWidthsMap),r.addHook("beforeColumnResize",(function(t,e,n){return r.onBeforeColumnResize(t,e,n)})),r}return iN(n,[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings()[mN]&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[mN];e&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("beforeChangeRender",(function(e){return t.onBeforeChange(e)})),this.addHook("afterFormulasValuesUpdate",(function(e){return t.onAfterFormulasValuesUpdate(e)})),this.addHook("beforeViewRender",(function(e){return t.onBeforeViewRender(e)})),this.addHook("modifyColWidth",(function(e,n){return t.getColumnWidth(n,e)})),this.addHook("afterInit",(function(){return t.onAfterInit()})),sN(vN(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var t=this.findColumnsWhereHeaderWasChanged();t.length&&(this.clearCache(t),this.calculateVisibleColumnsWidth()),sN(vN(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=this;sN(vN(n.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",(function(e,n,r){return t.onBeforeColumnResize(e,n,r)}))}},{key:"calculateVisibleColumnsWidth",value:function(){var t=this.hot.countRows();if(t){var e=this.hot.renderCall,n=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();-1!==n&&-1!==r&&this.calculateColumnsWidth({from:n,to:r},void 0,e)}}},{key:"calculateColumnsWidth",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"===typeof e?{from:e,to:e}:e,i="number"===typeof n?{from:n,to:n}:n;Ho(o.from,o.to,(function(e){var n=t.hot.toPhysicalColumn(e);if(null===n&&(n=e),r||null===t.columnWidthsMap.getValueAtIndex(n)&&!t.hot._getColWidthFromSettings(n)){var o=t.samplesGenerator.generateColumnSamples(e,i);U(o,(function(e){var n=QH(e,2),r=n[0],o=n[1];return t.ghostTable.addColumn(r,o)}))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((function(){t.ghostTable.getWidths((function(e,n){var r=t.hot.toPhysicalColumn(e);t.columnWidthsMap.setValueAtIndex(r,n)}))}),!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},r=0,o=this.hot.countCols()-1,i=null;this.inProgress=!0;var a=function a(){if(!t.hot)return A(i),void(t.inProgress=!1);t.calculateColumnsWidth({from:r,to:Math.min(r+n.CALCULATION_STEP,o)},e),r=r+n.CALCULATION_STEP+1,r<o?i=P(a):(A(i),t.inProgress=!1,t.hot.view.adjustElementsSize())},l=this.getSyncCalculationLimit();this.firstCalculation&&l>=0&&(this.calculateColumnsWidth({from:0,to:l},e),this.firstCalculation=!1,r=l+1),r<o?a():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings()[mN],e=t&&bt(t,"samplingRatio")?t.samplingRatio:void 0,n=t&&bt(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var t=this.hot.getSettings()[mN],e=n.SYNC_CALCULATION_LIMIT,r=this.hot.countCols()-1;return ht(t)&&(e=t.syncLimit,Ce(e)?e=Do(r,e):e>>=0),Math.min(e,r)}},{key:"getColumnWidth",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e;return void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),n&&"number"===typeof r&&(r=Math.max(r,my.DEFAULT_WIDTH))),r}},{key:"getFirstVisibleColumn",value:function(){var t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){var e=t.wtTable.getFirstVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){var n=t.wtTable.getFirstRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"getLastVisibleColumn",value:function(){var t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){var e=t.wtTable.getLastVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){var n=t.wtTable.getLastRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var t=this.hot.getColHeader(),e=bN.get(this),n=e.cachedColumnHeaders,r=V(t,(function(t,e,r){var o=n.length;return(o-1<r||n[r]!==e)&&t.push(r),o-1<r?n.push(e):n[r]=e,t}),[]);return r}},{key:"clearCache",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length?this.hot.batchExecution((function(){U(e,(function(e){t.columnWidthsMap.setValueAtIndex(e,null)}))}),!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!F(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(function(t){return null===t})).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout((function(){t.hot&&t.recalculateAllColumnsWidth()}),0)}},{key:"onBeforeChange",value:function(t){var e=this,n=W(t,(function(t){var n=QH(t,2),r=n[1];return e.hot.toPhysicalColumn(e.hot.propToCol(r))}));this.clearCache(Array.from(new Set(n)))}},{key:"onBeforeColumnResize",value:function(t,e,n){var r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}},{key:"onAfterInit",value:function(){bN.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(t){var e=F(t,(function(t){var e;return Zt(null===(e=t.address)||void 0===e?void 0:e.col)})),n=W(e,(function(t){return t.address.col}));this.clearCache(Array.from(new Set(n)))}},{key:"destroy",value:function(){this.ghostTable.clean(),sN(vN(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return mN}},{key:"PLUGIN_PRIORITY",get:function(){return gN}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),n}(RH),CN={horizontal:"horizontal",vertical:"vertical"};function ON(t,e,n){var r,o,i;return e[0]===t[0]&&e[1]<t[1]?(i="left",r=n(e[0],e[1]),o=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(i="right",r=n(e[0],t[3]+1),o=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(i="up",r=n(e[0],e[1]),o=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(i="down",r=n(t[2]+1,e[1]),o=n(e[2],e[3])),r&&r.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:r,endOfDragCoords:o}}function kN(t){var e={};return!0===t?(e.directions=Object.keys(CN),e.autoInsertRow=!0):ht(t)?(Zt(t.autoInsertRow)?t.direction===CN.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Zt(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(CN)):"string"===typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function RN(t){return RN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},RN(t)}function EN(t){return jN(t)||TN(t)||IN(t)||PN()}function PN(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function TN(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function jN(t){if(Array.isArray(t))return xN(t)}function MN(t,e){return HN(t)||_N(t,e)||IN(t,e)||AN()}function AN(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function IN(t,e){if(t){if("string"===typeof t)return xN(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xN(t,e):void 0}}function xN(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _N(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function HN(t){if(Array.isArray(t))return t}function NN(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function DN(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,BN(r.key),r)}}function LN(t,e,n){return e&&DN(t.prototype,e),n&&DN(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function BN(t){var e=VN(t,"string");return"symbol"===RN(e)?e:String(e)}function VN(t,e){if("object"!==RN(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==RN(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function FN(){return FN="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=WN(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},FN.apply(this,arguments)}function WN(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=$N(t),null===t)break;return t}function UN(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zN(t,e)}function zN(t,e){return zN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},zN(t,e)}function GN(t){var e=XN();return function(){var n,r=$N(t);if(e){var o=$N(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return YN(this,n)}}function YN(t,e){if(e&&("object"===RN(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return KN(t)}function KN(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function XN(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function $N(t){return $N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$N(t)}mr.getSingleton().register("modifyAutofillRange"),mr.getSingleton().register("beforeAutofill"),mr.getSingleton().register("afterAutofill");var qN="autofill",QN=20,JN=["fillHandle"],ZN="insert_row_below",tD=200,eD=function(t){UN(n,t);var e=GN(n);function n(t){var r;return NN(this,n),r=e.call(this,t),r.eventManager=new Gr(KN(r)),r.addingStarted=!1,r.mouseDownOnCellCorner=!1,r.mouseDragOutside=!1,r.handleDraggedCells=0,r.directions=[],r.autoInsertRow=!1,r}return LN(n,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(function(e){return t.onAfterCellCornerMouseDown(e)})),this.addHook("afterOnCellCornerDblClick",(function(e){return t.onCellCornerDblClick(e)})),this.addHook("beforeOnCellMouseOver",(function(e,n){return t.onBeforeCellMouseOver(n)})),FN($N(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),FN($N(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),FN($N(n.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var t=this,e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner(),r=n.row,o=n.col,i=e.getBottomEndCorner(),a=i.row,l=i.col,s=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:o,endRow:a,endCol:l}]),u=[],c=[],f=[];return U(s,(function(t){for(var e=t.startRow;e<=t.endRow;e+=1)-1===u.indexOf(e)&&u.push(e);for(var n=t.startCol;n<=t.endCol;n+=1)-1===c.indexOf(n)&&c.push(n)})),U(u,(function(e){var n=[];U(c,(function(r){n.push(t.hot.getCopyableData(e,r))})),f.push(n)})),f}},{key:"fillIn",value:function(){var t=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var e=this.hot.selection.highlight.getFill().getVisualCorners(),n=MN(e,4),r=n[0],o=n[1],i=n[2],a=n[3],l=this.hot.getSelectedRangeLast(),s=l.getTopStartCorner(),u=l.getBottomEndCorner();this.resetSelectionOfDraggedArea();var c=[s.row,s.col,u.row,u.col],f=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,r),Math.min(s.col,o),Math.max(u.row,i),Math.max(u.col,a)],c),h=ON(c,f,(function(e,n){return t.hot._createCellCoords(e,n)})),d=h.directionOfDrag,p=h.startOfDragCoords,y=h.endOfDragCoords;if(p&&p.row>-1&&p.col>-1){var v=this.getSelectionData(),m=l.clone(),g=this.hot._createCellRange(p,p,y),b=this.hot.runHooks("beforeAutofill",v,m,g,d);if(!1===b)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var w=b,S=b;if(["up","left"].indexOf(d)>-1&&(1!==S.length||0!==S[0].length))if(w=[],"up"===d)for(var C=y.row-p.row+1,O=C%S.length,k=0;k<C;k++)w.push(S[(k+(S.length-O))%S.length]);else for(var R=y.col-p.col+1,E=R%S[0].length,P=0;P<S.length;P++){w.push([]);for(var T=0;T<R;T++)w[P].push(S[P][(T+(S[P].length-E))%S[P].length])}this.hot.populateFromArray(p.row,p.col,w,y.row,y.col,"".concat(this.pluginName,".fill"),null),this.setSelection(f),this.hot.runHooks("afterAutofill",w,m,g,d),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}},{key:"getCoordsOfDragAndDropBorders",value:function(t){var e=this.hot.getSelectedRangeLast(),n=e.getBottomEndCorner(),r=t;if(this.directions.includes(CN.vertical)&&this.directions.includes(CN.horizontal)){var o=e.getTopStartCorner();(n.col<=t.col||o.col>=t.col)&&(r=this.hot._createCellCoords(n.row,t.col)),(n.row<t.row||o.row>t.row)&&(r=this.hot._createCellCoords(t.row,n.col))}else if(this.directions.includes(CN.vertical))r=this.hot._createCellCoords(t.row,n.col);else{if(!this.directions.includes(CN.horizontal))return;r=this.hot._createCellCoords(n.row,t.col)}return this.reduceSelectionAreaIfNeeded(r)}},{key:"showBorder",value:function(t){var e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}},{key:"addRow",value:function(){var t=this;this.hot._registerTimeout((function(){t.hot.alter(ZN,void 0,1,"".concat(t.pluginName,".fill")),t.addingStarted=!1}),tD)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){var t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();t[2]<n-1&&e[2]===n-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(t){for(var e,n=this.hot.getData(),r=this.hot.countRows(),o=t[2]+1;o<r;o++){for(var i=t[1];i<=t[3];i++){var a=n[o][i];if(a)return-1}var l=n[o][t[1]-1],s=n[o][t[3]+1];(l||s)&&(e=o)}return e}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}},{key:"setSelection",value:function(t){var e;(e=this.hot).selectCell.apply(e,EN(W(t,(function(t){return Math.max(t,0)}))).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(t){var e=this.hot.rootDocument.documentElement,n=tn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+hn(this.hot.table),r=tn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+fn(this.hot.table);return t.clientY>n&&t.clientX<=r}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()})),this.eventManager.addEventListener(e,"mousemove",(function(e){return t.onMouseMove(e)}))}},{key:"onCellCornerDblClick",value:function(){var t=this.selectAdjacent();t&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(t){var e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var t=kN(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}},{key:"destroy",value:function(){FN($N(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return qN}},{key:"PLUGIN_PRIORITY",get:function(){return QN}},{key:"SETTING_KEYS",get:function(){return[qN].concat(JN)}}]),n}(RH);function nD(t){return nD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nD(t)}function rD(t,e){return sD(t)||lD(t,e)||iD(t,e)||oD()}function oD(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function iD(t,e){if(t){if("string"===typeof t)return aD(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?aD(t,e):void 0}}function aD(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function lD(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function sD(t){if(Array.isArray(t))return t}function uD(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cD(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,hD(r.key),r)}}function fD(t,e,n){return e&&cD(t.prototype,e),n&&cD(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function hD(t){var e=dD(t,"string");return"symbol"===nD(e)?e:String(e)}function dD(t,e){if("object"!==nD(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==nD(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function pD(){return pD="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=yD(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},pD.apply(this,arguments)}function yD(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=CD(t),null===t)break;return t}function vD(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mD(t,e)}function mD(t,e){return mD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},mD(t,e)}function gD(t){var e=SD();return function(){var n,r=CD(t);if(e){var o=CD(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return bD(this,n)}}function bD(t,e){if(e&&("object"===nD(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return wD(t)}function wD(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function SD(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function CD(t){return CD=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},CD(t)}var OD="autoRowSize",kD=40,RD="autoRowSize",ED=function(t){vD(n,t);var e=gD(n);function n(t){var r;return uD(this,n),r=e.call(this,t),r.rowHeightsMap=void 0,r.headerHeight=null,r.ghostTable=new VH(r.hot),r.samplesGenerator=new $H((function(t,e){var n;return t>=0?n=r.hot.getDataAtCell(t,e):-1===t&&(n=r.hot.getColHeader(e)),{value:n}})),r.firstCalculation=!0,r.inProgress=!1,r.measuredRows=0,r.rowHeightsMap=new ng,r.hot.rowIndexMapper.registerMap(RD,r.rowHeightsMap),r.addHook("beforeRowResize",(function(t,e,n){return r.onBeforeRowResize(t,e,n)})),r}return fD(n,[{key:"isEnabled",value:function(){var t=this.hot.getSettings()[OD];return!0===t||ht(t)}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("beforeChangeRender",(function(e){return t.onBeforeChange(e)})),this.addHook("beforeColumnResize",(function(){return t.recalculateAllRowsHeight()})),this.addHook("beforeViewRender",(function(e){return t.onBeforeViewRender(e)})),this.addHook("modifyRowHeight",(function(e,n){return t.getRowHeight(n,e)})),this.addHook("modifyColumnHeaderHeight",(function(){return t.getColumnHeaderHeight()})),pD(CD(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=this;this.headerHeight=null,pD(CD(n.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",(function(e,n,r){return t.onBeforeRowResize(e,n,r)}))}},{key:"calculateRowsHeight",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="number"===typeof e?{from:e,to:e}:e,i="number"===typeof n?{from:n,to:n}:n;if(null!==this.hot.getColHeader(0)){var a=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(a.get(-1))}Ho(o.from,o.to,(function(e){if(r||null===t.rowHeightsMap.getValueAtIndex(e)){var n=t.samplesGenerator.generateRowSamples(e,i);U(n,(function(e){var n=rD(e,2),r=n[0],o=n[1];return t.ghostTable.addRow(r,o)}))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((function(){t.ghostTable.getHeights((function(e,n){e<0?t.headerHeight=n:t.rowHeightsMap.setValueAtIndex(t.hot.toPhysicalRow(e),n)}))}),!0),this.measuredRows=o.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},r=0,o=this.hot.countRows()-1,i=null;this.inProgress=!0;var a=function a(){if(!t.hot)return A(i),void(t.inProgress=!1);t.calculateRowsHeight({from:r,to:Math.min(r+n.CALCULATION_STEP,o)},e),r=r+n.CALCULATION_STEP+1,r<o?i=P(a):(A(i),t.inProgress=!1,t.hot.view.adjustElementsSize(!0),t.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&t.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},l=this.getSyncCalculationLimit();this.firstCalculation&&l>=0&&(this.calculateRowsHeight({from:0,to:l},e),this.firstCalculation=!1,r=l+1),r<o?a():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var t=this.hot.getSettings()[OD],e=t&&bt(t,"samplingRatio")?t.samplingRatio:void 0,n=t&&bt(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllRowsHeight",value:function(){Ze(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var t=this.hot.getSettings()[OD],e=n.SYNC_CALCULATION_LIMIT,r=this.hot.countRows()-1;return ht(t)&&(e=t.syncLimit,Ce(e)?e=Do(r,e):e>>=0),Math.min(e,r)}},{key:"getRowHeight",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t)),r=e;return null!==n&&n>(e||0)&&(r=n),r}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(t){var e=this,n="number"===typeof t?{from:t,to:t}:t,r=n.from,o=n.to;this.hot.batchExecution((function(){Ho(Math.min(r,o),Math.max(r,o),(function(t){e.rowHeightsMap.setValueAtIndex(t,null)}))}),!0)}},{key:"isNeedRecalculate",value:function(){return!!F(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(function(t){return null===t})).length}},{key:"onBeforeViewRender",value:function(){var t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(-1!==n&&-1!==r){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){var o=this.hot.countRows()-1;this.calculateRowsHeight({from:o-e,to:o})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(t,e){this.clearCacheByRange({from:t,to:e}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(t,e,n){var r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}},{key:"onAfterLoadData",value:function(){var t=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout((function(){t.hot&&t.recalculateAllRowsHeight()}),0)}},{key:"onBeforeChange",value:function(t){var e=null;1===t.length?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}},{key:"destroy",value:function(){this.ghostTable.clean(),pD(CD(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return OD}},{key:"PLUGIN_PRIORITY",get:function(){return kD}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),n}(RH),PD=new Map([["indexesSequence",{getListWithInsertedItems:dm,getListWithRemovedItems:pm}],["physicallyIndexed",{getListWithInsertedItems:Bm,getListWithRemovedItems:Vm}]]),TD=function(t){if(!1===PD.has(t))throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return PD.get(t)};function jD(t){return jD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jD(t)}function MD(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AD(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,xD(r.key),r)}}function ID(t,e,n){return e&&AD(t.prototype,e),n&&AD(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function xD(t){var e=_D(t,"string");return"symbol"===jD(e)?e:String(e)}function _D(t,e){if("object"!==jD(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==jD(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function HD(){return HD="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=ND(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},HD.apply(this,arguments)}function ND(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=UD(t),null===t)break;return t}function DD(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&LD(t,e)}function LD(t,e){return LD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},LD(t,e)}function BD(t){var e=WD();return function(){var n,r=UD(t);if(e){var o=UD(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return VD(this,n)}}function VD(t,e){if(e&&("object"===jD(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return FD(t)}function FD(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function WD(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function UD(t){return UD=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},UD(t)}var zD=TD("physicallyIndexed"),GD=zD.getListWithInsertedItems,YD=zD.getListWithRemovedItems,KD=function(t){DD(n,t);var e=BD(n);function n(){return MD(this,n),e.call(this,(function(t){return t}))}return ID(n,[{key:"insert",value:function(t,e){var r=vm(this.indexedValues,e);this.indexedValues=GD(r,t,e,this.initValueOrFn),HD(UD(n.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){var e=YD(this.indexedValues,t);this.indexedValues=ym(e,t),HD(UD(n.prototype),"remove",this).call(this,t)}}]),n}(am),XD=KD;function $D(t){return $D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$D(t)}function qD(t){return tL(t)||ZD(t)||JD(t)||QD()}function QD(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function JD(t,e){if(t){if("string"===typeof t)return eL(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eL(t,e):void 0}}function ZD(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function tL(t){if(Array.isArray(t))return eL(t)}function eL(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function nL(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rL(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,iL(r.key),r)}}function oL(t,e,n){return e&&rL(t.prototype,e),n&&rL(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function iL(t){var e=aL(t,"string");return"symbol"===$D(e)?e:String(e)}function aL(t,e){if("object"!==$D(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==$D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function lL(){return lL="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=sL(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},lL.apply(this,arguments)}function sL(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=yL(t),null===t)break;return t}function uL(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cL(t,e)}function cL(t,e){return cL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},cL(t,e)}function fL(t){var e=pL();return function(){var n,r=yL(t);if(e){var o=yL(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hL(this,n)}}function hL(t,e){if(e&&("object"===$D(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return dL(t)}function dL(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pL(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function yL(t){return yL=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yL(t)}var vL=TD("physicallyIndexed"),mL=vL.getListWithInsertedItems,gL=vL.getListWithRemovedItems,bL=function(t){uL(n,t);var e=fL(n);function n(){return nL(this,n),e.call(this,(function(t){return t}))}return oL(n,[{key:"insert",value:function(t,e){var r=this;this.indexedValues=mL(this.indexedValues,t,e,(function(t,e){return r.getNextValue(e)})),lL(yL(n.prototype),"insert",this).call(this,t,e)}},{key:"remove",value:function(t){this.indexedValues=gL(this.indexedValues,t),lL(yL(n.prototype),"remove",this).call(this,t)}},{key:"getNextValue",value:function(t){return Math.max.apply(Math,qD(this.getValues()))+1+t}}]),n}(am),wL=bL;function SL(t){return SL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},SL(t)}function CL(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OL(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,RL(r.key),r)}}function kL(t,e,n){return e&&OL(t.prototype,e),n&&OL(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function RL(t){var e=EL(t,"string");return"symbol"===SL(e)?e:String(e)}function EL(t,e){if("object"!==SL(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==SL(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function PL(){return PL="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=TL(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},PL.apply(this,arguments)}function TL(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=HL(t),null===t)break;return t}function jL(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ML(t,e)}function ML(t,e){return ML=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ML(t,e)}function AL(t){var e=_L();return function(){var n,r=HL(t);if(e){var o=HL(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return IL(this,n)}}function IL(t,e){if(e&&("object"===SL(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return xL(t)}function xL(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _L(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function HL(t){return HL=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},HL(t)}var NL="bindRowsWithHeaders",DL=210,LL="loose",BL=new Map([["loose",XD],["strict",wL]]),VL=function(t){jL(n,t);var e=AL(n);function n(t){var r;return CL(this,n),r=e.call(this,t),r.headerIndexes=null,r}return kL(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[NL]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[NL];"string"!==typeof e&&(e=LL);var r=BL.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new r),this.addHook("modifyRowHeader",(function(e){return t.onModifyRowHeader(e)})),PL(HL(n.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),PL(HL(n.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}},{key:"destroy",value:function(){PL(HL(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return NL}},{key:"PLUGIN_PRIORITY",get:function(){return DL}}]),n}(RH);function FL(t){return FL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FL(t)}function WL(t){return YL(t)||GL(t)||zL(t)||UL()}function UL(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function zL(t,e){if(t){if("string"===typeof t)return KL(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?KL(t,e):void 0}}function GL(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function YL(t){if(Array.isArray(t))return KL(t)}function KL(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function XL(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $L(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,uB(r.key),r)}}function qL(t,e,n){return e&&$L(t.prototype,e),n&&$L(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function QL(){return QL="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=JL(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},QL.apply(this,arguments)}function JL(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=iB(t),null===t)break;return t}function ZL(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tB(t,e)}function tB(t,e){return tB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},tB(t,e)}function eB(t){var e=oB();return function(){var n,r=iB(t);if(e){var o=iB(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nB(this,n)}}function nB(t,e){if(e&&("object"===FL(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return rB(t)}function rB(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oB(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function iB(t){return iB=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},iB(t)}function aB(t,e,n){lB(t,e),e.set(t,n)}function lB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sB(t,e,n){return e=uB(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uB(t){var e=cB(t,"string");return"symbol"===FL(e)?e:String(e)}function cB(t,e){if("object"!==FL(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==FL(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function fB(t,e){var n=pB(t,e,"get");return hB(t,n)}function hB(t,e){return e.get?e.get.call(t):e.value}function dB(t,e,n){var r=pB(t,e,"set");return yB(t,r,n),n}function pB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function yB(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var vB="collapsibleColumns",mB=290,gB=["nestedHeaders"],bB="collapsibleIndicator",wB=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),SB=new WeakMap,CB=function(t){ZL(n,t);var e=eB(n);function n(){var t;XL(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),sB(rB(t),"nestedHeadersPlugin",null),sB(rB(t),"eventManager",new Gr(rB(t))),sB(rB(t),"headerStateManager",null),aB(rB(t),SB,{writable:!0,value:null}),t}return qL(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[vB]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings(),r=e.nestedHeaders;r||er("You need to configure the Nested Headers plugin in order to use collapsible headers."),dB(this,SB,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(function(){return t.onInit()})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("afterGetColHeader",(function(){return t.onAfterGetColHeader.apply(t,arguments)})),this.addHook("beforeOnCellMouseDown",(function(e,n,r){return t.onBeforeOnCellMouseDown(e,n,r)})),QL(iB(n.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var t=this.hot.getSettings(),e=t.collapsibleColumns;"boolean"===typeof e?this.headerStateManager.mapState((function(t){return{collapsible:t.origColspan>1}})):Array.isArray(e)&&(this.headerStateManager.mapState((function(){return{collapsible:!1}})),this.headerStateManager.mergeStateWith(e))}QL(iB(n.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),dB(this,SB,null),this.nestedHeadersPlugin=null,this.clearButtons(),QL(iB(n.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var t=this.hot.view._wt.getSetting("columnHeaders").length,e=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(t){t&&t.parentNode.removeChild(t)};Ho(0,t-1,(function(t){var i=e.childNodes[t],a=n.childNodes[t],l=r?r.childNodes[t]:null;Ho(0,i.childNodes.length-1,(function(t){var e=i.childNodes[t].querySelector(".".concat(bB));o(e),a&&a.childNodes[t]&&(e=a.childNodes[t].querySelector(".".concat(bB)),o(e)),r&&l&&l.childNodes[t]&&(e=l.childNodes[t].querySelector(".".concat(bB)),o(e))}))}),!0)}}},{key:"expandSection",value:function(t){this.toggleCollapsibleSection([t],"expand")}},{key:"collapseSection",value:function(t){this.toggleCollapsibleSection([t],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(t){var e=this,n=this.headerStateManager.mapNodes((function(n){var r=n.collapsible,o=n.origColspan,i=n.headerLevel,a=n.columnIndex,l=n.isCollapsed;if(!0===r&&o>1&&(l&&"expand"===t||!l&&"collapse"===t))return{row:e.headerStateManager.levelToRowCoords(i),col:a}}));this.toggleCollapsibleSection(n,t)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(t,e){var n=this;if(!wB.has(e))throw new Error("Unsupported action is passed (".concat(e,")."));if(Array.isArray(t)){var r=F(t,(function(t){var e=t.row;return e<0})),o=r.length>0;U(r,(function(t){var r,i=t.row,a=t.col,l=null!==(r=n.headerStateManager.getHeaderSettings(i,a))&&void 0!==r?r:{},s=l.collapsible,u=l.isCollapsed;if(!s||u&&"collapse"===e||!u&&"expand"===e)return o=!1,!1}));var i=[],a=[];o&&U(r,(function(t){var r=t.row,o=t.col,l=n.headerStateManager.triggerNodeModification(e,r,o),s=l.colspanCompensation,u=l.affectedColumns,c=l.rollbackModification;s>0&&(a.push.apply(a,WL(u)),i.push(c))}));var l=this.getCollapsedColumns(),s=[];"collapse"===e?s=$([].concat(WL(l),a)):"expand"===e&&(s=F(l,(function(t){return!a.includes(t)})));var u=wB.get(e),c=this.hot.runHooks(u.beforeHook,l,s,o);if(!1!==c){this.hot.batchExecution((function(){U(a,(function(t){fB(n,SB).setValueAtIndex(n.hot.toPhysicalColumn(t),u.hideColumn)}))}),!0);var f=this.getCollapsedColumns().length!==l.length;this.hot.runHooks(u.afterHook,l,s,o,f),this.hot.render(),this.hot.view.adjustElementsSize(!0)}else U(i,(function(t){t()}))}}},{key:"getCollapsedColumns",value:function(){return fB(this,SB).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(t,e,n){var r,o,i=null!==(r=this.headerStateManager.getHeaderSettings(n,t))&&void 0!==r?r:{},a=i.collapsible,l=i.origColspan,s=i.isCollapsed,u=a&&l>1&&t>=this.hot.getSettings().fixedColumnsStart,c=e.querySelector(".".concat(bB));u?(c||(c=this.hot.rootDocument.createElement("div"),Ge(c,bB),e.querySelector("div:first-child").appendChild(c)),Ye(c,["collapsed","expanded"]),s?(Ge(c,"collapsed"),Je(c,"+")):(Ge(c,"expanded"),Je(c,"-"))):null===(o=c)||void 0===o||o.remove()}},{key:"onBeforeOnCellMouseDown",value:function(t,e){ze(t.target,bB)&&(ze(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ze(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Qn(t))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(t,e){e||this.updatePlugin()}},{key:"destroy",value:function(){dB(this,SB,null),QL(iB(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return vB}},{key:"PLUGIN_PRIORITY",get:function(){return mB}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[vB].concat(gB)}}]),n}(RH);function OB(t){return OB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OB(t)}function kB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function RB(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?kB(Object(n),!0).forEach((function(e){EB(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kB(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function EB(t,e,n){return e=NB(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PB(t,e){return IB(t)||AB(t,e)||jB(t,e)||TB()}function TB(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function jB(t,e){if(t){if("string"===typeof t)return MB(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?MB(t,e):void 0}}function MB(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function AB(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function IB(t){if(Array.isArray(t))return t}function xB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _B(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,NB(r.key),r)}}function HB(t,e,n){return e&&_B(t.prototype,e),n&&_B(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function NB(t){var e=DB(t,"string");return"symbol"===OB(e)?e:String(e)}function DB(t,e){if("object"!==OB(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==OB(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var LB=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],BB=!1,VB=!0,FB=!0,WB=function(){function t(e,n){xB(this,t),this.hot=e,this.sortingStates=new Bg,this.sortEmptyCells=BB,this.indicator=VB,this.headerAction=FB,this.compareFunctionFactory=void 0,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}return HB(t,[{key:"updateAllColumnsProperties",value:function(t){var e=this;ht(t)&&pt(t,(function(t,n){LB.includes(n)&&(e[n]=t)}))}},{key:"getAllColumnsProperties",value:function(){var t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"===typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}},{key:"getSortOrderOfColumn",value:function(t){var e;return null===(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))||void 0===e?void 0:e.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex((function(e){var n=PB(e,1),r=n[0];return r===t}))}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return 0===this.getNumberOfSortedColumns()}},{key:"isColumnSorted",value:function(t){return ht(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))}},{key:"getSortStates",value:function(){var t=this;if(null===this.sortingStates)return[];var e=this.sortingStates.getEntries();return e.map((function(e){var n=PB(e,2),r=n[0],o=n[1];return RB({column:t.hot.toVisualColumn(r)},o)}))}},{key:"getColumnSortState",value:function(t){var e=this.getSortOrderOfColumn(t);if(Zt(e))return{column:t,sortOrder:e}}},{key:"setSortStates",value:function(t){this.sortingStates.clear();for(var e=0;e<t.length;e+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[e].column),{sortOrder:t[e].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),t}(),UB="asc",zB="desc",GB="colHeader";function YB(t){if(!1===ht(t))return!1;var e=t.column,n=t.sortOrder;return Number.isInteger(e)&&[UB,zB].includes(n)}function KB(t){if(t.some((function(t){return!1===YB(t)})))return!1;var e=t.map((function(t){var e=t.column;return e}));return new Set(e).size===e.length}function XB(t){if(t!==zB)return t===UB?zB:UB}function $B(t){var e=t.querySelector(".".concat(GB));return e}function qB(t,e){if(t<0||!e.parentNode)return!1;var n=e.parentNode.parentNode.childNodes,r=Array.from(n).indexOf(e.parentNode)-n.length;return-1===r}function QB(t,e,n){return-1===t&&e>=0&&!1===Zn(n)}var JB="ascending",ZB="descending",tV="indicatorDisabled",eV="columnSorting",nV="sortAction",rV=new Map([[UB,JB],[zB,ZB]]);function oV(t,e,n,r){var o=[eV];if(r&&o.push(nV),!1===n)return o.push(tV),o;var i=t.getSortOrderOfColumn(e);return Zt(i)&&o.push(rV.get(i)),o}function iV(){return Array.from(rV.values()).concat(nV,tV,eV)}var aV=0,lV=-1,sV=1;function uV(t,e){for(var n=kV(e),r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];t.sort(n.apply(void 0,o))}function cV(t,e,n){var r=e.locale;return function(e,o){var i=n.sortEmptyCells;return"string"===typeof e&&(e=e.toLocaleLowerCase(r)),"string"===typeof o&&(o=o.toLocaleLowerCase(r)),e===o?aV:ee(e)?ee(o)?aV:i&&"asc"===t?lV:sV:ee(o)?i&&"asc"===t?sV:lV:isNaN(e)&&!isNaN(o)?"asc"===t?sV:lV:!isNaN(e)&&isNaN(o)?"asc"===t?lV:sV:(isNaN(e)||isNaN(o)||(e=parseFloat(e),o=parseFloat(o)),e<o?"asc"===t?lV:sV:e>o?"asc"===t?sV:lV:aV)}}var fV="default";function hV(t,e,n){return function(e,r){var o=parseFloat(e),i=parseFloat(r),a=n.sortEmptyCells;if(o===i||isNaN(o)&&isNaN(i))return aV;if(a){if(ee(e))return"asc"===t?lV:sV;if(ee(r))return"asc"===t?sV:lV}return isNaN(o)?sV:isNaN(i)?lV:o<i?"asc"===t?lV:sV:o>i?"asc"===t?sV:lV:aV}}var dV="numeric";function pV(t,e,n){var r=e.checkedTemplate,o=e.uncheckedTemplate,i=n.sortEmptyCells;return function(a,l){var s=ee(a),u=ee(l),c=s?o:a,f=u?o:l,h=c===o||c===r,d=f===o||f===r;if(!1===i){if(s&&!1===u)return sV;if(!1===s&&u)return lV}return!1===h&&d?"asc"===t?lV:sV:h&&!1===d?"asc"===t?sV:lV:!1===h&&!1===d?cV(t,e,n)(a,l):c===o&&f===r?"asc"===t?lV:sV:c===r&&f===o?"asc"===t?sV:lV:aV}}var yV="checkbox";function vV(t,e,n){return function(r,o){var i=n.sortEmptyCells;if(r===o)return aV;if(ee(r))return ee(o)?aV:i&&"asc"===t?lV:sV;if(ee(o))return i&&"asc"===t?sV:lV;var a=e.dateFormat,l=Xt(r,a),s=Xt(o,a);return l.isValid()?s.isValid()?s.isAfter(l)?"asc"===t?lV:sV:s.isBefore(l)?"asc"===t?sV:lV:aV:lV:sV}}var mV="date",gV=Rr("sorting.compareFunctionFactory"),bV=gV.register,wV=gV.getItem,SV=gV.hasItem,CV=Rr("sorting.mainSortComparator"),OV=CV.register,kV=CV.getItem;function RV(t){return SV(t)?wV(t):wV(fV)}function EV(t){return AV(t)||MV(t)||TV(t)||PV()}function PV(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function TV(t,e){if(t){if("string"===typeof t)return jV(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jV(t,e):void 0}}function jV(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function MV(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function AV(t){if(Array.isArray(t))return t}function IV(t,e){return function(n,r){var o=EV(n),i=o.slice(1),a=EV(r),l=a.slice(1);return function(n){var r=t[n],o=e[n],a=i[n],s=l[n],u=o.columnSorting,c=u.compareFunctionFactory?u.compareFunctionFactory:RV(o.type),f=c(r,o,u)(a,s);return f}(0)}}function xV(t){return xV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xV(t)}bV(dV,hV),bV(yV,pV),bV(mV,vV),bV(fV,cV);var _V=["column"],HV=["column"];function NV(t){return VV(t)||BV(t)||LV(t)||DV()}function DV(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function LV(t,e){if(t){if("string"===typeof t)return FV(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?FV(t,e):void 0}}function BV(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function VV(t){if(Array.isArray(t))return FV(t)}function FV(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function WV(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function UV(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?WV(Object(n),!0).forEach((function(e){zV(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):WV(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function zV(t,e,n){return e=qV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GV(t,e){if(null==t)return{};var n,r,o=YV(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function YV(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function KV(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function XV(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qV(r.key),r)}}function $V(t,e,n){return e&&XV(t.prototype,e),n&&XV(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function qV(t){var e=QV(t,"string");return"symbol"===xV(e)?e:String(e)}function QV(t,e){if("object"!==xV(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==xV(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function JV(){return JV="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=ZV(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},JV.apply(this,arguments)}function ZV(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=aF(t),null===t)break;return t}function tF(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eF(t,e)}function eF(t,e){return eF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},eF(t,e)}function nF(t){var e=iF();return function(){var n,r=aF(t);if(e){var o=aF(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rF(this,n)}}function rF(t,e){if(e&&("object"===xV(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return oF(t)}function oF(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function iF(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function aF(t){return aF=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},aF(t)}var lF="columnSorting",sF=50,uF="append",cF="replace";OV(lF,IV),mr.getSingleton().register("beforeColumnSort"),mr.getSingleton().register("afterColumnSort");var fF=function(t){tF(n,t);var e=nF(n);function n(t){var r;return KV(this,n),r=e.call(this,t),r.columnStatesManager=null,r.columnMetaCache=null,r.pluginKey=lF,r.indexesSequenceCache=null,r}return $V(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.columnStatesManager=new WB(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new ng((function(e){var n=t.hot.toVisualColumn(e);return null===n&&(n=e),t.getMergedPluginSettings(n)})),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",(function(e,n){return t.onAfterGetColHeader(e,n)})),this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)})),this.addHook("afterOnCellMouseDown",(function(e,n){return t.onAfterOnCellMouseDown(e,n)})),this.addHook("afterInit",(function(){return t.loadOrSortBySettings()})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.hot.view&&this.loadOrSortBySettings(),JV(aF(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=this,e=function(e,n){var r=$B(n);!1!==qB(e,n)&&null!==r&&t.updateHeaderClasses(r)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",(function(){t.hot.removeHook("afterGetColHeader",e)})),this.hot.batchExecution((function(){null!==t.indexesSequenceCache&&(t.hot.rowIndexMapper.setIndexesSequence(t.indexesSequenceCache.getValues()),t.hot.rowIndexMapper.unregisterMap(t.pluginKey))}),!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,JV(aF(n.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(t){var e=this.getSortConfig(),n=this.getNormalizedSortConfigs(t),r=this.areValidSortConfigs(n),o=this.hot.runHooks("beforeColumnSort",e,n,r);!1!==o&&(0===e.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Im),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",e,r?n:e,r),r&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(t){return Zt(t)?this.columnStatesManager.getColumnSortState(t):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(t){var e=this.getNormalizedSortConfigs(t);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}},{key:"getNormalizedSortConfigs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t]}},{key:"areValidSortConfigs",value:function(t){var e=this.hot.countCols();return KB(t)&&t.every((function(t){var n=t.column;return n<=e&&n>=0}))}},{key:"saveAllSortSettings",value:function(t){var e=this,n=this.columnStatesManager.getAllColumnsProperties(),r=function(t){var n=t.column,r=GV(t,_V);return UV({column:e.hot.toPhysicalColumn(n)},r)};n.initialConfig=W(t,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}},{key:"getAllSavedSortSettings",value:function(){var t=this,e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);var n=e.value,r=function(e){var n=e.column,r=GV(e,HV);return UV({column:t.hot.toVisualColumn(n)},r)};return Zt(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=W(n.initialConfig,r)),n}},{key:"getColumnNextConfig",value:function(t){var e=this.columnStatesManager.getSortOrderOfColumn(t);if(Zt(e)){var n=XB(e);return Zt(n)?{column:t,sortOrder:n}:void 0}var r=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<r)return{column:t,sortOrder:XB()}}},{key:"getNextSortConfig",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uF,n=this.columnStatesManager.getIndexOfColumnInSortQueue(t),r=-1!==n,o=this.getSortConfig(),i=this.getColumnNextConfig(t);if(r){if(te(i))return[].concat(NV(o.slice(0,n)),NV(o.slice(n+1)));if(e===uF)return[].concat(NV(o.slice(0,n)),NV(o.slice(n+1)),[i]);if(e===cF)return[].concat(NV(o.slice(0,n)),[i],NV(o.slice(n+1)))}return Zt(i)?o.concat(i):o}},{key:"getPluginColumnConfig",value:function(t){if(ht(t)){var e=t[this.pluginKey];if(ht(e))return e}return{}}},{key:"getMergedPluginSettings",value:function(t){var e=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,t),o=Object.getPrototypeOf(r);return Array.isArray(o.columns)?Object.assign(n,e,this.getPluginColumnConfig(o.columns[t])):_n(o.columns)?Object.assign(n,e,this.getPluginColumnConfig(o.columns(t))):Object.assign(n,e)}},{key:"getFirstCellSettings",value:function(t){var e=this.hot.getCellMeta(0,t),n=Object.create(e);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(t)),n}},{key:"getNumberOfRowsToSort",value:function(t){var e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}},{key:"sortByPresetSortStates",value:function(t){var e=this;if(0!==t.length){for(var n=[],r=this.hot.countRows(),o=function(n){return W(t,(function(t){return e.hot.getDataAtCell(n,t.column)}))},i=0;i<this.getNumberOfRowsToSort(r);i+=1)n.push([this.hot.toPhysicalRow(i)].concat(o(i)));var a=W(n,(function(t){return t[0]}));uV(n,this.pluginKey,W(t,(function(t){return t.sortOrder})),W(t,(function(t){return e.getFirstCellSettings(t.column)})));for(var l=n.length;l<r;l+=1)n.push([l].concat(o(l)));var s=W(n,(function(t){return t[0]})),u=new Map(W(a,(function(t,e){return[t,s[e]]}))),c=W(this.hot.rowIndexMapper.getIndexesSequence(),(function(t){return u.has(t)?u.get(t):t}));this.hot.rowIndexMapper.setIndexesSequence(c)}else this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues())}},{key:"loadOrSortBySettings",value:function(){var t=this.getAllSavedSortSettings();if(ht(t))this.sortBySettings(t);else{var e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}},{key:"sortBySettings",value:function(t){if(ht(t)){this.columnStatesManager.updateAllColumnsProperties(t);var e=t.initialConfig;(Array.isArray(e)||ht(e))&&this.sort(e)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(t,e){var n=$B(e);if(!1!==qB(t,e)&&null!==n){var r=this.getFirstCellSettings(t)[this.pluginKey],o=r.indicator,i=r.headerAction;this.updateHeaderClasses(n,this.columnStatesManager,t,o,i)}}},{key:"updateHeaderClasses",value:function(t){if(Ye(t,iV(t)),!1!==this.enabled){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];Ge(t,oV.apply(void 0,n))}}},{key:"onUpdateSettings",value:function(t){JV(aF(n.prototype),"onUpdateSettings",this).call(this),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Zt(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}},{key:"onAfterLoadData",value:function(t){!0===t&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(t,e){var n=this.getFirstCellSettings(e)[this.pluginKey],r=n.headerAction;return r&&"SPAN"===t.target.nodeName}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){!1!==QB(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(t,e){!1!==QB(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col)),this.sort(this.getColumnNextConfig(e.col)))}},{key:"destroy",value:function(){var t;null===(t=this.columnStatesManager)||void 0===t||t.destroy(),JV(aF(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return lF}},{key:"PLUGIN_PRIORITY",get:function(){return sF}}]),n}(RH);n(4401);function hF(t){return hF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hF(t)}function dF(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pF(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vF(r.key),r)}}function yF(t,e,n){return e&&pF(t.prototype,e),n&&pF(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function vF(t){var e=mF(t,"string");return"symbol"===hF(e)?e:String(e)}function mF(t,e){if("object"!==hF(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==hF(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var gF,bF=function(){function t(e,n){dF(this,t),this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=n,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return yF(t,[{key:"getEndpoint",value:function(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}},{key:"getAllEndpoints",value:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(t){return this.parseSettings(t.call(this))}},{key:"parseSettings",value:function(t){var e=this,n=[],r=t;if(r||"function"!==typeof this.settings)return r||(r=this.settings),U(r,(function(t){var r={};e.assignSetting(t,r,"ranges",[[0,e.hot.countRows()-1]]),e.assignSetting(t,r,"reversedRowCoords",!1),e.assignSetting(t,r,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),e.assignSetting(t,r,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),e.assignSetting(t,r,"sourceColumn",t.destinationColumn),e.assignSetting(t,r,"type","sum"),e.assignSetting(t,r,"forceNumeric",!1),e.assignSetting(t,r,"suppressDataTypeErrors",!0),e.assignSetting(t,r,"suppressDataTypeErrors",!0),e.assignSetting(t,r,"customFunction",null),e.assignSetting(t,r,"readOnly",!0),e.assignSetting(t,r,"roundFloat",!1),n.push(r)})),n;this.settingsType="function"}},{key:"assignSetting",value:function(t,e,n,r){if("ranges"!==n||void 0!==t[n]){if("ranges"!==n||0!==t[n].length)if(void 0===t[n]){if(r instanceof Error)throw r;e[n]=r}else"destinationRow"===n&&e.reversedRowCoords?e[n]=this.hot.countRows()-t[n]-1:e[n]=t[n]}else e[n]=r}},{key:"resetSetupBeforeStructureAlteration",value:function(t,e,n){if("function"===this.settingsType){var r=t.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();U(o,(function(o){"row"===r&&o.destinationRow>=e&&("insert_row"===t?o.alterRowOffset=n:"remove_row"===t&&(o.alterRowOffset=-1*n)),"col"===r&&o.destinationColumn>=e&&("insert_col"===t?o.alterColumnOffset=n:"remove_col"===t&&(o.alterColumnOffset=-1*n))})),this.resetAllEndpoints(o,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(t,e,n,r,o){var i=this,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"!==this.settingsType){var l=t.indexOf("row")>-1?"row":"col",s=t.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=0===t.indexOf("move_row"),f=e;U(u,(function(t){"row"===l&&t.destinationRow>=f&&(t.alterRowOffset=s*n),"col"===l&&t.destinationColumn>=f&&(t.alterColumnOffset=s*n)})),this.resetAllEndpoints(u,!c),U(u,c?function(t){i.extendEndpointRanges(t,f,r[0],r.length),i.recreatePhysicalRanges(t),i.clearOffsetInformation(t)}:function(t){i.shiftEndpointCoordinates(t,f)}),a&&this.refreshAllEndpoints()}else{var h=function t(){return i.hot.removeHook("beforeViewRender",t),i.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",h)}}},{key:"clearOffsetInformation",value:function(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(t,e,n,r){U(t.ranges,(function(t){t[1]&&(e>=t[0]&&e<=t[1]?n>t[1]?t[1]+=r:n<t[0]&&(t[0]-=r):n>=t[0]&&n<=t[1]&&(t[1]-=r,e<=t[0]&&(t[0]+=1,t[1]+=1)))}))}},{key:"recreatePhysicalRanges",value:function(t){var e=this,n=t.ranges,r=[],o=[];U(n,(function(t){var n=[];if(t[1])for(var r=t[0];r<=t[1];r++)n.push(e.hot.toPhysicalRow(r));else n.push(e.hot.toPhysicalRow(t[0]));o.push(n)})),U(o,(function(t){var e=[];U(t,(function(n,o){0===o?e.push(n):t[o]!==t[o-1]+1&&(e.push(t[o-1]),r.push(e),e=[],e.push(n)),o===t.length-1&&(e.push(n),r.push(e))}))})),t.ranges=r}},{key:"shiftEndpointCoordinates",value:function(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,U(t.ranges,(function(n){U(n,(function(r,o){r>=e&&(n[o]+=t.alterRowOffset||0)}))}))):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.some((function(e){var n=e.alterRowOffset||0,r=e.alterColumnOffset||0;return e.destinationRow+n>=t.hot.countRows()||e.destinationColumn+r>=t.hot.countCols()}));r||(this.cellsToSetCache=[],U(e,(function(e){t.resetEndpointValue(e,n)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var t=this;this.cellsToSetCache=[],U(this.getAllEndpoints(),(function(e){t.currentEndpoint=e,t.plugin.calculate(e),t.setEndpointValue(e,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(t){var e=this,n=[];this.cellsToSetCache=[],U(t,(function(t,r,o){"".concat(t[2]||"")!=="".concat(t[3])&&U(e.getAllEndpoints(),(function(t,i){e.hot.propToCol(o[r][1])===t.sourceColumn&&-1===n.indexOf(i)&&n.push(i)}))})),U(n,(function(t){e.refreshEndpoint(e.getEndpoint(t))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t.alterRowOffset||0,r=t.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(t.destinationRow+(e?n:0)),this.hot.toVisualColumn(t.destinationColumn+(e?r:0)),""])}},{key:"setEndpointValue",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols())this.throwOutOfBoundsWarning();else{var o=this.hot.toVisualRow(t.destinationRow);if(null!==o){var i=this.hot.getCellMeta(o,t.destinationColumn);"init"!==e&&i.readOnly===t.readOnly||(i.readOnly=t.readOnly,i.className="columnSummaryResult")}t.roundFloat&&!isNaN(t.result)&&(t.result=t.result.toFixed(t.roundFloat)),n?this.hot.setDataAtCell(r,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}}},{key:"throwOutOfBoundsWarning",value:function(){er("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),t}(),wF=bF;function SF(t){return null===t||void 0===t||isNaN(t)}function CF(t){return CF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},CF(t)}function OF(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function kF(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function RF(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,PF(r.key),r)}}function EF(t,e,n){return e&&RF(t.prototype,e),n&&RF(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function PF(t){var e=TF(t,"string");return"symbol"===CF(e)?e:String(e)}function TF(t,e){if("object"!==CF(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==CF(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function jF(){return jF="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=MF(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},jF.apply(this,arguments)}function MF(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=DF(t),null===t)break;return t}function AF(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&IF(t,e)}function IF(t,e){return IF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},IF(t,e)}function xF(t){var e=NF();return function(){var n,r=DF(t);if(e){var o=DF(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _F(this,n)}}function _F(t,e){if(e&&("object"===CF(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return HF(t)}function HF(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function NF(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function DF(t){return DF=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},DF(t)}var LF="columnSummary",BF=220,VF=function(t){AF(n,t);var e=xF(n);function n(t){var r;return kF(this,n),r=e.call(this,t),r.endpoints=null,r}return EF(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[LF]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.settings=this.hot.getSettings()[LF],this.endpoints=new wF(this,this.settings),this.addHook("afterInit",(function(){return t.onAfterInit.apply(t,arguments)})),this.addHook("afterChange",(function(){return t.onAfterChange.apply(t,arguments)})),this.addHook("beforeCreateRow",(function(e,n,r){return t.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,n,null,r)})),this.addHook("beforeCreateCol",(function(e,n,r){return t.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,n,null,r)})),this.addHook("beforeRemoveRow",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupBeforeStructureAlteration.apply(e,["remove_row"].concat(r))})),this.addHook("beforeRemoveCol",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupBeforeStructureAlteration.apply(e,["remove_col"].concat(r))})),this.addHook("afterCreateRow",(function(e,n,r){return t.endpoints.resetSetupAfterStructureAlteration("insert_row",e,n,null,r)})),this.addHook("afterCreateCol",(function(e,n,r){return t.endpoints.resetSetupAfterStructureAlteration("insert_col",e,n,null,r)})),this.addHook("afterRemoveRow",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupAfterStructureAlteration.apply(e,["remove_row"].concat(r))})),this.addHook("afterRemoveCol",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.endpoints).resetSetupAfterStructureAlteration.apply(e,["remove_col"].concat(r))})),this.addHook("afterRowMove",(function(){return t.onAfterRowMove.apply(t,arguments)})),jF(DF(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":t.result=this.calculateMinMax(t,t.type);break;case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t);break;default:break}}},{key:"calculateSum",value:function(t){var e=this,n=0;return pt(t.ranges,(function(r){n+=e.getPartialSum(r,t.sourceColumn)})),n}},{key:"getPartialSum",value:function(t,e){var n=0,r=t[1]||t[0],o=null,i=0;do{if(o=this.getCellValue(r,e),o=SF(o)?null:o,null!==o){var a=("".concat(o).split(".")[1]||[]).length||1;a>i&&(i=a)}n+=o||0,r-=1}while(r>=t[0]);return Math.round(n*Math.pow(10,i))/Math.pow(10,i)}},{key:"calculateMinMax",value:function(t,e){var n=this,r=null;return pt(t.ranges,(function(o){var i=n.getPartialMinMax(o,t.sourceColumn,e);if(null===r&&null!==i&&(r=i),null!==i)switch(e){case"min":r=Math.min(r,i);break;case"max":r=Math.max(r,i);break;default:break}})),null===r?"Not enough data":r}},{key:"getPartialMinMax",value:function(t,e,n){var r,o=null,i=t[1]||t[0];do{if(r=this.getCellValue(i,e),r=SF(r)?null:r,null===o)o=r;else if(null!==r)switch(n){case"min":o=Math.min(o,r);break;case"max":o=Math.max(o,r);break;default:break}i-=1}while(i>=t[0]);return o}},{key:"countEmpty",value:function(t,e){var n,r=0,o=t[1]||t[0];do{n=this.getCellValue(o,e),n=SF(n)?null:n,null===n&&(r+=1),o-=1}while(o>=t[0]);return r}},{key:"countEntries",value:function(t){var e=this,n=0,r=t.ranges;return pt(r,(function(r){var o=void 0===r[1]?1:r[1]-r[0]+1,i=e.countEmpty(r,t.sourceColumn);n+=o,n-=i})),n}},{key:"calculateAverage",value:function(t){var e=this.calculateSum(t),n=this.countEntries(t);return e/n}},{key:"getCellValue",value:function(t,e){var n=this.hot.toVisualRow(t),r=this.hot.toVisualColumn(e),o=this.hot.getSourceDataAtCell(t,e),i="";if(null!==n&&null!==r&&(i=this.hot.getCellMeta(n,r).className||""),i.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"===typeof o&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error($t(gF||(gF=OF(["ColumnSummary plugin: cell at (",", ",") is not in a \n          numeric format. Cannot do the calculation."],["ColumnSummary plugin: cell at (",", ",") is not in a\\x20\n          numeric format. Cannot do the calculation."])),t,e));return o}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}},{key:"onAfterRowMove",value:function(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return LF}},{key:"PLUGIN_PRIORITY",get:function(){return BF}}]),n}(RH);function FF(t){return FF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FF(t)}function WF(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function UF(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,GF(r.key),r)}}function zF(t,e,n){return e&&UF(t.prototype,e),n&&UF(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function GF(t){var e=YF(t,"string");return"symbol"===FF(e)?e:String(e)}function YF(t,e){if("object"!==FF(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==FF(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var KF=function(){function t(e,n){WF(this,t),this.rootDocument=e,this.isRtl=n,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return zF(t,[{key:"setPosition",value:function(t,e){this.editorStyle.left="".concat(t,"px"),this.editorStyle.top="".concat(e,"px")}},{key:"setSize",value:function(t,e){if(t&&e){var n=this.getInputElement();n.style.width="".concat(t,"px"),n.style.height="".concat(e,"px")}}},{key:"getSize",value:function(){return{width:fn(this.getInputElement()),height:hn(this.getInputElement())}}},{key:"resetSize",value:function(){var t=this.getInputElement();t.style.width="",t.style.height=""}},{key:"setReadOnlyState",value:function(t){var e=this.getInputElement();e.readOnly=t}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return"block"===this.editorStyle.display}},{key:"setValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=t||"";this.getInputElement().value=e}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Ge(this.container,t.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Ge(e,t.CLASS_EDITOR),Ge(n,t.CLASS_INPUT),e.appendChild(n),this.container.appendChild(e),e}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(t.CLASS_INPUT))}},{key:"destroy",value:function(){var t=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,t&&t.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),t}(),XF=KF,$F="---------";function qF(){return{name:$F}}function QF(t){return W(t,(function(t){return{start:t.getTopStartCorner(),end:t.getBottomEndCorner()}}))}function JF(t){return ze(t,"htSeparator")}function ZF(t){return ze(t,"htSubmenu")}function tW(t){return ze(t,"htDisabled")}function eW(t){return ze(t,"htSelectionDisabled")}function nW(t){var e=t.getSelected();return e?e[0]<0?null:e:null}function rW(t,e){if(-1!==t.indexOf(e))return t;var n=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(n," ").concat(e)}function oW(t,e){if(-1!==t.indexOf(e))return t;var n=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(n," ").concat(e)}function iW(t,e){var n={};return U(t,(function(t){t.forAll((function(t,r){t>=0&&r>=0&&(n[t]||(n[t]=[]),n[t][r]=e(t,r))}))})),n}function aW(t,e,n,r,o){U(t,(function(t){t.forAll((function(t,i){t>=0&&i>=0&&lW(t,i,e,n,r,o)}))}))}function lW(t,e,n,r,o,i){var a=o(t,e),l=r;a.className&&(l="vertical"===n?rW(a.className,r):oW(a.className,r)),i(t,e,"className",l)}function sW(t,e){var n=!1;return Array.isArray(t)&&U(t,(function(t){return t.forAll((function(t,r){if(t>=0&&r>=0&&e(t,r))return n=!0,!1})),n})),n}function uW(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function cW(t,e){return!t.hidden||!("function"===typeof t.hidden&&t.hidden.call(e))}function fW(t,e){for(var n=t.slice(0),r=0;r<n.length;){if(n[r].name!==e)break;n.shift()}return n}function hW(t,e){var n=t.slice(0);return n.reverse(),n=fW(n,e),n.reverse(),n}function dW(t){var e=[];return U(t,(function(t,n){n>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)})),e}function pW(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$F,n=t.slice(0);return n=fW(n,e),n=hW(n,e),n=dW(n),n}function yW(t){return yW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yW(t)}function vW(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bW(r.key),r)}}function gW(t,e,n){return e&&mW(t.prototype,e),n&&mW(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function bW(t){var e=wW(t,"string");return"symbol"===yW(e)?e:String(e)}function wW(t,e){if("object"!==yW(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==yW(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var SW=250,CW=250,OW=function(){function t(e){vW(this,t),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}return gW(t,[{key:"hide",value:function(){var t=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout((function(){!1===t.wasLastActionShow&&t.runLocalHooks("hide")}),CW)}},{key:"show",value:function(t){this.wasLastActionShow=!0,this.showDebounced(t)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:SW;this.showDebounced=Dn((function(e){t.wasLastActionShow&&t.runLocalHooks("show",e.from.row,e.from.col)}),e)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),t}();ct(OW,Zv);var kW=OW;function RW(t){return RW="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},RW(t)}function EW(t,e,n){return e=MW(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PW(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,MW(r.key),r)}}function jW(t,e,n){return e&&TW(t.prototype,e),n&&TW(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function MW(t){var e=AW(t,"string");return"symbol"===RW(e)?e:String(e)}function AW(t,e){if("object"!==RW(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==RW(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function IW(){return IW="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=xW(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},IW.apply(this,arguments)}function xW(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=VW(t),null===t)break;return t}function _W(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&HW(t,e)}function HW(t,e){return HW=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},HW(t,e)}function NW(t){var e=BW();return function(){var n,r=VW(t);if(e){var o=VW(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return DW(this,n)}}function DW(t,e){if(e&&("object"===RW(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return LW(t)}function LW(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function BW(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function VW(t){return VW=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},VW(t)}var FW="comments",WW=60,UW=new WeakMap,zW="comment",GW="value",YW="style",KW="readOnly",XW=function(t){_W(n,t);var e=NW(n);function n(t){var r;return PW(this,n),r=e.call(this,t),r.editor=null,r.displaySwitch=null,r.eventManager=null,r.range={},r.preventEditorAutoSwitch=!1,UW.set(LW(r),{tempEditorDimensions:{},cellBelowCursor:null}),r}return jW(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[FW]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.editor||(this.editor=new XF(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Gr(this)),this.displaySwitch||(this.displaySwitch=new kW(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(function(e){return t.addToContextMenu(e)})),this.addHook("afterRenderer",(function(e,n,r,o,i,a){return t.onAfterRenderer(e,a)})),this.addHook("afterScrollHorizontally",(function(){return t.hide()})),this.addHook("afterScrollVertically",(function(){return t.hide()})),this.addHook("afterBeginEditing",(function(){return t.hide()})),this.displaySwitch.addLocalHook("hide",(function(){return t.hide()})),this.displaySwitch.addLocalHook("show",(function(e,n){return t.showAtCell(e,n)})),this.registerListeners(),IW(VW(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),IW(VW(n.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){IW(VW(n.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var t=this,e=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(e,"mousedown",(function(e){return t.onMouseDown(e)})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()})),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",(function(){return t.onEditorBlur()})),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",(function(e){return t.onEditorMouseDown(e)})),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",(function(e){return t.onEditorMouseUp(e)}))}},{key:"setRange",value:function(t){this.range=t}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(t){var e=Ne(t.target,"TD","TBODY");return!!(e&&ze(e,"htCommentCell")&&Ne(e,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(t){return this.editor.getInputElement()===t.target}},{key:"setComment",value:function(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.editor.getValue(),n="";null!==t&&void 0!==t?n=t:null!==e&&void 0!==e&&(n=e);var r=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(r,o,EW({},GW,n)),this.hot.render()}},{key:"setCommentAtCell",value:function(t,e,n){this.setRange({from:this.hot._createCellCoords(t,e)}),this.setComment(n)}},{key:"removeComment",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,zW),t&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(t,e)}),this.removeComment(n)}},{key:"getComment",value:function(){var t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,GW)}},{key:"getCommentAtCell",value:function(t,e){return this.getCommentMeta(t,e,GW)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var t=this.range.from,e=t.row,n=t.col;if(e<0||e>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;var r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(r[zW]?r[zW][GW]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(t,e){return this.setRange({from:this.hot._createCellCoords(t,e)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(n||this.range.from&&this.editor.isVisible()){var r=this.hot,o=r.rowIndexMapper,i=r.columnIndexMapper,a=this.range.from,l=a.row,s=a.col,u=o.getRenderableFromVisualIndex(l),c=i.getRenderableFromVisualIndex(s),f=null===u;this.editor.setPosition(0,0),null===u&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(l,-1))),null===c&&(c=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1)));var h=null===u,d=null===c;u=null!==(t=u)&&void 0!==t?t:0,c=null!==(e=c)&&void 0!==e?e:0;var p=this.hot,y=p.rootWindow,v=p.view._wt,m=v.wtTable,g=v.getCell({row:u,col:c},!0),b=this.getCommentMeta(l,s,YW);b?this.editor.setSize(b.width,b.height):this.editor.resetSize();var w=d?0:m.getStretchedColumnWidth(c),S=f&&!h?hn(g):0,C=g.getBoundingClientRect(),O=C.left,k=C.top,R=C.width,E=C.height,P=this.editor.getSize(),T=P.width,j=P.height,M=this.hot.rootWindow,A=M.innerWidth,I=M.innerHeight,x=this.hot.rootDocument.documentElement,_=O+y.scrollX+w,H=k+y.scrollY+S;this.hot.isRtl()&&(_-=T+w),this.hot.isLtr()&&O+R+T>A?_=O+y.scrollX-T-1:this.hot.isRtl()&&_<-(x.scrollWidth-x.clientWidth)&&(_=O+y.scrollX+w+1),k+j>I&&(H-=j-E+1),this.editor.setPosition(_,H),this.editor.setReadOnlyState(this.getCommentMeta(l,s,KW))}}},{key:"checkSelectionCommentsConsistency",value:function(){var t=this.hot.getSelectedRangeLast();if(!t)return!1;var e=!1,n=t.getTopStartCorner();return this.getCommentMeta(n.row,n.col,GW)&&(e=!0),e}},{key:"updateCommentMeta",value:function(t,e,n){var r,o=this.hot.getCellMeta(t,e)[zW];o?(r=st(o),lt(r,n)):r=n,this.hot.setCellMeta(t,e,zW,r)}},{key:"getCommentMeta",value:function(t,e,n){var r=this.hot.getCellMeta(t,e);if(r[zW])return r[zW][n]}},{key:"onMouseDown",value:function(t){if(this.hot.view&&this.hot.view._wt&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(t)){var e=Ne(t.target,"TD","TBODY"),n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}},{key:"onMouseOver",value:function(t){var e=UW.get(this),n=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||ze(t.target,"wtBorder")||e.cellBelowCursor===t.target)&&this.editor)if(e.cellBelowCursor=n.elementFromPoint(t.clientX,t.clientY),this.targetIsCellWithComment(t)){var r=this.hot._createCellRange(this.hot.getCoords(t.target));this.displaySwitch.show(r)}else Le(t.target,n)&&!this.targetIsCommentTextArea(t)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(t,e){e[zW]&&e[zW][GW]&&Ge(t,e.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(t){var e=UW.get(this);e.tempEditorDimensions={width:fn(t.target),height:hn(t.target)}}},{key:"onEditorMouseUp",value:function(t){var e=UW.get(this),n=fn(t.target),r=hn(t.target);n===e.tempEditorDimensions.width+1&&r===e.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,EW({},YW,{width:n,height:r}))}},{key:"onContextMenuAddComment",value:function(){var t=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:t.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var t=this,e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((function(e,n){e>=0&&n>=0&&t.removeCommentAtCell(e,n,!1)})),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var t=this,e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((function(e,n){if(e>=0&&n>=0){var r=!!t.getCommentMeta(e,n,KW);t.updateCommentMeta(e,n,EW({},KW,!r))}}))}},{key:"addToContextMenu",value:function(t){var e=this,n=function(){return e.hot.rowIndexMapper.getRenderableIndexesLength()>0&&e.hot.columnIndexMapper.getRenderableIndexesLength()>0};t.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return e.checkSelectionCommentsConsistency()?e.hot.getTranslatedPhrase(tS):e.hot.getTranslatedPhrase(Zw)},callback:function(){return e.onContextMenuAddComment()},disabled:function(){return!n()||!(e.hot.getSelectedLast()&&!e.hot.selection.isSelectedByCorner())}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(eS)},callback:function(){return e.onContextMenuRemoveComment()},disabled:function(){return!n()||!(e.hot.getSelectedLast()&&!e.hot.selection.isSelectedByCorner())}},{key:"commentsReadOnly",name:function(){var t=this,e=this.getTranslatedPhrase(nS),n=sW(this.getSelectedRangeLast(),(function(e,n){var r=t.getCellMeta(e,n)[zW];if(r&&(r=r[KW]),r)return!0}));return n&&(e=uW(e)),e},callback:function(){return e.onContextMenuMakeReadOnly()},disabled:function(){return!n()||(!(e.hot.getSelectedLast()&&!e.hot.selection.isSelectedByCorner())||!e.checkSelectionCommentsConsistency())}})}},{key:"getDisplayDelaySetting",value:function(){var t=this.hot.getSettings()[FW];if(ht(t))return t.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),IW(VW(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return FW}},{key:"PLUGIN_PRIORITY",get:function(){return WW}}]),n}(RH);function $W(t){return $W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$W(t)}function qW(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ZW(r.key),r)}}function JW(t,e,n){return e&&QW(t.prototype,e),n&&QW(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZW(t){var e=tU(t,"string");return"symbol"===$W(e)?e:String(e)}function tU(t,e){if("object"!==$W(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==$W(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var eU=function(){function t(e){qW(this,t),this.hot=e,this.commands={},this.commonCallback=null}return JW(t,[{key:"registerCommand",value:function(t,e){this.commands[t]=e}},{key:"setCommonCallback",value:function(t){this.commonCallback=t}},{key:"execute",value:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=t.split(":"),a=i[0],l=2===i.length?i[1]:null,s=this.commands[a];if(!s)throw new Error("Menu command '".concat(a,"' not exists."));if(l&&s.submenu&&(s=nU(l,s.submenu.items)),!0!==s.disabled&&("function"!==typeof s.disabled||!0!==s.disabled.call(this.hot))&&!bt(s,"submenu")){var u=[];"function"===typeof s.callback&&u.push(s.callback),"function"===typeof this.commonCallback&&u.push(this.commonCallback),r.unshift(i.join(":")),U(u,(function(t){return t.apply(e.hot,r)}))}}}]),t}();function nU(t,e){var n;return U(e,(function(e){var r=e.key?e.key.split(":"):null;if(Array.isArray(r)&&r[1]===t)return n=e,!1})),n}var rU=eU,oU="alignment";function iU(){return{key:oU,name:function(){return this.getTranslatedPhrase(rS)},disabled:function(){return 0===this.countRows()||0===this.countCols()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(oU,":left"),name:function(){var t=this,e=this.getTranslatedPhrase(oS),n=sW(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htLeft"))return!0}));return n&&(e=uW(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=iW(e,(function(e,n){return t.getCellMeta(e,n).className})),r="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",n,e,r,o),aW(e,r,o,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{key:"".concat(oU,":center"),name:function(){var t=this,e=this.getTranslatedPhrase(iS),n=sW(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htCenter"))return!0}));return n&&(e=uW(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=iW(e,(function(e,n){return t.getCellMeta(e,n).className})),r="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",n,e,r,o),aW(e,r,o,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{key:"".concat(oU,":right"),name:function(){var t=this,e=this.getTranslatedPhrase(aS),n=sW(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htRight"))return!0}));return n&&(e=uW(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=iW(e,(function(e,n){return t.getCellMeta(e,n).className})),r="horizontal",o="htRight";this.runHooks("beforeCellAlignment",n,e,r,o),aW(e,r,o,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{key:"".concat(oU,":justify"),name:function(){var t=this,e=this.getTranslatedPhrase(lS),n=sW(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htJustify"))return!0}));return n&&(e=uW(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=iW(e,(function(e,n){return t.getCellMeta(e,n).className})),r="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",n,e,r,o),aW(e,r,o,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{name:$F},{key:"".concat(oU,":top"),name:function(){var t=this,e=this.getTranslatedPhrase(sS),n=sW(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htTop"))return!0}));return n&&(e=uW(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=iW(e,(function(e,n){return t.getCellMeta(e,n).className})),r="vertical",o="htTop";this.runHooks("beforeCellAlignment",n,e,r,o),aW(e,r,o,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{key:"".concat(oU,":middle"),name:function(){var t=this,e=this.getTranslatedPhrase(uS),n=sW(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htMiddle"))return!0}));return n&&(e=uW(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=iW(e,(function(e,n){return t.getCellMeta(e,n).className})),r="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",n,e,r,o),aW(e,r,o,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1},{key:"".concat(oU,":bottom"),name:function(){var t=this,e=this.getTranslatedPhrase(cS),n=sW(this.getSelectedRange(),(function(e,n){var r=t.getCellMeta(e,n).className;if(r&&-1!==r.indexOf("htBottom"))return!0}));return n&&(e=uW(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=iW(e,(function(e,n){return t.getCellMeta(e,n).className})),r="vertical",o="htBottom";this.runHooks("beforeCellAlignment",n,e,r,o),aW(e,r,o,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),this.render()},disabled:!1}]}}}var aU="clear_column";function lU(){return{key:aU,name:function(){return this.getTranslatedPhrase(Uw)},callback:function(t,e){var n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled:function(){var t=nW(this);return!t||!this.selection.isSelectedByColumnHeader()}}}var sU="col_left";function uU(){return{key:sU,name:function(){return this.getTranslatedPhrase(Nw)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=nW(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var e=this.countCols();return 0===e}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var cU="col_right";function fU(){return{key:cU,name:function(){return this.getTranslatedPhrase(Dw)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=nW(this);return!t||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden:function(){return!this.getSettings().allowInsertColumn}}}var hU="make_read_only";function dU(){return{key:hU,name:function(){var t=this,e=this.getTranslatedPhrase(Ww),n=sW(this.getSelectedRange(),(function(e,n){return t.getCellMeta(e,n).readOnly}));return n&&(e=uW(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),n=sW(e,(function(e,n){return t.getCellMeta(e,n).readOnly}));U(e,(function(e){e.forAll((function(e,r){e>=0&&r>=0&&t.setCellMeta(e,r,"readOnly",!n)}))})),this.render()},disabled:function(){return!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))}}}var pU="redo";function yU(){return{key:pU,name:function(){return this.getTranslatedPhrase(Fw)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function vU(t,e){return SU(t)||wU(t,e)||gU(t,e)||mU()}function mU(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function gU(t,e){if(t){if("string"===typeof t)return bU(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bU(t,e):void 0}}function bU(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function wU(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function SU(t){if(Array.isArray(t))return t}var CU="remove_col";function OU(){return{key:CU,name:function(){var t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{var n=vU(t[0],4),r=n[1],o=n[3];r-o!==0&&(e=1)}return this.getTranslatedPhrase(Bw,e)},callback:function(){this.alter("remove_col",BR(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=nW(this);if(!t)return!0;var e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function kU(t,e){return jU(t)||TU(t,e)||EU(t,e)||RU()}function RU(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function EU(t,e){if(t){if("string"===typeof t)return PU(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?PU(t,e):void 0}}function PU(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function TU(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function jU(t){if(Array.isArray(t))return t}var MU="remove_row";function AU(){return{key:MU,name:function(){var t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{var n=kU(t[0],3),r=n[0],o=n[2];r-o!==0&&(e=1)}return this.getTranslatedPhrase(Lw,e)},callback:function(){this.alter("remove_row",VR(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=nW(this);if(!t)return!0;var e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden:function(){return!this.getSettings().allowRemoveRow}}}var IU="row_above";function xU(){return{key:IU,name:function(){return this.getTranslatedPhrase(_w)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=nW(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var e=this.countRows();return 0===e}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var _U="row_below";function HU(){return{key:_U,name:function(){return this.getTranslatedPhrase(Hw)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=nW(this);return!t||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden:function(){return!this.getSettings().allowInsertRow}}}var NU="no_items";function DU(){return{key:NU,name:function(){return this.getTranslatedPhrase(xw)},disabled:!0,isCommand:!1}}var LU,BU="undo";function VU(){return{key:BU,name:function(){return this.getTranslatedPhrase(Vw)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function FU(t){return FU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FU(t)}function WU(t,e,n){return e=UU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UU(t){var e=zU(t,"string");return"symbol"===FU(e)?e:String(e)}function zU(t,e){if("object"!==FU(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==FU(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var GU=[IU,_U,sU,cU,aU,MU,CU,BU,pU,hU,oU,$F,NU],YU=(LU={},WU(LU,$F,qF),WU(LU,NU,DU),WU(LU,IU,xU),WU(LU,_U,HU),WU(LU,sU,uU),WU(LU,cU,fU),WU(LU,aU,lU),WU(LU,MU,AU),WU(LU,CU,OU),WU(LU,BU,VU),WU(LU,pU,yU),WU(LU,hU,dU),WU(LU,oU,iU),LU);function KU(){var t={};return pt(YU,(function(e,n){t[n]=e()})),t}function XU(t){return XU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},XU(t)}function $U(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qU(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,JU(r.key),r)}}function QU(t,e,n){return e&&qU(t.prototype,e),n&&qU(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function JU(t){var e=ZU(t,"string");return"symbol"===XU(e)?e:String(e)}function ZU(t,e){if("object"!==XU(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==XU(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var tz=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;$U(this,t),this.hot=e,this.predefinedItems=KU(),this.defaultOrderPattern=n}return QU(t,[{key:"setPredefinedItems",value:function(t){var e=this,n={};this.defaultOrderPattern.length=0,pt(t,(function(t,r){var o="";t.name===$F?(n[$F]=t,o=$F):isNaN(parseInt(r,10))?(t.key=void 0===t.key?r:t.key,n[r]=t,o=t.key):(n[t.key]=t,o=t.key),e.defaultOrderPattern.push(o)})),this.predefinedItems=n}},{key:"getItems",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return ez(t,this.defaultOrderPattern,this.predefinedItems)}}]),t}();function ez(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],o=t;return o&&o.items?o=o.items:Array.isArray(o)||(o=e),ht(o)?pt(o,(function(t,e){var o=n["string"===typeof t?t:e];o||(o=t),ht(t)?at(o,t):"string"===typeof o&&(o={name:o}),void 0===o.key&&(o.key=e),r.push(o)})):U(o,(function(t,e){var o=n[t];!o&&GU.indexOf(t)>=0||(o||(o={name:t,key:"".concat(e)}),ht(t)&&at(o,t),void 0===o.key&&(o.key=e),r.push(o))})),r}var nz=tz;function rz(t){return rz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rz(t)}function oz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iz(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lz(r.key),r)}}function az(t,e,n){return e&&iz(t.prototype,e),n&&iz(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function lz(t){var e=sz(t,"string");return"symbol"===rz(e)?e:String(e)}function sz(t,e){if("object"!==rz(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==rz(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var uz=function(){function t(e,n){oz(this,t);var r,o,i,a,l,s,u=en(n),c=nn(n);this.rootWindow=n,this.type=this.getSourceType(e),"literal"===this.type?(r=parseInt(e.top,10),i=parseInt(e.left,10),l=e.height||0,s=e.width||0,o=r,a=i,r+=u,i+=c):"event"===this.type&&(r=parseInt(e.pageY,10),i=parseInt(e.pageX,10),l=e.target.clientHeight,s=e.target.clientWidth,o=r-u,a=i-c),this.top=r,this.topRelative=o,this.left=i,this.leftRelative=a,this.scrollTop=u,this.scrollLeft=c,this.cellHeight=l,this.cellWidth=s}return az(t,[{key:"getSourceType",value:function(t){var e="literal";return t instanceof Event&&(e="event"),e}},{key:"fitsAbove",value:function(t){return this.topRelative>=t.offsetHeight}},{key:"fitsBelow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}},{key:"fitsOnRight",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}},{key:"fitsOnLeft",value:function(t){return this.leftRelative>=t.offsetWidth}}]),t}(),cz=uz;function fz(t){return fz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fz(t)}function hz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function dz(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?hz(Object(n),!0).forEach((function(e){pz(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):hz(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function pz(t,e,n){return e=gz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yz(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vz(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,gz(r.key),r)}}function mz(t,e,n){return e&&vz(t.prototype,e),n&&vz(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function gz(t){var e=bz(t,"string");return"symbol"===fz(e)?e:String(e)}function bz(t,e){if("object"!==fz(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==fz(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var wz=215,Sz="menu",Cz=Sz,Oz=function(){function t(e,n){yz(this,t),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:wz,container:this.hot.rootDocument.documentElement},this.eventManager=new Gr(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return mz(t,[{key:"registerEvents",value:function(){var t=this,e=this.hot.rootWindow;while(e)this.eventManager.addEventListener(e.document,"mousedown",(function(e){return t.onDocumentMouseDown(e)})),this.eventManager.addEventListener(e.document,"contextmenu",(function(e){return t.onDocumentContextMenu(e)})),e=_e(e)}},{key:"setMenuItems",value:function(t){this.menuItems=t}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset[t]=e}},{key:"isSubMenu",value:function(){return null!==this.parentMenu}},{key:"open",value:function(){var t=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var e=Dn((function(e){return t.openSubMenu(e)}),300),n=this.options.minWidth||wz,r=!1,o=F(this.menuItems,(function(e){return e.key===NU&&(r=!0),cW(e,t.hot)}));if(o.length<1&&!r)o.push(KU()[NU]);else if(0===o.length)return;o=pW(o,$F);var i=!1,a={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(t){return Zt(t)&&t<n?n:t},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(e,n,r,o,i,a){return t.menuItemRenderer(e,n,r,o,i,a)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(n,r){t.isAllSubMenusClosed()?e(r.row):t.openSubMenu(r.row)},rowHeights:function(t){return o[t].name===$F?1:23},afterOnCellContextMenu:function(e){e.preventDefault(),Lt()&&i&&t.hasSelectedItem()&&t.close(!0)},beforeOnCellMouseUp:function(e){t.hasSelectedItem()&&(i=!t.isCommandPassive(t.getSelectedItem()),t.executeCommand(e))},afterOnCellMouseUp:function(e){Lt()&&Zn(e)||!i||!t.hasSelectedItem()||(Ht()||Dt()?setTimeout((function(){return t.close(!0)}),325):t.close(!0))},afterUnlisten:function(){!t.hasSelectedItem()&&t.isOpened()&&t.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new BT(this.container,a),this.hotMenu.addHook("afterInit",(function(){return t.onAfterInit()})),this.hotMenu.addHook("afterSelection",(function(){return t.onAfterSelection.apply(t,arguments)})),this.hotMenu.init(),this.hotMenu.listen();var l=this.hotMenu.getShortcutManager(),s=l.addContext(Cz),u={group:Sz},c=dz(dz({},u),{},{runOnlyIf:function(e){return!1===jn(e.target)||!1===t.container.contains(e.target)}});l.setActiveContextName("menu"),s.addShortcuts([{keys:[["Escape"]],callback:function(){t.keyEvent=!0,t.close(),t.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var e=t.hotMenu.getSelectedLast();t.keyEvent=!0,e?t.selectNextCell(e[0],e[1]):t.selectFirstCell(),t.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var e=t.hotMenu.getSelectedLast();t.keyEvent=!0,e?t.selectPrevCell(e[0],e[1]):t.selectLastCell(),t.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var e=t.hotMenu.getSelectedLast();if(t.keyEvent=!0,e){var n=t.openSubMenu(e[0]);n&&n.selectFirstCell()}t.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var e=t.hotMenu.getSelectedLast();t.keyEvent=!0,e&&t.isSubMenu()&&(t.close(),t.parentMenu&&t.parentMenu.hotMenu.listen()),t.keyEvent=!1}},{keys:[["Enter"]],callback:function(e){var n=t.hotMenu.getSelectedLast();t.keyEvent=!0,t.hotMenu.getSourceDataAtRow(n[0]).submenu||(t.executeCommand(e),t.close(!0)),t.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var e=t.hotMenu.getSelectedLast();t.keyEvent=!0,e?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.selectFirstCell(),t.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var e=t.hotMenu.getSelectedLast();t.keyEvent=!0,e?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.selectLastCell(),t.keyEvent=!1}}],c),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isOpened()&&(t&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(e){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!ZF(n))return!1;var r=this.hotMenu.getSourceDataAtRow(e),o=new t(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(r.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=o,o}},{key:"closeSubMenu",value:function(t){var e=this.hotMenu.getSourceDataAtRow(t),n=this.hotSubMenus[e.key];n&&(n.destroy(),delete this.hotSubMenus[e.key])}},{key:"closeAllSubMenus",value:function(){var t=this;U(this.hotMenu.getData(),(function(e,n){return t.closeSubMenu(n)}))}},{key:"isAllSubMenusClosed",value:function(){return 0===Object.keys(this.hotSubMenus).length}},{key:"destroy",value:function(){var t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}},{key:"isOpened",value:function(){return null!==this.hotMenu}},{key:"executeCommand",value:function(t){if(this.isOpened()&&this.hasSelectedItem()){var e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),!this.isCommandPassive(e)){var n=this.hot.getSelectedRange(),r=n?QF(n):[];this.runLocalHooks("executeCommand",e.key,r,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,r,t)}}}},{key:"isCommandPassive",value:function(t){var e=t.isCommand,n=t.name,r=t.disabled,o=t.submenu,i=!0===r||"function"===typeof r&&!0===r.call(this.hot);return!1===e||n===$F||!0===i||o}},{key:"setPosition",value:function(t){var e=new cz(t,this.container.ownerDocument.defaultView);this.options.keepInViewport?(e.fitsBelow(this.container)?this.setPositionBelowCursor(e):e.fitsAbove(this.container)?this.setPositionAboveCursor(e):this.setPositionBelowCursor(e),this.hot.isLtr()?this.setHorizontalPositionForLtr(e):this.setHorizontalPositionForRtl(e)):(this.setPositionBelowCursor(e),this.setPositionOnRightOfCursor(e))}},{key:"setHorizontalPositionForRtl",value:function(t){t.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(t):this.setPositionOnRightOfCursor(t)}},{key:"setHorizontalPositionForLtr",value:function(t){t.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(t):this.setPositionOnLeftOfCursor(t)}},{key:"setPositionAboveCursor",value:function(t){var e=this.offset.above+t.top-this.container.offsetHeight;this.isSubMenu()&&(e=t.top+t.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(e,"px")}},{key:"setPositionBelowCursor",value:function(t){var e=this.offset.below+t.top+1;this.isSubMenu()&&(e=t.top-1),this.container.style.top="".concat(e,"px")}},{key:"setPositionOnRightOfCursor",value:function(t){var e=t.left;if(this.isSubMenu()){var n=this.parentMenu.container.getBoundingClientRect(),r=n.right;e+=t.cellWidth+r-(t.left+t.cellWidth)}else e+=this.offset.right;this.container.style.left="".concat(e,"px")}},{key:"setPositionOnLeftOfCursor",value:function(t){var e=this.offset.left+t.left-this.container.offsetWidth;if(this.isSubMenu()){var n=this.parentMenu.container.getBoundingClientRect(),r=n.left;e-=t.left-r}this.container.style.left="".concat(e,"px")}},{key:"selectFirstCell",value:function(){var t=this.hotMenu.getCell(0,0);JF(t)||tW(t)||eW(t)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var t=this.hotMenu.countRows()-1,e=this.hotMenu.getCell(t,0);JF(e)||tW(e)||eW(e)?this.selectPrevCell(t,0):(this.hotMenu.selectCell(t,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(t,0,!0,!1))}},{key:"selectNextCell",value:function(t,e){var n=t+1,r=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,e):null;r&&(JF(r)||tW(r)||eW(r)?this.selectNextCell(n,e):this.hotMenu.selectCell(n,e))}},{key:"selectPrevCell",value:function(t,e){var n=t-1,r=n>=0?this.hotMenu.getCell(n,e):null;r&&(JF(r)||tW(r)||eW(r)?this.selectPrevCell(n,e):this.hotMenu.selectCell(n,e))}},{key:"menuItemRenderer",value:function(t,e,n,r,o,i){var a=this,l=t.getSourceDataAtRow(n),s=this.hot.rootDocument.createElement("div"),u=function(t){return bt(t,"submenu")},c=function(t){return new RegExp($F,"i").test(t.name)},f=function(t){return!0===t.disabled||"function"===typeof t.disabled&&!0===t.disabled.call(a.hot)},h=function(t){return t.disableSelection},d=i;"function"===typeof d&&(d=d.call(this.hot)),Xe(e),Ge(s,"htItemWrapper"),e.appendChild(s),c(l)?Ge(e,"htSeparator"):"function"===typeof l.renderer?(Ge(e,"htCustomMenuRenderer"),e.appendChild(l.renderer(t,s,n,r,o,d))):Qe(s,d),f(l)?(Ge(e,"htDisabled"),this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()}))):h(l)?(Ge(e,"htSelectionDisabled"),this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()}))):u(l)?(Ge(e,"htSubmenu"),h(l)?this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()})):this.eventManager.addEventListener(e,"mouseenter",(function(){return t.selectCell(n,r,void 0,void 0,!1,!1)}))):(Ye(e,["htSubmenu","htDisabled"]),h(l)?this.eventManager.addEventListener(e,"mouseenter",(function(){return t.deselectCell()})):this.eventManager.addEventListener(e,"mouseenter",(function(){return t.selectCell(n,r,void 0,void 0,!1,!1)})))}},{key:"createContainer",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.options.container.ownerDocument,r=e;return r&&(_n(r)&&(r=r.call(this.hot),r=null===r||te(r)?"":r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r="".concat(this.options.className,"Sub_").concat(r),t=n.querySelector(".".concat(this.options.className,".").concat(r))),t||(t=n.createElement("div"),Ge(t,"htMenu ".concat(this.options.className)),r&&Ge(t,r),this.options.container.appendChild(t)),t}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var t=this.hotMenu.view._wt.wtTable,e=this.hotMenu.getSettings().data,n=t.hider.style,r=t.holder.style,o=parseInt(n.width,10),i=V(e,(function(t,e){return t+(e.name===$F?1:26)}),0);r.width="".concat(o+3,"px"),r.height="".concat(i+3,"px"),n.height=r.height}},{key:"onAfterSelection",value:function(t,e,n,r,o){!1===this.keyEvent&&(o.value=!0)}},{key:"onDocumentMouseDown",value:function(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Le(t.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Le(t.target,".htMenu")||this.close(!0))}},{key:"onDocumentContextMenu",value:function(t){this.isOpened()&&ze(t.target,"htCore")&&Le(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}]),t}();ct(Oz,Zv);var kz=Oz;function Rz(t){return Rz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rz(t)}function Ez(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pz(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,jz(r.key),r)}}function Tz(t,e,n){return e&&Pz(t.prototype,e),n&&Pz(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function jz(t){var e=Mz(t,"string");return"symbol"===Rz(e)?e:String(e)}function Mz(t,e){if("object"!==Rz(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Rz(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Az(){return Az="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Iz(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Az.apply(this,arguments)}function Iz(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Bz(t),null===t)break;return t}function xz(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_z(t,e)}function _z(t,e){return _z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_z(t,e)}function Hz(t){var e=Lz();return function(){var n,r=Bz(t);if(e){var o=Bz(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Nz(this,n)}}function Nz(t,e){if(e&&("object"===Rz(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Dz(t)}function Dz(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Lz(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Bz(t){return Bz=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Bz(t)}var Vz="contextMenu",Fz=70;mr.getSingleton().register("afterContextMenuDefaultOptions"),mr.getSingleton().register("beforeContextMenuShow"),mr.getSingleton().register("afterContextMenuShow"),mr.getSingleton().register("afterContextMenuHide"),mr.getSingleton().register("afterContextMenuExecute");var Wz=function(t){xz(n,t);var e=Hz(n);function n(t){var r;return Ez(this,n),r=e.call(this,t),r.eventManager=new Gr(Dz(r)),r.commandExecutor=new rU(r.hot),r.itemsFactory=null,r.menu=null,r}return Tz(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Vz]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[Vz];"function"===typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new kz(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(function(){return t.onMenuBeforeOpen()})),this.menu.addLocalHook("afterOpen",(function(){return t.onMenuAfterOpen()})),this.menu.addLocalHook("afterClose",(function(){return t.onMenuAfterClose()})),this.menu.addLocalHook("executeCommand",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.executeCommand).call.apply(e,[t].concat(r))})),this.addHook("afterOnCellContextMenu",(function(e){return t.onAfterOnCellContextMenu(e)})),Az(Bz(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Az(Bz(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),Az(Bz(n.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(t){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),this.menu.isOpened())){var e=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var r=this.hot.rootWindow.frameElement,o=r.getBoundingClientRect(),i=o.top,a=o.left;e=i-en(t.view),n=a-nn(t.view)}else e=-1*en(this.menu.hotMenu.rootWindow),n=-1*nn(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(t.pageY,10)+e,left:parseInt(t.pageX,10)+n})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(t){var e;null===this.itemsFactory&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=this.commandExecutor).execute.apply(e,[t].concat(r))}},{key:"prepareMenuItems",value:function(){var t=this;this.itemsFactory=new nz(this.hot,n.DEFAULT_ITEMS);var e=this.hot.getSettings()[Vz],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);var o=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",o),this.menu.setMenuItems(o),U(o,(function(e){return t.commandExecutor.registerCommand(e.key,e)}))}},{key:"onAfterOnCellContextMenu",value:function(t){var e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function o(t){return"TD"===t.nodeName||"TD"===t.parentNode.nodeName}var i=t.target;this.close(),ze(i,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),(n||r||o(i)||ze(i,"current")&&ze(i,"wtBorder"))&&this.open(t))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Az(Bz(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Vz}},{key:"PLUGIN_PRIORITY",get:function(){return Fz}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[IU,_U,$F,sU,cU,$F,MU,CU,$F,BU,pU,$F,hU,$F,oU]}}]),n}(RH);function Uz(t){return{key:"copy",name:function(){return this.getTranslatedPhrase(zw)},callback:function(){t.copyCellsOnly()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}function zz(t){return{key:"copy_column_headers_only",name:function(){var t=this.getSelectedRangeLast(),e=t?Math.min(t.getWidth()-1,1):0;return this.getTranslatedPhrase(Kw,e)},callback:function(){t.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}function Gz(t){return{key:"copy_with_column_group_headers",name:function(){var t=this.getSelectedRangeLast(),e=t?Math.min(t.getWidth()-1,1):0;return this.getTranslatedPhrase(Yw,e)},callback:function(){t.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}function Yz(t){return{key:"copy_with_column_headers",name:function(){var t=this.getSelectedRangeLast(),e=t?Math.min(t.getWidth()-1,1):0;return this.getTranslatedPhrase(Gw,e)},callback:function(){t.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}function Kz(t){return{key:"cut",name:function(){return this.getTranslatedPhrase(Xw)},callback:function(){t.cut()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var t=this.getSelected();return!t||t.length>1},hidden:!1}}function Xz(t){return Xz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xz(t)}function $z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qz(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Jz(r.key),r)}}function Qz(t,e,n){return e&&qz(t.prototype,e),n&&qz(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Jz(t){var e=Zz(t,"string");return"symbol"===Xz(e)?e:String(e)}function Zz(t,e){if("object"!==Xz(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Xz(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}Wz.SEPARATOR={name:$F};var tG=function(){function t(){$z(this,t),this.data={}}return Qz(t,[{key:"setData",value:function(t,e){this.data[t]=e}},{key:"getData",value:function(t){return this.data[t]||void 0}}]),t}();function eG(t){return eG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eG(t)}function nG(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,oG(r.key),r)}}function rG(t,e,n){return e&&nG(t.prototype,e),n&&nG(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function oG(t){var e=iG(t,"string");return"symbol"===eG(e)?e:String(e)}function iG(t,e){if("object"!==eG(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==eG(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function aG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var lG=rG((function t(){aG(this,t),this.clipboardData=new tG}));function sG(t){return sG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sG(t)}function uG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cG(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,hG(r.key),r)}}function fG(t,e,n){return e&&cG(t.prototype,e),n&&cG(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function hG(t){var e=dG(t,"string");return"symbol"===sG(e)?e:String(e)}function dG(t,e){if("object"!==sG(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==sG(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var pG=function(){function t(e){uG(this,t),this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new Gr(this),this.listenersCount=new WeakSet,this.container=e}return fG(t,[{key:"useSecondaryElement",value:function(){var t=SG(this.container);this.listenersCount.has(t)||(this.listenersCount.add(t),bG(this.eventManager,t,this)),this.mainElement=t}},{key:"setFocusableElement",value:function(t){this.listenersCount.has(t)||(this.listenersCount.add(t),bG(this.eventManager,t,this)),this.mainElement=t}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Ht()||An(this.mainElement)}}]),t}();ct(pG,Zv);var yG=new WeakMap;function vG(t){var e=new pG(t),n=yG.get(t);return n=isNaN(n)?0:n,yG.set(t,n+1),e}function mG(t){t.eventManager.clear()}var gG=function(t,e){return function(n){return e.runLocalHooks(t,n)}};function bG(t,e,n){t.addEventListener(e,"copy",gG("copy",n)),t.addEventListener(e,"cut",gG("cut",n)),t.addEventListener(e,"paste",gG("paste",n))}var wG=new WeakMap;function SG(t){var e=wG.get(t);if(e)return e.parentElement||t.appendChild(e),e;var n=t.defaultView?t:t.ownerDocument,r=n.createElement("textarea");return wG.set(t,r),r.setAttribute("data-hot-input",""),r.className="HandsontableCopyPaste",r.tabIndex=-1,r.autocomplete="off",r.wrap="hard",r.value=" ",t.appendChild(r),r}function CG(t){if(t instanceof pG){var e=yG.get(t.container);if(e=isNaN(e)?0:e,e>0&&(e-=1),mG(t),e<=0){e=0;var n=wG.get(t.container);n&&n.parentNode&&(n.parentNode.removeChild(n),wG.delete(t.container)),t.mainElement=null}yG.set(t.container,e)}}function OG(t){return OG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OG(t)}function kG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function RG(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,PG(r.key),r)}}function EG(t,e,n){return e&&RG(t.prototype,e),n&&RG(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function PG(t){var e=TG(t,"string");return"symbol"===OG(e)?e:String(e)}function TG(t,e){if("object"!==OG(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==OG(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function jG(t,e){AG(t,e),e.add(t)}function MG(t,e,n){AG(t,e),e.set(t,n)}function AG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IG(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function xG(t,e){var n=NG(t,e,"get");return _G(t,n)}function _G(t,e){return e.get?e.get.call(t):e.value}function HG(t,e,n){var r=NG(t,e,"set");return DG(t,r,n),n}function NG(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function DG(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var LG=new WeakMap,BG=new WeakMap,VG=new WeakMap,FG=new WeakMap,WG=new WeakMap,UG=new WeakMap,zG=new WeakSet,GG=new WeakSet,YG=function(){function t(e){var n=e.countRows,r=e.countColumns,o=e.rowsLimit,i=e.columnsLimit,a=e.countColumnHeaders;kG(this,t),jG(this,GG),jG(this,zG),MG(this,LG,{writable:!0,value:void 0}),MG(this,BG,{writable:!0,value:void 0}),MG(this,VG,{writable:!0,value:void 0}),MG(this,FG,{writable:!0,value:void 0}),MG(this,WG,{writable:!0,value:void 0}),MG(this,UG,{writable:!0,value:void 0}),HG(this,BG,n),HG(this,VG,r),HG(this,FG,o),HG(this,WG,i),HG(this,UG,a)}return EG(t,[{key:"setSelectedRange",value:function(t){HG(this,LG,t)}},{key:"getCellsRange",value:function(){if(0===xG(this,BG).call(this)||0===xG(this,VG).call(this))return null;var t=xG(this,LG).getTopStartCorner(),e=t.row,n=t.col,r=xG(this,LG).getBottomEndCorner(),o=r.row,i=r.col,a=IG(this,GG,XG).call(this,e,o),l=IG(this,zG,KG).call(this,n,i),s=o!==a||i!==l;return{isRangeTrimmed:s,startRow:e,startCol:n,endRow:a,endCol:l}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(0===xG(this,VG).call(this)||0===xG(this,UG).call(this))return null;var t=xG(this,LG).getTopStartCorner(),e=t.col,n=xG(this,LG).getBottomEndCorner(),r=n.col,o=IG(this,zG,KG).call(this,e,r),i=r!==o;return{isRangeTrimmed:i,startRow:-1,startCol:e,endRow:-1,endCol:o}}},{key:"getAllColumnHeadersRange",value:function(){if(0===xG(this,VG).call(this)||0===xG(this,UG).call(this))return null;var t=xG(this,LG).getTopStartCorner(),e=t.col,n=xG(this,LG).getBottomEndCorner(),r=n.col,o=IG(this,zG,KG).call(this,e,r),i=r!==o;return{isRangeTrimmed:i,startRow:-xG(this,UG).call(this),startCol:e,endRow:-1,endCol:o}}}]),t}();function KG(t,e){return Math.min(e,Math.max(t+xG(this,WG).call(this)-1,t))}function XG(t,e){return Math.min(e,Math.max(t+xG(this,FG).call(this)-1,t))}function $G(t){var e=[],n=[];return U(t,(function(t){var r=Math.min(t.startRow,t.endRow),o=Math.max(t.startRow,t.endRow);Ho(r,o,(function(t){-1===e.indexOf(t)&&e.push(t)}));var i=Math.min(t.startCol,t.endCol),a=Math.max(t.startCol,t.endCol);Ho(i,a,(function(t){-1===n.indexOf(t)&&n.push(t)}))})),{rows:e,columns:n}}function qG(t,e){return eY(t)||tY(t,e)||JG(t,e)||QG()}function QG(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function JG(t,e){if(t){if("string"===typeof t)return ZG(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ZG(t,e):void 0}}function ZG(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function tY(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function eY(t){if(Array.isArray(t))return t}function nY(t){return nY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nY(t)}function rY(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oY(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bY(r.key),r)}}function iY(t,e,n){return e&&oY(t.prototype,e),n&&oY(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function aY(){return aY="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=lY(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},aY.apply(this,arguments)}function lY(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=pY(t),null===t)break;return t}function sY(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uY(t,e)}function uY(t,e){return uY=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},uY(t,e)}function cY(t){var e=dY();return function(){var n,r=pY(t);if(e){var o=pY(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fY(this,n)}}function fY(t,e){if(e&&("object"===nY(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return hY(t)}function hY(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dY(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function pY(t){return pY=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pY(t)}function yY(t,e){mY(t,e),e.add(t)}function vY(t,e,n){mY(t,e),e.set(t,n)}function mY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gY(t,e,n){return e=bY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bY(t){var e=wY(t,"string");return"symbol"===nY(e)?e:String(e)}function wY(t,e){if("object"!==nY(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==nY(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function SY(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function CY(t,e){var n=RY(t,e,"get");return OY(t,n)}function OY(t,e){return e.get?e.get.call(t):e.value}function kY(t,e,n){var r=RY(t,e,"set");return EY(t,r,n),n}function RY(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function EY(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}mr.getSingleton().register("afterCopyLimit"),mr.getSingleton().register("modifyCopyableRange"),mr.getSingleton().register("beforeCut"),mr.getSingleton().register("afterCut"),mr.getSingleton().register("beforePaste"),mr.getSingleton().register("afterPaste"),mr.getSingleton().register("beforeCopy"),mr.getSingleton().register("afterCopy");var PY="copyPaste",TY=80,jY=["fragmentSelection"],MY=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),AY=new WeakMap,IY=new WeakMap,xY=new WeakMap,_Y=new WeakMap,HY=new WeakMap,NY=new WeakMap,DY=new WeakMap,LY=new WeakSet,BY=function(t){sY(n,t);var e=cY(n);function n(){var t;rY(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),yY(hY(t),LY),gY(hY(t),"columnsLimit",1/0),gY(hY(t),"rowsLimit",1/0),gY(hY(t),"pasteMode","overwrite"),gY(hY(t),"uiContainer",t.hot.rootDocument.body),vY(hY(t),AY,{writable:!0,value:!1}),vY(hY(t),IY,{writable:!0,value:!1}),vY(hY(t),xY,{writable:!0,value:!1}),vY(hY(t),_Y,{writable:!0,value:"cells-only"}),vY(hY(t),HY,{writable:!0,value:!1}),vY(hY(t),NY,{writable:!0,value:!1}),vY(hY(t),DY,{writable:!0,value:new YG({countRows:function(){return t.hot.countRows()},countColumns:function(){return t.hot.countCols()},rowsLimit:function(){return t.rowsLimit},columnsLimit:function(){return t.columnsLimit},countColumnHeaders:function(){return t.hot.view.getColumnHeadersCount()}})}),gY(hY(t),"copyableRanges",[]),gY(hY(t),"focusableElement",void 0),t}return iY(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[PY]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e,r,o=this.hot.getSettings(),i=o[PY];if("object"===nY(i))this.pasteMode=null!==(e=i.pasteMode)&&void 0!==e?e:this.pasteMode,this.rowsLimit=isNaN(i.rowsLimit)?this.rowsLimit:i.rowsLimit,this.columnsLimit=isNaN(i.columnsLimit)?this.columnsLimit:i.columnsLimit,kY(this,AY,!!i.copyColumnHeaders),kY(this,IY,!!i.copyColumnGroupHeaders),kY(this,xY,!!i.copyColumnHeadersOnly),this.uiContainer=null!==(r=i.uiContainer)&&void 0!==r?r:this.uiContainer;this.addHook("afterContextMenuDefaultOptions",(function(e){return t.onAfterContextMenuDefaultOptions(e)})),this.addHook("afterOnCellMouseUp",(function(){return t.onAfterOnCellMouseUp()})),this.addHook("afterSelectionEnd",(function(){return t.onAfterSelectionEnd()})),this.addHook("beforeKeyDown",(function(){return t.onBeforeKeyDown()})),this.focusableElement=vG(this.uiContainer),this.focusableElement.addLocalHook("copy",(function(e){return t.onCopy(e)})).addLocalHook("cut",(function(e){return t.onCut(e)})).addLocalHook("paste",(function(e){return t.onPaste(e)})),aY(pY(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),aY(pY(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&CG(this.focusableElement),aY(pY(n.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only";kY(this,_Y,t),kY(this,HY,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){kY(this,NY,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(t){return FP(this.getRangedData(t))}},{key:"getRangedData",value:function(t){var e=this,n=[],r=$G(t),o=r.rows,i=r.columns;return U(o,(function(t){var r=[];U(i,(function(n){t<0?r.push(e.hot.getColHeader(n,t)):r.push(e.hot.getCopyableData(t,n))})),n.push(r)})),n}},{key:"paste",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(t||e){var n=new lG;t&&n.clipboardData.setData("text/plain",t),e&&n.clipboardData.setData("text/html",e),this.getOrCreateFocusableElement(),this.onPaste(n)}}},{key:"setCopyableText",value:function(){var t=this.hot.getSelectedRangeLast();if(t){CY(this,DY).setSelectedRange(t);var e=new Map([["headers",null],["cells",null]]);"column-headers-only"===CY(this,_Y)?e.set("headers",CY(this,DY).getMostBottomColumnHeadersRange()):("with-column-headers"===CY(this,_Y)?e.set("headers",CY(this,DY).getMostBottomColumnHeadersRange()):"with-column-group-headers"===CY(this,_Y)&&e.set("headers",CY(this,DY).getAllColumnHeadersRange()),e.set("cells",CY(this,DY).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter((function(t){return null!==t})).map((function(t){var e=t.startRow,n=t.startCol,r=t.endRow,o=t.endCol;return{startRow:e,startCol:n,endRow:r,endCol:o}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var n=e.get("cells");if(null!==n&&n.isRangeTrimmed){var r=n.startRow,o=n.startCol,i=n.endRow,a=n.endCol;this.hot.runHooks("afterCopyLimit",i-r+1,a-o+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var t,e=null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.TEXTAREA;e?this.focusableElement.setFocusableElement(e):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}},{key:"populateValues",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(t.length){var n=t.length,r=t[0].length,o=[],i=e.getTopStartCorner(),a=i.row,l=i.col,s=e.getBottomEndCorner(),u=s.row,c=s.col,f=a,h=l,d=a,p=l;while(o.length<n||f<=u){var y=this.hot.getCellMeta(f,l),v=y.skipRowOnPaste,m=y.visualRow;if(f=m+1,!0!==v){d=m,h=l;var g=[],b=o.length%n;while(g.length<r||h<=c){var w=this.hot.getCellMeta(a,h),S=w.skipColumnOnPaste,C=w.visualCol;if(h=C+1,!0!==S){p=C;var O=g.length%r;g.push(t[b][O])}}o.push(g)}}return this.hot.populateFromArray(a,l,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,d,p]}}},{key:"onCopy",value:function(t){if((this.hot.isListening()||CY(this,HY))&&!this.isEditorOpened()){this.setCopyableText(),kY(this,HY,!1);var e=this.getRangedData(this.copyableRanges),n=SY(this,LY,VY).call(this,this.copyableRanges),r=!!this.hot.runHooks("beforeCopy",e,this.copyableRanges,n);if(r){var o=FP(e);if(t&&t.clipboardData){var i=ko(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",o),t.clipboardData.setData("text/html",[MY,i].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",e,this.copyableRanges,n)}kY(this,_Y,"cells-only"),t.preventDefault()}}},{key:"onCut",value:function(t){if((this.hot.isListening()||CY(this,NY))&&!this.isEditorOpened()){this.setCopyableText(),kY(this,NY,!1);var e=this.getRangedData(this.copyableRanges),n=!!this.hot.runHooks("beforeCut",e,this.copyableRanges);if(n){var r=FP(e);if(t&&t.clipboardData){var o=ko(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",r),t.clipboardData.setData("text/html",[MY,o].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",e,this.copyableRanges)}t.preventDefault()}}},{key:"onPaste",value:function(t){if(this.hot.isListening()&&!this.isEditorOpened()){var e;if(t&&t.preventDefault&&t.preventDefault(),t&&"undefined"!==typeof t.clipboardData){var n=Re(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(n&&/(<table)|(<TABLE)/g.test(n)){var r=Ro(n,this.hot.rootDocument);e=r.data}else e=t.clipboardData.getData("text/plain")}else"undefined"===typeof ClipboardEvent&&"undefined"!==typeof this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));if("string"===typeof e&&(e=VP(e)),(!e||0!==e.length)&&!1!==this.hot.runHooks("beforePaste",e,this.copyableRanges)){var o=this.populateValues(e),i=qG(o,4),a=i[0],l=i[1],s=i[2],u=i[3];this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,s),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",e,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(t){t.items.push({name:"---------"},Uz(this)),CY(this,AY)&&t.items.push(Yz(this)),CY(this,IY)&&t.items.push(Gz(this)),CY(this,xY)&&t.items.push(zz(this)),t.items.push(Kz(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&bn()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var t=this.hot.rootDocument.activeElement,e=this.hot.getActiveEditor();!e||t!==this.focusableElement.getFocusableElement()&&t!==e.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(CG(this.focusableElement),this.focusableElement=null),aY(pY(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PY}},{key:"SETTING_KEYS",get:function(){return[PY].concat(jY)}},{key:"PLUGIN_PRIORITY",get:function(){return TY}}]),n}(RH);function VY(t){for(var e=$G(t),n=e.rows,r=0,o=0;o<n.length;o++){if(n[o]>=0)break;r+=1}return{columnHeadersCount:r}}function FY(t,e){return"border_row".concat(t,"col").concat(e)}function WY(){return{width:1,color:"#000"}}function UY(){return{hide:!0}}function zY(){return{width:1,color:"#000",cornerVisible:!1}}function GY(t){var e,n;(Zt(t.start)||Zt(t.left))&&(t.start=null!==(e=t.start)&&void 0!==e?e:t.left);(Zt(t.end)||Zt(t.right))&&(t.end=null!==(n=t.end)&&void 0!==n?n:t.right);return delete t.left,delete t.right,t}function YY(t){return Zt(t.start)&&(t.left=t.start),Zt(t.end)&&(t.right=t.end),t}function KY(t,e){return{id:FY(t,e),border:zY(),row:t,col:e,top:UY(),bottom:UY(),start:UY(),end:UY()}}function XY(t,e){return bt(e,"border")&&e.border&&(t.border=e.border),bt(e,"top")&&Zt(e.top)&&(e.top?(ht(e.top)||(e.top=WY()),t.top=e.top):(e.top=UY(),t.top=e.top)),bt(e,"bottom")&&Zt(e.bottom)&&(e.bottom?(ht(e.bottom)||(e.bottom=WY()),t.bottom=e.bottom):(e.bottom=UY(),t.bottom=e.bottom)),bt(e,"start")&&Zt(e.start)&&(e.start?(ht(e.start)||(e.start=WY()),t.start=e.start):(e.start=UY(),t.start=e.start)),bt(e,"end")&&Zt(e.end)&&(e.end?(ht(e.end)||(e.end=WY()),t.end=e.end):(e.end=UY(),t.end=e.end)),t}function $Y(t,e){var n=!1;return U(t.getSelectedRange(),(function(r){r.forAll((function(r,o){if(!(r<0||o<0)){var i=t.getCellMeta(r,o).borders;if(i){if(!e)return n=!0,!1;if(!bt(i[e],"hide")||!1===i[e].hide)return n=!0,!1}}}))})),n}function qY(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function QY(t){return t.some((function(t){return Zt(t.left)||Zt(t.right)}))}function JY(t){return t.some((function(t){return Zt(t.start)||Zt(t.end)}))}var ZY=new Map([["left","start"],["right","end"]]);function tK(t){var e;return null!==(e=ZY.get(t))&&void 0!==e?e:t}function eK(t){return{key:"borders:top",name:function(){var t=this.getTranslatedPhrase(hS),e=$Y(this,"top");return e&&(t=qY(t)),t},callback:function(e,n){var r=$Y(this,"top");t.prepareBorder(n,"top",r)}}}function nK(t){var e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var t=this.getTranslatedPhrase(dS),n=$Y(this,e);return n&&(t=qY(t)),t},callback:function(n,r){var o=$Y(this,e);t.prepareBorder(r,e,o)}}}function rK(t){return{key:"borders:bottom",name:function(){var t=this.getTranslatedPhrase(pS),e=$Y(this,"bottom");return e&&(t=qY(t)),t},callback:function(e,n){var r=$Y(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function oK(t){var e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var t=this.getTranslatedPhrase(yS),n=$Y(this,e);return n&&(t=qY(t)),t},callback:function(n,r){var o=$Y(this,e);t.prepareBorder(r,e,o)}}}function iK(t){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(vS)},callback:function(e,n){t.prepareBorder(n,"noBorders")},disabled:function(){return!$Y(this)}}}function aK(t){return aK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aK(t)}function lK(t,e){return hK(t)||fK(t,e)||uK(t,e)||sK()}function sK(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function uK(t,e){if(t){if("string"===typeof t)return cK(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cK(t,e):void 0}}function cK(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function fK(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function hK(t){if(Array.isArray(t))return t}function dK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pK(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,EK(r.key),r)}}function yK(t,e,n){return e&&pK(t.prototype,e),n&&pK(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function vK(){return vK="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=mK(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},vK.apply(this,arguments)}function mK(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=kK(t),null===t)break;return t}function gK(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bK(t,e)}function bK(t,e){return bK=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},bK(t,e)}function wK(t){var e=OK();return function(){var n,r=kK(t);if(e){var o=kK(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return SK(this,n)}}function SK(t,e){if(e&&("object"===aK(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return CK(t)}function CK(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function OK(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function kK(t){return kK=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},kK(t)}function RK(t,e,n){return e=EK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EK(t){var e=PK(t,"string");return"symbol"===aK(e)?e:String(e)}function PK(t,e){if("object"!==aK(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==aK(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var TK="customBorders",jK=90,MK=function(t){gK(n,t);var e=wK(n);function n(){var t;dK(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),RK(CK(t),"savedBorders",[]),t}return yK(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[TK]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(e){return t.onAfterContextMenuDefaultOptions(e)})),this.addHook("init",(function(){return t.onAfterInit()})),vK(kK(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),vK(kK(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),vK(kK(n.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(t,e){var n=this,r=["top","bottom","start","end"],o=null;e&&(this.checkSettingsCohesion([e]),r=Object.keys(e),o=GY(e));var i=DR(t),a=LR(i);U(t,(function(t){for(var e=a(t),i=lK(e,4),l=i[0],s=i[1],u=i[2],c=i[3],f=function(t){for(var e=function(e){U(r,(function(r){n.prepareBorderFromCustomAdded(t,e,o,tK(r))}))},i=s;i<=c;i+=1)e(i)},h=l;h<=u;h+=1)f(h)})),this.hot.view.render()}},{key:"getBorders",value:function(t){var e=this;if(!Array.isArray(t))return this.savedBorders;var n=DR(t),r=LR(n),o=[];return U(t,(function(t){for(var n=r(t),i=lK(n,4),a=i[0],l=i[1],s=i[2],u=i[3],c=function(t){for(var n=function(n){U(e.savedBorders,(function(e){e.row===t&&e.col===n&&o.push(YY(e))}))},r=l;r<=u;r+=1)n(r)},f=a;f<=s;f+=1)c(f)})),o}},{key:"clearBorders",value:function(t){var e=this;t?this.setBorders(t):(U(this.savedBorders,(function(t){e.clearBordersFromSelectionSettings(t.id),e.clearNullCellRange(),e.hot.removeCellMeta(t.row,t.col,"borders")})),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(t,e){var n=this.checkSavedBorders(t);n||this.savedBorders.push(t);var r=this.hot._createCellRange(this.hot._createCellCoords(t.row,t.col)),o=this.checkCustomSelections(t,r,e);o||this.hot.selection.highlight.addCustomSelection({border:t,visualCellRange:r})}},{key:"prepareBorderFromCustomAdded",value:function(t,e,n,r){var o=this.hot.countRows(),i=this.hot.countCols();if(!(t>=o||e>=i)){var a=KY(t,e);n&&(a=XY(a,n),U(this.hot.selection.highlight.customSelections,(function(t){if(a.id===t.settings.id)return Object.assign(t.settings,n),a.id=t.settings.id,a.top=t.settings.top,a.bottom=t.settings.bottom,a.start=t.settings.start,a.end=t.settings.end,!1}))),this.hot.setCellMeta(t,e,"borders",YY(a)),this.insertBorderIntoSettings(a,r)}}},{key:"prepareBorderFromCustomAddedRange",value:function(t,e){var n=this,r=Math.min(t.to.row,this.hot.countRows()-1),o=Math.min(t.to.col,this.hot.countCols()-1);Ho(t.from.row,r,(function(r){Ho(t.from.col,o,(function(o){var i=KY(r,o),a=0;r===t.from.row&&bt(e,"top")&&(a+=1,i.top=e.top),r===t.to.row&&bt(e,"bottom")&&(a+=1,i.bottom=e.bottom),o===t.from.col&&bt(e,"start")&&(a+=1,i.start=e.start),o===t.to.col&&bt(e,"end")&&(a+=1,i.end=e.end),a>0&&(n.hot.setCellMeta(r,o,"borders",YY(i)),n.insertBorderIntoSettings(i))}))}))}},{key:"removeAllBorders",value:function(t,e){var n=FY(t,e);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}},{key:"setBorder",value:function(t,e,n,r){var o=this.hot.getCellMeta(t,e).borders;if(o=o&&void 0!==o.border?GY(o):KY(t,e),r){o[n]=UY();var i=this.countHide(o);if(4===i)this.removeAllBorders(t,e);else{var a=this.checkCustomSelectionsFromContextMenu(o,n,r);a||this.insertBorderIntoSettings(o),this.hot.setCellMeta(t,e,"borders",YY(o))}}else{o[n]=WY();var l=this.checkCustomSelectionsFromContextMenu(o,n,r);l||this.insertBorderIntoSettings(o),this.hot.setCellMeta(t,e,"borders",YY(o))}}},{key:"prepareBorder",value:function(t,e,n){var r=this;U(t,(function(t){var o=t.start,i=t.end;if(o.row===i.row&&o.col===i.col)"noBorders"===e?r.removeAllBorders(o.row,o.col):r.setBorder(o.row,o.col,e,n);else switch(e){case"noBorders":Ho(o.col,i.col,(function(t){Ho(o.row,i.row,(function(e){r.removeAllBorders(e,t)}))}));break;case"top":Ho(o.col,i.col,(function(t){r.setBorder(o.row,t,e,n)}));break;case"bottom":Ho(o.col,i.col,(function(t){r.setBorder(i.row,t,e,n)}));break;case"start":Ho(o.row,i.row,(function(t){r.setBorder(t,o.col,e,n)}));break;case"end":Ho(o.row,i.row,(function(t){r.setBorder(t,i.col,e,n)}));break;default:break}}))}},{key:"createCustomBorders",value:function(t){var e=this;U(t,(function(t){var n=GY(t);t.range?e.prepareBorderFromCustomAddedRange(t.range,n):e.prepareBorderFromCustomAdded(t.row,t.col,n)}))}},{key:"countHide",value:function(t){var e=t.top,n=t.bottom,r=t.start,o=t.end,i=[e,n,r,o];return V(i,(function(t,e){var n=t;return e&&e.hide&&(n+=1),n}),0)}},{key:"clearBordersFromSelectionSettings",value:function(t){var e=W(this.hot.selection.highlight.customSelections,(function(t){return t.settings.id})).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear()}},{key:"clearNullCellRange",value:function(){var t=this;U(this.hot.selection.highlight.customSelections,(function(e,n){if(null===e.cellRange)return t.hot.selection.highlight.customSelections[n].destroy(),t.hot.selection.highlight.customSelections.splice(n,1),!1}))}},{key:"hideBorders",value:function(){var t=this;U(this.savedBorders,(function(e){t.clearBordersFromSelectionSettings(e.id),t.clearNullCellRange()}))}},{key:"spliceBorder",value:function(t){var e=W(this.savedBorders,(function(t){return t.id})).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}},{key:"checkSavedBorders",value:function(t){var e=this,n=!1,r=this.countHide(t);return 4===r?(this.spliceBorder(t.id),n=!0):U(this.savedBorders,(function(r,o){if(t.id===r.id)return e.savedBorders[o]=t,n=!0,!1})),n}},{key:"checkCustomSelectionsFromContextMenu",value:function(t,e,n){var r=!1;return U(this.hot.selection.highlight.customSelections,(function(o){if(t.id===o.settings.id)return pt(o.instanceBorders,(function(t){t.toggleHiddenClass(e,n)})),r=!0,!1})),r}},{key:"checkCustomSelections",value:function(t,e,n){var r=this.countHide(t),o=!1;return 4===r?(this.removeAllBorders(t.row,t.col),o=!0):U(this.hot.selection.highlight.customSelections,(function(r){if(t.id===r.settings.id)return r.visualCellRange=e,r.commit(),n&&pt(r.instanceBorders,(function(e){e.changeBorderStyle(n,t)})),o=!0,!1})),o}},{key:"changeBorderSettings",value:function(){var t=this.hot.getSettings()[TK];if(Array.isArray(t)){var e=st(t);this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)}else void 0!==t&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(t){var e=QY(t),n=JY(t);if(e&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&e)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(t){this.hot.getSettings()[TK]&&t.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(fS)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[eK(this),nK(this),rK(this),oK(this),iK(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){vK(kK(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return TK}},{key:"PLUGIN_PRIORITY",get:function(){return jK}}]),n}(RH);function AK(t){return AK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AK(t)}function IK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xK(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,HK(r.key),r)}}function _K(t,e,n){return e&&xK(t.prototype,e),n&&xK(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function HK(t){var e=NK(t,"string");return"symbol"===AK(e)?e:String(e)}function NK(t,e){if("object"!==AK(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==AK(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function DK(){return DK="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=LK(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},DK.apply(this,arguments)}function LK(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=GK(t),null===t)break;return t}function BK(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&VK(t,e)}function VK(t,e){return VK=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},VK(t,e)}function FK(t){var e=zK();return function(){var n,r=GK(t);if(e){var o=GK(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return WK(this,n)}}function WK(t,e){if(e&&("object"===AK(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return UK(t)}function UK(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zK(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function GK(t){return GK=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},GK(t)}var YK="dragToScroll",KK=100,XK=function(t){BK(n,t);var e=FK(n);function n(t){var r;return IK(this,n),r=e.call(this,t),r.eventManager=new Gr(UK(r)),r.boundaries=null,r.callback=null,r.listening=!1,r}return _K(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[YK]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterOnCellMouseDown",(function(e){return t.setupListening(e)})),this.addHook("afterOnCellCornerMouseDown",(function(e){return t.setupListening(e)})),this.registerEvents(),DK(GK(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),DK(GK(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),DK(GK(n.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(t){this.boundaries=t}},{key:"setCallback",value:function(t){this.callback=t}},{key:"check",value:function(t,e){var n=0,r=0;e<this.boundaries.top?r=e-this.boundaries.top:e>this.boundaries.bottom&&(r=e-this.boundaries.bottom),t<this.boundaries.left?n=t-this.boundaries.left:t>this.boundaries.right&&(n=t-this.boundaries.right),this.callback(n,r)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootWindow,n=e;while(n)this.eventManager.addEventListener(n.document,"contextmenu",(function(){return t.unlisten()})),this.eventManager.addEventListener(n.document,"mouseup",(function(){return t.unlisten()})),this.eventManager.addEventListener(n.document,"mousemove",(function(e){return t.onMouseMove(e)})),n=_e(n)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(t){if(!Zn(t)){var e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback((function(t,n){t<0?e.scrollLeft-=50:t>0&&(e.scrollLeft+=50),n<0?e.scrollTop-=20:n>0&&(e.scrollTop+=20)})),this.listen())}}},{key:"onMouseMove",value:function(t){this.isListening()&&this.check(t.clientX,t.clientY)}},{key:"destroy",value:function(){DK(GK(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return YK}},{key:"PLUGIN_PRIORITY",get:function(){return KK}}]),n}(RH);function $K(t){return $K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$K(t)}function qK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QK(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ZK(r.key),r)}}function JK(t,e,n){return e&&QK(t.prototype,e),n&&QK(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZK(t){var e=tX(t,"string");return"symbol"===$K(e)?e:String(e)}function tX(t,e){if("object"!==$K(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==$K(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function eX(){return eX="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=nX(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},eX.apply(this,arguments)}function nX(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=uX(t),null===t)break;return t}function rX(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oX(t,e)}function oX(t,e){return oX=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},oX(t,e)}function iX(t){var e=sX();return function(){var n,r=uX(t);if(e){var o=uX(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return aX(this,n)}}function aX(t,e){if(e&&("object"===$K(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return lX(t)}function lX(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sX(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function uX(t){return uX=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},uX(t)}mr.getSingleton().register("afterDropdownMenuDefaultOptions"),mr.getSingleton().register("beforeDropdownMenuShow"),mr.getSingleton().register("afterDropdownMenuShow"),mr.getSingleton().register("afterDropdownMenuHide"),mr.getSingleton().register("afterDropdownMenuExecute");var cX="dropdownMenu",fX=230,hX="changeType",dX=function(t){rX(n,t);var e=iX(n);function n(t){var r;return qK(this,n),r=e.call(this,t),r.eventManager=new Gr(lX(r)),r.commandExecutor=new rU(r.hot),r.itemsFactory=null,r.menu=null,r.hot.addHook("afterGetColHeader",(function(t,e){return r.onAfterGetColHeader(t,e)})),r}return JK(n,[{key:"isEnabled",value:function(){return this.hot.getSettings()[cX]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.itemsFactory=new nz(this.hot,n.DEFAULT_ITEMS);var e=this.hot.getSettings()[cX],r={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"===typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),eX(uX(n.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady((function(){t.hot.runHooks("afterDropdownMenuDefaultOptions",r),t.itemsFactory.setPredefinedItems(r.items);var n=t.itemsFactory.getItems(e);t.menu&&t.menu.destroy(),t.menu=new kz(t.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||t.hot.rootDocument.body}),t.hot.runHooks("beforeDropdownMenuSetItems",n),t.menu.setMenuItems(n),t.menu.addLocalHook("beforeOpen",(function(){return t.onMenuBeforeOpen()})),t.menu.addLocalHook("afterOpen",(function(){return t.onMenuAfterOpen()})),t.menu.addLocalHook("afterClose",(function(){return t.onMenuAfterClose()})),t.menu.addLocalHook("executeCommand",(function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.executeCommand).call.apply(e,[t].concat(r))})),U(n,(function(e){return t.commandExecutor.registerCommand(e.key,e)}))}))}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),eX(uX(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),eX(uX(n.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var t=this;this.eventManager.addEventListener(this.hot.rootElement,"click",(function(e){return t.onTableClick(e)}))}},{key:"open",value:function(t){this.menu&&(this.menu.open(),t.width&&this.menu.setOffset("left",t.width),this.menu.setPosition(t))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=this.commandExecutor).execute.apply(e,[t].concat(r))}},{key:"setListening",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(t){if(t.stopPropagation(),ze(t.target,hX)&&!this.menu.isOpened()){var e=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var r=this.hot.rootWindow.frameElement,o=r.getBoundingClientRect(),i=o.top,a=o.left;e=i,n=a}var l=t.target.getBoundingClientRect();this.open({left:l.left+n,top:l.top+t.target.offsetHeight+3+e,width:l.width,height:l.height})}}},{key:"onAfterGetColHeader",value:function(t,e){var n=e.parentNode;if(n){var r=n.parentNode.childNodes,o=Array.prototype.indexOf.call(r,n);if(!(t<0||o!==r.length-1)){var i=e.querySelector(".".concat(hX));if(!this.enabled||!i)if(this.enabled){var a=this.hot.rootDocument.createElement("button");a.className=hX,a.type="button",a.onclick=function(){return!1},e.firstChild.insertBefore(a,e.firstChild.firstChild)}else i&&i.parentNode.removeChild(i)}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),eX(uX(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return cX}},{key:"PLUGIN_PRIORITY",get:function(){return fX}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[sU,cU,$F,CU,$F,aU,$F,hU,$F,oU]}}]),n}(RH);function pX(t){return pX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pX(t)}function yX(t,e){return wX(t)||bX(t,e)||mX(t,e)||vX()}function vX(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function mX(t,e){if(t){if("string"===typeof t)return gX(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gX(t,e):void 0}}function gX(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function bX(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function wX(t){if(Array.isArray(t))return t}function SX(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function CX(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kX(r.key),r)}}function OX(t,e,n){return e&&CX(t.prototype,e),n&&CX(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function kX(t){var e=RX(t,"string");return"symbol"===pX(e)?e:String(e)}function RX(t,e){if("object"!==pX(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==pX(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}dX.SEPARATOR={name:$F};var EX=function(){function t(e){SX(this,t),this.hot=e,this.options={}}return OX(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"getData",value:function(){var t=this,e=this._getDataRange(),n=e.startRow,r=e.startCol,o=e.endRow,i=e.endCol,a=this.options,l=[];return Ho(n,o,(function(e){var n=[];!a.exportHiddenRows&&t._isHiddenRow(e)||(Ho(r,i,(function(r){!a.exportHiddenColumns&&t._isHiddenColumn(r)||n.push(t.hot.getDataAtCell(e,r))})),l.push(n))})),l}},{key:"getRowHeaders",value:function(){var t=this,e=[];if(this.options.rowHeaders){var n=this._getDataRange(),r=n.startRow,o=n.endRow,i=this.hot.getRowHeader();Ho(r,o,(function(n){!t.options.exportHiddenRows&&t._isHiddenRow(n)||e.push(i[n])}))}return e}},{key:"getColumnHeaders",value:function(){var t=this,e=[];if(this.options.columnHeaders){var n=this._getDataRange(),r=n.startCol,o=n.endCol,i=this.hot.getColHeader();Ho(r,o,(function(n){!t.options.exportHiddenColumns&&t._isHiddenColumn(n)||e.push(i[n])}))}return e}},{key:"_getDataRange",value:function(){var t=this.hot.countCols()-1,e=this.hot.countRows()-1,n=yX(this.options.range,4),r=n[0],o=void 0===r?0:r,i=n[1],a=void 0===i?0:i,l=n[2],s=void 0===l?e:l,u=n[3],c=void 0===u?t:u;return o=Math.max(o,0),a=Math.max(a,0),s=Math.min(s,e),c=Math.min(c,t),{startRow:o,startCol:a,endRow:s,endCol:c}}},{key:"_isHiddenRow",value:function(t){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(t))}},{key:"_isHiddenColumn",value:function(t){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(t))}}]),t}(),PX=EX;function TX(t){return TX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TX(t)}function jX(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function MX(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,IX(r.key),r)}}function AX(t,e,n){return e&&MX(t.prototype,e),n&&MX(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function IX(t){var e=xX(t,"string");return"symbol"===TX(e)?e:String(e)}function xX(t,e){if("object"!==TX(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==TX(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var _X=function(){function t(e,n){jX(this,t),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}return AX(t,[{key:"_mergeOptions",value:function(e){var n=ut(this.constructor.DEFAULT_OPTIONS),r=new Date;return n=at(ut(t.DEFAULT_OPTIONS),n),n=at(n,e),n.filename=Oe(n.filename,{YYYY:r.getFullYear(),MM:"".concat(r.getMonth()+1).padStart(2,"0"),DD:"".concat(r.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),t}(),HX=_X;function NX(t){return NX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NX(t)}function DX(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LX(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,VX(r.key),r)}}function BX(t,e,n){return e&&LX(t.prototype,e),n&&LX(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function VX(t){var e=FX(t,"string");return"symbol"===NX(e)?e:String(e)}function FX(t,e){if("object"!==NX(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==NX(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function WX(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&UX(t,e)}function UX(t,e){return UX=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},UX(t,e)}function zX(t){var e=KX();return function(){var n,r=XX(t);if(e){var o=XX(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return GX(this,n)}}function GX(t,e){if(e&&("object"===NX(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return YX(t)}function YX(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function KX(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function XX(t){return XX=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},XX(t)}var $X=String.fromCharCode(13),qX=String.fromCharCode(34),QX=String.fromCharCode(10),JX=function(t){WX(n,t);var e=zX(n);function n(){return DX(this,n),e.apply(this,arguments)}return BX(n,[{key:"export",value:function(){var t=this,e=this.options,n=this.dataProvider.getData(),r=this.dataProvider.getColumnHeaders(),o=r.length>0,i=this.dataProvider.getRowHeaders(),a=i.length>0,l=e.bom?String.fromCharCode(65279):"";return o&&(r=W(r,(function(e){return t._escapeCell(e,!0)})),a&&(l+=e.columnDelimiter),l+=r.join(e.columnDelimiter),l+=e.rowDelimiter),U(n,(function(n,r){r>0&&(l+=e.rowDelimiter),a&&(l+=t._escapeCell(i[r])+e.columnDelimiter),l+=n.map((function(e){return t._escapeCell(e)})).join(e.columnDelimiter)})),l}},{key:"_escapeCell",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Jt(t);return""!==n&&(e||n.indexOf($X)>=0||n.indexOf(qX)>=0||n.indexOf(QX)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n='"'.concat(n,'"')),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}}]),n}(HX),ZX=JX;function t$(t){return t$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t$(t)}function e$(t,e,n){return e=n$(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n$(t){var e=r$(t,"string");return"symbol"===t$(e)?e:String(e)}function r$(t,e){if("object"!==t$(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==t$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var o$="csv",i$=e$({},o$,ZX);function a$(t,e,n){return"function"===typeof i$[t]?new i$[t](e,n):null}function l$(t){return l$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l$(t)}function s$(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u$(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,f$(r.key),r)}}function c$(t,e,n){return e&&u$(t.prototype,e),n&&u$(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function f$(t){var e=h$(t,"string");return"symbol"===l$(e)?e:String(e)}function h$(t,e){if("object"!==l$(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==l$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function d$(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p$(t,e)}function p$(t,e){return p$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},p$(t,e)}function y$(t){var e=g$();return function(){var n,r=b$(t);if(e){var o=b$(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v$(this,n)}}function v$(t,e){if(e&&("object"===l$(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return m$(t)}function m$(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g$(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function b$(t){return b$=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},b$(t)}var w$="exportFile",S$=240,C$=function(t){d$(n,t);var e=y$(n);function n(){return s$(this,n),e.apply(this,arguments)}return c$(n,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}},{key:"exportAsBlob",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}},{key:"downloadFile",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.hot,r=n.rootDocument,o=n.rootWindow,i=this._createTypeFormatter(t,e),a=this._createBlob(i),l=o.URL||o.webkitURL,s=r.createElement("a"),u="".concat(i.options.filename,".").concat(i.options.fileExtension);if(void 0!==s.download){var c=l.createObjectURL(a);s.style.display="none",s.setAttribute("href",c),s.setAttribute("download",u),r.body.appendChild(s),s.dispatchEvent(new MouseEvent("click")),r.body.removeChild(s),setTimeout((function(){l.revokeObjectURL(c)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,u)}},{key:"_createTypeFormatter",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!i$[t])throw new Error('Export format type "'.concat(t,'" is not supported.'));return a$(t,new PX(this.hot),e)}},{key:"_createBlob",value:function(t){var e=null;return"undefined"!==typeof Blob&&(e=new Blob([t.export()],{type:"".concat(t.options.mimeType,";charset=").concat(t.options.encoding)})),e}}],[{key:"PLUGIN_KEY",get:function(){return w$}},{key:"PLUGIN_PRIORITY",get:function(){return S$}}]),n}(RH);function O$(t){return O$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O$(t)}function k$(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R$(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,P$(r.key),r)}}function E$(t,e,n){return e&&R$(t.prototype,e),n&&R$(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function P$(t){var e=T$(t,"string");return"symbol"===O$(e)?e:String(e)}function T$(t,e){if("object"!==O$(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==O$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var j$=function(){function t(e,n){var r=n.id,o=n.stateless,i=void 0===o||o;k$(this,t),this.hot=e,this.id=r,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Bg)}return E$(t,[{key:"reset",value:function(){U(this.elements,(function(t){return t.reset()}))}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return null===this.hot||this.hidden}},{key:"restoreState",value:function(t){this.state&&this.setState(this.state.getValueAtIndex(t))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(t){this.state&&this.state.setValueAtIndex(t,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),U(this.elements,(function(t){return t.destroy()})),this.state=null,this.elements=null,this.hot=null}}]),t}();ct(j$,Zv);var M$=j$,A$={};function I$(t,e){if(!A$[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));var n=A$[t],r=n.condition,o=n.descriptor,i=e;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(t){return r.apply(t.meta.instance,[].concat([t],[i]))}}function x$(t){if(!A$[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));return A$[t].descriptor}function _$(t,e,n){n.key=t,A$[t]={condition:e,descriptor:n}}var H$="none";function N$(){return!0}_$(H$,N$,{name:RS,inputsCount:0,showOperators:!1});var D$="empty";function L$(t){return ee(t.value)}_$(D$,L$,{name:ES,inputsCount:0,showOperators:!0});var B$="not_empty";function V$(t,e){return!I$(D$,e)(t)}function F$(t,e){return Y$(t)||G$(t,e)||U$(t,e)||W$()}function W$(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function U$(t,e){if(t){if("string"===typeof t)return z$(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z$(t,e):void 0}}function z$(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function G$(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Y$(t){if(Array.isArray(t))return t}_$(B$,V$,{name:PS,inputsCount:0,showOperators:!0});var K$="eq";function X$(t,e){var n=F$(e,1),r=n[0];return Jt(t.value).toLocaleLowerCase(t.meta.locale)===Jt(r)}_$(K$,X$,{name:TS,inputsCount:1,showOperators:!0});var $$="neq";function q$(t,e){return!I$(K$,e)(t)}function Q$(t,e){return nq(t)||eq(t,e)||Z$(t,e)||J$()}function J$(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Z$(t,e){if(t){if("string"===typeof t)return tq(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tq(t,e):void 0}}function tq(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function eq(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function nq(t){if(Array.isArray(t))return t}_$($$,q$,{name:jS,inputsCount:1,showOperators:!0});var rq="gt";function oq(t,e){var n=Q$(e,1),r=n[0],o=r;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value>o}function iq(t,e){return cq(t)||uq(t,e)||lq(t,e)||aq()}function aq(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function lq(t,e){if(t){if("string"===typeof t)return sq(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sq(t,e):void 0}}function sq(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function uq(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function cq(t){if(Array.isArray(t))return t}_$(rq,oq,{name:HS,inputsCount:1,showOperators:!0});var fq="gte";function hq(t,e){var n=iq(e,1),r=n[0],o=r;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value>=o}function dq(t,e){return gq(t)||mq(t,e)||yq(t,e)||pq()}function pq(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function yq(t,e){if(t){if("string"===typeof t)return vq(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vq(t,e):void 0}}function vq(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function mq(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function gq(t){if(Array.isArray(t))return t}_$(fq,hq,{name:NS,inputsCount:1,showOperators:!0});var bq="lt";function wq(t,e){var n=dq(e,1),r=n[0],o=r;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value<o}function Sq(t,e){return Eq(t)||Rq(t,e)||Oq(t,e)||Cq()}function Cq(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Oq(t,e){if(t){if("string"===typeof t)return kq(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kq(t,e):void 0}}function kq(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Rq(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Eq(t){if(Array.isArray(t))return t}_$(bq,wq,{name:DS,inputsCount:1,showOperators:!0});var Pq="lte";function Tq(t,e){var n=Sq(e,1),r=n[0],o=r;return"numeric"===t.meta.type&&(o=parseFloat(o,10)),t.value<=o}function jq(t,e){return _q(t)||xq(t,e)||Aq(t,e)||Mq()}function Mq(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Aq(t,e){if(t){if("string"===typeof t)return Iq(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Iq(t,e):void 0}}function Iq(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function xq(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function _q(t){if(Array.isArray(t))return t}_$(Pq,Tq,{name:LS,inputsCount:1,showOperators:!0});var Hq="date_after";function Nq(t,e){var n=jq(e,1),r=n[0],o=Xt(t.value,t.meta.dateFormat),i=Xt(r,t.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)>=0}function Dq(t,e){return Wq(t)||Fq(t,e)||Bq(t,e)||Lq()}function Lq(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Bq(t,e){if(t){if("string"===typeof t)return Vq(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vq(t,e):void 0}}function Vq(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Fq(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Wq(t){if(Array.isArray(t))return t}_$(Hq,Nq,{name:FS,inputsCount:1,showOperators:!0});var Uq="date_before";function zq(t,e){var n=Dq(e,1),r=n[0],o=Xt(t.value,t.meta.dateFormat),i=Xt(r,t.meta.dateFormat);return!(!o.isValid()||!i.isValid())&&o.diff(i)<=0}function Gq(t,e){return qq(t)||$q(t,e)||Kq(t,e)||Yq()}function Yq(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Kq(t,e){if(t){if("string"===typeof t)return Xq(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xq(t,e):void 0}}function Xq(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $q(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function qq(t){if(Array.isArray(t))return t}_$(Uq,zq,{name:WS,inputsCount:1,showOperators:!0});var Qq="between";function Jq(t,e){var n=Gq(e,2),r=n[0],o=n[1],i=r,a=o;if("numeric"===t.meta.type){var l=parseFloat(i,10),s=parseFloat(a,10);i=Math.min(l,s),a=Math.max(l,s)}else if("date"===t.meta.type){var u=I$(Uq,[a]),c=I$(Hq,[i]);return u(t)&&c(t)}return t.value>=i&&t.value<=a}_$(Qq,Jq,{name:BS,inputsCount:2,showOperators:!0});var Zq="not_between";function tQ(t,e){return!I$(Qq,e)(t)}function eQ(t,e){return aQ(t)||iQ(t,e)||rQ(t,e)||nQ()}function nQ(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rQ(t,e){if(t){if("string"===typeof t)return oQ(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oQ(t,e):void 0}}function oQ(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function iQ(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function aQ(t){if(Array.isArray(t))return t}_$(Zq,tQ,{name:VS,inputsCount:2,showOperators:!0});var lQ="begins_with";function sQ(t,e){var n=eQ(e,1),r=n[0];return Jt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Jt(r))}_$(lQ,sQ,{name:MS,inputsCount:1,showOperators:!0});n(8605);function uQ(t,e){return pQ(t)||dQ(t,e)||fQ(t,e)||cQ()}function cQ(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fQ(t,e){if(t){if("string"===typeof t)return hQ(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hQ(t,e):void 0}}function hQ(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function dQ(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function pQ(t){if(Array.isArray(t))return t}var yQ="ends_with";function vQ(t,e){var n=uQ(e,1),r=n[0];return Jt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Jt(r))}function mQ(t,e){return CQ(t)||SQ(t,e)||bQ(t,e)||gQ()}function gQ(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function bQ(t,e){if(t){if("string"===typeof t)return wQ(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wQ(t,e):void 0}}function wQ(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function SQ(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function CQ(t){if(Array.isArray(t))return t}_$(yQ,vQ,{name:AS,inputsCount:1,showOperators:!0});var OQ="contains";function kQ(t,e){var n=mQ(e,1),r=n[0];return Jt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Jt(r))>=0}_$(OQ,kQ,{name:IS,inputsCount:1,showOperators:!0});var RQ="not_contains";function EQ(t,e){return!I$(OQ,e)(t)}_$(RQ,EQ,{name:xS,inputsCount:1,showOperators:!0});var PQ="date_tomorrow";function TQ(t){var e=Xt(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(Xt().subtract(-1,"days").startOf("day"),"d")}_$(PQ,TQ,{name:zS,inputsCount:0});var jQ="date_today";function MQ(t){var e=Xt(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(Xt().startOf("day"),"d")}_$(jQ,MQ,{name:US,inputsCount:0});var AQ,IQ="date_yesterday";function xQ(t){var e=Xt(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(Xt().subtract(1,"days").startOf("day"),"d")}function _Q(t){return _Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_Q(t)}function HQ(t,e,n){return e=NQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NQ(t){var e=DQ(t,"string");return"symbol"===_Q(e)?e:String(e)}function DQ(t,e){if("object"!==_Q(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==_Q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}_$(IQ,xQ,{name:GS,inputsCount:0});var LQ="numeric",BQ="text",VQ="date",FQ=(AQ={},HQ(AQ,LQ,[H$,$F,D$,B$,$F,K$,$$,$F,rq,fq,bq,Pq,Qq,Zq]),HQ(AQ,BQ,[H$,$F,D$,B$,$F,K$,$$,$F,lQ,yQ,$F,OQ,RQ]),HQ(AQ,VQ,[H$,$F,D$,B$,$F,K$,$$,$F,Uq,Hq,Qq,$F,PQ,jQ,IQ]),AQ);function WQ(t){var e=[],n=t;return FQ[n]||(n=BQ),U(FQ[n],(function(t){var n;n=t===$F?{name:$F}:ut(x$(t)),e.push(n)})),e}function UQ(t){return UQ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},UQ(t)}function zQ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function GQ(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,KQ(r.key),r)}}function YQ(t,e,n){return e&&GQ(t.prototype,e),n&&GQ(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function KQ(t){var e=XQ(t,"string");return"symbol"===UQ(e)?e:String(e)}function XQ(t,e){if("object"!==UQ(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==UQ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var $Q="built",qQ="building",QQ=["click","input","keydown","keypress","keyup","focus","blur","change"],JQ=function(){function t(e,n){zQ(this,t),this.hot=e,this.eventManager=new Gr(this),this.options=at(t.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return YQ(t,[{key:"setValue",value:function(t){this.options.value=t,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===qQ?this._element:this.buildState===$Q?(this.update(),this._element):(this.buildState=qQ,this.build(),this.buildState=$Q,this._element)}},{key:"isBuilt",value:function(){return this.buildState===$Q}},{key:"translateIfPossible",value:function(t){return"string"===typeof t&&t.startsWith(OS)?this.hot.getTranslatedPhrase(t):t}},{key:"build",value:function(){var t=this,e=function(e,n){t.eventManager.addEventListener(e,n,(function(e){return t.runLocalHooks(n,e,t)}))};if(this.buildState||(this.buildState=qQ),this.options.className&&Ge(this._element,this.options.className),this.options.children.length)U(this.options.children,(function(e){return t._element.appendChild(e.element)}));else if(this.options.wrapIt){var n=this.hot.rootDocument.createElement(this.options.tagName);pt(this.options,(function(e,r){void 0!==n[r]&&"className"!==r&&"tagName"!==r&&"children"!==r&&(n[r]=t.translateIfPossible(e))})),this._element.appendChild(n),U(QQ,(function(t){return e(n,t)}))}else U(QQ,(function(n){return e(t._element,n)}))}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return ut({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),t}();ct(JQ,Zv);var ZQ=JQ;function tJ(t){return tJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tJ(t)}function eJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nJ(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,oJ(r.key),r)}}function rJ(t,e,n){return e&&nJ(t.prototype,e),n&&nJ(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function oJ(t){var e=iJ(t,"string");return"symbol"===tJ(e)?e:String(e)}function iJ(t,e){if("object"!==tJ(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==tJ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function aJ(){return aJ="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=lJ(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},aJ.apply(this,arguments)}function lJ(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=pJ(t),null===t)break;return t}function sJ(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uJ(t,e)}function uJ(t,e){return uJ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},uJ(t,e)}function cJ(t){var e=dJ();return function(){var n,r=pJ(t);if(e){var o=pJ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fJ(this,n)}}function fJ(t,e){if(e&&("object"===tJ(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return hJ(t)}function hJ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dJ(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function pJ(t){return pJ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pJ(t)}var yJ=new WeakMap,vJ=function(t){sJ(n,t);var e=cJ(n);function n(t,r){var o;return eJ(this,n),o=e.call(this,t,at(n.DEFAULTS,r)),yJ.set(hJ(o),{}),o.registerHooks(),o}return rJ(n,[{key:"registerHooks",value:function(){var t=this;this.addLocalHook("click",(function(){return t.onClick()})),this.addLocalHook("keyup",(function(e){return t.onKeyup(e)}))}},{key:"build",value:function(){aJ(pJ(n.prototype),"build",this).call(this);var t=yJ.get(this),e=this.hot.rootDocument.createElement("div");t.input=this._element.firstChild,Ge(this._element,"htUIInput"),Ge(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var t=yJ.get(this).input;t.type=this.options.type,t.placeholder=this.translateIfPossible(this.options.placeholder),t.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&yJ.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(t){this.options.value=t.target.value}}],[{key:"DEFAULTS",get:function(){return ut({placeholder:"",type:"text",tagName:"input"})}}]),n}(ZQ),mJ=vJ;function gJ(t){return gJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gJ(t)}function bJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wJ(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,CJ(r.key),r)}}function SJ(t,e,n){return e&&wJ(t.prototype,e),n&&wJ(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function CJ(t){var e=OJ(t,"string");return"symbol"===gJ(e)?e:String(e)}function OJ(t,e){if("object"!==gJ(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==gJ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function kJ(){return kJ="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=RJ(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},kJ.apply(this,arguments)}function RJ(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=IJ(t),null===t)break;return t}function EJ(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&PJ(t,e)}function PJ(t,e){return PJ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},PJ(t,e)}function TJ(t){var e=AJ();return function(){var n,r=IJ(t);if(e){var o=IJ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jJ(this,n)}}function jJ(t,e){if(e&&("object"===gJ(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return MJ(t)}function MJ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function AJ(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function IJ(t){return IJ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},IJ(t)}var xJ=new WeakMap,_J=function(t){EJ(n,t);var e=TJ(n);function n(t,r){var o;return bJ(this,n),o=e.call(this,t,at(n.DEFAULTS,r)),xJ.set(MJ(o),{}),o.menu=null,o.items=[],o.registerHooks(),o}return SJ(n,[{key:"registerHooks",value:function(){var t=this;this.addLocalHook("click",(function(){return t.onClick()}))}},{key:"setItems",value:function(t){this.items=this.translateNames(t),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(t){var e=this;return U(t,(function(t){t.name=e.translateIfPossible(t.name)})),t}},{key:"build",value:function(){var t=this;kJ(IJ(n.prototype),"build",this).call(this),this.menu=new kz(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var e=new ZQ(this.hot,{className:"htUISelectCaption"}),r=new ZQ(this.hot,{className:"htUISelectDropdown"}),o=xJ.get(this);o.caption=e,o.captionElement=e.element,o.dropdown=r,U([e,r],(function(e){return t._element.appendChild(e.element)})),this.menu.addLocalHook("select",(function(e){return t.onMenuSelect(e)})),this.menu.addLocalHook("afterClose",(function(){return t.onMenuClosed()})),this.update()}},{key:"update",value:function(){var t;this.isBuilt()&&(t=this.options.value?this.options.value.name:this.menu.hot.getTranslatedPhrase(RS),xJ.get(this).captionElement.textContent=t,kJ(IJ(n.prototype),"update",this).call(this))}},{key:"openOptions",value:function(){var t=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(t){t.name!==$F&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var t=xJ.get(this),e=t.caption,r=t.dropdown;e&&e.destroy(),r&&r.destroy(),kJ(IJ(n.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return ut({className:"htUISelect",wrapIt:!1})}}]),n}(ZQ),HJ=_J;function NJ(t){return NJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NJ(t)}function DJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LJ(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,VJ(r.key),r)}}function BJ(t,e,n){return e&&LJ(t.prototype,e),n&&LJ(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function VJ(t){var e=FJ(t,"string");return"symbol"===NJ(e)?e:String(e)}function FJ(t,e){if("object"!==NJ(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==NJ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function WJ(){return WJ="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=UJ(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},WJ.apply(this,arguments)}function UJ(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=qJ(t),null===t)break;return t}function zJ(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&GJ(t,e)}function GJ(t,e){return GJ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},GJ(t,e)}function YJ(t){var e=$J();return function(){var n,r=qJ(t);if(e){var o=qJ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return KJ(this,n)}}function KJ(t,e){if(e&&("object"===NJ(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return XJ(t)}function XJ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $J(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function qJ(t){return qJ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qJ(t)}var QJ=function(t){zJ(n,t);var e=YJ(n);function n(t,r){var o;return DJ(this,n),o=e.call(this,t,{id:r.id,stateless:!1}),o.name=r.name,o.addSeparator=r.addSeparator,o.elements.push(new HJ(o.hot,{menuContainer:r.menuContainer})),o.elements.push(new mJ(o.hot,{placeholder:nC})),o.elements.push(new mJ(o.hot,{placeholder:rC})),o.registerHooks(),o}return BJ(n,[{key:"registerHooks",value:function(){var t=this;this.getSelectElement().addLocalHook("select",(function(e){return t.onConditionSelect(e)})),this.getSelectElement().addLocalHook("afterClose",(function(){return t.onSelectUIClosed()})),U(this.getInputElements(),(function(e){e.addLocalHook("keydown",(function(e){return t.onInputKeyDown(e)}))}))}},{key:"setState",value:function(t){var e=this;if(this.reset(),t){var n=ut(t.command);n.name.startsWith(kS)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),U(t.args,(function(t,r){if(r>n.inputsCount-1)return!1;var o=e.getInputElement(r);o.setValue(t),o[n.inputsCount>r?"show":"hide"](),r||setTimeout((function(){return o.focus()}),10)}))}}},{key:"getState",value:function(){var t=this.getSelectElement().getValue()||x$(H$),e=[];return U(this.getInputElements(),(function(n,r){t.inputsCount>r&&e.push(n.getValue())})),{command:t,args:e}}},{key:"updateState",value:function(t,e){var n=x$(t?t.name:H$);this.state.setValueAtIndex(e,{command:n,args:t?t.args:[]}),t||U(this.getInputElements(),(function(t){return t.setValue(null)}))}},{key:"getSelectElement",value:function(){return this.elements.filter((function(t){return t instanceof HJ}))[0]}},{key:"getInputElement",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}},{key:"getInputElements",value:function(){return this.elements.filter((function(t){return t instanceof mJ}))}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n,r,o,i,a){Ge(n.parentNode,"htFiltersMenuCondition"),t.addSeparator&&Ge(n.parentNode,"border");var l=t.hot.rootDocument.createElement("div");return Ge(l,"htFiltersMenuLabel"),l.textContent=a,n.appendChild(l),n.parentNode.hasAttribute("ghost-table")||U(t.elements,(function(t){return n.appendChild(t.element)})),n}}}},{key:"reset",value:function(){var t=this.hot.getPlugin("filters").getSelectedColumn(),e=[x$(H$)];if(null!==t){var r=t.visualIndex;e=WQ(this.hot.getDataType(0,r,this.hot.countRows(),r))}U(this.getInputElements(),(function(t){return t.hide()})),this.getSelectElement().setItems(e),WJ(qJ(n.prototype),"reset",this).call(this),this.getSelectElement().setValue(e[0])}},{key:"onConditionSelect",value:function(t){U(this.getInputElements(),(function(e,n){e[t.inputsCount>n?"show":"hide"](),0===n&&setTimeout((function(){return e.focus()}),10)})),this.runLocalHooks("change",t)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(t){qn(t.keyCode,"ENTER")?(this.runLocalHooks("accept"),Qn(t)):qn(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Qn(t))}}]),n}(M$),JJ=QJ,ZJ={};function tZ(t){if(!ZJ[t])throw Error('Operation with id "'.concat(t,'" does not exist.'));var e=ZJ[t].func;return function(t,n){return e(t,n)}}function eZ(t){return ZJ[t].name}function nZ(t,e,n){ZJ[t]={name:e,func:n}}var rZ="conjunction",oZ=XS;function iZ(t,e){return t.every((function(t){return t.func(e)}))}nZ(rZ,oZ,iZ);var aZ="disjunction",lZ=$S;function sZ(t,e){return t.some((function(t){return t.func(e)}))}nZ(aZ,lZ,sZ);var uZ="disjunctionWithExtraCondition",cZ=$S;function fZ(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some((function(t){return t.func(e)}))&&t[t.length-1].func(e)}function hZ(t){return hZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hZ(t)}function dZ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pZ(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vZ(r.key),r)}}function yZ(t,e,n){return e&&pZ(t.prototype,e),n&&pZ(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function vZ(t){var e=mZ(t,"string");return"symbol"===hZ(e)?e:String(e)}function mZ(t,e){if("object"!==hZ(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==hZ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function gZ(){return gZ="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=bZ(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},gZ.apply(this,arguments)}function bZ(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=EZ(t),null===t)break;return t}function wZ(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&SZ(t,e)}function SZ(t,e){return SZ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},SZ(t,e)}function CZ(t){var e=RZ();return function(){var n,r=EZ(t);if(e){var o=EZ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return OZ(this,n)}}function OZ(t,e){if(e&&("object"===hZ(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return kZ(t)}function kZ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function RZ(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function EZ(t){return EZ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},EZ(t)}nZ(uZ,cZ,fZ);var PZ,TZ=new WeakMap,jZ=function(t){wZ(n,t);var e=CZ(n);function n(t,r){var o;return dZ(this,n),o=e.call(this,t,at(n.DEFAULTS,r)),TZ.set(kZ(o),{}),o}return yZ(n,[{key:"build",value:function(){gZ(EZ(n.prototype),"build",this).call(this);var t=TZ.get(this);t.input=this._element.firstChild;var e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),t.label=e,this._element.appendChild(e),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var t=TZ.get(this);t.input.checked=this.options.checked,t.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.options.checked=t,this.update()}},{key:"focus",value:function(){this.isBuilt()&&TZ.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return ut({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),n}(ZQ),MZ=jZ;function AZ(t){return AZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AZ(t)}function IZ(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function xZ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _Z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,NZ(r.key),r)}}function HZ(t,e,n){return e&&_Z(t.prototype,e),n&&_Z(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function NZ(t){var e=DZ(t,"string");return"symbol"===AZ(e)?e:String(e)}function DZ(t,e){if("object"!==AZ(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==AZ(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function LZ(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&BZ(t,e)}function BZ(t,e){return BZ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},BZ(t,e)}function VZ(t){var e=UZ();return function(){var n,r=zZ(t);if(e){var o=zZ(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return FZ(this,n)}}function FZ(t,e){if(e&&("object"===AZ(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return WZ(t)}function WZ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function UZ(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function zZ(t){return zZ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},zZ(t)}var GZ=0,YZ=function(t){LZ(n,t);var e=VZ(n);function n(t,r){var o;return xZ(this,n),o=e.call(this,t,{id:r.id,stateless:!1}),o.name=r.name,o.buildOperatorsElement(),o}return HZ(n,[{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n){return Ge(n.parentNode,"htFiltersMenuOperators"),n.parentNode.hasAttribute("ghost-table")||U(t.elements,(function(t){return n.appendChild(t.element)})),n}}}},{key:"buildOperatorsElement",value:function(){var t=this,e=[rZ,aZ];U(e,(function(n){var r=new MZ(t.hot,{name:"operator",label:{htmlFor:n,textContent:eZ(n)},value:n,checked:n===e[GZ],id:n});r.addLocalHook("change",(function(e){return t.onRadioInputChange(e)})),t.elements.push(r)}))}},{key:"setChecked",value:function(t){if(this.elements.length<t)throw Error($t(PZ||(PZ=IZ(["Radio button with index "," doesn't exist."])),t));U(this.elements,(function(e,n){e.setChecked(n===t)}))}},{key:"getActiveOperationId",value:function(){var t=this.elements.find((function(t){return t instanceof MZ&&t.isChecked()}));return t?t.getValue():rZ}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(t){this.reset(),t&&this.getActiveOperationId()!==t&&U(this.elements,(function(e){e.setChecked(e.getValue()===t)}))}},{key:"updateState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rZ,e=arguments.length>1?arguments[1]:void 0,n=t;n===uZ&&(n=aZ),this.state.setValueAtIndex(e,n)}},{key:"reset",value:function(){this.setChecked(GZ)}},{key:"onRadioInputChange",value:function(t){this.setState(t.target.value)}}]),n}(M$),KZ=YZ;H();function XZ(t,e){var n=t;return""===n&&(n="(".concat(e,")")),n}var $Z=new Set([1]).has(1),qZ=$Z&&"function"===typeof Array.from;function QZ(t){var e=t;return $Z&&(e=new Set(e)),function(t){var n;return n=$Z?e.has(t):!!~e.indexOf(t),n}}function JZ(t){return null===t||void 0===t?"":t}function ZZ(t){var e=t;return e=qZ?Array.from(new Set(e)):$(e),e=e.sort((function(t,e){return"number"===typeof t&&"number"===typeof e?t-e:t===e?0:t>e?1:-1})),e}function t0(t,e,n,r){var o,i=[],a=t===e;return a||(o=QZ(e)),U(t,(function(t){var e=!1;(a||o(t))&&(e=!0);var l={checked:e,value:t,visualValue:XZ(t,n)};r&&r(l),i.push(l)})),i}n(3645);function e0(t){return e0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e0(t)}function n0(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r0(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,i0(r.key),r)}}function o0(t,e,n){return e&&r0(t.prototype,e),n&&r0(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function i0(t){var e=a0(t,"string");return"symbol"===e0(e)?e:String(e)}function a0(t,e){if("object"!==e0(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==e0(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function l0(){return l0="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=s0(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},l0.apply(this,arguments)}function s0(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=y0(t),null===t)break;return t}function u0(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c0(t,e)}function c0(t,e){return c0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c0(t,e)}function f0(t){var e=p0();return function(){var n,r=y0(t);if(e){var o=y0(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h0(this,n)}}function h0(t,e){if(e&&("object"===e0(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return d0(t)}function d0(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p0(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function y0(t){return y0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y0(t)}var v0=new WeakMap,m0=function(t){u0(n,t);var e=f0(n);function n(t,r){var o;return n0(this,n),o=e.call(this,t,at(n.DEFAULTS,r)),v0.set(d0(o),{}),o}return o0(n,[{key:"build",value:function(){l0(y0(n.prototype),"build",this).call(this);var t=v0.get(this);t.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(v0.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return ut({href:"#",tagName:"a"})}}]),n}(ZQ),g0=m0;function b0(t){return b0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b0(t)}function w0(t){return k0(t)||O0(t)||C0(t)||S0()}function S0(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function C0(t,e){if(t){if("string"===typeof t)return R0(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R0(t,e):void 0}}function O0(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function k0(t){if(Array.isArray(t))return R0(t)}function R0(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function E0(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P0(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,j0(r.key),r)}}function T0(t,e,n){return e&&P0(t.prototype,e),n&&P0(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function j0(t){var e=M0(t,"string");return"symbol"===b0(e)?e:String(e)}function M0(t,e){if("object"!==b0(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==b0(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function A0(){return A0="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=I0(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},A0.apply(this,arguments)}function I0(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=B0(t),null===t)break;return t}function x0(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_0(t,e)}function _0(t,e){return _0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_0(t,e)}function H0(t){var e=L0();return function(){var n,r=B0(t);if(e){var o=B0(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return N0(this,n)}}function N0(t,e){if(e&&("object"===b0(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return D0(t)}function D0(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function L0(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function B0(t){return B0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},B0(t)}var V0=new WeakMap,F0="multipleSelect.itemBox",W0=function(t){x0(n,t);var e=H0(n);function n(t,r){var o;return E0(this,n),o=e.call(this,t,at(n.DEFAULTS,r)),V0.set(D0(o),{}),o.searchInput=new mJ(o.hot,{placeholder:eC,className:"htUIMultipleSelectSearch"}),o.selectAllUI=new g0(o.hot,{textContent:QS,className:"htUISelectAll"}),o.clearAllUI=new g0(o.hot,{textContent:JS,className:"htUIClearAll"}),o.items=[],o.itemsBox=null,o.registerHooks(),o}return T0(n,[{key:"registerHooks",value:function(){var t=this;this.searchInput.addLocalHook("keydown",(function(e){return t.onInputKeyDown(e)})),this.searchInput.addLocalHook("input",(function(e){return t.onInput(e)})),this.selectAllUI.addLocalHook("click",(function(e){return t.onSelectAllClick(e)})),this.clearAllUI.addLocalHook("click",(function(e){return t.onClearAllClick(e)}))}},{key:"setItems",value:function(t){this.items=t,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(t){this.locale=t}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return w0(this.items)}},{key:"getValue",value:function(){return G0(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var t=this;A0(B0(n.prototype),"build",this).call(this);var e=this.hot.rootDocument,r=e.createElement("div"),o=new ZQ(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(o.element),this._element.appendChild(r);var i=function(n){if(t._element){t.itemsBox&&t.itemsBox.destroy(),Ge(n,"htUIMultipleSelectHot"),t.itemsBox=new t.hot.constructor(n,{data:t.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(t,e,n,r,o,i){t.title=i.instance.getDataAtRowProp(e,i.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return t.itemsBox.container.scrollWidth-On(e)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:t.hot.isRtl()?"rtl":"ltr"}),t.itemsBox.init();var r=t.itemsBox.getShortcutManager(),o=r.getContext("grid");o.addShortcut({keys:[["Escape"]],callback:function(e){t.runLocalHooks("keydown",e,t)},group:F0})}};i(r),setTimeout((function(){return i(r)}),100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(z0(this.items,this.options.value)),A0(B0(n.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,A0(B0(n.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(t){var e,n=this,r=t.target.value.toLocaleLowerCase(this.getLocale());e=""===r?w0(this.items):F(this.items,(function(t){return"".concat(t.value).toLocaleLowerCase(n.getLocale()).indexOf(r)>=0})),this.itemsBox.loadData(e)}},{key:"onInputKeyDown",value:function(t){this.runLocalHooks("keydown",t,this);var e=Bn(qn,t.keyCode);e("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Qn(t),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(t){var e=[];t.preventDefault(),U(this.itemsBox.getSourceData(),(function(t,n){t.checked=!0,e.push(Bv(t,n)[0])})),this.itemsBox.setSourceDataAtCell(e)}},{key:"onClearAllClick",value:function(t){var e=[];t.preventDefault(),U(this.itemsBox.getSourceData(),(function(t,n){t.checked=!1,e.push(Bv(t,n)[0])})),this.itemsBox.setSourceDataAtCell(e)}}],[{key:"DEFAULTS",get:function(){return ut({className:"htUIMultipleSelect",value:[]})}}]),n}(ZQ),U0=W0;function z0(t,e){var n=QZ(e);return W(t,(function(t){return t.checked=n(t.value),t}))}function G0(t){var e=[];return U(t,(function(t){t.checked&&e.push(t.value)})),e}function Y0(t,e){return Q0(t)||q0(t,e)||X0(t,e)||K0()}function K0(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function X0(t,e){if(t){if("string"===typeof t)return $0(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$0(t,e):void 0}}function $0(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function q0(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Q0(t){if(Array.isArray(t))return t}var J0="by_value";function Z0(t,e){var n=Y0(e,1),r=n[0];return r(t.value)}function t1(t){return t1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t1(t)}function e1(t,e){return a1(t)||i1(t,e)||r1(t,e)||n1()}function n1(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r1(t,e){if(t){if("string"===typeof t)return o1(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o1(t,e):void 0}}function o1(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i1(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function a1(t){if(Array.isArray(t))return t}function l1(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s1(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,c1(r.key),r)}}function u1(t,e,n){return e&&s1(t.prototype,e),n&&s1(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function c1(t){var e=f1(t,"string");return"symbol"===t1(e)?e:String(e)}function f1(t,e){if("object"!==t1(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==t1(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function h1(){return h1="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=d1(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},h1.apply(this,arguments)}function d1(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=w1(t),null===t)break;return t}function p1(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y1(t,e)}function y1(t,e){return y1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},y1(t,e)}function v1(t){var e=b1();return function(){var n,r=w1(t);if(e){var o=w1(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return m1(this,n)}}function m1(t,e){if(e&&("object"===t1(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return g1(t)}function g1(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b1(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function w1(t){return w1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},w1(t)}_$(J0,Z0,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var e=Y0(t,1),n=e[0];return[QZ(n)]},showOperators:!1});var S1=function(t){p1(n,t);var e=v1(n);function n(t,r){var o;return l1(this,n),o=e.call(this,t,{id:r.id,stateless:!1}),o.name=r.name,o.elements.push(new U0(o.hot)),o.registerHooks(),o}return u1(n,[{key:"registerHooks",value:function(){var t=this;this.getMultipleSelectElement().addLocalHook("keydown",(function(e){return t.onInputKeyDown(e)}))}},{key:"setState",value:function(t){if(this.reset(),t&&t.command.key===J0){var e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0]),e.setLocale(t.locale)}}},{key:"getState",value:function(){var t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?H$:J0},args:[t.getValue()],itemsSnapshot:e}}},{key:"updateState",value:function(t){var e=this,n=function(n,r,o,i,a){var l=F(r,(function(t){return t.name===J0})),s=e1(l,1),u=s[0],c={},f=e.hot.getTranslatedPhrase(qS);if(u){var h=ZZ(W(i(n,a),(function(t){return t.value})));o&&(u.args[0]=o);var d=[],p=t0(h,u.args[0],f,(function(t){t.checked&&d.push(t.value)})),y=t.editedConditionStack.column;c.locale=e.hot.getCellMeta(0,y).locale,c.args=[d],c.command=x$(J0),c.itemsSnapshot=p}else c.args=[],c.command=x$(H$);e.state.setValueAtIndex(n,c)};n(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&n(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter((function(t){return t instanceof U0}))[0]}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n,r,o,i,a){Ge(n.parentNode,"htFiltersMenuValue");var l=t.hot.rootDocument.createElement("div");return Ge(l,"htFiltersMenuLabel"),l.textContent=a,n.appendChild(l),n.parentNode.hasAttribute("ghost-table")||U(t.elements,(function(t){return n.appendChild(t.element)})),n}}}},{key:"reset",value:function(){var t=this.hot.getTranslatedPhrase(qS),e=ZZ(this._getColumnVisibleValues()),r=t0(e,e,t);this.getMultipleSelectElement().setItems(r),h1(w1(n.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(e);var o=this.hot.getPlugin("filters").getSelectedColumn();null!==o&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,o.visualIndex).locale)}},{key:"onInputKeyDown",value:function(t){qn(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Qn(t))}},{key:"_getColumnVisibleValues",value:function(){var t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:W(this.hot.getDataAtCol(t.visualIndex),(function(t){return JZ(t)}))}}]),n}(M$),C1=S1;function O1(t){return O1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O1(t)}function k1(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R1(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,P1(r.key),r)}}function E1(t,e,n){return e&&R1(t.prototype,e),n&&R1(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function P1(t){var e=T1(t,"string");return"symbol"===O1(e)?e:String(e)}function T1(t,e){if("object"!==O1(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==O1(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function j1(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&M1(t,e)}function M1(t,e){return M1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},M1(t,e)}function A1(t){var e=_1();return function(){var n,r=H1(t);if(e){var o=H1(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return I1(this,n)}}function I1(t,e){if(e&&("object"===O1(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return x1(t)}function x1(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _1(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function H1(t){return H1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},H1(t)}var N1,D1,L1=function(t){j1(n,t);var e=A1(n);function n(t,r){var o;return k1(this,n),o=e.call(this,t,{id:r.id,stateless:!0}),o.name=r.name,o.elements.push(new mJ(o.hot,{type:"button",value:ZS,className:"htUIButton htUIButtonOK",identifier:n.BUTTON_OK})),o.elements.push(new mJ(o.hot,{type:"button",value:tC,className:"htUIButton htUIButtonCancel",identifier:n.BUTTON_CANCEL})),o.registerHooks(),o}return E1(n,[{key:"registerHooks",value:function(){var t=this;U(this.elements,(function(e){e.addLocalHook("click",(function(e,n){return t.onButtonClick(e,n)}))}))}},{key:"getMenuItemDescriptor",value:function(){var t=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return t.isHidden()},renderer:function(e,n){return Ge(n.parentNode,"htFiltersMenuActionBar"),n.parentNode.hasAttribute("ghost-table")||U(t.elements,(function(t){return n.appendChild(t.element)})),n}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(t,e){e.options.identifier===n.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),n}(M$),B1=L1;function V1(t){return V1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V1(t)}function F1(t,e){return Y1(t)||G1(t,e)||U1(t,e)||W1()}function W1(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function U1(t,e){if(t){if("string"===typeof t)return z1(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z1(t,e):void 0}}function z1(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function G1(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function Y1(t){if(Array.isArray(t))return t}function K1(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function X1(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $1(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Q1(r.key),r)}}function q1(t,e,n){return e&&$1(t.prototype,e),n&&$1(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Q1(t){var e=J1(t,"string");return"symbol"===V1(e)?e:String(e)}function J1(t,e){if("object"!==V1(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==V1(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Z1="ConditionCollection.filteringStates",t2=function(){function t(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];X1(this,t),this.hot=e,this.isMapRegistrable=n,this.filteringStates=new Bg,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(Z1,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return q1(t,[{key:"isEmpty",value:function(){return 0===this.getFilteredColumns().length}},{key:"isMatch",value:function(t,e){var n,r=this.filteringStates.getValueAtIndex(e),o=null!==(n=null===r||void 0===r?void 0:r.conditions)&&void 0!==n?n:[],i=null===r||void 0===r?void 0:r.operation;return this.isMatchInConditions(o,t,i)}},{key:"isMatchInConditions",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rZ;return!t.length||tZ(n)(t,e)}},{key:"addCondition",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rZ,r=arguments.length>3?arguments[3]:void 0,o=this.hot.getCellMeta(0,t).locale,i=W(e.args,(function(t){return"string"===typeof t?t.toLocaleLowerCase(o):t})),a=e.name||e.command.key;this.runLocalHooks("beforeAdd",t);var l=this.getOperation(t);if(l){if(l!==n)throw Error($t(N1||(N1=K1(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),t,l))}else if(te(ZJ[n]))throw new Error($t(D1||(D1=K1(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),n));var s=this.getConditions(t);0===s.length?this.filteringStates.setValueAtIndex(t,{operation:n,conditions:[{name:a,args:i,func:I$(a,i)}]},r):s.push({name:a,args:i,func:I$(a,i)}),this.runLocalHooks("afterAdd",t)}},{key:"getConditions",value:function(t){var e,n;return null!==(e=null===(n=this.filteringStates.getValueAtIndex(t))||void 0===n?void 0:n.conditions)&&void 0!==e?e:[]}},{key:"getOperation",value:function(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map((function(t){var e=F1(t,1),n=e[0];return n}))}},{key:"getColumnStackPosition",value:function(t){return this.getFilteredColumns().indexOf(t)}},{key:"exportAllConditions",value:function(){return V(this.filteringStates.getEntries(),(function(t,e){var n=F1(e,2),r=n[0],o=n[1],i=o.operation,a=o.conditions;return t.push({column:r,operation:i,conditions:W(a,(function(t){var e=t.name,n=t.args;return{name:e,args:n}}))}),t}),[])}},{key:"importAllConditions",value:function(t){var e=this;this.clean(),U(t,(function(t){U(t.conditions,(function(n){return e.addCondition(t.column,n)}))}))}},{key:"removeConditions",value:function(t){this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(t,e){var n=this.getConditions(t);return e?n.some((function(t){return t.name===e})):n.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(Z1),this.filteringStates=null,this.clearLocalHooks()}}]),t}();ct(t2,Zv);var e2=t2;function n2(t){return n2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n2(t)}function r2(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,a2(r.key),r)}}function i2(t,e,n){return e&&o2(t.prototype,e),n&&o2(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function a2(t){var e=l2(t,"string");return"symbol"===n2(e)?e:String(e)}function l2(t,e){if("object"!==n2(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==n2(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var s2=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return[]};r2(this,t),this.conditionCollection=e,this.columnDataFactory=n}return i2(t,[{key:"filter",value:function(){var t=this,e=[];return U(this.conditionCollection.getFilteredColumns(),(function(n,r){var o=t.columnDataFactory(n);r&&(o=t._getIntersectData(o,e)),e=t.filterByColumn(n,o)})),e}},{key:"filterByColumn",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return U(n,(function(n){void 0!==n&&e.conditionCollection.isMatch(n,t)&&r.push(n)})),r}},{key:"_getIntersectData",value:function(t,e){var n=[];return U(e,(function(e){var r=e.meta.visualRow;void 0!==t[r]&&(n[r]=t[r])})),n}}]),t}(),u2=s2;function c2(t){return c2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c2(t)}function f2(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,p2(r.key),r)}}function d2(t,e,n){return e&&h2(t.prototype,e),n&&h2(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function p2(t){var e=y2(t,"string");return"symbol"===c2(e)?e:String(e)}function y2(t,e){if("object"!==c2(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==c2(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var v2=function(){function t(e,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return[]};f2(this,t),this.hot=e,this.conditionCollection=n,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",(function(t){return r._onConditionBeforeModify(t)})),this.conditionCollection.addLocalHook("afterRemove",(function(t){return r.updateStatesAtColumn(t)})),this.conditionCollection.addLocalHook("afterAdd",(function(t){return r.updateStatesAtColumn(t)})),this.conditionCollection.addLocalHook("beforeClean",(function(){return r._onConditionBeforeClean()})),this.conditionCollection.addLocalHook("afterClean",(function(){return r._onConditionAfterClean()}))}return d2(t,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var t=this;this.grouping=!1,U(this.changes,(function(e){t.updateStatesAtColumn(e)})),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}},{key:"updateStatesAtColumn",value:function(t,e){var n=this;if(this.grouping)-1===this.changes.indexOf(t)&&this.changes.push(t);else{var r=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.getColumnStackPosition(t);-1===o&&(o=this.latestEditedColumnPosition);var i=r.slice(0,o),a=r.slice(o);a.length&&a[0].column===t&&a.shift();var l=Vn((function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=new e2(n.hot,!1),i=[].concat(t,r);o.importAllConditions(i);var a,l=n.columnDataFactory(e);a=o.isEmpty()?l:new u2(o,(function(t){return n.columnDataFactory(t)})).filter(),a=W(a,(function(t){return t.meta.visualRow}));var s=QZ(a);return o.destroy(),F(l,(function(t){return s(t.meta.visualRow)}))}))(i),s=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:s},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:e})}}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var t=this;U(this.latestOrderStack,(function(e){t.updateStatesAtColumn(e)}))}},{key:"destroy",value:function(){var t=this;this.clearLocalHooks(),pt(this,(function(e,n){t[n]=null}))}}]),t}();ct(v2,Zv);var m2,g2=v2;function b2(t){return b2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b2(t)}function w2(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function S2(t,e){return E2(t)||R2(t,e)||O2(t,e)||C2()}function C2(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function O2(t,e){if(t){if("string"===typeof t)return k2(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k2(t,e):void 0}}function k2(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function R2(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function E2(t){if(Array.isArray(t))return t}function P2(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,M2(r.key),r)}}function j2(t,e,n){return e&&T2(t.prototype,e),n&&T2(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function M2(t){var e=A2(t,"string");return"symbol"===b2(e)?e:String(e)}function A2(t,e){if("object"!==b2(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==b2(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function I2(){return I2="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=x2(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},I2.apply(this,arguments)}function x2(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=V2(t),null===t)break;return t}function _2(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&H2(t,e)}function H2(t,e){return H2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},H2(t,e)}function N2(t){var e=B2();return function(){var n,r=V2(t);if(e){var o=V2(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return D2(this,n)}}function D2(t,e){if(e&&("object"===b2(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return L2(t)}function L2(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function B2(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function V2(t){return V2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},V2(t)}var F2="filters",W2=250,U2=function(t){_2(n,t);var e=N2(n);function n(t){var r;return P2(this,n),r=e.call(this,t),r.eventManager=new Gr(L2(r)),r.dropdownMenuPlugin=null,r.conditionCollection=null,r.conditionUpdateObserver=null,r.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),r.filtersRowsMap=null,r.hot.addHook("afterGetColHeader",(function(t,e){return r.onAfterGetColHeader(t,e)})),r}return j2(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[F2]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Zg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var e=this.hot.getSettings().dropdownMenu,r=e&&e.uiContainer||this.hot.rootDocument.body,o=function(e){return e.addLocalHook("accept",(function(){return t.onActionBarSubmit("accept")})),e.addLocalHook("cancel",(function(){return t.onActionBarSubmit("cancel")})),e.addLocalHook("change",(function(n){return t.onComponentChange(e,n)})),e},i=function(){return"".concat(t.hot.getTranslatedPhrase(YS),":")},a=function(){return"".concat(t.hot.getTranslatedPhrase(KS),":")};if(!this.components.get("filter_by_condition")){var l=new JJ(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:r});l.addLocalHook("afterClose",(function(){return t.onSelectUIClosed()})),this.components.set("filter_by_condition",o(l))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new KZ(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var s=new JJ(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});s.addLocalHook("afterClose",(function(){return t.onSelectUIClosed()})),this.components.set("filter_by_condition2",o(s))}this.components.get("filter_by_value")||this.components.set("filter_by_value",o(new C1(this.hot,{id:"filter_by_value",name:a}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",o(new B1(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new e2(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new g2(this.hot,this.conditionCollection,(function(e){return t.getDataMapAtColumn(e)})),this.conditionUpdateObserver.addLocalHook("update",(function(e){return t.updateComponents(e)}))),this.components.forEach((function(t){return t.show()})),this.addHook("beforeDropdownMenuSetItems",(function(e){return t.onBeforeDropdownMenuSetItems(e)})),this.addHook("afterDropdownMenuDefaultOptions",(function(e){return t.onAfterDropdownMenuDefaultOptions(e)})),this.addHook("afterDropdownMenuShow",(function(){return t.onAfterDropdownMenuShow()})),this.addHook("afterDropdownMenuHide",(function(){return t.onAfterDropdownMenuHide()})),this.addHook("afterChange",(function(e){return t.onAfterChange(e)})),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),I2(V2(n.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var t,e=this;this.enabled&&(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((function(t,n){t.destroy(),e.components.set(n,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));I2(V2(n.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:rZ,o=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(o,{command:{key:e},args:n},r)}},{key:"removeConditions",value:function(t){var e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}},{key:"clearConditions",value:function(t){if(void 0===t)this.conditionCollection.clean();else{var e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}},{key:"filter",value:function(){var t=this,e=this._createDataFilter(),n=!this.conditionCollection.isEmpty(),r=[],o=this.conditionCollection.exportAllConditions(),i=this.hot.runHooks("beforeFilter",o);if(!1!==i)if(n){var a=[];this.hot.batchExecution((function(){t.filtersRowsMap.clear(),r=W(e.filter(),(function(t){return t.meta.visualRow}));var n=QZ(r);Ho(t.hot.countSourceRows()-1,(function(t){n(t)||a.push(t)})),U(a,(function(e){t.filtersRowsMap.setValueAtIndex(e,!0)}))}),!0),r.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var t,e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}},{key:"clearColumnSelection",value:function(){var t=this.getSelectedColumn();null!==t&&this.hot.selectCell(0,t.visualIndex)}},{key:"getDataMapAtColumn",value:function(t){var e=this,n=this.hot.toVisualColumn(t),r=[];return U(this.hot.getSourceDataAtCol(n),(function(t,o){var i,a=e.hot.getCellMeta(o,n),l=a.row,s=a.col,u=a.visualCol,c=a.visualRow,f=a.type,h=a.instance,d=a.dateFormat,p=a.locale,y=null!==(i=e.hot.getDataAtCell(e.hot.toVisualRow(o),n))&&void 0!==i?i:t;r.push({meta:{row:l,col:s,visualCol:u,visualRow:c,type:f,instance:h,dateFormat:d,locale:p},value:JZ(y)})})),r}},{key:"onAfterChange",value:function(t){var e=this;t&&U(t,(function(t){var n=S2(t,2),r=n[1],o=e.hot.propToCol(r);e.conditionCollection.hasConditions(o)&&e.updateValueComponentCondition(o)}))}},{key:"updateValueComponentCondition",value:function(t){var e=this.hot.getDataAtCol(t),n=ZZ(e);this.conditionUpdateObserver.updateStatesAtColumn(t,n)}},{key:"restoreComponents",value:function(t){var e,n=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach((function(t){t.isHidden()||t.restoreState(n)})),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var t=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",(function(){t.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})}))}},{key:"onAfterDropdownMenuDefaultOptions",value:function(t){t.items.push({name:$F}),this.components.forEach((function(e){t.items.push(e.getMenuItemDescriptor())}))}},{key:"getOperationBasedOnArguments",value:function(t,e,n,r){var o=t;return o===aZ&&e.command.key!==H$&&n.command.key!==H$&&r.command.key!==H$?o=uZ:r.command.key!==H$&&(e.command.key!==H$&&n.command.key!==H$||(o=rZ)),o}},{key:"onActionBarSubmit",value:function(t){var e;if("accept"===t){var n,r=this.getSelectedColumn();if(null===r)return void(null===(n=this.dropdownMenuPlugin)||void 0===n||n.close());var o=r.physicalIndex,i=this.components.get("filter_by_condition").getState(),a=this.components.get("filter_by_condition2").getState(),l=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),i,a,l);this.conditionUpdateObserver.groupChanges();var u=this.conditionCollection.getColumnStackPosition(o);-1===u&&(u=void 0),this.conditionCollection.removeConditions(o),i.command.key!==H$&&(this.conditionCollection.addCondition(o,i,s,u),a.command.key!==H$&&this.conditionCollection.addCondition(o,a,s,u)),l.command.key!==H$&&this.conditionCollection.addCondition(o,l,s,u),this.conditionUpdateObserver.flush(),this.components.forEach((function(t){return t.saveState(o)})),this.filtersRowsMap.clear(),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}},{key:"onComponentChange",value:function(t,e){this.updateDependentComponentsVisibility(),t.constructor!==JJ||e.inputsCount||this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var t=this.components.get("filter_by_condition"),e=t.getState(),n=e.command,r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents.apply(this,r):this.hideComponents.apply(this,r)}},{key:"onAfterGetColHeader",value:function(t,e){var n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?Ge(e,"htFiltersActive"):Ye(e,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new u2(e,(function(e){return t.getDataMapAtColumn(e)}))}},{key:"updateComponents",value:function(t){var e;if(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled){var n=t.editedConditionStack,r=n.conditions,o=n.column,i=r.filter((function(t){return t.name===J0})),a=r.filter((function(t){return t.name!==J0}));if(i.length>=2||a.length>=3)er($t(m2||(m2=w2(["The filter conditions have been applied properly, but couldn’t be displayed visually. \n        The overall amount of conditions exceed the capability of the dropdown menu. \n        For more details see the documentation."],["The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20\n        The overall amount of conditions exceed the capability of the dropdown menu.\\x20\n        For more details see the documentation."]))));else{var l=this.conditionCollection.getOperation(o);this.components.get("filter_by_condition").updateState(a[0],o),this.components.get("filter_by_condition2").updateState(a[1],o),this.components.get("filter_operators").updateState(l,o),this.components.get("filter_by_value").updateState(t)}}}},{key:"getIndexesOfComponents",value:function(){var t=[];if(!this.dropdownMenuPlugin)return t;for(var e=this.dropdownMenuPlugin.menu,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return U(r,(function(n){U(e.menuItems,(function(e,r){e.key===n.getMenuItemDescriptor().key&&t.push(r)}))})),t}},{key:"changeComponentsVisibility",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.dropdownMenuPlugin){for(var e=this.dropdownMenuPlugin.menu,n=e.hotMenu,r=n.getPlugin("hiddenRows"),o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];var l=this.getIndexesOfComponents.apply(this,i);t?r.showRows(l):r.hideRows(l),n.render()}}},{key:"hideComponents",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!1].concat(e))}},{key:"showComponents",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility.apply(this,[!0].concat(e))}},{key:"destroy",value:function(){var t=this;this.enabled&&(this.components.forEach((function(e,n){null!==e&&(e.destroy(),t.components.set(n,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),I2(V2(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return F2}},{key:"PLUGIN_PRIORITY",get:function(){return W2}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),n}(RH);function z2(t){return z2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z2(t)}function G2(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Y2(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?G2(Object(n),!0).forEach((function(e){K2(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):G2(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function K2(t,e,n){return e=X2(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X2(t){var e=$2(t,"string");return"symbol"===z2(e)?e:String(e)}function $2(t,e){if("object"!==z2(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==z2(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var q2,Q2="internal-use-in-handsontable",J2={licenseKey:Q2,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function Z2(t){var e,n;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:null===(e=t[X8])||void 0===e||null===(n=e.language)||void 0===n?void 0:n.langCode}}function t3(t){return Object.keys(t).reduce((function(e,n){return"hyperformula"!==n&&(e[n]=t[n]),e}),{})}function e3(t){var e,n=t[X8],r=t3(null!==n&&void 0!==n&&null!==(e=n.engine)&&void 0!==e&&e.hyperformula?n.engine:{}),o=Z2(t);return Y2(Y2(Y2({},J2),r),o)}function n3(t){var e,n=t[X8],r=t3(null!==n&&void 0!==n&&null!==(e=n.engine)&&void 0!==e&&e.hyperformula?n.engine:{}),o=Z2(t);return Y2(Y2({},r),o)}function r3(t,e){return Object.keys(e).some((function(n){return void 0!==e[n]&&e[n]!==t[n]}))}function o3(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function i3(t){return i3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i3(t)}function a3(){var t="engine_relationship",e=Rr(X8);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function l3(){var t="shared_engine_usage",e=Rr(X8);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function s3(t){var e,n=t.getSettings(),r=n[X8],o=null===r||void 0===r?void 0:r.engine;if(!0===r)return null;if(te(o))return null;if("function"===typeof o.hyperformula||"function"===typeof o)return u3(null!==(e=o.hyperformula)&&void 0!==e?e:o,n,t);if("object"===i3(o)&&te(o.hyperformula)){var i=a3(),a=l3().get(o);return i.has(o)||i.set(o,[]),i.get(o).push(t),a&&a.push(t.guid),o.getConfig().licenseKey||o.updateConfig({licenseKey:Q2}),o.getConfig().leapYear1900===J2.leapYear1900&&!1!==ft(o.getConfig().nullDate,J2.nullDate)||er($t(q2||(q2=o3(["If you use HyperFormula with Handsontable, keep the default `leapYear1900` and `nullDate` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."],["If you use HyperFormula with Handsontable, keep the default \\`leapYear1900\\` and \\`nullDate\\` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."])))),o}return null}function u3(t,e,n){var r=e[X8],o=e3(e),i=a3(),a=l3();h3(t,r.functions),d3(t,r.language);var l=t.buildEmpty(o);return i.set(l,[n]),a.set(l,[n.guid]),p3(l,r.namedExpressions),l.on("sheetAdded",(function(){l.rebuildAndRecalculate()})),l.on("sheetRemoved",(function(){l.rebuildAndRecalculate()})),l}function c3(t){var e,n=a3(),r=0===n.size?[]:Array.from(null!==(e=n.get(t))&&void 0!==e?e:[]);return new Map(r.map((function(t){return[t.getPlugin("formulas").sheetId,t]})))}function f3(t,e){if(t){var n=a3(),r=n.get(t),o=l3(),i=o.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),0===r.length&&n.delete(t)),i&&i.includes(e.guid)&&(i.splice(i.indexOf(e.guid),1),0===i.length&&(o.delete(t),t.destroy()))}}function h3(t,e){e&&e.forEach((function(e){var n=e.name,r=e.plugin,o=e.translations;try{t.registerFunction(n,r,o)}catch(i){er(i.message)}}))}function d3(t,e){if(e){var n=e.langCode;try{t.registerLanguage(n,e)}catch(r){er(r.message)}}}function p3(t,e){e&&(t.suspendEvaluation(),e.forEach((function(e){var n=e.name,r=e.expression,o=e.scope,i=e.options;try{t.addNamedExpression(n,r,o,i)}catch(a){er(a.message)}})),t.resumeEvaluation())}function y3(t,e){return!te(e)&&t.doesSheetExist(e)||(e=t.addSheet(e)),e}var v3="DD/MM/YYYY";function m3(t){return"string"===typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function g3(t){return m3(t)?t.substr(1):t}function b3(t){return"string"===typeof t&&t.startsWith("=")}function w3(t,e){return"string"===typeof t&&"date"===e}function S3(t,e){return Xt(t,e,!0).isValid()}function C3(t,e){return Xt(t,e,!0).format(v3)}function O3(t,e){return Xt(t,v3,!0).format(e)}function k3(t,e){var n=-1,r=new Date(Date.UTC(0,0,t+n));return Xt(r).format(e)}function R3(t){return R3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R3(t)}function E3(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P3(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,j3(r.key),r)}}function T3(t,e,n){return e&&P3(t.prototype,e),n&&P3(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function j3(t){var e=M3(t,"string");return"symbol"===R3(e)?e:String(e)}function M3(t,e){if("object"!==R3(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==R3(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function A3(t,e,n){I3(t,e),e.set(t,n)}function I3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function x3(t,e){var n=N3(t,e,"get");return _3(t,n)}function _3(t,e){return e.get?e.get.call(t):e.value}function H3(t,e,n){var r=N3(t,e,"set");return D3(t,r,n),n}function N3(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function D3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var L3=new WeakMap,B3=new WeakMap,V3=new WeakMap,F3=new WeakMap,W3=new WeakMap,U3=new WeakMap,z3=new WeakMap,G3=function(){function t(e,n,r){E3(this,t),A3(this,L3,{writable:!0,value:void 0}),A3(this,B3,{writable:!0,value:void 0}),A3(this,V3,{writable:!0,value:void 0}),A3(this,F3,{writable:!0,value:[]}),A3(this,W3,{writable:!0,value:[]}),A3(this,U3,{writable:!0,value:void 0}),A3(this,z3,{writable:!0,value:[]}),H3(this,L3,e),H3(this,B3,n),H3(this,V3,r)}return T3(t,[{key:"setRemovedHfIndexes",value:function(t){var e=this;return H3(this,z3,t.map((function(t){var n=x3(e,B3).getVisualFromPhysicalIndex(t);return e.getHfIndexFromVisualIndex(n)}))),x3(this,z3)}},{key:"getRemovedHfIndexes",value:function(){return x3(this,z3)}},{key:"getHfIndexFromVisualIndex",value:function(t){var e=x3(this,B3).getIndexesSequence(),n=x3(this,B3).getNotTrimmedIndexes();return e.indexOf(n[t])}},{key:"syncMoves",value:function(t){var e=this,n=1,r="move".concat(be(x3(this,L3)),"s");x3(this,V3).getEngine().batch((function(){t.forEach((function(t){var o=t.from!==t.to,i=t.from+1!==t.to;o&&i&&x3(e,V3).getEngine()[r](x3(e,V3).getSheetId(),t.from,n,t.to)}))}))}},{key:"storeMovesInformation",value:function(t,e,n){var r=this;!1!==n&&(H3(this,W3,t.map((function(t){return r.getHfIndexFromVisualIndex(t)}))),H3(this,U3,this.getHfIndexFromVisualIndex(e)))}},{key:"getMoveLine",value:function(t,e){var n,r=x3(this,B3).getNumberOfIndexes(),o=Array.from(Array(r).keys()).filter((function(e){return!1===t.includes(e)}));return 0===e?null!==(n=o[e])&&void 0!==n?n:0:o[e-1]+1}},{key:"getInitiallyCalculatedMoves",value:function(t,e){var n=this.getMoveLine(t,e),r=[];return t.forEach((function(t){var e={from:t,to:n};r.forEach((function(t){var n=t.from>t.to,r=t.to<=e.from,o=t.from>e.from;o&&r&&n&&(e.from+=1)})),e.from>=n&&(n+=1),r.push(e)})),r}},{key:"adjustedCalculatedMoves",value:function(t){return t.forEach((function(e,n){var r=t.slice(n+1);r.forEach((function(t){var n=t.from<t.to;t.from>e.from&&n&&(t.from-=1)}))})),t}},{key:"calculateAndSyncMoves",value:function(t,e){var n=this;if(!x3(this,V3).isPerformingUndoRedo()&&!1!==t&&!1!==e){var r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(x3(this,W3),x3(this,U3)));null===x3(this,V3).getSheetId()?x3(this,V3).getPostponeAction((function(){return n.syncMoves(r)})):this.syncMoves(r)}}},{key:"getIndexesChangeSyncMethod",value:function(){var t=this,e="set".concat(be(x3(this,L3)),"Order");return function(n){if(!x3(t,V3).isPerformingUndoRedo()){var r=x3(t,B3).getIndexesSequence();if("update"===n){var o,i=x3(t,F3).map((function(t){return r.indexOf(t)})),a=x3(t,V3).getEngine().getSheetDimensions(x3(t,V3).getSheetId());o="row"===x3(t,L3)?a.height:a.width;for(var l=i.length,s=l;s<o;s+=1)i.push(s);x3(t,V3).getEngine()[e](x3(t,V3).getSheetId(),i)}H3(t,F3,r)}}}},{key:"init",value:function(){H3(this,F3,x3(this,B3).getIndexesSequence())}}]),t}(),Y3=G3;function K3(t){return K3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K3(t)}function X3(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $3(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Q3(r.key),r)}}function q3(t,e,n){return e&&$3(t.prototype,e),n&&$3(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Q3(t){var e=J3(t,"string");return"symbol"===K3(e)?e:String(e)}function J3(t,e){if("object"!==K3(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==K3(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Z3(t,e,n){t8(t,e),e.set(t,n)}function t8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function e8(t,e){var n=o8(t,e,"get");return n8(t,n)}function n8(t,e){return e.get?e.get.call(t):e.value}function r8(t,e,n){var r=o8(t,e,"set");return i8(t,r,n),n}function o8(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function i8(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var a8=new WeakMap,l8=new WeakMap,s8=new WeakMap,u8=new WeakMap,c8=new WeakMap,f8=new WeakMap,h8=new WeakMap,d8=function(){function t(e,n,r){X3(this,t),Z3(this,a8,{writable:!0,value:void 0}),Z3(this,l8,{writable:!0,value:void 0}),Z3(this,s8,{writable:!0,value:void 0}),Z3(this,u8,{writable:!0,value:!1}),Z3(this,c8,{writable:!0,value:!1}),Z3(this,f8,{writable:!0,value:null}),Z3(this,h8,{writable:!0,value:null}),r8(this,a8,new Y3("row",e,this)),r8(this,l8,new Y3("column",n,this)),r8(this,s8,r)}return q3(t,[{key:"getForAxis",value:function(t){return e8(this,"row"===t?a8:l8)}},{key:"setPerformUndo",value:function(t){r8(this,u8,t)}},{key:"setPerformRedo",value:function(t){r8(this,c8,t)}},{key:"isPerformingUndoRedo",value:function(){return e8(this,u8)||e8(this,c8)}},{key:"getSheetId",value:function(){return e8(this,h8)}},{key:"getEngine",value:function(){return e8(this,f8)}},{key:"getPostponeAction",value:function(){return e8(this,s8)}},{key:"setupSyncEndpoint",value:function(t,e){r8(this,f8,t),r8(this,h8,e),e8(this,a8).init(),e8(this,l8).init()}}]),t}(),p8=d8;function y8(t){return g8(t)||m8(t)||C8(t)||v8()}function v8(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function m8(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function g8(t){if(Array.isArray(t))return O8(t)}function b8(t){return b8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b8(t)}function w8(t,e){return R8(t)||k8(t,e)||C8(t,e)||S8()}function S8(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function C8(t,e){if(t){if("string"===typeof t)return O8(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O8(t,e):void 0}}function O8(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function k8(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function R8(t){if(Array.isArray(t))return t}function E8(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P8(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,B8(r.key),r)}}function T8(t,e,n){return e&&P8(t.prototype,e),n&&P8(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function j8(){return j8="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=M8(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},j8.apply(this,arguments)}function M8(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=D8(t),null===t)break;return t}function A8(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&I8(t,e)}function I8(t,e){return I8=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},I8(t,e)}function x8(t){var e=N8();return function(){var n,r=D8(t);if(e){var o=D8(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _8(this,n)}}function _8(t,e){if(e&&("object"===b8(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return H8(t)}function H8(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function N8(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function D8(t){return D8=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},D8(t)}function L8(t,e,n){return e=B8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B8(t){var e=V8(t,"string");return"symbol"===b8(e)?e:String(e)}function V8(t,e){if("object"!==b8(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==b8(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function F8(t,e,n){W8(t,e),e.set(t,n)}function W8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function U8(t,e,n){var r=Y8(t,e,"set");return z8(t,r,n),n}function z8(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function G8(t,e){var n=Y8(t,e,"get");return K8(t,n)}function Y8(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function K8(t,e){return e.get?e.get.call(t):e.value}var X8="formulas",$8=["maxRows","maxColumns","language"],q8=260;mr.getSingleton().register("afterNamedExpressionAdded"),mr.getSingleton().register("afterNamedExpressionRemoved"),mr.getSingleton().register("afterSheetAdded"),mr.getSingleton().register("afterSheetRemoved"),mr.getSingleton().register("afterSheetRenamed"),mr.getSingleton().register("afterFormulasValuesUpdate");var Q8=function(t){return"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t},J8=new WeakMap,Z8=new WeakMap,t6=new WeakMap,e6=function(t){A8(n,t);var e=x8(n);function n(){var t;E8(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),F8(H8(t),J8,{writable:!0,value:!1}),F8(H8(t),Z8,{writable:!0,value:!1}),F8(H8(t),t6,{writable:!0,value:[["valuesUpdated",function(){var e;return(e=t).onEngineValuesUpdated.apply(e,arguments)}],["namedExpressionAdded",function(){var e;return(e=t).onEngineNamedExpressionsAdded.apply(e,arguments)}],["namedExpressionRemoved",function(){var e;return(e=t).onEngineNamedExpressionsRemoved.apply(e,arguments)}],["sheetAdded",function(){var e;return(e=t).onEngineSheetAdded.apply(e,arguments)}],["sheetRenamed",function(){var e;return(e=t).onEngineSheetRenamed.apply(e,arguments)}],["sheetRemoved",function(){var e;return(e=t).onEngineSheetRemoved.apply(e,arguments)}]]}),L8(H8(t),"staticRegister",Rr("formulas")),L8(H8(t),"engine",null),L8(H8(t),"sheetName",null),L8(H8(t),"indexSyncer",null),L8(H8(t),"rowAxisSyncer",null),L8(H8(t),"columnAxisSyncer",null),t}return T8(n,[{key:"sheetId",get:function(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[X8]}},{key:"enablePlugin",value:function(){var t,e=this;if(!this.enabled)if(this.engine=null!==(t=s3(this.hot))&&void 0!==t?t:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){var r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==r&&(this.sheetName=r)}this.addHook("beforeLoadData",(function(){return e.onBeforeLoadData.apply(e,arguments)})),this.addHook("afterLoadData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("beforeUpdateData",(function(){return e.onBeforeLoadData.apply(e,arguments)})),this.addHook("afterUpdateData",(function(){return e.onAfterLoadData.apply(e,arguments)})),this.addHook("modifyData",(function(){return e.onModifyData.apply(e,arguments)})),this.addHook("modifySourceData",(function(){return e.onModifySourceData.apply(e,arguments)})),this.addHook("beforeValidate",(function(){return e.onBeforeValidate.apply(e,arguments)})),this.addHook("afterSetSourceDataAtCell",(function(){return e.onAfterSetSourceDataAtCell.apply(e,arguments)})),this.addHook("afterSetDataAtCell",(function(){return e.onAfterSetDataAtCell.apply(e,arguments)})),this.addHook("afterSetDataAtRowProp",(function(){return e.onAfterSetDataAtCell.apply(e,arguments)})),this.addHook("beforeCreateRow",(function(){return e.onBeforeCreateRow.apply(e,arguments)})),this.addHook("beforeCreateCol",(function(){return e.onBeforeCreateCol.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("afterCreateCol",(function(){return e.onAfterCreateCol.apply(e,arguments)})),this.addHook("beforeRemoveRow",(function(){return e.onBeforeRemoveRow.apply(e,arguments)})),this.addHook("beforeRemoveCol",(function(){return e.onBeforeRemoveCol.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("afterRemoveCol",(function(){return e.onAfterRemoveCol.apply(e,arguments)})),this.indexSyncer=new p8(this.hot.rowIndexMapper,this.hot.columnIndexMapper,(function(t){e.hot.addHookOnce("init",(function(){t()}))})),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(function(t,n,r,o){e.rowAxisSyncer.storeMovesInformation(t,n,o)})),this.hot.addHook("beforeColumnMove",(function(t,n,r,o){e.columnAxisSyncer.storeMovesInformation(t,n,o)})),this.hot.addHook("afterRowMove",(function(t,n,r,o,i){e.rowAxisSyncer.calculateAndSyncMoves(o,i)})),this.hot.addHook("afterColumnMove",(function(t,n,r,o,i){e.columnAxisSyncer.calculateAndSyncMoves(o,i)})),this.hot.addHook("beforeColumnFreeze",(function(t,n){e.columnAxisSyncer.storeMovesInformation([t],e.hot.getSettings().fixedColumnsStart,n)})),this.hot.addHook("afterColumnFreeze",(function(t,n){e.columnAxisSyncer.calculateAndSyncMoves(n,n)})),this.hot.addHook("beforeColumnUnfreeze",(function(t,n){e.columnAxisSyncer.storeMovesInformation([t],e.hot.getSettings().fixedColumnsStart-1,n)})),this.hot.addHook("afterColumnUnfreeze",(function(t,n){e.columnAxisSyncer.calculateAndSyncMoves(n,n)})),this.addHook("afterCellMetaReset",(function(){return e.onAfterCellMetaReset.apply(e,arguments)})),this.addHook("beforeUndo",(function(){e.indexSyncer.setPerformUndo(!0),e.engine.undo()})),this.addHook("beforeRedo",(function(){e.indexSyncer.setPerformRedo(!0),e.engine.redo()})),this.addHook("afterUndo",(function(){e.indexSyncer.setPerformUndo(!1)})),this.addHook("afterUndo",(function(){e.indexSyncer.setPerformRedo(!1)})),this.addHook("afterDetachChild",(function(){return e.onAfterDetachChild.apply(e,arguments)})),this.addHook("beforeAutofill",(function(){return e.onBeforeAutofill.apply(e,arguments)})),G8(this,t6).forEach((function(t){var n=w8(t,2),r=n[0],o=n[1];return e.engine.on(r,o)})),j8(D8(n.prototype),"enablePlugin",this).call(this)}else er("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}},{key:"disablePlugin",value:function(){var t=this;G8(this,t6).forEach((function(e){var n=w8(e,2),r=n[0],o=n[1];return t.engine.off(r,o)})),f3(this.engine,this.hot),this.engine=null,j8(D8(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(t){var e=n3(this.hot.getSettings());r3(this.engine.getConfig(),e)&&this.engine.updateConfig(e);var r=this.hot.getSettings()[X8];if(Zt(r)&&Zt(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!t.data&&null===this.sheetName){var o=this.hot.getSettings()[X8].sheetName;o&&this.engine.doesSheetExist(o)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!==o&&void 0!==o?o:void 0,this.hot.getSourceDataArray())}j8(D8(n.prototype),"updatePlugin",this).call(this,t)}},{key:"destroy",value:function(){var t=this;G8(this,t6).forEach((function(e){var n,r=w8(e,2),o=r[0],i=r[1];return null===(n=t.engine)||void 0===n?void 0:n.off(o,i)})),U8(this,t6,null),f3(this.engine,this.hot),this.engine=null,j8(D8(n.prototype),"destroy",this).call(this)}},{key:"addSheet",value:function(t,e){if(Zt(e)&&!Fv(e))return er("The provided data should be an array of arrays."),!1;if(void 0!==t&&null!==t&&this.engine.doesSheetExist(t))return er("Sheet with the provided name already exists."),!1;try{var n=this.engine.addSheet(null!==t&&void 0!==t?t:void 0);return e&&this.engine.setSheetContent(this.engine.getSheetId(n),e),n}catch(r){return er(r.message),!1}}},{key:"switchSheet",value:function(t){if(this.engine.doesSheetExist(t)){this.sheetName=t;var e=this.engine.getSheetSerialized(this.sheetId);e.length>0&&this.hot.loadData(e,"".concat(be(X8),".switchSheet"))}else nr("The sheet named `".concat(t,"` does not exist, switch aborted."))}},{key:"getCellType",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(e);return null!==r&&null!==o?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)}):"EMPTY"}},{key:"isFormulaCellType",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)})}},{key:"renderDependentSheets",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new Set;t.forEach((function(t){var e,n=null===t||void 0===t||null===(e=t.address)||void 0===e?void 0:e.sheet;void 0!==n&&(r.has(n)||r.add(n))})),c3(this.engine).forEach((function(t,o){var i;(n||o!==e.sheetId)&&r.has(o)&&(t.render(),null===(i=t.view)||void 0===i||i.adjustElementsSize())}))}},{key:"validateDependentCells",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=function(t){var e,n=null!==(e=null===t||void 0===t?void 0:t.address)&&void 0!==e?e:{},r=n.row,o=n.col,i=n.sheet;return Zt(i)?"".concat(i,":").concat(r,"x").concat(o):""},o=new Set(n.map((function(t){return r(t)})));t.forEach((function(t){var n,i,a=null!==(n=t.address)&&void 0!==n?n:{},l=a.row,s=a.col;if(!(!1===Zt(l)||!1===Zt(s)||l>=e.hot.countRows()||s>=e.hot.countCols())){var u=null===t||void 0===t||null===(i=t.address)||void 0===i?void 0:i.sheet,c=r(t);if(void 0!==u&&!o.has(c)){var f=c3(e.engine).get(u);if(!f)return;f.validateCell(f.getDataAtCell(l,s),f.getCellMeta(l,s),(function(){}))}}}))}},{key:"syncChangeWithEngine",value:function(t,e,n){var r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};if(this.engine.isItPossibleToSetCellContents(r)){var o=this.hot.getCellMeta(t,e);return w3(n,o.type)&&(S3(n,o.dateFormat)?n=C3(n,o.dateFormat):!1===b3(n)&&(n="'".concat(n))),this.engine.setCellContents(r,n)}er("Not possible to set cell data at ".concat(JSON.stringify(r)))}},{key:"onBeforeValidate",value:function(t,e,n){var r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){var o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},i=this.hot.getCellMeta(e,r),a=this.engine.getCellValue(o);return"date"===i.type&&xo(a)&&(a=k3(a,i.dateFormat)),"object"===b8(a)&&null!==a?a.value:a}return t}},{key:"onBeforeAutofill",value:function(t,e,n){var r=e.getTopStartCorner(),o=r.row,i=r.col,a=e.getBottomEndCorner(),l=a.row,s=a.col,u=n.getTopStartCorner(),c=u.row,f=u.col,h=n.getBottomEndCorner(),d=h.row,p=h.col,y={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},v={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(f),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(d),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(p),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(v))return!1;for(var m=this.engine.getFillRangeData(y,v),g=y.start,b=g.row,w=g.col,S=y.end,C=S.row,O=S.col,k=C-b+1,R=O-w+1,E=0;E<m.length;E+=1)for(var P=0;P<m[E].length;P+=1){var T=m[E][P],j=E%k,M=P%R,A=this.hot.getCellMeta(j,M);w3(T,A.type)&&(T.startsWith("'")?m[E][P]=T.slice(1):!1===this.isFormulaCellType(j,M,this.sheetId)&&(m[E][P]=O3(T,A.dateFormat)))}return m}},{key:"onBeforeLoadData",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";n.includes(be(X8))||U8(this,Z8,te(this.hot.getSettings().data))}},{key:"onAfterCellMetaReset",value:function(){var t=this,e=this.hot.getSourceDataArray(),n=!1;e.forEach((function(r,o){r.forEach((function(r,i){var a=t.hot.getCellMeta(o,i),l=a.dateFormat;w3(r,a.type)&&(n=!0,S3(r,l)?e[o][i]=C3(r,l):!1===t.isFormulaCellType(o,i)&&(e[o][i]="'".concat(r)))}))})),!0===n&&(U8(this,J8,!0),this.engine.setSheetContent(this.sheetId,e),U8(this,J8,!1))}},{key:"onAfterLoadData",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!n.includes(be(X8)))if(this.sheetName=y3(this.engine,this.hot.getSettings()[X8].sheetName),G8(this,Z8))this.switchSheet(this.sheetName);else{var r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){U8(this,J8,!0);var o=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),U8(this,J8,!1)}}}},{key:"onModifyData",value:function(t,e,n,r){if("get"===r&&!G8(this,J8)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var o=this.hot.toVisualRow(t);if(null!==o&&null!==e){var i=this.isFormulaCellType(o,e);if(!i){var a=this.getCellType(o,e);if("ARRAY"!==a)return void(m3(n.value)&&(n.value=g3(n.value)))}var l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId},s=this.engine.getCellValue(l),u=this.hot.getCellMeta(o,e);"date"===u.type&&xo(s)&&(s=k3(s,u.dateFormat));var c="object"===b8(s)&&null!==s?s.value:s;n.value=c}}}},{key:"onModifySourceData",value:function(t,e,n,r){if("get"===r&&!G8(this,J8)&&null!==this.sheetName&&this.engine.doesSheetExist(this.sheetName)){var o=this.hot.toVisualRow(t),i=this.hot.propToCol(e);if(null!==o&&null!==i){var a=this.isFormulaCellType(o,i);if(!a){var l=this.getCellType(o,i);if("ARRAY"!==l)return}var s=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0!==s.width||0!==s.height){var u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId};n.value=this.engine.getCellSerialized(u)}}}}},{key:"onAfterSetDataAtCell",value:function(t,e){var n=this;if(!Q8(e)){var r=[],o=[],i=this.engine.batch((function(){t.forEach((function(t){var e=w8(t,4),i=e[0],a=e[1],l=e[3],s=n.hot.propToCol(a),u=n.hot.toPhysicalRow(i),c=n.hot.toPhysicalColumn(s),f={row:n.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:n.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:n.sheetId};null!==u&&null!==c?n.syncChangeWithEngine(i,s,l):r.push([i,s,l]),o.push({address:f})}))}));r.length&&this.hot.addHookOnce("afterChange",(function(){var t=n.engine.batch((function(){r.forEach((function(t){var e=w8(t,3),r=e[0],o=e[1],i=e[2];n.syncChangeWithEngine(r,o,i)}))}));n.renderDependentSheets(t,!0)})),this.renderDependentSheets(i),this.validateDependentCells(i,o)}}},{key:"onAfterSetSourceDataAtCell",value:function(t,e){var n=this;if(!Q8(e)){var r=[],o=[];t.forEach((function(t){var e=w8(t,4),i=e[0],a=e[1],l=e[3],s=n.hot.propToCol(a);if(xo(s)){var u={row:n.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:n.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:n.sheetId};n.engine.isItPossibleToSetCellContents(u)?(o.push({address:u}),r.push.apply(r,y8(n.engine.setCellContents(u,l)))):er("Not possible to set source cell data at ".concat(JSON.stringify(u)))}})),this.renderDependentSheets(r),this.validateDependentCells(r,o)}}},{key:"onBeforeCreateRow",value:function(t,e){var n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}},{key:"onBeforeCreateCol",value:function(t,e){var n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}},{key:"onBeforeRemoveRow",value:function(t,e,n){var r=this,o=this.rowAxisSyncer.setRemovedHfIndexes(n),i=o.every((function(t){return r.engine.isItPossibleToRemoveRows(r.sheetId,[t,1])}));return!1!==i&&void 0}},{key:"onBeforeRemoveCol",value:function(t,e,n){var r=this,o=this.columnAxisSyncer.setRemovedHfIndexes(n),i=o.every((function(t){return r.engine.isItPossibleToRemoveColumns(r.sheetId,[t,1])}));return!1!==i&&void 0}},{key:"onAfterCreateRow",value:function(t,e,n){if(!Q8(n)){var r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}}},{key:"onAfterCreateCol",value:function(t,e,n){if(!Q8(n)){var r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}}},{key:"onAfterRemoveRow",value:function(t,e,n,r){var o=this;if(!Q8(r)){var i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),a=this.engine.batch((function(){i.forEach((function(t){o.engine.removeRows(o.sheetId,[t,1])}))}));this.renderDependentSheets(a)}}},{key:"onAfterRemoveCol",value:function(t,e,n,r){var o=this;if(!Q8(r)){var i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),a=this.engine.batch((function(){i.forEach((function(t){o.engine.removeColumns(o.sheetId,[t,1])}))}));this.renderDependentSheets(a)}}},{key:"onAfterDetachChild",value:function(t,e,n){var r,o=this;U8(this,J8,!0);var i=this.hot.getSourceDataArray(n,0,n+((null===(r=e.__children)||void 0===r?void 0:r.length)||0),this.hot.countSourceCols());U8(this,J8,!1),i.forEach((function(t,e){t.forEach((function(t,r){o.engine.setCellContents({col:r,row:n+e,sheet:o.sheetId},[[t]])}))}))}},{key:"onEngineValuesUpdated",value:function(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}},{key:"onEngineNamedExpressionsAdded",value:function(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}},{key:"onEngineNamedExpressionsRemoved",value:function(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}},{key:"onEngineSheetAdded",value:function(t){this.hot.runHooks("afterSheetAdded",t)}},{key:"onEngineSheetRenamed",value:function(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}},{key:"onEngineSheetRemoved",value:function(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}}],[{key:"PLUGIN_KEY",get:function(){return X8}},{key:"PLUGIN_PRIORITY",get:function(){return q8}},{key:"SETTING_KEYS",get:function(){return[X8].concat($8)}}]),n}(RH);function n6(t,e){return l6(t)||a6(t,e)||o6(t,e)||r6()}function r6(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o6(t,e){if(t){if("string"===typeof t)return i6(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i6(t,e):void 0}}function i6(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a6(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function l6(t){if(Array.isArray(t))return t}function s6(t){return{key:"hidden_columns_hide",name:function(){var t=this.getSelectedLast(),e=0;if(Array.isArray(t)){var n=n6(t,4),r=n[1],o=n[3];r-o!==0&&(e=1)}return this.getTranslatedPhrase(bS,e)},callback:function(){for(var e=this.getSelectedRangeLast(),n=e.from,r=e.to,o=Math.max(Math.min(n.col,r.col),0),i=Math.max(n.col,r.col),a=[],l=o;l<=i;l+=1)a.push(l);t.hideColumns(a);var s=a[a.length-1],u=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(u)&&u>=0?this.selectColumns(u):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function u6(t){return d6(t)||h6(t)||f6(t)||c6()}function c6(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f6(t,e){if(t){if("string"===typeof t)return p6(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p6(t,e):void 0}}function h6(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function d6(t){if(Array.isArray(t))return p6(t)}function p6(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function y6(t){var e=[];return{key:"hidden_columns_show",name:function(){var t=e.length>1?1:0;return this.getTranslatedPhrase(wS,t)},callback:function(){var n,r;if(0!==e.length){var o=e[0],i=e[e.length-1];o=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,i=null!==(r=this.columnIndexMapper.getNearestNotHiddenIndex(i+1,1))&&void 0!==r?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0);var a=i-o+1===this.countCols();a||this.selectColumns(o,i)}},disabled:!1,hidden:function(){var n=this,r=W(t.getHiddenColumns(),(function(t){return n.toPhysicalColumn(t)}));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;e.length=0;var o=this.getSelectedRangeLast(),i=o.getTopStartCorner().col,a=o.getBottomEndCorner().col,l=this.columnIndexMapper,s=l.getRenderableFromVisualIndex(i),u=l.getRenderableFromVisualIndex(a),c=l.getNotTrimmedIndexes(),f=[];if(i!==a){var h=a-i+1,d=u-s+1;if(h>d){var p=c.slice(i,a+1);f.push.apply(f,u6(p.filter((function(t){return r.includes(t)}))))}}else if(0===s&&s<i)f.push.apply(f,u6(c.slice(0,i)));else if(null===s)f.push.apply(f,u6(c.slice(0,this.countCols())));else{var y=this.countCols()-1,v=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(y,-1));u===v&&y>a&&f.push.apply(f,u6(c.slice(a+1)))}return U(f,(function(t){e.push(n.toVisualColumn(t))})),0===e.length}}}function v6(t){return v6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v6(t)}function m6(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g6(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,w6(r.key),r)}}function b6(t,e,n){return e&&g6(t.prototype,e),n&&g6(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function w6(t){var e=S6(t,"string");return"symbol"===v6(e)?e:String(e)}function S6(t,e){if("object"!==v6(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==v6(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function C6(){return C6="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=O6(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},C6.apply(this,arguments)}function O6(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=M6(t),null===t)break;return t}function k6(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&R6(t,e)}function R6(t,e){return R6=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},R6(t,e)}function E6(t){var e=j6();return function(){var n,r=M6(t);if(e){var o=M6(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return P6(this,n)}}function P6(t,e){if(e&&("object"===v6(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return T6(t)}function T6(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j6(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function M6(t){return M6=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},M6(t)}function A6(t,e,n){I6(t,e),e.set(t,n)}function I6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function x6(t,e){var n=N6(t,e,"get");return _6(t,n)}function _6(t,e){return e.get?e.get.call(t):e.value}function H6(t,e,n){var r=N6(t,e,"set");return D6(t,r,n),n}function N6(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function D6(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}mr.getSingleton().register("beforeHideColumns"),mr.getSingleton().register("afterHideColumns"),mr.getSingleton().register("beforeUnhideColumns"),mr.getSingleton().register("afterUnhideColumns");var L6="hiddenColumns",B6=310,V6=new WeakMap,F6=new WeakMap,W6=function(t){k6(n,t);var e=E6(n);function n(){var t;m6(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),A6(T6(t),V6,{writable:!0,value:{}}),A6(T6(t),F6,{writable:!0,value:null}),t}return b6(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[L6]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[L6];ht(e)&&(H6(this,V6,e),te(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),H6(this,F6,new vg),x6(this,F6).addLocalHook("init",(function(){return t.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,x6(this,F6)),this.addHook("afterContextMenuDefaultOptions",(function(){return t.onAfterContextMenuDefaultOptions.apply(t,arguments)})),this.addHook("afterGetCellMeta",(function(e,n,r){return t.onAfterGetCellMeta(e,n,r)})),this.addHook("modifyColWidth",(function(e,n){return t.onModifyColWidth(e,n)})),this.addHook("afterGetColHeader",(function(){return t.onAfterGetColHeader.apply(t,arguments)})),this.addHook("modifyCopyableRange",(function(e){return t.onModifyCopyableRange(e)})),C6(M6(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),C6(M6(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),H6(this,V6,{}),C6(M6(n.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(t){var e=this,n=this.getHiddenColumns(),r=this.isValidConfig(t),o=n,i=x6(this,F6).getValues().slice(),a=t.length>0;if(r&&a){var l=t.map((function(t){return e.hot.toPhysicalColumn(t)}));U(l,(function(t){i[t]=!1})),o=V(i,(function(t,n,r){return n&&t.push(e.hot.toVisualColumn(r)),t}),[])}var s=this.hot.runHooks("beforeUnhideColumns",n,o,r&&a);!1!==s&&(r&&a&&x6(this,F6).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,o,r&&a,r&&o.length<n.length))}},{key:"showColumn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showColumns(e)}},{key:"hideColumns",value:function(t){var e=this,n=this.getHiddenColumns(),r=this.isValidConfig(t),o=n;r&&(o=Array.from(new Set(n.concat(t))));var i=this.hot.runHooks("beforeHideColumns",n,o,r);!1!==i&&(r&&this.hot.batchExecution((function(){U(t,(function(t){x6(e,F6).setValueAtIndex(e.hot.toPhysicalColumn(t),!0)}))}),!0),this.hot.runHooks("afterHideColumns",n,o,r,r&&o.length>n.length))}},{key:"hideColumn",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideColumns(e)}},{key:"getHiddenColumns",value:function(){var t=this;return W(x6(this,F6).getHiddenIndexes(),(function(e){return t.hot.toVisualColumn(e)}))}},{key:"isHidden",value:function(t){return x6(this,F6).getValueAtIndex(this.hot.toPhysicalColumn(t))||!1}},{key:"isValidConfig",value:function(t){var e=this.hot.countCols();return!!(Array.isArray(t)&&t.length>0)&&t.every((function(t){return Number.isInteger(t)&&t>=0&&t<e}))}},{key:"resetCellsMeta",value:function(){U(this.hot.getCellsMeta(),(function(t){t&&(t.skipColumnOnPaste=!1)}))}},{key:"onModifyColWidth",value:function(t,e){return this.isHidden(e)?0:x6(this,V6).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&"number"===typeof t&&this.hot.hasColHeaders()?t+15:void 0}},{key:"onAfterGetCellMeta",value:function(t,e,n){if(!1===x6(this,V6).copyPasteEnabled&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){var r=n.className.split(" ");if(r.length>0){var o=r.indexOf("afterHiddenColumn");o>-1&&r.splice(o,1),n.className=r.join(" ")}}}},{key:"onModifyCopyableRange",value:function(t){var e=this;if(x6(this,V6).copyPasteEnabled)return t;var n=[],r=function(t,e,r,o){n.push({startRow:t,endRow:e,startCol:r,endCol:o})};return U(t,(function(t){var n=!0,o=0;Ho(t.startCol,t.endCol,(function(i){e.isHidden(i)?(n||r(t.startRow,t.endRow,o,i-1),n=!0):(n&&(o=i),i===t.endCol&&r(t.startRow,t.endRow,o,i),n=!1)}))})),n}},{key:"onAfterGetColHeader",value:function(t,e){if(x6(this,V6).indicators&&!(t<0)){var n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),Ge(e,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(t){t.items.push({name:$F},s6(this),y6(this))}},{key:"onMapInit",value:function(){Array.isArray(x6(this,V6).columns)&&this.hideColumns(x6(this,V6).columns)}},{key:"destroy",value:function(){H6(this,V6,null),H6(this,F6,null),C6(M6(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return L6}},{key:"PLUGIN_PRIORITY",get:function(){return B6}}]),n}(RH);function U6(t,e){return X6(t)||K6(t,e)||G6(t,e)||z6()}function z6(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function G6(t,e){if(t){if("string"===typeof t)return Y6(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y6(t,e):void 0}}function Y6(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function K6(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function X6(t){if(Array.isArray(t))return t}function $6(t){return{key:"hidden_rows_hide",name:function(){var t=this.getSelectedLast(),e=0;if(Array.isArray(t)){var n=U6(t,3),r=n[0],o=n[2];r-o!==0&&(e=1)}return this.getTranslatedPhrase(SS,e)},callback:function(){for(var e=this.getSelectedRangeLast(),n=e.from,r=e.to,o=Math.max(Math.min(n.row,r.row),0),i=Math.max(n.row,r.row),a=[],l=o;l<=i;l+=1)a.push(l);t.hideRows(a);var s=a[a.length-1],u=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(u)&&u>=0?this.selectRows(u):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function q6(t){return t5(t)||Z6(t)||J6(t)||Q6()}function Q6(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function J6(t,e){if(t){if("string"===typeof t)return e5(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e5(t,e):void 0}}function Z6(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function t5(t){if(Array.isArray(t))return e5(t)}function e5(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function n5(t){var e=[];return{key:"hidden_rows_show",name:function(){var t=e.length>1?1:0;return this.getTranslatedPhrase(CS,t)},callback:function(){var n,r;if(0!==e.length){var o=e[0],i=e[e.length-1];o=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,i=null!==(r=this.rowIndexMapper.getNearestNotHiddenIndex(i+1,1))&&void 0!==r?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0);var a=i-o+1===this.countRows();a||this.selectRows(o,i)}},disabled:!1,hidden:function(){var n=this,r=W(t.getHiddenRows(),(function(t){return n.toPhysicalRow(t)}));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;e.length=0;var o=this.getSelectedRangeLast(),i=o.getTopStartCorner().row,a=o.getBottomEndCorner().row,l=this.rowIndexMapper,s=l.getRenderableFromVisualIndex(i),u=l.getRenderableFromVisualIndex(a),c=l.getNotTrimmedIndexes(),f=[];if(i!==a){var h=a-i+1,d=u-s+1;if(h>d){var p=c.slice(i,a+1);f.push.apply(f,q6(p.filter((function(t){return r.includes(t)}))))}}else if(0===s&&s<i)f.push.apply(f,q6(c.slice(0,i)));else if(null===s)f.push.apply(f,q6(c.slice(0,this.countRows())));else{var y=this.countRows()-1,v=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(y,-1));u===v&&y>a&&f.push.apply(f,q6(c.slice(a+1)))}return U(f,(function(t){e.push(n.toVisualRow(t))})),0===e.length}}}function r5(t){return r5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r5(t)}function o5(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i5(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,l5(r.key),r)}}function a5(t,e,n){return e&&i5(t.prototype,e),n&&i5(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function l5(t){var e=s5(t,"string");return"symbol"===r5(e)?e:String(e)}function s5(t,e){if("object"!==r5(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==r5(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function u5(){return u5="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=c5(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},u5.apply(this,arguments)}function c5(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=m5(t),null===t)break;return t}function f5(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h5(t,e)}function h5(t,e){return h5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h5(t,e)}function d5(t){var e=v5();return function(){var n,r=m5(t);if(e){var o=m5(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p5(this,n)}}function p5(t,e){if(e&&("object"===r5(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return y5(t)}function y5(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v5(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function m5(t){return m5=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},m5(t)}function g5(t,e,n){b5(t,e),e.set(t,n)}function b5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function w5(t,e){var n=O5(t,e,"get");return S5(t,n)}function S5(t,e){return e.get?e.get.call(t):e.value}function C5(t,e,n){var r=O5(t,e,"set");return k5(t,r,n),n}function O5(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function k5(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}mr.getSingleton().register("beforeHideRows"),mr.getSingleton().register("afterHideRows"),mr.getSingleton().register("beforeUnhideRows"),mr.getSingleton().register("afterUnhideRows");var R5="hiddenRows",E5=320,P5=new WeakMap,T5=new WeakMap,j5=function(t){f5(n,t);var e=d5(n);function n(){var t;o5(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),g5(y5(t),P5,{writable:!0,value:{}}),g5(y5(t),T5,{writable:!0,value:null}),t}return a5(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[R5]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[R5];ht(e)&&(C5(this,P5,e),te(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),C5(this,T5,new vg),w5(this,T5).addLocalHook("init",(function(){return t.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,w5(this,T5)),this.addHook("afterContextMenuDefaultOptions",(function(){return t.onAfterContextMenuDefaultOptions.apply(t,arguments)})),this.addHook("afterGetCellMeta",(function(e,n,r){return t.onAfterGetCellMeta(e,n,r)})),this.addHook("modifyRowHeight",(function(e,n){return t.onModifyRowHeight(e,n)})),this.addHook("afterGetRowHeader",(function(){return t.onAfterGetRowHeader.apply(t,arguments)})),this.addHook("modifyCopyableRange",(function(e){return t.onModifyCopyableRange(e)})),u5(m5(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),u5(m5(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),C5(this,P5,{}),u5(m5(n.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(t){var e=this,n=this.getHiddenRows(),r=this.isValidConfig(t),o=n,i=w5(this,T5).getValues().slice(),a=t.length>0;if(r&&a){var l=t.map((function(t){return e.hot.toPhysicalRow(t)}));U(l,(function(t){i[t]=!1})),o=V(i,(function(t,n,r){return n&&t.push(e.hot.toVisualRow(r)),t}),[])}var s=this.hot.runHooks("beforeUnhideRows",n,o,r&&a);!1!==s&&(r&&a&&w5(this,T5).setValues(i),this.hot.runHooks("afterUnhideRows",n,o,r&&a,r&&o.length<n.length))}},{key:"showRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showRows(e)}},{key:"hideRows",value:function(t){var e=this,n=this.getHiddenRows(),r=this.isValidConfig(t),o=n;r&&(o=Array.from(new Set(n.concat(t))));var i=this.hot.runHooks("beforeHideRows",n,o,r);!1!==i&&(r&&this.hot.batchExecution((function(){U(t,(function(t){w5(e,T5).setValueAtIndex(e.hot.toPhysicalRow(t),!0)}))}),!0),this.hot.runHooks("afterHideRows",n,o,r,r&&o.length>n.length))}},{key:"hideRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideRows(e)}},{key:"getHiddenRows",value:function(){var t=this;return W(w5(this,T5).getHiddenIndexes(),(function(e){return t.hot.toVisualRow(e)}))}},{key:"isHidden",value:function(t){return w5(this,T5).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}},{key:"isValidConfig",value:function(t){var e=this.hot.countRows();return!!(Array.isArray(t)&&t.length>0)&&t.every((function(t){return Number.isInteger(t)&&t>=0&&t<e}))}},{key:"resetCellsMeta",value:function(){U(this.hot.getCellsMeta(),(function(t){t&&(t.skipRowOnPaste=!1)}))}},{key:"onModifyRowHeight",value:function(t,e){return this.isHidden(e)?0:t}},{key:"onAfterGetCellMeta",value:function(t,e,n){if(!1===w5(this,P5).copyPasteEnabled&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){var r=n.className.split(" ");if(r.length>0){var o=r.indexOf("afterHiddenRow");o>-1&&r.splice(o,1),n.className=r.join(" ")}}}},{key:"onModifyCopyableRange",value:function(t){var e=this;if(w5(this,P5).copyPasteEnabled)return t;var n=[],r=function(t,e,r,o){n.push({startRow:t,endRow:e,startCol:r,endCol:o})};return U(t,(function(t){var n=!0,o=0;Ho(t.startRow,t.endRow,(function(i){e.isHidden(i)?(n||r(o,i-1,t.startCol,t.endCol),n=!0):(n&&(o=i),i===t.endRow&&r(o,i,t.startCol,t.endCol),n=!1)}))})),n}},{key:"onAfterGetRowHeader",value:function(t,e){if(w5(this,P5).indicators&&!(t<0)){var n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),Ge(e,n)}}},{key:"onAfterContextMenuDefaultOptions",value:function(t){t.items.push({name:$F},$6(this),n5(this))}},{key:"onMapInit",value:function(){Array.isArray(w5(this,P5).rows)&&this.hideRows(w5(this,P5).rows)}},{key:"destroy",value:function(){C5(this,P5,null),C5(this,T5,null),u5(m5(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return R5}},{key:"PLUGIN_PRIORITY",get:function(){return E5}}]),n}(RH);function M5(t,e){return H5(t)||_5(t,e)||I5(t,e)||A5()}function A5(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function I5(t,e){if(t){if("string"===typeof t)return x5(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x5(t,e):void 0}}function x5(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _5(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function H5(t){if(Array.isArray(t))return t}function N5(t){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase($w)},callback:function(e,n){var r=M5(n,1),o=r[0].start.col;t.freezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(e=!0),e}}}function D5(t,e){return W5(t)||F5(t,e)||B5(t,e)||L5()}function L5(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function B5(t,e){if(t){if("string"===typeof t)return V5(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V5(t,e):void 0}}function V5(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function F5(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function W5(t){if(Array.isArray(t))return t}function U5(t){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(qw)},callback:function(e,n){var r=D5(n,1),o=r[0].start.col;t.unfreezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var t=this.getSelectedRange(),e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(e=!0),e}}}function z5(t){return z5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z5(t)}function G5(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y5(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,X5(r.key),r)}}function K5(t,e,n){return e&&Y5(t.prototype,e),n&&Y5(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function X5(t){var e=$5(t,"string");return"symbol"===z5(e)?e:String(e)}function $5(t,e){if("object"!==z5(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==z5(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function q5(){return q5="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Q5(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},q5.apply(this,arguments)}function Q5(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=o4(t),null===t)break;return t}function J5(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Z5(t,e)}function Z5(t,e){return Z5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Z5(t,e)}function t4(t){var e=r4();return function(){var n,r=o4(t);if(e){var o=o4(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return e4(this,n)}}function e4(t,e){if(e&&("object"===z5(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return n4(t)}function n4(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function r4(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function o4(t){return o4=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},o4(t)}mr.getSingleton().register("beforeColumnFreeze"),mr.getSingleton().register("afterColumnFreeze"),mr.getSingleton().register("beforeColumnUnfreeze"),mr.getSingleton().register("afterColumnUnfreeze");var i4="manualColumnFreeze",a4=110,l4=new WeakMap,s4=function(t){J5(n,t);var e=t4(n);function n(t){var r;return G5(this,n),r=e.call(this,t),l4.set(n4(r),{afterFirstUse:!1}),r}return K5(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[i4]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(e){return t.addContextMenuEntry(e)})),this.addHook("beforeColumnMove",(function(e,n){return t.onBeforeColumnMove(e,n)})),q5(o4(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var t=l4.get(this);t.afterFirstUse=!1,q5(o4(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),q5(o4(n.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(t){var e=l4.get(this),n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&t>n.fixedColumnsStart-1;e.afterFirstUse||(e.afterFirstUse=!0);var o=this.hot.runHooks("beforeColumnFreeze",t,r);!1!==o&&(r&&(this.hot.columnIndexMapper.moveIndexes(t,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",t,r))}},{key:"unfreezeColumn",value:function(t){var e=l4.get(this),n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&t<=n.fixedColumnsStart-1;e.afterFirstUse||(e.afterFirstUse=!0);var o=this.hot.runHooks("beforeColumnUnfreeze",t,r);!1!==o&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(t,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",t,r))}},{key:"addContextMenuEntry",value:function(t){t.items.push({name:"---------"},N5(this),U5(this))}},{key:"onBeforeColumnMove",value:function(t,e){var n=l4.get(this);if(n.afterFirstUse){var r=this.hot.getSettings().fixedColumnsStart;if(e<r)return!1;if(t.some((function(t){return t<r})))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return i4}},{key:"PLUGIN_PRIORITY",get:function(){return a4}}]),n}(RH);function u4(t){return u4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u4(t)}function c4(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f4(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,d4(r.key),r)}}function h4(t,e,n){return e&&f4(t.prototype,e),n&&f4(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function d4(t){var e=p4(t,"string");return"symbol"===u4(e)?e:String(e)}function p4(t,e){if("object"!==u4(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==u4(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var y4=0,v4=1,m4=2,g4="px",b4=function(){function t(e){c4(this,t),this.hot=e,this._element=null,this.state=y4,this.inlineProperty=e.isRtl()?"right":"left"}return h4(t,[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=m4}},{key:"build",value:function(){this.state===y4&&(this._element=this.hot.rootDocument.createElement("div"),this.state=v4)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=y4}},{key:"isAppended",value:function(){return this.state===m4}},{key:"isBuilt",value:function(){return this.state>=v4}},{key:"setPosition",value:function(t,e){xo(t)&&(this._element.style.top=t+g4),xo(e)&&(this._element.style[this.inlineProperty]=e+g4)}},{key:"getPosition",value:function(){var t=this._element.style;return{top:t.top?parseInt(t.top,10):0,start:t[this.inlineProperty]?parseInt(t[this.inlineProperty],10):0}}},{key:"setSize",value:function(t,e){xo(t)&&(this._element.style.width=t+g4),xo(e)&&(this._element.style.height=e+g4)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,e){xo(t)&&(this._element.style.marginTop=t+g4),xo(e)&&(this._element.style["margin".concat(be(this.inlineProperty))]=e+g4)}},{key:"getOffset",value:function(){var t=this._element.style,e="margin".concat(be(this.inlineProperty));return{top:t.marginTop?parseInt(t.marginTop,10):0,start:t[e]?parseInt(t[e],10):0}}}]),t}(),w4=b4;function S4(t){return S4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S4(t)}function C4(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O4(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,R4(r.key),r)}}function k4(t,e,n){return e&&O4(t.prototype,e),n&&O4(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function R4(t){var e=E4(t,"string");return"symbol"===S4(e)?e:String(e)}function E4(t,e){if("object"!==S4(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==S4(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function P4(){return P4="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=T4(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},P4.apply(this,arguments)}function T4(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=H4(t),null===t)break;return t}function j4(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&M4(t,e)}function M4(t,e){return M4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},M4(t,e)}function A4(t){var e=_4();return function(){var n,r=H4(t);if(e){var o=H4(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return I4(this,n)}}function I4(t,e){if(e&&("object"===S4(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return x4(t)}function x4(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _4(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function H4(t){return H4=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},H4(t)}var N4="ht__manualColumnMove--backlight",D4=function(t){j4(n,t);var e=A4(n);function n(){return C4(this,n),e.apply(this,arguments)}return k4(n,[{key:"build",value:function(){P4(H4(n.prototype),"build",this).call(this),Ge(this._element,N4)}}]),n}(w4),L4=D4;function B4(t){return B4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B4(t)}function V4(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F4(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,U4(r.key),r)}}function W4(t,e,n){return e&&F4(t.prototype,e),n&&F4(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function U4(t){var e=z4(t,"string");return"symbol"===B4(e)?e:String(e)}function z4(t,e){if("object"!==B4(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==B4(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function G4(){return G4="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Y4(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},G4.apply(this,arguments)}function Y4(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Z4(t),null===t)break;return t}function K4(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&X4(t,e)}function X4(t,e){return X4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},X4(t,e)}function $4(t){var e=J4();return function(){var n,r=Z4(t);if(e){var o=Z4(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return q4(this,n)}}function q4(t,e){if(e&&("object"===B4(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Q4(t)}function Q4(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function J4(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Z4(t){return Z4=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Z4(t)}var t9="ht__manualColumnMove--guideline",e9=function(t){K4(n,t);var e=$4(n);function n(){return V4(this,n),e.apply(this,arguments)}return W4(n,[{key:"build",value:function(){G4(Z4(n.prototype),"build",this).call(this),Ge(this._element,t9)}}]),n}(w4),n9=e9;function r9(t){return r9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r9(t)}function o9(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i9(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,l9(r.key),r)}}function a9(t,e,n){return e&&i9(t.prototype,e),n&&i9(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function l9(t){var e=s9(t,"string");return"symbol"===r9(e)?e:String(e)}function s9(t,e){if("object"!==r9(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==r9(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function u9(){return u9="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=c9(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},u9.apply(this,arguments)}function c9(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=m9(t),null===t)break;return t}function f9(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h9(t,e)}function h9(t,e){return h9=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h9(t,e)}function d9(t){var e=v9();return function(){var n,r=m9(t);if(e){var o=m9(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p9(this,n)}}function p9(t,e){if(e&&("object"===r9(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return y9(t)}function y9(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v9(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function m9(t){return m9=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},m9(t)}mr.getSingleton().register("beforeColumnMove"),mr.getSingleton().register("afterColumnMove");var g9="manualColumnMove",b9=120,w9=new WeakMap,S9="ht__manualColumnMove",C9="show-ui",O9="on-moving--columns",k9="after-selection--columns",R9=function(t){f9(n,t);var e=d9(n);function n(t){var r;return o9(this,n),r=e.call(this,t),w9.set(y9(r),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),r.eventManager=new Gr(y9(r)),r.backlight=new L4(t),r.guideline=new n9(t),r}return a9(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[g9]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return t.onBeforeOnCellMouseOver.apply(t,arguments)})),this.addHook("afterScrollVertically",(function(){return t.onAfterScrollVertically()})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.buildPluginUI(),this.registerEvents(),Ge(this.hot.rootElement,S9),u9(m9(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),u9(m9(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ye(this.hot.rootElement,S9),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),u9(m9(n.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(t,e){return this.moveColumns([t],e)}},{key:"moveColumns",value:function(t,e){var n=w9.get(this),r=n.cachedDropIndex,o=this.isMovePossible(t,e),i=this.hot.runHooks("beforeColumnMove",t,e,r,o);if(n.cachedDropIndex=void 0,!1!==i){o&&this.hot.columnIndexMapper.moveIndexes(t,e);var a=o&&this.isColumnOrderChanged(t,e);return this.hot.runHooks("afterColumnMove",t,e,r,o,a),a}}},{key:"dragColumn",value:function(t,e){return this.dragColumns([t],e)}},{key:"dragColumns",value:function(t,e){var n=this.countFinalIndex(t,e),r=w9.get(this);return r.cachedDropIndex=e,this.moveColumns(t,n)}},{key:"isMovePossible",value:function(t,e){var n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=t.length+e>n,o=e<0,i=t.some((function(t){return t<0})),a=t.some((function(t){return t>=n}));return!(r||o||i||a)}},{key:"isColumnOrderChanged",value:function(t,e){return t.some((function(t,n){return t-n!==e}))}},{key:"countFinalIndex",value:function(t,e){var n=V(t,(function(t,n){return n<e&&(t+=1),t}),0);return e-n}},{key:"getColumnsWidth",value:function(t,e){for(var n=this.hot.columnIndexMapper,r=0,o=t;o<=e;o+=1){var i=n.getRenderableFromVisualIndex(o);o<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==i&&(r+=this.hot.view._wt.wtTable.getStretchedColumnWidth(i)||0)}return r}},{key:"moveBySettingsOrLoad",value:function(){var t=this.hot.getSettings()[g9];if(Array.isArray(t))this.moveColumns(t,0);else if(void 0!==t){var e=this.persistentStateLoad();e.length&&this.moveColumns(e,0)}}},{key:"isFixedColumnsStart",value:function(t){return t<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value?t.value:[]}},{key:"prepareColumnsToMoving",value:function(t,e){var n=[];return Ho(t,e,(function(t){n.push(t)})),n}},{key:"refreshPositions",value:function(){var t=w9.get(this),e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(t.hoveredColumn)&&e>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1));var n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,o="number"===typeof r.scrollX?r.scrollX:r.scrollLeft,i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,t.hoveredColumn-1),a=n.hider.offsetWidth,l=n.TBODY.offsetLeft,s=this.backlight.getOffset().start,u=this.backlight.getSize().width,c=0,f=0;if(this.hot.isRtl()){var h=this.hot.rootWindow,d=fn(this.hot.rootElement),p=h.innerWidth-t.rootElementOffset-d;f=h.innerWidth-t.target.eventPageX-p-(void 0===r.scrollX?o:0)}else f=t.target.eventPageX-(t.rootElementOffset-(void 0===r.scrollX?o:0));if(t.hasRowHeaders&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(t.hoveredColumn)&&(i+=o),i+=c,t.hoveredColumn<0)t.fixedColumnsStart>0?t.target.col=0:t.target.col=e>0?e-1:e;else if(t.target.TD.offsetWidth/2+i<=f){var y=t.hoveredColumn>=t.countCols?t.countCols-1:t.hoveredColumn;t.target.col=y+1,i+=t.target.TD.offsetWidth}else t.target.col=t.hoveredColumn;var v=f,m=i;f+u+s>=a?v=a-u-s:f+s<l+c&&(v=l+c+Math.abs(s)),i>=a-1?m=a-1:0===m?m=1:void 0!==r.scrollX&&t.hoveredColumn<t.fixedColumnsStart&&(m-=t.rootElementOffset<=r.scrollX?t.rootElementOffset:0),this.backlight.setPosition(null,v),this.guideline.setPosition(null,m)}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(e,"mousemove",(function(e){return t.onMouseMove(e)})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){var o=this.hot.view._wt.wtTable,i=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),l=w9.get(this),s=ze(t.target,"sortAction");if(!a||!i||l.pressed||0!==t.button||s)return l.pressed=!1,l.columnsToMove.length=0,void Ye(this.hot.rootElement,[O9,C9]);var u=this.guideline.isBuilt()&&!this.guideline.isAppended(),c=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&c&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider));var f=a.from,h=a.to,d=Math.min(f.col,h.col),p=Math.max(f.col,h.col);if(e.row<0&&e.col>=d&&e.col<=p){r.column=!0,l.pressed=!0,l.target.eventPageX=t.pageX,l.target.eventOffsetX=t.offsetX,l.hoveredColumn=e.col,l.target.TD=n,l.target.col=e.col,l.columnsToMove=this.prepareColumnsToMoving(d,p),l.hasRowHeaders=!!this.hot.getSettings().rowHeaders,l.countCols=this.hot.countCols(),l.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,l.rootElementOffset=tn(this.hot.rootElement).left;var y=l.hasRowHeaders?-1:0,v=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,m=e.col<l.fixedColumnsStart,g=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),b=Math.abs(t.offsetX-(this.hot.isRtl()?t.target.offsetWidth:0)),w=this.getColumnsWidth(d,e.col-1)+b,S=this.getColumnsWidth(y,d-1)+(m?g:0)+w;this.backlight.setPosition(v,S),this.backlight.setSize(this.getColumnsWidth(d,p),o.hider.offsetHeight-v),this.backlight.setOffset(null,-w),Ge(this.hot.rootElement,O9)}else Ye(this.hot.rootElement,k9),l.pressed=!1,l.columnsToMove.length=0}},{key:"onMouseMove",value:function(t){var e=w9.get(this);if(e.pressed){if(t.target===this.backlight.element){var n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout((function(){this.backlight.setPosition(n)}))}e.target.eventPageX=t.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){var o=this.hot.getSelectedRangeLast(),i=w9.get(this);o&&i.pressed&&(i.columnsToMove.indexOf(e.col)>-1?Ye(this.hot.rootElement,C9):Ge(this.hot.rootElement,C9),r.row=!0,r.column=!0,r.cell=!0,i.hoveredColumn=e.col,i.target.TD=n)}},{key:"onMouseUp",value:function(){var t=w9.get(this),e=t.target.col,n=t.columnsToMove.length;if(t.hoveredColumn=void 0,t.pressed=!1,t.backlightWidth=0,Ye(this.hot.rootElement,[O9,C9,k9]),this.hot.selection.isSelectedByColumnHeader()&&Ge(this.hot.rootElement,k9),!(n<1||void 0===e)){var r=t.columnsToMove[0],o=this.hot.toPhysicalColumn(r),i=this.dragColumns(t.columnsToMove,e);if(t.columnsToMove.length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var a=this.hot.toVisualColumn(o),l=a+n-1;this.hot.selectColumns(a,l)}}}},{key:"onAfterScrollVertically",value:function(){var t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;this.backlight.setPosition(r),this.backlight.setSize(null,t.hider.offsetHeight-r)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),u9(m9(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return g9}},{key:"PLUGIN_PRIORITY",get:function(){return b9}}]),n}(RH);function E9(t){return E9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E9(t)}function P9(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T9(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,M9(r.key),r)}}function j9(t,e,n){return e&&T9(t.prototype,e),n&&T9(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function M9(t){var e=A9(t,"string");return"symbol"===E9(e)?e:String(e)}function A9(t,e){if("object"!==E9(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==E9(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function I9(){return I9="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=x9(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},I9.apply(this,arguments)}function x9(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=V9(t),null===t)break;return t}function _9(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&H9(t,e)}function H9(t,e){return H9=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},H9(t,e)}function N9(t){var e=B9();return function(){var n,r=V9(t);if(e){var o=V9(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return D9(this,n)}}function D9(t,e){if(e&&("object"===E9(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return L9(t)}function L9(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function B9(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function V9(t){return V9=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},V9(t)}var F9="manualColumnResize",W9=130,U9="manualColumnWidths",z9=new WeakMap,G9=function(t){_9(n,t);var e=N9(n);function n(t){var r;P9(this,n),r=e.call(this,t);var o=r.hot.rootDocument;return r.currentTH=null,r.currentCol=null,r.selectedCols=[],r.currentWidth=null,r.newSize=null,r.startY=null,r.startWidth=null,r.startOffset=null,r.handle=o.createElement("DIV"),r.guide=o.createElement("DIV"),r.eventManager=new Gr(L9(r)),r.pressed=null,r.isTriggeredByRMB=!1,r.dblclick=0,r.autoresizeTimeout=null,r.columnWidthsMap=void 0,z9.set(L9(r),{config:void 0}),Ge(r.handle,"manualColumnResizer"),Ge(r.guide,"manualColumnResizerGuide"),r}return j9(n,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[F9]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.columnWidthsMap=new ng,this.columnWidthsMap.addLocalHook("init",(function(){return t.onMapInit()})),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(function(e,n){return t.onModifyColWidth(e,n)})),this.addHook("beforeStretchingColumnWidth",(function(e,n){return t.onBeforeStretchingColumnWidth(e,n)})),this.addHook("beforeColumnResize",(function(e,n,r){return t.onBeforeColumnResize(e,n,r)})),this.bindEvents(),I9(V9(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),I9(V9(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=z9.get(this);t.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),I9(V9(n.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",U9,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var t={};return this.hot.runHooks("persistentStateLoad",U9,t),t.value}},{key:"setManualSize",value:function(t,e){var n=Math.max(e,20),r=this.hot.toPhysicalColumn(t);return this.columnWidthsMap.setValueAtIndex(r,n),n}},{key:"clearManualSize",value:function(t){var e=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(e,null)}},{key:"onMapInit",value:function(){var t=this,e=z9.get(this),n=this.hot.getSettings()[F9],r=this.loadManualColumnWidths();"undefined"!==typeof r?this.hot.batchExecution((function(){r.forEach((function(e,n){t.columnWidthsMap.setValueAtIndex(n,e)}))}),!0):Array.isArray(n)?(this.hot.batchExecution((function(){n.forEach((function(e,n){t.columnWidthsMap.setValueAtIndex(n,e)}))}),!0),e.config=n):!0===n&&Array.isArray(e.config)&&this.hot.batchExecution((function(){e.config.forEach((function(e,n){t.columnWidthsMap.setValueAtIndex(n,e)}))}),!0)}},{key:"setupHandlePosition",value:function(t){var e=this;if(t.parentNode){this.currentTH=t;var n=this.hot.view._wt,r=n.wtTable.getCoords(this.currentTH),o=r.col;if(!(o<0)){var i,a=hn(this.currentTH),l=this.currentTH.getBoundingClientRect(),s=o<n.getSetting("fixedColumnsStart");s&&(i=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),i||(i=n.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),this.selectedCols=[];var u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){var c=this.hot.getSelectedRange();U(c,(function(t){var n=t.getTopStartCorner().col,r=t.getBottomEndCorner().col;Ho(n,r,(function(t){e.selectedCols.includes(t)||e.selectedCols.push(t)}))}))}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=i.start-6,this.startWidth=parseInt(l.width,10),this.handle.style.top="".concat(i.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(a,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var t=parseInt(hn(this.handle),10),e=parseInt(this.handle.style.top,10)+t,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Ge(this.handle,"active"),Ge(this.guide,"active"),this.guide.style.top="".concat(e,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(n-t,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Ye(this.handle,"active"),Ye(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(t){return!!Ne(t,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}},{key:"onMouseOver",value:function(t){if(!In(t.target)&&!0!==this.isTriggeredByRMB&&this.checkIfColumnHeader(t.target)){var e=this.getClosestTHParent(t.target);if(!e)return;var n=e.getAttribute("colspan");!e||null!==n&&"1"!==n||this.pressed||this.setupHandlePosition(e)}}},{key:"afterMouseDownTimeout",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.adjustElementsSize(!0)},n=function(n,r){var o=t.hot.runHooks("beforeColumnResize",t.newSize,n,!0);void 0!==o&&(t.newSize=o),"all"===t.hot.getSettings().stretchH?t.clearManualSize(n):t.setManualSize(n,t.newSize),t.saveManualColumnWidths(),t.hot.runHooks("afterColumnResize",t.newSize,n,!0),r&&e()};if(this.dblclick>=2){var r=this.selectedCols.length;r>1?(U(this.selectedCols,(function(t){n(t)})),e()):U(this.selectedCols,(function(t){n(t,!0)}))}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(t){var e=this;ze(t.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return e.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=t.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(t){var e=this;if(this.pressed){var n=(t.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+n,U(this.selectedCols,(function(t){e.newSize=e.setManualSize(t,e.currentWidth)})),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.adjustElementsSize(!0)},n=function(n,r){t.hot.runHooks("beforeColumnResize",t.newSize,n,!1),r&&e(),t.saveManualColumnWidths(),t.hot.runHooks("afterColumnResize",t.newSize,n,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var r=this.selectedCols.length;r>1?(U(this.selectedCols,(function(t){n(t)})),e()):U(this.selectedCols,(function(t){n(t,!0)}))}this.setupHandlePosition(this.currentTH)}}},{key:"onContextMenu",value:function(){var t=this;this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate((function(){t.isTriggeredByRMB=!1}))}},{key:"bindEvents",value:function(){var t=this,e=this.hot,n=e.rootWindow,r=e.rootElement;this.eventManager.addEventListener(r,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(r,"mousedown",(function(e){return t.onMouseDown(e)})),this.eventManager.addEventListener(n,"mousemove",(function(e){return t.onMouseMove(e)})),this.eventManager.addEventListener(n,"mouseup",(function(){return t.onMouseUp()})),this.eventManager.addEventListener(this.handle,"contextmenu",(function(){return t.onContextMenu()}))}},{key:"onModifyColWidth",value:function(t,e){var n=t;if(this.enabled){var r=this.hot.toPhysicalColumn(e),o=this.columnWidthsMap.getValueAtIndex(r);this.hot.getSettings()[F9]&&o&&(n=o)}return n}},{key:"onBeforeStretchingColumnWidth",value:function(t,e){var n=this.columnWidthsMap.getValueAtIndex(e);return null===n&&(n=t),n}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){I9(V9(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return F9}},{key:"PLUGIN_PRIORITY",get:function(){return W9}}]),n}(RH);function Y9(t){return Y9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y9(t)}function K9(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function X9(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,q9(r.key),r)}}function $9(t,e,n){return e&&X9(t.prototype,e),n&&X9(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function q9(t){var e=Q9(t,"string");return"symbol"===Y9(e)?e:String(e)}function Q9(t,e){if("object"!==Y9(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Y9(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var J9=0,Z9=1,t7=2,e7="px",n7=function(){function t(e){K9(this,t),this.hot=e,this._element=null,this.state=J9}return $9(t,[{key:"appendTo",value:function(t){t.appendChild(this._element),this.state=t7}},{key:"build",value:function(){this.state===J9&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Z9)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=J9}},{key:"isAppended",value:function(){return this.state===t7}},{key:"isBuilt",value:function(){return this.state>=Z9}},{key:"setPosition",value:function(t,e){void 0!==t&&(this._element.style.top=t+e7),void 0!==e&&(this._element.style.left=e+e7)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(t,e){t&&(this._element.style.width=t+e7),e&&(this._element.style.height=e+e7)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(t,e){t&&(this._element.style.marginTop=t+e7),e&&(this._element.style.marginLeft=e+e7)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),t}(),r7=n7;function o7(t){return o7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o7(t)}function i7(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,s7(r.key),r)}}function l7(t,e,n){return e&&a7(t.prototype,e),n&&a7(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function s7(t){var e=u7(t,"string");return"symbol"===o7(e)?e:String(e)}function u7(t,e){if("object"!==o7(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==o7(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function c7(){return c7="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=f7(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},c7.apply(this,arguments)}function f7(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=g7(t),null===t)break;return t}function h7(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d7(t,e)}function d7(t,e){return d7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d7(t,e)}function p7(t){var e=m7();return function(){var n,r=g7(t);if(e){var o=g7(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y7(this,n)}}function y7(t,e){if(e&&("object"===o7(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return v7(t)}function v7(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m7(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function g7(t){return g7=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},g7(t)}var b7="ht__manualRowMove--backlight",w7=function(t){h7(n,t);var e=p7(n);function n(){return i7(this,n),e.apply(this,arguments)}return l7(n,[{key:"build",value:function(){c7(g7(n.prototype),"build",this).call(this),Ge(this._element,b7)}}]),n}(r7),S7=w7;function C7(t){return C7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C7(t)}function O7(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,E7(r.key),r)}}function R7(t,e,n){return e&&k7(t.prototype,e),n&&k7(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function E7(t){var e=P7(t,"string");return"symbol"===C7(e)?e:String(e)}function P7(t,e){if("object"!==C7(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==C7(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function T7(){return T7="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=j7(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},T7.apply(this,arguments)}function j7(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=N7(t),null===t)break;return t}function M7(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&A7(t,e)}function A7(t,e){return A7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},A7(t,e)}function I7(t){var e=H7();return function(){var n,r=N7(t);if(e){var o=N7(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return x7(this,n)}}function x7(t,e){if(e&&("object"===C7(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _7(t)}function _7(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function H7(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function N7(t){return N7=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},N7(t)}var D7="ht__manualRowMove--guideline",L7=function(t){M7(n,t);var e=I7(n);function n(){return O7(this,n),e.apply(this,arguments)}return R7(n,[{key:"build",value:function(){T7(N7(n.prototype),"build",this).call(this),Ge(this._element,D7)}}]),n}(r7),B7=L7;function V7(t){return V7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V7(t)}function F7(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function W7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,z7(r.key),r)}}function U7(t,e,n){return e&&W7(t.prototype,e),n&&W7(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function z7(t){var e=G7(t,"string");return"symbol"===V7(e)?e:String(e)}function G7(t,e){if("object"!==V7(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==V7(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Y7(){return Y7="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=K7(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Y7.apply(this,arguments)}function K7(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=ttt(t),null===t)break;return t}function X7(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$7(t,e)}function $7(t,e){return $7=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},$7(t,e)}function q7(t){var e=Z7();return function(){var n,r=ttt(t);if(e){var o=ttt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Q7(this,n)}}function Q7(t,e){if(e&&("object"===V7(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return J7(t)}function J7(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Z7(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function ttt(t){return ttt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ttt(t)}mr.getSingleton().register("beforeRowMove"),mr.getSingleton().register("afterRowMove");var ett="manualRowMove",ntt=140,rtt=new WeakMap,ott="ht__manualRowMove",itt="show-ui",att="on-moving--rows",ltt="after-selection--rows",stt=function(t){X7(n,t);var e=q7(n);function n(t){var r;return F7(this,n),r=e.call(this,t),rtt.set(J7(r),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),r.eventManager=new Gr(J7(r)),r.backlight=new S7(t),r.guideline=new B7(t),r}return U7(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[ett]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return t.onBeforeOnCellMouseOver.apply(t,arguments)})),this.addHook("afterScrollHorizontally",(function(){return t.onAfterScrollHorizontally()})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.buildPluginUI(),this.registerEvents(),Ge(this.hot.rootElement,ott),Y7(ttt(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),Y7(ttt(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ye(this.hot.rootElement,ott),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),Y7(ttt(n.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(t,e){return this.moveRows([t],e)}},{key:"moveRows",value:function(t,e){var n=rtt.get(this),r=n.cachedDropIndex,o=this.isMovePossible(t,e),i=this.hot.runHooks("beforeRowMove",t,e,r,o);if(n.cachedDropIndex=void 0,!1!==i){o&&this.hot.rowIndexMapper.moveIndexes(t,e);var a=o&&this.isRowOrderChanged(t,e);return this.hot.runHooks("afterRowMove",t,e,r,o,a),a}}},{key:"dragRow",value:function(t,e){return this.dragRows([t],e)}},{key:"dragRows",value:function(t,e){var n=this.countFinalIndex(t,e),r=rtt.get(this);return r.cachedDropIndex=e,this.moveRows(t,n)}},{key:"isMovePossible",value:function(t,e){var n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=t.length+e>n,o=e<0,i=t.some((function(t){return t<0})),a=t.some((function(t){return t>=n}));return!(r||o||i||a)}},{key:"isRowOrderChanged",value:function(t,e){return t.some((function(t,n){return t-n!==e}))}},{key:"countFinalIndex",value:function(t,e){var n=V(t,(function(t,n){return n<e&&(t+=1),t}),0);return e-n}},{key:"getRowsHeight",value:function(t,e){for(var n=this.hot.rowIndexMapper,r=0,o=t;o<=e;o++){var i=n.getRenderableFromVisualIndex(o);null!==i&&(r+=this.hot.view._wt.wtTable.getRowHeight(i)||23)}return r}},{key:"moveBySettingsOrLoad",value:function(){var t=this.hot.getSettings()[ett];if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){var e=this.persistentStateLoad();e.length&&this.moveRows(e,0)}}},{key:"isFixedRowTop",value:function(t){return t<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(t){return t>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}},{key:"prepareRowsToMoving",value:function(){var t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;var n=t.from,r=t.to,o=Math.min(n.row,r.row),i=Math.max(n.row,r.row);return Ho(o,i,(function(t){e.push(t)})),e}},{key:"refreshPositions",value:function(){var t=rtt.get(this),e=t.target.coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),o=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<o&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);var i,a=this.hot.view._wt.wtTable,l=t.target.TD,s=this.hot.rootElement,u=tn(s),c=ln(s),f=a.holder.scrollTop;i=this.hot.rootWindow===c?c.scrollY:c.scrollTop;var h=u.top-i,d=t.target.eventPageY-h+f,p=a.hider.offsetHeight,y=a.TBODY.offsetTop,v=this.backlight.getOffset().top,m=this.backlight.getSize().height,g=l.offsetHeight/2,b=l.offsetHeight,w=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1),S=d>=w+g;this.isFixedRowTop(e.row)&&(w+=a.holder.scrollTop),e.row<0?t.target.row=n>0?n-1:n:S?(t.target.row=e.row+1,w+=0===e.row?b-1:b):t.target.row=e.row;var C=d,O=w;d+m+v>=p?C=p-m-v:d+v<y&&(C=y+Math.abs(v)),w>=p-1&&(O=p-1),this.backlight.setPosition(C),this.guideline.setPosition(O)}},{key:"registerEvents",value:function(){var t=this,e=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(e,"mousemove",(function(e){return t.onMouseMove(e)})),this.eventManager.addEventListener(e,"mouseup",(function(){return t.onMouseUp()}))}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){var o=this.hot.view._wt,i=o.wtTable,a=o.wtViewport,l=this.hot.selection.isSelectedByRowHeader(),s=this.hot.getSelectedRangeLast(),u=rtt.get(this);if(!s||!l||u.pressed||0!==t.button)return u.pressed=!1,u.rowsToMove.length=0,void Ye(this.hot.rootElement,[att,itt]);var c=this.guideline.isBuilt()&&!this.guideline.isAppended(),f=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&f&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));var h=s.from,d=s.to,p=Math.min(h.row,d.row),y=Math.max(h.row,d.row);if(e.col<0&&e.row>=p&&e.row<=y){r.row=!0,u.pressed=!0,u.target.eventPageY=t.pageY,u.target.coords=e,u.target.TD=n,u.rowsToMove=this.prepareRowsToMoving();var v=i.holder.scrollLeft+a.getRowHeaderWidth();this.backlight.setPosition(null,v),this.backlight.setSize(i.hider.offsetWidth-v,this.getRowsHeight(p,y)),this.backlight.setOffset(-1*(this.getRowsHeight(p,e.row-1)+t.offsetY),null),Ge(this.hot.rootElement,att),this.refreshPositions()}else Ye(this.hot.rootElement,ltt),u.pressed=!1,u.rowsToMove.length=0}},{key:"onMouseMove",value:function(t){var e=rtt.get(this);if(e.pressed){if(t.target===this.backlight.element){var n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout((function(){this.backlight.setPosition(null,n)}))}e.target.eventPageY=t.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){var o=this.hot.getSelectedRangeLast(),i=rtt.get(this);o&&i.pressed&&(i.rowsToMove.indexOf(e.row)>-1?Ye(this.hot.rootElement,itt):Ge(this.hot.rootElement,itt),r.row=!0,r.column=!0,r.cell=!0,i.target.coords=e,i.target.TD=n)}},{key:"onMouseUp",value:function(){var t=rtt.get(this),e=t.target.row,n=t.rowsToMove.length;if(t.pressed=!1,t.backlightHeight=0,Ye(this.hot.rootElement,[att,itt,ltt]),this.hot.selection.isSelectedByRowHeader()&&Ge(this.hot.rootElement,ltt),!(n<1||void 0===e)){var r=t.rowsToMove[0],o=this.hot.toPhysicalRow(r),i=this.dragRows(t.rowsToMove,e);if(t.rowsToMove.length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var a=this.hot.toVisualRow(o),l=a+n-1;this.hot.selectRows(a,l)}}}},{key:"onAfterScrollHorizontally",value:function(){var t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;this.backlight.setPosition(null,r),this.backlight.setSize(t.hider.offsetWidth-r)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),Y7(ttt(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ett}},{key:"PLUGIN_PRIORITY",get:function(){return ntt}}]),n}(RH);function utt(t){return utt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},utt(t)}function ctt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ftt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dtt(r.key),r)}}function htt(t,e,n){return e&&ftt(t.prototype,e),n&&ftt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function dtt(t){var e=ptt(t,"string");return"symbol"===utt(e)?e:String(e)}function ptt(t,e){if("object"!==utt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==utt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function ytt(){return ytt="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=vtt(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},ytt.apply(this,arguments)}function vtt(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Ott(t),null===t)break;return t}function mtt(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gtt(t,e)}function gtt(t,e){return gtt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},gtt(t,e)}function btt(t){var e=Ctt();return function(){var n,r=Ott(t);if(e){var o=Ott(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wtt(this,n)}}function wtt(t,e){if(e&&("object"===utt(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Stt(t)}function Stt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ctt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Ott(t){return Ott=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ott(t)}var ktt,Rtt,Ett,Ptt,Ttt="manualRowResize",jtt=30,Mtt="manualRowHeights",Att=new WeakMap,Itt=function(t){mtt(n,t);var e=btt(n);function n(t){var r;ctt(this,n),r=e.call(this,t);var o=r.hot.rootDocument;return r.currentTH=null,r.currentRow=null,r.selectedRows=[],r.currentHeight=null,r.newSize=null,r.startY=null,r.startHeight=null,r.startOffset=null,r.handle=o.createElement("DIV"),r.guide=o.createElement("DIV"),r.eventManager=new Gr(Stt(r)),r.pressed=null,r.isTriggeredByRMB=!1,r.dblclick=0,r.autoresizeTimeout=null,r.rowHeightsMap=void 0,Att.set(Stt(r),{config:void 0}),Ge(r.handle,"manualRowResizer"),Ge(r.guide,"manualRowResizerGuide"),r}return htt(n,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Ttt]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.rowHeightsMap=new ng,this.rowHeightsMap.addLocalHook("init",(function(){return t.onMapInit()})),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(function(e,n){return t.onModifyRowHeight(e,n)})),this.bindEvents(),ytt(Ott(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ytt(Ott(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var t=Att.get(this);t.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),ytt(Ott(n.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",Mtt,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var t={};return this.hot.runHooks("persistentStateLoad",Mtt,t),t.value}},{key:"setManualSize",value:function(t,e){var n=this.hot.toPhysicalRow(t),r=Math.max(e,sy.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(n,r),r}},{key:"setupHandlePosition",value:function(t){var e=this;this.currentTH=t;var n=this.hot.view,r=n._wt,o=r.wtTable.getCoords(this.currentTH),i=o.row;if(!(i<0)){var a,l=fn(this.currentTH),s=this.currentTH.getBoundingClientRect(),u=i<r.getSetting("fixedRowsTop"),c=i>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");u?a=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col):c&&(a=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),a||(a=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.selectedRows=[];var f=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&f){var h=this.hot.getSelectedRange();U(h,(function(t){var n=t.getTopStartCorner().row,r=t.getBottomStartCorner().row;Ho(n,r,(function(t){e.selectedRows.includes(t)||e.selectedRows.push(t)}))}))}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=a.top-6,this.startHeight=parseInt(s.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(a.start,"px"),this.handle.style.width="".concat(l,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var t=parseInt(fn(this.handle),10),e=parseInt(this.handle.style[this.inlineDir],10)+t,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Ge(this.handle,"active"),Ge(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(e,"px"),this.guide.style.width="".concat(n-t,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Ye(this.handle,"active"),Ye(this.guide,"active")}},{key:"checkIfRowHeader",value:function(t){var e,n,r=Ne(t,["TH"],this.hot.rootElement);return r&&"TBODY"===(null===(e=t.parentNode)||void 0===e||null===(n=e.parentNode)||void 0===n?void 0:n.tagName)}},{key:"getClosestTHParent",value:function(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}},{key:"getActualRowHeight",value:function(t){var e=this.hot.view._wt.wtTable.getRowHeight(t);return void 0!==e&&this.newSize<e?e:this.newSize}},{key:"onMouseOver",value:function(t){if(!In(t.target)&&!0!==this.isTriggeredByRMB&&this.checkIfRowHeader(t.target)){var e=this.getClosestTHParent(t.target);e&&(this.pressed||this.setupHandlePosition(e))}}},{key:"afterMouseDownTimeout",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.adjustElementsSize(!0)},n=function(n,r){var o=t.hot.runHooks("beforeRowResize",t.getActualRowHeight(n),n,!0);void 0!==o&&(t.newSize=o),t.setManualSize(n,t.newSize),t.hot.runHooks("afterRowResize",t.getActualRowHeight(n),n,!0),r&&e()};if(this.dblclick>=2){var r=this.selectedRows.length;r>1?(U(this.selectedRows,(function(t){n(t)})),e()):U(this.selectedRows,(function(t){n(t,!0)}))}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(t){var e=this;ze(t.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout((function(){return e.afterMouseDownTimeout()}),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=t.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(t){var e=this;this.pressed&&(this.currentHeight=this.startHeight+(t.pageY-this.startY),U(this.selectedRows,(function(t){e.newSize=e.setManualSize(t,e.currentHeight)})),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var t=this,e=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.adjustElementsSize(!0)},n=function(n,r){t.hot.runHooks("beforeRowResize",t.getActualRowHeight(n),n,!1),r&&e(),t.saveManualRowHeights(),t.hot.runHooks("afterRowResize",t.getActualRowHeight(n),n,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var r=this.selectedRows.length;r>1?(U(this.selectedRows,(function(t){n(t)})),e()):U(this.selectedRows,(function(t){n(t,!0)}))}this.setupHandlePosition(this.currentTH)}}},{key:"onContextMenu",value:function(){var t=this;this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate((function(){t.isTriggeredByRMB=!1}))}},{key:"bindEvents",value:function(){var t=this,e=this.hot,n=e.rootElement,r=e.rootWindow;this.eventManager.addEventListener(n,"mouseover",(function(e){return t.onMouseOver(e)})),this.eventManager.addEventListener(n,"mousedown",(function(e){return t.onMouseDown(e)})),this.eventManager.addEventListener(r,"mousemove",(function(e){return t.onMouseMove(e)})),this.eventManager.addEventListener(r,"mouseup",(function(){return t.onMouseUp()})),this.eventManager.addEventListener(this.handle,"contextmenu",(function(){return t.onContextMenu()}))}},{key:"onModifyRowHeight",value:function(t,e){var n=t;if(this.enabled){var r=this.hot.toPhysicalRow(e),o=this.rowHeightsMap.getValueAtIndex(r);this.hot.getSettings()[Ttt]&&o&&(n=o)}return n}},{key:"onMapInit",value:function(){var t=this,e=Att.get(this),n=this.hot.getSettings()[Ttt],r=this.loadManualRowHeights();this.hot.batchExecution((function(){"undefined"!==typeof r?r.forEach((function(e,n){t.rowHeightsMap.setValueAtIndex(n,e)})):Array.isArray(n)?(n.forEach((function(e,n){t.rowHeightsMap.setValueAtIndex(n,e)})),e.config=n):!0===n&&Array.isArray(e.config)&&e.config.forEach((function(e,n){t.rowHeightsMap.setValueAtIndex(n,e)}))}),!0)}},{key:"destroy",value:function(){ytt(Ott(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Ttt}},{key:"PLUGIN_PRIORITY",get:function(){return jtt}}]),n}(RH);function xtt(t){return xtt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xtt(t)}function _tt(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Htt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ntt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ltt(r.key),r)}}function Dtt(t,e,n){return e&&Ntt(t.prototype,e),n&&Ntt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ltt(t){var e=Btt(t,"string");return"symbol"===xtt(e)?e:String(e)}function Btt(t,e){if("object"!==xtt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==xtt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Vtt,Ftt=function(){function t(e,n,r,o,i,a){Htt(this,t),this.row=e,this.col=n,this.rowspan=r,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return Dtt(t,[{key:"normalize",value:function(t){var e=t.countRows(),n=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}},{key:"includes",value:function(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}},{key:"includesHorizontally",value:function(t){return this.col<=t&&this.col+this.colspan-1>=t}},{key:"includesVertically",value:function(t){return this.row<=t&&this.row+this.rowspan-1>=t}},{key:"shift",value:function(t,e){var n=t[0]||t[1],r=e+Math.abs(t[0]||t[1])-1,o=t[0]?"colspan":"rowspan",i=t[0]?"col":"row",a=Math.min(e,r),l=Math.max(e,r),s=this[i],u=this[i]+this[o]-1;if(s>=e&&(this[i]+=n),n>0)e<=u&&e>s&&(this[o]+=n);else if(n<0){if(a<=s&&l>=u)return this.removed=!0,!1;if(s>=a&&s<=l){var c=l-s+1,f=Math.abs(n)-c;this[i]-=f+n,this[o]-=c}else if(s<=a&&u>=l)this[o]+=n;else if(s<=a&&u>=a&&u<l){var h=u-a+1;this[o]-=h}}return!0}},{key:"isFarther",value:function(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(t){return $t(ktt||(ktt=_tt(["The merged cell declared with {row: ",", col: ",", \n      rowspan: ",", colspan: ","} contains negative values, which is \n      not supported. It will not be added to the collection."],["The merged cell declared with {row: ",", col: ",",\\x20\n      rowspan: ",", colspan: ","} contains negative values, which is\\x20\n      not supported. It will not be added to the collection."])),t.row,t.col,t.rowspan,t.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(t){return $t(Rtt||(Rtt=_tt(["The merged cell declared at [",", ","] is positioned \n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] is positioned\\x20\n      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup."])),t.row,t.col)}},{key:"IS_SINGLE_CELL",value:function(t){return $t(Ett||(Ett=_tt(["The merged cell declared at [",", ",'] has both "rowspan" \n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has both "rowspan"\\x20\n      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'])),t.row,t.col)}},{key:"ZERO_SPAN_WARNING",value:function(t){return $t(Ptt||(Ptt=_tt(["The merged cell declared at [",", ",'] has "rowspan" \n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has "rowspan"\\x20\n      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.'])),t.row,t.col)}},{key:"containsNegativeValues",value:function(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}},{key:"isSingleCell",value:function(t){return 1===t.colspan&&1===t.rowspan}},{key:"containsZeroSpan",value:function(t){return 0===t.colspan||0===t.rowspan}},{key:"isOutOfBounds",value:function(t,e,n){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=n||t.col+t.colspan-1>=n}}]),t}(),Wtt=Ftt;function Utt(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function ztt(t){return ztt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ztt(t)}function Gtt(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Ytt(t){return qtt(t)||$tt(t)||Xtt(t)||Ktt()}function Ktt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Xtt(t,e){if(t){if("string"===typeof t)return Qtt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qtt(t,e):void 0}}function $tt(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function qtt(t){if(Array.isArray(t))return Qtt(t)}function Qtt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Jtt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ztt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,eet(r.key),r)}}function tet(t,e,n){return e&&Ztt(t.prototype,e),n&&Ztt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function eet(t){var e=net(t,"string");return"symbol"===ztt(e)?e:String(e)}function net(t,e){if("object"!==ztt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ztt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ret=function(){function t(e){Jtt(this,t),this.plugin=e,this.mergedCells=[],this.hot=e.hot}return tet(t,[{key:"get",value:function(t,e){var n=this.mergedCells,r=!1;return U(n,(function(n){return!(n.row<=t&&n.row+n.rowspan-1>=t&&n.col<=e&&n.col+n.colspan-1>=e)||(r=n,!1)})),r}},{key:"getByRange",value:function(t){var e=this.mergedCells,n=!1;return U(e,(function(e){return!(e.row<=t.from.row&&e.row+e.rowspan-1>=t.to.row&&e.col<=t.from.col&&e.col+e.colspan-1>=t.to.col)||(n=e,n)})),n}},{key:"getWithinRange",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCells,o=[],i=t;if(!i.includesRange){var a=this.hot._createCellCoords(i.from.row,i.from.col),l=this.hot._createCellCoords(i.to.row,i.to.col);i=this.hot._createCellRange(a,a,l)}return U(r,(function(t){var r=e.hot._createCellCoords(t.row,t.col),a=e.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),l=e.hot._createCellRange(r,r,a);n?i.overlaps(l)&&o.push(t):i.includesRange(l)&&o.push(t)})),!!o.length&&o}},{key:"add",value:function(e){var n=this.mergedCells,r=e.row,o=e.col,i=e.rowspan,a=e.colspan,l=new Wtt(r,o,i,a,this.hot._createCellCoords,this.hot._createCellRange),s=this.get(r,o),u=this.isOverlapping(l);return s||u?(er(t.IS_OVERLAPPING_WARNING(l)),!1):(this.hot&&l.normalize(this.hot),n.push(l),l)}},{key:"remove",value:function(t,e){var n=this.mergedCells,r=this.get(t,e),o=r?this.mergedCells.indexOf(r):-1;return!(!r||-1===o)&&(n.splice(o,1),r)}},{key:"clear",value:function(){var t=this,e=this.mergedCells,n=[],r=[];U(e,(function(e){var r=t.hot.getCell(e.row,e.col);r&&n.push([r,t.get(e.row,e.col),e.row,e.col])})),this.mergedCells.length=0,U(n,(function(e,o){Ho(0,e.rowspan-1,(function(n){Ho(0,e.colspan-1,(function(o){if(0!==o||0!==n){var i=t.hot.getCell(e.row+n,e.col+o);i&&r.push([i,null,null,null])}}))})),n[o][1]=null})),U(n,(function(t){Utt.apply(void 0,Ytt(t))})),U(r,(function(t){Utt.apply(void 0,Ytt(t))}))}},{key:"isOverlapping",value:function(t){var e=this,n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1)),r=!1;return U(this.mergedCells,(function(t){var o=e.hot._createCellRange(e.hot._createCellCoords(0,0),e.hot._createCellCoords(t.row,t.col),e.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1));return!o.overlaps(n)||(r=!0,!1)})),r}},{key:"isFirstRenderableMergedCell",value:function(t,e){var n=this.get(t,e);return n&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)===e}},{key:"getFirstRenderableCoords",value:function(t,e){var n=this.get(t,e);if(!n||this.isFirstRenderableMergedCell(t,e))return this.hot._createCellCoords(t,e);var r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(r,o)}},{key:"shiftCollections",value:function(t,e,n){var r=this,o=[0,0];switch(t){case"right":o[0]+=n;break;case"left":o[0]-=n;break;case"down":o[1]+=n;break;case"up":o[1]-=n;break;default:}U(this.mergedCells,(function(t){t.shift(o,e)})),No(this.mergedCells.length-1,0,(function(t){var e=r.mergedCells[t];e&&e.removed&&r.mergedCells.splice(r.mergedCells.indexOf(e),1)}))}}],[{key:"IS_OVERLAPPING_WARNING",value:function(t){return $t(Vtt||(Vtt=Gtt(["The merged cell declared at [",", ","], overlaps \n      with the other declared merged cell. The overlapping merged cell was not added to the table, please \n      fix your setup."],["The merged cell declared at [",", ","], overlaps\\x20\n      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20\n      fix your setup."])),t.row,t.col)}}]),t}(),oet=ret;function iet(t){return iet="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iet(t)}function aet(t,e){return het(t)||fet(t,e)||uet(t,e)||set()}function set(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function uet(t,e){if(t){if("string"===typeof t)return cet(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cet(t,e):void 0}}function cet(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function fet(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function het(t){if(Array.isArray(t))return t}function det(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pet(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vet(r.key),r)}}function yet(t,e,n){return e&&pet(t.prototype,e),n&&pet(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function vet(t){var e=met(t,"string");return"symbol"===iet(e)?e:String(e)}function met(t,e){if("object"!==iet(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==iet(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var get=function(){function t(e){det(this,t),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return yet(t,[{key:"correctSelectionAreaSize",value:function(t){if(t[0]===t[2]&&t[1]===t[3]){var e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}},{key:"getDirection",value:function(t,e){var n=null;return n=e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left",n}},{key:"snapDragArea",value:function(t,e,n,r){var o=e.slice(0),i=this.getAutofillSize(t,e,n),a=aet(t,4),l=a[0],s=a[1],u=a[2],c=a[3],f=["up","down"].indexOf(n)>-1,h=f?u-l+1:c-s+1,d=Math.floor(i/h)*h,p=i-d,y=this.getFarthestCollection(t,e,n,r);if(y)if("down"===n){var v=y.row+y.rowspan-l-p,m=o[2]+v;m>=this.plugin.hot.countRows()?o[2]-=p:o[2]+=p?v:0}else if("right"===n){var g=y.col+y.colspan-s-p,b=o[3]+g;b>=this.plugin.hot.countCols()?o[3]-=p:o[3]+=p?g:0}else if("up"===n){var w=u-p-y.row+1,S=o[0]+w;S<0?o[0]+=p:o[0]-=p?w:0}else if("left"===n){var C=c-p-y.col+1,O=o[1]+C;O<0?o[1]+=p:o[1]-=p?C:0}return this.updateCurrentFillCache({baseArea:t,dragDirection:n,foundMergedCells:r,fillSize:i,dragArea:o,cycleLength:h}),o}},{key:"updateCurrentFillCache",value:function(t){this.currentFillData||(this.currentFillData={}),at(this.currentFillData,t)}},{key:"getAutofillSize",value:function(t,e,n){var r=aet(t,4),o=r[0],i=r[1],a=r[2],l=r[3],s=aet(e,4),u=s[0],c=s[1],f=s[2],h=s[3];switch(n){case"up":return o-u;case"down":return f-a;case"left":return i-c;case"right":return h-l;default:return null}}},{key:"getDragArea",value:function(t,e,n){var r=aet(t,4),o=r[0],i=r[1],a=r[2],l=r[3],s=aet(e,4),u=s[0],c=s[1],f=s[2],h=s[3];switch(n){case"up":return[u,c,o-1,l];case"down":return[a+1,i,f,l];case"left":return[u,c,a,i-1];case"right":return[o,l+1,f,h];default:return null}}},{key:"getFarthestCollection",value:function(t,e,n,r){var o=aet(t,4),i=o[0],a=o[1],l=o[2],s=o[3],u=["up","down"].indexOf(n)>-1,c=u?l:s,f=u?i:a,h=this.getAutofillSize(t,e,n),d=u?l-i+1:s-a+1,p=Math.floor(h/d)*d,y=h-p,v=null,m=null,g=null;switch(n){case"up":v="includesVertically",g=c-y+1;break;case"left":v="includesHorizontally",g=c-y+1;break;case"down":v="includesVertically",g=f+y-1;break;case"right":v="includesHorizontally",g=f+y-1;break;default:}return U(r,(function(t){t[v](g)&&t.isFarther(m,n)&&(m=t)})),m}},{key:"recreateAfterDataPopulation",value:function(t){if(this.currentFillData){var e=this.getRangeFromChanges(t),n=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=function(t,n){switch(r){case"up":return t.row-n>=e.from.row;case"down":return t.row+t.rowspan-1+n<=e.to.row;case"left":return t.col-n>=e.from.column;case"right":return t.col+t.colspan-1+n<=e.to.column;default:return null}},i=0,a=null,l=1;do{for(var s=0;s<n.length;s+=1){if(a=n[s],i=l*this.currentFillData.cycleLength,o(a,i))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-i,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+i,colspan:a.colspan});break;default:}s===n.length-1&&(l+=1)}}while(o(a,i));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(t){var e=this,n={min:null,max:null},r={min:null,max:null};return U(t,(function(t){var o=t[0],i=e.plugin.hot.propToCol(t[1]);(null===n.min||o<n.min)&&(n.min=o),(null===n.max||o>n.max)&&(n.max=o),(null===r.min||i<r.min)&&(r.min=i),(null===r.max||i>r.max)&&(r.max=i)})),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}},{key:"dragAreaOverlapsCollections",value:function(t,e,n){var r=this.getDragArea(t,e,n),o=aet(r,4),i=o[0],a=o[1],l=o[2],s=o[3],u=this.plugin.hot._createCellCoords(i,a),c=this.plugin.hot._createCellCoords(l,s),f=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(f,!0)}}]),t}(),bet=get;function wet(t){return wet="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wet(t)}function Cet(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Oet(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ret(r.key),r)}}function ket(t,e,n){return e&&Oet(t.prototype,e),n&&Oet(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ret(t){var e=Eet(t,"string");return"symbol"===wet(e)?e:String(e)}function Eet(t,e){if("object"!==wet(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==wet(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Pet=function(){function t(e){Cet(this,t),this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return ket(t,[{key:"snapDelta",value:function(t,e,n){var r=e.to,o=r.row+t.row,i=r.col+t.col;t.row?this.jumpOverMergedCell(t,n,o):t.col&&this.jumpOverMergedCell(t,n,i)}},{key:"jumpOverMergedCell",value:function(t,e,n){var r=t.row||t.col,o=null,i=null,a=null;t.row?(o=e.includesVertically(n),i=e.row,a=e.getLastRow()):t.col&&(o=e.includesHorizontally(n),i=e.col,a=e.getLastColumn()),0!==r&&(r>0?o&&n!==i&&(r+=a-n+1):o&&n!==a&&(r-=n-i+1),t.row?t.row=r:t.col&&(t.col=r))}},{key:"getUpdatedSelectionRange",value:function(t,e){return this.hot._createCellRange(t.highlight,t.from,this.hot._createCellCoords(t.to.row+e.row,t.to.col+e.col))}},{key:"getSelectedMergedCellClassName",value:function(t,e,n,r){var o=Math.min(n[0],n[2]),i=Math.min(n[1],n[3]),a=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]);if(void 0!==r){var s=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(t,e);if(s){var u=this.plugin.mergedCellsCollection.get(t,e);if(u){var c=u.getLastRow(),f=u.getLastColumn(),h=o<=u.row&&i<=u.col&&a>=c&&l>=f;return h?"".concat(this.fullySelectedMergedCellClassName,"-").concat(r):this.plugin.selectionCalculations.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange())?"".concat(this.fullySelectedMergedCellClassName,"-multiple"):void 0}}}}},{key:"isMergeCellFullySelected",value:function(t,e){var n=[];if(!e||!t)return!1;for(var r=0;r<t.rowspan;r+=1)for(var o=0;o<t.colspan;o+=1)n.push(this.hot._createCellCoords(t.row+r,t.col+o));for(var i=0;i<n.length;i+=1){for(var a=[],l=0;l<e.length;l+=1)a[l]=e[l].includes(n[i]);if(!a.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var t=[],e=0;e<=7;e+=1)t.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(e));return t.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),t}}]),t}(),Tet=Pet;function jet(t){return{key:"mergeCells",name:function(){var e=this.getSelectedLast();if(e){var n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(Jw)}return this.getTranslatedPhrase(Qw)},callback:function(){t.toggleMergeOnSelection()},disabled:function(){var t=this.getSelectedLast();if(!t)return!0;var e=Wtt.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1});return e||this.selection.isSelectedByCorner()},hidden:!1}}function Met(t){return Met="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Met(t)}function Aet(t,e){return _et(t)||xet(t,e)||Det(t,e)||Iet()}function Iet(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xet(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function _et(t){if(Array.isArray(t))return t}function Het(t){return Bet(t)||Let(t)||Det(t)||Net()}function Net(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Det(t,e){if(t){if("string"===typeof t)return Vet(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vet(t,e):void 0}}function Let(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Bet(t){if(Array.isArray(t))return Vet(t)}function Vet(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Fet(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wet(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zet(r.key),r)}}function Uet(t,e,n){return e&&Wet(t.prototype,e),n&&Wet(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function zet(t){var e=Get(t,"string");return"symbol"===Met(e)?e:String(e)}function Get(t,e){if("object"!==Met(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Met(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Yet(){return Yet="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Ket(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Yet.apply(this,arguments)}function Ket(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=tnt(t),null===t)break;return t}function Xet(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$et(t,e)}function $et(t,e){return $et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},$et(t,e)}function qet(t){var e=Zet();return function(){var n,r=tnt(t);if(e){var o=tnt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Qet(this,n)}}function Qet(t,e){if(e&&("object"===Met(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Jet(t)}function Jet(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Zet(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function tnt(t){return tnt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tnt(t)}mr.getSingleton().register("beforeMergeCells"),mr.getSingleton().register("afterMergeCells"),mr.getSingleton().register("beforeUnmergeCells"),mr.getSingleton().register("afterUnmergeCells");var ent,nnt="mergeCells",rnt=150,ont=new WeakMap,int=nnt,ant=function(t){Xet(n,t);var e=qet(n);function n(t){var r;return Fet(this,n),r=e.call(this,t),ont.set(Jet(r),{lastDesiredCoords:null}),r.mergedCellsCollection=null,r.autofillCalculations=null,r.selectionCalculations=null,r}return Uet(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[nnt]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.mergedCellsCollection=new oet(this),this.autofillCalculations=new bet(this),this.selectionCalculations=new Tet(this),this.addHook("afterInit",(function(){return t.onAfterInit.apply(t,arguments)})),this.addHook("modifyTransformStart",(function(){return t.onModifyTransformStart.apply(t,arguments)})),this.addHook("afterModifyTransformStart",(function(){return t.onAfterModifyTransformStart.apply(t,arguments)})),this.addHook("modifyTransformEnd",(function(){return t.onModifyTransformEnd.apply(t,arguments)})),this.addHook("modifyGetCellCoords",(function(){return t.onModifyGetCellCoords.apply(t,arguments)})),this.addHook("beforeSetRangeStart",(function(){return t.onBeforeSetRangeStart.apply(t,arguments)})),this.addHook("beforeSetRangeStartOnly",(function(){return t.onBeforeSetRangeStart.apply(t,arguments)})),this.addHook("beforeSetRangeEnd",(function(){return t.onBeforeSetRangeEnd.apply(t,arguments)})),this.addHook("afterIsMultipleSelection",(function(){return t.onAfterIsMultipleSelection.apply(t,arguments)})),this.addHook("afterRenderer",(function(){return t.onAfterRenderer.apply(t,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return t.addMergeActionsToContextMenu.apply(t,arguments)})),this.addHook("afterGetCellMeta",(function(){return t.onAfterGetCellMeta.apply(t,arguments)})),this.addHook("afterViewportRowCalculatorOverride",(function(){return t.onAfterViewportRowCalculatorOverride.apply(t,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return t.onAfterViewportColumnCalculatorOverride.apply(t,arguments)})),this.addHook("modifyAutofillRange",(function(){return t.onModifyAutofillRange.apply(t,arguments)})),this.addHook("afterCreateCol",(function(){return t.onAfterCreateCol.apply(t,arguments)})),this.addHook("afterRemoveCol",(function(){return t.onAfterRemoveCol.apply(t,arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow.apply(t,arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow.apply(t,arguments)})),this.addHook("afterChange",(function(){return t.onAfterChange.apply(t,arguments)})),this.addHook("beforeDrawBorders",(function(){return t.onBeforeDrawAreaBorders.apply(t,arguments)})),this.addHook("afterDrawSelection",(function(){return t.onAfterDrawSelection.apply(t,arguments)})),this.addHook("beforeRemoveCellClassNames",(function(){return t.onBeforeRemoveCellClassNames.apply(t,arguments)})),this.addHook("beforeUndoStackChange",(function(t,e){if("MergeCells"===e)return!1})),this.registerShortcuts(),Yet(tnt(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),Yet(tnt(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var t=this.hot.getSettings()[nnt];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),Yet(tnt(n.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var t=this;if(Rt()){var e=[],n=[];this.mergedCellsCollection.mergedCells.forEach((function(t){for(var e=t.row,r=t.rowspan,o=e+1;o<e+r;o++)n.push(o)})),n=Het(new Set(n)),n.forEach((function(n){var r=t.hot.rowIndexMapper.getRenderableFromVisualIndex(n);t.hot.view._wt.wtOverlays.getOverlays(!0).map((function(t){return"master"===(null===t||void 0===t?void 0:t.name)?t:t.clone.wtTable})).forEach((function(t){var n=t.getRow(r);n&&(n.style.background=sn(n,"backgroundColor").replace(")",", 0.99)"),e.push(n))}))})),this.hot._registerTimeout((function(){e.forEach((function(t){t.style.background=sn(t,"backgroundColor").replace(", 0.99)",")")}))}),1)}}},{key:"validateSetting",value:function(t){var e=!0;return!!t&&(Wtt.containsNegativeValues(t)?(er(Wtt.NEGATIVE_VALUES_WARNING(t)),e=!1):Wtt.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?(er(Wtt.IS_OUT_OF_BOUNDS_WARNING(t)),e=!1):Wtt.isSingleCell(t)?(er(Wtt.IS_SINGLE_CELL(t)),e=!1):Wtt.containsZeroSpan(t)&&(er(Wtt.ZERO_SPAN_WARNING(t)),e=!1),e)}},{key:"generateFromSettings",value:function(t){var e=this;if(Array.isArray(t)){var n=[];if(U(t,(function(t){if(e.validateSetting(t)){var r=e.hot._createCellCoords(t.row,t.col),o=e.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),i=e.hot._createCellRange(r,r,o);e.mergeRange(i,!0,!0),Ho(t.row,t.row+t.rowspan-1,(function(e){Ho(t.col,t.col+t.colspan-1,(function(r){!1===(e===t.row&&r===t.col)&&n.push([e,r,null])}))}))}})),0===n.length)return;this.hot.setDataAtCell(n)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!e||this.validateSetting(t)}},{key:"toggleMergeOnSelection",value:function(){var t=this.hot.getSelectedRangeLast();if(t){t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var e=t.from,n=t.to;this.toggleMerge(t),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}}},{key:"mergeSelection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(t){t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var e=t.from,n=t.to;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}}},{key:"unmergeSelection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(t){var e=t.from,n=t.to;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}}},{key:"mergeRange",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t.getTopStartCorner(),i=t.getBottomEndCorner(),a={row:o.row,col:o.col,rowspan:i.row-o.row+1,colspan:i.col-o.col+1},l=[],s=null;if(!this.canMergeRange(a,n))return!1;this.hot.runHooks("beforeMergeCells",t,n),Ho(0,a.rowspan-1,(function(t){Ho(0,a.colspan-1,(function(n){var r=null;l[t]||(l[t]=[]),0===t&&0===n?r=e.hot.getSourceDataAtCell(e.hot.toPhysicalRow(a.row),e.hot.toPhysicalColumn(a.col)):e.hot.setCellMeta(a.row+t,a.col+n,"hidden",!0),l[t][n]=r}))})),this.hot.setCellMeta(a.row,a.col,"spanned",!0);var u=this.mergedCellsCollection.add(a);return!u||(r?s=[a.row,a.col,l]:this.hot.populateFromArray(a.row,a.col,l,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",t,a,n),s)}},{key:"unmergeRange",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCellsCollection.getWithinRange(t);r&&(this.hot.runHooks("beforeUnmergeCells",t,n),U(r,(function(t){e.mergedCellsCollection.remove(t.row,t.col),Ho(0,t.rowspan-1,(function(n){Ho(0,t.colspan-1,(function(r){e.hot.removeCellMeta(t.row+n,t.col+r,"hidden")}))})),e.hot.removeCellMeta(t.row,t.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",t,n),this.hot.render())}},{key:"toggleMerge",value:function(t){var e=this.mergedCellsCollection.get(t.from.row,t.from.col),n=e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col;n?this.unmergeRange(t):this.mergeSelection(t)}},{key:"merge",value:function(t,e,n,r){var o=this.hot._createCellCoords(t,e),i=this.hot._createCellCoords(n,r);this.mergeRange(this.hot._createCellRange(o,o,i))}},{key:"unmerge",value:function(t,e,n,r){var o=this.hot._createCellCoords(t,e),i=this.hot._createCellCoords(n,r);this.unmergeRange(this.hot._createCellRange(o,o,i))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[nnt]),this.hot.render()}},{key:"registerShortcuts",value:function(){var t=this,e=this.hot.getShortcutManager(),n=e.getContext("grid");n.addShortcut({keys:[["Control","m"]],callback:function(){t.toggleMerge(t.hot.getSelectedRangeLast()),t.hot.render()},runOnlyIf:function(t){return!t.altKey},group:int})}},{key:"unregisterShortcuts",value:function(){var t=this.hot.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(int)}},{key:"onAfterIsMultipleSelection",value:function(t){if(t)for(var e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1;return t}},{key:"onModifyTransformStart",value:function(t){var e=ont.get(this),n=this.hot.getSelectedRangeLast(),r={row:t.row,col:t.col},o=null,i=this.hot._createCellCoords(n.highlight.row,n.highlight.col),a=this.mergedCellsCollection.get(i.row,i.col);if(e.lastDesiredCoords||(e.lastDesiredCoords=this.hot._createCellCoords(null,null)),a){var l=this.hot._createCellCoords(a.row,a.col),s=this.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1),u=this.hot._createCellRange(l,l,s);u.includes(e.lastDesiredCoords)||(e.lastDesiredCoords=this.hot._createCellCoords(null,null)),r.row=e.lastDesiredCoords.row?e.lastDesiredCoords.row-i.row:r.row,r.col=e.lastDesiredCoords.col?e.lastDesiredCoords.col-i.col:r.col,t.row>0?r.row=a.row+a.rowspan-1-i.row+t.row:t.row<0&&(r.row=i.row-a.row+t.row),t.col>0?r.col=a.col+a.colspan-1-i.col+t.col:t.col<0&&(r.col=i.col-a.col+t.col)}o=this.hot._createCellCoords(n.highlight.row+r.row,n.highlight.col+r.col);var c=this.mergedCellsCollection.get(o.row,o.col);if(c){var f=this.mergedCellsCollection.getFirstRenderableCoords(c.row,c.col);e.lastDesiredCoords=o,r={row:f.row-i.row,col:f.col-i.col}}0!==r.row&&(t.row=r.row),0!==r.col&&(t.col=r.col)}},{key:"onModifyTransformEnd",value:function(t){var e=this,n=this.hot.getSelectedRangeLast(),r=ut(t),o=this.selectionCalculations.getUpdatedSelectionRange(n,t),i=ut(r),a=this.mergedCellsCollection.getWithinRange(o,!0);do{i=ut(r),this.selectionCalculations.getUpdatedSelectionRange(n,r),U(a,(function(t){e.selectionCalculations.snapDelta(r,n,t)}))}while(r.row!==i.row||r.col!==i.col);t.row=r.row,t.col=r.col}},{key:"onModifyGetCellCoords",value:function(t,e){if(!(t<0||e<0)){var n=this.mergedCellsCollection.get(t,e);if(n){var r=n.row,o=n.col,i=n.colspan,a=n.rowspan;return[r,o,r+a-1,o+i-1]}}}},{key:"addMergeActionsToContextMenu",value:function(t){t.items.push({name:"---------"},jet(this))}},{key:"onAfterRenderer",value:function(t,e,n){var r=this.mergedCellsCollection.get(e,n),o=ht(r)?ut(r):void 0;if(ht(o)){var i=this.hot,a=i.rowIndexMapper,l=i.columnIndexMapper,s=o.row,u=o.col,c=o.colspan,f=o.rowspan,h=this.translateMergedCellToRenderable(s,f,u,c),d=Aet(h,2),p=d[0],y=d[1],v=a.getRenderableFromVisualIndex(e),m=l.getRenderableFromVisualIndex(n),g=p-v+1,b=y-m+1;o.row=a.getNearestNotHiddenIndex(o.row,1),o.col=l.getNearestNotHiddenIndex(o.col,1),o.rowspan=Math.min(o.rowspan,g),o.colspan=Math.min(o.colspan,b)}Utt(t,o,e,n)}},{key:"onBeforeSetRangeStart",value:function(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){var e=this.mergedCellsCollection.get(t.row,t.col),n=[e.row,e.col];t.row=n[0],t.col=n[1]}}},{key:"onBeforeSetRangeEnd",value:function(t){var e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;var n=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{n=!1;for(var r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){var o=this.mergedCellsCollection.mergedCells[r],i=o.getRange();e.expandByRange(i)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}},{key:"onAfterGetCellMeta",value:function(t,e,n){var r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(t){var e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}},{key:"modifyViewportRowStart",value:function(t,e){for(var n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(t.startRow),o=0;o<e;o+=1){var i=this.mergedCellsCollection.get(r,o);if(ht(i)){var a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i.row,1));if(a<t.startRow)return t.startRow=a,void this.modifyViewportRowStart(t,e)}}}},{key:"modifyViewportRowEnd",value:function(t,e){for(var n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(t.endRow),o=0;o<e;o+=1){var i=this.mergedCellsCollection.get(r,o);if(ht(i)){var a=i.row+i.rowspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>t.endRow)return t.endRow=l,void this.modifyViewportRowEnd(t,e)}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(t){var e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}},{key:"modifyViewportColumnStart",value:function(t,e){for(var n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(t.startColumn),o=0;o<e;o+=1){var i=this.mergedCellsCollection.get(o,r);if(ht(i)){var a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i.col,1));if(a<t.startColumn)return t.startColumn=a,void this.modifyViewportColumnStart(t,e)}}}},{key:"modifyViewportColumnEnd",value:function(t,e){for(var n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(t.endColumn),o=0;o<e;o+=1){var i=this.mergedCellsCollection.get(o,r);if(ht(i)){var a=i.col+i.colspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>t.endColumn)return t.endColumn=l,void this.modifyViewportColumnEnd(t,e)}}}},{key:"translateMergedCellToRenderable",value:function(t,e,n,r){var o,i,a=this.hot,l=a.rowIndexMapper,s=a.columnIndexMapper;o=0===e?l.getNearestNotHiddenIndex(t,1):l.getNearestNotHiddenIndex(t+e-1,-1),i=0===r?s.getNearestNotHiddenIndex(n,1):s.getNearestNotHiddenIndex(n+r-1,-1);var u=t>=0?l.getRenderableFromVisualIndex(o):t,c=n>=0?s.getRenderableFromVisualIndex(i):n;return[u,c]}},{key:"onModifyAutofillRange",value:function(t,e){this.autofillCalculations.correctSelectionAreaSize(e);var n=this.autofillCalculations.getDirection(e,t),r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;var o=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return o?(r=this.autofillCalculations.snapDragArea(e,r,n,o),r):r}},{key:"onAfterCreateCol",value:function(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}},{key:"onAfterRemoveCol",value:function(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}},{key:"onAfterCreateRow",value:function(t,e,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",t,e)}},{key:"onAfterRemoveRow",value:function(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}},{key:"onAfterChange",value:function(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}},{key:"onBeforeDrawAreaBorders",value:function(t,e){if(e&&"area"===e){var n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);U(r,(function(e){n.getBottomEndCorner().row===e.getLastRow()&&n.getBottomEndCorner().col===e.getLastColumn()&&(t[2]=e.row,t[3]=e.col)}))}}},{key:"onAfterModifyTransformStart",value:function(t,e,n){if(this.enabled){var r=this.mergedCellsCollection.get(t.row,t.col);if(r){var o=e>0,i=e<0,a=n<0,l=n>0,s=r.row+r.rowspan-1===this.hot.countRows()-1,u=0===r.row,c=r.col+r.colspan-1===this.hot.countCols()-1,f=0===r.col;(o&&s||i&&u||l&&c||a&&f)&&(t.row=r.row,t.col=r.col)}}}},{key:"onAfterDrawSelection",value:function(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return nnt}},{key:"PLUGIN_PRIORITY",get:function(){return rnt}}]),n}(RH);function lnt(t){return hnt(t)||fnt(t)||unt(t)||snt()}function snt(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function unt(t,e){if(t){if("string"===typeof t)return cnt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cnt(t,e):void 0}}function cnt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function fnt(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function hnt(t){if(Array.isArray(t))return t}function dnt(t,e){return function(n,r){var o=lnt(n),i=o.slice(1),a=lnt(r),l=a.slice(1);return function n(r){var o=t[r],a=e[r],s=i[r],u=l[r],c=a.multiColumnSorting,f=c.compareFunctionFactory?c.compareFunctionFactory:RV(a.type),h=f(o,a,c)(s,u);if(h===aV){var d=r+1;if("undefined"!==typeof e[d])return n(d)}return h}(0)}}function pnt(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function ynt(){er($t(ent||(ent=pnt(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var vnt="sort";function mnt(t,e,n){var r=[];return!1===n||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push("".concat(vnt,"-").concat(t.getIndexOfColumnInSortQueue(e)+1)),r}function gnt(t){var e=t.className.split(" "),n=new RegExp("^".concat(vnt,"-[0-9]{1,2}$"));return e.filter((function(t){return n.test(t)}))}function bnt(t){return bnt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bnt(t)}function wnt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Snt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ont(r.key),r)}}function Cnt(t,e,n){return e&&Snt(t.prototype,e),n&&Snt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ont(t){var e=knt(t,"string");return"symbol"===bnt(e)?e:String(e)}function knt(t,e){if("object"!==bnt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==bnt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Rnt(){return Rnt="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Ent(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Rnt.apply(this,arguments)}function Ent(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=xnt(t),null===t)break;return t}function Pnt(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tnt(t,e)}function Tnt(t,e){return Tnt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Tnt(t,e)}function jnt(t){var e=Int();return function(){var n,r=xnt(t);if(e){var o=xnt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Mnt(this,n)}}function Mnt(t,e){if(e&&("object"===bnt(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ant(t)}function Ant(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Int(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function xnt(t){return xnt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xnt(t)}var _nt="multiColumnSorting",Hnt=170,Nnt="append",Dnt="columnSorting";OV(_nt,dnt);var Lnt=function(t){Pnt(n,t);var e=jnt(n);function n(t){var r;return wnt(this,n),r=e.call(this,t),r.pluginKey=_nt,r}return Cnt(n,[{key:"isEnabled",value:function(){return Rnt(xnt(n.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Dnt]&&ynt(),Rnt(xnt(n.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Rnt(xnt(n.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(t){Rnt(xnt(n.prototype),"sort",this).call(this,t)}},{key:"clearSort",value:function(){Rnt(xnt(n.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Rnt(xnt(n.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(t){return Rnt(xnt(n.prototype),"getSortConfig",this).call(this,t)}},{key:"setSortConfig",value:function(t){Rnt(xnt(n.prototype),"setSortConfig",this).call(this,t)}},{key:"getNormalizedSortConfigs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}},{key:"updateHeaderClasses",value:function(t){for(var e,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];(e=Rnt(xnt(n.prototype),"updateHeaderClasses",this)).call.apply(e,[this,t].concat(o)),Ye(t,gnt(t)),!1!==this.enabled&&Ge(t,mnt.apply(void 0,o))}},{key:"onUpdateSettings",value:function(t){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Dnt]&&ynt(),Rnt(xnt(n.prototype),"onUpdateSettings",this).call(this,t)}},{key:"onAfterOnCellMouseDown",value:function(t,e){!1!==QB(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,Nnt))):this.sort(this.getColumnNextConfig(e.col)))}}],[{key:"PLUGIN_KEY",get:function(){return _nt}},{key:"PLUGIN_PRIORITY",get:function(){return Hnt}}]),n}(fF);function Bnt(t){return Bnt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bnt(t)}function Vnt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fnt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Unt(r.key),r)}}function Wnt(t,e,n){return e&&Fnt(t.prototype,e),n&&Fnt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Unt(t){var e=znt(t,"string");return"symbol"===Bnt(e)?e:String(e)}function znt(t,e){if("object"!==Bnt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Bnt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Gnt(){return Gnt="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Ynt(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Gnt.apply(this,arguments)}function Ynt(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Znt(t),null===t)break;return t}function Knt(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xnt(t,e)}function Xnt(t,e){return Xnt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xnt(t,e)}function $nt(t){var e=Jnt();return function(){var n,r=Znt(t);if(e){var o=Znt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qnt(this,n)}}function qnt(t,e){if(e&&("object"===Bnt(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Qnt(t)}function Qnt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jnt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Znt(t){return Znt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Znt(t)}var trt="multipleSelectionHandles",ert=160,nrt=function(t){Knt(n,t);var e=$nt(n);function n(t){var r;return Vnt(this,n),r=e.call(this,t),r.dragged=[],r.eventManager=null,r.lastSetCell=null,r}return Wnt(n,[{key:"isEnabled",value:function(){return Ht()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Gr(this)),this.registerListeners(),Gnt(Znt(n.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var t=this,e=this,n=this.hot.rootElement;function r(t){if(1===e.dragged.length)return e.dragged.splice(0,e.dragged.length),!0;var n=e.dragged.indexOf(t);if(-1===n)return!1;0===n?e.dragged=e.dragged.slice(0,1):1===n&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",(function(t){var n;return ze(t.target,"topSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):ze(t.target,"bottomSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchend",(function(t){return ze(t.target,"topSelectionHandle-HitArea")?(r.call(e,"top"),e.touchStartRange=void 0,t.preventDefault(),!1):ze(t.target,"bottomSelectionHandle-HitArea")?(r.call(e,"bottom"),e.touchStartRange=void 0,t.preventDefault(),!1):void 0})),this.eventManager.addEventListener(n,"touchmove",(function(n){var r,o,i,a,l,s,u=t.hot.rootDocument;if(0!==e.dragged.length){var c=u.elementFromPoint(n.touches[0].clientX,n.touches[0].clientY);c&&c!==e.lastSetCell&&("TD"!==c.nodeName&&"TH"!==c.nodeName||(r=e.hot.getCoords(c),-1===r.col&&(r.col=0),o=e.hot.getSelectedRangeLast(),i=o.getWidth(),a=o.getHeight(),l=o.getDirection(),1===i&&1===a&&e.hot.selection.setRangeEnd(r),s=e.getCurrentRangeCoords(o,r,e.touchStartRange.direction,l,e.dragged[0]),null!==s.start&&e.hot.selection.setRangeStart(s.start),e.hot.selection.setRangeEnd(s.end),e.lastSetCell=c),n.preventDefault())}}))}},{key:"getCurrentRangeCoords",value:function(t,e,n,r,o){var i=t.getTopStartCorner(),a=t.getBottomEndCorner(),l=t.getBottomStartCorner(),s=t.getTopEndCorner(),u={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":u="top"===o?{start:this.hot._createCellCoords(e.row,t.highlight.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,i.col)};break;case"SE-NW":"bottom"===o&&(u={start:this.hot._createCellCoords(a.row,e.col),end:this.hot._createCellCoords(e.row,i.col)});break;default:break}break;case"NW-SE":switch(r){case"NE-SW":"top"===o?u={start:e,end:l}:u.end=e;break;case"NW-SE":"top"===o?u={start:e,end:a}:u.end=e;break;case"SE-NW":"top"===o?u={start:e,end:i}:u.end=e;break;case"SW-NE":"top"===o?u={start:e,end:s}:u.end=e;break;default:break}break;case"SW-NE":switch(r){case"NW-SE":u="bottom"===o?{start:this.hot._createCellCoords(e.row,i.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(i.row,e.col),end:this.hot._createCellCoords(e.row,a.col)};break;case"SW-NE":u="top"===o?{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,a.col)}:{start:this.hot._createCellCoords(e.row,i.col),end:this.hot._createCellCoords(i.row,e.col)};break;case"SE-NW":"bottom"===o?u={start:this.hot._createCellCoords(e.row,s.col),end:this.hot._createCellCoords(i.row,e.col)}:"top"===o&&(u={start:l,end:e});break;default:break}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"top"===o&&(u.end=e);break;case"SE-NW":"top"===o?u.end=e:u={start:e,end:i};break;default:break}break;default:break}return u}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return trt}},{key:"PLUGIN_PRIORITY",get:function(){return ert}}]),n}(RH);function rrt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.label,n=void 0===e?"":e,r=t.colspan,o=void 0===r?1:r,i=t.origColspan,a=void 0===i?1:i,l=t.collapsible,s=void 0!==l&&l,u=t.crossHiddenColumns,c=void 0===u?[]:u,f=t.isCollapsed,h=void 0!==f&&f,d=t.isHidden,p=void 0!==d&&d,y=t.isRoot,v=void 0!==y&&y,m=t.isPlaceholder,g=void 0!==m&&m;return{label:n,colspan:o,origColspan:a,collapsible:s,isCollapsed:h,crossHiddenColumns:c,isHidden:p,isRoot:v,isPlaceholder:g}}function ort(){return{label:"",isPlaceholder:!0}}function irt(t){return urt(t)||srt(t)||lrt(t)||art()}function art(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function lrt(t,e){if(t){if("string"===typeof t)return crt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?crt(t,e):void 0}}function srt(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function urt(t){if(Array.isArray(t))return crt(t)}function crt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function frt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=[];if(0===e)return n;U(t,(function(t){var r=[],o=0;n.push(r),U(t,(function(t){var n=rrt();if(ht(t)){var i=t.label,a=t.colspan;n.label=Jt(i),"number"===typeof a&&a>1&&(n.colspan=a,n.origColspan=a)}else n.label=Jt(t);o+=n.origColspan;var l=!1;if(o>=e&&(n.colspan=n.origColspan-(o-e),n.origColspan=n.colspan,l=!0),r.push(n),n.colspan>1)for(var s=0;s<n.colspan-1;s++)r.push(ort());return!l}))}));var r=Math.max.apply(Math,irt(W(n,(function(t){return t.length}))));return U(n,(function(t){if(t.length<r){var e=W(new Array(r-t.length),(function(){return rrt()}));t.splice.apply(t,[t.length,0].concat(irt(e)))}})),n}function hrt(t){return hrt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hrt(t)}var drt=["row","col"];function prt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function yrt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?prt(Object(n),!0).forEach((function(e){vrt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):prt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function vrt(t,e,n){return e=Crt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mrt(t,e){if(null==t)return{};var n,r,o=grt(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function grt(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function brt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wrt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Crt(r.key),r)}}function Srt(t,e,n){return e&&wrt(t.prototype,e),n&&wrt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Crt(t){var e=Ort(t,"string");return"symbol"===hrt(e)?e:String(e)}function Ort(t,e){if("object"!==hrt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==hrt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function krt(t,e,n){Rrt(t,e),e.set(t,n)}function Rrt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ert(t,e){var n=jrt(t,e,"get");return Prt(t,n)}function Prt(t,e){return e.get?e.get.call(t):e.value}function Trt(t,e,n){var r=jrt(t,e,"set");return Mrt(t,r,n),n}function jrt(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Mrt(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Art=["label","collapsible"],Irt=new WeakMap,xrt=new WeakMap,_rt=new WeakMap,Hrt=function(){function t(){brt(this,t),krt(this,Irt,{writable:!0,value:[]}),krt(this,xrt,{writable:!0,value:0}),krt(this,_rt,{writable:!0,value:1/0})}return Srt(t,[{key:"setColumnsLimit",value:function(t){Trt(this,_rt,t)}},{key:"setData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Trt(this,Irt,frt(t,Ert(this,_rt))),Trt(this,xrt,Ert(this,Irt).length)}},{key:"getData",value:function(){return Ert(this,Irt)}},{key:"mergeWith",value:function(t){var e=this;U(t,(function(t){var n=t.row,r=t.col,o=mrt(t,drt),i=e.getHeaderSettings(n,r);null!==i&&at(i,o,Art)}))}},{key:"map",value:function(t){U(Ert(this,Irt),(function(e){U(e,(function(e){var n=t(yrt({},e));ht(n)&&at(e,n,Art)}))}))}},{key:"getHeaderSettings",value:function(t,e){var n;if(t>=Ert(this,xrt)||t<0)return null;var r=Ert(this,Irt)[t];return e>=r.length?null:null!==(n=r[e])&&void 0!==n?n:null}},{key:"getHeadersSettings",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=[];if(t>=Ert(this,xrt)||t<0)return r;for(var o=Ert(this,Irt)[t],i=0,a=e;a<o.length;a++){var l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(i+=l.colspan,r.push(l),l.colspan>1&&(a+=l.colspan-1),i===n)break;if(i>n)throw new Error("The last column settings cannot overlap the other header layers")}return r}},{key:"getLayersCount",value:function(){return Ert(this,xrt)}},{key:"getColumnsCount",value:function(){return Ert(this,xrt)>0?Ert(this,Irt)[0].length:0}},{key:"clear",value:function(){Trt(this,Irt,[]),Trt(this,xrt,0)}}]),t}();function Nrt(t){return Nrt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nrt(t)}function Drt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Lrt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Drt(Object(n),!0).forEach((function(e){Wrt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Drt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Brt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vrt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Urt(r.key),r)}}function Frt(t,e,n){return e&&Vrt(t.prototype,e),n&&Vrt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Wrt(t,e,n){return e=Urt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Urt(t){var e=zrt(t,"string");return"symbol"===Nrt(e)?e:String(e)}function zrt(t,e){if("object"!==Nrt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Nrt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Grt(t){return $rt(t)||Xrt(t)||Krt(t)||Yrt()}function Yrt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Krt(t,e){if(t){if("string"===typeof t)return qrt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qrt(t,e):void 0}}function Xrt(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function $rt(t){if(Array.isArray(t))return qrt(t)}function qrt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Qrt="DF-pre-order";function Jrt(t,e){for(var n=t.call(e,this),r=0;r<this.childs.length;r++){if(!1===n)return!1;n=Jrt.call(this.childs[r],t,e)}return n}var Zrt="DF-post-order";function tot(t,e){for(var n=0;n<this.childs.length;n++){var r=tot.call(this.childs[n],t,e);if(!1===r)return!1}return t.call(e,this)}var eot="BF";function not(t,e){var n=[this];function r(){if(0!==n.length){var o=n.shift();n.push.apply(n,Grt(o.childs)),!1!==t.call(e,o)&&r()}}r()}var rot=eot,oot=new Map([[Qrt,Jrt],[Zrt,tot],[eot,not]]),iot=function(){function t(e){Brt(this,t),Wrt(this,"data",{}),Wrt(this,"parent",null),Wrt(this,"childs",[]),this.data=e}return Frt(t,[{key:"addChild",value:function(t){t.parent=this,this.childs.push(t)}},{key:"cloneTree",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=new t(Lrt({},e.data)),r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}},{key:"replaceTreeWith",value:function(t){this.data=Lrt({},t.data),this.childs=[];for(var e=0;e<t.childs.length;e++)this.addChild(t.childs[e])}},{key:"walkDown",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rot;if(!oot.has(e))throw new Error('Traversal strategy "'.concat(e,'" does not exist'));oot.get(e).call(this,t,this)}},{key:"walkUp",value:function(t){var e=this,n=function n(r){var o=t.call(e,r);!1!==o&&null!==r.parent&&n(r.parent)};n(this)}}]),t}();function aot(t){return aot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aot(t)}function lot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function sot(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lot(Object(n),!0).forEach((function(e){uot(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function uot(t,e,n){return e=bot(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cot(t,e){return yot(t)||pot(t,e)||hot(t,e)||fot()}function fot(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function hot(t,e){if(t){if("string"===typeof t)return dot(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dot(t,e):void 0}}function dot(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function pot(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function yot(t){if(Array.isArray(t))return t}function vot(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bot(r.key),r)}}function got(t,e,n){return e&&mot(t.prototype,e),n&&mot(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function bot(t){var e=wot(t,"string");return"symbol"===aot(e)?e:String(e)}function wot(t,e){if("object"!==aot(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==aot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Sot(t,e,n){Cot(t,e),e.set(t,n)}function Cot(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oot(t,e){var n=Eot(t,e,"get");return kot(t,n)}function kot(t,e){return e.get?e.get.call(t):e.value}function Rot(t,e,n){var r=Eot(t,e,"set");return Pot(t,r,n),n}function Eot(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Pot(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Tot,jot,Mot=new WeakMap,Aot=new WeakMap,Iot=new WeakMap,xot=function(){function t(e){vot(this,t),Sot(this,Mot,{writable:!0,value:new Map}),Sot(this,Aot,{writable:!0,value:new Map}),Sot(this,Iot,{writable:!0,value:null}),Rot(this,Iot,e)}return got(t,[{key:"getRoots",value:function(){return Array.from(Oot(this,Mot).values())}},{key:"getRootByColumn",value:function(t){var e;return Oot(this,Aot).has(t)&&(e=Oot(this,Mot).get(Oot(this,Aot).get(t))),e}},{key:"getNode",value:function(t,e){var n=this.getRootByColumn(e);if(n){var r,o=e-Oot(this,Aot).get(e),i=0;return n.walkDown((function(n){var a=n.data,l=a.origColspan,s=a.headerLevel;if(t===s){if(o>=i&&o<=i+l-1)return r=n,r.data.isRoot=e===r.data.columnIndex,!1;i+=l}})),r}}},{key:"rebuildTreeIndex",value:function(){var t=this,e=0;Oot(this,Aot).clear(),U(Oot(this,Mot),(function(n){for(var r=cot(n,2),o=r[1].data.colspan,i=e;i<e+o;i++)Oot(t,Aot).set(i,e);e+=o}))}},{key:"buildTree",value:function(){this.clear();var t=Oot(this,Iot).getColumnsCount(),e=0;while(e<t){var n=Oot(this,Iot).getHeaderSettings(0,e),r=new iot;Oot(this,Mot).set(e,r),this.buildLeaves(r,e,0,n.origColspan),e+=n.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(t,e,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=Oot(this,Iot).getHeadersSettings(n,e,o);n+=1,U(i,(function(o){var i,a=sot(sot({},o),{},{headerLevel:n-1,columnIndex:e});1===n?(t.data=a,i=t):(i=new iot(a),t.addChild(i)),n<Oot(r,Iot).getLayersCount()&&r.buildLeaves(i,e,n,o.origColspan),e+=o.origColspan}))}},{key:"clear",value:function(){Oot(this,Mot).clear(),Oot(this,Aot).clear()}}]),t}();function _ot(t,e){t.walkDown((function(t){var n=t.data,r=t.childs;if(!n.isHidden&&(e(n.columnIndex),0===r.length))for(var o=1;o<n.colspan;o++)e(n.columnIndex+o)}))}function Hot(t,e){var n=t.childs;if(0!==n.length)return n[0].data[e]}function Not(t){return Hot(t,"origColspan")===t.data.origColspan}function Dot(t){var e=t.data,n=t.childs;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var r=Not(t);if(r)return Dot(n[0]);e.isCollapsed=!1;var o=n.slice(1),i=new Set,a=0;if(o.length>0)U(o,(function(t){t.replaceTreeWith(t.data.clonedTree),t.data.clonedTree=null;var e=t.data;a+=e.colspan,_ot(t,(function(t){i.add(t)}))}));else{var l=e.colspan,s=e.origColspan,u=e.columnIndex;a=s-l;for(var c=1;c<s;c++)i.add(u+c)}return t.walkUp((function(t){var e=t.data;e.colspan+=a,e.colspan>=e.origColspan?(e.colspan=e.origColspan,e.isCollapsed=!1):Not(t)&&(e.isCollapsed=Hot(t,"isCollapsed"))})),{rollbackModification:function(){return Lot(t)},affectedColumns:Array.from(i),colspanCompensation:a}}function Lot(t){var e,n=t.data,r=t.childs;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=Not(t);if(o)return Lot(r[0]);n.isCollapsed=!0;var i=r.slice(1),a=new Set;if(i.length>0)U(i,(function(t){_ot(t,(function(t){a.add(t)})),t.data.clonedTree=t.cloneTree(),t.walkDown((function(t){var e=t.data;e.isHidden=!0}))}));else for(var l=n.origColspan,s=n.columnIndex,u=1;u<l;u++){var c=s+u;a.add(c)}var f=n.colspan-(null!==(e=Hot(t,"colspan"))&&void 0!==e?e:1);return t.walkUp((function(t){var e=t.data;e.colspan-=f,e.colspan<=1?(e.colspan=1,e.isCollapsed=!0):Not(t)&&(e.isCollapsed=Hot(t,"isCollapsed"))})),{rollbackModification:function(){return Dot(t)},affectedColumns:Array.from(a),colspanCompensation:f}}function Bot(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Vot(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error($t(Tot||(Tot=Bot(["The passed node is not the last node on the tree. Only for \nthe last node, the hide column modification can be applied."],["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the hide column modification can be applied."]))));var n=t.data.crossHiddenColumns;if(!n.includes(e)){var r=!1;t.walkUp((function(t){var e=t.data.collapsible;if(e)return r=!0,!1})),r||t.walkUp((function(t){var n=t.data;n.crossHiddenColumns.push(e),n.colspan>1?n.colspan-=1:n.isHidden=!0}))}}function Fot(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Wot(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error($t(jot||(jot=Fot(["The passed node is not the last node on the tree. Only for \nthe last node, the show column modification can be applied."],["The passed node is not the last node on the tree. Only for\\x20\nthe last node, the show column modification can be applied."]))));var n=t.data.crossHiddenColumns;if(n.includes(e)){var r=!1;t.walkUp((function(t){var e=t.data.collapsible;if(e)return r=!0,!1})),r||t.walkUp((function(t){var n=t.data;n.crossHiddenColumns.splice(n.crossHiddenColumns.indexOf(e),1),!n.isHidden&&n.colspan<n.origColspan&&(n.colspan+=1),n.isHidden=!1}))}}var Uot=new Map([["collapse",Lot],["expand",Dot],["hide-column",Vot],["show-column",Wot]]);function zot(t,e,n){if(!Uot.has(t))throw new Error('The node modifier action ("'.concat(t,'") does not exist.'));return Uot.get(t)(e,n)}var Got=["crossHiddenColumns"];function Yot(t,e){if(null==t)return{};var n,r,o=Kot(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function Kot(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function Xot(t){var e=[];return U(t,(function(t){t.walkDown((function(t){for(var n=t.data,r=n.origColspan,o=n.columnIndex,i=n.headerLevel,a=n.crossHiddenColumns,l=qot(e,i),s=!1,u=o;u<o+r;u++){var c=a.includes(u);if(c||s)l.push(ort(n));else{var f=$ot(n);f.isRoot=!0,l.push(f),s=!0}}}))})),e}function $ot(t){var e=rrt(t),n=(e.crossHiddenColumns,Yot(e,Got));return n}function qot(t,e){var n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function Qot(t){return Qot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qot(t)}var Jot=["row"];function Zot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function tit(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zot(Object(n),!0).forEach((function(e){eit(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function eit(t,e,n){return e=lit(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nit(t,e){if(null==t)return{};var n,r,o=rit(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function rit(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}function oit(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iit(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lit(r.key),r)}}function ait(t,e,n){return e&&iit(t.prototype,e),n&&iit(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function lit(t){var e=sit(t,"string");return"symbol"===Qot(e)?e:String(e)}function sit(t,e){if("object"!==Qot(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Qot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function uit(t,e,n){cit(t,e),e.set(t,n)}function cit(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fit(t,e,n){var r=pit(t,e,"set");return hit(t,r,n),n}function hit(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function dit(t,e){var n=pit(t,e,"get");return yit(t,n)}function pit(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function yit(t,e){return e.get?e.get.call(t):e.value}var vit=new WeakMap,mit=new WeakMap,git=new WeakMap,bit=function(){function t(){oit(this,t),uit(this,vit,{writable:!0,value:new Hrt}),uit(this,mit,{writable:!0,value:new xot(dit(this,vit))}),uit(this,git,{writable:!0,value:[[]]})}return ait(t,[{key:"setState",value:function(t){dit(this,vit).setData(t);var e=!1;try{dit(this,mit).buildTree()}catch(n){dit(this,mit).clear(),dit(this,vit).clear(),e=!0}return fit(this,git,Xot(dit(this,mit).getRoots())),e}},{key:"setColumnsLimit",value:function(t){dit(this,vit).setColumnsLimit(t)}},{key:"mergeStateWith",value:function(t){var e=this,n=W(t,(function(t){var n=t.row,r=nit(t,Jot);return tit({row:n<0?e.rowCoordsToLevel(n):n},r)}));dit(this,vit).mergeWith(n),dit(this,mit).buildTree(),fit(this,git,Xot(dit(this,mit).getRoots()))}},{key:"mapState",value:function(t){dit(this,vit).map(t),dit(this,mit).buildTree(),fit(this,git,Xot(dit(this,mit).getRoots()))}},{key:"mapNodes",value:function(t){return V(dit(this,mit).getRoots(),(function(e,n){return n.walkDown((function(n){var r=t(n.data);void 0!==r&&e.push(r)})),e}),[])}},{key:"triggerNodeModification",value:function(t,e,n){e<0&&(e=this.rowCoordsToLevel(e));var r,o=dit(this,mit).getNode(e,n);return o&&(r=zot(t,o,n),fit(this,git,Xot(dit(this,mit).getRoots()))),r}},{key:"triggerColumnModification",value:function(t,e){return this.triggerNodeModification(t,-1,e)}},{key:"rowCoordsToLevel",value:function(t){if(t>=0)return null;var e=t+Math.max(this.getLayersCount(),1);return e<0?null:e}},{key:"levelToRowCoords",value:function(t){if(t<0)return null;var e=t-Math.max(this.getLayersCount(),1);return e>=0?null:e}},{key:"getHeaderSettings",value:function(t,e){var n,r;return t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount()?null:null!==(n=null===(r=dit(this,git)[t])||void 0===r?void 0:r[e])&&void 0!==n?n:null}},{key:"getHeaderTreeNodeData",value:function(t,e){if(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())return null;var n=dit(this,mit).getNode(t,e);return n?tit({},n.data):null}},{key:"findLeftMostColumnIndex",value:function(t,e){var n,r=null!==(n=this.getHeaderSettings(t,e))&&void 0!==n?n:{isRoot:!0},o=r.isRoot;if(o)return e;var i=e-1;while(i>=0){var a,l=null!==(a=this.getHeaderSettings(t,i))&&void 0!==a?a:{isRoot:!0},s=l.isRoot;if(s)break;i-=1}return i}},{key:"getLayersCount",value:function(){return dit(this,vit).getLayersCount()}},{key:"getColumnsCount",value:function(){return dit(this,vit).getColumnsCount()}},{key:"clear",value:function(){fit(this,git,[]),dit(this,vit).clear(),dit(this,mit).clear()}}]),t}();function wit(t){return wit="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wit(t)}function Sit(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cit(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Rit(r.key),r)}}function Oit(t,e,n){return e&&Cit(t.prototype,e),n&&Cit(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function kit(t,e,n){return e=Rit(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rit(t){var e=Eit(t,"string");return"symbol"===wit(e)?e:String(e)}function Eit(t,e){if("object"!==wit(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==wit(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Pit,Tit,jit=function(){function t(e,n){Sit(this,t),kit(this,"hot",void 0),kit(this,"nestedHeaderSettingsGetter",void 0),kit(this,"layersCount",0),kit(this,"container",void 0),kit(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return Oit(t,[{key:"setLayersCount",value:function(t){return this.layersCount=t,this}},{key:"getWidth",value:function(t){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length;this.widthsMap.clear();for(var n=0;n<e;n++){var r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),o=this.hot.toPhysicalColumn(r);this.widthsMap.setValueAtIndex(o,t[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(t){for(var e=this.hot,n=e.rootDocument,r=e.columnIndexMapper,o=n.createDocumentFragment(),i=n.createElement("table"),a=!!this.hot.getSettings().dropdownMenu,l=r.getRenderableIndexesLength(),s=0;s<this.layersCount;s++){for(var u=n.createElement("tr"),c=0;c<l;c++){var f=r.getVisualFromRenderableIndex(c);null===f&&(f=c);var h=n.createElement("th"),d=this.nestedHeaderSettingsGetter(s,f);if(d&&(!d.isPlaceholder||d.isHidden)){var p=d.label;a&&(p+='<button class="changeType"></button>'),Qe(h,p),h.colSpan=d.colspan,u.appendChild(h)}}i.appendChild(u)}o.appendChild(i),t.appendChild(o)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),t}(),Mit=jit;function Ait(t){return Ait="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ait(t)}function Iit(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function xit(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _it(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Yit(r.key),r)}}function Hit(t,e,n){return e&&_it(t.prototype,e),n&&_it(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Nit(){return Nit="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Dit(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Nit.apply(this,arguments)}function Dit(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=zit(t),null===t)break;return t}function Lit(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bit(t,e)}function Bit(t,e){return Bit=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Bit(t,e)}function Vit(t){var e=Uit();return function(){var n,r=zit(t);if(e){var o=zit(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Fit(this,n)}}function Fit(t,e){if(e&&("object"===Ait(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Wit(t)}function Wit(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Uit(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function zit(t){return zit=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},zit(t)}function Git(t,e,n){return e=Yit(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yit(t){var e=Kit(t,"string");return"symbol"===Ait(e)?e:String(e)}function Kit(t,e){if("object"!==Ait(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ait(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Xit(t,e,n){$it(t,e),e.set(t,n)}function $it(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qit(t,e,n){var r=Zit(t,e,"set");return Qit(t,r,n),n}function Qit(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Jit(t,e){var n=Zit(t,e,"get");return tat(t,n)}function Zit(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function tat(t,e){return e.get?e.get.call(t):e.value}var eat="nestedHeaders",nat=280,rat=new WeakMap,oat=new WeakMap,iat=function(t){Lit(n,t);var e=Vit(n);function n(){var t;xit(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),Xit(Wit(t),rat,{writable:!0,value:new bit}),Xit(Wit(t),oat,{writable:!0,value:null}),Git(Wit(t),"ghostTable",new Mit(t.hot,(function(e,n){return t.getHeaderSettings(e,n)}))),Git(Wit(t),"detectedOverlappedHeaders",!1),t}return Hit(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[eat]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings(),r=e.nestedHeaders;Array.isArray(r)&&Array.isArray(r[0])||er($t(Pit||(Pit=Iit(["Your Nested Headers plugin configuration is invalid. The settings has to be \n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"],["Your Nested Headers plugin configuration is invalid. The settings has to be\\x20\n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]"])))),this.addHook("init",(function(){return t.onInit()})),this.addHook("afterLoadData",(function(){return t.onAfterLoadData.apply(t,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)})),this.addHook("afterOnCellMouseDown",(function(){return t.onAfterOnCellMouseDown.apply(t,arguments)})),this.addHook("beforeOnCellMouseOver",(function(){return t.onBeforeOnCellMouseOver.apply(t,arguments)})),this.addHook("afterGetColumnHeaderRenderers",(function(e){return t.onAfterGetColumnHeaderRenderers(e)})),this.addHook("modifyColWidth",(function(){return t.onModifyColWidth.apply(t,arguments)})),this.addHook("modifyColumnHeaderValue",(function(){return t.onModifyColumnHeaderValue.apply(t,arguments)})),this.addHook("beforeHighlightingColumnHeader",(function(){return t.onBeforeHighlightingColumnHeader.apply(t,arguments)})),this.addHook("beforeCopy",(function(){return t.onBeforeCopy.apply(t,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return t.onAfterViewportColumnCalculatorOverride.apply(t,arguments)})),Nit(zit(n.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var t=this;if(this.hot.view){var e=this.hot.getSettings(),r=e.nestedHeaders;Jit(this,rat).setColumnsLimit(this.hot.countCols()),Array.isArray(r)&&(this.detectedOverlappedHeaders=Jit(this,rat).setState(r)),this.detectedOverlappedHeaders&&er($t(Tit||(Tit=Iit(["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration \n                        is currently not supported."],["Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20\n                        is currently not supported."])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((function(e,n){var r=!0===e?"hide-column":"show-column";Jit(t,rat).triggerColumnModification(r,n)})),!Jit(this,oat)&&this.enabled&&qit(this,oat,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((function(e){e.forEach((function(e){var n=e.op,r=e.index,o=e.newValue;if("replace"===n){var i=!0===o?"hide-column":"show-column";Jit(t,rat).triggerColumnModification(i,r)}})),t.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),Nit(zit(n.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),Jit(this,rat).clear(),Jit(this,oat).unsubscribe(),qit(this,oat,null),this.ghostTable.clear(),Nit(zit(n.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return Jit(this,rat)}},{key:"getLayersCount",value:function(){return Jit(this,rat).getLayersCount()}},{key:"getHeaderSettings",value:function(t,e){return Jit(this,rat).getHeaderSettings(t,e)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var t=this.hot.view._wt,e=t.getSetting("columnHeaders").length,n=t.wtTable.THEAD,r=t.wtOverlays.topOverlay.clone.wtTable.THEAD,o=t.wtOverlays.topInlineStartCornerOverlay?t.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=0;i<e;i++){var a=n.childNodes[i];if(!a)break;for(var l=r.childNodes[i],s=o?o.childNodes[i]:null,u=0,c=a.childNodes.length;u<c;u++)a.childNodes[u].removeAttribute("colspan"),Ye(a.childNodes[u],"hiddenHeader"),l&&l.childNodes[u]&&(l.childNodes[u].removeAttribute("colspan"),Ye(l.childNodes[u],"hiddenHeader")),o&&s&&s.childNodes[u]&&(s.childNodes[u].removeAttribute("colspan"),Ye(s.childNodes[u],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(t){var e=this,n=this.hot.view._wt.getSetting("fixedColumnsStart");return function(r,o){var i,a=e.hot,l=a.columnIndexMapper,s=a.view,u=l.getVisualFromRenderableIndex(r);null===u&&(u=r),o.removeAttribute("colspan"),Ye(o,"hiddenHeader");var c=null!==(i=Jit(e,rat).getHeaderSettings(t,u))&&void 0!==i?i:{label:""},f=c.colspan,h=c.isHidden,d=c.isPlaceholder;if(d||h)Ge(o,"hiddenHeader");else if(f>1){var p,y,v=s._wt.wtOverlays,m=null===(p=v.topInlineStartCornerOverlay)||void 0===p?void 0:p.clone.wtTable.THEAD.contains(o),g=null===(y=v.inlineStartOverlay)||void 0===y?void 0:y.clone.wtTable.THEAD.contains(o),b=m||g?Math.min(f,n-r):f;b>1&&o.setAttribute("colspan",b)}e.hot.view.appendColHeader(u,o,(function(){return e.getColumnHeaderValue.apply(e,arguments)}),t)}}},{key:"getColumnHeaderValue",value:function(t,e){var n,r=null!==(n=Jit(this,rat).getHeaderSettings(e,t))&&void 0!==n?n:{},o=r.isHidden,i=r.isPlaceholder;return i||o?"":this.hot.getColHeader(t,e)}},{key:"onBeforeHighlightingColumnHeader",value:function(t,e,n){var r=Jit(this,rat).getHeaderTreeNodeData(e,t);if(!r)return t;var o=n.classNames,i=n.columnCursor,a=n.selectionType,l=n.selectionWidth,s=Jit(this,rat).getHeaderSettings(e,t),u=s.isRoot,c=s.colspan;if(a===TC){if(!u)return r.columnIndex}else a===kC&&(c>l-i||!u)&&(o.length=0);return t}},{key:"onBeforeCopy",value:function(t,e,n){var r=n.columnHeadersCount;if(0!==r)for(var o=0;o<e.length;o++){var i=e[o],a=i.startRow,l=i.startCol,s=i.endRow,u=i.endCol,c=s-a+1,f=l-u+1;if(a>=0||1===f)break;for(var h=l;h<=u;h++)for(var d=a;d<=s;d++){var p,y=c+d,v=h-l;if(0!==v){var m=null===(p=Jit(this,rat).getHeaderTreeNodeData(d,h))||void 0===p?void 0:p.isRoot;!1===m&&(t[y][v]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n,r){var o=this._getHeaderTreeNodeDataByCoords(e);o&&(r.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(t,e){var n=this._getHeaderTreeNodeDataByCoords(e);if(n){var r=this.hot.selection,o=r.isSelected()?r.getSelectedRange().current():null,i=[],a=n.columnIndex,l=n.origColspan,s=!r.inInSelection(e);t.shiftKey&&o?e.col<o.from.col?i.push(o.getTopEndCorner().col,a,e.row):e.col>o.from.col?i.push(o.getTopStartCorner().col,a+l-1,e.row):i.push(a,a+l-1,e.row):(tr(t)||Zn(t)&&s)&&i.push(a,a+l-1,e.row),r.selectColumns.apply(r,i)}}},{key:"onBeforeOnCellMouseOver",value:function(t,e,n,r){var o;if(this.hot.view.isMouseDown()){var i=this._getHeaderTreeNodeDataByCoords(e);if(i){var a=i.columnIndex,l=i.origColspan,s=this.hot.getSelectedRangeLast(),u=s.getTopStartCorner(),c=s.getBottomEndCorner(),f=s.from;r.column=!0,r.cell=!0;var h=[];e.col<f.col?h.push(c.col,a):e.col>f.col?h.push(u.col,a+l-1):h.push(a,a+l-1),(o=this.hot).selectColumns.apply(o,h)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(t){t.length=0;for(var e=0;e<Jit(this,rat).getLayersCount();e++)t.push(this.headerRendererFactory(e))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(t){for(var e=Jit(this,rat).getLayersCount(),n=t.startColumn,r=!!e,o=0;o<e;o++){var i=Jit(this,rat).findLeftMostColumnIndex(o,t.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(i);if(i>=0&&(r=!1),xo(a)&&a<t.startColumn){n=a;break}}t.startColumn=r?Jit(this,rat).getHeaderTreeNodeData(0,n).columnIndex:n}},{key:"onModifyColWidth",value:function(t,e){var n=this.ghostTable.getWidth(e);return t>n?t:n}},{key:"onModifyColumnHeaderValue",value:function(t,e,n){var r,o=null!==(r=Jit(this,rat).getHeaderTreeNodeData(n,e))&&void 0!==r?r:{label:""},i=o.label;return i}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(t,e){e||this.updatePlugin()}},{key:"destroy",value:function(){qit(this,rat,null),null!==Jit(this,oat)&&(Jit(this,oat).unsubscribe(),qit(this,oat,null)),Nit(zit(n.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(t){if(!(t.row>=0||t.col<0))return Jit(this,rat).getHeaderTreeNodeData(t.row,t.col)}}],[{key:"PLUGIN_KEY",get:function(){return eat}},{key:"PLUGIN_PRIORITY",get:function(){return nat}}]),n}(RH);function aat(t){return cat(t)||uat(t)||sat(t)||lat()}function lat(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function sat(t,e){if(t){if("string"===typeof t)return fat(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fat(t,e):void 0}}function uat(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function cat(t){if(Array.isArray(t))return fat(t)}function fat(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function hat(t){return hat="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hat(t)}function dat(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pat(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vat(r.key),r)}}function yat(t,e,n){return e&&pat(t.prototype,e),n&&pat(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function vat(t){var e=mat(t,"string");return"symbol"===hat(e)?e:String(e)}function mat(t,e){if("object"!==hat(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==hat(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var gat=function(){function t(e,n){dat(this,t),this.hot=n,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return yat(t,[{key:"setData",value:function(t){this.data=t}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var t=null;return this.plugin.disableCoreAPIModifiers(),t=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),t}},{key:"updateWithData",value:function(t){this.setData(t),this.rewriteCache()}},{key:"rewriteCache",value:function(){var t=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ho(0,this.data.length-1,(function(e){t.cacheNode(t.data[e],0,null)}))}},{key:"cacheNode",value:function(t,e,n){var r=this;this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:n,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&U(t.__children,(function(n){r.cacheNode(n,e+1,t)}))}},{key:"getDataObject",value:function(t){return null===t||void 0===t?null:this.cache.rows[t]}},{key:"readTreeNodes",value:function(t,e,n,r){var o=this,i=!1,a=e;if(isNaN(a)&&a.end)return a;var l=t;return l||(l={__children:this.data},i=!0,a-=1),null!==n&&void 0!==n&&a===n?{result:l,end:!0}:null!==r&&void 0!==r&&l===r?{result:a,end:!0}:(a+=1,l.__children&&U(l.__children,(function(t){if(o.parentReference.set(t,i?null:l),a=o.readTreeNodes(t,a,n,r),isNaN(a)&&a.end)return!1})),a)}},{key:"mockParent",value:function(){var t=this.mockNode();return t.__children=this.data,t}},{key:"mockNode",value:function(){var t={};return pt(this.data[0],(function(e,n){t[n]=null})),t}},{key:"getRowIndex",value:function(t){return null===t||void 0===t?null:this.cache.nodeInfo.get(t).row}},{key:"getRowIndexWithinParent",value:function(t){var e=null;e=isNaN(t)?t:this.getDataObject(t);var n=this.getRowParent(t);return null===n||void 0===n?this.data.indexOf(e):n.__children.indexOf(e)}},{key:"countAllRows",value:function(){var t={__children:this.data};return this.countChildren(t)}},{key:"countChildren",value:function(t){var e=this,n=0,r=t;return isNaN(r)||(r=this.getDataObject(r)),r&&r.__children?(U(r.__children,(function(t){n+=1,t.__children&&(n+=e.countChildren(t))})),n):0}},{key:"getRowParent",value:function(t){var e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}},{key:"getRowObjectParent",value:function(t){return t&&"object"===hat(t)?this.cache.nodeInfo.get(t).parent:null}},{key:"getRowLevel",value:function(t){var e=null;return e=isNaN(t)?t:this.getDataObject(t),e?this.getRowObjectLevel(e):null}},{key:"getRowObjectLevel",value:function(t){return null===t||void 0===t?null:this.cache.nodeInfo.get(t).level}},{key:"hasChildren",value:function(t){var e=t;return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)}},{key:"isChild",value:function(t){return null!==this.getRowParent(t)}},{key:"getChild",value:function(t,e){var n;return(null===(n=t.__children)||void 0===n?void 0:n[e])||null}},{key:"isRowHighestLevel",value:function(t){return!this.isChild(t)}},{key:"isParent",value:function(t){var e,n=t;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(e=n.__children)||void 0===e?void 0:e.length)}},{key:"addChild",value:function(t,e){var n=e;this.hot.runHooks("beforeAddChild",t,n);var r=null;t&&(r=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(t)+1,1);var o=t;t||(o=this.mockParent()),o.__children||(o.__children=[]),n||(n=this.mockNode()),o.__children.push(n),this.rewriteCache();var i=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(i,1),this.hot.runHooks("afterCreateRow",i,1),this.hot.runHooks("afterAddChild",t,n)}},{key:"addChildAtIndex",value:function(t,e,n){var r,o=n;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",t,o,e),t){var i=this.getRowIndex(t),a=i+e+1;this.hot.runHooks("beforeCreateRow",a,1),t.__children.splice(e,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),r=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",e,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[e]);o=this.getDataObject(r),this.hot.runHooks("afterAddChild",t,o,e)}},{key:"addSibling",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",n=this.translateTrimmedRow(t),r=this.getRowParent(n),o=this.getRowIndexWithinParent(n);switch(e){case"below":this.addChildAtIndex(r,o+1,null);break;case"above":this.addChildAtIndex(r,o,null);break;default:break}}},{key:"detachFromParent",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=null,o=[];Array.isArray(t)?(Ho(t[0],t[2],(function(t){var n=e.translateTrimmedRow(t);o.push(e.getDataObject(n))})),Ho(0,o.length-2,(function(t){e.detachFromParent(o[t],!1)})),r=o[o.length-1]):r=t;var i=this.getRowIndex(r),a=this.countChildren(r),l=this.getRowIndexWithinParent(r),s=this.getRowParent(r),u=this.getRowParent(s),c=this.getRowIndex(u),f=null;if(this.hot.runHooks("beforeDetachChild",s,r),null!==l&&void 0!==l){var h=Array.from(new Array(i+a+1).keys()).splice(-1*(a+1));if(this.hot.runHooks("beforeRemoveRow",i,a+1,h,this.plugin.pluginName),s.__children.splice(l,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,a+1,h,this.plugin.pluginName),u){f=c+this.countChildren(u);var d=this.getChild(u,this.countChildren(u)-1),p=this.getRowIndex(d);this.hot.runHooks("beforeCreateRow",p+1,a+1,this.plugin.pluginName),u.__children.push(r)}else f=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",f-2,a+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",f-2,a+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",s,r,this.getRowIndex(r)),n&&this.hot.render()}},{key:"filterData",value:function(t,e,n){var r=this,o=[];U(n,(function(t){o.push(r.getDataObject(t))})),U(o,(function(t){var e=r.getRowIndexWithinParent(t),n=r.getRowParent(t);null===n?r.data.splice(e,1):n.__children.splice(e,1)})),this.rewriteCache()}},{key:"spliceData",value:function(t,e,n){var r,o=this.getDataObject(t-1),i=null,a=t;if(o&&o.__children&&0===o.__children.length?(i=o,a=0):t<this.countAllRows()&&(i=this.getRowParent(t),a=this.getRowIndexWithinParent(t)),i)n?(r=i.__children).splice.apply(r,[a,e].concat(aat(n))):i.__children.splice(a,e);else if(n){var l;(l=this.data).splice.apply(l,[a,e].concat(aat(n)))}else this.data.splice(a,e);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(t){var e=t,n=null;do{n=this.getRowParent(n),null!==n&&(e=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(e),"__children",e.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(t,e,n,r){var o=e===this.hot.countRows(),i=this.getRowParent(t),a=this.getRowIndexWithinParent(t),l=i.__children.slice(a,a+1),s=t>e,u=o?this.getRowParent(e-1):this.getRowParent(e);null!==u&&void 0!==u||(u=this.getRowParent(e-1)),null!==u&&void 0!==u||(u=this.getDataObject(e-1)),u?u.__children||(u.__children=[]):(u=this.getDataObject(e),u.__children=[]);var c=o||n||r?u.__children.length:this.getRowIndexWithinParent(e),f=i===u;u.__children.splice(c,0,l[0]),i.__children.splice(a+(s&&f?1:0),1),this.syncRowWithRawSource(i),f||this.syncRowWithRawSource(u)}},{key:"translateTrimmedRow",value:function(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}},{key:"untranslateTrimmedRow",value:function(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(t):t}}]),t}(),bat=gat;function wat(t){return wat="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wat(t)}function Sat(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Oat(r.key),r)}}function Cat(t,e,n){return e&&Sat(t.prototype,e),n&&Sat(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Oat(t){var e=kat(t,"string");return"symbol"===wat(e)?e:String(e)}function kat(t,e){if("object"!==wat(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==wat(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Rat(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Eat=Cat((function t(e,n){Rat(this,t),this.hot=n,this.plugin=e})),Pat=Eat;function Tat(t){return Tat="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tat(t)}function jat(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mat(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Iat(r.key),r)}}function Aat(t,e,n){return e&&Mat(t.prototype,e),n&&Mat(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Iat(t){var e=xat(t,"string");return"symbol"===Tat(e)?e:String(e)}function xat(t,e){if("object"!==Tat(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Tat(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _at(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hat(t,e)}function Hat(t,e){return Hat=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Hat(t,e)}function Nat(t){var e=Bat();return function(){var n,r=Vat(t);if(e){var o=Vat(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Dat(this,n)}}function Dat(t,e){if(e&&("object"===Tat(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Lat(t)}function Lat(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bat(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Vat(t){return Vat=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Vat(t)}var Fat=function(t){_at(n,t);var e=Nat(n);function n(t,r){var o;return jat(this,n),o=e.call(this,t,r),o.dataManager=o.plugin.dataManager,o.collapsingUI=o.plugin.collapsingUI,o.rowHeaderWidthCache=null,o}return Aat(n,[{key:"appendLevelIndicators",value:function(t,e){var r=this.hot.toPhysicalRow(t),o=this.dataManager.getRowLevel(r),i=this.dataManager.getDataObject(r),a=e.getElementsByTagName("DIV")[0],l=a.querySelector("span.rowHeader"),s=a.querySelectorAll('[class^="ht_nesting"]');if(U(s,(function(t){t&&a.removeChild(t)})),Ge(e,n.CSS_CLASSES.indicatorContainer),o){var u=this.hot.rootDocument,c=l.cloneNode(!0);a.innerHTML="",Ho(0,o-1,(function(){var t=u.createElement("SPAN");Ge(t,n.CSS_CLASSES.emptyIndicator),a.appendChild(t)})),a.appendChild(c)}if(this.dataManager.hasChildren(i)){var f=this.hot.rootDocument.createElement("DIV");Ge(e,n.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?Ge(f,"".concat(n.CSS_CLASSES.button," ").concat(n.CSS_CLASSES.expandButton)):Ge(f,"".concat(n.CSS_CLASSES.button," ").concat(n.CSS_CLASSES.collapseButton)),a.appendChild(f)}}},{key:"updateRowHeaderWidth",value:function(t){var e=t;e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),n}(Pat),Wat=Fat;function Uat(t){return Uat="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uat(t)}function zat(t){return Xat(t)||Kat(t)||Yat(t)||Gat()}function Gat(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Yat(t,e){if(t){if("string"===typeof t)return $at(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$at(t,e):void 0}}function Kat(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Xat(t){if(Array.isArray(t))return $at(t)}function $at(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function qat(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qat(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Zat(r.key),r)}}function Jat(t,e,n){return e&&Qat(t.prototype,e),n&&Qat(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zat(t){var e=tlt(t,"string");return"symbol"===Uat(e)?e:String(e)}function tlt(t,e){if("object"!==Uat(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Uat(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function elt(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nlt(t,e)}function nlt(t,e){return nlt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},nlt(t,e)}function rlt(t){var e=alt();return function(){var n,r=llt(t);if(e){var o=llt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return olt(this,n)}}function olt(t,e){if(e&&("object"===Uat(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ilt(t)}function ilt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function alt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function llt(t){return llt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},llt(t)}var slt=function(t){elt(n,t);var e=rlt(n);function n(t,r){var o;return qat(this,n),o=e.call(this,t,r),o.dataManager=o.plugin.dataManager,o.collapsedRows=[],o.collapsedRowsStash={stash:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,t)},shiftStash:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null!==e&&void 0!==e||(e=1/0),U(o.lastCollapsedRows,(function(r,i){r>=t&&r<e&&(o.lastCollapsedRows[i]=r+n)}))},applyStash:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];o.collapseMultipleChildren(o.lastCollapsedRows,t),o.lastCollapsedRows=void 0},trimStash:function(t,e){Ho(t,t+e-1,(function(t){var e=o.lastCollapsedRows.indexOf(t);e>-1&&o.lastCollapsedRows.splice(e,1)}))}},o}return Jat(n,[{key:"collapseChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=null,a=null,l=null;return isNaN(t)?(i=t,a=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(t),a=t),this.dataManager.hasChildren(i)&&U(i.__children,(function(t){o.push(e.dataManager.getRowIndex(t))})),l=this.collapseRows(o,!0,!1),r&&this.trimRows(l),n&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(a)&&this.collapsedRows.push(a),l}},{key:"collapseMultipleChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];U(t,(function(t){o.push.apply(o,zat(e.collapseChildren(t,!1,!1)))})),r&&this.trimRows(o),n&&this.renderAndAdjust()}},{key:"collapseRow",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([t],e)}},{key:"collapseRows",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return U(t,(function(t){o.push(t),n&&e.collapseChildRows(t,o)})),r&&this.trimRows(o),o}},{key:"collapseChildRows",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){var o=this.dataManager.getDataObject(t);U(o.__children,(function(t){var r=e.dataManager.getRowIndex(t);n.push(r),e.collapseChildRows(r,n)}))}r&&this.trimRows(n)}},{key:"expandRow",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([t],e)}},{key:"expandRows",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];return U(t,(function(t){o.push(t),n&&e.expandChildRows(t,o)})),r&&this.untrimRows(o),o}},{key:"expandChildRows",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){var o=this.dataManager.getDataObject(t);U(o.__children,(function(t){if(!e.isAnyParentCollapsed(t)){var r=e.dataManager.getRowIndex(t);n.push(r),e.expandChildRows(r,n)}}))}r&&this.untrimRows(n)}},{key:"expandChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=null,a=null,l=null;return isNaN(t)?(i=t,a=this.dataManager.getRowIndex(t)):(i=this.dataManager.getDataObject(t),a=t),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(i)&&U(i.__children,(function(t){var n=e.dataManager.getRowIndex(t);o.push(n)})),l=this.expandRows(o,!0,!1),r&&this.untrimRows(l),n&&this.renderAndAdjust(),l}},{key:"expandMultipleChildren",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[];U(t,(function(t){o.push.apply(o,zat(e.expandChildren(t,!1,!1)))})),r&&this.untrimRows(o),n&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var t=this,e=this.dataManager.getData(),n=[];U(e,(function(e){t.dataManager.hasChildren(e)&&n.push(e)})),this.collapseMultipleChildren(n),this.renderAndAdjust()}},{key:"expandAll",value:function(){var t=this,e=this.dataManager.getData(),n=[];U(e,(function(e){t.dataManager.hasChildren(e)&&n.push(e)})),this.expandMultipleChildren(n),this.renderAndAdjust()}},{key:"trimRows",value:function(t){var e=this;this.hot.batchExecution((function(){U(t,(function(t){e.plugin.collapsedRowsMap.setValueAtIndex(t,!0)}))}),!0)}},{key:"untrimRows",value:function(t){var e=this;this.hot.batchExecution((function(){U(t,(function(t){e.plugin.collapsedRowsMap.setValueAtIndex(t,!1)}))}),!0)}},{key:"areChildrenCollapsed",value:function(t){var e=this,n=isNaN(t)?t:this.dataManager.getDataObject(t),r=!0;return null===n&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&U(n.__children,(function(t){var n=e.dataManager.getRowIndex(t);if(!e.plugin.collapsedRowsMap.getValueAtIndex(n))return r=!1,!1})),r}},{key:"isAnyParentCollapsed",value:function(t){var e=t;while(null!==e){e=this.dataManager.getRowParent(e);var n=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}},{key:"toggleState",value:function(t,e){if(!(e.col>=0)){var n=this.translateTrimmedRow(e.row);ze(t.target,Wat.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),Qn(t))}}},{key:"translateTrimmedRow",value:function(t){return this.hot.toPhysicalRow(t)}},{key:"untranslateTrimmedRow",value:function(t){return this.hot.toVisualRow(t)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),n}(Pat),ult=slt;function clt(t){return clt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},clt(t)}function flt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hlt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,plt(r.key),r)}}function dlt(t,e,n){return e&&hlt(t.prototype,e),n&&hlt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function plt(t){var e=ylt(t,"string");return"symbol"===clt(e)?e:String(e)}function ylt(t,e){if("object"!==clt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==clt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function vlt(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mlt(t,e)}function mlt(t,e){return mlt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},mlt(t,e)}function glt(t){var e=Slt();return function(){var n,r=Clt(t);if(e){var o=Clt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return blt(this,n)}}function blt(t,e){if(e&&("object"===clt(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return wlt(t)}function wlt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Slt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Clt(t){return Clt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Clt(t)}var Olt,klt=new WeakMap,Rlt=function(t){vlt(n,t);var e=glt(n);function n(t,r){var o;return flt(this,n),o=e.call(this,t,r),klt.set(wlt(o),{row_above:function(t,e){var n=e[e.length-1];o.dataManager.addSibling(n.start.row,"above")},row_below:function(t,e){var n=e[e.length-1];o.dataManager.addSibling(n.start.row,"below")}}),o.dataManager=o.plugin.dataManager,o}return dlt(n,[{key:"appendOptions",value:function(t){var e=this,n=[{key:"add_child",name:function(){return this.getTranslatedPhrase(mS)},callback:function(){var t=e.dataManager.translateTrimmedRow(e.hot.getSelectedLast()[0]),n=e.dataManager.getDataObject(t);e.dataManager.addChild(n)},disabled:function(){var t=e.hot.getSelectedLast();return!t||t[0]<0||e.hot.selection.isSelectedByColumnHeader()||e.hot.countRows()>=e.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(gS)},callback:function(){e.dataManager.detachFromParent(e.hot.getSelectedLast())},disabled:function(){var t=e.hot.getSelectedLast(),n=e.dataManager.translateTrimmedRow(t[0]),r=e.dataManager.getRowParent(n);return!r||!t||t[0]<0||e.hot.selection.isSelectedByColumnHeader()||e.hot.countRows()>=e.hot.getSettings().maxRows}},{name:"---------"}];return Ho(0,t.items.length-1,(function(e){if(0===e)return U(n,(function(n,r){t.items.splice(e+r,0,n)})),!1})),this.modifyRowInsertingOptions(t)}},{key:"modifyRowInsertingOptions",value:function(t){var e=klt.get(this);return Ho(0,t.items.length-1,(function(n){var r=e[t.items[n].key];null!==r&&void 0!==r&&(t.items[n].callback=r)})),t}}]),n}(Pat),Elt=Rlt;function Plt(t){return Plt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Plt(t)}function Tlt(t){return Ilt(t)||Alt(t)||Mlt(t)||jlt()}function jlt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Mlt(t,e){if(t){if("string"===typeof t)return xlt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xlt(t,e):void 0}}function Alt(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Ilt(t){if(Array.isArray(t))return xlt(t)}function xlt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _lt(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Hlt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nlt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Llt(r.key),r)}}function Dlt(t,e,n){return e&&Nlt(t.prototype,e),n&&Nlt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Llt(t){var e=Blt(t,"string");return"symbol"===Plt(e)?e:String(e)}function Blt(t,e){if("object"!==Plt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Plt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Vlt=function(){function t(e){Hlt(this,t),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}return Dlt(t,[{key:"onBeforeRowMove",value:function(t,e,n,r){var o=this,i=this.displayAPICompatibilityWarning({rows:t,finalIndex:e,dropIndex:n,movePossible:r});if(i)return!1;this.movedToCollapsed=!1;var a=n===this.hot.countRows(),l=a?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n),s=!0,u=t.map((function(t){if(!s)return!1;var e=o.dataManager.translateTrimmedRow(t);return s=o.shouldAllowMoving(e,l),e})),c=-1===u.indexOf(l);if(!s||!c)return!1;var f=this.getBaseParent(u),h=this.getTargetParent(a,l),d=f===h;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(h),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,l,d),this.moveRows(u,l,h),this.dataManager.rewriteCache(),this.moveCellsMeta(u,l),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",t,e,n,r,r&&this.isRowOrderChanged(t,e)),this.hot.render(),this.selectCells(t,n),!1}},{key:"displayAPICompatibilityWarning",value:function(t){var e=t.rows,n=t.finalIndex,r=t.dropIndex,o=t.movePossible,i=!1;return te(r)&&(er($t(Olt||(Olt=_lt(["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows \n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."],["Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20\n      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead."])))),this.hot.runHooks("afterRowMove",e,n,r,o,!1),i=!0),i}},{key:"shouldAllowMoving",value:function(t,e){return!(this.dataManager.isParent(t)||this.dataManager.isRowHighestLevel(t)||t===e||0===e)}},{key:"getBaseParent",value:function(t){return this.dataManager.getRowParent(t[0])}},{key:"getTargetParent",value:function(t,e){var n=this.dataManager.getRowParent(t?e-1:e);return null!==n&&void 0!==n||(n=this.dataManager.getRowParent(e-1)),n}},{key:"shiftCollapsibleParentsLocations",value:function(t,e,n){n||(Math.max.apply(Math,Tlt(t))<=e?this.collapsingUI.collapsedRowsStash.shiftStash(t[0],e,-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(e,t[0],t.length))}},{key:"moveRows",value:function(t,e,n){var r=this,o=e===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender((function(){t.forEach((function(t){r.dataManager.moveRow(t,e,r.movedToCollapsed,o)}))}))}},{key:"moveCellsMeta",value:function(t,e){var n,r=this,o=[],i=Math.max.apply(Math,Tlt(t))<e;t.forEach((function(t){o.push(r.hot.getCellMetaAtRow(t))})),this.hot.spliceCellsMeta(t[0],t.length),(n=this.hot).spliceCellsMeta.apply(n,[e-(i?o.length:0),0].concat(o))}},{key:"selectCells",value:function(t,e){var n=t.length,r=0,o=0,i=null,a=null;if(this.movedToCollapsed){var l=null;l=t[n-1]<e?this.dataManager.translateTrimmedRow(e-n):this.dataManager.translateTrimmedRow(e);var s=this.dataManager.getRowParent(null===l?this.hot.countSourceRows()-1:l-1),u=this.dataManager.getRowIndex(s);r=this.dataManager.untranslateTrimmedRow(u),o=r}else t[n-1]<e?(o=e-1,r=o-n+1):(r=e,o=r+n-1);i=this.hot.selection,a=this.hot.countCols()-1,i.setRangeStart(this.hot._createCellCoords(r,0)),i.setRangeEnd(this.hot._createCellCoords(o,a),!0)}},{key:"isRowOrderChanged",value:function(t,e){return t.some((function(t,n){return t-n!==e}))}}]),t}();function Flt(t){return Flt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Flt(t)}function Wlt(t){return Ylt(t)||Glt(t)||zlt(t)||Ult()}function Ult(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function zlt(t,e){if(t){if("string"===typeof t)return Klt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Klt(t,e):void 0}}function Glt(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Ylt(t){if(Array.isArray(t))return Klt(t)}function Klt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Xlt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Qlt(r.key),r)}}function qlt(t,e,n){return e&&$lt(t.prototype,e),n&&$lt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qlt(t){var e=Jlt(t,"string");return"symbol"===Flt(e)?e:String(e)}function Jlt(t,e){if("object"!==Flt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Flt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Zlt(){return Zlt="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=tst(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Zlt.apply(this,arguments)}function tst(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=lst(t),null===t)break;return t}function est(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nst(t,e)}function nst(t,e){return nst=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},nst(t,e)}function rst(t){var e=ast();return function(){var n,r=lst(t);if(e){var o=lst(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ost(this,n)}}function ost(t,e){if(e&&("object"===Flt(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ist(t)}function ist(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ast(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function lst(t){return lst=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lst(t)}var sst="nestedRows",ust=300,cst=new WeakMap,fst="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",hst=function(t){est(n,t);var e=rst(n);function n(t){var r;return Xlt(this,n),r=e.call(this,t),r.dataManager=null,r.headersUI=null,r.collapsedRowsMap=null,cst.set(ist(r),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),r}return qlt(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[sst]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Zg),this.dataManager=new bat(this,this.hot),this.collapsingUI=new ult(this,this.hot),this.headersUI=new Wat(this,this.hot),this.contextMenuUI=new Elt(this,this.hot),this.rowMoveController=new Vlt(this),this.addHook("afterInit",(function(){return t.onAfterInit.apply(t,arguments)})),this.addHook("beforeViewRender",(function(){return t.onBeforeViewRender.apply(t,arguments)})),this.addHook("modifyRowData",(function(){return t.onModifyRowData.apply(t,arguments)})),this.addHook("modifySourceLength",(function(){return t.onModifySourceLength.apply(t,arguments)})),this.addHook("beforeDataSplice",(function(){return t.onBeforeDataSplice.apply(t,arguments)})),this.addHook("filterData",(function(){return t.onFilterData.apply(t,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return t.onAfterContextMenuDefaultOptions.apply(t,arguments)})),this.addHook("afterGetRowHeader",(function(){return t.onAfterGetRowHeader.apply(t,arguments)})),this.addHook("beforeOnCellMouseDown",(function(){return t.onBeforeOnCellMouseDown.apply(t,arguments)})),this.addHook("beforeRemoveRow",(function(){return t.onBeforeRemoveRow.apply(t,arguments)})),this.addHook("afterRemoveRow",(function(){return t.onAfterRemoveRow.apply(t,arguments)})),this.addHook("beforeAddChild",(function(){return t.onBeforeAddChild.apply(t,arguments)})),this.addHook("afterAddChild",(function(){return t.onAfterAddChild.apply(t,arguments)})),this.addHook("beforeDetachChild",(function(){return t.onBeforeDetachChild.apply(t,arguments)})),this.addHook("afterDetachChild",(function(){return t.onAfterDetachChild.apply(t,arguments)})),this.addHook("modifyRowHeaderWidth",(function(){return t.onModifyRowHeaderWidth.apply(t,arguments)})),this.addHook("afterCreateRow",(function(){return t.onAfterCreateRow.apply(t,arguments)})),this.addHook("beforeRowMove",(function(){return t.onBeforeRowMove.apply(t,arguments)})),this.addHook("beforeLoadData",(function(e){return t.onBeforeLoadData(e)})),this.addHook("beforeUpdateData",(function(e){return t.onBeforeLoadData(e)})),Zlt(lst(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),Zlt(lst(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var t=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(t),Zlt(lst(n.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}},{key:"disableCoreAPIModifiers",value:function(){var t=cst.get(this);t.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var t=cst.get(this);t.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(t,e,n){this.collapsingUI.toggleState(t,e,n)}},{key:"onModifyRowData",value:function(t){var e=cst.get(this);if(!e.skipCoreAPIModifiers)return this.dataManager.getDataObject(t)}},{key:"onModifySourceLength",value:function(){var t=cst.get(this);if(!t.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(t,e,n){var r=cst.get(this);return!(!r.skipCoreAPIModifiers&&!this.dataManager.isRowHighestLevel(t))||(this.dataManager.spliceData(t,e,n),!1)}},{key:"onFilterData",value:function(t,e,n){var r=cst.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),r.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(t){return this.contextMenuUI.appendOptions(t)}},{key:"onAfterGetRowHeader",value:function(t,e){this.headersUI.appendLevelIndicators(t,e)}},{key:"onModifyRowHeaderWidth",value:function(t){return this.headersUI.rowHeaderWidthCache||t}},{key:"onAfterRemoveRow",value:function(t,e,n,r){var o=this;if(r!==this.pluginName){var i=cst.get(this);setTimeout((function(){i.skipRender=null,o.headersUI.updateRowHeaderWidth(),o.collapsingUI.collapsedRowsStash.applyStash()}),0)}}},{key:"onBeforeRemoveRow",value:function(t,e,n){var r=this,o=Array.from(n.reduce((function(t,e){if(r.dataManager.isParent(e)){var n=r.dataManager.getDataObject(e).__children;return t.add(e),Array.isArray(n)&&n.forEach((function(e){return t.add(r.dataManager.getRowIndex(e))})),t}return t.add(e)}),new Set));n.length=0,n.push.apply(n,o)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var t=Math.max.apply(Math,Wlt(this.dataManager.cache.levels));t>0&&this.headersUI.updateRowHeaderWidth(t)}},{key:"onBeforeViewRender",value:function(t,e){var n=cst.get(this);n.skipRender&&(e.skipRender=!0)}},{key:"destroy",value:function(){Zlt(lst(n.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(t){if(!Wv(t))return nr(fst),this.hot.getSettings()[sst]=!1,void this.disablePlugin();this.dataManager.setData(t),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return sst}},{key:"PLUGIN_PRIORITY",get:function(){return ust}}]),n}(RH);function dst(t){return dst="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dst(t)}function pst(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yst(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mst(r.key),r)}}function vst(t,e,n){return e&&yst(t.prototype,e),n&&yst(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function mst(t){var e=gst(t,"string");return"symbol"===dst(e)?e:String(e)}function gst(t,e){if("object"!==dst(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==dst(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var bst=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;pst(this,t),this.rootWindow=n,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}return vst(t,[{key:"saveValue",value:function(t,e){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(t),JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}},{key:"loadValue",value:function(t,e){var n="undefined"===typeof t?e:t,r=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(n));return null===r?void 0:JSON.parse(r)}},{key:"reset",value:function(t){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(t))}},{key:"resetAll",value:function(){var t=this;U(this.savedKeys,(function(e,n){t.rootWindow.localStorage.removeItem("".concat(t.prefix,"_").concat(t.savedKeys[n]))})),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var t=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),e="string"===typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),t}(),wst=bst;function Sst(t){return Sst="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sst(t)}function Cst(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ost(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Rst(r.key),r)}}function kst(t,e,n){return e&&Ost(t.prototype,e),n&&Ost(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Rst(t){var e=Est(t,"string");return"symbol"===Sst(e)?e:String(e)}function Est(t,e){if("object"!==Sst(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Sst(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Pst(){return Pst="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Tst(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Pst.apply(this,arguments)}function Tst(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Hst(t),null===t)break;return t}function jst(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mst(t,e)}function Mst(t,e){return Mst=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Mst(t,e)}function Ast(t){var e=_st();return function(){var n,r=Hst(t);if(e){var o=Hst(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ist(this,n)}}function Ist(t,e){if(e&&("object"===Sst(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return xst(t)}function xst(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _st(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Hst(t){return Hst=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Hst(t)}mr.getSingleton().register("persistentStateSave"),mr.getSingleton().register("persistentStateLoad"),mr.getSingleton().register("persistentStateReset");var Nst="persistentState",Dst=0,Lst=function(t){jst(n,t);var e=Ast(n);function n(t){var r;return Cst(this,n),r=e.call(this,t),r.storage=void 0,r}return kst(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Nst]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.storage||(this.storage=new wst(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(function(e,n){return t.saveValue(e,n)})),this.addHook("persistentStateLoad",(function(e,n){return t.loadValue(e,n)})),this.addHook("persistentStateReset",(function(){return t.resetValue()})),Pst(Hst(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,Pst(Hst(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Pst(Hst(n.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(t,e){e.value=this.storage.loadValue(t)}},{key:"saveValue",value:function(t,e){this.storage.saveValue(t,e)}},{key:"resetValue",value:function(t){"undefined"===typeof t?this.storage.resetAll():this.storage.reset(t)}},{key:"destroy",value:function(){Pst(Hst(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Nst}},{key:"PLUGIN_PRIORITY",get:function(){return Dst}}]),n}(RH);function Bst(t){return Bst="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bst(t)}function Vst(t){return zst(t)||Ust(t)||Wst(t)||Fst()}function Fst(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Wst(t,e){if(t){if("string"===typeof t)return Gst(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gst(t,e):void 0}}function Ust(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function zst(t){if(Array.isArray(t))return Gst(t)}function Gst(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Yst(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Kst(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$st(r.key),r)}}function Xst(t,e,n){return e&&Kst(t.prototype,e),n&&Kst(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function $st(t){var e=qst(t,"string");return"symbol"===Bst(e)?e:String(e)}function qst(t,e){if("object"!==Bst(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Bst(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Qst(){return Qst="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Jst(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Qst.apply(this,arguments)}function Jst(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=iut(t),null===t)break;return t}function Zst(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tut(t,e)}function tut(t,e){return tut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},tut(t,e)}function eut(t){var e=out();return function(){var n,r=iut(t);if(e){var o=iut(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nut(this,n)}}function nut(t,e){if(e&&("object"===Bst(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return rut(t)}function rut(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function out(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function iut(t){return iut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},iut(t)}var aut="search",lut=190,sut="htSearchResult",uut=function(t,e,n,r,o){t.getCellMeta(e,n).isSearchResult=o},cut=function(t,e,n){return!(te(t)||null===t||!t.toLocaleLowerCase||0===t.length)&&(!te(e)&&null!==e&&-1!==e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale)))},fut=function(t){Zst(n,t);var e=eut(n);function n(t){var r;return Yst(this,n),r=e.call(this,t),r.callback=uut,r.queryMethod=cut,r.searchResultClass=sut,r}return Xst(n,[{key:"isEnabled",value:function(){return this.hot.getSettings()[aut]}},{key:"enablePlugin",value:function(){var t=this;if(!this.enabled){var e=this.hot.getSettings()[aut];this.updatePluginSettings(e),this.addHook("beforeRenderer",(function(){return t.onBeforeRenderer.apply(t,arguments)})),Qst(iut(n.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var t=this,e=function(){return t.onBeforeRenderer.apply(t,arguments)};this.hot.addHook("beforeRenderer",e),this.hot.addHookOnce("afterViewRender",(function(){t.hot.removeHook("beforeRenderer",e)})),Qst(iut(n.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Qst(iut(n.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod(),o=this.hot.countRows(),i=this.hot.countCols(),a=[],l=this.hot;return Ho(0,o-1,(function(o){Ho(0,i-1,(function(i){var s=e.hot.getDataAtCell(o,i),u=e.hot.getCellMeta(o,i),c=u.search.callback||n,f=u.search.queryMethod||r,h=f(t,s,u);if(h){var d={row:o,col:i,data:s};a.push(d)}c&&c(l,o,i,s,h)}))})),a}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(t){this.callback=t}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(t){this.queryMethod=t}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(t){this.searchResultClass=t}},{key:"updatePluginSettings",value:function(t){ht(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}},{key:"onBeforeRenderer",value:function(t,e,n,r,o,i){var a,l=i.className||[],s=[];"string"===typeof l?s=l.split(" "):(a=s).push.apply(a,Vst(l));this.isEnabled()&&i.isSearchResult?s.includes(this.searchResultClass)||s.push("".concat(this.searchResultClass)):s.includes(this.searchResultClass)&&s.splice(s.indexOf(this.searchResultClass),1),i.className=s.join(" ")}},{key:"destroy",value:function(){Qst(iut(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return aut}},{key:"PLUGIN_PRIORITY",get:function(){return lut}}]),n}(RH);function hut(t){return hut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hut(t)}function dut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function put(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vut(r.key),r)}}function yut(t,e,n){return e&&put(t.prototype,e),n&&put(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function vut(t){var e=mut(t,"string");return"symbol"===hut(e)?e:String(e)}function mut(t,e){if("object"!==hut(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==hut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function gut(){return gut="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=but(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},gut.apply(this,arguments)}function but(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=Eut(t),null===t)break;return t}function wut(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sut(t,e)}function Sut(t,e){return Sut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Sut(t,e)}function Cut(t){var e=Rut();return function(){var n,r=Eut(t);if(e){var o=Eut(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Out(this,n)}}function Out(t,e){if(e&&("object"===hut(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return kut(t)}function kut(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Rut(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Eut(t){return Eut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Eut(t)}var Put="touchScroll",Tut=200,jut=function(t){wut(n,t);var e=Cut(n);function n(t){var r;return dut(this,n),r=e.call(this,t),r.scrollbars=[],r.clones=[],r.lockedCollection=!1,r.freezeOverlays=!1,r}return yut(n,[{key:"isEnabled",value:function(){return I()}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.addHook("afterViewRender",(function(){return t.onAfterViewRender()})),this.registerEvents(),gut(Eut(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,gut(Eut(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){gut(Eut(n.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var t=this;this.addHook("beforeTouchScroll",(function(){return t.onBeforeTouchScroll()})),this.addHook("afterMomentumScroll",(function(){return t.onAfterMomentumScroll()}))}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var t=this.hot.view._wt.wtOverlays,e=t.topOverlay,n=t.bottomOverlay,r=t.inlineStartOverlay,o=t.topInlineStartCornerOverlay,i=t.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),n.clone&&this.scrollbars.push(n),this.scrollbars.push(r),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,U(this.clones,(function(t){Ge(t,"hide-tween")}))}},{key:"onAfterMomentumScroll",value:function(){var t=this;this.freezeOverlays=!1,U(this.clones,(function(t){Ye(t,"hide-tween"),Ge(t,"show-tween")})),this.hot._registerTimeout((function(){U(t.clones,(function(t){Ye(t,"show-tween")}))}),400),U(this.scrollbars,(function(t){t.refresh(),t.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return Put}},{key:"PLUGIN_PRIORITY",get:function(){return Tut}},{key:"SETTING_KEYS",get:function(){return!0}}]),n}(RH);function Mut(t){return Mut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mut(t)}function Aut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Iut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_ut(r.key),r)}}function xut(t,e,n){return e&&Iut(t.prototype,e),n&&Iut(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _ut(t){var e=Hut(t,"string");return"symbol"===Mut(e)?e:String(e)}function Hut(t,e){if("object"!==Mut(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Mut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Nut(){return Nut="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=Dut(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Nut.apply(this,arguments)}function Dut(t,e){while(!Object.prototype.hasOwnProperty.call(t,e))if(t=zut(t),null===t)break;return t}function Lut(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&But(t,e)}function But(t,e){return But=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},But(t,e)}function Vut(t){var e=Uut();return function(){var n,r=zut(t);if(e){var o=zut(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Fut(this,n)}}function Fut(t,e){if(e&&("object"===Mut(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Wut(t)}function Wut(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Uut(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function zut(t){return zut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},zut(t)}var Gut="trimRows",Yut=330,Kut=function(t){Lut(n,t);var e=Vut(n);function n(t){var r;return Aut(this,n),r=e.call(this,t),r.trimmedRowsMap=null,r}return xut(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Gut]}},{key:"enablePlugin",value:function(){var t=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Zg),this.trimmedRowsMap.addLocalHook("init",(function(){return t.onMapInit()})),Nut(zut(n.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var t=this,e=this.hot.getSettings()[Gut];Array.isArray(e)&&this.hot.batchExecution((function(){t.trimmedRowsMap.clear(),U(e,(function(e){t.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0),Nut(zut(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),Nut(zut(n.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(t){var e=this,n=this.getTrimmedRows(),r=this.isValidConfig(t),o=n;r&&(o=Array.from(new Set(n.concat(t))));var i=this.hot.runHooks("beforeTrimRow",n,o,r);!1!==i&&(r&&this.hot.batchExecution((function(){U(t,(function(t){e.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),this.hot.runHooks("afterTrimRow",n,o,r,r&&o.length>n.length))}},{key:"trimRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.trimRows(e)}},{key:"untrimRows",value:function(t){var e=this.getTrimmedRows(),n=this.isValidConfig(t),r=e,o=this.trimmedRowsMap.getValues().slice(),i=t.length>0;n&&i&&(U(t,(function(t){o[t]=!1})),r=V(o,(function(t,e,n){return e&&t.push(n),t}),[]));var a=this.hot.runHooks("beforeUntrimRow",e,r,n&&i);!1!==a&&(n&&i&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",e,r,n&&i,n&&r.length<e.length))}},{key:"untrimRow",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.untrimRows(e)}},{key:"isTrimmed",value:function(t){return this.trimmedRowsMap.getValueAtIndex(t)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(t){var e=this.hot.countSourceRows();return t.every((function(t){return Number.isInteger(t)&&t>=0&&t<e}))}},{key:"onMapInit",value:function(){var t=this,e=this.hot.getSettings()[Gut];Array.isArray(e)&&this.hot.batchExecution((function(){U(e,(function(e){t.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0)}},{key:"destroy",value:function(){Nut(zut(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Gut}},{key:"PLUGIN_PRIORITY",get:function(){return Yut}}]),n}(RH);function Xut(t){return Xut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xut(t)}function $ut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Jut(r.key),r)}}function Qut(t,e,n){return e&&qut(t.prototype,e),n&&qut(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Jut(t){var e=Zut(t,"string");return"symbol"===Xut(e)?e:String(e)}function Zut(t,e){if("object"!==Xut(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Xut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function tct(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ect(t,e)}function ect(t,e){return ect=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ect(t,e)}function nct(t){var e=ict();return function(){var n,r=act(t);if(e){var o=act(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rct(this,n)}}function rct(t,e){if(e&&("object"===Xut(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return oct(t)}function oct(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ict(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function act(t){return act=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},act(t)}function lct(t){return cct(t)||uct(t)||dct(t)||sct()}function sct(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function uct(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function cct(t){if(Array.isArray(t))return pct(t)}function fct(t,e){return vct(t)||yct(t,e)||dct(t,e)||hct()}function hct(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function dct(t,e){if(t){if("string"===typeof t)return pct(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pct(t,e):void 0}}function pct(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function yct(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(c){u=!0,o=c}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function vct(t){if(Array.isArray(t))return t}var mct="undoRedo",gct="undoRedo";function bct(t){var e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",(function(n,r){var o=this,i=n&&n.length;if(i){var a=n.find((function(t){var e=fct(t,4),n=e[2],r=e[3];return n!==r}));if(a){var l=function(){var e=n.reduce((function(t,e){return t.push(lct(e)),t}),[]);U(e,(function(e){e[1]=t.propToCol(e[1])}));var r=i>1?o.getSelected():[[e[0][0],e[0][1]]];return new bct.ChangeAction(e,r)};e.done(l,r)}}})),t.addHook("afterCreateRow",(function(t,n,r){e.done((function(){return new bct.CreateRowAction(t,n)}),r)})),t.addHook("beforeRemoveRow",(function(n,r,o,i){var a=function(){var o=t.toPhysicalRow(n),i=st(e.instance.getSourceData(o,0,o+r-1,e.instance.countSourceCols()-1));return new bct.RemoveRowAction(o,i,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(a,i)})),t.addHook("afterCreateCol",(function(t,n,r){e.done((function(){return new bct.CreateColumnAction(t,n)}),r)})),t.addHook("beforeRemoveCol",(function(n,r,o,i){var a=function(){var o=e.instance.getSourceDataArray(),i=(e.instance.countCols()+n)%e.instance.countCols(),a=[],l=[],s=[];Ho(o.length-1,(function(e){var n=[],l=o[e];Ho(i,i+(r-1),(function(e){n.push(l[t.toPhysicalColumn(e)])})),a.push(n)})),Ho(r-1,(function(e){s.push(t.toPhysicalColumn(i+e))})),Array.isArray(t.getSettings().colHeaders)&&Ho(r-1,(function(e){l.push(t.getSettings().colHeaders[t.toPhysicalColumn(i+e)]||null)}));var u=t.columnIndexMapper.getIndexesSequence(),c=t.rowIndexMapper.getIndexesSequence();return new bct.RemoveColumnAction(i,s,a,l,u,c,t.getSettings().fixedColumnsStart)};e.done(a,i)})),t.addHook("beforeCellAlignment",(function(t,n,r,o){e.done((function(){return new bct.CellAlignmentAction(t,n,r,o)}))})),t.addHook("beforeFilter",(function(t){e.done((function(){return new bct.FiltersAction(t)}))})),t.addHook("beforeRowMove",(function(t,n){!1!==t&&e.done((function(){return new bct.RowMoveAction(t,n)}))})),t.addHook("beforeMergeCells",(function(n,r){r||e.done((function(){return new bct.MergeCellsAction(t,n)}))})),t.addHook("afterUnmergeCells",(function(n,r){r||e.done((function(){return new bct.UnmergeCellsAction(t,n)}))})),t.addHook("afterInit",(function(){e.init()}))}bct.prototype.done=function(t,e){if(!this.ignoreNewActions){var n="UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e;if(!n){var r=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",r,e);if(!1!==o){var i=t(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}},bct.prototype.undo=function(){if(this.isUndoAvailable()){var t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);var e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());var n=st(e),r=this.instance.runHooks("beforeUndo",n);if(!1===r)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),e.undo(this.instance,(function(){o.ignoreNewActions=!1,o.undoneActions.push(e)})),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}},bct.prototype.redo=function(){if(this.isRedoAvailable()){var t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);var e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());var n=st(e),r=this.instance.runHooks("beforeRedo",n);if(!1===r)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),e.redo(this.instance,(function(){o.ignoreNewActions=!1,o.doneActions.push(e)})),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}},bct.prototype.isUndoAvailable=function(){return this.doneActions.length>0},bct.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},bct.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},bct.prototype.isEnabled=function(){return this.enabled},bct.prototype.enable=function(){if(!this.isEnabled()){var t=this.instance;this.enabled=!0,Oct(t),this.registerShortcuts(),t.addHook("afterChange",Cct)}},bct.prototype.disable=function(){if(this.isEnabled()){var t=this.instance;this.enabled=!1,kct(t),this.unregisterShortcuts(),t.removeHook("afterChange",Cct)}},bct.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},bct.Action=function(){},bct.Action.prototype.undo=function(){},bct.Action.prototype.redo=function(){},bct.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"},it(bct.ChangeAction,bct.Action),bct.ChangeAction.prototype.undo=function(t,e){for(var n=st(this.changes),r=t.countEmptyRows(!0),o=t.countEmptyCols(!0),i=0,a=n.length;i<a;i++)n[i].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(var l=0,s=n.length;l<s;l++){var u=fct(n[l],2),c=u[0],f=u[1];t.getSettings().minSpareRows&&c+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(c+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&f+1+t.getSettings().minSpareCols===t.countCols()&&o===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(f+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)},bct.ChangeAction.prototype.redo=function(t,e){for(var n=st(this.changes),r=0,o=n.length;r<o;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)},bct.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},it(bct.CreateRowAction,bct.Action),bct.CreateRowAction.prototype.undo=function(t,e){var n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},bct.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},bct.RemoveRowAction=function(t,e,n,r,o){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=o},it(bct.RemoveRowAction,bct.Action),bct.RemoveRowAction.prototype.undo=function(t,e){var n=this,r=t.getSettings(),o=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((function(t,e){Object.keys(t).forEach((function(r){var i=parseInt(r,10);o.push([n.index+e,isNaN(i)?r:i,t[r]])}))})),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},bct.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},bct.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},it(bct.CreateColumnAction,bct.Action),bct.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},bct.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},bct.RemoveColumnAction=function(t,e,n,r,o,i,a){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a},it(bct.RemoveColumnAction,bct.Action),bct.RemoveColumnAction.prototype.undo=function(t,e){var n=this,r=t.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(t,e,r){return r[n.indexes.indexOf(o[e])]},a=this.data.length,l=[],s=0;s<a;s++)l.push(W(this.data[s],i));var u=W(this.headers,i),c=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),U(t.getSourceDataArray(),(function(t,e){U(o,(function(n,r){t[n]=l[e][r],c.push([e,n,t[n]])}))})),t.setSourceDataAtCell(c,void 0,void 0,"UndoRedo.undo"),"undefined"!==typeof this.headers&&U(u,(function(e,n){t.getSettings().colHeaders[o[n]]=e})),t.batchExecution((function(){t.rowIndexMapper.setIndexesSequence(n.rowPositions),t.columnIndexMapper.setIndexesSequence(n.columnPositions)}),!0),t.addHookOnce("afterViewRender",e),t.render()},bct.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},bct.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r},bct.CellAlignmentAction.prototype.undo=function(t,e){var n=this;U(this.range,(function(e){e.forAll((function(e,r){e>=0&&r>=0&&t.setCellMeta(e,r,"className",n.stateBefore[e][r]||" htLeft")}))})),t.addHookOnce("afterViewRender",e),t.render()},bct.CellAlignmentAction.prototype.redo=function(t,e){aW(this.range,this.type,this.alignment,(function(e,n){return t.getCellMeta(e,n)}),(function(e,n,r,o){return t.setCellMeta(e,n,r,o)})),t.addHookOnce("afterViewRender",e),t.render()},bct.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},it(bct.FiltersAction,bct.Action),bct.FiltersAction.prototype.undo=function(t,e){var n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},bct.FiltersAction.prototype.redo=function(t,e){var n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};var wct=function(t){tct(n,t);var e=nct(n);function n(t,r){var o;$ut(this,n),o=e.call(this),o.cellRange=r;var i=o.cellRange.getTopStartCorner(),a=o.cellRange.getBottomEndCorner();return o.rangeData=t.getData(i.row,i.col,a.row,a.col),o}return Qut(n,[{key:"undo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.unmergeRange(this.cellRange,!0);var r=this.cellRange.getTopStartCorner();t.populateFromArray(r.row,r.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.mergeRange(this.cellRange)}}]),n}(bct.Action);bct.MergeCellsAction=wct;var Sct=function(t){tct(n,t);var e=nct(n);function n(t,r){var o;return $ut(this,n),o=e.call(this),o.cellRange=r,o}return Qut(n,[{key:"undo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(t,e){var n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.unmergeRange(this.cellRange,!0),t.render()}}]),n}(bct.Action);function Cct(t,e){var n=this;if("loadData"===e)return n.undoRedo.clear()}function Oct(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function kct(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}bct.UnmergeCellsAction=Sct,bct.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"},it(bct.RowMoveAction,bct.Action),bct.RowMoveAction.prototype.undo=function(t,e){var n=this,r=t.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter((function(t){return t>n.finalIndex})),a=o.filter((function(t){return t<=n.finalIndex})),l=i.sort((function(t,e){return e-t})).concat(a.sort((function(t,e){return t-e})));t.addHookOnce("afterViewRender",e);for(var s=0;s<l.length;s+=1){var u=t.toVisualRow(l[s]);r.moveRow(u,l[s])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},bct.RowMoveAction.prototype.redo=function(t,e){var n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},bct.prototype.init=function(){var t=this.instance.getSettings().undo,e="undefined"===typeof t||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},bct.prototype.registerShortcuts=function(){var t=this,e=this.instance.getShortcutManager(),n=e.getContext("grid"),r=function(t){return!t.altKey},o={runOnlyIf:r,group:mct};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){t.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){t.redo()}}],o)},bct.prototype.unregisterShortcuts=function(){var t=this.instance.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(mct)};var Rct=mr.getSingleton();Rct.add("afterUpdateSettings",(function(){var t;null===(t=this.getPlugin("undoRedo"))||void 0===t||t.init()})),Rct.register("beforeUndo"),Rct.register("afterUndo"),Rct.register("beforeRedo"),Rct.register("afterRedo"),bct.PLUGIN_KEY=gct,bct.SETTING_KEYS=!0;var Ect,Pct,Tct,jct,Mct,Act=bct;function Ict(){Bi(SN),Bi(eD),Bi(ED),Bi(VL),Bi(CB),Bi(fF),Bi(VF),Bi(XW),Bi(Wz),Bi(BY),Bi(MK),Bi(XK),Bi(dX),Bi(C$),Bi(U2),Bi(e6),Bi(W6),Bi(j5),Bi(s4),Bi(R9),Bi(G9),Bi(stt),Bi(Itt),Bi(ant),Bi(Lnt),Bi(nrt),Bi(iat),Bi(hst),Bi(Lst),Bi(fut),Bi(jut),Bi(Kut),Bi(Act)}function xct(){t_(),P_(),V_(),rH(),Ict()}function _ct(t){var e="undefined"!==typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){var n,r=this.first(),o=r.data("handsontable");if("string"!==typeof e){var i=e||{};return o?o.updateSettings(i):(o=new t.Core(r[0],i),r.data("handsontable",o),o.init()),r}if(o){if("undefined"===typeof o[e])throw new Error("Handsontable do not provide action: ".concat(e));for(var a,l=arguments.length,s=new Array(l>1?l-1:0),u=1;u<l;u++)s[u-1]=arguments[u];n=(a=o[e]).call.apply(a,[o].concat(s)),"destroy"===e&&r.removeData()}return n})}xct(),_ct(Kj),Kj.__GhostTable=VH,Kj._getListenersCounter=Yr,Kj._getRegisteredMapsCounter=cb,Kj.EventManager=Gr;var Hct=[o,a,y,m,r,c,l,p,i,s,f,d],Nct=[u,h];Kj.helper={},Kj.dom={},U(Hct,(function(t){U(Object.getOwnPropertyNames(t),(function(e){"_"!==e.charAt(0)&&(Kj.helper[e]=t[e])}))})),U(Nct,(function(t){U(Object.getOwnPropertyNames(t),(function(e){"_"!==e.charAt(0)&&(Kj.dom[e]=t[e])}))})),Kj.cellTypes=null!==(Ect=Kj.cellTypes)&&void 0!==Ect?Ect:{},U(lE(),(function(t){Kj.cellTypes[t]=sE(t)})),Kj.cellTypes.registerCellType=uE,Kj.cellTypes.getCellType=sE,Kj.editors=null!==(Pct=Kj.editors)&&void 0!==Pct?Pct:{},U(Ar(),(function(t){Kj.editors["".concat(be(t),"Editor")]=_r(t)})),Kj.editors.registerEditor=Hr,Kj.editors.getEditor=_r,Kj.renderers=null!==(Tct=Kj.renderers)&&void 0!==Tct?Tct:{},U(Yi(),(function(t){var e=Ki(t);"base"===t&&(Kj.renderers.cellDecorator=e),Kj.renderers["".concat(be(t),"Renderer")]=e})),Kj.renderers.registerRenderer=Xi,Kj.renderers.getRenderer=Ki,Kj.validators=null!==(jct=Kj.validators)&&void 0!==jct?jct:{},U(Zi(),(function(t){Kj.validators["".concat(be(t),"Validator")]=ta(t)})),Kj.validators.registerValidator=ea,Kj.validators.getValidator=ta,Kj.plugins=null!==(Mct=Kj.plugins)&&void 0!==Mct?Mct:{},U(Ni(),(function(t){Kj.plugins[t]=Di(t)})),Kj.plugins["".concat(be(RH.PLUGIN_KEY),"Plugin")]=RH,Kj.plugins.registerPlugin=Bi,Kj.plugins.getPlugin=Di;var Dct=Kj,Lct=function(t,e){var n=e.className;void 0!==n&&Dct.dom.addClass(t,n)},Bct=function(t,e,n,r,o,i,a){var l=document.createElement("div");l.style.width="".concat(10*i,"px"),Lct(e,a),Dct.dom.addClass(l,"progressBar"),Dct.dom.empty(e),e.appendChild(l)},Vct=function(t,e,n,r,o,i,a){Dct.renderers.TextRenderer.apply(this,[t,e,n,r,o,"★".repeat(i),a])},Fct=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]),Wct=function(t,e,n,r,o,i){if(0===n){var a=t.parentElement;null!==a&&(i.instance.getDataAtRowProp(e,"0")?Dct.dom.addClass(a,rA):Dct.dom.removeClass(a,rA),e%2===0?Dct.dom.addClass(a,oA):Dct.dom.removeClass(a,oA))}},Uct=function(t,e){var n=document.createElement("input");n.type="checkbox",t>=0&&this.getDataAtRowProp(t,"0")&&(n.checked=!0),Dct.dom.empty(e),e.appendChild(n)};function zct(t,e){if(!(t<0)){var n=this.isRtl()?"htRight":"htLeft";e.firstChild&&(Fct.has(t.toString())?(Dct.dom.removeClass(e.firstChild,n),Dct.dom.addClass(e.firstChild,Fct.get(t.toString()))):Dct.dom.addClass(e.firstChild,n))}}var Gct=function(t,e){var n=t.target;-1===e.col&&t.target&&"INPUT"===n.nodeName&&(t.preventDefault(),this.setDataAtRowProp(e.row,"0",!n.checked))},Yct={name:"DataGrid",data:function(){return{hotSettings:{height:450,dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,afterOnCellMouseDown:Gct,afterGetColHeader:zct,afterGetRowHeader:Uct,beforeRenderer:Wct,colWidths:[140,192,100,90,90,110,97,100,126],colHeaders:["Company name","Name","Sell date","In stock","Qty","Progress","Rating","Order ID","Country"],columns:[{data:1,type:"text"},{data:3,type:"text"},{data:4,type:"date",allowInvalid:!1},{data:6,type:"checkbox",className:"htCenter"},{data:7,type:"numeric"},{data:8,renderer:Bct,readOnly:!0,className:"htMiddle"},{data:9,renderer:Vct,readOnly:!0,className:"star htCenter"},{data:5,type:"text"},{data:2,type:"text"}],licenseKey:"non-commercial-and-evaluation"},data:iA()}},components:{HotTable:HM}},Kct=Yct,Xct=n(9917),$ct=(0,Xct.Z)(Kct,k,R,!1,null,null,null),qct=$ct.exports,Qct={name:"App",components:{DataGrid:qct}},Jct=Qct,Zct=(0,Xct.Z)(Jct,C,O,!1,null,null,null),tft=Zct.exports;console.log("Handsontable: v".concat(Dct.version," (").concat(Dct.buildDate,") Wrapper: v").concat(HM.version," Vue: v").concat(S.ZP.version)),S.ZP.config.silent=!0,new S.ZP({render:function(t){return t(tft)}}).$mount("#app")},5131:function(t,e,n){var r={"./af":4466,"./af.js":4466,"./ar":9252,"./ar-dz":6520,"./ar-dz.js":6520,"./ar-kw":2358,"./ar-kw.js":2358,"./ar-ly":3229,"./ar-ly.js":3229,"./ar-ma":1707,"./ar-ma.js":1707,"./ar-sa":3237,"./ar-sa.js":3237,"./ar-tn":8206,"./ar-tn.js":8206,"./ar.js":9252,"./az":9665,"./az.js":9665,"./be":2888,"./be.js":2888,"./bg":5945,"./bg.js":5945,"./bm":6375,"./bm.js":6375,"./bn":758,"./bn-bd":533,"./bn-bd.js":533,"./bn.js":758,"./bo":5502,"./bo.js":5502,"./br":70,"./br.js":70,"./bs":295,"./bs.js":295,"./ca":6647,"./ca.js":6647,"./cs":4343,"./cs.js":4343,"./cv":9886,"./cv.js":9886,"./cy":2985,"./cy.js":2985,"./da":139,"./da.js":139,"./de":472,"./de-at":994,"./de-at.js":994,"./de-ch":4824,"./de-ch.js":4824,"./de.js":472,"./dv":9271,"./dv.js":9271,"./el":5195,"./el.js":5195,"./en-au":8847,"./en-au.js":8847,"./en-ca":1348,"./en-ca.js":1348,"./en-gb":9053,"./en-gb.js":9053,"./en-ie":1853,"./en-ie.js":1853,"./en-il":4135,"./en-il.js":4135,"./en-in":7122,"./en-in.js":7122,"./en-nz":3011,"./en-nz.js":3011,"./en-sg":6714,"./en-sg.js":6714,"./eo":197,"./eo.js":197,"./es":4293,"./es-do":8029,"./es-do.js":8029,"./es-mx":1154,"./es-mx.js":1154,"./es-us":8357,"./es-us.js":8357,"./es.js":4293,"./et":6720,"./et.js":6720,"./eu":5808,"./eu.js":5808,"./fa":4924,"./fa.js":4924,"./fi":5949,"./fi.js":5949,"./fil":6108,"./fil.js":6108,"./fo":2687,"./fo.js":2687,"./fr":6724,"./fr-ca":9466,"./fr-ca.js":9466,"./fr-ch":867,"./fr-ch.js":867,"./fr.js":6724,"./fy":9550,"./fy.js":9550,"./ga":4735,"./ga.js":4735,"./gd":9878,"./gd.js":9878,"./gl":9787,"./gl.js":9787,"./gom-deva":6492,"./gom-deva.js":6492,"./gom-latn":5339,"./gom-latn.js":5339,"./gu":836,"./gu.js":836,"./he":9315,"./he.js":9315,"./hi":3724,"./hi.js":3724,"./hr":3730,"./hr.js":3730,"./hu":7657,"./hu.js":7657,"./hy-am":1918,"./hy-am.js":1918,"./id":2215,"./id.js":2215,"./is":4095,"./is.js":4095,"./it":2446,"./it-ch":1947,"./it-ch.js":1947,"./it.js":2446,"./ja":9545,"./ja.js":9545,"./jv":1437,"./jv.js":1437,"./ka":1689,"./ka.js":1689,"./kk":8900,"./kk.js":8900,"./km":5620,"./km.js":5620,"./kn":7081,"./kn.js":7081,"./ko":8130,"./ko.js":8130,"./ku":5295,"./ku.js":5295,"./ky":8578,"./ky.js":8578,"./lb":8773,"./lb.js":8773,"./lo":6366,"./lo.js":6366,"./lt":2532,"./lt.js":2532,"./lv":3902,"./lv.js":3902,"./me":3636,"./me.js":3636,"./mi":4059,"./mi.js":4059,"./mk":6005,"./mk.js":6005,"./ml":2982,"./ml.js":2982,"./mn":5543,"./mn.js":5543,"./mr":4898,"./mr.js":4898,"./ms":4145,"./ms-my":8766,"./ms-my.js":8766,"./ms.js":4145,"./mt":4780,"./mt.js":4780,"./my":3445,"./my.js":3445,"./nb":4372,"./nb.js":4372,"./ne":2862,"./ne.js":2862,"./nl":2254,"./nl-be":3293,"./nl-be.js":3293,"./nl.js":2254,"./nn":6986,"./nn.js":6986,"./oc-lnc":6623,"./oc-lnc.js":6623,"./pa-in":3802,"./pa-in.js":3802,"./pl":2560,"./pl.js":2560,"./pt":6467,"./pt-br":3595,"./pt-br.js":3595,"./pt.js":6467,"./ro":5092,"./ro.js":5092,"./ru":2238,"./ru.js":2238,"./sd":5555,"./sd.js":5555,"./se":7291,"./se.js":7291,"./si":3013,"./si.js":3013,"./sk":7005,"./sk.js":7005,"./sl":284,"./sl.js":284,"./sq":7274,"./sq.js":7274,"./sr":1344,"./sr-cyrl":1521,"./sr-cyrl.js":1521,"./sr.js":1344,"./ss":9573,"./ss.js":9573,"./sv":8865,"./sv.js":8865,"./sw":1769,"./sw.js":1769,"./ta":1108,"./ta.js":1108,"./te":2002,"./te.js":2002,"./tet":3164,"./tet.js":3164,"./tg":6599,"./tg.js":6599,"./th":1806,"./th.js":1806,"./tk":2315,"./tk.js":2315,"./tl-ph":3296,"./tl-ph.js":3296,"./tlh":3102,"./tlh.js":3102,"./tr":5886,"./tr.js":5886,"./tzl":6963,"./tzl.js":6963,"./tzm":1203,"./tzm-latn":4676,"./tzm-latn.js":4676,"./tzm.js":1203,"./ug-cn":1444,"./ug-cn.js":1444,"./uk":2676,"./uk.js":2676,"./ur":5026,"./ur.js":5026,"./uz":9895,"./uz-latn":1873,"./uz-latn.js":1873,"./uz.js":9895,"./vi":5646,"./vi.js":5646,"./x-pseudo":7377,"./x-pseudo.js":7377,"./yo":9632,"./yo.js":9632,"./zh-cn":5665,"./zh-cn.js":5665,"./zh-hk":627,"./zh-hk.js":627,"./zh-mo":7922,"./zh-mo.js":7922,"./zh-tw":8973,"./zh-tw.js":8973};function o(t){var e=i(t);return n(e)}function i(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}o.keys=function(){return Object.keys(r)},o.resolve=i,t.exports=o,o.id=5131}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=t,function(){var t=[];n.O=function(e,r,o,i){if(!r){var a=1/0;for(c=0;c<t.length;c++){r=t[c][0],o=t[c][1],i=t[c][2];for(var l=!0,s=0;s<r.length;s++)(!1&i||a>=i)&&Object.keys(n.O).every((function(t){return n.O[t](r[s])}))?r.splice(s--,1):(l=!1,i<a&&(a=i));if(l){t.splice(c--,1);var u=o();void 0!==u&&(e=u)}}return e}i=i||0;for(var c=t.length;c>0&&t[c-1][2]>i;c--)t[c]=t[c-1];t[c]=[r,o,i]}}(),function(){n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,r){var o,i,a=r[0],l=r[1],s=r[2],u=0;if(a.some((function(e){return 0!==t[e]}))){for(o in l)n.o(l,o)&&(n.m[o]=l[o]);if(s)var c=s(n)}for(e&&e(r);u<a.length;u++)i=a[u],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(c)},r=self["webpackChunkvue_template"]=self["webpackChunkvue_template"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(1093)}));r=n.O(r)})();
//# sourceMappingURL=app.6a28f691.js.map