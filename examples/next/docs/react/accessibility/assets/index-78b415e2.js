var mG=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Lbe=mG((Jbe,Vp)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Zi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function gL(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var mL={exports:{}},uv={},pL={exports:{}},ot={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bf=Symbol.for("react.element"),pG=Symbol.for("react.portal"),wG=Symbol.for("react.fragment"),vG=Symbol.for("react.strict_mode"),CG=Symbol.for("react.profiler"),yG=Symbol.for("react.provider"),SG=Symbol.for("react.context"),bG=Symbol.for("react.forward_ref"),RG=Symbol.for("react.suspense"),EG=Symbol.for("react.memo"),TG=Symbol.for("react.lazy"),lx=Symbol.iterator;function _G(t){return t===null||typeof t!="object"?null:(t=lx&&t[lx]||t["@@iterator"],typeof t=="function"?t:null)}var wL={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vL=Object.assign,CL={};function rh(t,e,n){this.props=t,this.context=e,this.refs=CL,this.updater=n||wL}rh.prototype.isReactComponent={};rh.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};rh.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function yL(){}yL.prototype=rh.prototype;function cE(t,e,n){this.props=t,this.context=e,this.refs=CL,this.updater=n||wL}var hE=cE.prototype=new yL;hE.constructor=cE;vL(hE,rh.prototype);hE.isPureReactComponent=!0;var ux=Array.isArray,SL=Object.prototype.hasOwnProperty,dE={current:null},bL={key:!0,ref:!0,__self:!0,__source:!0};function RL(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)SL.call(e,r)&&!bL.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Bf,type:t,key:o,ref:s,props:i,_owner:dE.current}}function MG(t,e){return{$$typeof:Bf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function fE(t){return typeof t=="object"&&t!==null&&t.$$typeof===Bf}function xG(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var cx=/\/+/g;function WC(t,e){return typeof t=="object"&&t!==null&&t.key!=null?xG(""+t.key):e.toString(36)}function rp(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case Bf:case pG:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+WC(s,0):r,ux(i)?(n="",t!=null&&(n=t.replace(cx,"$&/")+"/"),rp(i,e,n,"",function(u){return u})):i!=null&&(fE(i)&&(i=MG(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(cx,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",ux(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+WC(o,a);s+=rp(o,e,n,l,i)}else if(l=_G(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+WC(o,a++),s+=rp(o,e,n,l,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Cg(t,e,n){if(t==null)return t;var r=[],i=0;return rp(t,r,"","",function(o){return e.call(n,o,i++)}),r}function PG(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var br={current:null},ip={transition:null},OG={ReactCurrentDispatcher:br,ReactCurrentBatchConfig:ip,ReactCurrentOwner:dE};ot.Children={map:Cg,forEach:function(t,e,n){Cg(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Cg(t,function(){e++}),e},toArray:function(t){return Cg(t,function(e){return e})||[]},only:function(t){if(!fE(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ot.Component=rh;ot.Fragment=wG;ot.Profiler=CG;ot.PureComponent=cE;ot.StrictMode=vG;ot.Suspense=RG;ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OG;ot.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=vL({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=dE.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)SL.call(e,l)&&!bL.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Bf,type:t.type,key:i,ref:o,props:r,_owner:s}};ot.createContext=function(t){return t={$$typeof:SG,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:yG,_context:t},t.Consumer=t};ot.createElement=RL;ot.createFactory=function(t){var e=RL.bind(null,t);return e.type=t,e};ot.createRef=function(){return{current:null}};ot.forwardRef=function(t){return{$$typeof:bG,render:t}};ot.isValidElement=fE;ot.lazy=function(t){return{$$typeof:TG,_payload:{_status:-1,_result:t},_init:PG}};ot.memo=function(t,e){return{$$typeof:EG,type:t,compare:e===void 0?null:e}};ot.startTransition=function(t){var e=ip.transition;ip.transition={};try{t()}finally{ip.transition=e}};ot.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ot.useCallback=function(t,e){return br.current.useCallback(t,e)};ot.useContext=function(t){return br.current.useContext(t)};ot.useDebugValue=function(){};ot.useDeferredValue=function(t){return br.current.useDeferredValue(t)};ot.useEffect=function(t,e){return br.current.useEffect(t,e)};ot.useId=function(){return br.current.useId()};ot.useImperativeHandle=function(t,e,n){return br.current.useImperativeHandle(t,e,n)};ot.useInsertionEffect=function(t,e){return br.current.useInsertionEffect(t,e)};ot.useLayoutEffect=function(t,e){return br.current.useLayoutEffect(t,e)};ot.useMemo=function(t,e){return br.current.useMemo(t,e)};ot.useReducer=function(t,e,n){return br.current.useReducer(t,e,n)};ot.useRef=function(t){return br.current.useRef(t)};ot.useState=function(t){return br.current.useState(t)};ot.useSyncExternalStore=function(t,e,n){return br.current.useSyncExternalStore(t,e,n)};ot.useTransition=function(){return br.current.useTransition()};ot.version="18.2.0";pL.exports=ot;var cv=pL.exports;const wn=Vf(cv);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AG=cv,IG=Symbol.for("react.element"),HG=Symbol.for("react.fragment"),DG=Object.prototype.hasOwnProperty,NG=AG.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kG={key:!0,ref:!0,__self:!0,__source:!0};function EL(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)DG.call(e,r)&&!kG.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:IG,type:t,key:o,ref:s,props:i,_owner:NG.current}}uv.Fragment=HG;uv.jsx=EL;uv.jsxs=EL;mL.exports=uv;var we=mL.exports,Qb={},TL={exports:{}},ii={},_L={exports:{}},ML={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(R,d){var m=R.length;R.push(d);e:for(;0<m;){var w=m-1>>>1,x=R[w];if(0<i(x,d))R[w]=d,R[m]=x,m=w;else break e}}function n(R){return R.length===0?null:R[0]}function r(R){if(R.length===0)return null;var d=R[0],m=R.pop();if(m!==d){R[0]=m;e:for(var w=0,x=R.length,O=x>>>1;w<O;){var H=2*(w+1)-1,K=R[H],B=H+1,Q=R[B];if(0>i(K,m))B<x&&0>i(Q,K)?(R[w]=Q,R[B]=m,w=B):(R[w]=K,R[H]=m,w=H);else if(B<x&&0>i(Q,m))R[w]=Q,R[B]=m,w=B;else break e}}return d}function i(R,d){var m=R.sortIndex-d.sortIndex;return m!==0?m:R.id-d.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var l=[],u=[],c=1,h=null,f=3,g=!1,p=!1,y=!1,E=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(R){for(var d=n(u);d!==null;){if(d.callback===null)r(u);else if(d.startTime<=R)r(u),d.sortIndex=d.expirationTime,e(l,d);else break;d=n(u)}}function T(R){if(y=!1,S(R),!p)if(n(l)!==null)p=!0,Ve(_);else{var d=n(u);d!==null&&ke(T,d.startTime-R)}}function _(R,d){p=!1,y&&(y=!1,v(U),U=-1),g=!0;var m=f;try{for(S(d),h=n(l);h!==null&&(!(h.expirationTime>d)||R&&!Z());){var w=h.callback;if(typeof w=="function"){h.callback=null,f=h.priorityLevel;var x=w(h.expirationTime<=d);d=t.unstable_now(),typeof x=="function"?h.callback=x:h===n(l)&&r(l),S(d)}else r(l);h=n(l)}if(h!==null)var O=!0;else{var H=n(u);H!==null&&ke(T,H.startTime-d),O=!1}return O}finally{h=null,f=m,g=!1}}var A=!1,D=null,U=-1,z=5,G=-1;function Z(){return!(t.unstable_now()-G<z)}function re(){if(D!==null){var R=t.unstable_now();G=R;var d=!0;try{d=D(!0,R)}finally{d?ne():(A=!1,D=null)}}else A=!1}var ne;if(typeof C=="function")ne=function(){C(re)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,Me=he.port2;he.port1.onmessage=re,ne=function(){Me.postMessage(null)}}else ne=function(){E(re,0)};function Ve(R){D=R,A||(A=!0,ne())}function ke(R,d){U=E(function(){R(t.unstable_now())},d)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(R){R.callback=null},t.unstable_continueExecution=function(){p||g||(p=!0,Ve(_))},t.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<R?Math.floor(1e3/R):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(R){switch(f){case 1:case 2:case 3:var d=3;break;default:d=f}var m=f;f=d;try{return R()}finally{f=m}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(R,d){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var m=f;f=R;try{return d()}finally{f=m}},t.unstable_scheduleCallback=function(R,d,m){var w=t.unstable_now();switch(typeof m=="object"&&m!==null?(m=m.delay,m=typeof m=="number"&&0<m?w+m:w):m=w,R){case 1:var x=-1;break;case 2:x=250;break;case 5:x=1073741823;break;case 4:x=1e4;break;default:x=5e3}return x=m+x,R={id:c++,callback:d,priorityLevel:R,startTime:m,expirationTime:x,sortIndex:-1},m>w?(R.sortIndex=m,e(u,R),n(l)===null&&R===n(u)&&(y?(v(U),U=-1):y=!0,ke(T,m-w))):(R.sortIndex=x,e(l,R),p||g||(p=!0,Ve(_))),R},t.unstable_shouldYield=Z,t.unstable_wrapCallback=function(R){var d=f;return function(){var m=f;f=d;try{return R.apply(this,arguments)}finally{f=m}}}})(ML);_L.exports=ML;var LG=_L.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xL=cv,ti=LG;function ie(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var PL=new Set,tf={};function ou(t,e){Uc(t,e),Uc(t+"Capture",e)}function Uc(t,e){for(tf[t]=e,t=0;t<e.length;t++)PL.add(e[t])}var As=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zb=Object.prototype.hasOwnProperty,$G=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,hx={},dx={};function FG(t){return Zb.call(dx,t)?!0:Zb.call(hx,t)?!1:$G.test(t)?dx[t]=!0:(hx[t]=!0,!1)}function WG(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function VG(t,e,n,r){if(e===null||typeof e>"u"||WG(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Rr(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var Bn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Bn[t]=new Rr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Bn[e]=new Rr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Bn[t]=new Rr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Bn[t]=new Rr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Bn[t]=new Rr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Bn[t]=new Rr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Bn[t]=new Rr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Bn[t]=new Rr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Bn[t]=new Rr(t,5,!1,t.toLowerCase(),null,!1,!1)});var gE=/[\-:]([a-z])/g;function mE(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(gE,mE);Bn[e]=new Rr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(gE,mE);Bn[e]=new Rr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(gE,mE);Bn[e]=new Rr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Bn[t]=new Rr(t,1,!1,t.toLowerCase(),null,!1,!1)});Bn.xlinkHref=new Rr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Bn[t]=new Rr(t,1,!1,t.toLowerCase(),null,!0,!0)});function pE(t,e,n,r){var i=Bn.hasOwnProperty(e)?Bn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(VG(e,n,i,r)&&(n=null),r||i===null?FG(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Fs=xL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,yg=Symbol.for("react.element"),dc=Symbol.for("react.portal"),fc=Symbol.for("react.fragment"),wE=Symbol.for("react.strict_mode"),Jb=Symbol.for("react.profiler"),OL=Symbol.for("react.provider"),AL=Symbol.for("react.context"),vE=Symbol.for("react.forward_ref"),e0=Symbol.for("react.suspense"),t0=Symbol.for("react.suspense_list"),CE=Symbol.for("react.memo"),ca=Symbol.for("react.lazy"),IL=Symbol.for("react.offscreen"),fx=Symbol.iterator;function Ch(t){return t===null||typeof t!="object"?null:(t=fx&&t[fx]||t["@@iterator"],typeof t=="function"?t:null)}var Jt=Object.assign,VC;function gd(t){if(VC===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);VC=e&&e[1]||""}return`
`+VC+t}var BC=!1;function UC(t,e){if(!t||BC)return"";BC=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var l=`
`+i[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=a);break}}}finally{BC=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?gd(t):""}function BG(t){switch(t.tag){case 5:return gd(t.type);case 16:return gd("Lazy");case 13:return gd("Suspense");case 19:return gd("SuspenseList");case 0:case 2:case 15:return t=UC(t.type,!1),t;case 11:return t=UC(t.type.render,!1),t;case 1:return t=UC(t.type,!0),t;default:return""}}function n0(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case fc:return"Fragment";case dc:return"Portal";case Jb:return"Profiler";case wE:return"StrictMode";case e0:return"Suspense";case t0:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case AL:return(t.displayName||"Context")+".Consumer";case OL:return(t._context.displayName||"Context")+".Provider";case vE:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case CE:return e=t.displayName||null,e!==null?e:n0(t.type)||"Memo";case ca:e=t._payload,t=t._init;try{return n0(t(e))}catch{}}return null}function UG(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return n0(e);case 8:return e===wE?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Va(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function HL(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function zG(t){var e=HL(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Sg(t){t._valueTracker||(t._valueTracker=zG(t))}function DL(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=HL(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Bp(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function r0(t,e){var n=e.checked;return Jt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function gx(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Va(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function NL(t,e){e=e.checked,e!=null&&pE(t,"checked",e,!1)}function i0(t,e){NL(t,e);var n=Va(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?o0(t,e.type,n):e.hasOwnProperty("defaultValue")&&o0(t,e.type,Va(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function mx(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function o0(t,e,n){(e!=="number"||Bp(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var md=Array.isArray;function Oc(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Va(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function s0(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ie(91));return Jt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function px(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ie(92));if(md(n)){if(1<n.length)throw Error(ie(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Va(n)}}function kL(t,e){var n=Va(e.value),r=Va(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function wx(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function LL(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function a0(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?LL(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var bg,$L=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(bg=bg||document.createElement("div"),bg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=bg.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function nf(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ed={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},GG=["Webkit","ms","Moz","O"];Object.keys(Ed).forEach(function(t){GG.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ed[e]=Ed[t]})});function FL(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ed.hasOwnProperty(t)&&Ed[t]?(""+e).trim():e+"px"}function WL(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=FL(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var jG=Jt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function l0(t,e){if(e){if(jG[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ie(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ie(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ie(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ie(62))}}function u0(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var c0=null;function yE(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var h0=null,Ac=null,Ic=null;function vx(t){if(t=Gf(t)){if(typeof h0!="function")throw Error(ie(280));var e=t.stateNode;e&&(e=mv(e),h0(t.stateNode,t.type,e))}}function VL(t){Ac?Ic?Ic.push(t):Ic=[t]:Ac=t}function BL(){if(Ac){var t=Ac,e=Ic;if(Ic=Ac=null,vx(t),e)for(t=0;t<e.length;t++)vx(e[t])}}function UL(t,e){return t(e)}function zL(){}var zC=!1;function GL(t,e,n){if(zC)return t(e,n);zC=!0;try{return UL(t,e,n)}finally{zC=!1,(Ac!==null||Ic!==null)&&(zL(),BL())}}function rf(t,e){var n=t.stateNode;if(n===null)return null;var r=mv(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ie(231,e,typeof n));return n}var d0=!1;if(As)try{var yh={};Object.defineProperty(yh,"passive",{get:function(){d0=!0}}),window.addEventListener("test",yh,yh),window.removeEventListener("test",yh,yh)}catch{d0=!1}function YG(t,e,n,r,i,o,s,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var Td=!1,Up=null,zp=!1,f0=null,KG={onError:function(t){Td=!0,Up=t}};function XG(t,e,n,r,i,o,s,a,l){Td=!1,Up=null,YG.apply(KG,arguments)}function qG(t,e,n,r,i,o,s,a,l){if(XG.apply(this,arguments),Td){if(Td){var u=Up;Td=!1,Up=null}else throw Error(ie(198));zp||(zp=!0,f0=u)}}function su(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function jL(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Cx(t){if(su(t)!==t)throw Error(ie(188))}function QG(t){var e=t.alternate;if(!e){if(e=su(t),e===null)throw Error(ie(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return Cx(i),t;if(o===r)return Cx(i),e;o=o.sibling}throw Error(ie(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(ie(189))}}if(n.alternate!==r)throw Error(ie(190))}if(n.tag!==3)throw Error(ie(188));return n.stateNode.current===n?t:e}function YL(t){return t=QG(t),t!==null?KL(t):null}function KL(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=KL(t);if(e!==null)return e;t=t.sibling}return null}var XL=ti.unstable_scheduleCallback,yx=ti.unstable_cancelCallback,ZG=ti.unstable_shouldYield,JG=ti.unstable_requestPaint,un=ti.unstable_now,ej=ti.unstable_getCurrentPriorityLevel,SE=ti.unstable_ImmediatePriority,qL=ti.unstable_UserBlockingPriority,Gp=ti.unstable_NormalPriority,tj=ti.unstable_LowPriority,QL=ti.unstable_IdlePriority,hv=null,Lo=null;function nj(t){if(Lo&&typeof Lo.onCommitFiberRoot=="function")try{Lo.onCommitFiberRoot(hv,t,void 0,(t.current.flags&128)===128)}catch{}}var Ji=Math.clz32?Math.clz32:oj,rj=Math.log,ij=Math.LN2;function oj(t){return t>>>=0,t===0?32:31-(rj(t)/ij|0)|0}var Rg=64,Eg=4194304;function pd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function jp(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=pd(a):(o&=s,o!==0&&(r=pd(o)))}else s=n&~i,s!==0?r=pd(s):o!==0&&(r=pd(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ji(e),i=1<<n,r|=t[n],e&=~i;return r}function sj(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function aj(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-Ji(o),a=1<<s,l=i[s];l===-1?(!(a&n)||a&r)&&(i[s]=sj(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function g0(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ZL(){var t=Rg;return Rg<<=1,!(Rg&4194240)&&(Rg=64),t}function GC(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Uf(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ji(e),t[e]=n}function lj(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ji(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function bE(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ji(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ct=0;function JL(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var e$,RE,t$,n$,r$,m0=!1,Tg=[],Ma=null,xa=null,Pa=null,of=new Map,sf=new Map,fa=[],uj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sx(t,e){switch(t){case"focusin":case"focusout":Ma=null;break;case"dragenter":case"dragleave":xa=null;break;case"mouseover":case"mouseout":Pa=null;break;case"pointerover":case"pointerout":of.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":sf.delete(e.pointerId)}}function Sh(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=Gf(e),e!==null&&RE(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function cj(t,e,n,r,i){switch(e){case"focusin":return Ma=Sh(Ma,t,e,n,r,i),!0;case"dragenter":return xa=Sh(xa,t,e,n,r,i),!0;case"mouseover":return Pa=Sh(Pa,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return of.set(o,Sh(of.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,sf.set(o,Sh(sf.get(o)||null,t,e,n,r,i)),!0}return!1}function i$(t){var e=kl(t.target);if(e!==null){var n=su(e);if(n!==null){if(e=n.tag,e===13){if(e=jL(n),e!==null){t.blockedOn=e,r$(t.priority,function(){t$(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function op(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=p0(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);c0=r,n.target.dispatchEvent(r),c0=null}else return e=Gf(n),e!==null&&RE(e),t.blockedOn=n,!1;e.shift()}return!0}function bx(t,e,n){op(t)&&n.delete(e)}function hj(){m0=!1,Ma!==null&&op(Ma)&&(Ma=null),xa!==null&&op(xa)&&(xa=null),Pa!==null&&op(Pa)&&(Pa=null),of.forEach(bx),sf.forEach(bx)}function bh(t,e){t.blockedOn===e&&(t.blockedOn=null,m0||(m0=!0,ti.unstable_scheduleCallback(ti.unstable_NormalPriority,hj)))}function af(t){function e(i){return bh(i,t)}if(0<Tg.length){bh(Tg[0],t);for(var n=1;n<Tg.length;n++){var r=Tg[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ma!==null&&bh(Ma,t),xa!==null&&bh(xa,t),Pa!==null&&bh(Pa,t),of.forEach(e),sf.forEach(e),n=0;n<fa.length;n++)r=fa[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<fa.length&&(n=fa[0],n.blockedOn===null);)i$(n),n.blockedOn===null&&fa.shift()}var Hc=Fs.ReactCurrentBatchConfig,Yp=!0;function dj(t,e,n,r){var i=Ct,o=Hc.transition;Hc.transition=null;try{Ct=1,EE(t,e,n,r)}finally{Ct=i,Hc.transition=o}}function fj(t,e,n,r){var i=Ct,o=Hc.transition;Hc.transition=null;try{Ct=4,EE(t,e,n,r)}finally{Ct=i,Hc.transition=o}}function EE(t,e,n,r){if(Yp){var i=p0(t,e,n,r);if(i===null)ty(t,e,r,Kp,n),Sx(t,r);else if(cj(i,t,e,n,r))r.stopPropagation();else if(Sx(t,r),e&4&&-1<uj.indexOf(t)){for(;i!==null;){var o=Gf(i);if(o!==null&&e$(o),o=p0(t,e,n,r),o===null&&ty(t,e,r,Kp,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else ty(t,e,r,null,n)}}var Kp=null;function p0(t,e,n,r){if(Kp=null,t=yE(r),t=kl(t),t!==null)if(e=su(t),e===null)t=null;else if(n=e.tag,n===13){if(t=jL(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Kp=t,null}function o$(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ej()){case SE:return 1;case qL:return 4;case Gp:case tj:return 16;case QL:return 536870912;default:return 16}default:return 16}}var ya=null,TE=null,sp=null;function s$(){if(sp)return sp;var t,e=TE,n=e.length,r,i="value"in ya?ya.value:ya.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return sp=i.slice(t,1<r?1-r:void 0)}function ap(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function _g(){return!0}function Rx(){return!1}function oi(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?_g:Rx,this.isPropagationStopped=Rx,this}return Jt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=_g)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=_g)},persist:function(){},isPersistent:_g}),e}var ih={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_E=oi(ih),zf=Jt({},ih,{view:0,detail:0}),gj=oi(zf),jC,YC,Rh,dv=Jt({},zf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ME,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Rh&&(Rh&&t.type==="mousemove"?(jC=t.screenX-Rh.screenX,YC=t.screenY-Rh.screenY):YC=jC=0,Rh=t),jC)},movementY:function(t){return"movementY"in t?t.movementY:YC}}),Ex=oi(dv),mj=Jt({},dv,{dataTransfer:0}),pj=oi(mj),wj=Jt({},zf,{relatedTarget:0}),KC=oi(wj),vj=Jt({},ih,{animationName:0,elapsedTime:0,pseudoElement:0}),Cj=oi(vj),yj=Jt({},ih,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Sj=oi(yj),bj=Jt({},ih,{data:0}),Tx=oi(bj),Rj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ej={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _j(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Tj[t])?!!e[t]:!1}function ME(){return _j}var Mj=Jt({},zf,{key:function(t){if(t.key){var e=Rj[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ap(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Ej[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ME,charCode:function(t){return t.type==="keypress"?ap(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ap(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),xj=oi(Mj),Pj=Jt({},dv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_x=oi(Pj),Oj=Jt({},zf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ME}),Aj=oi(Oj),Ij=Jt({},ih,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hj=oi(Ij),Dj=Jt({},dv,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Nj=oi(Dj),kj=[9,13,27,32],xE=As&&"CompositionEvent"in window,_d=null;As&&"documentMode"in document&&(_d=document.documentMode);var Lj=As&&"TextEvent"in window&&!_d,a$=As&&(!xE||_d&&8<_d&&11>=_d),Mx=String.fromCharCode(32),xx=!1;function l$(t,e){switch(t){case"keyup":return kj.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function u$(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var gc=!1;function $j(t,e){switch(t){case"compositionend":return u$(e);case"keypress":return e.which!==32?null:(xx=!0,Mx);case"textInput":return t=e.data,t===Mx&&xx?null:t;default:return null}}function Fj(t,e){if(gc)return t==="compositionend"||!xE&&l$(t,e)?(t=s$(),sp=TE=ya=null,gc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return a$&&e.locale!=="ko"?null:e.data;default:return null}}var Wj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Px(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Wj[t.type]:e==="textarea"}function c$(t,e,n,r){VL(r),e=Xp(e,"onChange"),0<e.length&&(n=new _E("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Md=null,lf=null;function Vj(t){S$(t,0)}function fv(t){var e=wc(t);if(DL(e))return t}function Bj(t,e){if(t==="change")return e}var h$=!1;if(As){var XC;if(As){var qC="oninput"in document;if(!qC){var Ox=document.createElement("div");Ox.setAttribute("oninput","return;"),qC=typeof Ox.oninput=="function"}XC=qC}else XC=!1;h$=XC&&(!document.documentMode||9<document.documentMode)}function Ax(){Md&&(Md.detachEvent("onpropertychange",d$),lf=Md=null)}function d$(t){if(t.propertyName==="value"&&fv(lf)){var e=[];c$(e,lf,t,yE(t)),GL(Vj,e)}}function Uj(t,e,n){t==="focusin"?(Ax(),Md=e,lf=n,Md.attachEvent("onpropertychange",d$)):t==="focusout"&&Ax()}function zj(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return fv(lf)}function Gj(t,e){if(t==="click")return fv(e)}function jj(t,e){if(t==="input"||t==="change")return fv(e)}function Yj(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var no=typeof Object.is=="function"?Object.is:Yj;function uf(t,e){if(no(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Zb.call(e,i)||!no(t[i],e[i]))return!1}return!0}function Ix(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Hx(t,e){var n=Ix(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ix(n)}}function f$(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?f$(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function g$(){for(var t=window,e=Bp();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Bp(t.document)}return e}function PE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Kj(t){var e=g$(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&f$(n.ownerDocument.documentElement,n)){if(r!==null&&PE(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=Hx(n,o);var s=Hx(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Xj=As&&"documentMode"in document&&11>=document.documentMode,mc=null,w0=null,xd=null,v0=!1;function Dx(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;v0||mc==null||mc!==Bp(r)||(r=mc,"selectionStart"in r&&PE(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),xd&&uf(xd,r)||(xd=r,r=Xp(w0,"onSelect"),0<r.length&&(e=new _E("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=mc)))}function Mg(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var pc={animationend:Mg("Animation","AnimationEnd"),animationiteration:Mg("Animation","AnimationIteration"),animationstart:Mg("Animation","AnimationStart"),transitionend:Mg("Transition","TransitionEnd")},QC={},m$={};As&&(m$=document.createElement("div").style,"AnimationEvent"in window||(delete pc.animationend.animation,delete pc.animationiteration.animation,delete pc.animationstart.animation),"TransitionEvent"in window||delete pc.transitionend.transition);function gv(t){if(QC[t])return QC[t];if(!pc[t])return t;var e=pc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in m$)return QC[t]=e[n];return t}var p$=gv("animationend"),w$=gv("animationiteration"),v$=gv("animationstart"),C$=gv("transitionend"),y$=new Map,Nx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qa(t,e){y$.set(t,e),ou(e,[t])}for(var ZC=0;ZC<Nx.length;ZC++){var JC=Nx[ZC],qj=JC.toLowerCase(),Qj=JC[0].toUpperCase()+JC.slice(1);qa(qj,"on"+Qj)}qa(p$,"onAnimationEnd");qa(w$,"onAnimationIteration");qa(v$,"onAnimationStart");qa("dblclick","onDoubleClick");qa("focusin","onFocus");qa("focusout","onBlur");qa(C$,"onTransitionEnd");Uc("onMouseEnter",["mouseout","mouseover"]);Uc("onMouseLeave",["mouseout","mouseover"]);Uc("onPointerEnter",["pointerout","pointerover"]);Uc("onPointerLeave",["pointerout","pointerover"]);ou("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ou("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ou("onBeforeInput",["compositionend","keypress","textInput","paste"]);ou("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ou("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ou("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zj=new Set("cancel close invalid load scroll toggle".split(" ").concat(wd));function kx(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,qG(r,e,void 0,t),t.currentTarget=null}function S$(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;kx(i,a,u),o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,u=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;kx(i,a,u),o=l}}}if(zp)throw t=f0,zp=!1,f0=null,t}function At(t,e){var n=e[R0];n===void 0&&(n=e[R0]=new Set);var r=t+"__bubble";n.has(r)||(b$(e,t,2,!1),n.add(r))}function ey(t,e,n){var r=0;e&&(r|=4),b$(n,t,r,e)}var xg="_reactListening"+Math.random().toString(36).slice(2);function cf(t){if(!t[xg]){t[xg]=!0,PL.forEach(function(n){n!=="selectionchange"&&(Zj.has(n)||ey(n,!1,t),ey(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[xg]||(e[xg]=!0,ey("selectionchange",!1,e))}}function b$(t,e,n,r){switch(o$(e)){case 1:var i=dj;break;case 4:i=fj;break;default:i=EE}n=i.bind(null,e,n,t),i=void 0,!d0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function ty(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;a!==null;){if(s=kl(a),s===null)return;if(l=s.tag,l===5||l===6){r=o=s;continue e}a=a.parentNode}}r=r.return}GL(function(){var u=o,c=yE(n),h=[];e:{var f=y$.get(t);if(f!==void 0){var g=_E,p=t;switch(t){case"keypress":if(ap(n)===0)break e;case"keydown":case"keyup":g=xj;break;case"focusin":p="focus",g=KC;break;case"focusout":p="blur",g=KC;break;case"beforeblur":case"afterblur":g=KC;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Ex;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=pj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=Aj;break;case p$:case w$:case v$:g=Cj;break;case C$:g=Hj;break;case"scroll":g=gj;break;case"wheel":g=Nj;break;case"copy":case"cut":case"paste":g=Sj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=_x}var y=(e&4)!==0,E=!y&&t==="scroll",v=y?f!==null?f+"Capture":null:f;y=[];for(var C=u,S;C!==null;){S=C;var T=S.stateNode;if(S.tag===5&&T!==null&&(S=T,v!==null&&(T=rf(C,v),T!=null&&y.push(hf(C,T,S)))),E)break;C=C.return}0<y.length&&(f=new g(f,p,null,n,c),h.push({event:f,listeners:y}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",f&&n!==c0&&(p=n.relatedTarget||n.fromElement)&&(kl(p)||p[Is]))break e;if((g||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,g?(p=n.relatedTarget||n.toElement,g=u,p=p?kl(p):null,p!==null&&(E=su(p),p!==E||p.tag!==5&&p.tag!==6)&&(p=null)):(g=null,p=u),g!==p)){if(y=Ex,T="onMouseLeave",v="onMouseEnter",C="mouse",(t==="pointerout"||t==="pointerover")&&(y=_x,T="onPointerLeave",v="onPointerEnter",C="pointer"),E=g==null?f:wc(g),S=p==null?f:wc(p),f=new y(T,C+"leave",g,n,c),f.target=E,f.relatedTarget=S,T=null,kl(c)===u&&(y=new y(v,C+"enter",p,n,c),y.target=S,y.relatedTarget=E,T=y),E=T,g&&p)t:{for(y=g,v=p,C=0,S=y;S;S=Cu(S))C++;for(S=0,T=v;T;T=Cu(T))S++;for(;0<C-S;)y=Cu(y),C--;for(;0<S-C;)v=Cu(v),S--;for(;C--;){if(y===v||v!==null&&y===v.alternate)break t;y=Cu(y),v=Cu(v)}y=null}else y=null;g!==null&&Lx(h,f,g,y,!1),p!==null&&E!==null&&Lx(h,E,p,y,!0)}}e:{if(f=u?wc(u):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var _=Bj;else if(Px(f))if(h$)_=jj;else{_=zj;var A=Uj}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(_=Gj);if(_&&(_=_(t,u))){c$(h,_,n,c);break e}A&&A(t,f,u),t==="focusout"&&(A=f._wrapperState)&&A.controlled&&f.type==="number"&&o0(f,"number",f.value)}switch(A=u?wc(u):window,t){case"focusin":(Px(A)||A.contentEditable==="true")&&(mc=A,w0=u,xd=null);break;case"focusout":xd=w0=mc=null;break;case"mousedown":v0=!0;break;case"contextmenu":case"mouseup":case"dragend":v0=!1,Dx(h,n,c);break;case"selectionchange":if(Xj)break;case"keydown":case"keyup":Dx(h,n,c)}var D;if(xE)e:{switch(t){case"compositionstart":var U="onCompositionStart";break e;case"compositionend":U="onCompositionEnd";break e;case"compositionupdate":U="onCompositionUpdate";break e}U=void 0}else gc?l$(t,n)&&(U="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(U="onCompositionStart");U&&(a$&&n.locale!=="ko"&&(gc||U!=="onCompositionStart"?U==="onCompositionEnd"&&gc&&(D=s$()):(ya=c,TE="value"in ya?ya.value:ya.textContent,gc=!0)),A=Xp(u,U),0<A.length&&(U=new Tx(U,t,null,n,c),h.push({event:U,listeners:A}),D?U.data=D:(D=u$(n),D!==null&&(U.data=D)))),(D=Lj?$j(t,n):Fj(t,n))&&(u=Xp(u,"onBeforeInput"),0<u.length&&(c=new Tx("onBeforeInput","beforeinput",null,n,c),h.push({event:c,listeners:u}),c.data=D))}S$(h,e)})}function hf(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Xp(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=rf(t,n),o!=null&&r.unshift(hf(t,o,i)),o=rf(t,e),o!=null&&r.push(hf(t,o,i))),t=t.return}return r}function Cu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Lx(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=rf(n,o),l!=null&&s.unshift(hf(n,l,a))):i||(l=rf(n,o),l!=null&&s.push(hf(n,l,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var Jj=/\r\n?/g,eY=/\u0000|\uFFFD/g;function $x(t){return(typeof t=="string"?t:""+t).replace(Jj,`
`).replace(eY,"")}function Pg(t,e,n){if(e=$x(e),$x(t)!==e&&n)throw Error(ie(425))}function qp(){}var C0=null,y0=null;function S0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var b0=typeof setTimeout=="function"?setTimeout:void 0,tY=typeof clearTimeout=="function"?clearTimeout:void 0,Fx=typeof Promise=="function"?Promise:void 0,nY=typeof queueMicrotask=="function"?queueMicrotask:typeof Fx<"u"?function(t){return Fx.resolve(null).then(t).catch(rY)}:b0;function rY(t){setTimeout(function(){throw t})}function ny(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),af(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);af(e)}function Oa(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Wx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var oh=Math.random().toString(36).slice(2),Ao="__reactFiber$"+oh,df="__reactProps$"+oh,Is="__reactContainer$"+oh,R0="__reactEvents$"+oh,iY="__reactListeners$"+oh,oY="__reactHandles$"+oh;function kl(t){var e=t[Ao];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Is]||n[Ao]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Wx(t);t!==null;){if(n=t[Ao])return n;t=Wx(t)}return e}t=n,n=t.parentNode}return null}function Gf(t){return t=t[Ao]||t[Is],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function wc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ie(33))}function mv(t){return t[df]||null}var E0=[],vc=-1;function Qa(t){return{current:t}}function Ht(t){0>vc||(t.current=E0[vc],E0[vc]=null,vc--)}function xt(t,e){vc++,E0[vc]=t.current,t.current=e}var Ba={},tr=Qa(Ba),Wr=Qa(!1),Kl=Ba;function zc(t,e){var n=t.type.contextTypes;if(!n)return Ba;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Vr(t){return t=t.childContextTypes,t!=null}function Qp(){Ht(Wr),Ht(tr)}function Vx(t,e,n){if(tr.current!==Ba)throw Error(ie(168));xt(tr,e),xt(Wr,n)}function R$(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ie(108,UG(t)||"Unknown",i));return Jt({},n,r)}function Zp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ba,Kl=tr.current,xt(tr,t),xt(Wr,Wr.current),!0}function Bx(t,e,n){var r=t.stateNode;if(!r)throw Error(ie(169));n?(t=R$(t,e,Kl),r.__reactInternalMemoizedMergedChildContext=t,Ht(Wr),Ht(tr),xt(tr,t)):Ht(Wr),xt(Wr,n)}var ws=null,pv=!1,ry=!1;function E$(t){ws===null?ws=[t]:ws.push(t)}function sY(t){pv=!0,E$(t)}function Za(){if(!ry&&ws!==null){ry=!0;var t=0,e=Ct;try{var n=ws;for(Ct=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ws=null,pv=!1}catch(i){throw ws!==null&&(ws=ws.slice(t+1)),XL(SE,Za),i}finally{Ct=e,ry=!1}}return null}var Cc=[],yc=0,Jp=null,ew=0,wi=[],vi=0,Xl=null,vs=1,Cs="";function Il(t,e){Cc[yc++]=ew,Cc[yc++]=Jp,Jp=t,ew=e}function T$(t,e,n){wi[vi++]=vs,wi[vi++]=Cs,wi[vi++]=Xl,Xl=t;var r=vs;t=Cs;var i=32-Ji(r)-1;r&=~(1<<i),n+=1;var o=32-Ji(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,vs=1<<32-Ji(e)+i|n<<i|r,Cs=o+t}else vs=1<<o|n<<i|r,Cs=t}function OE(t){t.return!==null&&(Il(t,1),T$(t,1,0))}function AE(t){for(;t===Jp;)Jp=Cc[--yc],Cc[yc]=null,ew=Cc[--yc],Cc[yc]=null;for(;t===Xl;)Xl=wi[--vi],wi[vi]=null,Cs=wi[--vi],wi[vi]=null,vs=wi[--vi],wi[vi]=null}var ei=null,Zr=null,Wt=!1,Ki=null;function _$(t,e){var n=yi(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ux(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ei=t,Zr=Oa(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ei=t,Zr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Xl!==null?{id:vs,overflow:Cs}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=yi(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ei=t,Zr=null,!0):!1;default:return!1}}function T0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function _0(t){if(Wt){var e=Zr;if(e){var n=e;if(!Ux(t,e)){if(T0(t))throw Error(ie(418));e=Oa(n.nextSibling);var r=ei;e&&Ux(t,e)?_$(r,n):(t.flags=t.flags&-4097|2,Wt=!1,ei=t)}}else{if(T0(t))throw Error(ie(418));t.flags=t.flags&-4097|2,Wt=!1,ei=t}}}function zx(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ei=t}function Og(t){if(t!==ei)return!1;if(!Wt)return zx(t),Wt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!S0(t.type,t.memoizedProps)),e&&(e=Zr)){if(T0(t))throw M$(),Error(ie(418));for(;e;)_$(t,e),e=Oa(e.nextSibling)}if(zx(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ie(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Zr=Oa(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Zr=null}}else Zr=ei?Oa(t.stateNode.nextSibling):null;return!0}function M$(){for(var t=Zr;t;)t=Oa(t.nextSibling)}function Gc(){Zr=ei=null,Wt=!1}function IE(t){Ki===null?Ki=[t]:Ki.push(t)}var aY=Fs.ReactCurrentBatchConfig;function zi(t,e){if(t&&t.defaultProps){e=Jt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var tw=Qa(null),nw=null,Sc=null,HE=null;function DE(){HE=Sc=nw=null}function NE(t){var e=tw.current;Ht(tw),t._currentValue=e}function M0(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Dc(t,e){nw=t,HE=Sc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Fr=!0),t.firstContext=null)}function Ri(t){var e=t._currentValue;if(HE!==t)if(t={context:t,memoizedValue:e,next:null},Sc===null){if(nw===null)throw Error(ie(308));Sc=t,nw.dependencies={lanes:0,firstContext:t}}else Sc=Sc.next=t;return e}var Ll=null;function kE(t){Ll===null?Ll=[t]:Ll.push(t)}function x$(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,kE(e)):(n.next=i.next,i.next=n),e.interleaved=n,Hs(t,r)}function Hs(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ha=!1;function LE(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function P$(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ps(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Aa(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ut&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Hs(t,n)}return i=r.interleaved,i===null?(e.next=e,kE(r)):(e.next=i.next,i.next=e),r.interleaved=e,Hs(t,n)}function lp(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,bE(t,n)}}function Gx(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function rw(t,e,n,r){var i=t.updateQueue;ha=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,s===null?o=u:s.next=u,s=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==s&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(o!==null){var h=i.baseState;s=0,c=u=l=null,a=o;do{var f=a.lane,g=a.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,y=a;switch(f=e,g=n,y.tag){case 1:if(p=y.payload,typeof p=="function"){h=p.call(g,h,f);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=y.payload,f=typeof p=="function"?p.call(g,h,f):p,f==null)break e;h=Jt({},h,f);break e;case 2:ha=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else g={eventTime:g,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=g,l=h):c=c.next=g,s|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(1);if(c===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);Ql|=s,t.lanes=s,t.memoizedState=h}}function jx(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ie(191,i));i.call(r)}}}var O$=new xL.Component().refs;function x0(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Jt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var wv={isMounted:function(t){return(t=t._reactInternals)?su(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Cr(),i=Ha(t),o=Ps(r,i);o.payload=e,n!=null&&(o.callback=n),e=Aa(t,o,i),e!==null&&(eo(e,t,i,r),lp(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Cr(),i=Ha(t),o=Ps(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Aa(t,o,i),e!==null&&(eo(e,t,i,r),lp(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Cr(),r=Ha(t),i=Ps(n,r);i.tag=2,e!=null&&(i.callback=e),e=Aa(t,i,r),e!==null&&(eo(e,t,r,n),lp(e,t,r))}};function Yx(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!uf(n,r)||!uf(i,o):!0}function A$(t,e,n){var r=!1,i=Ba,o=e.contextType;return typeof o=="object"&&o!==null?o=Ri(o):(i=Vr(e)?Kl:tr.current,r=e.contextTypes,o=(r=r!=null)?zc(t,i):Ba),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=wv,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function Kx(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&wv.enqueueReplaceState(e,e.state,null)}function P0(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=O$,LE(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Ri(o):(o=Vr(e)?Kl:tr.current,i.context=zc(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(x0(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&wv.enqueueReplaceState(i,i.state,null),rw(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Eh(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ie(309));var r=n.stateNode}if(!r)throw Error(ie(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=i.refs;a===O$&&(a=i.refs={}),s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(ie(284));if(!n._owner)throw Error(ie(290,t))}return t}function Ag(t,e){throw t=Object.prototype.toString.call(e),Error(ie(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Xx(t){var e=t._init;return e(t._payload)}function I$(t){function e(v,C){if(t){var S=v.deletions;S===null?(v.deletions=[C],v.flags|=16):S.push(C)}}function n(v,C){if(!t)return null;for(;C!==null;)e(v,C),C=C.sibling;return null}function r(v,C){for(v=new Map;C!==null;)C.key!==null?v.set(C.key,C):v.set(C.index,C),C=C.sibling;return v}function i(v,C){return v=Da(v,C),v.index=0,v.sibling=null,v}function o(v,C,S){return v.index=S,t?(S=v.alternate,S!==null?(S=S.index,S<C?(v.flags|=2,C):S):(v.flags|=2,C)):(v.flags|=1048576,C)}function s(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,C,S,T){return C===null||C.tag!==6?(C=cy(S,v.mode,T),C.return=v,C):(C=i(C,S),C.return=v,C)}function l(v,C,S,T){var _=S.type;return _===fc?c(v,C,S.props.children,T,S.key):C!==null&&(C.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===ca&&Xx(_)===C.type)?(T=i(C,S.props),T.ref=Eh(v,C,S),T.return=v,T):(T=gp(S.type,S.key,S.props,null,v.mode,T),T.ref=Eh(v,C,S),T.return=v,T)}function u(v,C,S,T){return C===null||C.tag!==4||C.stateNode.containerInfo!==S.containerInfo||C.stateNode.implementation!==S.implementation?(C=hy(S,v.mode,T),C.return=v,C):(C=i(C,S.children||[]),C.return=v,C)}function c(v,C,S,T,_){return C===null||C.tag!==7?(C=jl(S,v.mode,T,_),C.return=v,C):(C=i(C,S),C.return=v,C)}function h(v,C,S){if(typeof C=="string"&&C!==""||typeof C=="number")return C=cy(""+C,v.mode,S),C.return=v,C;if(typeof C=="object"&&C!==null){switch(C.$$typeof){case yg:return S=gp(C.type,C.key,C.props,null,v.mode,S),S.ref=Eh(v,null,C),S.return=v,S;case dc:return C=hy(C,v.mode,S),C.return=v,C;case ca:var T=C._init;return h(v,T(C._payload),S)}if(md(C)||Ch(C))return C=jl(C,v.mode,S,null),C.return=v,C;Ag(v,C)}return null}function f(v,C,S,T){var _=C!==null?C.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return _!==null?null:a(v,C,""+S,T);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case yg:return S.key===_?l(v,C,S,T):null;case dc:return S.key===_?u(v,C,S,T):null;case ca:return _=S._init,f(v,C,_(S._payload),T)}if(md(S)||Ch(S))return _!==null?null:c(v,C,S,T,null);Ag(v,S)}return null}function g(v,C,S,T,_){if(typeof T=="string"&&T!==""||typeof T=="number")return v=v.get(S)||null,a(C,v,""+T,_);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case yg:return v=v.get(T.key===null?S:T.key)||null,l(C,v,T,_);case dc:return v=v.get(T.key===null?S:T.key)||null,u(C,v,T,_);case ca:var A=T._init;return g(v,C,S,A(T._payload),_)}if(md(T)||Ch(T))return v=v.get(S)||null,c(C,v,T,_,null);Ag(C,T)}return null}function p(v,C,S,T){for(var _=null,A=null,D=C,U=C=0,z=null;D!==null&&U<S.length;U++){D.index>U?(z=D,D=null):z=D.sibling;var G=f(v,D,S[U],T);if(G===null){D===null&&(D=z);break}t&&D&&G.alternate===null&&e(v,D),C=o(G,C,U),A===null?_=G:A.sibling=G,A=G,D=z}if(U===S.length)return n(v,D),Wt&&Il(v,U),_;if(D===null){for(;U<S.length;U++)D=h(v,S[U],T),D!==null&&(C=o(D,C,U),A===null?_=D:A.sibling=D,A=D);return Wt&&Il(v,U),_}for(D=r(v,D);U<S.length;U++)z=g(D,v,U,S[U],T),z!==null&&(t&&z.alternate!==null&&D.delete(z.key===null?U:z.key),C=o(z,C,U),A===null?_=z:A.sibling=z,A=z);return t&&D.forEach(function(Z){return e(v,Z)}),Wt&&Il(v,U),_}function y(v,C,S,T){var _=Ch(S);if(typeof _!="function")throw Error(ie(150));if(S=_.call(S),S==null)throw Error(ie(151));for(var A=_=null,D=C,U=C=0,z=null,G=S.next();D!==null&&!G.done;U++,G=S.next()){D.index>U?(z=D,D=null):z=D.sibling;var Z=f(v,D,G.value,T);if(Z===null){D===null&&(D=z);break}t&&D&&Z.alternate===null&&e(v,D),C=o(Z,C,U),A===null?_=Z:A.sibling=Z,A=Z,D=z}if(G.done)return n(v,D),Wt&&Il(v,U),_;if(D===null){for(;!G.done;U++,G=S.next())G=h(v,G.value,T),G!==null&&(C=o(G,C,U),A===null?_=G:A.sibling=G,A=G);return Wt&&Il(v,U),_}for(D=r(v,D);!G.done;U++,G=S.next())G=g(D,v,U,G.value,T),G!==null&&(t&&G.alternate!==null&&D.delete(G.key===null?U:G.key),C=o(G,C,U),A===null?_=G:A.sibling=G,A=G);return t&&D.forEach(function(re){return e(v,re)}),Wt&&Il(v,U),_}function E(v,C,S,T){if(typeof S=="object"&&S!==null&&S.type===fc&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case yg:e:{for(var _=S.key,A=C;A!==null;){if(A.key===_){if(_=S.type,_===fc){if(A.tag===7){n(v,A.sibling),C=i(A,S.props.children),C.return=v,v=C;break e}}else if(A.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===ca&&Xx(_)===A.type){n(v,A.sibling),C=i(A,S.props),C.ref=Eh(v,A,S),C.return=v,v=C;break e}n(v,A);break}else e(v,A);A=A.sibling}S.type===fc?(C=jl(S.props.children,v.mode,T,S.key),C.return=v,v=C):(T=gp(S.type,S.key,S.props,null,v.mode,T),T.ref=Eh(v,C,S),T.return=v,v=T)}return s(v);case dc:e:{for(A=S.key;C!==null;){if(C.key===A)if(C.tag===4&&C.stateNode.containerInfo===S.containerInfo&&C.stateNode.implementation===S.implementation){n(v,C.sibling),C=i(C,S.children||[]),C.return=v,v=C;break e}else{n(v,C);break}else e(v,C);C=C.sibling}C=hy(S,v.mode,T),C.return=v,v=C}return s(v);case ca:return A=S._init,E(v,C,A(S._payload),T)}if(md(S))return p(v,C,S,T);if(Ch(S))return y(v,C,S,T);Ag(v,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,C!==null&&C.tag===6?(n(v,C.sibling),C=i(C,S),C.return=v,v=C):(n(v,C),C=cy(S,v.mode,T),C.return=v,v=C),s(v)):n(v,C)}return E}var jc=I$(!0),H$=I$(!1),jf={},$o=Qa(jf),ff=Qa(jf),gf=Qa(jf);function $l(t){if(t===jf)throw Error(ie(174));return t}function $E(t,e){switch(xt(gf,e),xt(ff,t),xt($o,jf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:a0(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=a0(e,t)}Ht($o),xt($o,e)}function Yc(){Ht($o),Ht(ff),Ht(gf)}function D$(t){$l(gf.current);var e=$l($o.current),n=a0(e,t.type);e!==n&&(xt(ff,t),xt($o,n))}function FE(t){ff.current===t&&(Ht($o),Ht(ff))}var Kt=Qa(0);function iw(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var iy=[];function WE(){for(var t=0;t<iy.length;t++)iy[t]._workInProgressVersionPrimary=null;iy.length=0}var up=Fs.ReactCurrentDispatcher,oy=Fs.ReactCurrentBatchConfig,ql=0,Zt=null,bn=null,An=null,ow=!1,Pd=!1,mf=0,lY=0;function Gn(){throw Error(ie(321))}function VE(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!no(t[n],e[n]))return!1;return!0}function BE(t,e,n,r,i,o){if(ql=o,Zt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,up.current=t===null||t.memoizedState===null?dY:fY,t=n(r,i),Pd){o=0;do{if(Pd=!1,mf=0,25<=o)throw Error(ie(301));o+=1,An=bn=null,e.updateQueue=null,up.current=gY,t=n(r,i)}while(Pd)}if(up.current=sw,e=bn!==null&&bn.next!==null,ql=0,An=bn=Zt=null,ow=!1,e)throw Error(ie(300));return t}function UE(){var t=mf!==0;return mf=0,t}function _o(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return An===null?Zt.memoizedState=An=t:An=An.next=t,An}function Ei(){if(bn===null){var t=Zt.alternate;t=t!==null?t.memoizedState:null}else t=bn.next;var e=An===null?Zt.memoizedState:An.next;if(e!==null)An=e,bn=t;else{if(t===null)throw Error(ie(310));bn=t,t={memoizedState:bn.memoizedState,baseState:bn.baseState,baseQueue:bn.baseQueue,queue:bn.queue,next:null},An===null?Zt.memoizedState=An=t:An=An.next=t}return An}function pf(t,e){return typeof e=="function"?e(t):e}function sy(t){var e=Ei(),n=e.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=t;var r=bn,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,l=null,u=o;do{var c=u.lane;if((ql&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,s=r):l=l.next=h,Zt.lanes|=c,Ql|=c}u=u.next}while(u!==null&&u!==o);l===null?s=r:l.next=a,no(r,e.memoizedState)||(Fr=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,Zt.lanes|=o,Ql|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ay(t){var e=Ei(),n=e.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);no(o,e.memoizedState)||(Fr=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function N$(){}function k$(t,e){var n=Zt,r=Ei(),i=e(),o=!no(r.memoizedState,i);if(o&&(r.memoizedState=i,Fr=!0),r=r.queue,zE(F$.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||An!==null&&An.memoizedState.tag&1){if(n.flags|=2048,wf(9,$$.bind(null,n,r,i,e),void 0,null),Hn===null)throw Error(ie(349));ql&30||L$(n,e,i)}return i}function L$(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Zt.updateQueue,e===null?(e={lastEffect:null,stores:null},Zt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function $$(t,e,n,r){e.value=n,e.getSnapshot=r,W$(e)&&V$(t)}function F$(t,e,n){return n(function(){W$(e)&&V$(t)})}function W$(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!no(t,n)}catch{return!0}}function V$(t){var e=Hs(t,1);e!==null&&eo(e,t,1,-1)}function qx(t){var e=_o();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pf,lastRenderedState:t},e.queue=t,t=t.dispatch=hY.bind(null,Zt,t),[e.memoizedState,t]}function wf(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Zt.updateQueue,e===null?(e={lastEffect:null,stores:null},Zt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function B$(){return Ei().memoizedState}function cp(t,e,n,r){var i=_o();Zt.flags|=t,i.memoizedState=wf(1|e,n,void 0,r===void 0?null:r)}function vv(t,e,n,r){var i=Ei();r=r===void 0?null:r;var o=void 0;if(bn!==null){var s=bn.memoizedState;if(o=s.destroy,r!==null&&VE(r,s.deps)){i.memoizedState=wf(e,n,o,r);return}}Zt.flags|=t,i.memoizedState=wf(1|e,n,o,r)}function Qx(t,e){return cp(8390656,8,t,e)}function zE(t,e){return vv(2048,8,t,e)}function U$(t,e){return vv(4,2,t,e)}function z$(t,e){return vv(4,4,t,e)}function G$(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function j$(t,e,n){return n=n!=null?n.concat([t]):null,vv(4,4,G$.bind(null,e,t),n)}function GE(){}function Y$(t,e){var n=Ei();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&VE(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function K$(t,e){var n=Ei();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&VE(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function X$(t,e,n){return ql&21?(no(n,e)||(n=ZL(),Zt.lanes|=n,Ql|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Fr=!0),t.memoizedState=n)}function uY(t,e){var n=Ct;Ct=n!==0&&4>n?n:4,t(!0);var r=oy.transition;oy.transition={};try{t(!1),e()}finally{Ct=n,oy.transition=r}}function q$(){return Ei().memoizedState}function cY(t,e,n){var r=Ha(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Q$(t))Z$(e,n);else if(n=x$(t,e,n,r),n!==null){var i=Cr();eo(n,t,r,i),J$(n,e,r)}}function hY(t,e,n){var r=Ha(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Q$(t))Z$(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,no(a,s)){var l=e.interleaved;l===null?(i.next=i,kE(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=x$(t,e,i,r),n!==null&&(i=Cr(),eo(n,t,r,i),J$(n,e,r))}}function Q$(t){var e=t.alternate;return t===Zt||e!==null&&e===Zt}function Z$(t,e){Pd=ow=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function J$(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,bE(t,n)}}var sw={readContext:Ri,useCallback:Gn,useContext:Gn,useEffect:Gn,useImperativeHandle:Gn,useInsertionEffect:Gn,useLayoutEffect:Gn,useMemo:Gn,useReducer:Gn,useRef:Gn,useState:Gn,useDebugValue:Gn,useDeferredValue:Gn,useTransition:Gn,useMutableSource:Gn,useSyncExternalStore:Gn,useId:Gn,unstable_isNewReconciler:!1},dY={readContext:Ri,useCallback:function(t,e){return _o().memoizedState=[t,e===void 0?null:e],t},useContext:Ri,useEffect:Qx,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,cp(4194308,4,G$.bind(null,e,t),n)},useLayoutEffect:function(t,e){return cp(4194308,4,t,e)},useInsertionEffect:function(t,e){return cp(4,2,t,e)},useMemo:function(t,e){var n=_o();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=_o();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=cY.bind(null,Zt,t),[r.memoizedState,t]},useRef:function(t){var e=_o();return t={current:t},e.memoizedState=t},useState:qx,useDebugValue:GE,useDeferredValue:function(t){return _o().memoizedState=t},useTransition:function(){var t=qx(!1),e=t[0];return t=uY.bind(null,t[1]),_o().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Zt,i=_o();if(Wt){if(n===void 0)throw Error(ie(407));n=n()}else{if(n=e(),Hn===null)throw Error(ie(349));ql&30||L$(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,Qx(F$.bind(null,r,o,t),[t]),r.flags|=2048,wf(9,$$.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=_o(),e=Hn.identifierPrefix;if(Wt){var n=Cs,r=vs;n=(r&~(1<<32-Ji(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=mf++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=lY++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},fY={readContext:Ri,useCallback:Y$,useContext:Ri,useEffect:zE,useImperativeHandle:j$,useInsertionEffect:U$,useLayoutEffect:z$,useMemo:K$,useReducer:sy,useRef:B$,useState:function(){return sy(pf)},useDebugValue:GE,useDeferredValue:function(t){var e=Ei();return X$(e,bn.memoizedState,t)},useTransition:function(){var t=sy(pf)[0],e=Ei().memoizedState;return[t,e]},useMutableSource:N$,useSyncExternalStore:k$,useId:q$,unstable_isNewReconciler:!1},gY={readContext:Ri,useCallback:Y$,useContext:Ri,useEffect:zE,useImperativeHandle:j$,useInsertionEffect:U$,useLayoutEffect:z$,useMemo:K$,useReducer:ay,useRef:B$,useState:function(){return ay(pf)},useDebugValue:GE,useDeferredValue:function(t){var e=Ei();return bn===null?e.memoizedState=t:X$(e,bn.memoizedState,t)},useTransition:function(){var t=ay(pf)[0],e=Ei().memoizedState;return[t,e]},useMutableSource:N$,useSyncExternalStore:k$,useId:q$,unstable_isNewReconciler:!1};function Kc(t,e){try{var n="",r=e;do n+=BG(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function ly(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function O0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var mY=typeof WeakMap=="function"?WeakMap:Map;function eF(t,e,n){n=Ps(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){lw||(lw=!0,W0=r),O0(t,e)},n}function tF(t,e,n){n=Ps(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){O0(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){O0(t,e),typeof r!="function"&&(Ia===null?Ia=new Set([this]):Ia.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function Zx(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new mY;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=PY.bind(null,t,e,n),e.then(t,t))}function Jx(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function eP(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ps(-1,1),e.tag=2,Aa(n,e,1))),n.lanes|=1),t)}var pY=Fs.ReactCurrentOwner,Fr=!1;function gr(t,e,n,r){e.child=t===null?H$(e,null,n,r):jc(e,t.child,n,r)}function tP(t,e,n,r,i){n=n.render;var o=e.ref;return Dc(e,i),r=BE(t,e,n,r,o,i),n=UE(),t!==null&&!Fr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ds(t,e,i)):(Wt&&n&&OE(e),e.flags|=1,gr(t,e,r,i),e.child)}function nP(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!JE(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,nF(t,e,o,r,i)):(t=gp(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:uf,n(s,r)&&t.ref===e.ref)return Ds(t,e,i)}return e.flags|=1,t=Da(o,r),t.ref=e.ref,t.return=e,e.child=t}function nF(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(uf(o,r)&&t.ref===e.ref)if(Fr=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(Fr=!0);else return e.lanes=t.lanes,Ds(t,e,i)}return A0(t,e,n,r,i)}function rF(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},xt(Rc,Kr),Kr|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,xt(Rc,Kr),Kr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,xt(Rc,Kr),Kr|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,xt(Rc,Kr),Kr|=r;return gr(t,e,i,n),e.child}function iF(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function A0(t,e,n,r,i){var o=Vr(n)?Kl:tr.current;return o=zc(e,o),Dc(e,i),n=BE(t,e,n,r,o,i),r=UE(),t!==null&&!Fr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ds(t,e,i)):(Wt&&r&&OE(e),e.flags|=1,gr(t,e,n,i),e.child)}function rP(t,e,n,r,i){if(Vr(n)){var o=!0;Zp(e)}else o=!1;if(Dc(e,i),e.stateNode===null)hp(t,e),A$(e,n,r),P0(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,u=n.contextType;typeof u=="object"&&u!==null?u=Ri(u):(u=Vr(n)?Kl:tr.current,u=zc(e,u));var c=n.getDerivedStateFromProps,h=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";h||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==u)&&Kx(e,s,r,u),ha=!1;var f=e.memoizedState;s.state=f,rw(e,r,s,i),l=e.memoizedState,a!==r||f!==l||Wr.current||ha?(typeof c=="function"&&(x0(e,n,c,r),l=e.memoizedState),(a=ha||Yx(e,n,a,r,f,l,u))?(h||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=u,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,P$(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:zi(e.type,a),s.props=u,h=e.pendingProps,f=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=Ri(l):(l=Vr(n)?Kl:tr.current,l=zc(e,l));var g=n.getDerivedStateFromProps;(c=typeof g=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==h||f!==l)&&Kx(e,s,r,l),ha=!1,f=e.memoizedState,s.state=f,rw(e,r,s,i);var p=e.memoizedState;a!==h||f!==p||Wr.current||ha?(typeof g=="function"&&(x0(e,n,g,r),p=e.memoizedState),(u=ha||Yx(e,n,u,r,f,p,l)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),s.props=r,s.state=p,s.context=l,r=u):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return I0(t,e,n,r,o,i)}function I0(t,e,n,r,i,o){iF(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&Bx(e,n,!1),Ds(t,e,o);r=e.stateNode,pY.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=jc(e,t.child,null,o),e.child=jc(e,null,a,o)):gr(t,e,a,o),e.memoizedState=r.state,i&&Bx(e,n,!0),e.child}function oF(t){var e=t.stateNode;e.pendingContext?Vx(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Vx(t,e.context,!1),$E(t,e.containerInfo)}function iP(t,e,n,r,i){return Gc(),IE(i),e.flags|=256,gr(t,e,n,r),e.child}var H0={dehydrated:null,treeContext:null,retryLane:0};function D0(t){return{baseLanes:t,cachePool:null,transitions:null}}function sF(t,e,n){var r=e.pendingProps,i=Kt.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),xt(Kt,i&1),t===null)return _0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=Sv(s,r,0,null),t=jl(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=D0(n),e.memoizedState=H0,t):jE(e,s));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return wY(t,e,s,r,a,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Da(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=Da(a,o):(o=jl(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?D0(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=H0,r}return o=t.child,t=o.sibling,r=Da(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function jE(t,e){return e=Sv({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ig(t,e,n,r){return r!==null&&IE(r),jc(e,t.child,null,n),t=jE(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function wY(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=ly(Error(ie(422))),Ig(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=Sv({mode:"visible",children:r.children},i,0,null),o=jl(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&jc(e,t.child,null,s),e.child.memoizedState=D0(s),e.memoizedState=H0,o);if(!(e.mode&1))return Ig(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(ie(419)),r=ly(o,r,void 0),Ig(t,e,s,r)}if(a=(s&t.childLanes)!==0,Fr||a){if(r=Hn,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Hs(t,i),eo(r,t,i,-1))}return ZE(),r=ly(Error(ie(421))),Ig(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=OY.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,Zr=Oa(i.nextSibling),ei=e,Wt=!0,Ki=null,t!==null&&(wi[vi++]=vs,wi[vi++]=Cs,wi[vi++]=Xl,vs=t.id,Cs=t.overflow,Xl=e),e=jE(e,r.children),e.flags|=4096,e)}function oP(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),M0(t.return,e,n)}function uy(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function aF(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(gr(t,e,r.children,n),r=Kt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&oP(t,n,e);else if(t.tag===19)oP(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(xt(Kt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&iw(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),uy(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&iw(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}uy(e,!0,n,null,o);break;case"together":uy(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function hp(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ds(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ql|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ie(153));if(e.child!==null){for(t=e.child,n=Da(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Da(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function vY(t,e,n){switch(e.tag){case 3:oF(e),Gc();break;case 5:D$(e);break;case 1:Vr(e.type)&&Zp(e);break;case 4:$E(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;xt(tw,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(xt(Kt,Kt.current&1),e.flags|=128,null):n&e.child.childLanes?sF(t,e,n):(xt(Kt,Kt.current&1),t=Ds(t,e,n),t!==null?t.sibling:null);xt(Kt,Kt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return aF(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),xt(Kt,Kt.current),r)break;return null;case 22:case 23:return e.lanes=0,rF(t,e,n)}return Ds(t,e,n)}var lF,N0,uF,cF;lF=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};N0=function(){};uF=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,$l($o.current);var o=null;switch(n){case"input":i=r0(t,i),r=r0(t,r),o=[];break;case"select":i=Jt({},i,{value:void 0}),r=Jt({},r,{value:void 0}),o=[];break;case"textarea":i=s0(t,i),r=s0(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=qp)}l0(n,r);var s;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(tf.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(tf.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&At("scroll",t),o||a===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};cF=function(t,e,n,r){n!==r&&(e.flags|=4)};function Th(t,e){if(!Wt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function jn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function CY(t,e,n){var r=e.pendingProps;switch(AE(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jn(e),null;case 1:return Vr(e.type)&&Qp(),jn(e),null;case 3:return r=e.stateNode,Yc(),Ht(Wr),Ht(tr),WE(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Og(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ki!==null&&(U0(Ki),Ki=null))),N0(t,e),jn(e),null;case 5:FE(e);var i=$l(gf.current);if(n=e.type,t!==null&&e.stateNode!=null)uF(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ie(166));return jn(e),null}if(t=$l($o.current),Og(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Ao]=e,r[df]=o,t=(e.mode&1)!==0,n){case"dialog":At("cancel",r),At("close",r);break;case"iframe":case"object":case"embed":At("load",r);break;case"video":case"audio":for(i=0;i<wd.length;i++)At(wd[i],r);break;case"source":At("error",r);break;case"img":case"image":case"link":At("error",r),At("load",r);break;case"details":At("toggle",r);break;case"input":gx(r,o),At("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},At("invalid",r);break;case"textarea":px(r,o),At("invalid",r)}l0(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&Pg(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Pg(r.textContent,a,t),i=["children",""+a]):tf.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&At("scroll",r)}switch(n){case"input":Sg(r),mx(r,o,!0);break;case"textarea":Sg(r),wx(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=qp)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=LL(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[Ao]=e,t[df]=r,lF(t,e,!1,!1),e.stateNode=t;e:{switch(s=u0(n,r),n){case"dialog":At("cancel",t),At("close",t),i=r;break;case"iframe":case"object":case"embed":At("load",t),i=r;break;case"video":case"audio":for(i=0;i<wd.length;i++)At(wd[i],t);i=r;break;case"source":At("error",t),i=r;break;case"img":case"image":case"link":At("error",t),At("load",t),i=r;break;case"details":At("toggle",t),i=r;break;case"input":gx(t,r),i=r0(t,r),At("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Jt({},r,{value:void 0}),At("invalid",t);break;case"textarea":px(t,r),i=s0(t,r),At("invalid",t);break;default:i=r}l0(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?WL(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&$L(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&nf(t,l):typeof l=="number"&&nf(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(tf.hasOwnProperty(o)?l!=null&&o==="onScroll"&&At("scroll",t):l!=null&&pE(t,o,l,s))}switch(n){case"input":Sg(t),mx(t,r,!1);break;case"textarea":Sg(t),wx(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Va(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Oc(t,!!r.multiple,o,!1):r.defaultValue!=null&&Oc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=qp)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return jn(e),null;case 6:if(t&&e.stateNode!=null)cF(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ie(166));if(n=$l(gf.current),$l($o.current),Og(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ao]=e,(o=r.nodeValue!==n)&&(t=ei,t!==null))switch(t.tag){case 3:Pg(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Pg(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ao]=e,e.stateNode=r}return jn(e),null;case 13:if(Ht(Kt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Wt&&Zr!==null&&e.mode&1&&!(e.flags&128))M$(),Gc(),e.flags|=98560,o=!1;else if(o=Og(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(ie(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ie(317));o[Ao]=e}else Gc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;jn(e),o=!1}else Ki!==null&&(U0(Ki),Ki=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Kt.current&1?Rn===0&&(Rn=3):ZE())),e.updateQueue!==null&&(e.flags|=4),jn(e),null);case 4:return Yc(),N0(t,e),t===null&&cf(e.stateNode.containerInfo),jn(e),null;case 10:return NE(e.type._context),jn(e),null;case 17:return Vr(e.type)&&Qp(),jn(e),null;case 19:if(Ht(Kt),o=e.memoizedState,o===null)return jn(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)Th(o,!1);else{if(Rn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=iw(t),s!==null){for(e.flags|=128,Th(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return xt(Kt,Kt.current&1|2),e.child}t=t.sibling}o.tail!==null&&un()>Xc&&(e.flags|=128,r=!0,Th(o,!1),e.lanes=4194304)}else{if(!r)if(t=iw(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Th(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Wt)return jn(e),null}else 2*un()-o.renderingStartTime>Xc&&n!==1073741824&&(e.flags|=128,r=!0,Th(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=un(),e.sibling=null,n=Kt.current,xt(Kt,r?n&1|2:n&1),e):(jn(e),null);case 22:case 23:return QE(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Kr&1073741824&&(jn(e),e.subtreeFlags&6&&(e.flags|=8192)):jn(e),null;case 24:return null;case 25:return null}throw Error(ie(156,e.tag))}function yY(t,e){switch(AE(e),e.tag){case 1:return Vr(e.type)&&Qp(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Yc(),Ht(Wr),Ht(tr),WE(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return FE(e),null;case 13:if(Ht(Kt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ie(340));Gc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ht(Kt),null;case 4:return Yc(),null;case 10:return NE(e.type._context),null;case 22:case 23:return QE(),null;case 24:return null;default:return null}}var Hg=!1,Qn=!1,SY=typeof WeakSet=="function"?WeakSet:Set,ye=null;function bc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){on(t,e,r)}else n.current=null}function k0(t,e,n){try{n()}catch(r){on(t,e,r)}}var sP=!1;function bY(t,e){if(C0=Yp,t=g$(),PE(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,u=0,c=0,h=t,f=null;t:for(;;){for(var g;h!==n||i!==0&&h.nodeType!==3||(a=s+i),h!==o||r!==0&&h.nodeType!==3||(l=s+r),h.nodeType===3&&(s+=h.nodeValue.length),(g=h.firstChild)!==null;)f=h,h=g;for(;;){if(h===t)break t;if(f===n&&++u===i&&(a=s),f===o&&++c===r&&(l=s),(g=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=g}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(y0={focusedElem:t,selectionRange:n},Yp=!1,ye=e;ye!==null;)if(e=ye,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ye=t;else for(;ye!==null;){e=ye;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var y=p.memoizedProps,E=p.memoizedState,v=e.stateNode,C=v.getSnapshotBeforeUpdate(e.elementType===e.type?y:zi(e.type,y),E);v.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ie(163))}}catch(T){on(e,e.return,T)}if(t=e.sibling,t!==null){t.return=e.return,ye=t;break}ye=e.return}return p=sP,sP=!1,p}function Od(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&k0(e,n,o)}i=i.next}while(i!==r)}}function Cv(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function L0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function hF(t){var e=t.alternate;e!==null&&(t.alternate=null,hF(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ao],delete e[df],delete e[R0],delete e[iY],delete e[oY])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function dF(t){return t.tag===5||t.tag===3||t.tag===4}function aP(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||dF(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function $0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=qp));else if(r!==4&&(t=t.child,t!==null))for($0(t,e,n),t=t.sibling;t!==null;)$0(t,e,n),t=t.sibling}function F0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(F0(t,e,n),t=t.sibling;t!==null;)F0(t,e,n),t=t.sibling}var Fn=null,ji=!1;function Ks(t,e,n){for(n=n.child;n!==null;)fF(t,e,n),n=n.sibling}function fF(t,e,n){if(Lo&&typeof Lo.onCommitFiberUnmount=="function")try{Lo.onCommitFiberUnmount(hv,n)}catch{}switch(n.tag){case 5:Qn||bc(n,e);case 6:var r=Fn,i=ji;Fn=null,Ks(t,e,n),Fn=r,ji=i,Fn!==null&&(ji?(t=Fn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Fn.removeChild(n.stateNode));break;case 18:Fn!==null&&(ji?(t=Fn,n=n.stateNode,t.nodeType===8?ny(t.parentNode,n):t.nodeType===1&&ny(t,n),af(t)):ny(Fn,n.stateNode));break;case 4:r=Fn,i=ji,Fn=n.stateNode.containerInfo,ji=!0,Ks(t,e,n),Fn=r,ji=i;break;case 0:case 11:case 14:case 15:if(!Qn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&k0(n,e,s),i=i.next}while(i!==r)}Ks(t,e,n);break;case 1:if(!Qn&&(bc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){on(n,e,a)}Ks(t,e,n);break;case 21:Ks(t,e,n);break;case 22:n.mode&1?(Qn=(r=Qn)||n.memoizedState!==null,Ks(t,e,n),Qn=r):Ks(t,e,n);break;default:Ks(t,e,n)}}function lP(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new SY),e.forEach(function(r){var i=AY.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Oi(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:Fn=a.stateNode,ji=!1;break e;case 3:Fn=a.stateNode.containerInfo,ji=!0;break e;case 4:Fn=a.stateNode.containerInfo,ji=!0;break e}a=a.return}if(Fn===null)throw Error(ie(160));fF(o,s,i),Fn=null,ji=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){on(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)gF(e,t),e=e.sibling}function gF(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Oi(e,t),uo(t),r&4){try{Od(3,t,t.return),Cv(3,t)}catch(y){on(t,t.return,y)}try{Od(5,t,t.return)}catch(y){on(t,t.return,y)}}break;case 1:Oi(e,t),uo(t),r&512&&n!==null&&bc(n,n.return);break;case 5:if(Oi(e,t),uo(t),r&512&&n!==null&&bc(n,n.return),t.flags&32){var i=t.stateNode;try{nf(i,"")}catch(y){on(t,t.return,y)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&NL(i,o),u0(a,s);var u=u0(a,o);for(s=0;s<l.length;s+=2){var c=l[s],h=l[s+1];c==="style"?WL(i,h):c==="dangerouslySetInnerHTML"?$L(i,h):c==="children"?nf(i,h):pE(i,c,h,u)}switch(a){case"input":i0(i,o);break;case"textarea":kL(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var g=o.value;g!=null?Oc(i,!!o.multiple,g,!1):f!==!!o.multiple&&(o.defaultValue!=null?Oc(i,!!o.multiple,o.defaultValue,!0):Oc(i,!!o.multiple,o.multiple?[]:"",!1))}i[df]=o}catch(y){on(t,t.return,y)}}break;case 6:if(Oi(e,t),uo(t),r&4){if(t.stateNode===null)throw Error(ie(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(y){on(t,t.return,y)}}break;case 3:if(Oi(e,t),uo(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{af(e.containerInfo)}catch(y){on(t,t.return,y)}break;case 4:Oi(e,t),uo(t);break;case 13:Oi(e,t),uo(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(XE=un())),r&4&&lP(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Qn=(u=Qn)||c,Oi(e,t),Qn=u):Oi(e,t),uo(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(ye=t,c=t.child;c!==null;){for(h=ye=c;ye!==null;){switch(f=ye,g=f.child,f.tag){case 0:case 11:case 14:case 15:Od(4,f,f.return);break;case 1:bc(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(y){on(r,n,y)}}break;case 5:bc(f,f.return);break;case 22:if(f.memoizedState!==null){cP(h);continue}}g!==null?(g.return=f,ye=g):cP(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,u?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=h.stateNode,l=h.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=FL("display",s))}catch(y){on(t,t.return,y)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(y){on(t,t.return,y)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Oi(e,t),uo(t),r&4&&lP(t);break;case 21:break;default:Oi(e,t),uo(t)}}function uo(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(dF(n)){var r=n;break e}n=n.return}throw Error(ie(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(nf(i,""),r.flags&=-33);var o=aP(t);F0(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=aP(t);$0(t,a,s);break;default:throw Error(ie(161))}}catch(l){on(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function RY(t,e,n){ye=t,mF(t)}function mF(t,e,n){for(var r=(t.mode&1)!==0;ye!==null;){var i=ye,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Hg;if(!s){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Qn;a=Hg;var u=Qn;if(Hg=s,(Qn=l)&&!u)for(ye=i;ye!==null;)s=ye,l=s.child,s.tag===22&&s.memoizedState!==null?hP(i):l!==null?(l.return=s,ye=l):hP(i);for(;o!==null;)ye=o,mF(o),o=o.sibling;ye=i,Hg=a,Qn=u}uP(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,ye=o):uP(t)}}function uP(t){for(;ye!==null;){var e=ye;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Qn||Cv(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Qn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:zi(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&jx(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}jx(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&af(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ie(163))}Qn||e.flags&512&&L0(e)}catch(f){on(e,e.return,f)}}if(e===t){ye=null;break}if(n=e.sibling,n!==null){n.return=e.return,ye=n;break}ye=e.return}}function cP(t){for(;ye!==null;){var e=ye;if(e===t){ye=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ye=n;break}ye=e.return}}function hP(t){for(;ye!==null;){var e=ye;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Cv(4,e)}catch(l){on(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){on(e,i,l)}}var o=e.return;try{L0(e)}catch(l){on(e,o,l)}break;case 5:var s=e.return;try{L0(e)}catch(l){on(e,s,l)}}}catch(l){on(e,e.return,l)}if(e===t){ye=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ye=a;break}ye=e.return}}var EY=Math.ceil,aw=Fs.ReactCurrentDispatcher,YE=Fs.ReactCurrentOwner,Si=Fs.ReactCurrentBatchConfig,ut=0,Hn=null,vn=null,Vn=0,Kr=0,Rc=Qa(0),Rn=0,vf=null,Ql=0,yv=0,KE=0,Ad=null,Lr=null,XE=0,Xc=1/0,hs=null,lw=!1,W0=null,Ia=null,Dg=!1,Sa=null,uw=0,Id=0,V0=null,dp=-1,fp=0;function Cr(){return ut&6?un():dp!==-1?dp:dp=un()}function Ha(t){return t.mode&1?ut&2&&Vn!==0?Vn&-Vn:aY.transition!==null?(fp===0&&(fp=ZL()),fp):(t=Ct,t!==0||(t=window.event,t=t===void 0?16:o$(t.type)),t):1}function eo(t,e,n,r){if(50<Id)throw Id=0,V0=null,Error(ie(185));Uf(t,n,r),(!(ut&2)||t!==Hn)&&(t===Hn&&(!(ut&2)&&(yv|=n),Rn===4&&ga(t,Vn)),Br(t,r),n===1&&ut===0&&!(e.mode&1)&&(Xc=un()+500,pv&&Za()))}function Br(t,e){var n=t.callbackNode;aj(t,e);var r=jp(t,t===Hn?Vn:0);if(r===0)n!==null&&yx(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&yx(n),e===1)t.tag===0?sY(dP.bind(null,t)):E$(dP.bind(null,t)),nY(function(){!(ut&6)&&Za()}),n=null;else{switch(JL(r)){case 1:n=SE;break;case 4:n=qL;break;case 16:n=Gp;break;case 536870912:n=QL;break;default:n=Gp}n=RF(n,pF.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function pF(t,e){if(dp=-1,fp=0,ut&6)throw Error(ie(327));var n=t.callbackNode;if(Nc()&&t.callbackNode!==n)return null;var r=jp(t,t===Hn?Vn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=cw(t,r);else{e=r;var i=ut;ut|=2;var o=vF();(Hn!==t||Vn!==e)&&(hs=null,Xc=un()+500,Gl(t,e));do try{MY();break}catch(a){wF(t,a)}while(1);DE(),aw.current=o,ut=i,vn!==null?e=0:(Hn=null,Vn=0,e=Rn)}if(e!==0){if(e===2&&(i=g0(t),i!==0&&(r=i,e=B0(t,i))),e===1)throw n=vf,Gl(t,0),ga(t,r),Br(t,un()),n;if(e===6)ga(t,r);else{if(i=t.current.alternate,!(r&30)&&!TY(i)&&(e=cw(t,r),e===2&&(o=g0(t),o!==0&&(r=o,e=B0(t,o))),e===1))throw n=vf,Gl(t,0),ga(t,r),Br(t,un()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ie(345));case 2:Hl(t,Lr,hs);break;case 3:if(ga(t,r),(r&130023424)===r&&(e=XE+500-un(),10<e)){if(jp(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Cr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=b0(Hl.bind(null,t,Lr,hs),e);break}Hl(t,Lr,hs);break;case 4:if(ga(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-Ji(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=un()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*EY(r/1960))-r,10<r){t.timeoutHandle=b0(Hl.bind(null,t,Lr,hs),r);break}Hl(t,Lr,hs);break;case 5:Hl(t,Lr,hs);break;default:throw Error(ie(329))}}}return Br(t,un()),t.callbackNode===n?pF.bind(null,t):null}function B0(t,e){var n=Ad;return t.current.memoizedState.isDehydrated&&(Gl(t,e).flags|=256),t=cw(t,e),t!==2&&(e=Lr,Lr=n,e!==null&&U0(e)),t}function U0(t){Lr===null?Lr=t:Lr.push.apply(Lr,t)}function TY(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!no(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ga(t,e){for(e&=~KE,e&=~yv,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ji(e),r=1<<n;t[n]=-1,e&=~r}}function dP(t){if(ut&6)throw Error(ie(327));Nc();var e=jp(t,0);if(!(e&1))return Br(t,un()),null;var n=cw(t,e);if(t.tag!==0&&n===2){var r=g0(t);r!==0&&(e=r,n=B0(t,r))}if(n===1)throw n=vf,Gl(t,0),ga(t,e),Br(t,un()),n;if(n===6)throw Error(ie(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Hl(t,Lr,hs),Br(t,un()),null}function qE(t,e){var n=ut;ut|=1;try{return t(e)}finally{ut=n,ut===0&&(Xc=un()+500,pv&&Za())}}function Zl(t){Sa!==null&&Sa.tag===0&&!(ut&6)&&Nc();var e=ut;ut|=1;var n=Si.transition,r=Ct;try{if(Si.transition=null,Ct=1,t)return t()}finally{Ct=r,Si.transition=n,ut=e,!(ut&6)&&Za()}}function QE(){Kr=Rc.current,Ht(Rc)}function Gl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,tY(n)),vn!==null)for(n=vn.return;n!==null;){var r=n;switch(AE(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Qp();break;case 3:Yc(),Ht(Wr),Ht(tr),WE();break;case 5:FE(r);break;case 4:Yc();break;case 13:Ht(Kt);break;case 19:Ht(Kt);break;case 10:NE(r.type._context);break;case 22:case 23:QE()}n=n.return}if(Hn=t,vn=t=Da(t.current,null),Vn=Kr=e,Rn=0,vf=null,KE=yv=Ql=0,Lr=Ad=null,Ll!==null){for(e=0;e<Ll.length;e++)if(n=Ll[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}Ll=null}return t}function wF(t,e){do{var n=vn;try{if(DE(),up.current=sw,ow){for(var r=Zt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}ow=!1}if(ql=0,An=bn=Zt=null,Pd=!1,mf=0,YE.current=null,n===null||n.return===null){Rn=1,vf=e,vn=null;break}e:{var o=t,s=n.return,a=n,l=e;if(e=Vn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var g=Jx(s);if(g!==null){g.flags&=-257,eP(g,s,a,o,e),g.mode&1&&Zx(o,u,e),e=g,l=u;var p=e.updateQueue;if(p===null){var y=new Set;y.add(l),e.updateQueue=y}else p.add(l);break e}else{if(!(e&1)){Zx(o,u,e),ZE();break e}l=Error(ie(426))}}else if(Wt&&a.mode&1){var E=Jx(s);if(E!==null){!(E.flags&65536)&&(E.flags|=256),eP(E,s,a,o,e),IE(Kc(l,a));break e}}o=l=Kc(l,a),Rn!==4&&(Rn=2),Ad===null?Ad=[o]:Ad.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var v=eF(o,l,e);Gx(o,v);break e;case 1:a=l;var C=o.type,S=o.stateNode;if(!(o.flags&128)&&(typeof C.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Ia===null||!Ia.has(S)))){o.flags|=65536,e&=-e,o.lanes|=e;var T=tF(o,a,e);Gx(o,T);break e}}o=o.return}while(o!==null)}yF(n)}catch(_){e=_,vn===n&&n!==null&&(vn=n=n.return);continue}break}while(1)}function vF(){var t=aw.current;return aw.current=sw,t===null?sw:t}function ZE(){(Rn===0||Rn===3||Rn===2)&&(Rn=4),Hn===null||!(Ql&268435455)&&!(yv&268435455)||ga(Hn,Vn)}function cw(t,e){var n=ut;ut|=2;var r=vF();(Hn!==t||Vn!==e)&&(hs=null,Gl(t,e));do try{_Y();break}catch(i){wF(t,i)}while(1);if(DE(),ut=n,aw.current=r,vn!==null)throw Error(ie(261));return Hn=null,Vn=0,Rn}function _Y(){for(;vn!==null;)CF(vn)}function MY(){for(;vn!==null&&!ZG();)CF(vn)}function CF(t){var e=bF(t.alternate,t,Kr);t.memoizedProps=t.pendingProps,e===null?yF(t):vn=e,YE.current=null}function yF(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=yY(n,e),n!==null){n.flags&=32767,vn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Rn=6,vn=null;return}}else if(n=CY(n,e,Kr),n!==null){vn=n;return}if(e=e.sibling,e!==null){vn=e;return}vn=e=t}while(e!==null);Rn===0&&(Rn=5)}function Hl(t,e,n){var r=Ct,i=Si.transition;try{Si.transition=null,Ct=1,xY(t,e,n,r)}finally{Si.transition=i,Ct=r}return null}function xY(t,e,n,r){do Nc();while(Sa!==null);if(ut&6)throw Error(ie(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ie(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(lj(t,o),t===Hn&&(vn=Hn=null,Vn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Dg||(Dg=!0,RF(Gp,function(){return Nc(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Si.transition,Si.transition=null;var s=Ct;Ct=1;var a=ut;ut|=4,YE.current=null,bY(t,n),gF(n,t),Kj(y0),Yp=!!C0,y0=C0=null,t.current=n,RY(n),JG(),ut=a,Ct=s,Si.transition=o}else t.current=n;if(Dg&&(Dg=!1,Sa=t,uw=i),o=t.pendingLanes,o===0&&(Ia=null),nj(n.stateNode),Br(t,un()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(lw)throw lw=!1,t=W0,W0=null,t;return uw&1&&t.tag!==0&&Nc(),o=t.pendingLanes,o&1?t===V0?Id++:(Id=0,V0=t):Id=0,Za(),null}function Nc(){if(Sa!==null){var t=JL(uw),e=Si.transition,n=Ct;try{if(Si.transition=null,Ct=16>t?16:t,Sa===null)var r=!1;else{if(t=Sa,Sa=null,uw=0,ut&6)throw Error(ie(331));var i=ut;for(ut|=4,ye=t.current;ye!==null;){var o=ye,s=o.child;if(ye.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(ye=u;ye!==null;){var c=ye;switch(c.tag){case 0:case 11:case 15:Od(8,c,o)}var h=c.child;if(h!==null)h.return=c,ye=h;else for(;ye!==null;){c=ye;var f=c.sibling,g=c.return;if(hF(c),c===u){ye=null;break}if(f!==null){f.return=g,ye=f;break}ye=g}}}var p=o.alternate;if(p!==null){var y=p.child;if(y!==null){p.child=null;do{var E=y.sibling;y.sibling=null,y=E}while(y!==null)}}ye=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,ye=s;else e:for(;ye!==null;){if(o=ye,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Od(9,o,o.return)}var v=o.sibling;if(v!==null){v.return=o.return,ye=v;break e}ye=o.return}}var C=t.current;for(ye=C;ye!==null;){s=ye;var S=s.child;if(s.subtreeFlags&2064&&S!==null)S.return=s,ye=S;else e:for(s=C;ye!==null;){if(a=ye,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Cv(9,a)}}catch(_){on(a,a.return,_)}if(a===s){ye=null;break e}var T=a.sibling;if(T!==null){T.return=a.return,ye=T;break e}ye=a.return}}if(ut=i,Za(),Lo&&typeof Lo.onPostCommitFiberRoot=="function")try{Lo.onPostCommitFiberRoot(hv,t)}catch{}r=!0}return r}finally{Ct=n,Si.transition=e}}return!1}function fP(t,e,n){e=Kc(n,e),e=eF(t,e,1),t=Aa(t,e,1),e=Cr(),t!==null&&(Uf(t,1,e),Br(t,e))}function on(t,e,n){if(t.tag===3)fP(t,t,n);else for(;e!==null;){if(e.tag===3){fP(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ia===null||!Ia.has(r))){t=Kc(n,t),t=tF(e,t,1),e=Aa(e,t,1),t=Cr(),e!==null&&(Uf(e,1,t),Br(e,t));break}}e=e.return}}function PY(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Cr(),t.pingedLanes|=t.suspendedLanes&n,Hn===t&&(Vn&n)===n&&(Rn===4||Rn===3&&(Vn&130023424)===Vn&&500>un()-XE?Gl(t,0):KE|=n),Br(t,e)}function SF(t,e){e===0&&(t.mode&1?(e=Eg,Eg<<=1,!(Eg&130023424)&&(Eg=4194304)):e=1);var n=Cr();t=Hs(t,e),t!==null&&(Uf(t,e,n),Br(t,n))}function OY(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),SF(t,n)}function AY(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ie(314))}r!==null&&r.delete(e),SF(t,n)}var bF;bF=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Wr.current)Fr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Fr=!1,vY(t,e,n);Fr=!!(t.flags&131072)}else Fr=!1,Wt&&e.flags&1048576&&T$(e,ew,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;hp(t,e),t=e.pendingProps;var i=zc(e,tr.current);Dc(e,n),i=BE(null,e,r,t,i,n);var o=UE();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Vr(r)?(o=!0,Zp(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,LE(e),i.updater=wv,e.stateNode=i,i._reactInternals=e,P0(e,r,t,n),e=I0(null,e,r,!0,o,n)):(e.tag=0,Wt&&o&&OE(e),gr(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(hp(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=HY(r),t=zi(r,t),i){case 0:e=A0(null,e,r,t,n);break e;case 1:e=rP(null,e,r,t,n);break e;case 11:e=tP(null,e,r,t,n);break e;case 14:e=nP(null,e,r,zi(r.type,t),n);break e}throw Error(ie(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:zi(r,i),A0(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:zi(r,i),rP(t,e,r,i,n);case 3:e:{if(oF(e),t===null)throw Error(ie(387));r=e.pendingProps,o=e.memoizedState,i=o.element,P$(t,e),rw(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=Kc(Error(ie(423)),e),e=iP(t,e,r,n,i);break e}else if(r!==i){i=Kc(Error(ie(424)),e),e=iP(t,e,r,n,i);break e}else for(Zr=Oa(e.stateNode.containerInfo.firstChild),ei=e,Wt=!0,Ki=null,n=H$(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Gc(),r===i){e=Ds(t,e,n);break e}gr(t,e,r,n)}e=e.child}return e;case 5:return D$(e),t===null&&_0(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,S0(r,i)?s=null:o!==null&&S0(r,o)&&(e.flags|=32),iF(t,e),gr(t,e,s,n),e.child;case 6:return t===null&&_0(e),null;case 13:return sF(t,e,n);case 4:return $E(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=jc(e,null,r,n):gr(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:zi(r,i),tP(t,e,r,i,n);case 7:return gr(t,e,e.pendingProps,n),e.child;case 8:return gr(t,e,e.pendingProps.children,n),e.child;case 12:return gr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,xt(tw,r._currentValue),r._currentValue=s,o!==null)if(no(o.value,s)){if(o.children===i.children&&!Wr.current){e=Ds(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=Ps(-1,n&-n),l.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),M0(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(ie(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),M0(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}gr(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Dc(e,n),i=Ri(i),r=r(i),e.flags|=1,gr(t,e,r,n),e.child;case 14:return r=e.type,i=zi(r,e.pendingProps),i=zi(r.type,i),nP(t,e,r,i,n);case 15:return nF(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:zi(r,i),hp(t,e),e.tag=1,Vr(r)?(t=!0,Zp(e)):t=!1,Dc(e,n),A$(e,r,i),P0(e,r,i,n),I0(null,e,r,!0,t,n);case 19:return aF(t,e,n);case 22:return rF(t,e,n)}throw Error(ie(156,e.tag))};function RF(t,e){return XL(t,e)}function IY(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yi(t,e,n,r){return new IY(t,e,n,r)}function JE(t){return t=t.prototype,!(!t||!t.isReactComponent)}function HY(t){if(typeof t=="function")return JE(t)?1:0;if(t!=null){if(t=t.$$typeof,t===vE)return 11;if(t===CE)return 14}return 2}function Da(t,e){var n=t.alternate;return n===null?(n=yi(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function gp(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")JE(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case fc:return jl(n.children,i,o,e);case wE:s=8,i|=8;break;case Jb:return t=yi(12,n,e,i|2),t.elementType=Jb,t.lanes=o,t;case e0:return t=yi(13,n,e,i),t.elementType=e0,t.lanes=o,t;case t0:return t=yi(19,n,e,i),t.elementType=t0,t.lanes=o,t;case IL:return Sv(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case OL:s=10;break e;case AL:s=9;break e;case vE:s=11;break e;case CE:s=14;break e;case ca:s=16,r=null;break e}throw Error(ie(130,t==null?t:typeof t,""))}return e=yi(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function jl(t,e,n,r){return t=yi(7,t,r,e),t.lanes=n,t}function Sv(t,e,n,r){return t=yi(22,t,r,e),t.elementType=IL,t.lanes=n,t.stateNode={isHidden:!1},t}function cy(t,e,n){return t=yi(6,t,null,e),t.lanes=n,t}function hy(t,e,n){return e=yi(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function DY(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=GC(0),this.expirationTimes=GC(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=GC(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function eT(t,e,n,r,i,o,s,a,l){return t=new DY(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=yi(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},LE(o),t}function NY(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function EF(t){if(!t)return Ba;t=t._reactInternals;e:{if(su(t)!==t||t.tag!==1)throw Error(ie(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Vr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ie(171))}if(t.tag===1){var n=t.type;if(Vr(n))return R$(t,n,e)}return e}function TF(t,e,n,r,i,o,s,a,l){return t=eT(n,r,!0,t,i,o,s,a,l),t.context=EF(null),n=t.current,r=Cr(),i=Ha(n),o=Ps(r,i),o.callback=e??null,Aa(n,o,i),t.current.lanes=i,Uf(t,i,r),Br(t,r),t}function bv(t,e,n,r){var i=e.current,o=Cr(),s=Ha(i);return n=EF(n),e.context===null?e.context=n:e.pendingContext=n,e=Ps(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Aa(i,e,s),t!==null&&(eo(t,i,s,o),lp(t,i,s)),s}function hw(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function gP(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function tT(t,e){gP(t,e),(t=t.alternate)&&gP(t,e)}function kY(){return null}var _F=typeof reportError=="function"?reportError:function(t){console.error(t)};function nT(t){this._internalRoot=t}Rv.prototype.render=nT.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ie(409));bv(t,e,null,null)};Rv.prototype.unmount=nT.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Zl(function(){bv(null,t,null,null)}),e[Is]=null}};function Rv(t){this._internalRoot=t}Rv.prototype.unstable_scheduleHydration=function(t){if(t){var e=n$();t={blockedOn:null,target:t,priority:e};for(var n=0;n<fa.length&&e!==0&&e<fa[n].priority;n++);fa.splice(n,0,t),n===0&&i$(t)}};function rT(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ev(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function mP(){}function LY(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var u=hw(s);o.call(u)}}var s=TF(e,r,t,0,null,!1,!1,"",mP);return t._reactRootContainer=s,t[Is]=s.current,cf(t.nodeType===8?t.parentNode:t),Zl(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=hw(l);a.call(u)}}var l=eT(t,0,!1,null,null,!1,!1,"",mP);return t._reactRootContainer=l,t[Is]=l.current,cf(t.nodeType===8?t.parentNode:t),Zl(function(){bv(e,l,n,r)}),l}function Tv(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var l=hw(s);a.call(l)}}bv(e,s,t,i)}else s=LY(n,e,t,i,r);return hw(s)}e$=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=pd(e.pendingLanes);n!==0&&(bE(e,n|1),Br(e,un()),!(ut&6)&&(Xc=un()+500,Za()))}break;case 13:Zl(function(){var r=Hs(t,1);if(r!==null){var i=Cr();eo(r,t,1,i)}}),tT(t,1)}};RE=function(t){if(t.tag===13){var e=Hs(t,134217728);if(e!==null){var n=Cr();eo(e,t,134217728,n)}tT(t,134217728)}};t$=function(t){if(t.tag===13){var e=Ha(t),n=Hs(t,e);if(n!==null){var r=Cr();eo(n,t,e,r)}tT(t,e)}};n$=function(){return Ct};r$=function(t,e){var n=Ct;try{return Ct=t,e()}finally{Ct=n}};h0=function(t,e,n){switch(e){case"input":if(i0(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=mv(r);if(!i)throw Error(ie(90));DL(r),i0(r,i)}}}break;case"textarea":kL(t,n);break;case"select":e=n.value,e!=null&&Oc(t,!!n.multiple,e,!1)}};UL=qE;zL=Zl;var $Y={usingClientEntryPoint:!1,Events:[Gf,wc,mv,VL,BL,qE]},_h={findFiberByHostInstance:kl,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},FY={bundleType:_h.bundleType,version:_h.version,rendererPackageName:_h.rendererPackageName,rendererConfig:_h.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=YL(t),t===null?null:t.stateNode},findFiberByHostInstance:_h.findFiberByHostInstance||kY,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ng=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ng.isDisabled&&Ng.supportsFiber)try{hv=Ng.inject(FY),Lo=Ng}catch{}}ii.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$Y;ii.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!rT(e))throw Error(ie(200));return NY(t,e,null,n)};ii.createRoot=function(t,e){if(!rT(t))throw Error(ie(299));var n=!1,r="",i=_F;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=eT(t,1,!1,null,null,n,!1,r,i),t[Is]=e.current,cf(t.nodeType===8?t.parentNode:t),new nT(e)};ii.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ie(188)):(t=Object.keys(t).join(","),Error(ie(268,t)));return t=YL(e),t=t===null?null:t.stateNode,t};ii.flushSync=function(t){return Zl(t)};ii.hydrate=function(t,e,n){if(!Ev(e))throw Error(ie(200));return Tv(null,t,e,!0,n)};ii.hydrateRoot=function(t,e,n){if(!rT(t))throw Error(ie(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=_F;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=TF(e,null,t,1,n??null,i,!1,o,s),t[Is]=e.current,cf(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Rv(e)};ii.render=function(t,e,n){if(!Ev(e))throw Error(ie(200));return Tv(null,t,e,!1,n)};ii.unmountComponentAtNode=function(t){if(!Ev(t))throw Error(ie(40));return t._reactRootContainer?(Zl(function(){Tv(null,null,t,!1,function(){t._reactRootContainer=null,t[Is]=null})}),!0):!1};ii.unstable_batchedUpdates=qE;ii.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Ev(n))throw Error(ie(200));if(t==null||t._reactInternals===void 0)throw Error(ie(38));return Tv(t,e,n,!1,r)};ii.version="18.2.0-next-9e3b772b8-20220608";function MF(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(MF)}catch(t){console.error(t)}}MF(),TL.exports=ii;var xF=TL.exports;const PF=Vf(xF);var pP=xF;Qb.createRoot=pP.createRoot,Qb.hydrateRoot=pP.hydrateRoot;var kg=function(t){return t&&t.Math===Math&&t},ir=kg(typeof globalThis=="object"&&globalThis)||kg(typeof window=="object"&&window)||kg(typeof self=="object"&&self)||kg(typeof Zi=="object"&&Zi)||function(){return this}()||Zi||Function("return this")(),iT={},_i=function(t){try{return!!t()}catch{return!0}},WY=_i,Vo=!WY(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),VY=_i,_v=!VY(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),BY=_v,Lg=Function.prototype.call,Mv=BY?Lg.bind(Lg):function(){return Lg.apply(Lg,arguments)},OF={},AF={}.propertyIsEnumerable,IF=Object.getOwnPropertyDescriptor,UY=IF&&!AF.call({1:2},1);OF.f=UY?function(e){var n=IF(this,e);return!!n&&n.enumerable}:AF;var oT=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},HF=_v,DF=Function.prototype,z0=DF.call,zY=HF&&DF.bind.bind(z0,z0),Er=HF?zY:function(t){return function(){return z0.apply(t,arguments)}},NF=Er,GY=NF({}.toString),jY=NF("".slice),sh=function(t){return jY(GY(t),8,-1)},YY=Er,KY=_i,XY=sh,dy=Object,qY=YY("".split),QY=KY(function(){return!dy("z").propertyIsEnumerable(0)})?function(t){return XY(t)==="String"?qY(t,""):dy(t)}:dy,kF=function(t){return t==null},ZY=kF,JY=TypeError,LF=function(t){if(ZY(t))throw new JY("Can't call method on "+t);return t},e3=QY,t3=LF,xv=function(t){return e3(t3(t))},G0=typeof document=="object"&&document.all,n3=typeof G0>"u"&&G0!==void 0,$F={all:G0,IS_HTMLDDA:n3},FF=$F,r3=FF.all,Un=FF.IS_HTMLDDA?function(t){return typeof t=="function"||t===r3}:function(t){return typeof t=="function"},wP=Un,WF=$F,i3=WF.all,au=WF.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:wP(t)||t===i3}:function(t){return typeof t=="object"?t!==null:wP(t)},fy=ir,o3=Un,s3=function(t){return o3(t)?t:void 0},Yf=function(t,e){return arguments.length<2?s3(fy[t]):fy[t]&&fy[t][e]},a3=Er,VF=a3({}.isPrototypeOf),sT=typeof navigator<"u"&&String(navigator.userAgent)||"",BF=ir,gy=sT,vP=BF.process,CP=BF.Deno,yP=vP&&vP.versions||CP&&CP.version,SP=yP&&yP.v8,Xi,dw;SP&&(Xi=SP.split("."),dw=Xi[0]>0&&Xi[0]<4?1:+(Xi[0]+Xi[1]));!dw&&gy&&(Xi=gy.match(/Edge\/(\d+)/),(!Xi||Xi[1]>=74)&&(Xi=gy.match(/Chrome\/(\d+)/),Xi&&(dw=+Xi[1])));var l3=dw,bP=l3,u3=_i,c3=ir,h3=c3.String,aT=!!Object.getOwnPropertySymbols&&!u3(function(){var t=Symbol("symbol detection");return!h3(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&bP&&bP<41}),d3=aT,UF=d3&&!Symbol.sham&&typeof Symbol.iterator=="symbol",f3=Yf,g3=Un,m3=VF,p3=UF,w3=Object,lT=p3?function(t){return typeof t=="symbol"}:function(t){var e=f3("Symbol");return g3(e)&&m3(e.prototype,w3(t))},v3=String,zF=function(t){try{return v3(t)}catch{return"Object"}},C3=Un,y3=zF,S3=TypeError,uT=function(t){if(C3(t))return t;throw new S3(y3(t)+" is not a function")},b3=uT,R3=kF,E3=function(t,e){var n=t[e];return R3(n)?void 0:b3(n)},my=Mv,py=Un,wy=au,T3=TypeError,_3=function(t,e){var n,r;if(e==="string"&&py(n=t.toString)&&!wy(r=my(n,t))||py(n=t.valueOf)&&!wy(r=my(n,t))||e!=="string"&&py(n=t.toString)&&!wy(r=my(n,t)))return r;throw new T3("Can't convert object to primitive value")},GF={exports:{}},RP=ir,M3=Object.defineProperty,cT=function(t,e){try{M3(RP,t,{value:e,configurable:!0,writable:!0})}catch{RP[t]=e}return e},x3=ir,P3=cT,EP="__core-js_shared__",O3=x3[EP]||P3(EP,{}),hT=O3,TP=hT;(GF.exports=function(t,e){return TP[t]||(TP[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.33.2",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.2/LICENSE",source:"https://github.com/zloirock/core-js"});var jF=GF.exports,A3=LF,I3=Object,Pv=function(t){return I3(A3(t))},H3=Er,D3=Pv,N3=H3({}.hasOwnProperty),Ws=Object.hasOwn||function(e,n){return N3(D3(e),n)},k3=Er,L3=0,$3=Math.random(),F3=k3(1 .toString),YF=function(t){return"Symbol("+(t===void 0?"":t)+")_"+F3(++L3+$3,36)},W3=ir,V3=jF,_P=Ws,B3=YF,U3=aT,z3=UF,Ec=W3.Symbol,vy=V3("wks"),G3=z3?Ec.for||Ec:Ec&&Ec.withoutSetter||B3,Ov=function(t){return _P(vy,t)||(vy[t]=U3&&_P(Ec,t)?Ec[t]:G3("Symbol."+t)),vy[t]},j3=Mv,MP=au,xP=lT,Y3=E3,K3=_3,X3=Ov,q3=TypeError,Q3=X3("toPrimitive"),Z3=function(t,e){if(!MP(t)||xP(t))return t;var n=Y3(t,Q3),r;if(n){if(e===void 0&&(e="default"),r=j3(n,t,e),!MP(r)||xP(r))return r;throw new q3("Can't convert object to primitive value")}return e===void 0&&(e="number"),K3(t,e)},J3=Z3,e4=lT,KF=function(t){var e=J3(t,"string");return e4(e)?e:e+""},t4=ir,PP=au,j0=t4.document,n4=PP(j0)&&PP(j0.createElement),dT=function(t){return n4?j0.createElement(t):{}},r4=Vo,i4=_i,o4=dT,XF=!r4&&!i4(function(){return Object.defineProperty(o4("div"),"a",{get:function(){return 7}}).a!==7}),s4=Vo,a4=Mv,l4=OF,u4=oT,c4=xv,h4=KF,d4=Ws,f4=XF,OP=Object.getOwnPropertyDescriptor;iT.f=s4?OP:function(e,n){if(e=c4(e),n=h4(n),f4)try{return OP(e,n)}catch{}if(d4(e,n))return u4(!a4(l4.f,e,n),e[n])};var lu={},g4=Vo,m4=_i,qF=g4&&m4(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),p4=au,w4=String,v4=TypeError,Kf=function(t){if(p4(t))return t;throw new v4(w4(t)+" is not an object")},C4=Vo,y4=XF,S4=qF,$g=Kf,AP=KF,b4=TypeError,Cy=Object.defineProperty,R4=Object.getOwnPropertyDescriptor,yy="enumerable",Sy="configurable",by="writable";lu.f=C4?S4?function(e,n,r){if($g(e),n=AP(n),$g(r),typeof e=="function"&&n==="prototype"&&"value"in r&&by in r&&!r[by]){var i=R4(e,n);i&&i[by]&&(e[n]=r.value,r={configurable:Sy in r?r[Sy]:i[Sy],enumerable:yy in r?r[yy]:i[yy],writable:!1})}return Cy(e,n,r)}:Cy:function(e,n,r){if($g(e),n=AP(n),$g(r),y4)try{return Cy(e,n,r)}catch{}if("get"in r||"set"in r)throw new b4("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var E4=Vo,T4=lu,_4=oT,Xf=E4?function(t,e,n){return T4.f(t,e,_4(1,n))}:function(t,e,n){return t[e]=n,t},QF={exports:{}},Y0=Vo,M4=Ws,ZF=Function.prototype,x4=Y0&&Object.getOwnPropertyDescriptor,fT=M4(ZF,"name"),P4=fT&&(function(){}).name==="something",O4=fT&&(!Y0||Y0&&x4(ZF,"name").configurable),A4={EXISTS:fT,PROPER:P4,CONFIGURABLE:O4},I4=Er,H4=Un,K0=hT,D4=I4(Function.toString);H4(K0.inspectSource)||(K0.inspectSource=function(t){return D4(t)});var N4=K0.inspectSource,k4=ir,L4=Un,IP=k4.WeakMap,$4=L4(IP)&&/native code/.test(String(IP)),F4=jF,W4=YF,HP=F4("keys"),JF=function(t){return HP[t]||(HP[t]=W4(t))},gT={},V4=$4,eW=ir,B4=au,U4=Xf,Ry=Ws,Ey=hT,z4=JF,G4=gT,DP="Object already initialized",X0=eW.TypeError,j4=eW.WeakMap,fw,Cf,gw,Y4=function(t){return gw(t)?Cf(t):fw(t,{})},K4=function(t){return function(e){var n;if(!B4(e)||(n=Cf(e)).type!==t)throw new X0("Incompatible receiver, "+t+" required");return n}};if(V4||Ey.state){var co=Ey.state||(Ey.state=new j4);co.get=co.get,co.has=co.has,co.set=co.set,fw=function(t,e){if(co.has(t))throw new X0(DP);return e.facade=t,co.set(t,e),e},Cf=function(t){return co.get(t)||{}},gw=function(t){return co.has(t)}}else{var yu=z4("state");G4[yu]=!0,fw=function(t,e){if(Ry(t,yu))throw new X0(DP);return e.facade=t,U4(t,yu,e),e},Cf=function(t){return Ry(t,yu)?t[yu]:{}},gw=function(t){return Ry(t,yu)}}var X4={set:fw,get:Cf,has:gw,enforce:Y4,getterFor:K4},mT=Er,q4=_i,Q4=Un,Fg=Ws,q0=Vo,Z4=A4.CONFIGURABLE,J4=N4,tW=X4,eK=tW.enforce,tK=tW.get,NP=String,mp=Object.defineProperty,nK=mT("".slice),rK=mT("".replace),iK=mT([].join),oK=q0&&!q4(function(){return mp(function(){},"length",{value:8}).length!==8}),sK=String(String).split("String"),aK=QF.exports=function(t,e,n){nK(NP(e),0,7)==="Symbol("&&(e="["+rK(NP(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Fg(t,"name")||Z4&&t.name!==e)&&(q0?mp(t,"name",{value:e,configurable:!0}):t.name=e),oK&&n&&Fg(n,"arity")&&t.length!==n.arity&&mp(t,"length",{value:n.arity});try{n&&Fg(n,"constructor")&&n.constructor?q0&&mp(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=eK(t);return Fg(r,"source")||(r.source=iK(sK,typeof e=="string"?e:"")),t};Function.prototype.toString=aK(function(){return Q4(this)&&tK(this).source||J4(this)},"toString");var lK=QF.exports,uK=Un,cK=lu,hK=lK,dK=cT,fK=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(uK(n)&&hK(n,o,r),r.global)i?t[e]=n:dK(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:cK.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},nW={},gK=Math.ceil,mK=Math.floor,pK=Math.trunc||function(e){var n=+e;return(n>0?mK:gK)(n)},wK=pK,pT=function(t){var e=+t;return e!==e||e===0?0:wK(e)},vK=pT,CK=Math.max,yK=Math.min,SK=function(t,e){var n=vK(t);return n<0?CK(n+e,0):yK(n,e)},bK=pT,RK=Math.min,EK=function(t){return t>0?RK(bK(t),9007199254740991):0},TK=EK,Av=function(t){return TK(t.length)},_K=xv,MK=SK,xK=Av,kP=function(t){return function(e,n,r){var i=_K(e),o=xK(i),s=MK(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},PK={includes:kP(!0),indexOf:kP(!1)},OK=Er,Ty=Ws,AK=xv,IK=PK.indexOf,HK=gT,LP=OK([].push),rW=function(t,e){var n=AK(t),r=0,i=[],o;for(o in n)!Ty(HK,o)&&Ty(n,o)&&LP(i,o);for(;e.length>r;)Ty(n,o=e[r++])&&(~IK(i,o)||LP(i,o));return i},wT=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],DK=rW,NK=wT,kK=NK.concat("length","prototype");nW.f=Object.getOwnPropertyNames||function(e){return DK(e,kK)};var iW={};iW.f=Object.getOwnPropertySymbols;var LK=Yf,$K=Er,FK=nW,WK=iW,VK=Kf,BK=$K([].concat),UK=LK("Reflect","ownKeys")||function(e){var n=FK.f(VK(e)),r=WK.f;return r?BK(n,r(e)):n},$P=Ws,zK=UK,GK=iT,jK=lu,oW=function(t,e,n){for(var r=zK(e),i=jK.f,o=GK.f,s=0;s<r.length;s++){var a=r[s];!$P(t,a)&&!(n&&$P(n,a))&&i(t,a,o(e,a))}},YK=_i,KK=Un,XK=/#|\.prototype\./,qf=function(t,e){var n=QK[qK(t)];return n===JK?!0:n===ZK?!1:KK(e)?YK(e):!!e},qK=qf.normalize=function(t){return String(t).replace(XK,".").toLowerCase()},QK=qf.data={},ZK=qf.NATIVE="N",JK=qf.POLYFILL="P",e8=qf,_y=ir,t8=iT.f,n8=Xf,r8=fK,i8=cT,o8=oW,s8=e8,uu=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=_y:i?s=_y[n]||i8(n,{}):s=(_y[n]||{}).prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=t8(s,a),l=c&&c.value):l=s[a],o=s8(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;o8(u,l)}(t.sham||l&&l.sham)&&n8(u,"sham",!0),r8(s,a,u,t)}},a8=sh,sW=Array.isArray||function(e){return a8(e)==="Array"},l8=Vo,u8=sW,c8=TypeError,h8=Object.getOwnPropertyDescriptor,d8=l8&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),aW=d8?function(t,e){if(u8(t)&&!h8(t,"length").writable)throw new c8("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},f8=TypeError,g8=9007199254740991,lW=function(t){if(t>g8)throw f8("Maximum allowed index exceeded");return t},m8=uu,p8=Pv,w8=Av,v8=aW,C8=lW,y8=_i,S8=y8(function(){return[].push.call({length:4294967296},1)!==4294967297}),b8=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},R8=S8||!b8();m8({target:"Array",proto:!0,arity:1,forced:R8},{push:function(e){var n=p8(this),r=w8(n),i=arguments.length;C8(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return v8(n,r),r}});var E8=_v,uW=Function.prototype,FP=uW.apply,WP=uW.call,Iv=typeof Reflect=="object"&&Reflect.apply||(E8?WP.bind(FP):function(){return WP.apply(FP,arguments)}),T8=Er,_8=uT,M8=function(t,e,n){try{return T8(_8(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},x8=Un,P8=String,O8=TypeError,A8=function(t){if(typeof t=="object"||x8(t))return t;throw new O8("Can't set "+P8(t)+" as a prototype")},I8=M8,H8=Kf,D8=A8,cW=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=I8(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return H8(i),D8(o),t?n(i,o):i.__proto__=o,i}}():void 0),N8=lu.f,k8=function(t,e,n){n in t||N8(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},L8=Un,$8=au,VP=cW,F8=function(t,e,n){var r,i;return VP&&L8(r=e.constructor)&&r!==n&&$8(i=r.prototype)&&i!==n.prototype&&VP(t,i),t},W8=Ov,V8=W8("toStringTag"),hW={};hW[V8]="z";var B8=String(hW)==="[object z]",U8=B8,z8=Un,pp=sh,G8=Ov,j8=G8("toStringTag"),Y8=Object,K8=pp(function(){return arguments}())==="Arguments",X8=function(t,e){try{return t[e]}catch{}},q8=U8?pp:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=X8(e=Y8(t),j8))=="string"?n:K8?pp(e):(r=pp(e))==="Object"&&z8(e.callee)?"Arguments":r},Q8=q8,Z8=String,dW=function(t){if(Q8(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return Z8(t)},J8=dW,e6=function(t,e){return t===void 0?arguments.length<2?"":e:J8(t)},t6=au,n6=Xf,r6=function(t,e){t6(e)&&"cause"in e&&n6(t,"cause",e.cause)},i6=Er,fW=Error,o6=i6("".replace),s6=function(t){return String(new fW(t).stack)}("zxcasd"),gW=/\n\s*at [^:]*:[^\n]*/,a6=gW.test(s6),l6=function(t,e){if(a6&&typeof t=="string"&&!fW.prepareStackTrace)for(;e--;)t=o6(t,gW,"");return t},u6=_i,c6=oT,h6=!u6(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",c6(1,7)),t.stack!==7):!0}),d6=Xf,f6=l6,g6=h6,BP=Error.captureStackTrace,m6=function(t,e,n,r){g6&&(BP?BP(t,e):d6(t,"stack",f6(n,r)))},UP=Yf,p6=Ws,zP=Xf,w6=VF,GP=cW,jP=oW,YP=k8,v6=F8,C6=e6,y6=r6,S6=m6,b6=Vo,R6=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=UP.apply(null,s);if(l){var u=l.prototype;if(p6(u,"cause")&&delete u.cause,!n)return l;var c=UP("Error"),h=e(function(f,g){var p=C6(r?g:f,void 0),y=r?new l(f):new l;return p!==void 0&&zP(y,"message",p),S6(y,h,y.stack,2),this&&w6(u,this)&&v6(y,this,h),arguments.length>o&&y6(y,arguments[o]),y});h.prototype=u,a!=="Error"?GP?GP(h,c):jP(h,c,{name:!0}):b6&&i in l&&(YP(h,l,i),YP(h,l,"prepareStackTrace")),jP(h,l);try{u.name!==a&&zP(u,"name",a),u.constructor=h}catch{}return h}},mW=uu,E6=ir,Bo=Iv,pW=R6,Q0="WebAssembly",KP=E6[Q0],mw=new Error("e",{cause:7}).cause!==7,cu=function(t,e){var n={};n[t]=pW(t,e,mw),mW({global:!0,constructor:!0,arity:1,forced:mw},n)},vT=function(t,e){if(KP&&KP[t]){var n={};n[t]=pW(Q0+"."+t,e,mw),mW({target:Q0,stat:!0,constructor:!0,arity:1,forced:mw},n)}};cu("Error",function(t){return function(n){return Bo(t,this,arguments)}});cu("EvalError",function(t){return function(n){return Bo(t,this,arguments)}});cu("RangeError",function(t){return function(n){return Bo(t,this,arguments)}});cu("ReferenceError",function(t){return function(n){return Bo(t,this,arguments)}});cu("SyntaxError",function(t){return function(n){return Bo(t,this,arguments)}});cu("TypeError",function(t){return function(n){return Bo(t,this,arguments)}});cu("URIError",function(t){return function(n){return Bo(t,this,arguments)}});vT("CompileError",function(t){return function(n){return Bo(t,this,arguments)}});vT("LinkError",function(t){return function(n){return Bo(t,this,arguments)}});vT("RuntimeError",function(t){return function(n){return Bo(t,this,arguments)}});var T6=sh,_6=Er,M6=function(t){if(T6(t)==="Function")return _6(t)},XP=M6,x6=uT,P6=_v,O6=XP(XP.bind),A6=function(t,e){return x6(t),e===void 0?t:P6?O6(t,e):function(){return t.apply(e,arguments)}},I6=Yf,wW=I6("document","documentElement"),H6=Er,CT=H6([].slice),D6=TypeError,vW=function(t,e){if(t<e)throw new D6("Not enough arguments");return t},N6=sT,k6=/(?:ipad|iphone|ipod).*applewebkit/i.test(N6),L6=ir,$6=sh,F6=$6(L6.process)==="process",Jr=ir,W6=Iv,V6=A6,qP=Un,B6=Ws,CW=_i,QP=wW,U6=CT,ZP=dT,z6=vW,G6=k6,j6=F6,Z0=Jr.setImmediate,J0=Jr.clearImmediate,Y6=Jr.process,My=Jr.Dispatch,K6=Jr.Function,JP=Jr.MessageChannel,X6=Jr.String,xy=0,Hd={},eO="onreadystatechange",yf,tl,Py,Oy;CW(function(){yf=Jr.location});var yT=function(t){if(B6(Hd,t)){var e=Hd[t];delete Hd[t],e()}},Ay=function(t){return function(){yT(t)}},tO=function(t){yT(t.data)},nO=function(t){Jr.postMessage(X6(t),yf.protocol+"//"+yf.host)};(!Z0||!J0)&&(Z0=function(e){z6(arguments.length,1);var n=qP(e)?e:K6(e),r=U6(arguments,1);return Hd[++xy]=function(){W6(n,void 0,r)},tl(xy),xy},J0=function(e){delete Hd[e]},j6?tl=function(t){Y6.nextTick(Ay(t))}:My&&My.now?tl=function(t){My.now(Ay(t))}:JP&&!G6?(Py=new JP,Oy=Py.port2,Py.port1.onmessage=tO,tl=V6(Oy.postMessage,Oy)):Jr.addEventListener&&qP(Jr.postMessage)&&!Jr.importScripts&&yf&&yf.protocol!=="file:"&&!CW(nO)?(tl=nO,Jr.addEventListener("message",tO,!1)):eO in ZP("script")?tl=function(t){QP.appendChild(ZP("script"))[eO]=function(){QP.removeChild(this),yT(t)}}:tl=function(t){setTimeout(Ay(t),0)});var yW={set:Z0,clear:J0},q6=uu,Q6=ir,rO=yW.clear;q6({global:!0,bind:!0,enumerable:!0,forced:Q6.clearImmediate!==rO},{clearImmediate:rO});var Z6=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",SW=ir,J6=Iv,e5=Un,t5=Z6,n5=sT,r5=CT,i5=vW,o5=SW.Function,s5=/MSIE .\./.test(n5)||t5&&function(){var t=SW.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),a5=function(t,e){var n=e?2:1;return s5?function(r,i){var o=i5(arguments.length,1)>n,s=e5(r)?r:o5(r),a=o?r5(arguments,n):[],l=o?function(){J6(s,this,a)}:s;return e?t(l,i):t(l)}:t},l5=uu,bW=ir,iO=yW.set,u5=a5,oO=bW.setImmediate?u5(iO,!1):iO;l5({global:!0,bind:!0,enumerable:!0,forced:bW.setImmediate!==oO},{setImmediate:oO});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function ma(t){"@babel/helpers - typeof";return ma=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ma(t)}function eR(t,e){return eR=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},eR(t,e)}function c5(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wp(t,e,n){return c5()?wp=Reflect.construct:wp=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),u=new l;return s&&eR(u,s.prototype),u},wp.apply(null,arguments)}function Vi(t){return h5(t)||d5(t)||f5(t)||g5()}function h5(t){if(Array.isArray(t))return tR(t)}function d5(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function f5(t,e){if(t){if(typeof t=="string")return tR(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tR(t,e)}}function tR(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function g5(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var m5=Object.hasOwnProperty,sO=Object.setPrototypeOf,p5=Object.isFrozen,w5=Object.getPrototypeOf,v5=Object.getOwnPropertyDescriptor,Sr=Object.freeze,ro=Object.seal,C5=Object.create,RW=typeof Reflect<"u"&&Reflect,pw=RW.apply,nR=RW.construct;pw||(pw=function(e,n,r){return e.apply(n,r)});Sr||(Sr=function(e){return e});ro||(ro=function(e){return e});nR||(nR=function(e,n){return wp(e,Vi(n))});var y5=Ti(Array.prototype.forEach),aO=Ti(Array.prototype.pop),Mh=Ti(Array.prototype.push),vp=Ti(String.prototype.toLowerCase),Iy=Ti(String.prototype.toString),S5=Ti(String.prototype.match),Ai=Ti(String.prototype.replace),b5=Ti(String.prototype.indexOf),R5=Ti(String.prototype.trim),lr=Ti(RegExp.prototype.test),Hy=E5(TypeError);function Ti(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return pw(t,e,r)}}function E5(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return nR(t,n)}}function Ze(t,e,n){var r;n=(r=n)!==null&&r!==void 0?r:vp,sO&&sO(t,null);for(var i=e.length;i--;){var o=e[i];if(typeof o=="string"){var s=n(o);s!==o&&(p5(e)||(e[i]=s),o=s)}t[o]=!0}return t}function nl(t){var e=C5(null),n;for(n in t)pw(m5,t,[n])===!0&&(e[n]=t[n]);return e}function Wg(t,e){for(;t!==null;){var n=v5(t,e);if(n){if(n.get)return Ti(n.get);if(typeof n.value=="function")return Ti(n.value)}t=w5(t)}function r(i){return console.warn("fallback value for",i),null}return r}var lO=Sr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Dy=Sr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ny=Sr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),T5=Sr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ky=Sr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),_5=Sr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),uO=Sr(["#text"]),cO=Sr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Ly=Sr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),hO=Sr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Vg=Sr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),M5=ro(/\{\{[\w\W]*|[\w\W]*\}\}/gm),x5=ro(/<%[\w\W]*|[\w\W]*%>/gm),P5=ro(/\${[\w\W]*}/gm),O5=ro(/^data-[\-\w.\u00B7-\uFFFF]/),A5=ro(/^aria-[\-\w]+$/),I5=ro(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),H5=ro(/^(?:\w+script|data):/i),D5=ro(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),N5=ro(/^html$/i),k5=function(){return typeof window>"u"?null:window},L5=function(e,n){if(ma(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function EW(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:k5(),e=function($){return EW($)};if(e.version="2.4.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,r=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,h=t.HTMLFormElement,f=t.DOMParser,g=t.trustedTypes,p=a.prototype,y=Wg(p,"cloneNode"),E=Wg(p,"nextSibling"),v=Wg(p,"childNodes"),C=Wg(p,"parentNode");if(typeof o=="function"){var S=r.createElement("template");S.content&&S.content.ownerDocument&&(r=S.content.ownerDocument)}var T=L5(g,n),_=T?T.createHTML(""):"",A=r,D=A.implementation,U=A.createNodeIterator,z=A.createDocumentFragment,G=A.getElementsByTagName,Z=n.importNode,re={};try{re=nl(r).documentMode?r.documentMode:{}}catch{}var ne={};e.isSupported=typeof C=="function"&&D&&D.createHTMLDocument!==void 0&&re!==9;var he=M5,Me=x5,Ve=P5,ke=O5,R=A5,d=H5,m=D5,w=I5,x=null,O=Ze({},[].concat(Vi(lO),Vi(Dy),Vi(Ny),Vi(ky),Vi(uO))),H=null,K=Ze({},[].concat(Vi(cO),Vi(Ly),Vi(hO),Vi(Vg))),B=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Q=null,ee=null,q=!0,me=!0,He=!1,Pe=!0,De=!1,X=!1,Qe=!1,Be=!1,Te=!1,Le=!1,xe=!1,b=!0,M=!1,I="user-content-",V=!0,N=!1,W={},k=null,L=Ze({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),j=null,F=Ze({},["audio","video","img","source","image","track"]),Y=null,ae=Ze({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),pe="http://www.w3.org/1998/Math/MathML",_e="http://www.w3.org/2000/svg",Ne="http://www.w3.org/1999/xhtml",Ge=Ne,Mt=!1,tt=null,mt=Ze({},[pe,_e,Ne],Iy),kt,vu=["application/xhtml+xml","text/html"],wh="text/html",tn,Nn=null,el=r.createElement("form"),ar=function($){return $ instanceof RegExp||$ instanceof Function},yn=function($){Nn&&Nn===$||((!$||ma($)!=="object")&&($={}),$=nl($),kt=vu.indexOf($.PARSER_MEDIA_TYPE)===-1?kt=wh:kt=$.PARSER_MEDIA_TYPE,tn=kt==="application/xhtml+xml"?Iy:vp,x="ALLOWED_TAGS"in $?Ze({},$.ALLOWED_TAGS,tn):O,H="ALLOWED_ATTR"in $?Ze({},$.ALLOWED_ATTR,tn):K,tt="ALLOWED_NAMESPACES"in $?Ze({},$.ALLOWED_NAMESPACES,Iy):mt,Y="ADD_URI_SAFE_ATTR"in $?Ze(nl(ae),$.ADD_URI_SAFE_ATTR,tn):ae,j="ADD_DATA_URI_TAGS"in $?Ze(nl(F),$.ADD_DATA_URI_TAGS,tn):F,k="FORBID_CONTENTS"in $?Ze({},$.FORBID_CONTENTS,tn):L,Q="FORBID_TAGS"in $?Ze({},$.FORBID_TAGS,tn):{},ee="FORBID_ATTR"in $?Ze({},$.FORBID_ATTR,tn):{},W="USE_PROFILES"in $?$.USE_PROFILES:!1,q=$.ALLOW_ARIA_ATTR!==!1,me=$.ALLOW_DATA_ATTR!==!1,He=$.ALLOW_UNKNOWN_PROTOCOLS||!1,Pe=$.ALLOW_SELF_CLOSE_IN_ATTR!==!1,De=$.SAFE_FOR_TEMPLATES||!1,X=$.WHOLE_DOCUMENT||!1,Te=$.RETURN_DOM||!1,Le=$.RETURN_DOM_FRAGMENT||!1,xe=$.RETURN_TRUSTED_TYPE||!1,Be=$.FORCE_BODY||!1,b=$.SANITIZE_DOM!==!1,M=$.SANITIZE_NAMED_PROPS||!1,V=$.KEEP_CONTENT!==!1,N=$.IN_PLACE||!1,w=$.ALLOWED_URI_REGEXP||w,Ge=$.NAMESPACE||Ne,B=$.CUSTOM_ELEMENT_HANDLING||{},$.CUSTOM_ELEMENT_HANDLING&&ar($.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(B.tagNameCheck=$.CUSTOM_ELEMENT_HANDLING.tagNameCheck),$.CUSTOM_ELEMENT_HANDLING&&ar($.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(B.attributeNameCheck=$.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),$.CUSTOM_ELEMENT_HANDLING&&typeof $.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(B.allowCustomizedBuiltInElements=$.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),De&&(me=!1),Le&&(Te=!0),W&&(x=Ze({},Vi(uO)),H=[],W.html===!0&&(Ze(x,lO),Ze(H,cO)),W.svg===!0&&(Ze(x,Dy),Ze(H,Ly),Ze(H,Vg)),W.svgFilters===!0&&(Ze(x,Ny),Ze(H,Ly),Ze(H,Vg)),W.mathMl===!0&&(Ze(x,ky),Ze(H,hO),Ze(H,Vg))),$.ADD_TAGS&&(x===O&&(x=nl(x)),Ze(x,$.ADD_TAGS,tn)),$.ADD_ATTR&&(H===K&&(H=nl(H)),Ze(H,$.ADD_ATTR,tn)),$.ADD_URI_SAFE_ATTR&&Ze(Y,$.ADD_URI_SAFE_ATTR,tn),$.FORBID_CONTENTS&&(k===L&&(k=nl(k)),Ze(k,$.FORBID_CONTENTS,tn)),V&&(x["#text"]=!0),X&&Ze(x,["html","head","body"]),x.table&&(Ze(x,["tbody"]),delete Q.tbody),Sr&&Sr($),Nn=$)},Pt=Ze({},["mi","mo","mn","ms","mtext"]),ex=Ze({},["foreignobject","desc","title","annotation-xml"]),hG=Ze({},["title","style","font","a","script"]),wg=Ze({},Dy);Ze(wg,Ny),Ze(wg,T5);var LC=Ze({},ky);Ze(LC,_5);var dG=function($){var se=C($);(!se||!se.tagName)&&(se={namespaceURI:Ge,tagName:"template"});var de=vp($.tagName),gt=vp(se.tagName);return tt[$.namespaceURI]?$.namespaceURI===_e?se.namespaceURI===Ne?de==="svg":se.namespaceURI===pe?de==="svg"&&(gt==="annotation-xml"||Pt[gt]):!!wg[de]:$.namespaceURI===pe?se.namespaceURI===Ne?de==="math":se.namespaceURI===_e?de==="math"&&ex[gt]:!!LC[de]:$.namespaceURI===Ne?se.namespaceURI===_e&&!ex[gt]||se.namespaceURI===pe&&!Pt[gt]?!1:!LC[de]&&(hG[de]||!wg[de]):!!(kt==="application/xhtml+xml"&&tt[$.namespaceURI]):!1},jo=function($){Mh(e.removed,{element:$});try{$.parentNode.removeChild($)}catch{try{$.outerHTML=_}catch{$.remove()}}},$C=function($,se){try{Mh(e.removed,{attribute:se.getAttributeNode($),from:se})}catch{Mh(e.removed,{attribute:null,from:se})}if(se.removeAttribute($),$==="is"&&!H[$])if(Te||Le)try{jo(se)}catch{}else try{se.setAttribute($,"")}catch{}},tx=function($){var se,de;if(Be)$="<remove></remove>"+$;else{var gt=S5($,/^[\r\n\t ]+/);de=gt&&gt[0]}kt==="application/xhtml+xml"&&Ge===Ne&&($='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+$+"</body></html>");var _r=T?T.createHTML($):$;if(Ge===Ne)try{se=new f().parseFromString(_r,kt)}catch{}if(!se||!se.documentElement){se=D.createDocument(Ge,"template",null);try{se.documentElement.innerHTML=Mt?_:_r}catch{}}var zn=se.body||se.documentElement;return $&&de&&zn.insertBefore(r.createTextNode(de),zn.childNodes[0]||null),Ge===Ne?G.call(se,X?"html":"body")[0]:X?se.documentElement:zn},nx=function($){return U.call($.ownerDocument||$,$,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},fG=function($){return $ instanceof h&&(typeof $.nodeName!="string"||typeof $.textContent!="string"||typeof $.removeChild!="function"||!($.attributes instanceof c)||typeof $.removeAttribute!="function"||typeof $.setAttribute!="function"||typeof $.namespaceURI!="string"||typeof $.insertBefore!="function"||typeof $.hasChildNodes!="function")},vh=function($){return ma(s)==="object"?$ instanceof s:$&&ma($)==="object"&&typeof $.nodeType=="number"&&typeof $.nodeName=="string"},Yo=function($,se,de){ne[$]&&y5(ne[$],function(gt){gt.call(e,se,de,Nn)})},rx=function($){var se;if(Yo("beforeSanitizeElements",$,null),fG($)||lr(/[\u0080-\uFFFF]/,$.nodeName))return jo($),!0;var de=tn($.nodeName);if(Yo("uponSanitizeElement",$,{tagName:de,allowedTags:x}),$.hasChildNodes()&&!vh($.firstElementChild)&&(!vh($.content)||!vh($.content.firstElementChild))&&lr(/<[/\w]/g,$.innerHTML)&&lr(/<[/\w]/g,$.textContent)||de==="select"&&lr(/<template/i,$.innerHTML))return jo($),!0;if(!x[de]||Q[de]){if(!Q[de]&&ox(de)&&(B.tagNameCheck instanceof RegExp&&lr(B.tagNameCheck,de)||B.tagNameCheck instanceof Function&&B.tagNameCheck(de)))return!1;if(V&&!k[de]){var gt=C($)||$.parentNode,_r=v($)||$.childNodes;if(_r&&gt)for(var zn=_r.length,kn=zn-1;kn>=0;--kn)gt.insertBefore(y(_r[kn],!0),E($))}return jo($),!0}return $ instanceof a&&!dG($)||(de==="noscript"||de==="noembed"||de==="noframes")&&lr(/<\/no(script|embed|frames)/i,$.innerHTML)?(jo($),!0):(De&&$.nodeType===3&&(se=$.textContent,se=Ai(se,he," "),se=Ai(se,Me," "),se=Ai(se,Ve," "),$.textContent!==se&&(Mh(e.removed,{element:$.cloneNode()}),$.textContent=se)),Yo("afterSanitizeElements",$,null),!1)},ix=function($,se,de){if(b&&(se==="id"||se==="name")&&(de in r||de in el))return!1;if(!(me&&!ee[se]&&lr(ke,se))){if(!(q&&lr(R,se))){if(!H[se]||ee[se]){if(!(ox($)&&(B.tagNameCheck instanceof RegExp&&lr(B.tagNameCheck,$)||B.tagNameCheck instanceof Function&&B.tagNameCheck($))&&(B.attributeNameCheck instanceof RegExp&&lr(B.attributeNameCheck,se)||B.attributeNameCheck instanceof Function&&B.attributeNameCheck(se))||se==="is"&&B.allowCustomizedBuiltInElements&&(B.tagNameCheck instanceof RegExp&&lr(B.tagNameCheck,de)||B.tagNameCheck instanceof Function&&B.tagNameCheck(de))))return!1}else if(!Y[se]){if(!lr(w,Ai(de,m,""))){if(!((se==="src"||se==="xlink:href"||se==="href")&&$!=="script"&&b5(de,"data:")===0&&j[$])){if(!(He&&!lr(d,Ai(de,m,"")))){if(de)return!1}}}}}}return!0},ox=function($){return $.indexOf("-")>0},sx=function($){var se,de,gt,_r;Yo("beforeSanitizeAttributes",$,null);var zn=$.attributes;if(zn){var kn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:H};for(_r=zn.length;_r--;){se=zn[_r];var vg=se,_n=vg.name,FC=vg.namespaceURI;if(de=_n==="value"?se.value:R5(se.value),gt=tn(_n),kn.attrName=gt,kn.attrValue=de,kn.keepAttr=!0,kn.forceKeepAttr=void 0,Yo("uponSanitizeAttribute",$,kn),de=kn.attrValue,!kn.forceKeepAttr&&($C(_n,$),!!kn.keepAttr)){if(!Pe&&lr(/\/>/i,de)){$C(_n,$);continue}De&&(de=Ai(de,he," "),de=Ai(de,Me," "),de=Ai(de,Ve," "));var ax=tn($.nodeName);if(ix(ax,gt,de)){if(M&&(gt==="id"||gt==="name")&&($C(_n,$),de=I+de),T&&ma(g)==="object"&&typeof g.getAttributeType=="function"&&!FC)switch(g.getAttributeType(ax,gt)){case"TrustedHTML":{de=T.createHTML(de);break}case"TrustedScriptURL":{de=T.createScriptURL(de);break}}try{FC?$.setAttributeNS(FC,_n,de):$.setAttribute(_n,de),aO(e.removed)}catch{}}}}Yo("afterSanitizeAttributes",$,null)}},gG=function Oe($){var se,de=nx($);for(Yo("beforeSanitizeShadowDOM",$,null);se=de.nextNode();)Yo("uponSanitizeShadowNode",se,null),!rx(se)&&(se.content instanceof i&&Oe(se.content),sx(se));Yo("afterSanitizeShadowDOM",$,null)};return e.sanitize=function(Oe){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},se,de,gt,_r,zn;if(Mt=!Oe,Mt&&(Oe="<!-->"),typeof Oe!="string"&&!vh(Oe))if(typeof Oe.toString=="function"){if(Oe=Oe.toString(),typeof Oe!="string")throw Hy("dirty is not a string, aborting")}else throw Hy("toString is not a function");if(!e.isSupported){if(ma(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Oe=="string")return t.toStaticHTML(Oe);if(vh(Oe))return t.toStaticHTML(Oe.outerHTML)}return Oe}if(Qe||yn($),e.removed=[],typeof Oe=="string"&&(N=!1),N){if(Oe.nodeName){var kn=tn(Oe.nodeName);if(!x[kn]||Q[kn])throw Hy("root node is forbidden and cannot be sanitized in-place")}}else if(Oe instanceof s)se=tx("<!---->"),de=se.ownerDocument.importNode(Oe,!0),de.nodeType===1&&de.nodeName==="BODY"||de.nodeName==="HTML"?se=de:se.appendChild(de);else{if(!Te&&!De&&!X&&Oe.indexOf("<")===-1)return T&&xe?T.createHTML(Oe):Oe;if(se=tx(Oe),!se)return Te?null:xe?_:""}se&&Be&&jo(se.firstChild);for(var vg=nx(N?Oe:se);gt=vg.nextNode();)gt.nodeType===3&&gt===_r||rx(gt)||(gt.content instanceof i&&gG(gt.content),sx(gt),_r=gt);if(_r=null,N)return Oe;if(Te){if(Le)for(zn=z.call(se.ownerDocument);se.firstChild;)zn.appendChild(se.firstChild);else zn=se;return(H.shadowroot||H.shadowrootmod)&&(zn=Z.call(n,zn,!0)),zn}var _n=X?se.outerHTML:se.innerHTML;return X&&x["!doctype"]&&se.ownerDocument&&se.ownerDocument.doctype&&se.ownerDocument.doctype.name&&lr(N5,se.ownerDocument.doctype.name)&&(_n="<!DOCTYPE "+se.ownerDocument.doctype.name+`>
`+_n),De&&(_n=Ai(_n,he," "),_n=Ai(_n,Me," "),_n=Ai(_n,Ve," ")),T&&xe?T.createHTML(_n):_n},e.setConfig=function(Oe){yn(Oe),Qe=!0},e.clearConfig=function(){Nn=null,Qe=!1},e.isValidAttribute=function(Oe,$,se){Nn||yn({});var de=tn(Oe),gt=tn($);return ix(de,gt,se)},e.addHook=function(Oe,$){typeof $=="function"&&(ne[Oe]=ne[Oe]||[],Mh(ne[Oe],$))},e.removeHook=function(Oe){if(ne[Oe])return aO(ne[Oe])},e.removeHooks=function(Oe){ne[Oe]&&(ne[Oe]=[])},e.removeAllHooks=function(){ne={}},e}var $5=EW();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var TW;function J(){return TW.apply(null,arguments)}function F5(t){TW=t}function io(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Yl(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function dt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ST(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(dt(t,e))return!1;return!0}function Ir(t){return t===void 0}function Ns(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Qf(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function _W(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function ba(t,e){for(var n in e)dt(e,n)&&(t[n]=e[n]);return dt(e,"toString")&&(t.toString=e.toString),dt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Uo(t,e,n,r){return qW(t,e,n,r,!0).utc()}function W5(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Xe(t){return t._pf==null&&(t._pf=W5()),t._pf}var rR;Array.prototype.some?rR=Array.prototype.some:rR=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function bT(t){if(t._isValid==null){var e=Xe(t),n=rR.call(e.parsedDateParts,function(i){return i!=null}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r}return t._isValid}function Hv(t){var e=Uo(NaN);return t!=null?ba(Xe(e),t):Xe(e).userInvalidated=!0,e}var dO=J.momentProperties=[],$y=!1;function RT(t,e){var n,r,i,o=dO.length;if(Ir(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Ir(e._i)||(t._i=e._i),Ir(e._f)||(t._f=e._f),Ir(e._l)||(t._l=e._l),Ir(e._strict)||(t._strict=e._strict),Ir(e._tzm)||(t._tzm=e._tzm),Ir(e._isUTC)||(t._isUTC=e._isUTC),Ir(e._offset)||(t._offset=e._offset),Ir(e._pf)||(t._pf=Xe(e)),Ir(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=dO[n],i=e[r],Ir(i)||(t[r]=i);return t}function Zf(t){RT(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),$y===!1&&($y=!0,J.updateOffset(this),$y=!1)}function oo(t){return t instanceof Zf||t!=null&&t._isAMomentObject!=null}function MW(t){J.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Mi(t,e){var n=!0;return ba(function(){if(J.deprecationHandler!=null&&J.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])dt(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}MW(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var fO={};function xW(t,e){J.deprecationHandler!=null&&J.deprecationHandler(t,e),fO[t]||(MW(e),fO[t]=!0)}J.suppressDeprecationWarnings=!1;J.deprecationHandler=null;function zo(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function V5(t){var e,n;for(n in t)dt(t,n)&&(e=t[n],zo(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function iR(t,e){var n=ba({},t),r;for(r in e)dt(e,r)&&(Yl(t[r])&&Yl(e[r])?(n[r]={},ba(n[r],t[r]),ba(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)dt(t,r)&&!dt(e,r)&&Yl(t[r])&&(n[r]=ba({},n[r]));return n}function ET(t){t!=null&&this.set(t)}var oR;Object.keys?oR=Object.keys:oR=function(t){var e,n=[];for(e in t)dt(t,e)&&n.push(e);return n};var B5={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function U5(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return zo(r)?r.call(e,n):r}function Wo(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var TT=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Bg=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Fy={},kc={};function Ie(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(kc[t]=i),e&&(kc[e[0]]=function(){return Wo(i.apply(this,arguments),e[1],e[2])}),n&&(kc[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function z5(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function G5(t){var e=t.match(TT),n,r;for(n=0,r=e.length;n<r;n++)kc[e[n]]?e[n]=kc[e[n]]:e[n]=z5(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=zo(e[s])?e[s].call(i,t):e[s];return o}}function Cp(t,e){return t.isValid()?(e=PW(e,t.localeData()),Fy[e]=Fy[e]||G5(e),Fy[e](t)):t.localeData().invalidDate()}function PW(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Bg.lastIndex=0;n>=0&&Bg.test(t);)t=t.replace(Bg,r),Bg.lastIndex=0,n-=1;return t}var j5={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Y5(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(TT).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var K5="Invalid date";function X5(){return this._invalidDate}var q5="%d",Q5=/\d{1,2}/;function Z5(t){return this._ordinal.replace("%d",t)}var J5={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function e9(t,e,n,r){var i=this._relativeTime[n];return zo(i)?i(t,e,n,r):i.replace(/%d/i,t)}function t9(t,e){var n=this._relativeTime[t>0?"future":"past"];return zo(n)?n(e):n.replace(/%s/i,e)}var Dd={};function or(t,e){var n=t.toLowerCase();Dd[n]=Dd[n+"s"]=Dd[e]=t}function xi(t){return typeof t=="string"?Dd[t]||Dd[t.toLowerCase()]:void 0}function _T(t){var e={},n,r;for(r in t)dt(t,r)&&(n=xi(r),n&&(e[n]=t[r]));return e}var OW={};function sr(t,e){OW[t]=e}function n9(t){var e=[],n;for(n in t)dt(t,n)&&e.push({unit:n,priority:OW[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}function Dv(t){return t%4===0&&t%100!==0||t%400===0}function Ci(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function it(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Ci(e)),n}function ah(t,e){return function(n){return n!=null?(AW(this,t,n),J.updateOffset(this,e),this):ww(this,t)}}function ww(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function AW(t,e,n){t.isValid()&&!isNaN(n)&&(e==="FullYear"&&Dv(t.year())&&t.month()===1&&t.date()===29?(n=it(n),t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),Wv(n,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function r9(t){return t=xi(t),zo(this[t])?this[t]():this}function i9(t,e){if(typeof t=="object"){t=_T(t);var n=n9(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=xi(t),zo(this[t]))return this[t](e);return this}var IW=/\d/,si=/\d\d/,HW=/\d{3}/,MT=/\d{4}/,Nv=/[+-]?\d{6}/,Nt=/\d\d?/,DW=/\d\d\d\d?/,NW=/\d\d\d\d\d\d?/,kv=/\d{1,3}/,xT=/\d{1,4}/,Lv=/[+-]?\d{1,6}/,lh=/\d+/,$v=/[+-]?\d+/,o9=/Z|[+-]\d\d:?\d\d/gi,Fv=/Z|[+-]\d\d(?::?\d\d)?/gi,s9=/[+-]?\d+(\.\d{1,3})?/,Jf=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,vw;vw={};function Ce(t,e,n){vw[t]=zo(e)?e:function(r,i){return r&&n?n:e}}function a9(t,e){return dt(vw,t)?vw[t](e._strict,e._locale):new RegExp(l9(t))}function l9(t){return Qr(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Qr(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var sR={};function yt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Ns(e)&&(r=function(o,s){s[e]=it(o)}),i=t.length,n=0;n<i;n++)sR[t[n]]=r}function eg(t,e){yt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function u9(t,e,n){e!=null&&dt(sR,t)&&sR[t](e,n._a,n,t)}var er=0,ys=1,Io=2,En=3,qi=4,Ss=5,Fl=6,c9=7,h9=8;function d9(t,e){return(t%e+e)%e}var ln;Array.prototype.indexOf?ln=Array.prototype.indexOf:ln=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Wv(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=d9(e,12);return t+=(e-n)/12,n===1?Dv(t)?29:28:31-n%7%2}Ie("M",["MM",2],"Mo",function(){return this.month()+1});Ie("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ie("MMMM",0,0,function(t){return this.localeData().months(this,t)});or("month","M");sr("month",8);Ce("M",Nt);Ce("MM",Nt,si);Ce("MMM",function(t,e){return e.monthsShortRegex(t)});Ce("MMMM",function(t,e){return e.monthsRegex(t)});yt(["M","MM"],function(t,e){e[ys]=it(t)-1});yt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[ys]=i:Xe(n).invalidMonth=t});var f9="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),kW="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),LW=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,g9=Jf,m9=Jf;function p9(t,e){return t?io(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||LW).test(e)?"format":"standalone"][t.month()]:io(this._months)?this._months:this._months.standalone}function w9(t,e){return t?io(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[LW.test(e)?"format":"standalone"][t.month()]:io(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function v9(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Uo([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=ln.call(this._shortMonthsParse,s),i!==-1?i:null):(i=ln.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=ln.call(this._shortMonthsParse,s),i!==-1?i:(i=ln.call(this._longMonthsParse,s),i!==-1?i:null)):(i=ln.call(this._longMonthsParse,s),i!==-1?i:(i=ln.call(this._shortMonthsParse,s),i!==-1?i:null))}function C9(t,e,n){var r,i,o;if(this._monthsParseExact)return v9.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Uo([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function $W(t,e){var n;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=it(e);else if(e=t.localeData().monthsParse(e),!Ns(e))return t}return n=Math.min(t.date(),Wv(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function FW(t){return t!=null?($W(this,t),J.updateOffset(this,!0),this):ww(this,"Month")}function y9(){return Wv(this.year(),this.month())}function S9(t){return this._monthsParseExact?(dt(this,"_monthsRegex")||WW.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(dt(this,"_monthsShortRegex")||(this._monthsShortRegex=g9),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function b9(t){return this._monthsParseExact?(dt(this,"_monthsRegex")||WW.call(this),t?this._monthsStrictRegex:this._monthsRegex):(dt(this,"_monthsRegex")||(this._monthsRegex=m9),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function WW(){function t(s,a){return a.length-s.length}var e=[],n=[],r=[],i,o;for(i=0;i<12;i++)o=Uo([2e3,i]),e.push(this.monthsShort(o,"")),n.push(this.months(o,"")),r.push(this.months(o,"")),r.push(this.monthsShort(o,""));for(e.sort(t),n.sort(t),r.sort(t),i=0;i<12;i++)e[i]=Qr(e[i]),n[i]=Qr(n[i]);for(i=0;i<24;i++)r[i]=Qr(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Ie("Y",0,0,function(){var t=this.year();return t<=9999?Wo(t,4):"+"+t});Ie(0,["YY",2],0,function(){return this.year()%100});Ie(0,["YYYY",4],0,"year");Ie(0,["YYYYY",5],0,"year");Ie(0,["YYYYYY",6,!0],0,"year");or("year","y");sr("year",1);Ce("Y",$v);Ce("YY",Nt,si);Ce("YYYY",xT,MT);Ce("YYYYY",Lv,Nv);Ce("YYYYYY",Lv,Nv);yt(["YYYYY","YYYYYY"],er);yt("YYYY",function(t,e){e[er]=t.length===2?J.parseTwoDigitYear(t):it(t)});yt("YY",function(t,e){e[er]=J.parseTwoDigitYear(t)});yt("Y",function(t,e){e[er]=parseInt(t,10)});function Nd(t){return Dv(t)?366:365}J.parseTwoDigitYear=function(t){return it(t)+(it(t)>68?1900:2e3)};var VW=ah("FullYear",!0);function R9(){return Dv(this.year())}function E9(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Sf(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Cw(t,e,n){var r=7+e-n,i=(7+Sf(t,0,r).getUTCDay()-e)%7;return-i+r-1}function BW(t,e,n,r,i){var o=(7+n-r)%7,s=Cw(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Nd(l)+a):a>Nd(t)?(l=t+1,u=a-Nd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function bf(t,e,n){var r=Cw(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Os(s,e,n)):i>Os(t.year(),e,n)?(o=i-Os(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Os(t,e,n){var r=Cw(t,e,n),i=Cw(t+1,e,n);return(Nd(t)-r+i)/7}Ie("w",["ww",2],"wo","week");Ie("W",["WW",2],"Wo","isoWeek");or("week","w");or("isoWeek","W");sr("week",5);sr("isoWeek",5);Ce("w",Nt);Ce("ww",Nt,si);Ce("W",Nt);Ce("WW",Nt,si);eg(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=it(t)});function T9(t){return bf(t,this._week.dow,this._week.doy).week}var _9={dow:0,doy:6};function M9(){return this._week.dow}function x9(){return this._week.doy}function P9(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function O9(t){var e=bf(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ie("d",0,"do","day");Ie("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ie("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ie("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ie("e",0,0,"weekday");Ie("E",0,0,"isoWeekday");or("day","d");or("weekday","e");or("isoWeekday","E");sr("day",11);sr("weekday",11);sr("isoWeekday",11);Ce("d",Nt);Ce("e",Nt);Ce("E",Nt);Ce("dd",function(t,e){return e.weekdaysMinRegex(t)});Ce("ddd",function(t,e){return e.weekdaysShortRegex(t)});Ce("dddd",function(t,e){return e.weekdaysRegex(t)});eg(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Xe(n).invalidWeekday=t});eg(["d","e","E"],function(t,e,n,r){e[r]=it(t)});function A9(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function I9(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function PT(t,e){return t.slice(e,7).concat(t.slice(0,e))}var H9="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),UW="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),D9="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),N9=Jf,k9=Jf,L9=Jf;function $9(t,e){var n=io(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?PT(n,this._week.dow):t?n[t.day()]:n}function F9(t){return t===!0?PT(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function W9(t){return t===!0?PT(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function V9(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Uo([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=ln.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=ln.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=ln.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=ln.call(this._weekdaysParse,s),i!==-1||(i=ln.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=ln.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=ln.call(this._shortWeekdaysParse,s),i!==-1||(i=ln.call(this._weekdaysParse,s),i!==-1)?i:(i=ln.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=ln.call(this._minWeekdaysParse,s),i!==-1||(i=ln.call(this._weekdaysParse,s),i!==-1)?i:(i=ln.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function B9(t,e,n){var r,i,o;if(this._weekdaysParseExact)return V9.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Uo([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function U9(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=A9(t,this.localeData()),this.add(t-e,"d")):e}function z9(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function G9(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=I9(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function j9(t){return this._weekdaysParseExact?(dt(this,"_weekdaysRegex")||OT.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(dt(this,"_weekdaysRegex")||(this._weekdaysRegex=N9),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function Y9(t){return this._weekdaysParseExact?(dt(this,"_weekdaysRegex")||OT.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(dt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=k9),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function K9(t){return this._weekdaysParseExact?(dt(this,"_weekdaysRegex")||OT.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(dt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=L9),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function OT(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Uo([2e3,1]).day(o),a=Qr(this.weekdaysMin(s,"")),l=Qr(this.weekdaysShort(s,"")),u=Qr(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function AT(){return this.hours()%12||12}function X9(){return this.hours()||24}Ie("H",["HH",2],0,"hour");Ie("h",["hh",2],0,AT);Ie("k",["kk",2],0,X9);Ie("hmm",0,0,function(){return""+AT.apply(this)+Wo(this.minutes(),2)});Ie("hmmss",0,0,function(){return""+AT.apply(this)+Wo(this.minutes(),2)+Wo(this.seconds(),2)});Ie("Hmm",0,0,function(){return""+this.hours()+Wo(this.minutes(),2)});Ie("Hmmss",0,0,function(){return""+this.hours()+Wo(this.minutes(),2)+Wo(this.seconds(),2)});function zW(t,e){Ie(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}zW("a",!0);zW("A",!1);or("hour","h");sr("hour",13);function GW(t,e){return e._meridiemParse}Ce("a",GW);Ce("A",GW);Ce("H",Nt);Ce("h",Nt);Ce("k",Nt);Ce("HH",Nt,si);Ce("hh",Nt,si);Ce("kk",Nt,si);Ce("hmm",DW);Ce("hmmss",NW);Ce("Hmm",DW);Ce("Hmmss",NW);yt(["H","HH"],En);yt(["k","kk"],function(t,e,n){var r=it(t);e[En]=r===24?0:r});yt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});yt(["h","hh"],function(t,e,n){e[En]=it(t),Xe(n).bigHour=!0});yt("hmm",function(t,e,n){var r=t.length-2;e[En]=it(t.substr(0,r)),e[qi]=it(t.substr(r)),Xe(n).bigHour=!0});yt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[En]=it(t.substr(0,r)),e[qi]=it(t.substr(r,2)),e[Ss]=it(t.substr(i)),Xe(n).bigHour=!0});yt("Hmm",function(t,e,n){var r=t.length-2;e[En]=it(t.substr(0,r)),e[qi]=it(t.substr(r))});yt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[En]=it(t.substr(0,r)),e[qi]=it(t.substr(r,2)),e[Ss]=it(t.substr(i))});function q9(t){return(t+"").toLowerCase().charAt(0)==="p"}var Q9=/[ap]\.?m?\.?/i,Z9=ah("Hours",!0);function J9(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var jW={calendar:B5,longDateFormat:j5,invalidDate:K5,ordinal:q5,dayOfMonthOrdinalParse:Q5,relativeTime:J5,months:f9,monthsShort:kW,week:_9,weekdays:H9,weekdaysMin:D9,weekdaysShort:UW,meridiemParse:Q9},Ft={},xh={},Rf;function e7(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function gO(t){return t&&t.toLowerCase().replace("_","-")}function t7(t){for(var e=0,n,r,i,o;e<t.length;){for(o=gO(t[e]).split("-"),n=o.length,r=gO(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Vv(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&e7(o,r)>=n-1)break;n--}e++}return Rf}function n7(t){return t.match("^[^/\\\\]*$")!=null}function Vv(t){var e=null,n;if(Ft[t]===void 0&&typeof Vp<"u"&&Vp&&Vp.exports&&n7(t))try{e=Rf._abbr,n=require,n("./locale/"+t),Na(e)}catch{Ft[t]=null}return Ft[t]}function Na(t,e){var n;return t&&(Ir(e)?n=Vs(t):n=IT(t,e),n?Rf=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Rf._abbr}function IT(t,e){if(e!==null){var n,r=jW;if(e.abbr=t,Ft[t]!=null)xW("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Ft[t]._config;else if(e.parentLocale!=null)if(Ft[e.parentLocale]!=null)r=Ft[e.parentLocale]._config;else if(n=Vv(e.parentLocale),n!=null)r=n._config;else return xh[e.parentLocale]||(xh[e.parentLocale]=[]),xh[e.parentLocale].push({name:t,config:e}),null;return Ft[t]=new ET(iR(r,e)),xh[t]&&xh[t].forEach(function(i){IT(i.name,i.config)}),Na(t),Ft[t]}else return delete Ft[t],null}function r7(t,e){if(e!=null){var n,r,i=jW;Ft[t]!=null&&Ft[t].parentLocale!=null?Ft[t].set(iR(Ft[t]._config,e)):(r=Vv(t),r!=null&&(i=r._config),e=iR(i,e),r==null&&(e.abbr=t),n=new ET(e),n.parentLocale=Ft[t],Ft[t]=n),Na(t)}else Ft[t]!=null&&(Ft[t].parentLocale!=null?(Ft[t]=Ft[t].parentLocale,t===Na()&&Na(t)):Ft[t]!=null&&delete Ft[t]);return Ft[t]}function Vs(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Rf;if(!io(t)){if(e=Vv(t),e)return e;t=[t]}return t7(t)}function i7(){return oR(Ft)}function HT(t){var e,n=t._a;return n&&Xe(t).overflow===-2&&(e=n[ys]<0||n[ys]>11?ys:n[Io]<1||n[Io]>Wv(n[er],n[ys])?Io:n[En]<0||n[En]>24||n[En]===24&&(n[qi]!==0||n[Ss]!==0||n[Fl]!==0)?En:n[qi]<0||n[qi]>59?qi:n[Ss]<0||n[Ss]>59?Ss:n[Fl]<0||n[Fl]>999?Fl:-1,Xe(t)._overflowDayOfYear&&(e<er||e>Io)&&(e=Io),Xe(t)._overflowWeeks&&e===-1&&(e=c9),Xe(t)._overflowWeekday&&e===-1&&(e=h9),Xe(t).overflow=e),t}var o7=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,s7=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,a7=/Z|[+-]\d\d(?::?\d\d)?/,Ug=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Wy=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],l7=/^\/?Date\((-?\d+)/i,u7=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,c7={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function YW(t){var e,n,r=t._i,i=o7.exec(r)||s7.exec(r),o,s,a,l,u=Ug.length,c=Wy.length;if(i){for(Xe(t).iso=!0,e=0,n=u;e<n;e++)if(Ug[e][1].exec(i[1])){s=Ug[e][0],o=Ug[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(Wy[e][1].exec(i[3])){a=(i[2]||" ")+Wy[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(a7.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),NT(t)}else t._isValid=!1}function h7(t,e,n,r,i,o){var s=[d7(t),kW.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function d7(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function f7(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function g7(t,e,n){if(t){var r=UW.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Xe(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function m7(t,e,n){if(t)return c7[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function KW(t){var e=u7.exec(f7(t._i)),n;if(e){if(n=h7(e[4],e[3],e[2],e[5],e[6],e[7]),!g7(e[1],n,t))return;t._a=n,t._tzm=m7(e[8],e[9],e[10]),t._d=Sf.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Xe(t).rfc2822=!0}else t._isValid=!1}function p7(t){var e=l7.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(YW(t),t._isValid===!1)delete t._isValid;else return;if(KW(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:J.createFromInputFallback(t)}J.createFromInputFallback=Mi("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function lc(t,e,n){return t??e??n}function w7(t){var e=new Date(J.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function DT(t){var e,n,r=[],i,o,s;if(!t._d){for(i=w7(t),t._w&&t._a[Io]==null&&t._a[ys]==null&&v7(t),t._dayOfYear!=null&&(s=lc(t._a[er],i[er]),(t._dayOfYear>Nd(s)||t._dayOfYear===0)&&(Xe(t)._overflowDayOfYear=!0),n=Sf(s,0,t._dayOfYear),t._a[ys]=n.getUTCMonth(),t._a[Io]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[En]===24&&t._a[qi]===0&&t._a[Ss]===0&&t._a[Fl]===0&&(t._nextDay=!0,t._a[En]=0),t._d=(t._useUTC?Sf:E9).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[En]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Xe(t).weekdayMismatch=!0)}}function v7(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=lc(e.GG,t._a[er],bf(Dt(),1,4).year),r=lc(e.W,1),i=lc(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=bf(Dt(),o,s),n=lc(e.gg,t._a[er],u.year),r=lc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>Os(n,o,s)?Xe(t)._overflowWeeks=!0:l!=null?Xe(t)._overflowWeekday=!0:(a=BW(n,r,i,o,s),t._a[er]=a.year,t._dayOfYear=a.dayOfYear)}J.ISO_8601=function(){};J.RFC_2822=function(){};function NT(t){if(t._f===J.ISO_8601){YW(t);return}if(t._f===J.RFC_2822){KW(t);return}t._a=[],Xe(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=PW(t._f,t._locale).match(TT)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(a9(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Xe(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),kc[o]?(r?Xe(t).empty=!1:Xe(t).unusedTokens.push(o),u9(o,r,t)):t._strict&&!r&&Xe(t).unusedTokens.push(o);Xe(t).charsLeftOver=a-l,e.length>0&&Xe(t).unusedInput.push(e),t._a[En]<=12&&Xe(t).bigHour===!0&&t._a[En]>0&&(Xe(t).bigHour=void 0),Xe(t).parsedDateParts=t._a.slice(0),Xe(t).meridiem=t._meridiem,t._a[En]=C7(t._locale,t._a[En],t._meridiem),u=Xe(t).era,u!==null&&(t._a[er]=t._locale.erasConvertYear(u,t._a[er])),DT(t),HT(t)}function C7(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function y7(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Xe(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=RT({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],NT(e),bT(e)&&(s=!0),o+=Xe(e).charsLeftOver,o+=Xe(e).unusedTokens.length*10,Xe(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));ba(t,n||e)}function S7(t){if(!t._d){var e=_T(t._i),n=e.day===void 0?e.date:e.day;t._a=_W([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),DT(t)}}function b7(t){var e=new Zf(HT(XW(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function XW(t){var e=t._i,n=t._f;return t._locale=t._locale||Vs(t._l),e===null||n===void 0&&e===""?Hv({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),oo(e)?new Zf(HT(e)):(Qf(e)?t._d=e:io(n)?y7(t):n?NT(t):R7(t),bT(t)||(t._d=null),t))}function R7(t){var e=t._i;Ir(e)?t._d=new Date(J.now()):Qf(e)?t._d=new Date(e.valueOf()):typeof e=="string"?p7(t):io(e)?(t._a=_W(e.slice(0),function(n){return parseInt(n,10)}),DT(t)):Yl(e)?S7(t):Ns(e)?t._d=new Date(e):J.createFromInputFallback(t)}function qW(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(Yl(t)&&ST(t)||io(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,b7(o)}function Dt(t,e,n,r){return qW(t,e,n,r,!1)}var E7=Mi("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Dt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Hv()}),T7=Mi("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Dt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Hv()});function QW(t,e){var n,r;if(e.length===1&&io(e[0])&&(e=e[0]),!e.length)return Dt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function _7(){var t=[].slice.call(arguments,0);return QW("isBefore",t)}function M7(){var t=[].slice.call(arguments,0);return QW("isAfter",t)}var x7=function(){return Date.now?Date.now():+new Date},Ph=["year","quarter","month","week","day","hour","minute","second","millisecond"];function P7(t){var e,n=!1,r,i=Ph.length;for(e in t)if(dt(t,e)&&!(ln.call(Ph,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Ph[r]]){if(n)return!1;parseFloat(t[Ph[r]])!==it(t[Ph[r]])&&(n=!0)}return!0}function O7(){return this._isValid}function A7(){return ao(NaN)}function Bv(t){var e=_T(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=P7(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=Vs(),this._bubble()}function yp(t){return t instanceof Bv}function aR(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function I7(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)(n&&t[s]!==e[s]||!n&&it(t[s])!==it(e[s]))&&o++;return o+i}function ZW(t,e){Ie(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Wo(~~(n/60),2)+e+Wo(~~n%60,2)})}ZW("Z",":");ZW("ZZ","");Ce("Z",Fv);Ce("ZZ",Fv);yt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=kT(Fv,t)});var H7=/([\+\-]|\d\d)/gi;function kT(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(H7)||["-",0,0],o=+(i[1]*60)+it(i[2]),o===0?0:i[0]==="+"?o:-o)}function LT(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(oo(t)||Qf(t)?t.valueOf():Dt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),J.updateOffset(n,!1),n):Dt(t).local()}function lR(t){return-Math.round(t._d.getTimezoneOffset())}J.updateOffset=function(){};function D7(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=kT(Fv,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=lR(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?tV(this,ao(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,J.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:lR(this)}function N7(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function k7(t){return this.utcOffset(0,t)}function L7(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(lR(this),"m")),this}function $7(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=kT(o9,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function F7(t){return this.isValid()?(t=t?Dt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function W7(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function V7(){if(!Ir(this._isDSTShifted))return this._isDSTShifted;var t={},e;return RT(t,this),t=XW(t),t._a?(e=t._isUTC?Uo(t._a):Dt(t._a),this._isDSTShifted=this.isValid()&&I7(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function B7(){return this.isValid()?!this._isUTC:!1}function U7(){return this.isValid()?this._isUTC:!1}function JW(){return this.isValid()?this._isUTC&&this._offset===0:!1}var z7=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,G7=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ao(t,e){var n=t,r=null,i,o,s;return yp(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Ns(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=z7.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:it(r[Io])*i,h:it(r[En])*i,m:it(r[qi])*i,s:it(r[Ss])*i,ms:it(aR(r[Fl]*1e3))*i}):(r=G7.exec(t))?(i=r[1]==="-"?-1:1,n={y:rl(r[2],i),M:rl(r[3],i),w:rl(r[4],i),d:rl(r[5],i),h:rl(r[6],i),m:rl(r[7],i),s:rl(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=j7(Dt(n.from),Dt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Bv(n),yp(t)&&dt(t,"_locale")&&(o._locale=t._locale),yp(t)&&dt(t,"_isValid")&&(o._isValid=t._isValid),o}ao.fn=Bv.prototype;ao.invalid=A7;function rl(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function mO(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function j7(t,e){var n;return t.isValid()&&e.isValid()?(e=LT(e,t),t.isBefore(e)?n=mO(t,e):(n=mO(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function eV(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(xW(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=ao(n,r),tV(this,i,t),this}}function tV(t,e,n,r){var i=e._milliseconds,o=aR(e._days),s=aR(e._months);t.isValid()&&(r=r??!0,s&&$W(t,ww(t,"Month")+s*n),o&&AW(t,"Date",ww(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&J.updateOffset(t,o||s))}var Y7=eV(1,"add"),K7=eV(-1,"subtract");function nV(t){return typeof t=="string"||t instanceof String}function X7(t){return oo(t)||Qf(t)||nV(t)||Ns(t)||Q7(t)||q7(t)||t===null||t===void 0}function q7(t){var e=Yl(t)&&!ST(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||dt(t,o);return e&&n}function Q7(t){var e=io(t),n=!1;return e&&(n=t.filter(function(r){return!Ns(r)&&nV(t)}).length===0),e&&n}function Z7(t){var e=Yl(t)&&!ST(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||dt(t,o);return e&&n}function J7(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function eX(t,e){arguments.length===1&&(arguments[0]?X7(arguments[0])?(t=arguments[0],e=void 0):Z7(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Dt(),r=LT(n,this).startOf("day"),i=J.calendarFormat(this,r)||"sameElse",o=e&&(zo(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Dt(n)))}function tX(){return new Zf(this)}function nX(t,e){var n=oo(t)?t:Dt(t);return this.isValid()&&n.isValid()?(e=xi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function rX(t,e){var n=oo(t)?t:Dt(t);return this.isValid()&&n.isValid()?(e=xi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function iX(t,e,n,r){var i=oo(t)?t:Dt(t),o=oo(e)?e:Dt(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function oX(t,e){var n=oo(t)?t:Dt(t),r;return this.isValid()&&n.isValid()?(e=xi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function sX(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function aX(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function lX(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=LT(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=xi(e),e){case"year":o=Sp(this,r)/12;break;case"month":o=Sp(this,r);break;case"quarter":o=Sp(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Ci(o)}function Sp(t,e){if(t.date()<e.date())return-Sp(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}J.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";J.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function uX(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function cX(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Cp(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):zo(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Cp(n,"Z")):Cp(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function hX(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function dX(t){t||(t=this.isUtc()?J.defaultFormatUtc:J.defaultFormat);var e=Cp(this,t);return this.localeData().postformat(e)}function fX(t,e){return this.isValid()&&(oo(t)&&t.isValid()||Dt(t).isValid())?ao({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function gX(t){return this.from(Dt(),t)}function mX(t,e){return this.isValid()&&(oo(t)&&t.isValid()||Dt(t).isValid())?ao({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function pX(t){return this.to(Dt(),t)}function rV(t){var e;return t===void 0?this._locale._abbr:(e=Vs(t),e!=null&&(this._locale=e),this)}var iV=Mi("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function oV(){return this._locale}var yw=1e3,Lc=60*yw,Sw=60*Lc,sV=(365*400+97)*24*Sw;function $c(t,e){return(t%e+e)%e}function aV(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-sV:new Date(t,e,n).valueOf()}function lV(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-sV:Date.UTC(t,e,n)}function wX(t){var e,n;if(t=xi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?lV:aV,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=$c(e+(this._isUTC?0:this.utcOffset()*Lc),Sw);break;case"minute":e=this._d.valueOf(),e-=$c(e,Lc);break;case"second":e=this._d.valueOf(),e-=$c(e,yw);break}return this._d.setTime(e),J.updateOffset(this,!0),this}function vX(t){var e,n;if(t=xi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?lV:aV,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Sw-$c(e+(this._isUTC?0:this.utcOffset()*Lc),Sw)-1;break;case"minute":e=this._d.valueOf(),e+=Lc-$c(e,Lc)-1;break;case"second":e=this._d.valueOf(),e+=yw-$c(e,yw)-1;break}return this._d.setTime(e),J.updateOffset(this,!0),this}function CX(){return this._d.valueOf()-(this._offset||0)*6e4}function yX(){return Math.floor(this.valueOf()/1e3)}function SX(){return new Date(this.valueOf())}function bX(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function RX(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function EX(){return this.isValid()?this.toISOString():null}function TX(){return bT(this)}function _X(){return ba({},Xe(this))}function MX(){return Xe(this).overflow}function xX(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ie("N",0,0,"eraAbbr");Ie("NN",0,0,"eraAbbr");Ie("NNN",0,0,"eraAbbr");Ie("NNNN",0,0,"eraName");Ie("NNNNN",0,0,"eraNarrow");Ie("y",["y",1],"yo","eraYear");Ie("y",["yy",2],0,"eraYear");Ie("y",["yyy",3],0,"eraYear");Ie("y",["yyyy",4],0,"eraYear");Ce("N",$T);Ce("NN",$T);Ce("NNN",$T);Ce("NNNN",FX);Ce("NNNNN",WX);yt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Xe(n).era=i:Xe(n).invalidEra=t});Ce("y",lh);Ce("yy",lh);Ce("yyy",lh);Ce("yyyy",lh);Ce("yo",VX);yt(["y","yy","yyy","yyyy"],er);yt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[er]=n._locale.eraYearOrdinalParse(t,i):e[er]=parseInt(t,10)});function PX(t,e){var n,r,i,o=this._eras||Vs("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=J(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=J(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function OX(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function AX(t,e){var n=t.since<=t.until?1:-1;return e===void 0?J(t.since).year():J(t.since).year()+(e-t.offset)*n}function IX(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function HX(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function DX(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function NX(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-J(i[t].since).year())*n+i[t].offset;return this.year()}function kX(t){return dt(this,"_erasNameRegex")||FT.call(this),t?this._erasNameRegex:this._erasRegex}function LX(t){return dt(this,"_erasAbbrRegex")||FT.call(this),t?this._erasAbbrRegex:this._erasRegex}function $X(t){return dt(this,"_erasNarrowRegex")||FT.call(this),t?this._erasNarrowRegex:this._erasRegex}function $T(t,e){return e.erasAbbrRegex(t)}function FX(t,e){return e.erasNameRegex(t)}function WX(t,e){return e.erasNarrowRegex(t)}function VX(t,e){return e._eraYearOrdinalRegex||lh}function FT(){var t=[],e=[],n=[],r=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)e.push(Qr(s[i].name)),t.push(Qr(s[i].abbr)),n.push(Qr(s[i].narrow)),r.push(Qr(s[i].name)),r.push(Qr(s[i].abbr)),r.push(Qr(s[i].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ie(0,["gg",2],0,function(){return this.weekYear()%100});Ie(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Uv(t,e){Ie(0,[t,t.length],0,e)}Uv("gggg","weekYear");Uv("ggggg","weekYear");Uv("GGGG","isoWeekYear");Uv("GGGGG","isoWeekYear");or("weekYear","gg");or("isoWeekYear","GG");sr("weekYear",1);sr("isoWeekYear",1);Ce("G",$v);Ce("g",$v);Ce("GG",Nt,si);Ce("gg",Nt,si);Ce("GGGG",xT,MT);Ce("gggg",xT,MT);Ce("GGGGG",Lv,Nv);Ce("ggggg",Lv,Nv);eg(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=it(t)});eg(["gg","GG"],function(t,e,n,r){e[r]=J.parseTwoDigitYear(t)});function BX(t){return uV.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function UX(t){return uV.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function zX(){return Os(this.year(),1,4)}function GX(){return Os(this.isoWeekYear(),1,4)}function jX(){var t=this.localeData()._week;return Os(this.year(),t.dow,t.doy)}function YX(){var t=this.localeData()._week;return Os(this.weekYear(),t.dow,t.doy)}function uV(t,e,n,r,i){var o;return t==null?bf(this,r,i).year:(o=Os(t,r,i),e>o&&(e=o),KX.call(this,t,e,n,r,i))}function KX(t,e,n,r,i){var o=BW(t,e,n,r,i),s=Sf(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Ie("Q",0,"Qo","quarter");or("quarter","Q");sr("quarter",7);Ce("Q",IW);yt("Q",function(t,e){e[ys]=(it(t)-1)*3});function XX(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ie("D",["DD",2],"Do","date");or("date","D");sr("date",9);Ce("D",Nt);Ce("DD",Nt,si);Ce("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});yt(["D","DD"],Io);yt("Do",function(t,e){e[Io]=it(t.match(Nt)[0])});var cV=ah("Date",!0);Ie("DDD",["DDDD",3],"DDDo","dayOfYear");or("dayOfYear","DDD");sr("dayOfYear",4);Ce("DDD",kv);Ce("DDDD",HW);yt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=it(t)});function qX(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ie("m",["mm",2],0,"minute");or("minute","m");sr("minute",14);Ce("m",Nt);Ce("mm",Nt,si);yt(["m","mm"],qi);var QX=ah("Minutes",!1);Ie("s",["ss",2],0,"second");or("second","s");sr("second",15);Ce("s",Nt);Ce("ss",Nt,si);yt(["s","ss"],Ss);var ZX=ah("Seconds",!1);Ie("S",0,0,function(){return~~(this.millisecond()/100)});Ie(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ie(0,["SSS",3],0,"millisecond");Ie(0,["SSSS",4],0,function(){return this.millisecond()*10});Ie(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ie(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ie(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ie(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ie(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});or("millisecond","ms");sr("millisecond",16);Ce("S",kv,IW);Ce("SS",kv,si);Ce("SSS",kv,HW);var Ra,hV;for(Ra="SSSS";Ra.length<=9;Ra+="S")Ce(Ra,lh);function JX(t,e){e[Fl]=it(("0."+t)*1e3)}for(Ra="S";Ra.length<=9;Ra+="S")yt(Ra,JX);hV=ah("Milliseconds",!1);Ie("z",0,0,"zoneAbbr");Ie("zz",0,0,"zoneName");function eq(){return this._isUTC?"UTC":""}function tq(){return this._isUTC?"Coordinated Universal Time":""}var oe=Zf.prototype;oe.add=Y7;oe.calendar=eX;oe.clone=tX;oe.diff=lX;oe.endOf=vX;oe.format=dX;oe.from=fX;oe.fromNow=gX;oe.to=mX;oe.toNow=pX;oe.get=r9;oe.invalidAt=MX;oe.isAfter=nX;oe.isBefore=rX;oe.isBetween=iX;oe.isSame=oX;oe.isSameOrAfter=sX;oe.isSameOrBefore=aX;oe.isValid=TX;oe.lang=iV;oe.locale=rV;oe.localeData=oV;oe.max=T7;oe.min=E7;oe.parsingFlags=_X;oe.set=i9;oe.startOf=wX;oe.subtract=K7;oe.toArray=bX;oe.toObject=RX;oe.toDate=SX;oe.toISOString=cX;oe.inspect=hX;typeof Symbol<"u"&&Symbol.for!=null&&(oe[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});oe.toJSON=EX;oe.toString=uX;oe.unix=yX;oe.valueOf=CX;oe.creationData=xX;oe.eraName=IX;oe.eraNarrow=HX;oe.eraAbbr=DX;oe.eraYear=NX;oe.year=VW;oe.isLeapYear=R9;oe.weekYear=BX;oe.isoWeekYear=UX;oe.quarter=oe.quarters=XX;oe.month=FW;oe.daysInMonth=y9;oe.week=oe.weeks=P9;oe.isoWeek=oe.isoWeeks=O9;oe.weeksInYear=jX;oe.weeksInWeekYear=YX;oe.isoWeeksInYear=zX;oe.isoWeeksInISOWeekYear=GX;oe.date=cV;oe.day=oe.days=U9;oe.weekday=z9;oe.isoWeekday=G9;oe.dayOfYear=qX;oe.hour=oe.hours=Z9;oe.minute=oe.minutes=QX;oe.second=oe.seconds=ZX;oe.millisecond=oe.milliseconds=hV;oe.utcOffset=D7;oe.utc=k7;oe.local=L7;oe.parseZone=$7;oe.hasAlignedHourOffset=F7;oe.isDST=W7;oe.isLocal=B7;oe.isUtcOffset=U7;oe.isUtc=JW;oe.isUTC=JW;oe.zoneAbbr=eq;oe.zoneName=tq;oe.dates=Mi("dates accessor is deprecated. Use date instead.",cV);oe.months=Mi("months accessor is deprecated. Use month instead",FW);oe.years=Mi("years accessor is deprecated. Use year instead",VW);oe.zone=Mi("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",N7);oe.isDSTShifted=Mi("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",V7);function nq(t){return Dt(t*1e3)}function rq(){return Dt.apply(null,arguments).parseZone()}function dV(t){return t}var ft=ET.prototype;ft.calendar=U5;ft.longDateFormat=Y5;ft.invalidDate=X5;ft.ordinal=Z5;ft.preparse=dV;ft.postformat=dV;ft.relativeTime=e9;ft.pastFuture=t9;ft.set=V5;ft.eras=PX;ft.erasParse=OX;ft.erasConvertYear=AX;ft.erasAbbrRegex=LX;ft.erasNameRegex=kX;ft.erasNarrowRegex=$X;ft.months=p9;ft.monthsShort=w9;ft.monthsParse=C9;ft.monthsRegex=b9;ft.monthsShortRegex=S9;ft.week=T9;ft.firstDayOfYear=x9;ft.firstDayOfWeek=M9;ft.weekdays=$9;ft.weekdaysMin=W9;ft.weekdaysShort=F9;ft.weekdaysParse=B9;ft.weekdaysRegex=j9;ft.weekdaysShortRegex=Y9;ft.weekdaysMinRegex=K9;ft.isPM=q9;ft.meridiem=J9;function bw(t,e,n,r){var i=Vs(),o=Uo().set(r,e);return i[n](o,t)}function fV(t,e,n){if(Ns(t)&&(e=t,t=void 0),t=t||"",e!=null)return bw(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=bw(t,r,n,"month");return i}function WT(t,e,n,r){typeof t=="boolean"?(Ns(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Ns(e)&&(n=e,e=void 0),e=e||"");var i=Vs(),o=t?i._week.dow:0,s,a=[];if(n!=null)return bw(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=bw(e,(s+o)%7,r,"day");return a}function iq(t,e){return fV(t,e,"months")}function oq(t,e){return fV(t,e,"monthsShort")}function sq(t,e,n){return WT(t,e,n,"weekdays")}function aq(t,e,n){return WT(t,e,n,"weekdaysShort")}function lq(t,e,n){return WT(t,e,n,"weekdaysMin")}Na("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=it(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});J.lang=Mi("moment.lang is deprecated. Use moment.locale instead.",Na);J.langData=Mi("moment.langData is deprecated. Use moment.localeData instead.",Vs);var Ko=Math.abs;function uq(){var t=this._data;return this._milliseconds=Ko(this._milliseconds),this._days=Ko(this._days),this._months=Ko(this._months),t.milliseconds=Ko(t.milliseconds),t.seconds=Ko(t.seconds),t.minutes=Ko(t.minutes),t.hours=Ko(t.hours),t.months=Ko(t.months),t.years=Ko(t.years),this}function gV(t,e,n,r){var i=ao(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function cq(t,e){return gV(this,t,e,1)}function hq(t,e){return gV(this,t,e,-1)}function pO(t){return t<0?Math.floor(t):Math.ceil(t)}function dq(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=pO(uR(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Ci(t/1e3),r.seconds=i%60,o=Ci(i/60),r.minutes=o%60,s=Ci(o/60),r.hours=s%24,e+=Ci(s/24),l=Ci(mV(e)),n+=l,e-=pO(uR(l)),a=Ci(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function mV(t){return t*4800/146097}function uR(t){return t*146097/4800}function fq(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=xi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+mV(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(uR(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function gq(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+it(this._months/12)*31536e6:NaN}function Bs(t){return function(){return this.as(t)}}var mq=Bs("ms"),pq=Bs("s"),wq=Bs("m"),vq=Bs("h"),Cq=Bs("d"),yq=Bs("w"),Sq=Bs("M"),bq=Bs("Q"),Rq=Bs("y");function Eq(){return ao(this)}function Tq(t){return t=xi(t),this.isValid()?this[t+"s"]():NaN}function hu(t){return function(){return this.isValid()?this._data[t]:NaN}}var _q=hu("milliseconds"),Mq=hu("seconds"),xq=hu("minutes"),Pq=hu("hours"),Oq=hu("days"),Aq=hu("months"),Iq=hu("years");function Hq(){return Ci(this.days()/7)}var ds=Math.round,Tc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Dq(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function Nq(t,e,n,r){var i=ao(t).abs(),o=ds(i.as("s")),s=ds(i.as("m")),a=ds(i.as("h")),l=ds(i.as("d")),u=ds(i.as("M")),c=ds(i.as("w")),h=ds(i.as("y")),f=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(f=f||c<=1&&["w"]||c<n.w&&["ww",c]),f=f||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],f[2]=e,f[3]=+t>0,f[4]=r,Dq.apply(null,f)}function kq(t){return t===void 0?ds:typeof t=="function"?(ds=t,!0):!1}function Lq(t,e){return Tc[t]===void 0?!1:e===void 0?Tc[t]:(Tc[t]=e,t==="s"&&(Tc.ss=e-1),!0)}function $q(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Tc,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Tc,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=Nq(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Vy=Math.abs;function Su(t){return(t>0)-(t<0)||+t}function zv(){if(!this.isValid())return this.localeData().invalidDate();var t=Vy(this._milliseconds)/1e3,e=Vy(this._days),n=Vy(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=Ci(t/60),i=Ci(r/60),t%=60,r%=60,o=Ci(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Su(this._months)!==Su(a)?"-":"",c=Su(this._days)!==Su(a)?"-":"",h=Su(this._milliseconds)!==Su(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var lt=Bv.prototype;lt.isValid=O7;lt.abs=uq;lt.add=cq;lt.subtract=hq;lt.as=fq;lt.asMilliseconds=mq;lt.asSeconds=pq;lt.asMinutes=wq;lt.asHours=vq;lt.asDays=Cq;lt.asWeeks=yq;lt.asMonths=Sq;lt.asQuarters=bq;lt.asYears=Rq;lt.valueOf=gq;lt._bubble=dq;lt.clone=Eq;lt.get=Tq;lt.milliseconds=_q;lt.seconds=Mq;lt.minutes=xq;lt.hours=Pq;lt.days=Oq;lt.weeks=Hq;lt.months=Aq;lt.years=Iq;lt.humanize=$q;lt.toISOString=zv;lt.toString=zv;lt.toJSON=zv;lt.locale=rV;lt.localeData=oV;lt.toIsoString=Mi("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",zv);lt.lang=iV;Ie("X",0,0,"unix");Ie("x",0,0,"valueOf");Ce("x",$v);Ce("X",s9);yt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});yt("x",function(t,e,n){n._d=new Date(it(t))});//! moment.js
J.version="2.29.4";F5(Dt);J.fn=oe;J.min=_7;J.max=M7;J.now=x7;J.utc=Uo;J.unix=nq;J.months=iq;J.isDate=Qf;J.locale=Na;J.invalid=Hv;J.duration=ao;J.isMoment=oo;J.weekdays=sq;J.parseZone=rq;J.localeData=Vs;J.isDuration=yp;J.monthsShort=oq;J.weekdaysMin=lq;J.defineLocale=IT;J.updateLocale=r7;J.locales=i7;J.weekdaysShort=aq;J.normalizeUnits=xi;J.relativeTimeRounding=kq;J.relativeTimeThreshold=Lq;J.calendarFormat=J7;J.prototype=oe;J.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Fq=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));function pV(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function cR(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function kd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function sn(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function ni(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ye(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function P(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function wV(t){return sn(t,(e,n)=>e+n,0)}function Wq(t){return sn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function Vq(t){return sn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function Bq(t){return t.length?wV(t)/t.length:0}function vV(t){return sn(t,(e,n)=>e.concat(Array.isArray(n)?vV(n):n),[])}function VT(t){const e=[];return P(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function hR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return P(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function Uq(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return P(i,s=>{o=o.filter(a=>s.includes(a))}),o}function zq(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return P(i,s=>{P(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function dR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const Gq=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:Bq,arrayEach:P,arrayFilter:ni,arrayFlatten:vV,arrayMap:Ye,arrayMax:Wq,arrayMin:Vq,arrayReduce:sn,arraySum:wV,arrayUnique:VT,extendArray:cR,getDifferenceOfArrays:hR,getIntersectionOfArrays:Uq,getUnionOfArrays:zq,pivot:kd,stringToArray:dR,to2dArray:pV},Symbol.toStringTag,{value:"Module"}));function vt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return sn(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Qt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function fe(t){return typeof t<"u"}function Tt(t){return typeof t>"u"}function Cn(t){return t===null||t===""||Tt(t)}function CV(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const vd="length",Ld=t=>parseInt(t,16),wO=t=>parseInt(t,10),Rw=(t,e,n)=>t.substr(e,n),$d=t=>t.codePointAt(0)-65,fR=t=>`${t}`.replace(/\-/g,""),jq=t=>Ld(Rw(fR(t),Ld("12"),$d("F")))/(Ld(Rw(fR(t),$d("B"),~~![][vd]))||9),Yq=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let vO=!1;const CO={invalid:()=>vt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return vt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>vt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},yO={invalid:()=>vt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return vt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>vt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function yV(t,e){const n=!Cn(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.0.0";let o,s="invalid",a="invalid";t=fR(t||"");const l=Kq(t);if(n||r||l)if(l){const u=J("30/11/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=jq(t);o=J((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(Yq()&&(s="valid",a="valid"),!vO&&s!=="valid"&&(CO[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](CO[s]({keyValidityDate:o,hotVersion:i})),vO=!0),a!=="valid"&&e.parentNode&&yO[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=yO[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function Kq(t){let e=[][vd],n=e;if(t[vd]!==$d("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=$d(i.shift());o;o=$d(i.shift()||"A"))--o<""[vd]?n=n|(wO(`${wO(Ld(r)+(Ld(Rw(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Rw(t,o,o?i[vd]===1?9:8:6);return n===e}const Xq=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:yV,isDefined:fe,isEmpty:Cn,isRegExp:CV,isUndefined:Tt,stringify:Qt},Symbol.toStringTag,{value:"Module"}));function nr(t){return t[0].toUpperCase()+t.substr(1)}function qq(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Qt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function BT(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function UT(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function zT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function gR(t){return Gv(`${t}`,{ALLOWED_TAGS:[]})}function Gv(t,e){return $5.sanitize(t,e)}const Qq=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:qq,isPercentValue:UT,randomString:BT,sanitize:Gv,stripTags:gR,substitute:zT,toUpperCaseFirst:nr},Symbol.toStringTag,{value:"Module"})),uh=t=>["tabindex",t],Zq=()=>["role","treegrid"],No=()=>["role","presentation"],Jq=()=>["role","gridcell"],eQ=()=>["role","rowheader"],SV=()=>["role","rowgroup"],tQ=()=>["role","columnheader"],mR=()=>["role","row"],nQ=()=>["role","menu"],rQ=()=>["role","menuitem"],iQ=()=>["role","combobox"],bV=()=>["role","listbox"],oQ=()=>["role","option"],sQ=()=>["role","checkbox"],aQ=()=>["scope","col"],lQ=()=>["scope","row"],uQ=()=>["type","text"],GT=t=>["aria-label",t],Us=()=>["aria-hidden","true"],cQ=()=>["aria-disabled","true"],hQ=()=>["aria-multiselectable","true"],RV=t=>["aria-haspopup",t],EV=t=>["aria-rowcount",t],jv=t=>["aria-colcount",t],TV=t=>["aria-rowindex",t],jT=t=>["aria-colindex",t],bi=t=>["aria-expanded",t],dQ=t=>["aria-sort",t],SO=()=>["aria-readonly","true"],bO=()=>["aria-invalid","true"],fQ=t=>["aria-checked",t],YT=()=>["aria-selected","true"],gQ=()=>["aria-autocomplete","list"],mQ=t=>["aria-controls",t],pQ=t=>["aria-activedescendant",t],wQ=t=>["aria-live",t],vQ=t=>["aria-relevant",t],CQ=t=>["aria-setsize",t],yQ=t=>["aria-posinset",t];function _V(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function MV(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function xV(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Ef(t){return xV(t)&&t.parent}function SQ(t){return!!Object.getPrototypeOf(t.parent)}function Ua(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Cd(t,e,n){const r=[];let i=t;for(;i&&(i=Ua(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function ka(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function PV(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function aa(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function OV(t){return!t||!t.length?[]:t.filter(e=>!!e)}function AV(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),e?{regexFree:r,regexes:n}:r}function $e(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function te(t,e){typeof e=="string"&&(e=e.split(" ")),e=OV(e),e.length>0&&t.classList.add(...e)}function We(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=AV(e,!0);n=OV(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Ae(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function du(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=AV(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function KT(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)KT(e[n])}}function so(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const IV=/(<(.*)>|&(.*);)/;function fu(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;IV.test(e)?t.innerHTML=n?Gv(e):e:za(t,e)}function za(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(so(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Ga(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Ga(n.host.impl);if(n.host)return Ga(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(ks(n).display==="none")return!1;n=n.parentNode}return!0}function cn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function XT(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Yv(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Tf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?XT(e):t.scrollTop}function Ew(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Yv(e):t.scrollLeft}function _f(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function Jl(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=ks(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function qc(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=ks(t,n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function bQ(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function ks(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function wt(t){return t.offsetWidth}function Bt(t){return t.offsetHeight}function bs(t){return t.clientHeight||t.innerHeight}function Fd(t){return t.clientWidth||t.innerWidth}function RQ(t,e,n){t.addEventListener(e,n,!1)}function EQ(t,e,n){t.removeEventListener(e,n,!1)}function qT(t){return t.selectionStart?t.selectionStart:0}function HV(t){return t.selectionEnd?t.selectionEnd:0}function TQ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function pR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function tg(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let By;function _Q(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function Tn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return By===void 0&&(By=_Q(t)),By}function DV(t){return t.offsetWidth!==t.clientWidth}function NV(t){return t.offsetHeight!==t.clientHeight}function Kv(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function MQ(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function ng(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Tw(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Xv(t){return Tw(t)&&t.hasAttribute("data-hot-input")===!1}function xQ(t){const e=t.ownerDocument.activeElement;Xv(e)||t.select()}function QT(t){return!t.parentNode}function kV(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function ZT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Ae(t,"contenteditable",!0),n&&Ae(t,...Us()),e&&te(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function JT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&We(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function LV(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;ZT(t,n),e(),JT(t,n)}const PQ=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:IV,addClass:te,addEvent:RQ,clearTextSelection:pR,closest:Ua,closestDown:Cd,empty:so,fastInnerHTML:fu,fastInnerText:za,getCaretPosition:qT,getComputedStyle:ks,getCssTransform:MQ,getFrameElement:xV,getParent:_V,getParentWindow:Ef,getScrollLeft:Ew,getScrollTop:Tf,getScrollableElement:_f,getScrollbarWidth:Tn,getSelectionEndPosition:HV,getSelectionText:TQ,getStyle:qc,getTrimmingContainer:Jl,getWindowScrollLeft:Yv,getWindowScrollTop:XT,hasAccessToParentWindow:SQ,hasClass:$e,hasHorizontalScrollbar:NV,hasVerticalScrollbar:DV,index:PV,innerHeight:bs,innerWidth:Fd,isChildOf:ka,isDetached:QT,isInput:Tw,isOutsideInput:Xv,isThisHotChild:MV,isVisible:Ga,makeElementContentEditableAndSelectItsContent:ZT,matchesCSSRules:bQ,observeVisibilityChangeOnce:kV,offset:cn,outerHeight:Bt,outerWidth:wt,overlayContainsElement:aa,removeAttribute:du,removeClass:We,removeContentEditableFromElementAndDeselect:JT,removeEvent:EQ,removeTextNodes:KT,resetCssTransform:ng,runWithSelectedContendEditableElement:LV,selectElementIfAllowed:xQ,setAttribute:Ae,setCaretPosition:tg,setOverlayPosition:Kv},Symbol.toStringTag,{value:"Module"}));function Et(t){return typeof t=="function"}function $V(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function OQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=$V(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function qv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function AQ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return sn(i,(u,c)=>c(u),r.apply(this,a))}}function e1(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function FV(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function IQ(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function _w(t,e,n,r,i,o,s,a){return fe(a)?t.call(e,n,r,i,o,s,a):fe(s)?t.call(e,n,r,i,o,s):fe(o)?t.call(e,n,r,i,o):fe(i)?t.call(e,n,r,i):fe(r)?t.call(e,n,r):fe(n)?t.call(e,n):t.call(e)}const HQ=Object.freeze(Object.defineProperty({__proto__:null,curry:FV,curryRight:IQ,debounce:qv,fastCall:_w,isFunction:Et,partial:e1,pipe:AQ,throttle:$V,throttleAfterHits:OQ},Symbol.toStringTag,{value:"Module"}));var DQ=Er,RO=sW,NQ=Un,EO=sh,kQ=dW,TO=DQ([].push),LQ=function(t){if(NQ(t))return t;if(RO(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?TO(n,i):(typeof i=="number"||EO(i)==="Number"||EO(i)==="String")&&TO(n,kQ(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(RO(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},$Q=uu,WV=Yf,VV=Iv,FQ=Mv,rg=Er,BV=_i,_O=Un,MO=lT,UV=CT,WQ=LQ,VQ=aT,BQ=String,La=WV("JSON","stringify"),zg=rg(/./.exec),xO=rg("".charAt),UQ=rg("".charCodeAt),zQ=rg("".replace),GQ=rg(1 .toString),jQ=/[\uD800-\uDFFF]/g,PO=/^[\uD800-\uDBFF]$/,OO=/^[\uDC00-\uDFFF]$/,AO=!VQ||BV(function(){var t=WV("Symbol")("stringify detection");return La([t])!=="[null]"||La({a:t})!=="{}"||La(Object(t))!=="{}"}),IO=BV(function(){return La("\uDF06\uD834")!=='"\\udf06\\ud834"'||La("\uDEAD")!=='"\\udead"'}),YQ=function(t,e){var n=UV(arguments),r=WQ(e);if(!(!_O(r)&&(t===void 0||MO(t))))return n[1]=function(i,o){if(_O(r)&&(o=FQ(r,this,BQ(i),o)),!MO(o))return o},VV(La,null,n)},KQ=function(t,e,n){var r=xO(n,e-1),i=xO(n,e+1);return zg(PO,t)&&!zg(OO,i)||zg(OO,t)&&!zg(PO,r)?"\\u"+GQ(UQ(t,0),16):t};La&&$Q({target:"JSON",stat:!0,arity:3,forced:AO||IO},{stringify:function(e,n,r){var i=UV(arguments),o=VV(AO?YQ:La,null,i);return IO&&typeof o=="string"?zQ(o,jQ,KQ):o}});function Qc(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ke(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Qc(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Qc(n[0])]:e[r]=[]:e[r]=null)})),e}function zs(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function hn(t,e,n){const r=Array.isArray(n);return Ke(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function ig(t,e){Ke(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),ig(t[r],e[r])):t[r]=e[r]})}function rr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function yr(t){const e={};return Ke(t,(n,r)=>{e[r]=n}),e}function St(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return P(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Ke(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const f=`_${c}`,g=p=>{let y=p;return(Array.isArray(y)||je(y))&&(y=rr(y)),y};return function(){return this[f]===void 0&&(this[f]=g(h)),this[f]}},l=function(c){const h=`_${c}`;return function(f){this[h]=f}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Qv(t,e){return JSON.stringify(t)===JSON.stringify(e)}function je(t){return Object.prototype.toString.call(t)==="[object Object]"}function Go(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ke(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function zV(t,e){const n=e.split(".");let r=t;return Ke(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function bp(t,e,n){const r=e.split(".");let i=t;r.forEach((o,s)=>{s!==r.length-1?(Vt(i,o)||(i[o]={}),i=i[o]):i[o]=n})}function Zv(t){if(!je(t))return 0;const e=function(n){let r=0;return je(n)?Ke(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Qi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Vt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const XQ=Object.freeze(Object.defineProperty({__proto__:null,clone:yr,createObjectPropListener:Qi,deepClone:rr,deepExtend:ig,deepObjectSize:Zv,defineGetter:Go,duckSchema:Qc,extend:hn,getProperty:zV,hasOwnProperty:Vt,inherit:zs,isObject:je,isObjectEqual:Qv,mixin:St,objectEach:Ke,setProperty:bp},Symbol.toStringTag,{value:"Module"})),gi=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Gs={chrome:gi((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:gi(t=>/CriOS/.test(t)),edge:gi(t=>/Edge/.test(t)),edgeWebKit:gi(t=>/EdgiOS/.test(t)),firefox:gi(t=>/Firefox/.test(t)),firefoxWebKit:gi(t=>/FxiOS/.test(t)),mobile:gi(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:gi((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},ch={mac:gi(t=>/^Mac/.test(t)),win:gi(t=>/^Win/.test(t)),linux:gi(t=>/^Linux/.test(t)),ios:gi(t=>/iPhone|iPad|iPod/i.test(t))};function GV(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ke(Gs,n=>{let{test:r}=n;return void r(t,e)})}function jV(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ke(ch,e=>{let{test:n}=e;return void n(t)})}GV();jV();function t1(){return Gs.chrome.value}function YV(){return Gs.chromeWebKit.value}function Rp(){return Gs.firefox.value}function KV(){return Gs.firefoxWebKit.value}function n1(){return Gs.safari.value}function XV(){return Gs.edge.value}function qQ(){return Gs.edgeWebKit.value}function Rs(){return Gs.mobile.value}function r1(){return ch.ios.value}function i1(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&ch.mac.value}function wR(){return ch.win.value}function Mf(){return ch.mac.value}function QQ(){return ch.linux.value}const ZQ=Object.freeze(Object.defineProperty({__proto__:null,isChrome:t1,isChromeWebKit:YV,isEdge:XV,isEdgeWebKit:qQ,isFirefox:Rp,isFirefoxWebKit:KV,isIOS:r1,isIpadOS:i1,isLinuxOS:QQ,isMacOS:Mf,isMobileBrowser:Rs,isSafari:n1,isWindowsOS:wR,setBrowserMeta:GV,setPlatformMeta:jV},Symbol.toStringTag,{value:"Module"})),be={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Rp()?182:174,AUDIO_MUTE:Rp()?181:173,AUDIO_UP:Rp()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},JQ=[be.ALT,be.ARROW_DOWN,be.ARROW_LEFT,be.ARROW_RIGHT,be.ARROW_UP,be.AUDIO_DOWN,be.AUDIO_MUTE,be.AUDIO_UP,be.BACKSPACE,be.CAPS_LOCK,be.DELETE,be.END,be.ENTER,be.ESCAPE,be.F1,be.F2,be.F3,be.F4,be.F5,be.F6,be.F7,be.F8,be.F9,be.F10,be.F11,be.F12,be.F13,be.F14,be.F15,be.F16,be.F17,be.F18,be.F19,be.HOME,be.INSERT,be.MEDIA_NEXT,be.MEDIA_PLAY_PAUSE,be.MEDIA_PREV,be.MEDIA_STOP,be.NULL,be.NUM_LOCK,be.PAGE_DOWN,be.PAGE_UP,be.PAUSE,be.SCROLL_LOCK,be.SHIFT,be.TAB];function qV(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function o1(t){return JQ.includes(t)}function eZ(t){const e=[];return Mf()?e.push(be.COMMAND_LEFT,be.COMMAND_RIGHT,be.COMMAND_FIREFOX):e.push(be.CONTROL),e.includes(t)}function QV(t){return[be.CONTROL,be.COMMAND_LEFT,be.COMMAND_RIGHT,be.COMMAND_FIREFOX].includes(t)}function hh(t,e){const n=e.split("|");let r=!1;return P(n,i=>{if(t===be[i])return r=!0,!1}),r}const tZ=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:be,isCtrlKey:eZ,isCtrlMetaKey:QV,isFunctionKey:o1,isKey:hh,isPrintableChar:qV},Symbol.toStringTag,{value:"Module"}));function Pi(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function pa(t){return t.isImmediatePropagationEnabled===!1}function ja(t){return t.button===2}function Jv(t){return t.button===0}function ZV(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const nZ=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:pa,isLeftClick:Jv,isRightClick:ja,offsetRelativeTo:ZV,stopImmediatePropagation:Pi},Symbol.toStringTag,{value:"Module"}));function _t(){fe(console)&&console.warn(...arguments)}function s1(){fe(console)&&console.error(...arguments)}function rZ(t,e,n){return e=iZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iZ(t){var e=oZ(t,"string");return typeof e=="symbol"?e:String(e)}function oZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const bu=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],sZ=vt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Uy=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),zy=new Map([[]]);class JV{static getSingleton(){return lZ()}constructor(){rZ(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return P(bu,n=>e[n]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))P(n,i=>this.add(e,i,r));else{Uy.has(e)&&_t(zT(sZ,{hookName:e,removedInVersion:Uy.get(e)})),zy.has(e)&&_t(zy.get(e));const i=this.getBucket(r);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),n.skip=!1,i[e].indexOf(n)===-1){let o=!1;n.initialHook&&P(i[e],(s,a)=>{if(s.initialHook)return i[e][a]=n,o=!0,!1}),o||i[e].push(n)}}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?P(n,i=>this.once(e,i,r)):(n.runOnce=!0,this.add(e,n,r))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,i,o,s,a,l){{const u=this.globalBucket[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const f=_w(u[h],e,r,i,o,s,a,l);f!==void 0&&(r=f),u[h]&&u[h].runOnce&&this.remove(n,u[h]),h+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const f=_w(u[h],e,r,i,o,s,a,l);f!==void 0&&(r=f),u[h]&&u[h].runOnce&&this.remove(n,u[h],e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ke(this.getBucket(e),(n,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||bu.push(e)}deregister(e){this.isRegistered(e)&&bu.splice(bu.indexOf(e),1)}isDeprecated(e){return zy.has(e)||Uy.has(e)}isRegistered(e){return bu.indexOf(e)>=0}getRegistered(){return bu}}const aZ=new JV;function lZ(){return aZ}const ve=JV,Gy=new Map;function lo(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Gy.has(t)||Gy.set(t,new Map);const e=Gy.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const vR=new WeakMap,{register:uZ,getItem:e2,hasItem:t2,getNames:cZ,getValues:Wbe}=lo("editors");function hZ(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},ve.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function n2(t,e){let n;if(typeof t=="function")vR.get(t)||Hr(null,t),n=vR.get(t);else if(typeof t=="string")n=e2(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Mw(t){if(typeof t=="function")return t;if(!t2(t))throw Error(`No registered editor found under "${t}" name`);return e2(t).getConstructor()}function Hr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new hZ(e);typeof t=="string"&&uZ(t,n),vR.set(e,n)}function dZ(t,e,n){return e=fZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fZ(t){var e=gZ(t,"string");return typeof e=="symbol"?e:String(e)}function gZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Ep=0;class mZ{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;dZ(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,pZ(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Ep+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Ep-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Ep-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function pZ(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Pi(this)},t}const ri=mZ;function wZ(){return Ep}function HO(t,e){vZ(t,e),e.add(t)}function vZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xs(t,e,n){return e=CZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CZ(t){var e=yZ(t,"string");return typeof e=="symbol"?e:String(e)}function yZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DO(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const eC="editorManager.navigation";var NO=new WeakSet,kO=new WeakSet;class CR{constructor(e,n,r){HO(this,kO),HO(this,NO),Xs(this,"hot",void 0),Xs(this,"tableMeta",void 0),Xs(this,"selection",void 0),Xs(this,"eventManager",void 0),Xs(this,"destroyed",!1),Xs(this,"lock",!1),Xs(this,"activeEditor",void 0),Xs(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new ri(e),this.hot.addHook("afterDocumentKeyDown",i=>DO(this,NO,SZ).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>DO(this,kO,bZ).call(this,i,o,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,l=>{l&&this.prepareEditor()});return}const{highlight:e}=this.hot.getSelectedRangeLast();if(e.isHeader())return;const{row:n,col:r}=e,i=this.hot.runHooks("modifyGetCellCoords",n,r);let o=n,s=r;if(Array.isArray(i)&&([o,s]=i),this.cellProperties=this.hot.getCellMeta(o,s),!this.isCellEditable()){this.clearActiveEditor();return}const a=this.hot.getCell(n,r,!0);if(a){const l=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(s),c=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),s);this.activeEditor=n2(l,this.hot),this.activeEditor.prepare(n,r,u,a,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function SZ(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||pa(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!o1(n)&&!QV(n)&&!r&&!this.isEditorOpened()){const o=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>fe(this.hot.getSelected()),group:eC};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.openEditor("",t)}}function bZ(t,e,n){n.nodeName==="TD"&&this.openEditor(null,t,!0)}const LO=new WeakMap;CR.getInstance=function(t,e,n){let r=LO.get(t);return r||(r=new CR(t,e,n),LO.set(t,r)),r};const RZ=CR;function Gg(t,e){r2(t,e),e.add(t)}function Oh(t,e,n){r2(t,e),e.set(t,n)}function r2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _c(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function jt(t,e){var n=i2(t,e,"get");return EZ(t,n)}function EZ(t,e){return e.get?e.get.call(t):e.value}function Ah(t,e,n){var r=i2(t,e,"set");return TZ(t,r,n),n}function i2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function TZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const Ea=Object.freeze({CELL:"cell",MIXED:"mixed"});var Wn=new WeakMap,jg=new WeakMap,Yg=new WeakMap,Kg=new WeakMap,Xg=new WeakMap,xw=new WeakSet,$O=new WeakSet,FO=new WeakSet,WO=new WeakSet;class _Z{constructor(e){var n=this;Gg(this,WO),Gg(this,FO),Gg(this,$O),Gg(this,xw),Oh(this,Wn,{writable:!0,value:void 0}),Oh(this,jg,{writable:!0,value:void 0}),Oh(this,Yg,{writable:!0,value:50}),Oh(this,Kg,{writable:!0,value:null}),Oh(this,Xg,{writable:!0,value:new Map});const r=e.getSettings();Ah(this,Wn,e),Ah(this,jg,r.imeFastEdit?Ea.MIXED:Ea.CELL),jt(this,Wn).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return _c(n,WO,PZ).call(n,...o)}),jt(this,Wn).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return _c(n,$O,MZ).call(n,...o)}),jt(this,Wn).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return _c(n,FO,xZ).call(n,...o)})}getFocusMode(){return jt(this,jg)}setFocusMode(e){Object.values(Ea).includes(e)?Ah(this,jg,e):_t(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return jt(this,Yg)}setRefocusDelay(e){Ah(this,Yg,e)}setRefocusElementGetter(e){Ah(this,Kg,e)}getRefocusElement(){if(typeof jt(this,Kg)=="function")return jt(this,Kg).call(this);var e;return(e=jt(this,Wn).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=jt(this,Wn).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=jt(this,Wn).runHooks("modifyFocusedElement",s.row,s.col,r);a instanceof HTMLElement||(a=r),a&&!((o=jt(this,Wn).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):_c(this,xw,a1).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:jt(this,Yg);const r=this.getRefocusElement();jt(this,Wn).getSettings().imeFastEdit&&!((e=jt(this,Wn).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(jt(this,Xg).has(n)||jt(this,Xg).set(n,qv(()=>{r.select()},n)),jt(this,Xg).get(n)())}}function a1(t){var e;const n=(e=jt(this,Wn).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!jt(this,Wn).selection.isCellVisible(n)){t(null);return}const r=jt(this,Wn).getCell(n.row,n.col,!0);r===null?jt(this,Wn).addHookOnce("afterScroll",()=>{t(jt(this,Wn).getCell(n.row,n.col,!0))}):t(r)}function MZ(){_c(this,xw,a1).call(this,t=>{const{activeElement:e}=jt(this,Wn).rootDocument;e&&Xv(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function xZ(){_c(this,xw,a1).call(this,t=>{this.getFocusMode()===Ea.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function PZ(t){t.imeFastEdit&&this.getFocusMode()!==Ea.MIXED?this.setFocusMode(Ea.MIXED):!t.imeFastEdit&&this.getFocusMode()!==Ea.CELL&&this.setFocusMode(Ea.CELL)}const o2={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},OZ=new RegExp(Object.keys(o2).map(t=>`(${t})`).join("|"),"gi");function AZ(t){return(t&&t.nodeName||"")==="TABLE"}function yR(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let f=0;f<o;f+=1){const g=e&&f===0,p=[];for(let E=0;E<s;E+=1){const v=!g&&n&&E===0;let C="";if(g)C=`<th>${t.getColHeader(E-c)}</th>`;else if(v)C=`<th>${t.getRowHeader(f-h)}</th>`;else{const S=i[f][E],{hidden:T,rowspan:_,colspan:A}=t.getCellMeta(f-h,E-c);if(!T){const D=[];if(_&&D.push(`rowspan="${_}"`),A&&D.push(`colspan="${A}"`),Cn(S))C=`<td ${D.join(" ")}></td>`;else{const U=S.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");C=`<td ${D.join(" ")}>${U}</td>`}}}p.push(C)}const y=["<tr>",...p,"</tr>"].join("");g?l.splice(1,0,y):u.splice(-1,0,y)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function SR(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Cn(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function s2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const S=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,T=>{const _=T.match(/<td\b[^>]*?>/g)[0],A=T.substring(_.length,T.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${_}${A}</td>`});i.insertAdjacentHTML("afterbegin",`${S}`),o=i.querySelector("table")}if(!o||!AZ(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((S,T)=>S+T.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let f=!1,g=0,p=0;if(o.tHead){const S=Array.from(o.tHead.rows).filter(T=>{const _=T.querySelector("td")!==null;return _&&h.push(T),!_});g=S.length,f=g>0,g>1?n.nestedHeaders=Array.from(S).reduce((T,_)=>{const A=Array.from(_.cells).reduce((D,U,z)=>{if(a&&z===0)return D;const{colSpan:G,innerHTML:Z}=U,re=G>1?{label:Z,colspan:G}:Z;return D.push(re),D},[]);return T.push(A),T},[]):f&&(n.colHeaders=Array.from(S[0].children).reduce((T,_,A)=>(a&&A===0||T.push(_.innerHTML),T),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const y=[...h,...Array.from(o.tBodies).reduce((S,T)=>(S.push(...Array.from(T.rows)),S),[]),...c];p=y.length;const E=new Array(p);for(let S=0;S<p;S++)E[S]=new Array(u);const v=[],C=[];for(let S=0;S<p;S++){const T=y[S],_=Array.from(T.cells),A=_.length;for(let D=0;D<A;D++){const U=_[D],{nodeName:z,innerHTML:G,rowSpan:Z,colSpan:re}=U,ne=E[S].findIndex(he=>he===void 0);if(z==="TD"){if(Z>1||re>1){for(let ke=S;ke<S+Z;ke++)if(ke<p)for(let R=ne;R<ne+re;R++)E[ke][R]=null;const Me=U.getAttribute("style");Me&&Me.includes("mso-ignore:colspan")||v.push({col:ne,row:S,rowspan:Z,colspan:re})}let he="";s&&/excel/gi.test(s.content)?he=G.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):he=G.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),E[S][ne]=he.replace(OZ,Me=>o2[Me])}else C.push(G)}}return v.length&&(n.mergeCells=v),C.length&&(n.rowHeaders=C),E.length&&(n.data=E),n}const IZ=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:SR,htmlToGridSettings:s2,instanceToHTML:yR},Symbol.toStringTag,{value:"Module"}));function vr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function a2(t){return vr(t,[","])}function Re(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function Pw(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function l1(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function $r(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const HZ=Object.freeze(Object.defineProperty({__proto__:null,clamp:$r,isNumeric:vr,isNumericLike:a2,rangeEach:Re,rangeEachReverse:Pw,valueAccordingPercent:l1},Symbol.toStringTag,{value:"Module"})),bR="asc",DZ="desc",VO=new Map([[bR,[-1,1]],[DZ,[1,-1]]]),NZ=t=>`The priority '${t}' is already declared in a map.`,kZ=t=>`The priority '${t}' is not a number.`;function LZ(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=Et(t)?t:NZ,e=Et(e)?e:kZ;function r(o,s){if(!vr(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bR;const[s,a]=VO.get(o)||VO.get(bR);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const $Z=t=>`The id '${t}' is already declared in a map.`;function tC(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Et(t)?t:$Z;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[f,g]=h;return u===g?f:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const FZ=t=>`'${t}' value is already declared in a unique set.`;function WZ(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Et(t)?t:FZ;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const u1=t=>`There is already registered "${t}" plugin.`,VZ=t=>`There is already registered plugin on priority "${t}".`,BZ=t=>`The priority "${t}" is not a number.`,l2=LZ({errorPriorityExists:VZ,errorPriorityNaN:BZ}),u2=WZ({errorItemExists:u1}),RR=tC({errorIdExists:u1});function c1(){return[...l2.getItems(),...u2.getItems()]}function og(t){const e=nr(t);return RR.getItem(e)}function UZ(t){return!!og(t)}function at(t,e,n){[t,e,n]=GZ(t,e,n),og(t)===void 0&&zZ(t,e,n)}function zZ(t,e,n){const r=nr(t);if(RR.hasItem(r))throw new Error(u1(r));n===void 0?u2.addItem(r):l2.addItem(n,r),RR.addItem(r,e)}function GZ(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:jZ,getItem:YZ,hasItem:c2,getNames:KZ,getValues:Vbe}=lo("renderers");function Ow(t){if(typeof t=="function")return t;if(!c2(t))throw Error(`No registered renderer found under "${t}" name`);return YZ(t)}function Mo(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),jZ(t,e)}const{register:XZ,getItem:qZ,hasItem:h2,getNames:QZ,getValues:Bbe}=lo("validators");function h1(t){if(typeof t=="function")return t;if(!h2(t))throw Error(`No registered validator found under "${t}" name`);return qZ(t)}function Mc(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),XZ(t,e)}var d2={},ZZ=rW,JZ=wT,eJ=Object.keys||function(e){return ZZ(e,JZ)},tJ=Vo,nJ=qF,rJ=lu,iJ=Kf,oJ=xv,sJ=eJ;d2.f=tJ&&!nJ?Object.defineProperties:function(e,n){iJ(e);for(var r=oJ(n),i=sJ(n),o=i.length,s=0,a;o>s;)rJ.f(e,a=i[s++],r[a]);return e};var aJ=Kf,lJ=d2,BO=wT,uJ=gT,cJ=wW,hJ=dT,dJ=JF,UO=">",zO="<",ER="prototype",TR="script",f2=dJ("IE_PROTO"),jy=function(){},g2=function(t){return zO+TR+UO+t+zO+"/"+TR+UO},GO=function(t){t.write(g2("")),t.close();var e=t.parentWindow.Object;return t=null,e},fJ=function(){var t=hJ("iframe"),e="java"+TR+":",n;return t.style.display="none",cJ.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(g2("document.F=Object")),n.close(),n.F},qg,Tp=function(){try{qg=new ActiveXObject("htmlfile")}catch{}Tp=typeof document<"u"?document.domain&&qg?GO(qg):fJ():GO(qg);for(var t=BO.length;t--;)delete Tp[ER][BO[t]];return Tp()};uJ[f2]=!0;var gJ=Object.create||function(e,n){var r;return e!==null?(jy[ER]=aJ(e),r=new jy,jy[ER]=null,r[f2]=e):r=Tp(),n===void 0?r:lJ.f(r,n)},mJ=Ov,pJ=gJ,wJ=lu.f,_R=mJ("unscopables"),MR=Array.prototype;MR[_R]===void 0&&wJ(MR,_R,{configurable:!0,value:pJ(null)});var m2=function(t){MR[_R][t]=!0},vJ=uu,CJ=Pv,yJ=Av,SJ=pT,bJ=m2;vJ({target:"Array",proto:!0},{at:function(e){var n=CJ(this),r=yJ(n),i=SJ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});bJ("at");const Nl=1,Zn=2;function jO(t,e,n){RJ(t,e),e.set(t,n)}function RJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xo(t,e,n){return e=EJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EJ(t){var e=TJ(t,"string");return typeof e=="symbol"?e:String(e)}function TJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fn(t,e){var n=p2(t,e,"get");return _J(t,n)}function _J(t,e){return e.get?e.get.call(t):e.value}function YO(t,e,n){var r=p2(t,e,"set");return MJ(t,r,n),n}function p2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function MJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Qg=new WeakMap,gn=new WeakMap;class d1{static get DEFAULT_WIDTH(){return 50}constructor(e){Xo(this,"count",0),Xo(this,"startColumn",null),Xo(this,"endColumn",null),Xo(this,"startPosition",null),Xo(this,"isVisibleInTrimmingContainer",!1),Xo(this,"stretchAllRatio",0),Xo(this,"stretchLastWidth",0),jO(this,Qg,{writable:!0,value:0}),Xo(this,"needVerifyLastColumnWidth",!0),Xo(this,"stretchAllColumnsWidth",[]),jO(this,gn,{writable:!0,value:void 0}),YO(this,gn,e),typeof fn(this,gn).stretchingColumnWidthFn!="function"&&(fn(this,gn).stretchingColumnWidthFn=n=>n),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,scrollOffset:r,totalColumns:i,viewportWidth:o}=fn(this,gn),s=Math.max(fn(this,gn).scrollOffset,0),a=s>0?o+1:o;let l=0,u=!0;const c=[];let h,f=0,g=0;for(let v=0;v<i;v++)if(h=this._getColumnWidth(v),l<=s&&e!==Zn&&(this.startColumn=v,f=h),l>=s&&l+(e===Zn?h:0)<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=v,f=h),this.endColumn=v),c.push(l),l+=h,g=h,e!==Zn&&(this.endColumn=v),l>=s+o){u=!1;break}const p=r+o-a,y=e===Zn?0:g,E=e===Zn?f:0;if(p<-1*fn(this,gn).inlineStartOffset||r>c.at(-1)+y||-1*fn(this,gn).scrollOffset-fn(this,gn).viewportWidth>-1*E?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===i-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const v=c[this.endColumn]+h-c[this.startColumn-1];if((v<=o||e!==Zn)&&(this.startColumn-=1),v>o)break}e===Nl&&this.startColumn!==null&&n&&n(this),this.startPosition=c[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(fn(this,gn).stretchMode==="none")return;let n=e;YO(this,Qg,n);const r=fn(this,gn).totalColumns;let i=0;for(let s=0;s<r;s++){const a=this._getColumnWidth(s),l=fn(this,gn).stretchingColumnWidthFn(void 0,s);typeof l=="number"?n-=l:i+=a}const o=n-i;if(fn(this,gn).stretchMode==="all"&&o>0)this.stretchAllRatio=n/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(fn(this,gn).stretchMode==="last"&&n!==1/0){const s=this._getColumnWidth(r-1),a=o+s;this.stretchLastWidth=a>=0?a:s}}getStretchedColumnWidth(e,n){let r=null;return fn(this,gn).stretchMode==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):fn(this,gn).stretchMode==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0;const i=fn(this,gn).totalColumns;if(!this.stretchAllColumnsWidth[e]){const o=Math.round(n*this.stretchAllRatio),s=fn(this,gn).stretchingColumnWidthFn(o,e);s===void 0?this.stretchAllColumnsWidth[e]=o:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let o=0;o<this.stretchAllColumnsWidth.length;o++)r+=this.stretchAllColumnsWidth[o];r!==fn(this,Qg)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=fn(this,Qg)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const n=fn(this,gn).totalColumns;return e===n-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=fn(this,gn).columnWidthFn(e);return isNaN(n)&&(n=d1.DEFAULT_WIDTH),n}}const f1=d1;function xJ(t,e,n){PJ(t,e),e.set(t,n)}function PJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ih(t,e,n){return e=OJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OJ(t){var e=AJ(t,"string");return typeof e=="symbol"?e:String(e)}function AJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yy(t,e){var n=w2(t,e,"get");return IJ(t,n)}function IJ(t,e){return e.get?e.get.call(t):e.value}function HJ(t,e,n){var r=w2(t,e,"set");return DJ(t,r,n),n}function w2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function DJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Hh=new WeakMap;class g1{static get DEFAULT_HEIGHT(){return 23}constructor(e){Ih(this,"count",0),Ih(this,"startRow",null),Ih(this,"endRow",null),Ih(this,"startPosition",null),Ih(this,"isVisibleInTrimmingContainer",!1),xJ(this,Hh,{writable:!0,value:void 0}),HJ(this,Hh,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,rowHeightFn:r,scrollOffset:i,totalRows:o,viewportHeight:s}=Yy(this,Hh),a=Math.max(Yy(this,Hh).scrollOffset,0),l=Yy(this,Hh).horizontalScrollbarHeight||0;let u=0,c=!0;const h=[];let f,g=0,p=0;for(let C=0;C<o;C++)if(f=r(C),isNaN(f)&&(f=g1.DEFAULT_HEIGHT),u<=a&&e!==Zn&&(this.startRow=C,g=f),u>=a&&u+(e===Zn?f:0)<=a+s-l&&(this.startRow===null&&(this.startRow=C,g=f),this.endRow=C),h.push(u),u+=f,p=f,e!==Zn&&(this.endRow=C),u>=a+s-l){c=!1;break}const y=i+s-l,E=e===Zn?g:0,v=e===Zn?0:p;if(y<E||i>h.at(-1)+v?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const C=h[this.endRow]+f-h[this.startRow-1];if((C<=s-l||e!==Zn)&&(this.startRow-=1),C>=s-l)break}e===Nl&&this.startRow!==null&&n&&n(this),this.startPosition=h[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}const v2=g1;function NJ(t,e,n){kJ(t,e),e.set(t,n)}function kJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KO(t,e,n){return e=LJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LJ(t){var e=$J(t,"string");return typeof e=="symbol"?e:String(e)}function $J(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ru(t,e){var n=C2(t,e,"get");return FJ(t,n)}function FJ(t,e){return e.get?e.get.call(t):e.value}function XO(t,e,n){var r=C2(t,e,"set");return WJ(t,r,n),n}function C2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function WJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var qo=new WeakMap;class Aw{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;KO(this,"row",null),KO(this,"col",null),NJ(this,qo,{writable:!0,value:!1}),XO(this,qo,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Ru(this,qo)}isSouthEastOf(e){return this.row>=e.row&&(Ru(this,qo)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Ru(this,qo)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Ru(this,qo)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Ru(this,qo)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Aw&&XO(this,qo,e.isRtl()),this}clone(){return new Aw(this.row,this.col,Ru(this,qo))}toObject(){return{row:this.row,col:this.col}}}const Iw=Aw;function VJ(t,e,n){BJ(t,e),e.set(t,n)}function BJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ky(t,e,n){return e=UJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UJ(t){var e=zJ(t,"string");return typeof e=="symbol"?e:String(e)}function zJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ho(t,e){var n=y2(t,e,"get");return GJ(t,n)}function GJ(t,e){return e.get?e.get.call(t):e.value}function jJ(t,e,n){var r=y2(t,e,"set");return YJ(t,r,n),n}function y2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function YJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var li=new WeakMap;class m1{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Ky(this,"highlight",null),Ky(this,"from",null),Ky(this,"to",null),VJ(this,li,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),jJ(this,li,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(r.row,s.row),c=Math.max(r.col,s.col),h=this._createCellCoords(a,l),f=this._createCellCoords(u,c);return this.from=h,this.to=f,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return ho(this,li)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return ho(this,li)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return ho(this,li)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return ho(this,li)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return ho(this,li)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return ho(this,li)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return ho(this,li)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return ho(this,li)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,n){return n&&n.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,n){if(!(e instanceof Iw))return!1;if(n){const{from:r,to:i}=n;if(n.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(r.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,r.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push("right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push("left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new m1(this.highlight,this.from,this.to,ho(this,li))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new Iw(e,n,ho(this,li))}}const p1=m1;function nC(t){return window.requestAnimationFrame(t)}function xf(t){window.cancelAnimationFrame(t)}function w1(){return"ontouchstart"in window}let Eu;function S2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Eu||(typeof Intl=="object"?Eu=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Eu=(n,r)=>`${n}`.localeCompare(r):Eu=(n,r)=>n===r?0:n>r?-1:1,Eu)}const KJ=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:xf,getComparisonFunction:S2,isTouchSupported:w1,requestAnimationFrame:nC},Symbol.toStringTag,{value:"Module"}));function fo(t,e,n){XJ(t,e),e.set(t,n)}function XJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ee(t,e){var n=b2(t,e,"get");return qJ(t,n)}function qJ(t,e){return e.get?e.get.call(t):e.value}function qs(t,e,n){var r=b2(t,e,"set");return QJ(t,r,n),n}function b2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function QJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ui=new WeakMap,Xy=new WeakMap,Mn=new WeakMap,Tu=new WeakMap,Zg=new WeakMap,Ii=new WeakMap,qy=new WeakMap,Dh=new WeakMap,il=new WeakMap,go=new WeakMap;let ZJ=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;fo(this,ui,{writable:!0,value:void 0}),fo(this,Xy,{writable:!0,value:void 0}),fo(this,Mn,{writable:!0,value:void 0}),fo(this,Tu,{writable:!0,value:void 0}),fo(this,Zg,{writable:!0,value:void 0}),fo(this,Ii,{writable:!0,value:void 0}),fo(this,qy,{writable:!0,value:void 0}),fo(this,Dh,{writable:!0,value:void 0}),fo(this,il,{writable:!0,value:[null,null]}),fo(this,go,{writable:!0,value:[null,null]}),qs(this,ui,r),qs(this,Xy,n),qs(this,Mn,o),qs(this,Tu,s),qs(this,Zg,a),qs(this,Ii,i),qs(this,qy,e),this.registerEvents()}registerEvents(){Ee(this,Ii).addEventListener(Ee(this,Mn).holder,"contextmenu",r=>this.onContextMenu(r)),Ee(this,Ii).addEventListener(Ee(this,Mn).TABLE,"mouseover",r=>this.onMouseOver(r)),Ee(this,Ii).addEventListener(Ee(this,Mn).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{Ee(this,Ii).addEventListener(Ee(this,Mn).holder,"touchstart",r=>this.onTouchStart(r)),Ee(this,Ii).addEventListener(Ee(this,Mn).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),Ee(this,Ii).addEventListener(Ee(this,Mn).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Ee(this,ui).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Ee(this,ui).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{Ee(this,Ii).addEventListener(Ee(this,Mn).holder,"mouseup",r=>this.onMouseUp(r)),Ee(this,Ii).addEventListener(Ee(this,Mn).holder,"mousedown",r=>this.onMouseDown(r))};Rs()?e():(w1()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(Ee(this,Dh)&&r){const[i,o]=[r.row,Ee(this,Dh).from.row],[s,a]=[r.col,Ee(this,Dh).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=Ee(this,Mn).TABLE,i=Cd(e,["TD","TH"],r);return i?(n.coords=Ee(this,Mn).getCoords(i),n.TD=i):$e(e,"wtBorder")&&$e(e,"current")?(n.coords=Ee(this,Tu).getFocusSelection().cellRange.highlight,n.TD=Ee(this,Mn).getCell(n.coords)):$e(e,"wtBorder")&&$e(e,"area")&&Ee(this,Tu).getAreaSelection().cellRange&&(n.coords=Ee(this,Tu).getAreaSelection().cellRange.to,n.TD=Ee(this,Mn).getCell(n.coords)),n}onMouseDown(e){const n=Ee(this,Xy).rootDocument.activeElement,r=e1(_V,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);$e(i,"corner")?Ee(this,ui).getSetting("onCellCornerMouseDown",e,i):o.TD&&Ee(this,ui).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(Ee(this,go)[0]=o.TD,clearTimeout(Ee(this,il)[0]),Ee(this,il)[0]=setTimeout(()=>{Ee(this,go)[0]=null},1e3))}onContextMenu(e){if(Ee(this,ui).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!Ee(this,ui).has("onCellMouseOver"))return;const n=Ee(this,Mn).TABLE,r=Cd(e.target,["TD","TH"],n),i=Ee(this,Zg)||this;r&&r!==i.lastMouseOver&&ka(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,Ee(this,Mn).getCoords(r),r))}onMouseOut(e){if(!Ee(this,ui).has("onCellMouseOut"))return;const n=Ee(this,Mn).TABLE,r=Cd(e.target,["TD","TH"],n),i=Cd(e.relatedTarget,["TD","TH"],n),o=Ee(this,Zg)||this;r&&r!==i&&ka(r,n)&&(this.callListener("onCellMouseOut",e,Ee(this,Mn).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&Ee(this,ui).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===Ee(this,go)[0]&&n.TD===Ee(this,go)[1]?($e(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),Ee(this,go)[0]=null,Ee(this,go)[1]=null):n.TD===Ee(this,go)[0]&&(Ee(this,go)[1]=n.TD,clearTimeout(Ee(this,il)[1]),Ee(this,il)[1]=setTimeout(()=>{Ee(this,go)[1]=null},500)))}onTouchStart(e){qs(this,Dh,Ee(this,Tu).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=fe(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&Ee(this,ui).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];r1()&&(YV()||KV())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=Ee(this,ui).getSettingPure(e);o&&o(n,r,i,Ee(this,qy).call(this))}destroy(){clearTimeout(Ee(this,il)[0]),clearTimeout(Ee(this,il)[1]),Ee(this,Ii).destroy()}};const R2=ZJ;function Qy(t,e,n){return e=JJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JJ(t){var e=eee(t,"string");return typeof e=="symbol"?e:String(e)}function eee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tee{constructor(e,n,r){Qy(this,"offset",void 0),Qy(this,"total",void 0),Qy(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const nee=tee;function Zy(t,e,n){return e=ree(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ree(t){var e=iee(t,"string");return typeof e=="symbol"?e:String(e)}function iee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oee{constructor(e,n,r){Zy(this,"offset",void 0),Zy(this,"total",void 0),Zy(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const see=oee,aee=0,Hw=1,Dw=2;function Jg(t,e,n){return e=lee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lee(t){var e=uee(t,"string");return typeof e=="symbol"?e:String(e)}function uee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qO{constructor(){Jg(this,"currentSize",0),Jg(this,"nextSize",0),Jg(this,"currentOffset",0),Jg(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function Jy(t,e,n){return e=cee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cee(t){var e=hee(t,"string");return typeof e=="symbol"?e:String(e)}function hee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dee{constructor(){Jy(this,"size",new qO),Jy(this,"workingSpace",aee),Jy(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof qO}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Hw,e.workingSpace=Dw,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Dw,e.workingSpace=Hw,this.sharedSize=e.getViewSize()}}function _u(t,e,n){return e=fee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fee(t){var e=gee(t,"string");return typeof e=="symbol"?e:String(e)}function gee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E2{constructor(e,n,r){_u(this,"rootNode",void 0),_u(this,"nodesPool",void 0),_u(this,"sizeSet",new dee),_u(this,"childNodeType",void 0),_u(this,"visualIndex",0),_u(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(Hw))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn(Dw)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}const s=r&&n.isPlaceOn(Hw);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Dw)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class T2 extends E2{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function mee(t,e,n){return e=pee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pee(t){var e=wee(t,"string");return typeof e=="symbol"?e:String(e)}function wee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vee{constructor(e){mee(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Nh(t,e,n){return e=Cee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cee(t){var e=yee(t,"string");return typeof e=="symbol"?e:String(e)}function yee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sg{constructor(e,n){Nh(this,"nodesPool",null),Nh(this,"nodeType",void 0),Nh(this,"rootNode",void 0),Nh(this,"table",null),Nh(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new vee(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function QO(t,e,n){return e=See(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function See(t){var e=bee(t,"string");return typeof e=="symbol"?e:String(e)}function bee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ree extends sg{constructor(){super("TH"),QO(this,"orderViews",new WeakMap),QO(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new T2(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<r;h++){u.render();const f=u.getCurrentNode();f.className="",f.removeAttribute("style"),du(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ae(f,[eQ(),lQ(),jT(h+1),uh(-1)]),n[h](a,f,h)}u.end()}}}class Eee extends sg{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&so(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ae(this.rootNode,[SV()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Ae(s,[mR(),TV(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),du(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ae(u,[jT(a+1+this.table.rowHeadersCount),uh(-1),tQ(),...a>=0?[aQ()]:[mR()]]),r[n](l,u,n)}}}}class Tee extends sg{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&te(r,"rowHeader")}}function _ee(t,e,n){return e=Mee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mee(t){var e=xee(t,"string");return typeof e=="symbol"?e:String(e)}function xee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let ZO=!1;class Pee extends sg{constructor(e){super("TR",e),_ee(this,"orderView",void 0),this.orderView=new E2(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!ZO&&e>1e3&&(ZO=!0,_t(vt`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ae(this.rootNode,[SV()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Ae(o,[mR(),TV(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}function JO(t,e,n){return e=Oee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oee(t){var e=Aee(t,"string");return typeof e=="symbol"?e:String(e)}function Aee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Iee extends sg{constructor(){super("TD"),JO(this,"orderViews",new WeakMap),JO(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new T2(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let f=0;f<n;f++){c.render();const g=c.getCurrentNode(),p=this.table.renderedColumnToSource(f);if($e(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),du(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,p,g),this.table.isAriaEnabled()){var o,s;Ae(g,[...g.hasAttribute("role")?[]:[Jq()],uh(-1),jT(p+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function xn(t,e,n){return e=Hee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hee(t){var e=Dee(t,"string");return typeof e=="symbol"?e:String(e)}function Dee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nee{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};xn(this,"rootNode",void 0),xn(this,"rootDocument",void 0),xn(this,"rowHeaders",null),xn(this,"columnHeaders",null),xn(this,"colGroup",null),xn(this,"rows",null),xn(this,"cells",null),xn(this,"rowFilter",null),xn(this,"columnFilter",null),xn(this,"rowUtils",null),xn(this,"columnUtils",null),xn(this,"rowsToRender",0),xn(this,"columnsToRender",0),xn(this,"rowHeaderFunctions",[]),xn(this,"rowHeadersCount",0),xn(this,"columnHeaderFunctions",[]),xn(this,"columnHeadersCount",0),xn(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r);if(i.firstChild){const o=this.renderedRowToSource(r),s=this.rowUtils.getHeight(o);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}}class kee{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Nee(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new Ree,columnHeaders:new Eee(n),colGroup:new Tee(r),rows:new Pee(i),cells:new Iee}),this.renderer.setAxisUtils(o,s)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function eS(t,e,n){return e=Lee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lee(t){var e=$ee(t,"string");return typeof e=="symbol"?e:String(e)}function $ee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fee{constructor(e,n){eS(this,"dataAccessObject",void 0),eS(this,"wtSettings",void 0),eS(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const n=this.dataAccessObject.wtViewport.columnsRenderCalculator;let r=this.getWidth(e);if(n){const i=n.getStretchedColumnWidth(e,r);i&&(r=i)}return r}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:n,wtViewport:r,cloneSource:i}=this.dataAccessObject,o=i?i.wtTable.holder:n.holder,s=o.offsetHeight<o.scrollHeight?Tn():0;let a=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-s),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){const l=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth");for(let c=0;c<l;c++){let h=Array.isArray(a)?a[c]:a;h=h??u,this.headerWidths.set(c,h)}}}}function eA(t,e,n){return e=Wee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wee(t){var e=Vee(t,"string");return typeof e=="symbol"?e:String(e)}function Vee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bee{constructor(e,n){eA(this,"dataAccessObject",void 0),eA(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}}function mo(t,e,n){return e=Uee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uee(t){var e=zee(t,"string");return typeof e=="symbol"?e:String(e)}function zee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gee{constructor(e,n,r,i,o){mo(this,"wtSettings",null),mo(this,"domBindings",void 0),mo(this,"TBODY",null),mo(this,"THEAD",null),mo(this,"COLGROUP",null),mo(this,"hasTableHeight",!0),mo(this,"hasTableWidth",!0),mo(this,"isTableVisible",!1),mo(this,"tableOffset",0),mo(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,KT(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new Bee(this.dataAccessObject,this.wtSettings),this.columnUtils=new Fee(this.dataAccessObject,this.wtSettings),this.tableRenderer=new kee({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!$e(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ae(r,[No()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!$e(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ae(r,[No()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!$e(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ae(r.parentNode,[No()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ae(r,[No()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=!1,f=e;if(this.isMaster&&(this.holderOffset=cn(this.holder),f=i.createRenderCalculators(f),l&&!n.getSetting("fixedColumnsStart"))){const p=r.inlineStartOverlay.getScrollPosition(),y=this.correctHeaderWidth;this.correctHeaderWidth=p!==0,y!==this.correctHeaderWidth&&(f=!1)}if(this.isMaster&&(h=r.updateStateOfRendering()),f)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=cn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const p=o>0?this.getFirstRenderedRow():0,y=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new see(p,o,c),this.columnFilter=new nee(y,s,l);let E=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const v={};this.wtSettings.getSetting("beforeDraw",!0,v),E=v.skipRender!==!0}if(E){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Ho)||this.is($a))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let v;if(this.isMaster&&(v=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Ho))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const C=wt(this.hider),S=wt(this.TABLE);C!==0&&S!==C&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),v!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Ho)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let g=!1;return this.isMaster&&(g=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(g=r.bottomOverlay.resetFixedPosition()||g),g=r.inlineStartOverlay.resetFixedPosition()||g,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),g?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(f),h&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=bs(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Ho))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Ua(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let o=PV(r),s=n.cellIndex;return aa(nu,n,this.wtRootElement)||aa(eu,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):aa($a,n,this.wtRootElement)||aa(Ho,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),aa(nu,n,this.wtRootElement)||aa(tu,n,this.wtRootElement)||aa($a,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),r=bs(this.TBODY)-1;let i,o,s,a,l;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=bs(l):o=bs(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return wt(this.TABLE)}getHeight(){return Bt(this.TABLE)}getTotalWidth(){const e=wt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Bt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Ga(this.TABLE)}_modifyRowHeaderWidth(e){let n=Et(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const dh=Gee,jee="stickyRowsBottom",_2={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Go(_2,"MIXIN_NAME",jee,{writable:!1,enumerable:!1});const M2=_2,Yee="stickyColumnsStart",x2={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Go(x2,"MIXIN_NAME",Yee,{writable:!1,enumerable:!1});const v1=x2;class C1 extends dh{constructor(e,n,r,i){super(e,n,r,i,$a)}}St(C1,M2);St(C1,v1);const Kee=C1,eu="top",Ho="bottom",tu="inline_start",nu="top_inline_start_corner",$a="bottom_inline_start_corner",Xee=[eu,Ho,tu,nu,$a],qee=new Map([[eu,`ht_clone_${eu}`],[Ho,`ht_clone_${Ho}`],[tu,`ht_clone_${tu} ht_clone_left`],[nu,`ht_clone_${nu} ht_clone_top_left_corner`],[$a,`ht_clone_${$a} ht_clone_bottom_left_corner`]]);function tS(t,e,n){return e=Qee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qee(t){var e=Zee(t,"string");return typeof e=="symbol"?e:String(e)}function Zee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jee{constructor(e){tS(this,"dataAccessObject",void 0),tS(this,"lastScrolledColumnPos",-1),tS(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,n,r,i,o){const s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,n,i);return s||a}scrollViewportHorizontally(e,n,r){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=n===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let h=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?h=c.scrollTo(e,l?e>this.lastScrolledColumnPos:n):(l&&(e<s||e>a)||!l)&&(h=c.scrollTo(e,l?e>a:n)),h&&(this.lastScrolledColumnPos=e),h}scrollViewportVertically(e,n,r){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=n===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:h}=this.dataAccessObject;if(l&&(e<c||e>o-u-1))return!1;let f=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?f=h.scrollTo(e,l?e>this.lastScrolledRowPos:r):(l&&(e<s||e>a)||!l)&&(f=h.scrollTo(e,l?e>a:r)),f&&(this.lastScrolledRowPos=e),f}getFirstVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,fixedRowsTop:o,rootWindow:s}=this.dataAccessObject;let a=n.getFirstVisibleRow();if(e.mainTableScrollableElement===s){const l=cn(n.wtRootElement),u=bs(n.hider),c=bs(s),h=Tf(s,s);if(l.top+u-c<=h){let f=r.getColumnHeaderHeight();f+=e.sumCellSizes(0,o);for(let g=i;g>0;g--)if(f+=e.sumCellSizes(g-1,g),l.top+u-f<=h){a=g;break}}}return a}getLastVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;let s=n.getLastVisibleRow();if(e.mainTableScrollableElement===o){const a=cn(n.wtRootElement),l=Tf(o,o);if(a.top>l){const u=bs(o);let c=r.getColumnHeaderHeight();for(let h=1;h<=i;h++)if(c+=e.sumCellSizes(h-1,h),a.top+c-l>=u){s=h-2;break}}}return s}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:n,wtViewport:r,totalColumns:i,rootWindow:o}=this.dataAccessObject;let s=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===o){const a=cn(n.wtRootElement),l=Fd(n.hider),u=Fd(o),c=Math.abs(Ew(o,o));if(a.left+l-u<=c){let h=r.getRowHeaderWidth();for(let f=i;f>0;f--)if(h+=e.sumCellSizes(f-1,f),a.left+l-h<=c){s=f;break}}}return s}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;let a=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){const l=e.getSetting("rtlMode");let u=null;if(l){const h=r.TABLE.getBoundingClientRect(),g=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(h.right-g)}else u=cn(r.wtRootElement).left;const c=Math.abs(Ew(s,s));if(u>c){const h=Fd(s);let f=i.getRowHeaderWidth();for(let g=1;g<=o;g++)if(f+=n.sumCellSizes(g-1,g),u+f-c>=h){a=g-2;break}}}return a}}const ete=Jee;function Hi(t,e,n){return e=tte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tte(t){var e=nte(t,"string");return typeof e=="symbol"?e:String(e)}function nte(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y1{get eventManager(){return new ri(this)}constructor(e,n){Hi(this,"wtTable",void 0),Hi(this,"wtScroll",void 0),Hi(this,"wtViewport",void 0),Hi(this,"wtOverlays",void 0),Hi(this,"selectionManager",void 0),Hi(this,"wtEvent",void 0),Hi(this,"guid",`wt_${BT()}`),Hi(this,"drawInterrupted",!1),Hi(this,"drawn",!1),Hi(this,"domBindings",void 0),Hi(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new ete(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){za(r,e[n])}])}}createCellCoords(e,n){return new Iw(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new p1(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function tA(t,e,n){return e=rte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rte(t){var e=ite(t,"string");return typeof e=="symbol"?e:String(e)}function ite(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ote extends y1{constructor(e,n,r){super(e,n),tA(this,"cloneSource",void 0),tA(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new R2(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function ste(t,e,n){return e=ate(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ate(t){var e=lte(t,"string");return typeof e=="symbol"?e:String(e)}function lte(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ag{constructor(e,n,r,i,o){ste(this,"wtSettings",null),Go(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Jl(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Jl(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=_f(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){_t(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Tn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(Xee.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${qee.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Ae(o,[No()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===eu||u==="vertical"&&this.type===tu?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=_f(e.TABLE),new ote(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;P([r,i,o],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class ute extends ag{constructor(e,n,r,i,o,s){super(e,n,$a,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Kee(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else ng(n),this.repositionOverlay();let r=Bt(this.clone.wtTable.TABLE);const i=wt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Tn(r)),i.style.bottom=`${o}px`}}const cte="calculatedColumns",P2={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Go(P2,"MIXIN_NAME",cte,{writable:!1,enumerable:!1});const S1=P2;class b1 extends dh{constructor(e,n,r,i){super(e,n,r,i,Ho)}}St(b1,M2);St(b1,S1);const hte=b1;function dte(t,e,n){return e=fte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fte(t){var e=gte(t,"string");return typeof e=="symbol"?e:String(e)}function gte(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mte extends ag{constructor(e,n,r,i){super(e,n,Ho,r,i),dte(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new hte(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Tn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(Yv(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=Tn(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=o),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Bt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=Tn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Tf(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=$e(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(te(s,"innerBorderBottom"),o=!a):(We(s,"innerBorderBottom"),o=a)}return o}}const pte="calculatedRows",O2={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Go(O2,"MIXIN_NAME",pte,{writable:!1,enumerable:!1});const A2=O2;class R1 extends dh{constructor(e,n,r,i){super(e,n,r,i,tu)}}St(R1,A2);St(R1,v1);const wte=R1,vte="localHooks",I2={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)_w(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Go(I2,"MIXIN_NAME",vte,{writable:!1,enumerable:!1});const Ur=I2;let H2=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};St(H2,Ur);const Cte=H2,D2="active-header",E1="header",T1="area",_1="focus",yte="fill",Ste="row",bte="column",Rte="custom-selection",M1=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var Ete=m2;Ete("flat");function Tte(t,e){N2(t,e),e.add(t)}function nA(t,e,n){N2(t,e),e.set(t,n)}function N2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nS(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function an(t,e){var n=k2(t,e,"get");return _te(t,n)}function _te(t,e){return e.get?e.get.call(t):e.value}function rA(t,e,n){var r=k2(t,e,"set");return Mte(t,r,n),n}function k2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Mte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Di=new WeakMap,Pr=new WeakMap,em=new WeakSet;class xte{constructor(){Tte(this,em),nA(this,Di,{writable:!0,value:void 0}),nA(this,Pr,{writable:!0,value:void 0})}setActiveOverlay(e){return rA(this,Pr,e),this}setActiveSelection(e){return rA(this,Di,e),this}scan(){const e=an(this,Di).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=an(this,Di).getCorners(),{wtTable:s}=an(this,Pr),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let f=-l;f<0;f++){if(f<n||f>i)continue;const g=f+l;let p=s.getColumnHeader(h,g);const y=an(this,Pr).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:an(this,Di).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});y!==null&&(y!==h&&(p=s.getColumnHeader(y,g)),e(p))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=an(this,Di).getCorners(),{wtTable:s}=an(this,Pr),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let f=-l;f<0;f++){if(f<r||f>o)continue;const g=f+l;let p=s.getRowHeader(h,g);const y=an(this,Pr).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:an(this,Di).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});y!==null&&(y!==h&&(p=s.getRowHeader(y,g)),e(p))}u+=1}}}scanCellsRange(e){const[n,r,i,o]=an(this,Di).getCorners(),{wtTable:s}=an(this,Pr);nS(this,em,rS).call(this,(a,l)=>{if(a>=n&&a<=i&&l>=r&&l<=o){const u=s.getCell(an(this,Pr).createCellCoords(a,l)),c=an(this,Pr).getSetting("onAfterDrawSelection",a,l,an(this,Di).settings.layerLevel);typeof c=="string"&&te(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,r]=an(this,Di).getCorners(),{wtTable:i}=an(this,Pr);nS(this,em,rS).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(an(this,Pr).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=an(this,Di).getCorners(),{wtTable:i}=an(this,Pr);nS(this,em,rS).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(an(this,Pr).createCellCoords(o,s));e(a)}})}}function rS(t){const{wtTable:e}=an(this,Pr),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class Pte{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=M1,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Pi(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Rs()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Ke(i,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Ke(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:f}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),p=parseInt(u.width,10),y=parseInt(c.width,10),E=this.wot.wtTable.getWidth(),v=this.wot.wtTable.getHeight();u.top=`${parseInt(r-p-1,10)}px`,u[l]=`${parseInt(i-p-1,10)}px`,c.top=`${parseInt(r-y/4*3,10)}px`,c[l]=`${parseInt(i-y/4*3,10)}px`;const C=Math.min(parseInt(i+o,10),E-p-g*2),S=Math.min(parseInt(i+o-y/4,10),E-y-g*2);h[l]=`${C}px`,f[l]=`${S}px`;const T=Math.min(parseInt(r+s,10),v-p-g*2),_=Math.min(parseInt(r+s-y/4,10),v-y-g*2);h.top=`${T}px`,f.top=`${_}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",f.display="none"):(h.display="block",f.display="block")):(u.display="none",h.display="none",c.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:r,rootWindow:i}=this.wot;let o,s,a,l,u,c;const h=n.getRenderedRowsCount();for(let R=0;R<h;R+=1){const d=n.rowFilter.renderedToSource(R);if(d>=e[0]&&d<=e[2]){o=d,u=e[0];break}}for(let R=h-1;R>=0;R-=1){const d=n.rowFilter.renderedToSource(R);if(d>=e[0]&&d<=e[2]){s=d;break}}const f=n.getRenderedColumnsCount();for(let R=0;R<f;R+=1){const d=n.columnFilter.renderedToSource(R);if(d>=e[1]&&d<=e[3]){a=d,c=e[1];break}}for(let R=f-1;R>=0;R-=1){const d=n.columnFilter.renderedToSource(R);if(d>=e[1]&&d<=e[3]){l=d;break}}if(o===void 0||a===void 0){this.disappear();return}let g=n.getCell(this.wot.createCellCoords(o,a));const p=o!==s||a!==l,y=p?n.getCell(this.wot.createCellCoords(s,l)):g,E=cn(g),v=p?cn(y):E,C=cn(n.TABLE),S=wt(n.TABLE),T=E.top,_=E.left,A=this.wot.wtSettings.getSetting("rtlMode");let D=0,U=0;if(A){const R=wt(g),d=i.innerWidth-C.left-S;U=_+R-v.left,D=i.innerWidth-_-R-d-1}else U=v.left+wt(y)-_,D=_-C.left-1;if(this.isEntireColumnSelected(o,s)){const R=this.getDimensionsFromHeader("columns",a,l,u,C);let d=null;R&&([d,D,U]=R),d&&(g=d)}let z=T-C.top-1,G=v.top+Bt(y)-T;if(this.isEntireRowSelected(a,l)){const R=this.getDimensionsFromHeader("rows",o,s,c,C);let d=null;R&&([d,z,G]=R),d&&(g=d)}const Z=ks(g,i);parseInt(Z.borderTopWidth,10)>0&&(z+=1,G=G>0?G-1:0),parseInt(Z[A?"borderRightWidth":"borderLeftWidth"],10)>0&&(D+=1,U=U>0?U-1:0);const re=A?"right":"left";this.topStyle.top=`${z}px`,this.topStyle[re]=`${D}px`,this.topStyle.width=`${U}px`,this.topStyle.display="block",this.startStyle.top=`${z}px`,this.startStyle[re]=`${D}px`,this.startStyle.height=`${G}px`,this.startStyle.display="block";const ne=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${z+G-ne}px`,this.bottomStyle[re]=`${D}px`,this.bottomStyle.width=`${U}px`,this.bottomStyle.display="block",this.endStyle.top=`${z}px`,this.endStyle[re]=`${D+U-ne}px`,this.endStyle.height=`${G+1}px`,this.endStyle.display="block";let he=this.settings.border.cornerVisible;he=typeof he=="function"?he(this.settings.layerLevel):he;const Me=this.wot.getSetting("onModifyGetCellCoords",s,l);let[Ve,ke]=[s,l];if(Me&&Array.isArray(Me)&&([,,Ve,ke]=Me),Rs()||!he||this.isPartRange(Ve,ke))this.cornerStyle.display="none";else{this.cornerStyle.top=`${z+G+this.cornerCenterPointOffset-1}px`,this.cornerStyle[re]=`${D+U+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let R=Jl(n.TABLE);const d=R===i;d&&(R=r.documentElement);const m=parseInt(this.cornerDefaultStyle.width,10)/2,w=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const x=d?y.getBoundingClientRect().left:y.offsetLeft;let O=!1,H=0;A?(H=x-parseInt(this.cornerDefaultStyle.width,10)/2,O=H<0):(H=x+wt(y)+parseInt(this.cornerDefaultStyle.width,10)/2,O=H>=Fd(R)),O&&(this.cornerStyle[re]=`${Math.floor(D+U+this.cornerCenterPointOffset-m)}px`,this.cornerStyle[A?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(d?y.getBoundingClientRect().top:y.offsetTop)+Bt(y)+parseInt(this.cornerDefaultStyle.height,10)/2>=bs(R)&&(this.cornerStyle.top=`${Math.floor(z+G+this.cornerCenterPointOffset-w)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Rs()&&this.updateMultipleSelectionHandlesPosition(s,l,z,D,U,G)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,f=null,g=null,p=null,y=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return Bt(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return wt(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const E=this.wot.getSetting("columnHeaders").length;if(p=l(n,E-i),y=l(r,E-i),!p||!y)return!1;const v=cn(p),C=cn(y);return p&&y&&(h=v[g]-o[g]-1,f=C[g]+u(y)-v[g]),[p,h,f]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?te(this[e],"hidden"):($e(this[e],"hidden")&&We(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?te(this[e],"hidden"):We(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Rs()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const iA=Pte;function Ote(t,e){L2(t,e),e.add(t)}function Mu(t,e,n){L2(t,e),e.set(t,n)}function L2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ate(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function et(t,e){var n=$2(t,e,"get");return Ite(t,n)}function Ite(t,e){return e.get?e.get.call(t):e.value}function oA(t,e,n){var r=$2(t,e,"set");return Hte(t,r,n),n}function $2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Hte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var qn=new WeakMap,Dr=new WeakMap,iS=new WeakMap,yd=new WeakMap,oS=new WeakMap,ol=new WeakMap,sA=new WeakSet;class Dte{constructor(e){Ote(this,sA),Mu(this,qn,{writable:!0,value:void 0}),Mu(this,Dr,{writable:!0,value:void 0}),Mu(this,iS,{writable:!0,value:new xte}),Mu(this,yd,{writable:!0,value:new WeakMap}),Mu(this,oS,{writable:!0,value:new WeakSet}),Mu(this,ol,{writable:!0,value:new Map}),oA(this,Dr,e)}setActiveOverlay(e){return oA(this,qn,e),et(this,iS).setActiveOverlay(et(this,qn)),et(this,yd).has(et(this,qn))||et(this,yd).set(et(this,qn),new Set),this}getFocusSelection(){return et(this,Dr)!==null?et(this,Dr).getFocus():null}getAreaSelection(){return et(this,Dr)!==null?et(this,Dr).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(et(this,ol).has(e)){const r=et(this,ol).get(e);if(r.has(et(this,qn)))return r.get(et(this,qn));const i=new iA(et(this,qn),e.settings);return r.set(et(this,qn),i),i}const n=new iA(et(this,qn),e.settings);return et(this,ol).set(e,new Map([[et(this,qn),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=et(this,ol).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){et(this,ol).get(e).forEach(n=>n.destroy()),et(this,ol).delete(e)}render(e){if(et(this,Dr)===null)return;e&&Ate(this,sA,Nte).call(this);const n=Array.from(et(this,Dr)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;et(this,oS).has(s)||(et(this,oS).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&et(this,iS).setActiveSelection(s).scan().forEach(p=>{if(r.has(p)){const y=r.get(p);y.has(a)&&u===!0?y.set(a,y.get(a)+1):y.set(a,1)}else r.set(p,new Map([[a,1]]));l&&(i.has(p)||i.set(p,[]),p.nodeName==="TH"&&i.get(p).push(...l))});const f=s.getCorners();et(this,qn).getSetting("onBeforeDrawBorders",f,c),h==null||h.appear(f)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(f,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>et(this,yd).get(et(this,qn)).add(u)),te(s,l),s.nodeName==="TD"&&Array.isArray((a=et(this,Dr).options)===null||a===void 0?void 0:a.cellAttributes)&&Ae(s,et(this,Dr).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Ae(o,[...i.get(o)])})}}function Nte(){const t=et(this,yd).get(et(this,qn)),e=et(this,qn).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=et(this,qn).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=et(this,Dr).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=et(this,Dr).options.cellAttributes.map(a=>a[0])),Array.isArray((i=et(this,Dr).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...et(this,Dr).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)We(o[a],n),du(o[a],s)}),t.clear()}class kte extends ag{constructor(e,n,r,i){super(e,n,tu,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new wte(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Kv(r,`${o}px`,"0px")):(o=this.getScrollPosition(),ng(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,XT(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=Tn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=wt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(M1.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;if(n){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(n=!1)}return n&&o.offsetWidth!==o.clientWidth&&(s=Tn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(Ew(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?We(n,"emptyRows"):te(n,"emptyRows");let s=!1;if(i&&!r.length)te(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const a=$e(n,"innerBorderInlineStart");e?(te(n,"innerBorderLeft innerBorderInlineStart"),s=!a):(We(n,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}}const Lte="stickyRowsTop",F2={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Go(F2,"MIXIN_NAME",Lte,{writable:!1,enumerable:!1});const W2=F2;class x1 extends dh{constructor(e,n,r,i){super(e,n,r,i,nu)}}St(x1,W2);St(x1,v1);const $te=x1;function aA(t,e,n){return e=Fte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fte(t){var e=Wte(t,"string");return typeof e=="symbol"?e:String(e)}function Wte(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vte extends ag{constructor(e,n,r,i,o,s){super(e,n,nu,r,i),aA(this,"topOverlay",void 0),aA(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new $te(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Kv(e,`${i}px`,`${o}px`)}else ng(e);let n=Bt(this.clone.wtTable.TABLE);const r=wt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class P1 extends dh{constructor(e,n,r,i){super(e,n,r,i,eu)}}St(P1,W2);St(P1,S1);const Bte=P1;function Ute(t,e,n){return e=zte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zte(t){var e=Gte(t,"string");return typeof e=="symbol"?e:String(e)}function Gte(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jte extends ag{constructor(e,n,r,i){super(e,n,eu,r,i),Ute(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Bte(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Kv(e,"0px",`${i}px`)}else i=this.getScrollPosition(),ng(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(Yv(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=Tn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Bt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(M1.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(n){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(l=Tn(this.domBindings.rootDocument)),n){const u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Tf(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?We(r,"emptyColumns"):te(r,"emptyColumns");let o=!1;if(!n){const s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,l=this.wtSettings.getSetting("columnHeaders");if((a||s===0)&&l.length>0){const u=$e(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(te(r,"innerBorderTop"),o=!u):(We(r,"innerBorderTop"),o=u)}}return o}}function Qo(t,e,n){return e=Yte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yte(t){var e=Kte(t,"string");return typeof e=="symbol"?e:String(e)}function Kte(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xte{constructor(e,n,r,i,o,s){Qo(this,"wot",null),Qo(this,"topOverlay",null),Qo(this,"bottomOverlay",null),Qo(this,"inlineStartOverlay",null),Qo(this,"topInlineStartCornerOverlay",null),Qo(this,"bottomInlineStartCornerOverlay",null),Qo(this,"browserLineHeight",void 0),Qo(this,"wtSettings",null),Qo(this,"resizeObserver",new ResizeObserver(c=>{nC(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Tn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:_f(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new jte(...e),this.bottomOverlay=new mte(...e),this.inlineStartOverlay=new kte(...e),this.topInlineStartCornerOverlay=new Vte(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new ute(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!t1())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:f}=h.clone.wtTable;this.eventManager.addEventListener(f,"wheel",g=>this.onCloneWheel(g,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=hh(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=_f(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:n}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),a=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,o)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:h,scrollWidth:f}=r.holder;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<f,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return P(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];P(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}const qte=Xte;function lA(t,e,n){return e=Qte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qte(t){var e=Zte(t,"string");return typeof e=="symbol"?e:String(e)}function Zte(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jte{constructor(e){lA(this,"settings",{}),lA(this,"defaults",Object.freeze(this.getDefaults())),Ke(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);za(r,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Ke(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class O1 extends dh{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Jl(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=qc(e,"height",n),o=qc(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?r.insertBefore(f,e.nextElementSibling):r.appendChild(f);const g=parseInt(ks(f,n).height,10);r.removeChild(f),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Ga(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}St(O1,A2);St(O1,S1);const ene=O1;class tne{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=Bt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-o:u.left,h=o-c;let f,g;if(a)return wt(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?f=Math.min(h,o):f=Math.min(this.getContainerFillWidth(),h,o),i===r&&s>0&&this.sumColumnWidths(0,s-1)>f)return n.documentElement.clientWidth;if(i!==r&&(g=qc(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(f,i.clientWidth);const p=e.getSetting("stretchH");return p==="none"||!p?Math.max(f,wt(this.wtTable.TABLE)):f}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return cn(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Bt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=wt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Nl;const{wtSettings:n,wtTable:r}=this;let i,o,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&e===Nl?i=1/0:i=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=Tn(this.domBindings.rootDocument),new v2({viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Nl;const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=Tn(this.domBindings.rootDocument)),new f1({viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:n.getSetting("stretchH"),stretchingColumnWidthFn:(a,l)=>n.getSetting("onBeforeStretchingColumnWidth",a,l),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(n){const r=this.createRowsCalculator(Zn),i=this.createColumnsCalculator(Zn);this.areAllProposedVisibleRowsAlreadyRendered(r)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Nl),this.columnsRenderCalculator=this.createColumnsCalculator(Nl)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(Zn),this.columnsVisibleCalculator=this.createColumnsCalculator(Zn)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:n,endRow:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startRow:o,endRow:s}=this.rowsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:n,endColumn:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Ke(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}const nne=tne;class rne extends y1{constructor(e,n){super(e,new Jte(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new ene(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new nne(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Dte(this.wtSettings.getSetting("selections")),this.wtEvent=new R2(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new qte(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ke(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),We(this.wtTable.wtRootElement.parentNode,n),te(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class A1{constructor(e){e instanceof y1?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new A1(n);return()=>r},this._wot=new rne(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,i,o){return this._wot.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function uA(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),f=n||r&&h;i.row<0&&i.col>=0&&!s.column?f&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?f&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?f&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function ine(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n)}const one=new Map([["mousedown",uA],["mouseover",ine],["touchstart",uA]]);function cA(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;one.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:Jv(t)||t.type==="touchstart",isRightClick:ja(t)})}const V2=new WeakMap,I1=Symbol("rootInstance");function sne(t){V2.set(t,!0)}function ane(t){return t===I1}function _p(t){return V2.has(t)}function hA(t,e){B2(t,e),e.add(t)}function sl(t,e,n){B2(t,e),e.set(t,n)}function B2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qs(t,e,n){return e=lne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lne(t){var e=une(t,"string");return typeof e=="symbol"?e:String(e)}function une(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xR(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Pn(t,e){var n=U2(t,e,"get");return cne(t,n)}function cne(t,e){return e.get?e.get.call(t):e.value}function ci(t,e,n){var r=U2(t,e,"set");return hne(t,r,n),n}function U2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function hne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var sS=new WeakMap,tm=new WeakMap,nm=new WeakMap,Zo=new WeakMap,Ni=new WeakMap,aS=new WeakMap,lS=new WeakMap,PR=new WeakSet,dA=new WeakSet;class dne{constructor(e){hA(this,dA),hA(this,PR),Qs(this,"hot",void 0),Qs(this,"eventManager",void 0),Qs(this,"settings",void 0),Qs(this,"THEAD",void 0),Qs(this,"TBODY",void 0),Qs(this,"_wt",void 0),Qs(this,"activeWt",void 0),sl(this,sS,{writable:!0,value:0}),sl(this,tm,{writable:!0,value:0}),Qs(this,"postponedAdjustElementsSize",!1),sl(this,nm,{writable:!0,value:!1}),sl(this,Zo,{writable:!0,value:void 0}),sl(this,Ni,{writable:!0,value:void 0}),sl(this,aS,{writable:!0,value:0}),sl(this,lS,{writable:!0,value:0}),this.hot=e,this.eventManager=new ri(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,i,o){return this._wt.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),te(e,"handsontable"),ci(this,Ni,n.createElement("TABLE")),te(Pn(this,Ni),"htCore"),this.hot.getSettings().tableClassName&&te(Pn(this,Ni),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ae(Pn(this,Ni),[No()]),Ae(e,[Zq(),EV(-1),jv(this.hot.countCols()),hQ()])),this.THEAD=n.createElement("THEAD"),Pn(this,Ni).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),Pn(this,Ni).appendChild(this.TBODY),this.hot.table=Pn(this,Ni),this.hot.container.insertBefore(Pn(this,Ni),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r}=this.hot,i=n.documentElement;this.eventManager.addEventListener(e,"mousedown",o=>{if(ci(this,nm,!0),!this.isTextSelectionAllowed(o.target)){const{rootWindow:s}=this.hot;pR(s),o.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{ci(this,nm,!1)}),this.eventManager.addEventListener(e,"mousemove",o=>{Pn(this,nm)&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&pR(this.hot.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(i,"keyup",o=>{r.isInProgress()&&!o.shiftKey&&r.finish()}),this.eventManager.addEventListener(i,"mouseup",o=>{r.isInProgress()&&Jv(o)&&r.finish(),ci(this,Zo,!1);const s=Xv(n.activeElement);s&&(s||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(o.target)&&!ja(o))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",o=>{r.isInProgress()&&ja(o)&&(r.finish(),ci(this,Zo,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{r.isInProgress()&&r.finish(),ci(this,Zo,!1)}),this.eventManager.addEventListener(i,"mousedown",o=>{const s=o.target,a=o.x||o.clientX,l=o.y||o.clientY;let u=o.target;if(Pn(this,Zo)||!e||!this.hot.view)return;const{holder:c}=this.hot.view._wt.wtTable;if(u===c){const f=Tn(n);if(n.elementFromPoint(a+f,l)!==c||n.elementFromPoint(a,l+f)!==c)return}else for(;u!==i;){if(u===null){if(o.isTargetWebComponent)break;return}if(u===e)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(Pn(this,Ni),"selectstart",o=>{this.settings.fragmentSelection||Tw(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Pn(this,Ni),isDataViewInstance:()=>_p(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),ci(this,tm,o.length),this.hot.getSettings().ariaTags&&xR(this,PR,z2).call(this)===this.hot.countCols()&&xR(this,dA,fne).call(this,Pn(this,tm)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),ci(this,sS,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let h=l,f=u;Array.isArray(c)&&([h,f]=c);const g=this.hot.getCellMeta(h,f),p=this.hot.colToProp(f);let y=this.hot.getDataAtRowProp(h,p);this.hot.hasHook("beforeValueRender")&&(y=this.hot.runHooks("beforeValueRender",y,g)),this.hot.runHooks("beforeRenderer",a,l,u,p,y,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,p,y,g),this.hot.runHooks("afterRenderer",a,l,u,p,y,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Ga(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,ci(this,Zo,!0),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!pa(o)&&(cA(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,ci(this,Zo,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!pa(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!pa(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!pa(o)&&(Pn(this,Zo)&&cA(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(pa(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,h=o>=0?l.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",h,c,a);if(Array.isArray(f)){const[g,p,y,E]=f;return[g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g,p>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(p,1)):p,y>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(y,-1)):y,E>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(E,-1)):E]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.ceil(u/a*12);o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.ceil(u/a*6);o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new A1(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(Tw(e))return!0;const n=ka(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Pn(this,Zo)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!$e(r,"relative")){so(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){const o=n.firstChild;$e(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,i):(so(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span");s.className="relative",a.className="colHeader",this.settings.ariaTags&&(Ae(s,...No()),Ae(a,...No())),this.updateCellHeader(a,e,r,i),s.appendChild(a),n.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&($e(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):$e(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?fu(e,r(n,i)):(za(e,String.fromCharCode(160)),te(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){ci(this,aS,e),ci(this,lS,n)}getLastSize(){return{width:Pn(this,aS),height:Pn(this,lS)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return Pn(this,sS)}getRowHeadersCount(){return Pn(this,tm)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function z2(){return parseInt(this.hot.rootElement.getAttribute(jv()[0]),10)}function fne(t){const e=xR(this,PR,z2).call(this)+t;Ae(this.hot.rootElement,...jv(e))}const gne=dne,G2="ABCDEFGHIJKLMNOPQRSTUVWXYZ",OR=G2.length;function rC(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%OR,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/OR,10);return n}function mne(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=OR**r*(G2.indexOf(t[n])+1);return e-=1,e}function pne(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(rC(i)+(r+1));n.push(o)}return n}function wne(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=rC(i)+(r+1);n.push(o)}return n}function vne(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function H1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function D1(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&je(t[0])&&(e=Zv(t[0]))),e}function j2(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function Y2(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const Cne=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:D1,createEmptySpreadsheetData:vne,createSpreadsheetData:pne,createSpreadsheetObjectData:wne,dataRowToChangesArray:H1,isArrayOfArrays:j2,isArrayOfObjects:Y2,spreadsheetColumnIndex:mne,spreadsheetColumnLabel:rC},Symbol.toStringTag,{value:"Module"}));function kh(t,e,n){return e=yne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yne(t){var e=Sne(t,"string");return typeof e=="symbol"?e:String(e)}function Sne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bne{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];kh(this,"hot",void 0),kh(this,"data",void 0),kh(this,"dataType","array"),kh(this,"colToProp",()=>{}),kh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return P(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0;let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,s)}):Re(n,r,l=>{a[l-n]=this.getAtPhysicalCell(e,l,s)});else if(je(s)||Et(s))if(i?a=[]:a={},!o||i){const u=this.countFirstRowKeys()-1;Re(0,u,c=>{const h=this.colToProp(c);if(c>=(n||0)&&c<=(r||u)&&!Number.isInteger(h)){const f=this.getAtPhysicalCell(e,h,s);i?a.push(f):bp(a,h,f)}})}else Ke(s,(l,u)=>{bp(a,u,this.getAtPhysicalCell(e,u,s))});return a}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Qi(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:bp(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r&&(typeof n=="string"?i=zV(r,n):typeof n=="function"?i=n(r):i=r[n]),this.hot.hasHook("modifySourceData")){const o=Qi(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return Re(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return D1(this.data)}destroy(){this.data=null,this.hot=null}}const Rne=bne;function fA(t,e,n){return e=Ene(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ene(t){var e=Tne(t,"string");return typeof e=="symbol"?e:String(e)}function Tne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;fA(this,"indexedValues",[]),fA(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Et(this.initValueOrFn)?Re(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):Re(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}St(gu,Ur);function N1(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>Et(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function k1(t,e){return ni(t,(n,r)=>e.includes(r)===!1)}class Ja extends gu{insert(e,n){this.indexedValues=N1(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=k1(this.indexedValues,e),super.remove(e)}}class iC extends Ja{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return sn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function L1(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Pf(t,e){return ni(t,n=>e.includes(n)===!1)}function $1(t,e){return Ye(t,n=>n-e.filter(r=>r<n).length)}function F1(t,e){const n=e[0],r=e.length;return Ye(t,i=>i>=n?i+r:i)}function _ne(t,e,n){return e=Mne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mne(t){var e=xne(t,"string");return typeof e=="symbol"?e:String(e)}function xne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oC extends gu{constructor(){super(...arguments),_ne(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Pf(this.orderOfIndexes,[e]),Et(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=N1(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=F1(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=k1(this.indexedValues,e),this.orderOfIndexes=Pf(this.orderOfIndexes,e),this.orderOfIndexes=$1(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class lg extends Ja{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return sn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const gA=new Map([["indexesSequence",{getListWithInsertedItems:L1,getListWithRemovedItems:Pf}],["physicallyIndexed",{getListWithInsertedItems:N1,getListWithRemovedItems:k1}]]),K2=t=>{if(gA.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return gA.get(t)};class X2 extends gu{constructor(){super(e=>e)}insert(e,n){const r=F1(this.indexedValues,n);this.indexedValues=L1(r,e,n),super.insert(e,n)}remove(e){const n=Pf(this.indexedValues,e);this.indexedValues=$1(n,e),super.remove(e)}}const mA=new Map([["hiding",iC],["index",gu],["linkedPhysicalIndexToValue",oC],["physicalIndexToValue",Ja],["trimming",lg]]);function Pne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!mA.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(mA.get(t))(e)}function One(t,e,n){return e=Ane(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ane(t){var e=Ine(t,"string");return typeof e=="symbol"?e:String(e)}function Ine(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let AR=0;class W1{constructor(){One(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),AR+=1)}unregister(e){const n=this.collection.get(e);fe(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),AR-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Tt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}St(W1,Ur);function Hne(){return AR}function uS(t,e,n){return e=Dne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dne(t){var e=Nne(t,"string");return typeof e=="symbol"?e:String(e)}function Nne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pA extends W1{constructor(e,n){super(),uS(this,"mergedValuesCache",[]),uS(this,"aggregationFunction",void 0),uS(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ye(this.get(),o=>o.getValues()),r=[],i=fe(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ye(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return fe(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function kne(t,e,n){Lne(t,e),e.set(t,n)}function Lne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $ne(t,e,n){var r=q2(t,e,"set");return Fne(t,r,n),n}function Fne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Wne(t,e){var n=q2(t,e,"get");return Vne(t,n)}function q2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Vne(t,e){return e.get?e.get.call(t):e.value}var cS=new WeakMap;class Q2{constructor(){kne(this,cS,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(Wne(this,cS)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){$ne(this,cS,e)}}St(Q2,Ur);function wA(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function Lh(t,e,n){Bne(t,e),e.set(t,n)}function Bne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hi(t,e){var n=Z2(t,e,"get");return Une(t,n)}function Une(t,e){return e.get?e.get.call(t):e.value}function rm(t,e,n){var r=Z2(t,e,"set");return zne(t,r,n),n}function Z2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function zne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var im=new WeakMap,$h=new WeakMap,om=new WeakMap,sm=new WeakMap,am=new WeakMap;class Gne{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Lh(this,im,{writable:!0,value:new Set}),Lh(this,$h,{writable:!0,value:[]}),Lh(this,om,{writable:!0,value:[]}),Lh(this,sm,{writable:!0,value:!1}),Lh(this,am,{writable:!0,value:!1}),rm(this,am,e??!1)}createObserver(){const e=new Q2;return hi(this,im).add(e),e.addLocalHook("unsubscribe",()=>{hi(this,im).delete(e)}),e._writeInitialChanges(wA(hi(this,$h),hi(this,om))),e}emit(e){let n=hi(this,om);(!hi(this,sm)||hi(this,$h).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(hi(this,am)):rm(this,$h,new Array(e.length).fill(hi(this,am))),hi(this,sm)||(rm(this,sm,!0),n=hi(this,$h)));const r=wA(n,e);hi(this,im).forEach(i=>i._write(r)),rm(this,om,e)}}function ur(t,e,n){return e=jne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jne(t){var e=Yne(t,"string");return typeof e=="symbol"?e:String(e)}function Yne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IR{constructor(){ur(this,"indexesSequence",new X2),ur(this,"trimmingMapsCollection",new pA(e=>e.some(n=>n===!0),!1)),ur(this,"hidingMapsCollection",new pA(e=>e.some(n=>n===!0),!1)),ur(this,"variousMapsCollection",new W1),ur(this,"hidingChangesObservable",new Gne({initialIndexValue:!1})),ur(this,"notTrimmedIndexesCache",[]),ur(this,"notHiddenIndexesCache",[]),ur(this,"isBatched",!1),ur(this,"indexesSequenceChanged",!1),ur(this,"indexesChangeSource",void 0),ur(this,"trimmedIndexesChanged",!1),ur(this,"hiddenIndexesChanged",!1),ur(this,"renderablePhysicalIndexesCache",[]),ur(this,"fromPhysicalToVisualIndexesCache",new Map),ur(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,Pne(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof lg?this.trimmingMapsCollection.register(e,n):n instanceof iC?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return fe(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return fe(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return fe(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return fe(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ye(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Pf(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(L1(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=fe(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ye(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}St(IR,Ur);function Kne(t,e){return Ke(e,(n,r)=>{Tt(t[r])&&(t[r]=n)}),t}function J2(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function eB(t){fe(t)&&s1(vt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Xne(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:qne,getValues:Qne}=lo("phraseFormatters");function Zne(t,e){qne(t,e)}function Jne(){return Qne()}Zne("pluralize",Xne);const tB="ContextMenu:items",ze=tB,V1=`${ze}.noItems`,B1=`${ze}.insertRowAbove`,U1=`${ze}.insertRowBelow`,z1=`${ze}.insertColumnOnTheLeft`,G1=`${ze}.insertColumnOnTheRight`,j1=`${ze}.removeRow`,Y1=`${ze}.removeColumn`,K1=`${ze}.undo`,X1=`${ze}.redo`,q1=`${ze}.readOnly`,Q1=`${ze}.clearColumn`,Z1=`${ze}.copy`,J1=`${ze}.copyWithHeaders`,e_=`${ze}.copyWithGroupHeaders`,t_=`${ze}.copyHeadersOnly`,n_=`${ze}.cut`,r_=`${ze}.freezeColumn`,i_=`${ze}.unfreezeColumn`,o_=`${ze}.mergeCells`,s_=`${ze}.unmergeCells`,a_=`${ze}.addComment`,l_=`${ze}.editComment`,u_=`${ze}.removeComment`,c_=`${ze}.readOnlyComment`,h_=`${ze}.align`,d_=`${ze}.align.left`,f_=`${ze}.align.center`,g_=`${ze}.align.right`,m_=`${ze}.align.justify`,p_=`${ze}.align.top`,w_=`${ze}.align.middle`,v_=`${ze}.align.bottom`,C_=`${ze}.borders`,y_=`${ze}.borders.top`,S_=`${ze}.borders.right`,b_=`${ze}.borders.bottom`,R_=`${ze}.borders.left`,E_=`${ze}.borders.remove`,T_=`${ze}.nestedHeaders.insertChildRow`,__=`${ze}.nestedHeaders.detachFromParent`,M_=`${ze}.hideColumn`,x_=`${ze}.showColumn`,P_=`${ze}.hideRow`,O_=`${ze}.showRow`,Tr="Filters:",en=`${Tr}conditions`,sC=`${en}.none`,A_=`${en}.isEmpty`,I_=`${en}.isNotEmpty`,H_=`${en}.isEqualTo`,D_=`${en}.isNotEqualTo`,N_=`${en}.beginsWith`,k_=`${en}.endsWith`,L_=`${en}.contains`,$_=`${en}.doesNotContain`,ere=`${en}.byValue`,F_=`${en}.greaterThan`,W_=`${en}.greaterThanOrEqualTo`,V_=`${en}.lessThan`,B_=`${en}.lessThanOrEqualTo`,U_=`${en}.isBetween`,z_=`${en}.isNotBetween`,G_=`${en}.after`,j_=`${en}.before`,Y_=`${en}.today`,K_=`${en}.tomorrow`,X_=`${en}.yesterday`,q_=`${Tr}labels.filterByCondition`,Q_=`${Tr}labels.filterByValue`,Z_=`${Tr}labels.conjunction`,aC=`${Tr}labels.disjunction`,Nw=`${Tr}values.blankCells`,J_=`${Tr}buttons.selectAll`,eM=`${Tr}buttons.clear`,tM=`${Tr}buttons.ok`,nM=`${Tr}buttons.cancel`,rM=`${Tr}buttons.placeholder.search`,iM=`${Tr}buttons.placeholder.value`,oM=`${Tr}buttons.placeholder.secondValue`,sM="CheckboxRenderer:",aM=`${sM}checked`,lM=`${sM}unchecked`,tre=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:aM,CHECKBOX_RENDERER_NAMESPACE:sM,CHECKBOX_UNCHECKED:lM,CONTEXTMENU_ITEMS_ADD_COMMENT:a_,CONTEXTMENU_ITEMS_ALIGNMENT:h_,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:v_,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:f_,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:m_,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:d_,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:w_,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:g_,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:p_,CONTEXTMENU_ITEMS_BORDERS:C_,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:b_,CONTEXTMENU_ITEMS_BORDERS_LEFT:R_,CONTEXTMENU_ITEMS_BORDERS_RIGHT:S_,CONTEXTMENU_ITEMS_BORDERS_TOP:y_,CONTEXTMENU_ITEMS_CLEAR_COLUMN:Q1,CONTEXTMENU_ITEMS_COPY:Z1,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:t_,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:e_,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:J1,CONTEXTMENU_ITEMS_CUT:n_,CONTEXTMENU_ITEMS_EDIT_COMMENT:l_,CONTEXTMENU_ITEMS_FREEZE_COLUMN:r_,CONTEXTMENU_ITEMS_HIDE_COLUMN:M_,CONTEXTMENU_ITEMS_HIDE_ROW:P_,CONTEXTMENU_ITEMS_INSERT_LEFT:z1,CONTEXTMENU_ITEMS_INSERT_RIGHT:G1,CONTEXTMENU_ITEMS_MERGE_CELLS:o_,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:__,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:T_,CONTEXTMENU_ITEMS_NO_ITEMS:V1,CONTEXTMENU_ITEMS_READ_ONLY:q1,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:c_,CONTEXTMENU_ITEMS_REDO:X1,CONTEXTMENU_ITEMS_REMOVE_BORDERS:E_,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Y1,CONTEXTMENU_ITEMS_REMOVE_COMMENT:u_,CONTEXTMENU_ITEMS_REMOVE_ROW:j1,CONTEXTMENU_ITEMS_ROW_ABOVE:B1,CONTEXTMENU_ITEMS_ROW_BELOW:U1,CONTEXTMENU_ITEMS_SHOW_COLUMN:x_,CONTEXTMENU_ITEMS_SHOW_ROW:O_,CONTEXTMENU_ITEMS_UNDO:K1,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:i_,CONTEXTMENU_ITEMS_UNMERGE_CELLS:s_,CONTEXT_MENU_ITEMS_NAMESPACE:tB,FILTERS_BUTTONS_CANCEL:nM,FILTERS_BUTTONS_CLEAR:eM,FILTERS_BUTTONS_OK:tM,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:rM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:oM,FILTERS_BUTTONS_PLACEHOLDER_VALUE:iM,FILTERS_BUTTONS_SELECT_ALL:J_,FILTERS_CONDITIONS_AFTER:G_,FILTERS_CONDITIONS_BEFORE:j_,FILTERS_CONDITIONS_BEGINS_WITH:N_,FILTERS_CONDITIONS_BETWEEN:U_,FILTERS_CONDITIONS_BY_VALUE:ere,FILTERS_CONDITIONS_CONTAINS:L_,FILTERS_CONDITIONS_EMPTY:A_,FILTERS_CONDITIONS_ENDS_WITH:k_,FILTERS_CONDITIONS_EQUAL:H_,FILTERS_CONDITIONS_GREATER_THAN:F_,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:W_,FILTERS_CONDITIONS_LESS_THAN:V_,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:B_,FILTERS_CONDITIONS_NAMESPACE:en,FILTERS_CONDITIONS_NONE:sC,FILTERS_CONDITIONS_NOT_BETWEEN:z_,FILTERS_CONDITIONS_NOT_CONTAIN:$_,FILTERS_CONDITIONS_NOT_EMPTY:I_,FILTERS_CONDITIONS_NOT_EQUAL:D_,FILTERS_CONDITIONS_TODAY:Y_,FILTERS_CONDITIONS_TOMORROW:K_,FILTERS_CONDITIONS_YESTERDAY:X_,FILTERS_DIVS_FILTER_BY_CONDITION:q_,FILTERS_DIVS_FILTER_BY_VALUE:Q_,FILTERS_LABELS_CONJUNCTION:Z_,FILTERS_LABELS_DISJUNCTION:aC,FILTERS_NAMESPACE:Tr,FILTERS_VALUES_BLANK_CELLS:Nw},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const nre={languageCode:"en-US",[V1]:"No available options",[B1]:"Insert row above",[U1]:"Insert row below",[z1]:"Insert column left",[G1]:"Insert column right",[j1]:["Remove row","Remove rows"],[Y1]:["Remove column","Remove columns"],[K1]:"Undo",[X1]:"Redo",[q1]:"Read only",[Q1]:"Clear column",[h_]:"Alignment",[d_]:"Left",[f_]:"Center",[g_]:"Right",[m_]:"Justify",[p_]:"Top",[w_]:"Middle",[v_]:"Bottom",[r_]:"Freeze column",[i_]:"Unfreeze column",[C_]:"Borders",[y_]:"Top",[S_]:"Right",[b_]:"Bottom",[R_]:"Left",[E_]:"Remove border(s)",[a_]:"Add comment",[l_]:"Edit comment",[u_]:"Delete comment",[c_]:"Read-only comment",[o_]:"Merge cells",[s_]:"Unmerge cells",[Z1]:"Copy",[J1]:["Copy with header","Copy with headers"],[e_]:["Copy with group header","Copy with group headers"],[t_]:["Copy header only","Copy headers only"],[n_]:"Cut",[T_]:"Insert child row",[__]:"Detach from parent",[M_]:["Hide column","Hide columns"],[x_]:["Show column","Show columns"],[P_]:["Hide row","Hide rows"],[O_]:["Show row","Show rows"],[sC]:"None",[A_]:"Is empty",[I_]:"Is not empty",[H_]:"Is equal to",[D_]:"Is not equal to",[N_]:"Begins with",[k_]:"Ends with",[L_]:"Contains",[$_]:"Does not contain",[F_]:"Greater than",[W_]:"Greater than or equal to",[V_]:"Less than",[B_]:"Less than or equal to",[U_]:"Is between",[z_]:"Is not between",[G_]:"After",[j_]:"Before",[Y_]:"Today",[K_]:"Tomorrow",[X_]:"Yesterday",[Nw]:"Blank cells",[q_]:"Filter by condition",[Q_]:"Filter by value",[Z_]:"And",[aC]:"Or",[J_]:"Select all",[eM]:"Clear",[tM]:"OK",[nM]:"Cancel",[rM]:"Search",[iM]:"Value",[oM]:"Second value",[aM]:"Checked",[lM]:"Unchecked"},nB=nre,rre=tre,HR=nB.languageCode,{register:ire,getItem:rB,hasItem:ore,getValues:sre}=lo("languagesDictionaries");iB(nB);function iB(t,e){let n=t,r=e;return je(t)&&(r=t,n=r.languageCode),are(n,r),ire(n,rr(r)),rr(r)}function are(t,e){t!==HR&&Kne(e,rB(HR))}function oB(t){return uM(t)?rr(rB(t)):null}function uM(t){return ore(t)}function lre(){return sre()}function sB(t,e,n){const r=oB(t);if(r===null)return null;const i=r[e];if(Tt(i))return null;const o=ure(i,n);return Array.isArray(o)?o[0]:o}function ure(t,e){let n=t;return P(Jne(),r=>{n=r(t,e)}),n}function cre(t){let e=J2(t);return uM(e)||(e=HR,eB(t)),e}function hre(t,e,n){return e=dre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dre(t){var e=fre(t,"string");return typeof e=="symbol"?e:String(e)}function fre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gre extends Cte{constructor(e,n){super(e,null),hre(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}const js=gre;function hS(t){let{activeHeaderClassName:e,...n}=t;return new js({className:e,...n,selectionType:D2})}function mre(t){let{areaCornerVisible:e,...n}=t;return new js({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:T1})}function pre(t){let{...e}=t;return new js({className:"highlight",...e,selectionType:T1})}function wre(t){let{columnClassName:e,...n}=t;return new js({className:e,...n,selectionType:bte})}function vre(t){let{cellCornerVisible:e,...n}=t;return new js({className:"current",headerAttributes:[YT()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:_1})}function Cre(t){let{border:e,visualCellRange:n,...r}=t;return new js({...e,...r,selectionType:Rte},n)}function yre(t){let{...e}=t;return new js({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:yte})}function vA(t){let{headerClassName:e,...n}=t;return new js({className:e,...n,selectionType:E1})}function Sre(t){let{rowClassName:e,...n}=t;return new js({className:e,...n,selectionType:Ste})}let aB;function bre(t,e){Rre(t,e),e.add(t)}function Rre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mr(t,e,n){return e=Ere(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ere(t){var e=Tre(t,"string");return typeof e=="symbol"?e:String(e)}function Tre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jo(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var po=new WeakSet;aB=Symbol.iterator;class _re{constructor(e){bre(this,po),Mr(this,"options",void 0),Mr(this,"layerLevel",0),Mr(this,"focus",void 0),Mr(this,"fill",void 0),Mr(this,"layeredAreas",new Map),Mr(this,"areas",new Map),Mr(this,"rowHeaders",new Map),Mr(this,"columnHeaders",new Map),Mr(this,"activeRowHeaders",new Map),Mr(this,"activeColumnHeaders",new Map),Mr(this,"activeCornerHeaders",new Map),Mr(this,"rowHighlights",new Map),Mr(this,"columnHighlights",new Map),Mr(this,"customSelections",[]),this.options=e,this.focus=vre(e),this.fill=yre(e)}isEnabledFor(e,n){let r=e;e===_1&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Jo(this,po,es).call(this,this.layeredAreas,mre)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Jo(this,po,es).call(this,this.areas,pre)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Jo(this,po,es).call(this,this.rowHeaders,vA)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Jo(this,po,es).call(this,this.columnHeaders,vA)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Jo(this,po,es).call(this,this.activeRowHeaders,hS)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Jo(this,po,es).call(this,this.activeColumnHeaders,hS)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Jo(this,po,es).call(this,this.activeCornerHeaders,hS)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Jo(this,po,es).call(this,this.rowHighlights,Sre)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Jo(this,po,es).call(this,this.columnHighlights,wre)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(Cre({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),P(this.areas.values(),e=>void e.clear()),P(this.layeredAreas.values(),e=>void e.clear()),P(this.rowHeaders.values(),e=>void e.clear()),P(this.columnHeaders.values(),e=>void e.clear()),P(this.activeRowHeaders.values(),e=>void e.clear()),P(this.activeColumnHeaders.values(),e=>void e.clear()),P(this.activeCornerHeaders.values(),e=>void e.clear()),P(this.rowHighlights.values(),e=>void e.clear()),P(this.columnHighlights.values(),e=>void e.clear())}[aB](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function es(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}const Mre=_re;let lB;function CA(t,e,n){return e=xre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xre(t){var e=Pre(t,"string");return typeof e=="symbol"?e:String(e)}function Pre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}lB=Symbol.iterator;class Ore{constructor(e){CA(this,"ranges",[]),CA(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[lB](){return this.ranges[Symbol.iterator]()}}const Are=Ore;function Fh(t,e){uB(t,e),e.add(t)}function dS(t,e,n){uB(t,e),e.set(t,n)}function uB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rt(t,e){var n=cB(t,e,"get");return Ire(t,n)}function Ire(t,e){return e.get?e.get.call(t):e.value}function Or(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function DR(t,e,n){var r=cB(t,e,"set");return Hre(t,r,n),n}function cB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Hre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var lm=new WeakMap,ht=new WeakMap,Ya=new WeakMap,fS=new WeakSet,gS=new WeakSet,NR=new WeakSet,mS=new WeakSet,al=new WeakSet;class hB{constructor(e,n){Fh(this,al),Fh(this,mS),Fh(this,NR),Fh(this,gS),Fh(this,fS),dS(this,lm,{writable:!0,value:void 0}),dS(this,ht,{writable:!0,value:void 0}),dS(this,Ya,{writable:!0,value:{x:0,y:0}}),DR(this,lm,e),DR(this,ht,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Or(this,fS,yA).call(this,{x:rt(this,ht).navigableHeaders()?rt(this,ht).countRowHeaders():0,y:rt(this,ht).navigableHeaders()?rt(this,ht).countColHeaders():0});const i=rt(this,ht).createCellCoords(e,n);let o=rt(this,lm).current().highlight;const s=rt(this,ht).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=Or(this,NR,dB).call(this),{row:h,col:f}=Or(this,mS,bA).call(this,o),g=rt(this,ht).fixedRowsBottom(),p=rt(this,ht).minSpareRows(),y=rt(this,ht).minSpareCols(),E=rt(this,ht).autoWrapRow(),v=rt(this,ht).autoWrapCol(),C=rt(this,ht).createCellCoords(h+i.row,f+i.col);if(C.row>=c){const _=Qi(r&&p>0&&g===0),A=C.col+1,D=rt(this,ht).createCellCoords(C.row-c,A>=u?A-u:A);this.runLocalHooks("beforeColumnWrap",_,Or(this,al,xu).call(this,D),A>=u),_.value?this.runLocalHooks("insertRowRequire",rt(this,ht).countRenderableRows()):v&&C.assign(D)}else if(C.row<0){const _=Qi(v),A=C.col-1,D=rt(this,ht).createCellCoords(c+C.row,A<0?u+A:A);this.runLocalHooks("beforeColumnWrap",_,Or(this,al,xu).call(this,D),A<0),v&&C.assign(D)}if(C.col>=u){const _=Qi(r&&y>0),A=C.row+1,D=rt(this,ht).createCellCoords(A>=c?A-c:A,C.col-u);this.runLocalHooks("beforeRowWrap",_,Or(this,al,xu).call(this,D),A>=c),_.value?this.runLocalHooks("insertColRequire",rt(this,ht).countRenderableColumns()):E&&C.assign(D)}else if(C.col<0){const _=Qi(E),A=C.row-1,D=rt(this,ht).createCellCoords(A<0?c+A:A,u+C.col);this.runLocalHooks("beforeRowWrap",_,Or(this,al,xu).call(this,D),A<0),E&&C.assign(D)}const{rowDir:S,colDir:T}=Or(this,gS,SA).call(this,C);a=S,l=T,o=Or(this,al,xu).call(this,C)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){Or(this,fS,yA).call(this,{x:rt(this,ht).navigableHeaders()?rt(this,ht).countRowHeaders():0,y:rt(this,ht).navigableHeaders()?rt(this,ht).countColHeaders():0});const r=rt(this,ht).createCellCoords(e,n),i=rt(this,lm).current(),o=rt(this,ht).visualToRenderableCoords(i.highlight),s=i.to.clone();let a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null){const{row:u,col:c}=Or(this,mS,bA).call(this,i.to),h=rt(this,ht).createCellCoords(u+r.row,c+r.col),{rowDir:f,colDir:g}=Or(this,gS,SA).call(this,h);a=f,l=g;const p=Or(this,al,xu).call(this,h);r.row===0&&r.col!==0?s.col=p.col:r.row!==0&&r.col===0?s.row=p.row:(s.row=p.row,s.col=p.col)}return this.runLocalHooks("afterTransformEnd",s,a,l),s}}function yA(t){let{x:e,y:n}=t;DR(this,Ya,{x:e,y:n})}function SA(t){const{width:e,height:n}=Or(this,NR,dB).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function dB(){return{width:rt(this,Ya).x+rt(this,ht).countRenderableColumns(),height:rt(this,Ya).y+rt(this,ht).countRenderableRows()}}function bA(t){const{row:e,col:n}=rt(this,ht).visualToRenderableCoords(t);return rt(this,ht).createCellCoords(rt(this,Ya).y+e,rt(this,Ya).x+n)}function xu(t){const e=t.clone();return e.col=t.col-rt(this,Ya).x,e.row=t.row-rt(this,Ya).y,rt(this,ht).renderableToVisualCoords(e)}St(hB,Ur);const Dre=hB,lC=0,uC=1,fB=2,cM=3,Nre=[cM,fB],kre=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],pS=Symbol("root"),RA=Symbol("child");function Zc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pS;if(e!==pS&&e!==RA)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===pS;let i=lC;if(n){const o=t[0];t.length===0?i=uC:r&&o instanceof p1?i=cM:r&&Array.isArray(o)?i=Zc(o,RA):t.length>=2&&t.length<=4&&!t.some((a,l)=>!kre[l].includes(typeof a))&&(i=fB)}return i}function Of(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Nre.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===cM;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Tt(u)&&(u=a),Tt(c)&&(c=l),!r){const g=a,p=l,y=u,E=c;a=Math.min(g,y),l=Math.min(p,E),u=Math.max(g,y),c=Math.max(p,E)}const h=e(a,l),f=e(u,c);return n(h,h,f)}}function Lre(t){const e=Zc(t.getSelected());if(e===lC||e===uC)return[];const n=Of(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;P(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;P(Array.from(new Array(c),(h,f)=>u+f),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return sn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function $re(t){const e=Zc(t.getSelected());if(e===lC||e===uC)return[];const n=Of(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;P(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;P(Array.from(new Array(c),(h,f)=>u+f),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return sn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Fre(t,e,n){Wre(t,e),e.set(t,n)}function Wre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zs(t,e,n){return e=Vre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vre(t){var e=Bre(t,"string");return typeof e=="symbol"?e:String(e)}function Bre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EA(t,e,n){var r=gB(t,e,"set");return Ure(t,r,n),n}function Ure(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function TA(t,e){var n=gB(t,e,"get");return zre(t,n)}function gB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function zre(t,e){return e.get?e.get.call(t):e.value}var Wh=new WeakMap;class mB{constructor(e,n){var r=this;Zs(this,"settings",void 0),Zs(this,"tableProps",void 0),Zs(this,"inProgress",!1),Zs(this,"selectedRange",new Are((i,o,s)=>this.tableProps.createCellRange(i,o,s))),Zs(this,"highlight",void 0),Zs(this,"transformation",void 0),Zs(this,"selectedByRowHeader",new Set),Zs(this,"selectedByColumnHeader",new Set),Fre(this,Wh,{writable:!0,value:!1}),this.settings=e,this.tableProps=n,this.highlight=new Mre({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[YT()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),this.transformation=new Dre(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Tt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Tt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(n),r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(_1,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(P(this.highlight.getAreas(),C=>void C.clear()),P(this.highlight.getLayeredAreas(),C=>void C.clear()),P(this.highlight.getRowHeaders(),C=>void C.clear()),P(this.highlight.getColumnHeaders(),C=>void C.clear()),P(this.highlight.getActiveRowHeaders(),C=>void C.clear()),P(this.highlight.getActiveColumnHeaders(),C=>void C.clear()),P(this.highlight.getActiveCornerHeaders(),C=>void C.clear()),P(this.highlight.getRowHighlights(),C=>void C.clear()),P(this.highlight.getColumnHighlights(),C=>void C.clear())),this.highlight.useLayerLevel(l);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),h=this.highlight.createRowHeader(),f=this.highlight.createColumnHeader(),g=this.highlight.createActiveRowHeader(),p=this.highlight.createActiveColumnHeader(),y=this.highlight.createActiveCornerHeader(),E=this.highlight.createRowHighlight(),v=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),h.clear(),f.clear(),g.clear(),p.clear(),y.clear(),E.clear(),v.clear(),this.highlight.isEnabledFor(T1,s.highlight)&&(this.isMultiple()||l>=1)&&(u.add(s.from).add(s.to).commit(),c.add(s.from).add(s.to).commit(),l===1)){const C=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(C.from).commit().syncWith(C),this.highlight.createLayeredArea().add(C.from).commit().syncWith(C),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(E1,s.highlight)){if(!s.isSingleHeader()){const T=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),_=this.tableProps.createCellCoords(s.to.row,-1),A=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),D=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(h.add(T).commit(),f.add(A).commit(),E.add(T).commit(),v.add(A).commit()):(h.add(T).add(_).commit(),f.add(A).add(D).commit(),E.add(T).add(_).commit(),v.add(A).add(D).commit())}const C=!TA(this,Wh)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||i===0&&this.isSelectedByRowHeader()),S=!TA(this,Wh)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||r===0&&this.isSelectedByColumnHeader());C&&g.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),S&&p.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),C&&S&&y.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=Qi(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,r))}transformEnd(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:f,disableHeadersHighlight:g}=i;EA(this,Wh,g),f&&Number.isInteger(f==null?void 0:f.row)&&Number.isInteger(f==null?void 0:f.col)&&(h=this.tableProps.createCellCoords($r(f.row,u,o-1),$r(f.col,c,s-1)));const p=this.tableProps.createCellCoords(u,c),y=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(p,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.finish(),EA(this,Wh,!1)}selectCells(e){var n=this;const r=Zc(e);if(r===uC)return!1;if(r===lC)throw new Error(vt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Of(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),P(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone()),this.finish()})),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),f=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(f){const g=l===0?0:$r(r,u,-1),p=s-1,y=this.tableProps.createCellCoords(g,i),E=this.tableProps.createCellCoords(p,o),v=this.tableProps.createCellCoords($r(r,u,s-1),i);this.runLocalHooks("beforeSelectColumns",y,E,v),y.row=g,E.row=p,this.setRangeStartOnly(y,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectColumns",y,E,v),this.finish()}return f}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){const h=s===0?0:$r(r,a,-1),f=o-1,g=this.tableProps.createCellCoords(e,h),p=this.tableProps.createCellCoords(n,f),y=this.tableProps.createCellCoords(e,$r(r,a,o-1));this.runLocalHooks("beforeSelectRows",g,p,y),g.col=h,p.col=f,this.setRangeStartOnly(g,void 0,y),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.runLocalHooks("afterSelectRows",g,p,y),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),f.commit(),g.commit()}this.highlight.useLayerLevel(r)}}St(mB,Ur);const Gre=mB,_A=/^(\r\n|\n\r|\r|\n)/,jre=/^[^\t\r\n]+/,MA=/^\t/;function Yre(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(MA))t=t.replace(MA,""),n+=1,e[r][n]="";else if(t.match(_A))t=t.replace(_A,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(jre);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function Wd(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function ll(t,e,n){return e=Kre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kre(t){var e=Xre(t,"string");return typeof e=="symbol"?e:String(e)}function Xre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){ll(this,"hot",void 0),ll(this,"metaManager",void 0),ll(this,"tableMeta",void 0),ll(this,"dataSource",void 0),ll(this,"duckSchema",void 0),ll(this,"colToPropCache",void 0),ll(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=Zv(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(je(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return D1(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ke(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&fe(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(fe(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Qc(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,f=[];for(;a<n&&o+a<c;){let p=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?p=rr(this.getSchema()):(p=[],Re(h-1,()=>p.push(null))):this.hot.dataType==="function"?p=this.tableMeta.dataSchema(l+a):(p={},ig(p,this.getSchema())),f.push(p),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,f);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===f.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",g,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let f=this.hot.countCols(),g=0,p=c;i==="end"&&(p=Math.min(p+1,a));const y=p;for(;g<n&&f<s;){if(typeof l!="number"||l>=f)if(h>0)for(let v=0;v<h;v+=1)typeof o[v]>"u"&&(o[v]=[]),o[v].push(null);else o.push([null]);else for(let v=0;v<h;v++)o[v].splice(p,0,null);g+=1,p+=1,f+=1}this.hot.columnIndexMapper.insertIndexes(l,g),g>0&&(e==null?this.metaManager.createColumn(null,g):r!=="auto"&&this.metaManager.createColumn(y,n));const E=this.hot.toVisualColumn(y);return this.hot.runHooks("afterCreateCol",E,g,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:y}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=fe(this.tableMeta.columns)||fe(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,f)=>f-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,f=this.hot.countSourceRows();h<f;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,f=this.hot.countSourceRows();h<f;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];cR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return pV(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];cR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;let s=null;if(i&&i.hasOwnProperty&&Vt(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){const a=n.split(".");let l=i;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;s=l}else typeof n=="function"&&(s=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const a=Qi(s);this.hot.runHooks("modifyData",r,this.propToCol(n),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const l=Qi(o);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"set"),l.isTouched()&&(o=l.value)}if(s&&s.hasOwnProperty&&Vt(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){const l=n.split(".");let u=s,c=0,h;for(c=0,h=l.length-1;c<h;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=o}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,xc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===xc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),f=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=f&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,n){return Wd(this.getRange(e,n,xc.DESTINATION_RENDERER))}getCopyableText(e,n){return Wd(this.getRange(e,n,xc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const qre=xc,{register:Qre,getItem:Zre,hasItem:pB,getNames:Jre,getValues:Gbe}=lo("cellTypes");function hM(t){if(!pB(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Zre(t)}function di(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Hr(t,n),r&&Mo(t,r),i&&Mc(t,i),Qre(t,e)}function eie(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Vt(e,t)}function cC(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?hM(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ke(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!je(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ke(r,(o,s)=>{if(eie(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),hn(t,i)}function tie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}zs(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Mp(t){return Number.isInteger(t)&&t>=0}function xp(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function um(t){return t==null}const wB=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Cn(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Cn(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),Qv(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function xA(t,e,n){return e=nie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nie(t){var e=rie(t,"string");return typeof e=="symbol"?e:String(e)}function rie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iie(){return class{}}class oie{constructor(e){xA(this,"metaCtor",iie()),xA(this,"meta",void 0),this.meta=this.metaCtor.prototype,hn(this.meta,wB()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;hn(this.meta,e),cC(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function sie(t,e,n){return e=aie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aie(t){var e=lie(t,"string");return typeof e=="symbol"?e:String(e)}function lie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uie{constructor(e){sie(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){hn(this.meta,e),cC(this.meta,e,e)}}let vB;function cm(t,e,n){return e=cie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cie(t){var e=hie(t,"string");return typeof e=="symbol"?e:String(e)}function hie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}vB=Symbol.iterator;class kw{constructor(e){cm(this,"valueFactory",void 0),cm(this,"data",[]),cm(this,"index",[]),cm(this,"holes",new Set),this.valueFactory=e}obtain(e){xp(()=>Mp(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;xp(()=>Mp(e)||um(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=um(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;xp(()=>Mp(e)||um(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(um(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return ni(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[vB](){return this.entries()}}function PA(t,e,n){return e=die(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function die(t){var e=fie(t,"string");return typeof e=="symbol"?e:String(e)}function fie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const gie=["data","width"];class mie{constructor(e){PA(this,"globalMeta",void 0),PA(this,"metas",new kw(()=>this._createMeta())),this.globalMeta=e,this.metas=new kw(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);hn(r,n),cC(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return tie(this.globalMeta.getMetaConstructor(),gie).prototype}}function OA(t,e,n){return e=pie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pie(t){var e=wie(t,"string");return typeof e=="symbol"?e:String(e)}function wie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vie{constructor(e){OA(this,"columnMeta",void 0),OA(this,"metas",new kw(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);hn(i,r),cC(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)e.push(...n[r].values());return e}getMetasAtRow(e){xp(()=>Mp(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new kw(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class CB{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new oie(e),this.tableMeta=new uie(this.globalMeta),this.columnMeta=new mie(this.globalMeta),this.cellMeta=new vie(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:o}=r;const s=this.cellMeta.getMeta(e,n);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}St(CB,Ur);function AA(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=nr(a),f=i.getSettings();Array.isArray(f.dataSchema)?i.dataType="array":Et(f.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new qre(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const p=g.getSchema();t=[];let y,E=0,v=0;for(E=0,v=f.startRows;E<v;E++)if((i.dataType==="object"||i.dataType==="function")&&f.dataSchema)y=rr(p),t.push(y);else if(i.dataType==="array")y=rr(p[0]),t.push(y);else{y=[];for(let C=0,S=f.startCols;C<S;C++)y.push(null);t.push(y)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),f.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),n(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Ae(i.rootElement,[EV(-1),jv(i.countCols()+(i.view?i.countRowHeaders():0))])}function IA(t,e,n){return e=Cie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cie(t){var e=yie(t,"string");return typeof e=="symbol"?e:String(e)}function yie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sie{constructor(e){IA(this,"metaManager",void 0),IA(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),ve.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Vt(e,"type")?e.type:null;let c=Et(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function wS(t,e,n){return e=bie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bie(t){var e=Rie(t,"string");return typeof e=="symbol"?e:String(e)}function Rie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Eie{constructor(e){wS(this,"metaManager",void 0),wS(this,"usageTracker",new Set),wS(this,"propDescriptors",new Map([["ariaTags",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{target:r,onChange:i=()=>{}}=e,o=typeof r=="string",s=o?r:n,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(n,a,i),o&&this.installPropWatcher(r,a,i)})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const yB="gridDefault",dM="editorManager.handlingEditor",Tie={name:"editorCloseAndSave",callback(t,e,n){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(n.includes("shift"))}},_ie={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},Mie={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},xie={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(n.includes("shift")),Pi(e))}};function Pie(){return[Tie,_ie,Mie,xie]}const Oie={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},Aie={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},Iie={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},Hie={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},Die={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e.row)}},Nie={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},kie={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},Lie={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}},$ie={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},Fie={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},Wie={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},Vie={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e.col)}},Bie={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},Uie={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function zie(){return[Oie,Aie,Iie,Hie,Die,Nie,kie,Lie,$ie,Fie,Wie,Vie,Bie,Uie]}const Gie={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},jie={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},Yie={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-r.row,-r.col)}},Kie={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(r.row,r.col)}},Xie={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},qie={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},Qie={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},Zie={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},Jie={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},eoe={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,o))}},toe={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},noe={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},roe={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},ioe={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},ooe={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},soe={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function aoe(){return[Gie,jie,Yie,Kie,Xie,qie,Qie,Zie,Jie,eoe,toe,noe,roe,ioe,ooe,soe]}const loe={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},uoe={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},coe={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},hoe={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},doe={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},foe=[...Pie(),...zie(),...aoe(),loe,uoe,coe,hoe,doe];function SB(t){const e={};return foe.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function goe(t){const e=t.getShortcutManager().addContext("editor"),n=SB(t),r={group:dM};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function moe(t){const e=t.getShortcutManager().addContext("grid"),n=SB(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return fe(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:yB};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:dM,runOnlyIf:()=>fe(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function poe(t){[goe,moe].forEach(e=>e(t))}function woe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=HA(t),i=HA(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function HA(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Ae(n,[No(),Us()]),n}function voe(t){let e;const{activate:n,deactivate:r}=woe(t,{onFocusFromTop(){var u;const c=(u=e)!==null&&u!==void 0?u:DA(t);c&&(t.runHooks("modifyFocusOnTabNavigation","from_above",c),t.selectCell(c.row,c.col)),t.listen()},onFocusFromBottom(){var u;const c=(u=e)!==null&&u!==void 0?u:NA(t);c&&(t.runHooks("modifyFocusOnTabNavigation","from_below",c),t.selectCell(c.row,c.col)),t.listen()}}),i={wrapped:!1,flipped:!1};let o=!0,s=!1;t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(u,c,h,f,g)=>{if(s&&i.wrapped&&i.flipped&&(g.value=!0),o){var p;e=(p=t.getSelectedRangeLast())===null||p===void 0?void 0:p.highlight}}),t.addHook("beforeRowWrap",(u,c,h)=>{i.wrapped=!0,i.flipped=h});function a(){i.wrapped=!1,i.flipped=!1,t.deselectCell(),t.unlisten()}const l={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:yB,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...l,callback:()=>{s=!0,t.getSelectedRangeLast()&&!t.getSettings().tabNavigation&&(o=!1)},position:"before"},{...l,callback:u=>{const{tabNavigation:c,autoWrapRow:h}=t.getSettings();if(s=!1,o=!0,!c||!t.selection.isSelected()||h&&i.wrapped&&i.flipped||!h&&i.wrapped)return h&&i.wrapped&&i.flipped&&(e=u.shiftKey?DA(t):NA(t)),a(),!1;u.preventDefault()},position:"after"}])}function DA(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function NA(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}const kA=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),hm=t=>t.map(e=>{const n=e.toLowerCase();return kA.has(n)?kA.get(n):n}).sort().join("+"),Coe=t=>t.split("+"),LA=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),yoe=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),vS=t=>{let{key:e,code:n}=t,r=e;return LA.test(n)?r=n.replace(LA,"$1"):yoe.has(n)&&(r=n),r.toLowerCase()},bB=Symbol("shortcut-context");function RB(t){return je(t)&&t.__kindOf===bB}const Soe=t=>{const e=tC({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:f=!1,preventDefault:g=!0,stopPropagation:p=!1,relativeToGroup:y,position:E,forwardToContext:v}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Tt(c))throw new Error("You need to define the shortcut's group.");if(Et(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(vt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const C={callback:u,group:c,runOnlyIf:h,captureCtrl:f,preventDefault:g,stopPropagation:p};fe(y)&&([C.relativeToGroup,C.position]=[y,E]),RB(v)&&(C.forwardToContext=v),l.forEach(S=>{const T=hm(S);if(e.hasItem(T)){const A=e.getItem(T);let D=A.findIndex(U=>U.group===y);D!==-1?E==="before"?D-=1:D+=1:D=A.length,A.splice(D,0,C)}else e.addItem(T,[C])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ke(u,(h,f)=>{Object.prototype.hasOwnProperty.call(c,f)===!1&&(c[f]=u[f])}),n(c)})},i=l=>{const u=hm(l);e.removeItem(u)};return{__kindOf:bB,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=hm(l),c=e.getItem(u);return fe(c)?c.slice():[]},hasShortcut:l=>{const u=hm(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,f]=c;const g=f.filter(p=>p.group!==l);g.length===0?i(Coe(h)):(f.length=0,f.push(...g))})}}};function boe(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Roe=["meta","alt","shift","control"],Vh=boe();let dm=0;function Eoe(t,e,n,r,i){const o=g=>Roe.includes(g),s=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=[];return g.altKey&&y.push("alt"),p&&(g.ctrlKey||g.metaKey)?y.push("control/meta"):(g.ctrlKey&&y.push("control"),g.metaKey&&y.push("meta")),g.shiftKey&&y.push("shift"),y},a=g=>{if(e(g)===!1)return;const p=n(g);if(g.keyCode===229||p===!1||pa(g))return;const y=vS(g);let E=[];o(y)||(E=s(g));const v=[y].concat(E);!i(g,v)&&(Mf()&&E.includes("meta")||!Mf()&&E.includes("control"))&&i(g,[y].concat(s(g,!0))),r(g)},l=g=>{const p=vS(g);o(p)&&Vh.press(p)},u=g=>{const p=vS(g);o(p)&&Vh.release(p)},c=()=>{Vh.releaseAll()};return{mount:()=>{let g=t;for(dm+=1;g;)dm===1&&(g.document.documentElement.addEventListener("keydown",l),g.document.documentElement.addEventListener("keyup",u)),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=Ef(g)},unmount:()=>{let g=t;for(dm-=1;g;)dm===0&&(g.document.documentElement.removeEventListener("keydown",l),g.document.documentElement.removeEventListener("keyup",u)),g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=Ef(g)},isPressed:g=>Vh.isPressed(g),releasePressedKeys:()=>Vh.releaseAll()}}const Toe=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=tC({errorIdExists:p=>`The "${p}" context name is already registered.`});let s="grid";const a=p=>{const y=Soe(p);return o.addItem(p,y),y},l=()=>s,u=p=>o.getItem(p),c=p=>{if(!o.hasItem(p))throw new Error(vt`You've tried to activate the "${p}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=p};let h=!1;const f=function(p,y){let E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const v=RB(E)?E:u(E);let C=!1;if(!v.hasShortcut(y))return C;const S=v.getShortcuts(y);for(let T=0;T<S.length;T++){const{callback:_,runOnlyIf:A,preventDefault:D,stopPropagation:U,captureCtrl:z,forwardToContext:G}=S[T];if(A(p)===!0){if(h=z,C=_(p,y)===!1,h=!1,D&&p.preventDefault(),U&&(Pi(p),p.stopPropagation()),C)break;G&&f(p,y,G)}}return C},g=Eoe(e,n,r,i,f);return g.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};let CS=null;const yS=new Map;function EB(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this;const a=new ri(s);let l,u,c,h,f,g=!0;ane(i)&&sne(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const p=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",y=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",y),this.isRtl=function(){return y==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=cre(e.language);const E=new CB(s,e,[Sie,Eie]),v=E.getTableMeta(),C=E.getGlobalMeta(),S=tC();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),_p(this)&&yV(e.licenseKey,t),this.guid=`ht_${BT()}`,yS.set(this.guid,this),this.columnIndexMapper=new IR,this.rowIndexMapper=new IR,this.columnIndexMapper.addLocalHook("indexesSequenceChange",d=>{s.runHooks("afterColumnSequenceChange",d)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",d=>{s.runHooks("afterRowSequenceChange",d)}),u=new Rne(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const T=d=>{const{row:m,col:w}=d;return s._createCellCoords(m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m,w>=0?s.columnIndexMapper.getRenderableFromVisualIndex(w):w)},_=d=>{const{row:m,col:w}=d;return s._createCellCoords(m>=0?s.rowIndexMapper.getVisualFromRenderableIndex(m):m,w>=0?s.columnIndexMapper.getVisualFromRenderableIndex(w):w)};let A=new Gre(v,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:d=>l.propToCol(d),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(d,m)=>s._createCellCoords(d,m),createCellRange:(d,m,w)=>s._createCellRange(d,m,w),visualToRenderableCoords:T,renderableToVisualCoords:_,isDisabledCellSelection:(d,m)=>d<0||m<0?s.getSettings().disableVisualSelection:s.getCellMeta(d,m).disableVisualSelection});this.selection=A;const D=d=>{let{hiddenIndexesChanged:m}=d;m&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",D),this.rowIndexMapper.addLocalHook("cacheUpdated",D),this.selection.addLocalHook("afterSetRangeEnd",d=>{const m=Qi(!1),w=this.selection.getSelectedRange(),{from:x,to:O}=w.current(),H=w.size()-1;this.runHooks("afterSelection",x.row,x.col,O.row,O.col,m,H),this.runHooks("afterSelectionByProp",x.row,s.colToProp(x.col),O.row,s.colToProp(O.col),m,H);let K=!0;o&&(K=!1),m.isTouched()&&(K=!m.value);const B=this.selection.selectedRange.current(),Q=this.selection.isSelectedByAnyHeader(),ee=this.selection.isSelectedByRowHeader(),q=this.selection.isSelectedByColumnHeader();if(K!==!1)if(Q)ee?this.scrollViewportTo({row:d.row}):q&&this.scrollViewportTo({col:d.col});else if(B&&!this.selection.isMultiple()){const{row:me,col:He}=B.from;me<0&&He>=0?this.scrollViewportTo({col:He}):He<0&&me>=0?this.scrollViewportTo({row:me}):this.scrollViewportTo({row:me,col:He})}else this.scrollViewportTo(d.toObject());ee&&q?te(this.rootElement,["ht__selection--rows","ht__selection--columns"]):ee?(We(this.rootElement,"ht__selection--columns"),te(this.rootElement,"ht__selection--rows")):q?(We(this.rootElement,"ht__selection--rows"),te(this.rootElement,"ht__selection--columns")):We(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",d=>{const m=d.length-1,{from:w,to:x}=d[m];this.runHooks("afterSelectionEnd",w.row,w.col,x.row,x.col,m),this.runHooks("afterSelectionEndByProp",w.row,s.colToProp(w.col),x.row,s.colToProp(x.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",d=>{const m=this.runHooks("afterIsMultipleSelection",d.value);d.value&&(d.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{h.destroyEditor(),this._refreshBorders(),We(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("afterSelectRows",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",d=>this.alter("insert_row_above",d,1,"auto")).addLocalHook("insertColRequire",d=>this.alter("insert_col_start",d,1,"auto")),c={alter(d,m){var w,x;let O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,H=arguments.length>3?arguments[3]:void 0,K=arguments.length>4?arguments[4]:void 0;const B=Q=>{if(Q.length===0)return[];const ee=[...Q];return ee.sort((me,He)=>{let[Pe]=me,[De]=He;return Pe===De?0:Pe>De?1:-1}),sn(ee,(me,He)=>{let[Pe,De]=He;const X=me[me.length-1],[Qe,Be]=X,Te=Qe+Be;if(Pe<=Te){const Le=Math.max(De-(Te-Pe),0);X[1]+=Le}else me.push([Pe,De]);return me},[ee[0]])};switch(d){case"insert_row_below":case"insert_row_above":const Q=s.countSourceRows();if(v.maxRows===Q)return;const ee=d==="insert_row_below"?"below":"above";m=(w=m)!==null&&w!==void 0?w:ee==="below"?Q:0;const{delta:q,startPhysicalIndex:me}=l.createRow(m,O,{source:H,mode:ee});if(q){const Be=A.selectedRange.current(),Te=Be==null?void 0:Be.from,Le=Te==null?void 0:Te.row,xe=s.toVisualRow(me);if(A.isSelectedByCorner())A.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(fe(Le)&&Le>=xe){const{row:b,col:M}=Be.to;let I=Te.col;A.isSelectedByRowHeader()&&(I=-1),A.getSelectedRange().pop(),A.setRangeStartOnly(s._createCellCoords(Le+q,I),!0),A.setRangeEnd(s._createCellCoords(b+q,M))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const He=d==="insert_col_end"?"end":"start";m=(x=m)!==null&&x!==void 0?x:He==="end"?s.countSourceCols():0;const{delta:Pe,startPhysicalIndex:De}=l.createCol(m,O,{source:H,mode:He});if(Pe){if(Array.isArray(v.colHeaders)){const b=[s.toVisualColumn(De),0];b.length+=Pe,Array.prototype.splice.apply(v.colHeaders,b)}const Be=A.selectedRange.current(),Te=Be==null?void 0:Be.from,Le=Te==null?void 0:Te.col,xe=s.toVisualColumn(De);if(A.isSelectedByCorner())A.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(fe(Le)&&Le>=xe){const{row:b,col:M}=Be.to;let I=Te.row;A.isSelectedByColumnHeader()&&(I=-1),A.getSelectedRange().pop(),A.setRangeStartOnly(s._createCellCoords(I,Le+Pe),!0),A.setRangeEnd(s._createCellCoords(b,M+Pe))}else s._refreshBorders()}break;case"remove_row":const X=Be=>{let Te=0;P(Be,Le=>{let[xe,b]=Le;const M=Cn(xe)?s.countRows()-1:Math.max(xe-Te,0);if(Number.isInteger(xe)&&(xe=Math.max(xe-Te,0)),!l.removeRow(xe,b,H))return;const V=s.countRows(),N=v.fixedRowsTop;N>=M+1&&(v.fixedRowsTop-=Math.min(b,N-M));const W=v.fixedRowsBottom;W&&M>=V-W&&(v.fixedRowsBottom-=Math.min(b,W)),Te+=b})};Array.isArray(m)?X(B(m)):X([[m,O]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const Qe=Be=>{let Te=0;P(Be,Le=>{let[xe,b]=Le;const M=Cn(xe)?s.countCols()-1:Math.max(xe-Te,0);let I=s.toPhysicalColumn(M);if(Number.isInteger(xe)&&(xe=Math.max(xe-Te,0)),!l.removeCol(xe,b,H))return;const N=v.fixedColumnsStart;N>=M+1&&(v.fixedColumnsStart-=Math.min(b,N-M)),Array.isArray(v.colHeaders)&&(typeof I>"u"&&(I=-1),v.colHeaders.splice(I,b)),Te+=b})};Array.isArray(m)?Qe(B(m)):Qe([[m,O]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${d}"`)}K||c.adjustRowsAndCols()},adjustRowsAndCols(){const d=v.minRows,m=v.minSpareRows,w=v.minCols,x=v.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&A.deselect(),d){const O=s.countRows();O<d&&l.createRow(O,d-O,{source:"auto"})}if(m){const O=s.countEmptyRows(!0);if(O<m){const H=m-O,K=Math.min(H,v.maxRows-s.countSourceRows());l.createRow(s.countRows(),K,{source:"auto"})}}{let O;(w||x)&&(O=s.countEmptyCols(!0));let H=s.countCols();if(w&&!v.columns&&H<w){const K=w-H;O+=K,l.createCol(H,K,{source:"auto"})}if(x&&!v.columns&&s.dataType==="array"&&O<x){H=s.countCols();const K=x-O,B=Math.min(K,v.maxCols-H);l.createCol(H,B,{source:"auto"})}}if(A.isSelected()){const O=s.countRows(),H=s.countCols();P(A.selectedRange,K=>{let B=!1,Q=K.from.row,ee=K.from.col,q=K.to.row,me=K.to.col;Q>O-1?(Q=O-1,B=!0,q>Q&&(q=Q)):q>O-1&&(q=O-1,B=!0,Q>q&&(Q=q)),ee>H-1?(ee=H-1,B=!0,me>ee&&(me=ee)):me>H-1&&(me=H-1,B=!0,ee>me&&(ee=me)),B&&s.selectCell(Q,ee,q,me)})}s.view&&s.view.adjustElementsSize()},populateFromArray(d,m,w,x,O){let H,K,B,Q;const ee=[],q={},me=[],He=d.row,Pe=d.col;if(K=m.length,K===0)return!1;let De=0,X=0;switch(je(w)&&(De=w.col-Pe+1,X=w.row-He+1),O){case"shift_down":const Qe=kd(m),Be=Qe.length,Te=Math.max(Be,De),Le=s.getData().slice(He),xe=kd(Le).slice(Pe,Pe+Te);for(B=0;B<Te;B+=1)if(B<Be){for(H=0,K=Qe[B].length;H<X-K;H+=1)Qe[B].push(Qe[B][H%K]);B<xe.length?me.push(Qe[B].concat(xe[B])):me.push(Qe[B].concat(new Array(Le.length).fill(null)))}else me.push(Qe[B%Be].concat(xe[B]));s.populateFromArray(He,Pe,kd(me));break;case"shift_right":const b=m.length,M=Math.max(b,X),I=s.getData().slice(He).map(Y=>Y.slice(Pe));for(H=0;H<M;H+=1)if(H<b){for(B=0,Q=m[H].length;B<De-Q;B+=1)m[H].push(m[H][B%Q]);if(H<I.length)for(let Y=0;Y<I[H].length;Y+=1)m[H].push(I[H][Y]);else m[H].push(...new Array(I[0].length).fill(null))}else m.push(m[H%K].slice(0,M).concat(I[H]));s.populateFromArray(He,Pe,m);break;case"overwrite":default:q.row=d.row,q.col=d.col;let V=0,N=0,W=!0,k;const L=function(ae){let pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const _e=m[ae%m.length];return pe!==null?_e[pe%_e.length]:_e},j=m.length,F=w?w.row-d.row+1:0;for(w?K=F:K=Math.max(j,F),H=0;H<K&&!(w&&q.row>w.row&&F>j||!v.allowInsertRow&&q.row>s.countRows()-1||q.row>=v.maxRows);H++){const Y=H-V,ae=L(Y).length,pe=w?w.col-d.col+1:0;if(w?Q=pe:Q=Math.max(ae,pe),q.col=d.col,k=s.getCellMeta(q.row,q.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&k.skipRowOnPaste){V+=1,q.row+=1,K+=1;continue}for(N=0,B=0;B<Q&&!(w&&q.col>w.col&&pe>ae||!v.allowInsertColumn&&q.col>s.countCols()-1||q.col>=v.maxCols);B++){if(k=s.getCellMeta(q.row,q.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&k.skipColumnOnPaste){N+=1,q.col+=1,Q+=1;continue}if(k.readOnly&&x!=="UndoRedo.undo"){q.col+=1;continue}const _e=B-N;let Ne=L(Y,_e),Ge=s.getDataAtCell(q.row,q.col);if(Ne!==null&&typeof Ne=="object")if(Array.isArray(Ne)&&Ge===null&&(Ge=[]),Ge===null||typeof Ge!="object")W=!1;else{const Mt=Qc(Array.isArray(Ge)?Ge:Ge[0]||Ge),tt=Qc(Array.isArray(Ne)?Ne:Ne[0]||Ne);Qv(Mt,tt)||Array.isArray(Mt)&&Array.isArray(tt)?Ne=rr(Ne):W=!1}else Ge!==null&&typeof Ge=="object"&&(W=!1);W&&ee.push([q.row,q.col,Ne]),W=!0,q.col+=1}q.row+=1}s.setDataAtCell(ee,null,null,x||"populateFromArray");break}}};function U(d){const m=J2(d);uM(m)?(s.runHooks("beforeLanguageChange",m),C.language=m,s.runHooks("afterLanguageChange",m)):eB(d)}function z(d,m){const w=d==="className"?s.rootElement:s.table;if(g)te(w,m);else{let x=[],O=[];C[d]&&(x=Array.isArray(C[d])?C[d]:dR(C[d])),m&&(O=Array.isArray(m)?m:dR(m));const H=hR(x,O),K=hR(O,x);H.length&&We(w,H),K.length&&te(w,K)}C[d]=m}this.init=function(){u.setData(v.data),s.runHooks("beforeInit"),(Rs()||i1())&&te(s.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new gne(this),h=RZ.getInstance(s,v,A),f=new _Z(s),_p(this)&&voe(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&s.rootElement.offsetParent===null&&kV(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof g=="object"&&(s.runHooks("afterChange",g[0],g[1]),g=!1),s.runHooks("afterInit")};function G(){let d=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,d=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&d===!1&&(d=!0,this.onQueueEmpty(this.valid))}}}function Z(d){const m=d.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):d}function re(d,m,w){if(!d.length)return;const x=s.getActiveEditor(),O=new G;let H=!0;O.onQueueEmpty=K=>{x&&H&&x.cancelChanges(),w(K)};for(let K=d.length-1;K>=0;K--){const[B,Q,,ee]=d[K],q=l.propToCol(Q),me=s.getCellMeta(B,q);me.type==="numeric"&&typeof ee=="string"&&a2(ee)&&(d[K][3]=Z(ee)),s.getCellValidator(me)&&(O.addValidatorToQueue(),s.validateCell(d[K][3],me,function(He,Pe){return function(De){if(typeof De!="boolean")throw new Error("Validation error: result is not boolean");if(De===!1&&Pe.allowInvalid===!1){H=!1,d.splice(He,1),Pe.valid=!0;const X=s.getCell(Pe.visualRow,Pe.visualCol);X!==null&&We(X,v.invalidCellClassName)}O.removeValidatorFormQueue()}}(K,me),m))}O.checkIfQueueIsEmpty()}function ne(d,m){let w=d.length-1;if(w<0)return;for(;w>=0;w--){let O=!1;if(d[w]===null){d.splice(w,1);continue}if(!((d[w][2]===null||d[w][2]===void 0)&&(d[w][3]===null||d[w][3]===void 0))){if(v.allowInsertRow)for(;d[w][0]>s.countRows()-1;){const{delta:H}=l.createRow(void 0,void 0,{source:m});if(H===0){O=!0;break}}if(s.dataType==="array"&&(!v.columns||v.columns.length===0)&&v.allowInsertColumn)for(;l.propToCol(d[w][1])>s.countCols()-1;){const{delta:H}=l.createCol(void 0,void 0,{source:m});if(H===0){O=!0;break}}O||l.set(d[w][0],d[w][1],d[w][3])}}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",d,m),h.lockEditor(),s._refreshBorders(null),h.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",d,m||"edit");const x=s.getActiveEditor();x&&fe(x.refreshValue)&&x.refreshValue()}this._createCellCoords=function(d,m){return s.view._wt.createCellCoords(d,m)},this._createCellRange=function(d,m,w){return s.view._wt.createCellRange(d,m,w)},this.validateCell=function(d,m,w,x){let O=s.getCellValidator(m);function H(K){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){w(K);return}const Q=m.visualCol,ee=m.visualRow,q=s.getCell(ee,Q,!0);if(q&&q.nodeName!=="TH"){const me=s.rowIndexMapper.getRenderableFromVisualIndex(ee),He=s.columnIndexMapper.getRenderableFromVisualIndex(Q);s.view._wt.getSetting("cellRenderer",me,He,q)}w(K)}CV(O)&&(O=function(K){return function(B,Q){Q(K.test(B))}}(O)),Et(O)?(d=s.runHooks("beforeValidate",d,m.visualRow,m.prop,x),s._registerImmediate(()=>{O.call(m,d,K=>{s&&(K=s.runHooks("afterValidate",K,d,m.visualRow,m.prop,x),m.valid=K,H(K),s.runHooks("postAfterValidate",K,d,m.visualRow,m.prop,x))})})):s._registerImmediate(()=>{m.valid=!0,H(m.valid,!1)})};function he(d,m,w){return Array.isArray(d)?d:[[d,m,w]]}function Me(d,m){const w=s.getActiveEditor(),x=s.runHooks("beforeChange",d,m||"edit"),O=d.filter(H=>H!==null);return x===!1||O.length===0?(w&&w.cancelChanges(),[]):O}this.setDataAtCell=function(d,m,w,x){const O=he(d,m,w),H=[];let K=x,B,Q,ee;for(B=0,Q=O.length;B<Q;B++){if(typeof O[B]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof O[B][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");O[B][1]>=this.countCols()?ee=O[B][1]:ee=l.colToProp(O[B][1]),H.push([O[B][0],ee,u.getAtCell(this.toPhysicalRow(O[B][0]),O[B][1]),O[B][2]])}!K&&typeof d=="object"&&(K=m);const q=Me(H,x);s.runHooks("afterSetDataAtCell",q,K),re(q,K,()=>{ne(q,K)})},this.setDataAtRowProp=function(d,m,w,x){const O=he(d,m,w),H=[];let K=x,B,Q;for(B=0,Q=O.length;B<Q;B++)H.push([O[B][0],O[B][1],u.getAtCell(this.toPhysicalRow(O[B][0]),O[B][1]),O[B][2]]);!K&&typeof d=="object"&&(K=m);const ee=Me(H,x);s.runHooks("afterSetDataAtRowProp",ee,K),re(ee,K,()=>{ne(ee,K)})},this.listen=function(){s&&!s.isListening()&&(yS.forEach(d=>{s!==d&&d.unlisten()}),CS=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(CS=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return CS===s.guid},this.destroyEditor=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(d,m)},this.populateFromArray=function(d,m,w,x,O,H,K){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const B=typeof x=="number"?s._createCellCoords(x,O):null;return c.populateFromArray(s._createCellCoords(d,m),w,B,H,K)},this.spliceCol=function(d,m,w){for(var x=arguments.length,O=new Array(x>3?x-3:0),H=3;H<x;H++)O[H-3]=arguments[H];return l.spliceCol(d,m,w,...O)},this.spliceRow=function(d,m,w){for(var x=arguments.length,O=new Array(x>3?x-3:0),H=3;H<x;H++)O[H-3]=arguments[H];return l.spliceRow(d,m,w,...O)},this.getSelected=function(){if(A.isSelected())return Ye(A.getSelectedRange(),d=>{let{from:m,to:w}=d;return[m.row,m.col,w.row,w.col]})},this.getSelectedLast=function(){const d=this.getSelected();let m;return d&&d.length>0&&(m=d[d.length-1]),m},this.getSelectedRange=function(){if(A.isSelected())return Array.from(A.getSelectedRange())},this.getSelectedRangeLast=function(){const d=this.getSelectedRange();let m;return d&&d.length>0&&(m=d[d.length-1]),m},this.emptySelectedCells=function(d){if(!A.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];P(A.getSelectedRange(),w=>{if(w.isSingleHeader())return;const x=w.getTopStartCorner(),O=w.getBottomEndCorner();Re(x.row,O.row,H=>{Re(x.col,O.col,K=>{this.getCellMeta(H,K).readOnly||m.push([H,K,null])})})}),m.length>0&&this.setDataAtCell(m,d)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const d=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(d,0),!this.isRenderSuspended()&&d===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(h.lockEditor(),this._refreshBorders(null),h.unlockEditor()))},this.batchRender=function(d){this.suspendRender();const m=d();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||d)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const w=d();return this.resumeExecution(m),w},this.batch=function(d){this.suspendRender(),this.suspendExecution();const m=d();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!s.view)return;const{width:d,height:m}=s.view.getLastSize(),{width:w,height:x}=s.rootElement.getBoundingClientRect(),O=w!==d||x!==m;s.runHooks("beforeRefreshDimensions",{width:d,height:m},{width:w,height:x},O)!==!1&&((O||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(w,x),s.render()),s.runHooks("afterRefreshDimensions",{width:d,height:m},{width:w,height:x},O))},this.updateData=function(d,m){AA(d,w=>{l=w},w=>{l=w,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:m,metaManager:E,firstRun:g})},this.loadData=function(d,m){AA(d,w=>{l=w},()=>{E.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),g&&(g=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:m,metaManager:E,firstRun:g})},this.getInitialColumnCount=function(){const d=v.columns;let m=0;if(Array.isArray(d))m=d.length;else if(Et(d))if(s.dataType==="array"){const w=this.countSourceCols();for(let x=0;x<w;x+=1)d(x)&&(m+=1)}else(s.dataType==="object"||s.dataType==="function")&&(m=l.colToPropCache.length);else if(fe(v.dataSchema)){const w=l.getSchema();m=Array.isArray(w)?w.length:Zv(w)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(d,m,w,x){return Tt(d)?l.getAll():l.getRange(s._createCellCoords(d,m),s._createCellCoords(w,x),l.DESTINATION_RENDERER)},this.getCopyableText=function(d,m,w,x){return l.getCopyableText(s._createCellCoords(d,m),s._createCellCoords(w,x))},this.getCopyableData=function(d,m){return l.getCopyable(d,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=(g?s.loadData:s.updateData).bind(this);let x=!1,O,H;if(fe(d.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(fe(d.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(fe(d.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(O in d)O==="data"||(O==="language"?U(d.language):O==="className"?z("className",d.className):O==="tableClassName"&&s.table?(z("tableClassName",d.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):ve.getSingleton().isRegistered(O)||ve.getSingleton().isDeprecated(O)?(Et(d[O])||Array.isArray(d[O]))&&(d[O].initialHook=!0,s.addHook(O,d[O])):!m&&Vt(d,O)&&(C[O]=d[O]));d.data===void 0&&v.data===void 0?w(null,"updateSettings"):d.data!==void 0?w(d.data,"updateSettings"):d.columns!==void 0&&(l.createMap(),s.initIndexMappers());const K=s.countCols(),B=v.columns;if(B&&Et(B)&&(x=!0),(d.cell!==void 0||d.cells!==void 0||d.columns!==void 0)&&E.clearCache(),K>0)for(O=0,H=0;O<K;O++){if(B){const q=x?B(O):B[H];q&&E.updateColumnMeta(H,q)}H+=1}fe(d.cell)&&Ke(d.cell,q=>{s.setCellMetaObject(q.row,q.col,q)}),s.runHooks("afterCellMetaReset");let Q=s.rootElement.style.height;Q!==""&&(Q=parseInt(s.rootElement.style.height,10));let ee=d.height;if(Et(ee)&&(ee=ee()),m&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),ee===null){const q=s.rootElement.getAttribute("data-initialstyle");q&&(q.indexOf("height")>-1||q.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",q):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else ee!==void 0&&(s.rootElement.style.height=isNaN(ee)?`${ee}`:`${ee}px`,s.rootElement.style.overflow="hidden");if(typeof d.width<"u"){let q=d.width;Et(q)&&(q=q()),s.rootElement.style.width=isNaN(q)?`${q}`:`${q}px`}m||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",d)),c.adjustRowsAndCols(),s.view&&!g&&(s.forceFullRender=!0,h.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),h.unlockEditor()),!m&&s.view&&(Q===""||ee===""||ee===void 0)&&Q!==ee&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const d=s.getSelectedLast();if(v.getValue){if(Et(v.getValue))return v.getValue.call(s);if(d)return s.getData()[d[0][0]][v.getValue]}else if(d)return s.getDataAtCell(d[0],d[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(d,m,w,x,O){c.alter(d,m,w,x,O)},this.getCell=function(d,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,x=m,O=d;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;x=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(d>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(d)))return null;O=this.rowIndexMapper.getRenderableFromVisualIndex(d)}return O===null||x===null?null:s.view.getCellAtCoords(s._createCellCoords(O,x),w)},this.getCoords=function(d){const m=this.view._wt.wtTable.getCoords(d);if(m===null)return null;const{row:w,col:x}=m;let O=w,H=x;return w>=0&&(O=this.rowIndexMapper.getVisualFromRenderableIndex(w)),x>=0&&(H=this.columnIndexMapper.getVisualFromRenderableIndex(x)),s._createCellCoords(O,H)},this.colToProp=function(d){return l.colToProp(d)},this.propToCol=function(d){return l.propToCol(d)},this.toVisualRow=d=>this.rowIndexMapper.getVisualFromPhysicalIndex(d),this.toVisualColumn=d=>this.columnIndexMapper.getVisualFromPhysicalIndex(d),this.toPhysicalRow=d=>this.rowIndexMapper.getPhysicalFromVisualIndex(d),this.toPhysicalColumn=d=>this.columnIndexMapper.getPhysicalFromVisualIndex(d),this.getDataAtCell=function(d,m){return l.get(d,l.colToProp(m))},this.getDataAtRowProp=function(d,m){return l.get(d,m)},this.getDataAtCol=function(d){const m=[],w=l.getRange(s._createCellCoords(0,d),s._createCellCoords(v.data.length-1,d),l.DESTINATION_RENDERER);for(let x=0;x<w.length;x+=1)for(let O=0;O<w[x].length;O+=1)m.push(w[x][O]);return m},this.getDataAtProp=function(d){const m=[],w=l.getRange(s._createCellCoords(0,l.propToCol(d)),s._createCellCoords(v.data.length-1,l.propToCol(d)),l.DESTINATION_RENDERER);for(let x=0;x<w.length;x+=1)for(let O=0;O<w[x].length;O+=1)m.push(w[x][O]);return m},this.getSourceData=function(d,m,w,x){let O;return d===void 0?O=u.getData():O=u.getByRange(s._createCellCoords(d,m),s._createCellCoords(w,x)),O},this.getSourceDataArray=function(d,m,w,x){let O;return d===void 0?O=u.getData(!0):O=u.getByRange(s._createCellCoords(d,m),s._createCellCoords(w,x),!0),O},this.getSourceDataAtCol=function(d){return u.getAtColumn(d)},this.setSourceDataAtCell=function(d,m,w,x){const O=he(d,m,w),H=this.hasHook("afterSetSourceDataAtCell"),K=[];H&&P(O,Q=>{let[ee,q,me]=Q;K.push([ee,q,u.getAtCell(ee,q),me])}),P(O,Q=>{let[ee,q,me]=Q;u.setAtCell(ee,q,me)}),H&&this.runHooks("afterSetSourceDataAtCell",K,x),this.render();const B=s.getActiveEditor();B&&fe(B.refreshValue)&&B.refreshValue()},this.getSourceDataAtRow=function(d){return u.getAtRow(d)},this.getSourceDataAtCell=function(d,m){return u.getAtCell(d,m)},this.getDataAtRow=function(d){return l.getRange(s._createCellCoords(d,0),s._createCellCoords(d,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(d,m,w,x){const O=d===void 0?[0,0,this.countRows(),this.countCols()]:[d,m,w,x],[H,K]=O;let[,,B,Q]=O,ee=null,q=null;B===void 0&&(B=H),Q===void 0&&(Q=K);let me="mixed";return Re(Math.max(Math.min(H,B),0),Math.max(H,B),He=>{let Pe=!0;return Re(Math.max(Math.min(K,Q),0),Math.max(K,Q),De=>(q=this.getCellMeta(He,De).type,ee?Pe=ee===q:ee=q,Pe)),me=Pe?q:"mixed",Pe}),me},this.removeCellMeta=function(d,m,w){const[x,O]=[this.toPhysicalRow(d),this.toPhysicalColumn(m)];let H=E.getCellMetaKeyValue(x,O,w);s.runHooks("beforeRemoveCellMeta",d,m,w,H)!==!1&&(E.removeCellMeta(x,O,w),s.runHooks("afterRemoveCellMeta",d,m,w,H)),H=null},this.spliceCellsMeta=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,x=new Array(w>2?w-2:0),O=2;O<w;O++)x[O-2]=arguments[O];if(x.length>0&&!Array.isArray(x[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&E.removeRow(this.toPhysicalRow(d),m),x.length>0&&P(x.reverse(),H=>{E.createRow(this.toPhysicalRow(d)),P(H,(K,B)=>this.setCellMetaObject(d,B,K))}),s.render()},this.setCellMetaObject=function(d,m,w){typeof w=="object"&&Ke(w,(x,O)=>{this.setCellMeta(d,m,O,x)})},this.setCellMeta=function(d,m,w,x){if(s.runHooks("beforeSetCellMeta",d,m,w,x)===!1)return;let H=d,K=m;d<this.countRows()&&(H=this.toPhysicalRow(d)),m<this.countCols()&&(K=this.toPhysicalColumn(m)),E.setCellMeta(H,K,w,x),s.runHooks("afterSetCellMeta",d,m,w,x)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(d,m){let w=this.toPhysicalRow(d),x=this.toPhysicalColumn(m);return w===null&&(w=d),x===null&&(x=m),E.getCellMeta(w,x,{visualRow:d,visualColumn:m})},this.getCellMetaAtRow=function(d){return E.getCellsMetaAtRow(d)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||v.columns)},this.getCellRenderer=function(d,m){const w=typeof d=="number"?s.getCellMeta(d,m).renderer:d.renderer;return typeof w=="string"?Ow(w):Tt(w)?Ow("text"):w},this.getCellEditor=function(d,m){const w=typeof d=="number"?s.getCellMeta(d,m).editor:d.editor;return typeof w=="string"?Mw(w):Tt(w)?Mw("text"):w},this.getCellValidator=function(d,m){const w=typeof d=="number"?s.getCellMeta(d,m).validator:d.validator;return typeof w=="string"?h1(w):w},this.validateCells=function(d){this._validateCells(d)},this.validateRows=function(d,m){if(!Array.isArray(d))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,d)},this.validateColumns=function(d,m){if(!Array.isArray(d))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,d)},this._validateCells=function(d,m,w){const x=new G;d&&(x.onQueueEmpty=d);let O=s.countRows()-1;for(;O>=0;){if(m!==void 0&&m.indexOf(O)===-1){O-=1;continue}let H=s.countCols()-1;for(;H>=0;){if(w!==void 0&&w.indexOf(H)===-1){H-=1;continue}x.addValidatorToQueue(),s.validateCell(s.getDataAtCell(O,H),s.getCellMeta(O,H),K=>{if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&(x.valid=!1),x.removeValidatorFormQueue()},"validateCells"),H-=1}O-=1}x.checkIfQueueIsEmpty()},this.getRowHeader=function(d){let m=v.rowHeaders,w=d;return w!==void 0&&(w=s.runHooks("modifyRowHeader",w)),w===void 0?(m=[],Re(s.countRows()-1,x=>{m.push(s.getRowHeader(x))})):Array.isArray(m)&&m[w]!==void 0?m=m[w]:Et(m)?m=m(w):m&&typeof m!="string"&&typeof m!="number"&&(m=w+1),m},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(v.colHeaders!==void 0&&v.colHeaders!==null)return!!v.colHeaders;for(let d=0,m=s.countCols();d<m;d++)if(s.getColHeader(d))return!0;return!1},this.getColHeader=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const w=s.runHooks("modifyColHeader",d);if(w===void 0){const B=[],Q=s.countCols();for(let ee=0;ee<Q;ee++)B.push(s.getColHeader(ee));return B}let x=v.colHeaders;const O=function(B){const Q=[],ee=s.countCols();let q=0;for(;q<ee;q++)Et(v.columns)&&v.columns(q)&&Q.push(q);return Q[B]},H=s.toPhysicalColumn(w),K=O(H);return v.colHeaders===!1?x=null:v.columns&&Et(v.columns)&&v.columns(K)&&v.columns(K).title?x=v.columns(K).title:v.columns&&v.columns[H]&&v.columns[H].title?x=v.columns[H].title:Array.isArray(v.colHeaders)&&v.colHeaders[H]!==void 0?x=v.colHeaders[H]:Et(v.colHeaders)?x=v.colHeaders(H):v.colHeaders&&typeof v.colHeaders!="string"&&typeof v.colHeaders!="number"&&(x=rC(w)),x=s.runHooks("modifyColumnHeaderValue",x,d,m),x},this._getColWidthFromSettings=function(d){let m;if(d>=0&&(m=s.getCellMeta(0,d).width),(m===void 0||m===v.width)&&(m=v.colWidths),m!=null){switch(typeof m){case"object":m=m[d];break;case"function":m=m(d);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(d){let m=s._getColWidthFromSettings(d);return m=s.runHooks("modifyColWidth",m,d),m===void 0&&(m=f1.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(d){let m=v.rowHeights;if(m!=null){switch(typeof m){case"object":m=m[d];break;case"function":m=m(d);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(d){let m=s._getRowHeightFromSettings(d);return m=s.runHooks("modifyRowHeight",m,d),m},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const d=v.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(d,m)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Pw(s.countRows()-1,w=>{if(s.isEmptyRow(w))m+=1;else if(d===!0)return!1}),m},this.countEmptyCols=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Pw(s.countCols()-1,w=>{if(s.isEmptyCol(w))m+=1;else if(d===!0)return!1}),m},this.isEmptyRow=function(d){return v.isEmptyRow.call(s,d)},this.isEmptyCol=function(d){return v.isEmptyCol.call(s,d)},this.selectCell=function(d,m,w,x){let O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,H=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Tt(d)||Tt(m)?!1:this.selectCells([[d,m,w,x]],O,H)},this.selectCells=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(o=!0);const x=A.selectCells(d);return x&&w&&s.listen(),o=!1,x},this.selectColumns=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,w=arguments.length>2?arguments[2]:void 0;return A.selectColumns(d,m,w)},this.selectRows=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,w=arguments.length>2?arguments[2]:void 0;return A.selectRows(d,m,w)},this.deselectCell=function(){A.deselect()},this.selectAll=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,w=arguments.length>2?arguments[2]:void 0;o=!0,A.selectAll(d,m,w),o=!1};const Ve=(d,m)=>d.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(d){var m;if(typeof d=="number"){var w;d={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(w=arguments[4])!==null&&w!==void 0?w:!0}}const{row:x,col:O,verticalSnap:H,horizontalSnap:K,considerHiddenIndexes:B}=(m=d)!==null&&m!==void 0?m:{};let Q,ee,q,me;H!==void 0&&(Q=H==="top",ee=!Q),K!==void 0&&(q=K==="start",me=!q);let He=x,Pe=O;if(B===void 0||B){const Qe=Number.isInteger(x)&&x>=0,Be=Number.isInteger(O)&&O>=0,Te=Qe?Ve(this.rowIndexMapper,x):void 0,Le=Be?Ve(this.columnIndexMapper,O):void 0;if(Te===null||Le===null)return!1;He=Qe?s.rowIndexMapper.getRenderableFromVisualIndex(Te):x,Pe=Be?s.columnIndexMapper.getRenderableFromVisualIndex(Le):O}const De=Number.isInteger(He),X=Number.isInteger(Pe);return De&&He>=0&&X&&Pe>=0?s.view.scrollViewport(s._createCellCoords(He,Pe),Q,me,ee,q):De&&He>=0&&(X&&Pe<0||!X)?s.view.scrollViewportVertically(He,Q,ee):X&&Pe>=0&&(De&&He<0||!De)?s.view.scrollViewportHorizontally(Pe,me,q):!1},this.scrollToFocusedCell=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",d);const{highlight:m}=this.getSelectedRangeLast();this.scrollViewportTo(m.toObject())?this.view.render():(this.removeHook("afterScroll",d),this._registerImmediate(()=>d()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),E.clearCache(),yS.delete(this.guid),_p(s)){const d=this.rootDocument.querySelector(".hot-display-license-info");d&&d.parentNode.removeChild(d)}so(s.rootElement),a.destroy(),h&&h.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),S.getItems().forEach(d=>{let[,m]=d;m.destroy()}),S.clear(),s.runHooks("afterDestroy")},!0),ve.getSingleton().destroy(s),Ke(s,(d,m,w)=>{Et(d)?w[m]=ke(m):m!=="guid"&&(w[m]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,A=null,h=null,s=null};function ke(d){return()=>{throw new Error(`The "${d}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getPlugin=function(d){const m=nr(d);return m==="UndoRedo"?this.undoRedo:S.getItem(m)},this.getPluginName=function(d){return d===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:S.getId(d)},this.getInstance=function(){return s},this.addHook=function(d,m){ve.getSingleton().add(d,m,s)},this.hasHook=function(d){return ve.getSingleton().has(d,s)||ve.getSingleton().has(d)},this.addHookOnce=function(d,m){ve.getSingleton().once(d,m,s)},this.removeHook=function(d,m){ve.getSingleton().remove(d,m,s)},this.runHooks=function(d,m,w,x,O,H,K){return ve.getSingleton().run(s,d,m,w,x,O,H,K)},this.getTranslatedPhrase=function(d,m){return sB(v.language,d,m)},this.toHTML=()=>yR(this),this.toTableElement=()=>{const d=this.rootDocument.createElement("div");return d.insertAdjacentHTML("afterbegin",yR(this)),d.firstElementChild},this.timeouts=[],this._registerTimeout=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=d;typeof w=="function"&&(w=setTimeout(w,m)),this.timeouts.push(w)},this._clearTimeouts=function(){P(this.timeouts,d=>{clearTimeout(d)})},this.immediates=[],this._registerImmediate=function(d){this.immediates.push(setImmediate(d))},this._clearImmediates=function(){P(this.immediates,d=>{clearImmediate(d)})},this._refreshBorders=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.destroyEditor(d),s.view.render(),m&&A.isSelected()&&h.prepareEditor()},this._getEditorManager=function(){return h},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const R=Toe({handleEvent(){return s.isListening()},beforeKeyDown:d=>this.runHooks("beforeKeyDown",d),afterKeyDown:d=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",d)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",d=>{d.ctrlKey===!1&&d.metaKey===!1&&R.releasePressedKeys()}),this.getShortcutManager=function(){return R},this.getFocusManager=function(){return f},c1().forEach(d=>{const m=og(d);S.addItem(d,new m(this))}),poe(s),R.setActiveContextName("grid"),ve.getSingleton().run(s,"construct")}const _oe="hooksRefRegisterer",TB={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){P(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ke(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Go(TB,"MIXIN_NAME",_oe,{writable:!1,enumerable:!1});const Moe=TB;function ki(t,e,n){return e=xoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xoe(t){var e=Poe(t,"string");return typeof e=="symbol"?e:String(e)}function Poe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ooe="base",pn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),kR="baseEditor";class fh{static get EDITOR_TYPE(){return Ooe}constructor(e){ki(this,"hot",void 0),ki(this,"state",pn.VIRGIN),ki(this,"_opened",!1),ki(this,"_fullEditMode",!1),ki(this,"_closeCallback",null),ki(this,"TD",null),ki(this,"row",null),ki(this,"col",null),ki(this,"prop",null),ki(this,"originalValue",null),ki(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=pn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const h=this.hot.getSelectedLast();r=Math.max(Math.min(h[0],h[2]),0),i=Math.max(Math.min(h[1],h[3]),0),o=Math.max(h[0],h[2]),s=Math.max(h[1],h[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>fe(this.hot.getSelected()),group:kR};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==pn.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=pn.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:Qt(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let i;if(r){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),r(l),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(kR),s.removeShortcutsByGroup(eC),this.state===pn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===pn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=pn.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=pn.FINISHED,this.discardEditor(l)}):(this.state=pn.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=pn.FINISHED,this.discardEditor()}discardEditor(e){this.state===pn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=pn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=pn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===pn.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=cn(n),a=wt(n),l=cn(this.hot.rootElement),u=wt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,f=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,p=o.innerWidth-l.left-u,{wtTable:y}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,E=y.name,v=["master","inline_start"].includes(E)?f:0,C=["master","top","bottom"].includes(E)?g:0,S=s.top===l.top?0:1;let T=s.top-l.top-S-v,_=0;this.hot.isRtl()?_=o.innerWidth-s.left-a-p-1+C:_=s.left-l.left-1-C,["top","top_inline_start_corner"].includes(E)&&(T+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(E)&&(_+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const A=this.hot.hasColHeaders(),D=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),U=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),G=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(A&&D<=0||D===G)&&(T+=1),U<=0&&(_+=1);const Z=i.rowsRenderCalculator.startPosition,re=i.columnsRenderCalculator.startPosition,ne=Math.abs(r.inlineStartOverlay.getScrollPosition()),he=r.topOverlay.getScrollPosition(),Me=Tn(this.hot.rootDocument);let Ve=n.offsetTop;if(["inline_start","master"].includes(E)&&(Ve+=Z-he),["bottom","bottom_inline_start_corner"].includes(E)){const{wtViewport:ee,wtTable:q}=r.bottomOverlay.clone;Ve+=ee.getWorkspaceHeight()-q.getHeight()-Me}let ke=n.offsetLeft;this.hot.isRtl()?(ke>=0?ke=y.getWidth()-n.offsetLeft:ke=Math.abs(ke),ke+=re-ne-a):["top","master","bottom"].includes(E)&&(ke+=re-ne);const R=ks(this.TD,this.hot.rootWindow),d=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",m=parseInt(R[d],10)>0?0:1,w=parseInt(R.borderTopWidth,10)>0?0:1,x=wt(n)+m,O=Bt(n)+w,H=DV(c)?Me:0,K=NV(h)?Me:0,B=this.hot.view.maximumVisibleElementWidth(ke)-H+m,Q=Math.max(this.hot.view.maximumVisibleElementHeight(Ve)-K+w,23);return{top:T,start:_,height:O,maxHeight:Q,width:x,maxWidth:B}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}St(fh,Moe);function $A(t,e,n){t.addEventListener(e,n,!1)}function FA(t,e,n){t.removeEventListener(e,n,!1)}function WA(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function Aoe(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,r=t.createTextNode(""),i=t.createElement("span");let o;function s(){r.textContent=o.value,i.style.position="absolute",i.style.fontSize=WA(o).fontSize,i.style.fontFamily=WA(o).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const c=i.clientWidth+2;n.removeChild(i);const h=o.style;h.height=`${e.minHeight}px`,e.minWidth>c?h.width=`${e.minWidth}px`:c>e.maxWidth?h.width=`${e.maxWidth}px`:h.width=`${c}px`;const f=o.scrollHeight?o.scrollHeight-1:0;e.minHeight>f?h.height=`${e.minHeight}px`:e.maxHeight<f?(h.height=`${e.maxHeight}px`,h.overflowY="visible"):h.height=`${f}px`}function a(){t.defaultView.setTimeout(s,0)}function l(c){if(c&&c.minHeight)if(c.minHeight==="inherit")e.minHeight=o.clientHeight;else{const h=parseInt(c.minHeight,10);isNaN(h)||(e.minHeight=h)}if(c&&c.maxHeight)if(c.maxHeight==="inherit")e.maxHeight=o.clientHeight;else{const h=parseInt(c.maxHeight,10);isNaN(h)||(e.maxHeight=h)}if(c&&c.minWidth)if(c.minWidth==="inherit")e.minWidth=o.clientWidth;else{const h=parseInt(c.minWidth,10);isNaN(h)||(e.minWidth=h)}if(c&&c.maxWidth)if(c.maxWidth==="inherit")e.maxWidth=o.clientWidth;else{const h=parseInt(c.maxWidth,10);isNaN(h)||(e.maxWidth=h)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}function u(c,h){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=c,l(h),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.overflowY="",o.style.height=`${e.minHeight}px`,o.style.minWidth=`${e.minWidth}px`,o.style.maxWidth=`${e.maxWidth}px`,o.style.overflowY="hidden"),f&&($A(o,"input",s),$A(o,"keydown",a)),s()}return{init:u,resize:s,unObserve(){FA(o,"input",s),FA(o,"keydown",a)}}}function VA(t,e){const n=qT(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}tg(e,i)}function ul(t,e,n){return e=Ioe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ioe(t){var e=Hoe(t,"string");return typeof e=="symbol"?e:String(e)}function Hoe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Doe="ht_editor_visible",fm="ht_editor_hidden",BA="textEditor",Noe="text";class mu extends fh{static get EDITOR_TYPE(){return Noe}constructor(e){super(e),ul(this,"eventManager",new ri(this)),ul(this,"autoResize",Aoe(this.hot.rootDocument)),ul(this,"TEXTAREA",void 0),ul(this,"textareaStyle",void 0),ul(this,"TEXTAREA_PARENT",void 0),ul(this,"textareaParentStyle",void 0),ul(this,"layerClass",void 0),this.eventManager=new ri(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),MV(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&(this.TEXTAREA.value=""),a!==pn.FINISHED&&this.hideEditableElement()}}beginEditing(e,n){this.state===pn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),tg(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ae(this.TEXTAREA,[["data-hot-input",""],uh(-1)]),this.hot.getSettings().ariaTags&&Ae(this.TEXTAREA,[Us()]),te(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),te(this.TEXTAREA_PARENT,"handsontableInputHolder"),$e(this.TEXTAREA_PARENT,this.layerClass)&&We(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,fm),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){XV()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",We(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,fm)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;Re(e.length-1,r=>{const i=e[r];if($e(i,"handsontableEditor"))return n=!0,!1}),$e(this.TEXTAREA_PARENT,fm)&&We(this.TEXTAREA_PARENT,fm),n?(this.layerClass=Doe,te(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),te(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==pn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=ks(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=ks(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),h=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),f=i-c,g=s-h,p=o-c,y=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(f,p),minHeight:Math.min(g,y),maxWidth:p,maxHeight:y},!0)}bindEvents(){r1()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===pn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===pn.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("editor"),r=e.getContext("grid"),i={runOnlyIf:()=>fe(this.hot.getSelected()),group:BA},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:r,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["Home"]],callback:(s,a)=>{let[l]=a;VA(l,this.TEXTAREA)}},{keys:[["End"]],callback:(s,a)=>{let[l]=a;VA(l,this.TEXTAREA)}}],i)}unregisterShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");n.removeShortcutsByGroup(eC),n.removeShortcutsByGroup(BA),n.removeShortcutsByGroup(kR)}}const koe="base";function ug(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&te(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(SO())):a&&c.push(SO()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(bO())):(u.push(s.invalidCellClassName),a&&c.push(bO()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),We(e,u),te(e,l),du(e,c),Ae(e,h)}ug.RENDERER_TYPE=koe;const Loe="text";function Ys(t,e,n,r,i,o,s){ug.apply(this,[t,e,n,r,i,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Qt(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){so(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else za(e,a)}Ys.RENDERER_TYPE=Loe;const $oe="text",_B={CELL_TYPE:$oe,editor:mu,renderer:Ys};di(_B);le.editors={BaseEditor:fh};function le(t,e){const n=new EB(t,e||{},I1);return n.init(),n}le.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new EB(t,e,I1)};le.DefaultSettings=wB();le.hooks=ve.getSingleton();le.CellCoords=Iw;le.CellRange=p1;le.packageName="handsontable";le.buildDate="30/11/2023 09:47:48";le.version="14.0.0";le.languages={dictionaryKeys:rre,getLanguageDictionary:oB,getLanguagesDictionaries:lre,registerLanguageDictionary:iB,getTranslatedPhrase:sB};function UA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Foe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?UA(Object(n),!0).forEach(function(r){Woe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):UA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Af(t){"@babel/helpers - typeof";return Af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Af(t)}function Jc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zA(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,xB(r.key),r)}}function eh(t,e,n){return e&&zA(t.prototype,e),n&&zA(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Woe(t,e,n){return e=xB(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function If(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&LR(t,e)}function Lw(t){return Lw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Lw(t)}function LR(t,e){return LR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},LR(t,e)}function Voe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function MB(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Boe(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MB(t)}function Hf(t){var e=Voe();return function(){var r=Lw(t),i;if(e){var o=Lw(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return Boe(this,i)}}function Uoe(t){return zoe(t)||Goe(t)||joe(t)||Yoe()}function zoe(t){if(Array.isArray(t))return $R(t)}function Goe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function joe(t,e){if(t){if(typeof t=="string")return $R(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $R(t,e)}}function $R(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Yoe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Koe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xB(t){var e=Koe(t,"string");return typeof e=="symbol"?e:String(e)}var SS=null,Xoe="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",qoe="The Handsontable instance bound to this component was destroyed and cannot be used properly.",$w="global",Qoe="hot-wrapper-editor-container";function Zoe(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function FR(t,e){var n=wn.Children.toArray(t),r=wn.Children.count(t),i=null;return r!==0&&(r===1&&n[0].props[e]?i=n[0]:i=n.find(function(o){return o.props[e]!==void 0})),i||null}function PB(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function OB(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=arguments.length>1?arguments[1]:void 0;if(e===null)return null;var n=IB(e.props,!1);return n.className="".concat(Qoe," ").concat(n.className),PF.createPortal(wn.createElement("div",Object.assign({},n),e),t.body)}function AB(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$w,r=FR(t,"hot-editor"),i=PB(r);return r?wn.cloneElement(r,{emitEditorInstance:function(s,a){e.get(i)||e.set(i,new Map);var l=e.get(i);l.set(a??$w,s)},editorColumnScope:n,isEditor:!0}):null}function Joe(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;n||(n=document),SS||(SS=n.createDocumentFragment());var r=n.createElement("DIV");SS.appendChild(r);var i=wn.cloneElement(t,Foe({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:PF.createPortal(i,r,"".concat(e.row,"-").concat(e.col,"-").concat(Math.random())),portalContainer:r}}function IB(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}var HB=function(){function t(){Jc(this,t)}return eh(t,null,[{key:"getSettings",value:function(n){var r={};if(n.settings){var i=n.settings;for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])}for(var s in n)s!=="settings"&&s!=="children"&&n.hasOwnProperty(s)&&(r[s]=n[s]);return r}}]),t}(),la=function(t){If(n,t);var e=Hf(n);function n(){return Jc(this,n),e.apply(this,arguments)}return eh(n,[{key:"getSettingsProps",value:function(){var i=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(o){return!i.internalProps.includes(o)}).reduce(function(o,s){return o[s]=i.props[s],o},{})}},{key:"getLocalEditorElement",value:function(){return AB(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var i=this.props._getChildElementByType(this.props.children,"hot-renderer"),o=this.getLocalEditorElement();this.columnSettings=HB.getSettings(this.getSettingsProps()),i!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(i),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),o!==null&&(this.columnSettings.editor=this.props._getEditorClass(o,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var i=this.props._getOwnerDocument(),o=OB(i,this.getLocalEditorElement());return wn.createElement(wn.Fragment,null,o)}}]),n}(wn.Component),ese=function(t){If(n,t);var e=Hf(n);function n(){var r;return Jc(this,n),r=e.apply(this,arguments),r.state={portals:[]},r}return eh(n,[{key:"render",value:function(){return wn.createElement(wn.Fragment,null,this.state.portals)}}]),n}(wn.Component),tse="14.0.0";function fM(t,e){return e={exports:{}},t(e,e.exports),e.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dn=typeof Symbol=="function"&&Symbol.for,gM=Dn?Symbol.for("react.element"):60103,mM=Dn?Symbol.for("react.portal"):60106,hC=Dn?Symbol.for("react.fragment"):60107,dC=Dn?Symbol.for("react.strict_mode"):60108,fC=Dn?Symbol.for("react.profiler"):60114,gC=Dn?Symbol.for("react.provider"):60109,mC=Dn?Symbol.for("react.context"):60110,pM=Dn?Symbol.for("react.async_mode"):60111,pC=Dn?Symbol.for("react.concurrent_mode"):60111,wC=Dn?Symbol.for("react.forward_ref"):60112,vC=Dn?Symbol.for("react.suspense"):60113,nse=Dn?Symbol.for("react.suspense_list"):60120,CC=Dn?Symbol.for("react.memo"):60115,yC=Dn?Symbol.for("react.lazy"):60116,rse=Dn?Symbol.for("react.block"):60121,ise=Dn?Symbol.for("react.fundamental"):60117,ose=Dn?Symbol.for("react.responder"):60118,sse=Dn?Symbol.for("react.scope"):60119;function ai(t){if(Af(t)==="object"&&t!==null){var e=t.$$typeof;switch(e){case gM:switch(t=t.type,t){case pM:case pC:case hC:case fC:case dC:case vC:return t;default:switch(t=t&&t.$$typeof,t){case mC:case wC:case yC:case CC:case gC:return t;default:return e}}case mM:return e}}}function DB(t){return ai(t)===pC}var ase=pM,lse=pC,use=mC,cse=gC,hse=gM,dse=wC,fse=hC,gse=yC,mse=CC,pse=mM,wse=fC,vse=dC,Cse=vC,yse=function(e){return DB(e)||ai(e)===pM},Sse=DB,bse=function(e){return ai(e)===mC},Rse=function(e){return ai(e)===gC},Ese=function(e){return Af(e)==="object"&&e!==null&&e.$$typeof===gM},Tse=function(e){return ai(e)===wC},_se=function(e){return ai(e)===hC},Mse=function(e){return ai(e)===yC},xse=function(e){return ai(e)===CC},Pse=function(e){return ai(e)===mM},Ose=function(e){return ai(e)===fC},Ase=function(e){return ai(e)===dC},Ise=function(e){return ai(e)===vC},Hse=function(e){return typeof e=="string"||typeof e=="function"||e===hC||e===pC||e===fC||e===dC||e===vC||e===nse||Af(e)==="object"&&e!==null&&(e.$$typeof===yC||e.$$typeof===CC||e.$$typeof===gC||e.$$typeof===mC||e.$$typeof===wC||e.$$typeof===ise||e.$$typeof===ose||e.$$typeof===sse||e.$$typeof===rse)},Dse=ai,Nse={AsyncMode:ase,ConcurrentMode:lse,ContextConsumer:use,ContextProvider:cse,Element:hse,ForwardRef:dse,Fragment:fse,Lazy:gse,Memo:mse,Portal:pse,Profiler:wse,StrictMode:vse,Suspense:Cse,isAsyncMode:yse,isConcurrentMode:Sse,isContextConsumer:bse,isContextProvider:Rse,isElement:Ese,isForwardRef:Tse,isFragment:_se,isLazy:Mse,isMemo:xse,isPortal:Pse,isProfiler:Ose,isStrictMode:Ase,isSuspense:Ise,isValidElementType:Hse,typeOf:Dse},bt=fM(function(t,e){});bt.AsyncMode;bt.ConcurrentMode;bt.ContextConsumer;bt.ContextProvider;bt.Element;bt.ForwardRef;bt.Fragment;bt.Lazy;bt.Memo;bt.Portal;bt.Profiler;bt.StrictMode;bt.Suspense;bt.isAsyncMode;bt.isConcurrentMode;bt.isContextConsumer;bt.isContextProvider;bt.isElement;bt.isForwardRef;bt.isFragment;bt.isLazy;bt.isMemo;bt.isPortal;bt.isProfiler;bt.isStrictMode;bt.isSuspense;bt.isValidElementType;bt.typeOf;fM(function(t){t.exports=Nse});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var GA=Object.getOwnPropertySymbols,kse=Object.prototype.hasOwnProperty,Lse=Object.prototype.propertyIsEnumerable;function $se(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function Fse(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(e).map(function(o){return e[o]});if(r.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(o){i[o]=o}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}Fse();var Wse="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Vse=Wse;Function.call.bind(Object.prototype.hasOwnProperty);function NB(){}function kB(){}kB.resetWarningCache=NB;var Bse=function(){function e(i,o,s,a,l,u){if(u!==Vse){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function n(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:n,element:e,elementType:e,instanceOf:n,node:e,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:kB,resetWarningCache:NB};return r.PropTypes=r,r},Use=fM(function(t){t.exports=Bse()}),bS=Use,LB=function(t){If(n,t);var e=Hf(n);function n(){var r;return Jc(this,n),r=e.apply(this,arguments),r.id=null,r.__hotInstance=null,r.hotElementRef=null,r.columnSettings=[],r.renderersPortalManager=null,r.portalCacheArray=[],r.renderedCellCache=new Map,r.editorCache=new Map,r.componentRendererColumns=new Map,r}return eh(n,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(qoe),null)},set:function(i){this.__hotInstance=i}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(i){this.hotElementRef=i}},{key:"getRendererWrapper",value:function(i){var o=this;return function(s,a,l,u,c,h,f){var g=o.getRenderedCellCache();if(g.has("".concat(l,"-").concat(u))&&(a.innerHTML=g.get("".concat(l,"-").concat(u)).innerHTML),a&&!a.getAttribute("ghost-table")){for(var p=Joe(i,{TD:a,row:l,col:u,prop:c,value:h,cellProperties:f,isRenderer:!0},a.ownerDocument),y=p.portal,E=p.portalContainer;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(E),o.portalCacheArray.push(y)}return g.set("".concat(l,"-").concat(u),a),a}}},{key:"getEditorClass",value:function(i){var o,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$w,a=PB(i),l=(o=this.getEditorCache().get(a))===null||o===void 0?void 0:o.get(s);return this.makeEditorClass(l)}},{key:"makeEditorClass",value:function(i){var o=function(s){If(l,s);var a=Hf(l);function l(u){var c;return Jc(this,l),c=a.call(this,u),i.hotCustomEditorInstance=MB(c),c.editorComponent=i,c}return eh(l,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),l}(le.editors.BaseEditor);return Object.getOwnPropertyNames(le.editors.BaseEditor.prototype).forEach(function(s){s!=="constructor"&&(o.prototype[s]=function(){for(var a,l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];return(a=i[s]).call.apply(a,[i].concat(u))})}),o}},{key:"getGlobalRendererElement",value:function(){return FR(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return AB(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var i=HB.getSettings(this.props),o=this.getGlobalRendererElement(),s=this.getGlobalEditorElement();return i.columns=this.columnSettings.length?this.columnSettings:i.columns,s?i.editor=this.getEditorClass(s,$w):i.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),o?(i.renderer=this.getRendererWrapper(o),this.componentRendererColumns.set("global",!0)):i.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),i}},{key:"displayAutoSizeWarning",value:function(i){var o,s;this.hotInstance&&((o=this.hotInstance.getPlugin("autoRowSize"))!==null&&o!==void 0&&o.enabled||(s=this.hotInstance.getPlugin("autoColumnSize"))!==null&&s!==void 0&&s.enabled)&&this.componentRendererColumns.size>0&&Zoe(Xoe)}},{key:"setHotColumnSettings",value:function(i,o){this.columnSettings[o]=i}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var i=this;this.renderersPortalManager.setState({portals:Uoe(this.portalCacheArray)},function(){i.portalCacheArray=[]})}},{key:"updateHot",value:function(i){this.hotInstance&&this.hotInstance.updateSettings(i,!1)}},{key:"setRenderersPortalManagerRef",value:function(i){this.renderersPortalManager=i}},{key:"componentDidMount",value:function(){var i=this,o=this.createNewGlobalSettings();this.hotInstance=new le.Core(this.hotElementRef,o),this.hotInstance.addHook("beforeViewRender",function(){return i.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return i.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(o)}},{key:"componentDidUpdate",value:function(){this.clearCache();var i=this.createNewGlobalSettings();this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var i=this,o=IB(this.props),s=function(h){return h.type===la},a=wn.Children.toArray(this.props.children),l=a.filter(function(c){return s(c)}).map(function(c,h){return wn.cloneElement(c,{_componentRendererColumns:i.componentRendererColumns,_emitColumnSettings:i.setHotColumnSettings.bind(i),_columnIndex:h,_getChildElementByType:FR.bind(i),_getRendererWrapper:i.getRendererWrapper.bind(i),_getEditorClass:i.getEditorClass.bind(i),_getOwnerDocument:i.getOwnerDocument.bind(i),_getEditorCache:i.getEditorCache.bind(i),children:c.props.children})}),u=OB(this.getOwnerDocument(),this.getGlobalEditorElement());return wn.createElement(wn.Fragment,null,wn.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},o),l),wn.createElement(ese,{ref:this.setRenderersPortalManagerRef.bind(this)}),u)}}],[{key:"version",get:function(){return tse}}]),n}(wn.Component);LB.propTypes={style:bS.object,id:bS.string,className:bS.string};wn.Component;var wM={exports:{}};wM.exports;(function(t){(function(e,n,r){function i(l){var u=this,c=a();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function s(l,u){var c=new i(l),h=u&&u.state,f=c.next;return f.int32=function(){return c.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,h&&(typeof h=="object"&&o(h,c),f.state=function(){return o(c,{})}),f}function a(){var l=4022871197,u=function(c){c=String(c);for(var h=0;h<c.length;h++){l+=c.charCodeAt(h);var f=.02519603282416938*l;l=f>>>0,f-=l,f*=l,l=f>>>0,f-=l,l+=f*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.alea=s})(Zi,t,!1)})(wM);var zse=wM.exports,vM={exports:{}};vM.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,p=(f+g)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xor128=s})(Zi,t,!1)})(vM);var Gse=vM.exports,CM={exports:{}};CM.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,p=(f+g)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xorwow=s})(Zi,t,!1)})(CM);var jse=CM.exports,yM={exports:{}};yM.exports;(function(t){(function(e,n,r){function i(a){var l=this;l.next=function(){var c=l.x,h=l.i,f,g;return f=c[h],f^=f>>>7,g=f^f<<24,f=c[h+1&7],g^=f^f>>>10,f=c[h+3&7],g^=f^f>>>3,f=c[h+4&7],g^=f^f<<7,f=c[h+7&7],f=f^f<<13,g^=f^f<<9,c[h]=g,l.i=h+1&7,g};function u(c,h){var f,g=[];if(h===(h|0))g[0]=h;else for(h=""+h,f=0;f<h.length;++f)g[f&7]=g[f&7]<<15^h.charCodeAt(f)+g[f+1&7]<<13;for(;g.length<8;)g.push(0);for(f=0;f<8&&g[f]===0;++f);for(f==8?g[7]=-1:g[f],c.x=g,c.i=0,f=256;f>0;--f)c.next()}u(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function s(a,l){a==null&&(a=+new Date);var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,p=(f+g)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(c.x&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xorshift7=s})(Zi,t,!1)})(yM);var Yse=yM.exports,SM={exports:{}};SM.exports;(function(t){(function(e,n,r){function i(a){var l=this;l.next=function(){var c=l.w,h=l.X,f=l.i,g,p;return l.w=c=c+1640531527|0,p=h[f+34&127],g=h[f=f+1&127],p^=p<<13,g^=g<<17,p^=p>>>15,g^=g>>>12,p=h[f]=p^g,l.i=f,p+(c^c>>>16)|0};function u(c,h){var f,g,p,y,E,v=[],C=128;for(h===(h|0)?(g=h,h=null):(h=h+"\0",g=0,C=Math.max(C,h.length)),p=0,y=-32;y<C;++y)h&&(g^=h.charCodeAt((y+32)%h.length)),y===0&&(E=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,y>=0&&(E=E+1640531527|0,f=v[y&127]^=g+E,p=f==0?p+1:0);for(p>=128&&(v[(h&&h.length||0)&127]=-1),p=127,y=4*128;y>0;--y)g=v[p+34&127],f=v[p=p+1&127],g^=g<<13,f^=f<<17,g^=g>>>15,f^=f>>>12,v[p]=g^f;c.w=E,c.X=v,c.i=p}u(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function s(a,l){a==null&&(a=+new Date);var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,p=(f+g)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(c.X&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xor4096=s})(Zi,t,!1)})(SM);var Kse=SM.exports,bM={exports:{}};bM.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.next=function(){var h=l.b,f=l.c,g=l.d,p=l.a;return h=h<<25^h>>>7^f,f=f-g|0,g=g<<24^g>>>8^p,p=p-h|0,l.b=h=h<<20^h>>>12^f,l.c=f=f-g|0,l.d=g<<16^f>>>16^p,l.a=p-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,p=(f+g)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.tychei=s})(Zi,t,!1)})(bM);var Xse=bM.exports,$B={exports:{}};const qse={},Qse=Object.freeze(Object.defineProperty({__proto__:null,default:qse},Symbol.toStringTag,{value:"Module"})),Zse=gL(Qse);(function(t){(function(e,n,r){var i=256,o=6,s=52,a="random",l=r.pow(i,o),u=r.pow(2,s),c=u*2,h=i-1,f;function g(T,_,A){var D=[];_=_==!0?{entropy:!0}:_||{};var U=v(E(_.entropy?[T,S(n)]:T??C(),3),D),z=new p(D),G=function(){for(var Z=z.g(o),re=l,ne=0;Z<u;)Z=(Z+ne)*i,re*=i,ne=z.g(1);for(;Z>=c;)Z/=2,re/=2,ne>>>=1;return(Z+ne)/re};return G.int32=function(){return z.g(4)|0},G.quick=function(){return z.g(4)/4294967296},G.double=G,v(S(z.S),n),(_.pass||A||function(Z,re,ne,he){return he&&(he.S&&y(he,z),Z.state=function(){return y(z,{})}),ne?(r[a]=Z,re):Z})(G,U,"global"in _?_.global:this==r,_.state)}function p(T){var _,A=T.length,D=this,U=0,z=D.i=D.j=0,G=D.S=[];for(A||(T=[A++]);U<i;)G[U]=U++;for(U=0;U<i;U++)G[U]=G[z=h&z+T[U%A]+(_=G[U])],G[z]=_;(D.g=function(Z){for(var re,ne=0,he=D.i,Me=D.j,Ve=D.S;Z--;)re=Ve[he=h&he+1],ne=ne*i+Ve[h&(Ve[he]=Ve[Me=h&Me+re])+(Ve[Me]=re)];return D.i=he,D.j=Me,ne})(i)}function y(T,_){return _.i=T.i,_.j=T.j,_.S=T.S.slice(),_}function E(T,_){var A=[],D=typeof T,U;if(_&&D=="object")for(U in T)try{A.push(E(T[U],_-1))}catch{}return A.length?A:D=="string"?T:T+"\0"}function v(T,_){for(var A=T+"",D,U=0;U<A.length;)_[h&U]=h&(D^=_[h&U]*19)+A.charCodeAt(U++);return S(_)}function C(){try{var T;return f&&(T=f.randomBytes)?T=T(i):(T=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(T)),S(T)}catch{var _=e.navigator,A=_&&_.plugins;return[+new Date,e,A,e.screen,S(n)]}}function S(T){return String.fromCharCode.apply(0,T)}if(v(r.random(),n),t.exports){t.exports=g;try{f=Zse}catch{}}else r["seed"+a]=g})(typeof self<"u"?self:Zi,[],Math)})($B);var Jse=$B.exports,eae=zse,tae=Gse,nae=jse,rae=Yse,iae=Kse,oae=Xse,pu=Jse;pu.alea=eae;pu.xor128=tae;pu.xorwow=nae;pu.xorshift7=rae;pu.xor4096=iae;pu.tychei=oae;var sae=pu;const FB=Vf(sae);let WB=FB();function VB(){return WB()}function aae(t){WB=FB(t)}function wu(t,e){let n=t;if(Array.isArray(t)){let r=t;e!=null&&e.maxCharCount&&typeof t[0]=="string"&&(r=t.filter(i=>i.length<=e.maxCharCount)),n=()=>BB(r)}return(e==null?void 0:e.length)===void 0?n(0):Array.from({length:e.length},(r,i)=>n(i))}function BB(t){return t[Math.floor(VB()*t.length)]}function lae({min:t=1,max:e=9999.99,fraction:n=0}={}){if(e<t)throw new Error("Max must be bigger than min");return Number((VB()*(e-t)+t).toFixed(n))}function jA(t){return wu(()=>BB([!0,!1]),t)}function us(t){const e={min:(t==null?void 0:t.min)??0,max:(t==null?void 0:t.max)??999999,precision:t==null?void 0:t.precision,fraction:t==null?void 0:t.fraction};return wu(()=>{if(e.min===e.max)return e.min;const n=lae(e);return e.precision!==void 0?Math.floor(n/e.precision)*e.precision:n},t)}function uae(t){const e=new Date(t.from).getTime(),n=new Date(t.to).getTime();if(e>=n)throw new Error("From must be before to");return wu(()=>new Date(us({min:e,max:n})),t)}var cae=["Kautzer, Macejkovic and Fisher","Greenholt - Mosciski","Marquardt - Runolfsdottir","Abernathy Inc","Dickens - Lang","Hand, Bernhard and Kessler","Abbott LLC","Kub Inc","Johnston - Wisozk","Reichert LLC","Kohler LLC","Shanahan - Boyle","Batz - Rice","Cronin, Oberbrunner and Beier","Kuhlman, Schowalter and West","Luettgen Inc","Ward Group","Hills and Sons","Prohaska, Balistreri and Walker","Rempel - Durgan","Bernier LLC","Stehr - Lockman","Roberts, Rogahn and Dooley","Lesch - Jakubowski","Jenkins - Turcotte","Gerhold - Rowe","Block - Rau","Dickinson, Tremblay and Moore","Nader - Fritsch","Kreiger and Sons","Bartell, Wehner and Schowalter","Hegmann Inc","Orn, Spencer and Kiehn","Graham, Sipes and Towne","Hodkiewicz Inc","Mills Group","Legros, Tillman and Hodkiewicz","Lesch - Carter","Lesch Group","Kreiger - Sauer","Cartwright - Schuster","Labadie LLC","Pfannerstill, White and Mosciski","Jenkins LLC","Boehm, Hettinger and Huels","Maggio, Wisoky and Blick","Kozey Inc","Stracke - Wisozk","Olson, Olson and Carter","Orn, Gerlach and Runolfsdottir","Stracke - Kertzmann","Walker - Zieme","Hodkiewicz - Hintz","Lind Group","Fahey, Leannon and Gleichner","Mertz, Gusikowski and Lemke","Heidenreich - Aufderhar","Zboncak and Sons","Carroll Group","Brown LLC","Weber Inc","Rath LLC","Walker Inc","Heller, Hyatt and Jaskolski","Jacobi - Kutch","Skiles and Sons","Durgan - Stamm","Renner - Prosacco","Hahn - Welch","Lesch, Dooley and Bartell","Crona and Sons","Rogahn, Armstrong and Goyette","Lubowitz, Kuhlman and Bailey","Doyle Group","Dooley and Sons","Kerluke LLC","Bogan - Daniel","Hintz - Boehm","Swaniawski and Sons","Kris, Legros and Cartwright","Reichel Group","Russel - Hintz","Welch, Lockman and Hand","Pouros - Brakus","Mohr, Fritsch and Wisozk","Upton - Reichert","Koepp and Sons","Weber and Sons","Quigley, Bins and Becker","Strosin, Oberbrunner and Wunsch","Rodriguez - Spencer","Wilkinson - Dare","Gutkowski Inc","OReilly LLC","Collins, Mante and Pacocha","Steuber, Luettgen and Corkery","Kub and Sons","Lesch and Sons"];function YA(t){return wu(cae,t)}var hae=["Argentina","Peru","Colombia","Chile","Uruguay","Gabon","Congo","Norfolk Island","Qatar","Syrian Arab Republic","Wallis and Futuna","Somalia","Saint Barthelemy","Comoros","Sri Lanka","Czech Republic","Christmas Island","Macao","Montenegro","Anguilla","Canada","Mayotte","Tajikistan","Afghanistan","Liechtenstein","Cocos (Keeling) Islands","Angola","Bahrain","Dominican Republic","Croatia","Latvia","Virgin Islands, U.S.","United Kingdom","Brazil","Spain","Mongolia","Montserrat","Estonia","Benin","Guinea","Guinea-Bissau","Greece","Lao Peoples Democratic Republic","Puerto Rico","Slovakia (Slovak Republic)","United States of America","Switzerland","Costa Rica","Mauritius","Nigeria","Russian Federation","Germany","Antigua and Barbuda","Albania","Romania","Moldova","Senegal","Tanzania","British Indian Ocean Territory (Chagos Archipelago)","Central African Republic","New Caledonia","Burundi","Panama","Azerbaijan","Namibia","French Southern Territories","Vanuatu","Ethiopia","Burkina Faso","Tunisia","Mozambique","Belarus","Saint Kitts and Nevis","Hungary","Indonesia","Cyprus","Ecuador","Saint Martin","Nauru","Faroe Islands","Iran","Bolivia","Pitcairn Islands","France","Paraguay","Isle of Man","Sierra Leone","Monaco","Belize","Trinidad and Tobago"];function dae(t){return wu(hae,t)}var fae={china:["Peking roasted duck","Kung pao chicken","Sweet and sour pork","Hot pot","Dim sum","Dumplings","Ma po tofu","Char siu","Chicken chow mein","Beef chow mein","vegetable chow mein","Chicken fried rice","Beef fried rice","Vegetable fried Rice","Special fried Rice","Sichuan pork","Xiaolongbao","Zhajiangmian","Wonton soup","Sweet and sour pork","Duck spring Rolls","Vegetable spring Rolls","Wonton","Peking duck","Lamb hot pot","Spicy crayfish","Guilin rice noodles","Lanzhou hand-pulled noodles","Steamed crab","Shredded pork with garlic sauce","Red braised pork","Sweet and sour Ribs","Xinjiang","Braised pork with vermicelli"],italy:["Butternut squash risotto","Mushroom risotto","Beetroot risotto","Courgette risotto","Pizza","Gnocchi","Spaghetti bolognese","Spaghetti carbonara","Pesto alla Genovese","Beef lasagne","Vegetable lasagne","Gelato","Prosciutto di Parma","Ribollita","Bagna cauda","Polenta","Tortelli and ravioli","Focaccia","Garlic bread","Arancini","Il tartufo","Panzerotto fritto","Fiorentina","Minestrone","Frico","Arrosticini","Olive ascolante","Fritto misto piemontes","Tiramisù"],india:["Biryani","Dosa","Tandoori chicken","Samosas","Chaat","Plain naan","Garlic naan","Pilau rice","Steamed rice","Chicken madras","Vegetable madras","Chicken vindaloo","Chicken jalfrezi","Chicken roghan josh","Lamb roghan josh","Beef roghan josh","Butter chicken","Dosa","Gulab jamun","Chicken korma","Mutter paneer","Papadum","Paratha","Raita","Saag paneer","Tandoori chicken","Chicken tikka masala","Pakora","Dal","Chapati","Pasanda","Aloo gobi","Kofta","Chicken makhani","Paneer naan","Chana Aloo Curry"],mexico:["Chilaquiles","Pozole","Tacos al pastor","Tostadas","Chiles en nogada","Elote","Enchiladas","Mole","Guacamole","Tamales","Huevos rancheros","Machaca","Discada","Beef Burrito","Chicken Burrito","Pozole de pollo o duajolote","Menudo","Cochinita pibil","Tamale","Quesadilla","Frijoles puercos","Chile en nogada","Esquites","Alegria de amaranto","Pipián","Aguachile","Ceviche","Pescado zarandeado","Camarones a la diabla","Birria de chivo","Tlayuda","Guacamole con chapulines","Flautas","Torta Ahogada","Carnitas","Caldo Azteca","Gorditas de Nata"],japan:["Sushi","Udon","Tofu","Tempura","Yakitori","Sashimi","Ramen","Donburi","Natto","Oden","Tamagoyaki","Soba","Tonkatsu","Kashipan","Sukiyaki","Miso soup","Okonomiyaki","Mentaiko","Nikujaga","Unagi no kabayaki","Shabu Shabu","Onigiri","Gyoza","Takoyaki","aiseki ryori","Edamame","Yakisoba","Chawanmushi","Wagashi"],france:["Foie gras","Huîtres","Cassoulet","Poulet basquaise","Escargots au beurre persillé","Mouclade charentaise","Galettes bretonnes","Flemish carbonnade","Quiche lorraine","Raclette","Cheese fondue","Beef fondue","Gratin dauphinois","Tartiflette","Bouillabaisse","Ratatouille","Boeuf bourguignon","Blanquette de veau","Pot-au-feu","Coq-au-vin","Hachis parmentier","Steak tartare","Choucroute","Soufflé au fromage","Cuisses de grenouilles","Soupe à l’oignon","Baguette","Croissant","French cheeses","Fondant au chocolat","Tarte tatin","Macarons","Crème brûlée","Île flottante","Profiteroles","Pain au chocolat"],lebanon:["Kibbeh","Kafta","Kanafeh","Hummus","Rice pilaf","Fattoush","Manakish","Tabbouleh","Sfeeha","Fattoush","Labneh","Muhammara","Lahm bi ajin","Kaak","Chanklich","Mssabaha","Shawarma","Kebbe","Falafel","Halewit el jeben","Namoura","Maamoul","Foul mdammas","Balila","Kawarma","Fattouch"],thailand:["Pad kra pao moo","Tom kha gai","Khao Pad","Chicken pad Thai","Vegetable pad Thai","Moo satay","Tom yum goong","Khao niew mamuang","Kai yad sai","Khao soi","Pad see ew","Laab moo","Gaeng panang","Gai pad med ma muang","Som tam","Poh pia tod","Gaeng massaman","Pla kapung nueng manao","Tod mun pla","Gaeng ped","Gaeng garee","Gaeng keow wan","Moo ping","Durian","Sai ooah","Hoy tod","Kuay teow reua","Mu kratha","Kao ka moo","Yam nua"],greece:["Moussaka","Papoutsakia","Pastitsio","Souvlaki","Soutzoukakia","Stifado","Tomatokeftedes","Tzatziki","Kolokithokeftedes","Giouvetsi","Choriatiki","Kleftiko","Gemista","Fasolada","Bougatsa","Tiropita","Spanakopita","Feta Cheese with Honey","Horta","Tirokroketes","Briam","Saganaki","Gigantes","Dolmades","Fasolatha","Koulouri","Loukoumades","Gyros","Galaktoboureko","Baklava"],turkey:["Şiş kebap","Döner","Köfte","Pide","Kumpir","Meze","Mantı","Lahmacun","Menemen","Şiş kebap","İskender kebab","Corba","Kuzu tandir","Çiğ Köfte","Pilav","Yaprak sarma","Dolma","İmam bayıldı","Borek","Durum","Kumpir","Balik ekmek","Simit","Kunefe","Baklava","Lokum","Halva","Mozzaik pasta","Güllaç","Mercimek Köftesi","Haydari","Tursu suyu","Kahvalti","Kazan dibi","Hunkar begendi","Islak burgers","Salep","Yogurtlu kebab"],spain:["Tortilla de patatas","Fabada asturiana","Calçots","Boquerones al vinagre","Empanada gallega","Paella","Gazpacho","Gachas","Migas","Bocadillo de calamares","Pulpo a feira","Caldo gallego","Lentejas con chorizo","Cocido madrileño","Cachopo","Caracoles"],venezuela:["Pabellón criollo","Arepa","Mondongo","Empanadas","Quesillo","Chicha andina","Tequeños","Cachapa","Hallaca","Perico","Pasticho","Mandocas","Caraotas negras","Patacones","Dulce de leche","Pan de Jamón"],chile:["Humitas","Empanadas","Porotos con riendas","Completos","Manjar","Cordero al palo","Pastel de choclo","Mote con huesillos","Sopaipillas","Curanto"],argentina:["Milanesas","Empanadas","Pizza fugazeta","Asado","Choripan","Bondiola","Bife de chorizo"],colombia:["Bandeja paisa","Chuleta valluna","Sancocho trifásico","Empanada valluna","Salpicon de frutas","Pastel de garbanzo","Ajiaco","Arepas","Arroz de lisa","Sancocho","Pan de bono","Cuchuco","Oblea","Cazuela de mariscos","Pan de yuca","Bollo Limpio","Almojábana","Empanadas","Arroz con Coco","Sopa de mondongo","Cazuela de Mariscos","Arroz con Pollo","Arepa de Huevo","Mote de Queso"],ecuador:["Encebollado","Ceviche","Tigrillo","Bolon de verde","Llapingacho","Mote pillo","Locro de papa","Churrasco"],peru:["Ceviche","Arroz con pollo","Aji de gallina","Llunca de gallina"],"el salvador":["Pupusa","Sopa de patas","Rigua","Flor de izote con huevo","Gallo en chicha"],romania:["Sarmale","Mici","Pomana porcului","Ciorbă de fasole cu ciolan","Ciorbă de burtă","Ciorbă rădăuțeană","Plăcintă cu brânză","Ciorbă de potroace","Mămăligă cu brânză și smântână","Tochitură","Piftie","Iahnie de fasole","Slănină afumată","Cârnați afumați","Varză a la Cluj","Gulaș de cartofi cu afumătură","Cozonac de casă","Ciorbă ardelenească de porc","Mucenici moldovenești","Salată de boeuf","Dovleac copt","Papanași cu brânză de vacă și afine","Drob de miel","Pârjoale moldovenești","Zacuscă de vinete","Zacuscă de fasole","Turtă dulce","Clătitele cu gem","Clătitele cu brânza de vacă","Balmoș","Cozonac","Chiftele"]},fL;(fL=Object.keys(fae))==null||fL.length;function KA(t){const e=(t==null?void 0:t.years)??1;if(e<=0)throw new Error("Years must be positive, use future() instead");const n=365*e*24*60*60*1e3,r=new Date,i=new Date(r.getTime()-n);return wu(()=>uae({from:i,to:r}),t)}var gae=["Small Rubber Shoes","Fantastic Wooden Sausages","Handmade Frozen Salad","Intelligent Soft Car","Intelligent Concrete Chips","Handcrafted Concrete Bacon","Small Fresh Fish","Rustic Metal Towels","Unbranded Cotton Hat","Fantastic Frozen Bike","Generic Rubber Shirt","Unbranded Wooden Keyboard","Awesome Metal Computer","Gorgeous Fresh Shoes","Unbranded Concrete Sausages","Practical Wooden Ball","Ergonomic Soft Towels","Small Plastic Table","Awesome Metal Pants","Licensed Steel Sausages","Handcrafted Rubber Bike","Ergonomic Cotton Computer","Generic Wooden Ball","Fantastic Frozen Soap","Generic Plastic Keyboard","Awesome Cotton Pizza","Licensed Metal Chips","Handcrafted Cotton Towels","Handmade Plastic Tuna","Practical Granite Keyboard","Intelligent Concrete Soap","Rustic Concrete Chips","Fantastic Steel Hat","Rustic Cotton Chair","Gorgeous Metal Pants","Intelligent Metal Bacon","Handmade Rubber Car","Tasty Concrete Keyboard","Incredible Granite Hat","Practical Rubber Fish","Rustic Cotton Gloves","Rustic Cotton Ball","Refined Fresh Shirt","Generic Granite Sausages","Rustic Granite Fish","Practical Wooden Bacon","Sleek Plastic Chair","Handcrafted Fresh Mouse","Small Concrete Shoes","Awesome Fresh Chair","Incredible Soft Computer","Tasty Concrete Chips","Generic Rubber Sausages","Intelligent Concrete Chicken","Rustic Soft Ball","Awesome Steel Towels","Incredible Fresh Bike","Unbranded Granite Chicken","Rustic Concrete Bike","Small Frozen Sausages","Intelligent Plastic Gloves","Ergonomic Frozen Towels","Refined Frozen Ball","Refined Cotton Ball","Licensed Steel Salad","Intelligent Wooden Bacon","Unbranded Metal Shoes","Fantastic Granite Car","Ergonomic Granite Bacon","Awesome Wooden Shirt","Rustic Wooden Pizza","Tasty Frozen Table","Awesome Wooden Hat","Awesome Rubber Salad","Licensed Concrete Fish","Fantastic Soft Cheese","Rustic Frozen Pizza","Refined Concrete Tuna","Small Frozen Tuna","Licensed Granite Cheese","Practical Rubber Car","Rustic Steel Sausages","Awesome Concrete Hat","Awesome Granite Sausages","Sleek Plastic Chips","Handcrafted Wooden Gloves","Intelligent Metal Computer","Fantastic Fresh Sausages","Fantastic Plastic Salad","Unbranded Steel Sausages","Handcrafted Wooden Fish","Sleek Wooden Bacon","Unbranded Plastic Towels","Tasty Soft Sausages","Generic Metal Shirt","Handmade Granite Cheese","Small Fresh Bacon","Tasty Granite Towels","Licensed Steel Chips"];function XA(t){return wu(gae,t)}aae("42219");const UB=[{companyName:YA({maxCharCount:18}),productName:XA({maxCharCount:18}),sellDate:KA().toLocaleDateString("en-gb"),inStock:jA(),qty:us({max:500}),orderId:`${us({max:9,min:0})}${us({max:9,min:0})}-${us({max:9999999,min:1111111})}`,country:"United Kingdom"},...Array.from({length:150},()=>({companyName:YA({maxCharCount:18}),productName:XA({maxCharCount:18}),sellDate:KA().toLocaleDateString("en-gb"),inStock:jA(),qty:us({max:500}),orderId:`${us({max:9,min:0})}${us({max:9,min:0})}-${us({max:9999999,min:1111111})}`,country:dae({maxCharCount:28})}))],mae=UB.reduce((t,e)=>t.includes(e.country)?t:[...t,e.country],[]);function pae({tabNavigation:t,navigableHeaders:e,renderAllRows:n,enterBeginsEditing:r,autoWrapRow:i,autoWrapCol:o,enterMoves:s,changeToggleOptions:a}){const l=u=>{switch(u){case"enable-tab-navigation":a(c=>({...c,tabNavigation:!t}));break;case"enable-header-navigation":a(c=>({...c,navigableHeaders:!e}));break;case"enable-cell-virtualization":a(c=>({...c,renderAllRows:!n,viewportColumnRenderingOffset:n?"auto":9}));break;case"enable-cell-enter-editing":a(c=>({...c,enterBeginsEditing:!r}));break;case"enable-arrow-rl-first-last-column":a(c=>({...c,autoWrapRow:!i}));break;case"enable-arrow-td-first-last-column":a(c=>({...c,autoWrapCol:!o}));break;case"enable-enter-focus-editing":a(c=>({...c,enterMoves:s.row!==1?{col:0,row:1}:{col:0,row:0}}));break}};return we.jsx(we.Fragment,{children:we.jsxs("div",{className:"checkbox-container",children:[we.jsxs("div",{className:"checkbox-group",children:[we.jsxs("div",{children:[we.jsxs("label",{className:"option-label",htmlFor:"enable-tab-navigation",id:"tab-navigation-label",children:[we.jsx("input",{checked:t,type:"checkbox",id:"enable-tab-navigation",name:"enable-tab-navigation","aria-label":"Enable navigation with the Tab key",onChange:()=>l("enable-tab-navigation")}),"Enable navigation with the Tab key"]}),we.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#tabNavigation",target:"_blank",className:"external-link",rel:"noopener noreferrer","aria-label":"Learn more enabling/disabling tab navigation (opens in a new window)",children:we.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"icon outbound",children:[we.jsx("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),we.jsx("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]})})]}),we.jsxs("div",{children:[we.jsxs("label",{className:"option-label",htmlFor:"enable-header-navigation",id:"header-navigation-label",children:[we.jsx("input",{checked:e,type:"checkbox",id:"enable-header-navigation",name:"enable-header-navigation","aria-labelledby":"header-navigation-label",onChange:()=>l("enable-header-navigation")}),"Enable navigation across headers"]}),we.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#navigableheaders",target:"_blank",className:"external-link",rel:"noopener noreferrer","aria-label":"Learn more about enabling/disabling tab navigation across headers (opens in a new window)",children:we.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"icon outbound",children:[we.jsx("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),we.jsx("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]})})]}),we.jsxs("div",{children:[we.jsxs("label",{className:"option-label",htmlFor:"enable-cell-virtualization",id:"cell-virtualization-label",children:[we.jsx("input",{checked:!n,type:"checkbox",id:"enable-cell-virtualization",name:"enable-cell-virtualization","aria-labelledby":"cell-virtualization-label",onChange:()=>l("enable-cell-virtualization")}),"Enable cells virtualization"]}),we.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#renderAllRows",target:"_blank",className:"external-link",rel:"noopener noreferrer","aria-label":"Learn more about row virtualization (opens in a new window)",children:we.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"icon outbound",children:[we.jsx("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),we.jsx("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]})})]}),we.jsxs("div",{children:[we.jsxs("label",{className:"option-label",htmlFor:"enable-cell-enter-editing",id:"cell-enter-editing-label",children:[we.jsx("input",{checked:r,type:"checkbox",id:"enable-cell-enter-editing",name:"enable-cell-enter-editing","aria-labelledby":"cell-enter-editing-label",onChange:()=>l("enable-cell-enter-editing")}),"The Enter key begins cell editing"]}),we.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#enterbeginsediting",target:"_blank",className:"external-link",rel:"noopener noreferrer","aria-label":"Learn more about Enter key cell editing (opens in a new window)",children:we.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"icon outbound",children:[we.jsx("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),we.jsx("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]})})]})]}),we.jsxs("div",{className:"checkbox-group",children:[we.jsxs("div",{children:[we.jsxs("label",{className:"option-label",htmlFor:"enable-arrow-rl-first-last-column",id:"arrow-rl-first-last-column-label",children:[we.jsx("input",{checked:i,type:"checkbox",id:"enable-arrow-rl-first-last-column",name:"enableArrowFirstLastColumn","aria-labelledby":"arrow-rl-first-last-column-label",onChange:()=>l("enable-arrow-rl-first-last-column")}),"The right/left arrow keys move the focus to the first/last column"]}),we.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#autowrapcol",target:"_blank",className:"external-link",rel:"noopener noreferrer","aria-label":"Learn more about right/left arrow key behavior (opens in a new window)",children:we.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"icon outbound",children:[we.jsx("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),we.jsx("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]})})]}),we.jsxs("div",{children:[we.jsxs("label",{className:"option-label",htmlFor:"enable-arrow-td-first-last-column",id:"arrow-td-first-last-column-label",children:[we.jsx("input",{checked:o,type:"checkbox",id:"enable-arrow-td-first-last-column",name:"enable-arrow-td-first-last-column","aria-labelledby":"arrow-td-first-last-column-label",onChange:()=>l("enable-arrow-td-first-last-column")}),"The up/down arrow keys move the focus to the first/last row"]}),we.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#autowraprow",target:"_blank",className:"external-link",rel:"noopener noreferrer","aria-label":"Learn more about up/down arrow key behavior (opens in a new window)",children:we.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"icon outbound",children:[we.jsx("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),we.jsx("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]})})]}),we.jsxs("div",{children:[we.jsxs("label",{className:"option-label",htmlFor:"enable-enter-focus-editing",id:"enter-focus-editing-label",children:[we.jsx("input",{checked:s.row!==0,type:"checkbox",id:"enable-enter-focus-editing",name:"enable-enter-focus-editing","aria-labelledby":"enter-focus-editing-label",onChange:()=>l("enable-enter-focus-editing")}),"The Enter key moves the focus after cell edition"]}),we.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#entermoves",target:"_blank",className:"external-link",rel:"noopener noreferrer","aria-label":"Learn more about Enter key focus behavior (opens in a new window)",children:we.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15",className:"icon outbound",children:[we.jsx("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}),we.jsx("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"})]})})]})]})]})})}const qA="handsontableEditor",wae="handsontable";class RM extends mu{static get EDITOR_TYPE(){return wae}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),tg(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&hn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:qA,relativeToGroup:eC,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Pi(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(qA)}}function vae(t,e,n){Cae(t,e),e.set(t,n)}function Cae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gm(t,e,n){return e=yae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yae(t){var e=Sae(t,"string");return typeof e=="symbol"?e:String(e)}function Sae(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QA(t,e){var n=bae(t,e,"get");return Rae(t,n)}function bae(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Rae(t,e){return e.get?e.get.call(t):e.value}const Eae="autocomplete";var RS=new WeakMap;class EM extends RM{constructor(){super(...arguments),gm(this,"query",null),gm(this,"strippedChoices",[]),gm(this,"rawChoices",[]),vae(this,RS,{writable:!0,value:this.hot.guid.slice(0,9)}),gm(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=gR(Qt(n[c])),r)h=u.indexOf(e);else{const f=this.cellProperties.locale;h=u.toLocaleLowerCase(f).indexOf(e.toLocaleLowerCase(f))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((f,g)=>{if(g.index===-1)return-1;if(f.index===-1)return 1;if(f.index<g.index)return-1;if(g.index<f.index)return 1;if(f.index===g.index){if(f.charsLeft<g.charsLeft)return-1;if(f.charsLeft>g.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return Eae}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return fe(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),te(this.htContainer,"autocompleteEditor"),te(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ae(this.TEXTAREA,[uQ(),iQ(),RV("listbox"),gQ()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&Ae(this.TEXTAREA,[bi("false"),mQ(`${QA(this,RS)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=Tn();a===0&&Mf()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[wt(this.TEXTAREA)-2]:void 0,width:e?wt(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,h,f,g,p)=>{Ys(l,u,c,h,f,g,p);const{filteringCaseSensitive:y,allowHtml:E,locale:v}=this.cellProperties,C=this.query;let S=Qt(g),T,_;S&&!E&&(T=y===!0?S.indexOf(C):S.toLocaleLowerCase(v).indexOf(C.toLocaleLowerCase(v)),T!==-1&&(_=S.substr(T,C.length),S=S.replace(_,`<strong>${_}</strong>`))),n&&Ae(u,[oQ(),...r?[CQ(i)]:[],...r?[yQ(r.indexOf(g)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${h}`]]),u.innerHTML=S},afterSelection:(l,u)=>{if(n){const c=this.htEditor.getCell(l,u,!0);Ae(c,[YT()]),Ae(this.TEXTAREA,...pQ(c.id))}}}),n&&(Ae(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...No()),Ae(this.htEditor.rootElement,[bV(),wQ("polite"),vQ("text"),["id",`${QA(this,RS)}-listbox-${o}-${s}`]]),Ae(this.TEXTAREA,...bi("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ae(this.TEXTAREA,[bi("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=qT(this.TEXTAREA),r=HV(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,f=l.length;h<f&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(kd([l])),l.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),tg(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=Jl(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const i=cn(this.TEXTAREA),o=Bt(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=Bt(this.hot.view._wt.wtTable.THEAD),u=cn(e),c=i.top-u.top-l+a,h=e.scrollHeight-c-l-o,f=s>h&&c>h;return f?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(f?c:h,s),f}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+Tn(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ye(e,o=>Qt(o));return Ye(r,o=>n?o:gR(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===be.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===be.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(qV(e.keyCode)||e.keyCode===be.BACKSPACE||e.keyCode===be.DELETE||e.keyCode===be.INSERT){let n=10;if(e.keyCode===be.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const Tae="checkbox";class zB extends fh{static get EDITOR_TYPE(){return Tae}beginEditing(e,n){if(n&&n.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');$e(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var GB={exports:{}};const _ae=gL(Fq);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,e){(function(n,r){var i;{try{i=_ae}catch{}t.exports=r(i)}})(Zi,function(n){var r=typeof n=="function",i=!!window.addEventListener,o=window.document,s=window.setTimeout,a=function(R,d,m,w){i?R.addEventListener(d,m,!!w):R.attachEvent("on"+d,m)},l=function(R,d,m,w){i?R.removeEventListener(d,m,!!w):R.detachEvent("on"+d,m)},u=function(R){return R.trim?R.trim():R.replace(/^\s+|\s+$/g,"")},c=function(R,d){return(" "+R.className+" ").indexOf(" "+d+" ")!==-1},h=function(R,d){c(R,d)||(R.className=R.className===""?d:R.className+" "+d)},f=function(R,d){R.className=u((" "+R.className+" ").replace(" "+d+" "," "))},g=function(R){return/Array/.test(Object.prototype.toString.call(R))},p=function(R){return/Date/.test(Object.prototype.toString.call(R))&&!isNaN(R.getTime())},y=function(R){var d=R.getDay();return d===0||d===6},E=function(R){return R%4===0&&R%100!==0||R%400===0},v=function(R,d){return[31,E(R)?29:28,31,30,31,30,31,31,30,31,30,31][d]},C=function(R){p(R)&&R.setHours(0,0,0,0)},S=function(R,d){return R.getTime()===d.getTime()},T=function(R,d,m){var w,x;for(w in d)x=R[w]!==void 0,x&&typeof d[w]=="object"&&d[w]!==null&&d[w].nodeName===void 0?p(d[w])?m&&(R[w]=new Date(d[w].getTime())):g(d[w])?m&&(R[w]=d[w].slice(0)):R[w]=T({},d[w],m):(m||!x)&&(R[w]=d[w]);return R},_=function(R,d,m){var w;o.createEvent?(w=o.createEvent("HTMLEvents"),w.initEvent(d,!0,!1),w=T(w,m),R.dispatchEvent(w)):o.createEventObject&&(w=o.createEventObject(),w=T(w,m),R.fireEvent("on"+d,w))},A=function(R){return R.month<0&&(R.year-=Math.ceil(Math.abs(R.month)/12),R.month+=12),R.month>11&&(R.year+=Math.floor(Math.abs(R.month)/12),R.month-=12),R},D={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},U=function(R,d,m){for(d+=R.firstDay;d>=7;)d-=7;return m?R.i18n.weekdaysShort[d]:R.i18n.weekdays[d]},z=function(R){var d=[],m="false";if(R.isEmpty)if(R.showDaysInNextAndPreviousMonths)d.push("is-outside-current-month"),R.enableSelectionDaysInNextAndPreviousMonths||d.push("is-selection-disabled");else return'<td class="is-empty"></td>';return R.isDisabled&&d.push("is-disabled"),R.isToday&&d.push("is-today"),R.isSelected&&(d.push("is-selected"),m="true"),R.hasEvent&&d.push("has-event"),R.isInRange&&d.push("is-inrange"),R.isStartRange&&d.push("is-startrange"),R.isEndRange&&d.push("is-endrange"),'<td data-day="'+R.day+'" class="'+d.join(" ")+'" aria-selected="'+m+'"><button class="pika-button pika-day" type="button" data-pika-year="'+R.year+'" data-pika-month="'+R.month+'" data-pika-day="'+R.day+'">'+R.day+"</button></td>"},G=function(R,d){R.setHours(0,0,0,0);var m=R.getDate(),w=R.getDay(),x=d,O=x-1,H=7,K=function(me){return(me+H-1)%H};R.setDate(m+O-K(w));var B=new Date(R.getFullYear(),0,x),Q=24*60*60*1e3,ee=(R.getTime()-B.getTime())/Q,q=1+Math.round((ee-O+K(B.getDay()))/H);return q},Z=function(R,d,m,w){var x=new Date(m,d,R),O=r?n(x).isoWeek():G(x,w);return'<td class="pika-week">'+O+"</td>"},re=function(R,d,m,w){return'<tr class="pika-row'+(m?" pick-whole-week":"")+(w?" is-selected":"")+'">'+(d?R.reverse():R).join("")+"</tr>"},ne=function(R){return"<tbody>"+R.join("")+"</tbody>"},he=function(R){var d,m=[];for(R.showWeekNumber&&m.push("<th></th>"),d=0;d<7;d++)m.push('<th scope="col"><abbr title="'+U(R,d)+'">'+U(R,d,!0)+"</abbr></th>");return"<thead><tr>"+(R.isRTL?m.reverse():m).join("")+"</tr></thead>"},Me=function(R,d,m,w,x,O){var H,K,B,Q=R._o,ee=m===Q.minYear,q=m===Q.maxYear,me='<div id="'+O+'" class="pika-title" role="heading" aria-live="assertive">',He,Pe,De=!0,X=!0;for(B=[],H=0;H<12;H++)B.push('<option value="'+(m===x?H-d:12+H-d)+'"'+(H===w?' selected="selected"':"")+(ee&&H<Q.minMonth||q&&H>Q.maxMonth?' disabled="disabled"':"")+">"+Q.i18n.months[H]+"</option>");for(He='<div class="pika-label">'+Q.i18n.months[w]+'<select class="pika-select pika-select-month" tabindex="-1">'+B.join("")+"</select></div>",g(Q.yearRange)?(H=Q.yearRange[0],K=Q.yearRange[1]+1):(H=m-Q.yearRange,K=1+m+Q.yearRange),B=[];H<K&&H<=Q.maxYear;H++)H>=Q.minYear&&B.push('<option value="'+H+'"'+(H===m?' selected="selected"':"")+">"+H+"</option>");return Pe='<div class="pika-label">'+m+Q.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+B.join("")+"</select></div>",Q.showMonthAfterYear?me+=Pe+He:me+=He+Pe,ee&&(w===0||Q.minMonth>=w)&&(De=!1),q&&(w===11||Q.maxMonth<=w)&&(X=!1),d===0&&(me+='<button class="pika-prev'+(De?"":" is-disabled")+'" type="button">'+Q.i18n.previousMonth+"</button>"),d===R._o.numberOfMonths-1&&(me+='<button class="pika-next'+(X?"":" is-disabled")+'" type="button">'+Q.i18n.nextMonth+"</button>"),me+="</div>"},Ve=function(R,d,m){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+m+'">'+he(R)+ne(d)+"</table>"},ke=function(R){var d=this,m=d.config(R);d._onMouseDown=function(x){if(d._v){x=x||window.event;var O=x.target||x.srcElement;if(O)if(c(O,"is-disabled")||(c(O,"pika-button")&&!c(O,"is-empty")&&!c(O.parentNode,"is-disabled")?(d.setDate(new Date(O.getAttribute("data-pika-year"),O.getAttribute("data-pika-month"),O.getAttribute("data-pika-day"))),m.bound&&s(function(){d.hide(),m.blurFieldOnSelect&&m.field&&m.field.blur()},100)):c(O,"pika-prev")?d.prevMonth():c(O,"pika-next")&&d.nextMonth()),c(O,"pika-select"))d._c=!0;else if(x.preventDefault)x.preventDefault();else return x.returnValue=!1,!1}},d._onChange=function(x){x=x||window.event;var O=x.target||x.srcElement;O&&(c(O,"pika-select-month")?d.gotoMonth(O.value):c(O,"pika-select-year")&&d.gotoYear(O.value))},d._onKeyChange=function(x){if(x=x||window.event,d.isVisible())switch(x.keyCode){case 13:case 27:m.field&&m.field.blur();break;case 37:d.adjustDate("subtract",1);break;case 38:d.adjustDate("subtract",7);break;case 39:d.adjustDate("add",1);break;case 40:d.adjustDate("add",7);break;case 8:case 46:d.setDate(null);break}},d._parseFieldValue=function(){if(m.parse)return m.parse(m.field.value,m.format);if(r){var x=n(m.field.value,m.format,m.formatStrict);return x&&x.isValid()?x.toDate():null}else return new Date(Date.parse(m.field.value))},d._onInputChange=function(x){var O;x.firedBy!==d&&(O=d._parseFieldValue(),p(O)&&d.setDate(O),d._v||d.show())},d._onInputFocus=function(){d.show()},d._onInputClick=function(){d.show()},d._onInputBlur=function(){var x=o.activeElement;do if(c(x,"pika-single"))return;while(x=x.parentNode);d._c||(d._b=s(function(){d.hide()},50)),d._c=!1},d._onClick=function(x){x=x||window.event;var O=x.target||x.srcElement,H=O;if(O){!i&&c(O,"pika-select")&&(O.onchange||(O.setAttribute("onchange","return;"),a(O,"change",d._onChange)));do if(c(H,"pika-single")||H===m.trigger)return;while(H=H.parentNode);d._v&&O!==m.trigger&&H!==m.trigger&&d.hide()}},d.el=o.createElement("div"),d.el.className="pika-single"+(m.isRTL?" is-rtl":"")+(m.theme?" "+m.theme:""),a(d.el,"mousedown",d._onMouseDown,!0),a(d.el,"touchend",d._onMouseDown,!0),a(d.el,"change",d._onChange),m.keyboardInput&&a(o,"keydown",d._onKeyChange),m.field&&(m.container?m.container.appendChild(d.el):m.bound?o.body.appendChild(d.el):m.field.parentNode.insertBefore(d.el,m.field.nextSibling),a(m.field,"change",d._onInputChange),m.defaultDate||(m.defaultDate=d._parseFieldValue(),m.setDefaultDate=!0));var w=m.defaultDate;p(w)?m.setDefaultDate?d.setDate(w,!0):d.gotoDate(w):d.gotoDate(new Date),m.bound?(this.hide(),d.el.className+=" is-bound",a(m.trigger,"click",d._onInputClick),a(m.trigger,"focus",d._onInputFocus),a(m.trigger,"blur",d._onInputBlur)):this.show()};return ke.prototype={config:function(R){this._o||(this._o=T({},D,!0));var d=T(this._o,R,!0);d.isRTL=!!d.isRTL,d.field=d.field&&d.field.nodeName?d.field:null,d.theme=typeof d.theme=="string"&&d.theme?d.theme:null,d.bound=!!(d.bound!==void 0?d.field&&d.bound:d.field),d.trigger=d.trigger&&d.trigger.nodeName?d.trigger:d.field,d.disableWeekends=!!d.disableWeekends,d.disableDayFn=typeof d.disableDayFn=="function"?d.disableDayFn:null;var m=parseInt(d.numberOfMonths,10)||1;if(d.numberOfMonths=m>4?4:m,p(d.minDate)||(d.minDate=!1),p(d.maxDate)||(d.maxDate=!1),d.minDate&&d.maxDate&&d.maxDate<d.minDate&&(d.maxDate=d.minDate=!1),d.minDate&&this.setMinDate(d.minDate),d.maxDate&&this.setMaxDate(d.maxDate),g(d.yearRange)){var w=new Date().getFullYear()-10;d.yearRange[0]=parseInt(d.yearRange[0],10)||w,d.yearRange[1]=parseInt(d.yearRange[1],10)||w}else d.yearRange=Math.abs(parseInt(d.yearRange,10))||D.yearRange,d.yearRange>100&&(d.yearRange=100);return d},toString:function(R){return R=R||this._o.format,p(this._d)?this._o.toString?this._o.toString(this._d,R):r?n(this._d).format(R):this._d.toDateString():""},getMoment:function(){return r?n(this._d):null},setMoment:function(R,d){r&&n.isMoment(R)&&this.setDate(R.toDate(),d)},getDate:function(){return p(this._d)?new Date(this._d.getTime()):null},setDate:function(R,d){if(!R)return this._d=null,this._o.field&&(this._o.field.value="",_(this._o.field,"change",{firedBy:this})),this.draw();if(typeof R=="string"&&(R=new Date(Date.parse(R))),!!p(R)){var m=this._o.minDate,w=this._o.maxDate;p(m)&&R<m?R=m:p(w)&&R>w&&(R=w),this._d=new Date(R.getTime()),C(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),_(this._o.field,"change",{firedBy:this})),!d&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(R){var d=!0;if(p(R)){if(this.calendars){var m=new Date(this.calendars[0].year,this.calendars[0].month,1),w=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),x=R.getTime();w.setMonth(w.getMonth()+1),w.setDate(w.getDate()-1),d=x<m.getTime()||w.getTime()<x}d&&(this.calendars=[{month:R.getMonth(),year:R.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(R,d){var m=this.getDate()||new Date,w=parseInt(d)*24*60*60*1e3,x;R==="add"?x=new Date(m.valueOf()+w):R==="subtract"&&(x=new Date(m.valueOf()-w)),this.setDate(x)},adjustCalendars:function(){this.calendars[0]=A(this.calendars[0]);for(var R=1;R<this._o.numberOfMonths;R++)this.calendars[R]=A({month:this.calendars[0].month+R,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(R){isNaN(R)||(this.calendars[0].month=parseInt(R,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(R){isNaN(R)||(this.calendars[0].year=parseInt(R,10),this.adjustCalendars())},setMinDate:function(R){R instanceof Date?(C(R),this._o.minDate=R,this._o.minYear=R.getFullYear(),this._o.minMonth=R.getMonth()):(this._o.minDate=D.minDate,this._o.minYear=D.minYear,this._o.minMonth=D.minMonth,this._o.startRange=D.startRange),this.draw()},setMaxDate:function(R){R instanceof Date?(C(R),this._o.maxDate=R,this._o.maxYear=R.getFullYear(),this._o.maxMonth=R.getMonth()):(this._o.maxDate=D.maxDate,this._o.maxYear=D.maxYear,this._o.maxMonth=D.maxMonth,this._o.endRange=D.endRange),this.draw()},setStartRange:function(R){this._o.startRange=R},setEndRange:function(R){this._o.endRange=R},draw:function(R){if(!(!this._v&&!R)){var d=this._o,m=d.minYear,w=d.maxYear,x=d.minMonth,O=d.maxMonth,H="",K;this._y<=m&&(this._y=m,!isNaN(x)&&this._m<x&&(this._m=x)),this._y>=w&&(this._y=w,!isNaN(O)&&this._m>O&&(this._m=O));for(var B=0;B<d.numberOfMonths;B++)K="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),H+='<div class="pika-lendar">'+Me(this,B,this.calendars[B].year,this.calendars[B].month,this.calendars[0].year,K)+this.render(this.calendars[B].year,this.calendars[B].month,K)+"</div>";this.el.innerHTML=H,d.bound&&d.field.type!=="hidden"&&s(function(){d.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),d.bound&&d.field.setAttribute("aria-label",d.ariaLabel)}},adjustPosition:function(){var R,d,m,w,x,O,H,K,B,Q,ee,q;if(!this._o.container){if(this.el.style.position="absolute",R=this._o.trigger,d=R,m=this.el.offsetWidth,w=this.el.offsetHeight,x=window.innerWidth||o.documentElement.clientWidth,O=window.innerHeight||o.documentElement.clientHeight,H=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,ee=!0,q=!0,typeof R.getBoundingClientRect=="function")Q=R.getBoundingClientRect(),K=Q.left+window.pageXOffset,B=Q.bottom+window.pageYOffset;else for(K=d.offsetLeft,B=d.offsetTop+d.offsetHeight;d=d.offsetParent;)K+=d.offsetLeft,B+=d.offsetTop;(this._o.reposition&&K+m>x||this._o.position.indexOf("right")>-1&&K-m+R.offsetWidth>0)&&(K=K-m+R.offsetWidth,ee=!1),(this._o.reposition&&B+w>O+H||this._o.position.indexOf("top")>-1&&B-w-R.offsetHeight>0)&&(B=B-w-R.offsetHeight,q=!1),this.el.style.left=K+"px",this.el.style.top=B+"px",h(this.el,ee?"left-aligned":"right-aligned"),h(this.el,q?"bottom-aligned":"top-aligned"),f(this.el,ee?"right-aligned":"left-aligned"),f(this.el,q?"top-aligned":"bottom-aligned")}},render:function(R,d,m){var w=this._o,x=new Date,O=v(R,d),H=new Date(R,d,1).getDay(),K=[],B=[];C(x),w.firstDay>0&&(H-=w.firstDay,H<0&&(H+=7));for(var Q=d===0?11:d-1,ee=d===11?0:d+1,q=d===0?R-1:R,me=d===11?R+1:R,He=v(q,Q),Pe=O+H,De=Pe;De>7;)De-=7;Pe+=7-De;for(var X=!1,Qe=0,Be=0;Qe<Pe;Qe++){var Te=new Date(R,d,1+(Qe-H)),Le=p(this._d)?S(Te,this._d):!1,xe=S(Te,x),b=w.events.indexOf(Te.toDateString())!==-1,M=Qe<H||Qe>=O+H,I=1+(Qe-H),V=d,N=R,W=w.startRange&&S(w.startRange,Te),k=w.endRange&&S(w.endRange,Te),L=w.startRange&&w.endRange&&w.startRange<Te&&Te<w.endRange,j=w.minDate&&Te<w.minDate||w.maxDate&&Te>w.maxDate||w.disableWeekends&&y(Te)||w.disableDayFn&&w.disableDayFn(Te);M&&(Qe<H?(I=He+I,V=Q,N=q):(I=I-O,V=ee,N=me));var F={day:I,month:V,year:N,hasEvent:b,isSelected:Le,isToday:xe,isDisabled:j,isEmpty:M,isStartRange:W,isEndRange:k,isInRange:L,showDaysInNextAndPreviousMonths:w.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:w.enableSelectionDaysInNextAndPreviousMonths};w.pickWholeWeek&&Le&&(X=!0),B.push(z(F)),++Be===7&&(w.showWeekNumber&&B.unshift(Z(Qe-H,d,R,w.firstWeekOfYearMinDays)),K.push(re(B,w.isRTL,w.pickWholeWeek,X)),B=[],Be=0,X=!1)}return Ve(w,K,m)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),f(this.el,"is-hidden"),this._o.bound&&(a(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var R=this._v;R!==!1&&(this._o.bound&&l(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),h(this.el,"is-hidden"),this._v=!1,R!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var R=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),R.keyboardInput&&l(o,"keydown",this._onKeyChange),R.field&&(l(R.field,"change",this._onInputChange),R.bound&&(l(R.trigger,"click",this._onInputClick),l(R.trigger,"focus",this._onInputFocus),l(R.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},ke})})(GB);var Mae=GB.exports;const ZA=Vf(Mae);function mm(t,e,n){return e=xae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xae(t){var e=Pae(t,"string");return typeof e=="symbol"?e:String(e)}function Pae(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const jB="date",JA="dateEditor";class YB extends mu{constructor(){super(...arguments),mm(this,"defaultDateFormat","DD/MM/YYYY"),mm(this,"isCellEdited",!1),mm(this,"parentDestroyed",!1),mm(this,"$datePicker",null)}static get EDITOR_TYPE(){return jB}init(){if(typeof J!="function")throw new Error("You need to include moment.js to your project.");if(typeof ZA!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),te(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);const e=new ri(this);e.addEventListener(this.datePicker,"mousedown",n=>{$e(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()}),e.addEventListener(this.TEXTAREA,"keydown",n=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(n.code)&&n.preventDefault()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),r.addShortcut({keys:[["Enter"]],callback:i=>{i.stopPropagation()},group:JA})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(JA),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const r=this.originalValue;r!==void 0&&this.setValue(r)}super.finishEditing(e,n)}showDatepicker(e){const n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?o1(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new ZA(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+n.top+Bt(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=n.right-wt(this.datePicker):a=n.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(s=this.originalValue,J(s,r,!0).isValid()&&this.$datePicker.setMoment(J(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,J(s,r,!0).isValid()&&this.$datePicker.setMoment(J(s,r),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&ig(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=J(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}}const Oae="dropdown";class TM extends EM{static get EDITOR_TYPE(){return Oae}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}ve.getSingleton().add("beforeValidate",function(t,e,n){const r=this.getCellMeta(e,this.propToCol(n));r.editor===TM&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const Aae="numeric";class KB extends mu{static get EDITOR_TYPE(){return Aae}}const Iae="password";class XB extends mu{static get EDITOR_TYPE(){return Iae}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&Ae(this.TEXTAREA,[Us()]),so(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const ES="ht_editor_visible",eI="selectEditor",Hae="select";class qB extends fh{static get EDITOR_TYPE(){return Hae}init(){this.select=this.hot.rootDocument.createElement("SELECT"),te(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",$e(this.select,ES)&&We(this.select,ES),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),so(this.select),Ke(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,fu(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==pn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",te(this.select,ES)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:eI};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(eI)}}const Dae="time";class QB extends mu{static get EDITOR_TYPE(){return Dae}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function Nae(){Hr(fh),Hr(EM),Hr(zB),Hr(YB),Hr(TM),Hr(RM),Hr(KB),Hr(XB),Hr(qB),Hr(mu),Hr(QB)}const kae="html";function _M(t,e,n,r,i,o,s){ug.apply(this,[t,e,n,r,i,o,s]),fu(e,o??"",!1)}_M.RENDERER_TYPE=kae;const Lae="autocomplete";function gh(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?_M:Ys,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Us()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),te(e,"htAutocomplete"),!t.acArrowListener){const h=new ri(t);t.acArrowListener=function(f){$e(f.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}gh.RENDERER_TYPE=Lae;const tI=new WeakMap,nI=new WeakMap,$ae="htBadValue",th="data-row",nh="data-col",Fae="checkboxRenderer",ZB="checkbox";ve.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===ZB){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function MM(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;ug.apply(this,[t,e,n,r,i,o,s]),Wae(t);let u=Vae(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),so(e),o===s.checkedTemplate||Qt(o).toLocaleLowerCase(s.locale)===Qt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Qt(o).toLocaleLowerCase(s.locale)===Qt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Cn(o)?te(u,"noValue"):(u.style.display="none",te(u,$ae),h=!0),Ae(u,[[th,n],[nh,r]]),l&&Ae(u,[GT(u.checked?t.getTranslatedPhrase(aM):t.getTranslatedPhrase(lM)),fQ(u.checked),sQ()]),!h&&c){let y="";if(c.value)y=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const v=t.getDataAtRowProp(n,c.property);y=v!==null?v:""}const E=Bae(a,y,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(E),e.appendChild(u)):(E.appendChild(u),u=E):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(E)):(E.insertBefore(u,E.firstChild),u=E))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),tI.has(t)||(tI.set(t,!0),f());function f(){const E=t.getShortcutManager().getContext("grid"),v={group:Fae};E.addShortcuts([{keys:[["space"]],callback:()=>(g(),!p())},{keys:[["enter"]],callback:()=>(g(),!p()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!p()),relativeToGroup:dM,position:"before"}],v)}function g(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const E=t.getSelectedRange();if(E)for(let v=0;v<E.length;v++){const{row:C,col:S}=E[v].getTopStartCorner(),{row:T,col:_}=E[v].getBottomEndCorner(),A=[];for(let D=C;D<=T;D+=1)for(let U=S;U<=_;U+=1){const z=t.getCellMeta(D,U);if(z.type!=="checkbox")return;if(z.readOnly===!0)continue;typeof z.checkedTemplate>"u"&&(z.checkedTemplate=!0),typeof z.uncheckedTemplate>"u"&&(z.uncheckedTemplate=!1);const G=t.getDataAtCell(D,U);y===!1?[z.checkedTemplate,z.checkedTemplate.toString()].includes(G)?A.push([D,U,z.uncheckedTemplate]):[z.uncheckedTemplate,z.uncheckedTemplate.toString(),null,void 0].includes(G)&&A.push([D,U,z.checkedTemplate]):A.push([D,U,z.uncheckedTemplate])}A.length>0&&t.setDataAtCell(A)}}function p(){const y=t.getSelectedRange();if(y){for(let E=0;E<y.length;E++){const v=y[E].getTopStartCorner(),C=y[E].getBottomEndCorner();for(let S=v.row;S<=C.row;S++)for(let T=v.col;T<=C.col;T++){const _=t.getCellMeta(S,T);if(_.type!=="checkbox")return!1;const A=t.getCell(S,T);if(A==null)return!0;if(A.querySelectorAll("input[type=checkbox]").length>0&&!_.readOnly)return!0}}return!1}}}MM.RENDERER_TYPE=ZB;function Wae(t){let e=nI.get(t);if(!e){const{rootElement:n}=t;e=new ri(t),e.addEventListener(n,"click",r=>zae(r,t)),e.addEventListener(n,"mouseup",r=>Uae(r,t)),e.addEventListener(n,"change",r=>Gae(r,t)),nI.set(t,e)}return e}function Vae(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Bae(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function Uae(t,e){const{target:n}=t;xM(n)&&(!n.hasAttribute(th)||!n.hasAttribute(nh)||setTimeout(e.listen,10))}function zae(t,e){const{target:n}=t;if(!xM(n)||!n.hasAttribute(th)||!n.hasAttribute(nh))return;const r=parseInt(n.getAttribute(th),10),i=parseInt(n.getAttribute(nh),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function Gae(t,e){const{target:n}=t;if(!xM(n)||!n.hasAttribute(th)||!n.hasAttribute(nh))return;const r=parseInt(n.getAttribute(th),10),i=parseInt(n.getAttribute(nh),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function xM(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}function pm(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var JB={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(u,c){if(!i[u]){if(!r[u]){var h=typeof pm=="function"&&pm;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var g=i[u]={exports:{}};r[u][0].call(g.exports,function(p){return s(r[u][1][p]||p)},g,g.exports,n,r,i,o)}return i[u].exports}for(var a=typeof pm=="function"&&pm,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",f=1e14,g=14,p=9007199254740991,y=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],E=1e7,v=1e9;function C(z){var G=0|z;return 0<z||z===G?G:G-1}function S(z){for(var G,Z,re=1,ne=z.length,he=z[0]+"";re<ne;){for(G=z[re++]+"",Z=g-G.length;Z--;G="0"+G);he+=G}for(ne=he.length;he.charCodeAt(--ne)===48;);return he.slice(0,ne+1||1)}function T(z,G){var Z,re,ne=z.c,he=G.c,Me=z.s,Ve=G.s,ke=z.e,R=G.e;if(!Me||!Ve)return null;if(Z=ne&&!ne[0],re=he&&!he[0],Z||re)return Z?re?0:-Ve:Me;if(Me!=Ve)return Me;if(Z=Me<0,re=ke==R,!ne||!he)return re?0:!ne^Z?1:-1;if(!re)return R<ke^Z?1:-1;for(Ve=(ke=ne.length)<(R=he.length)?ke:R,Me=0;Me<Ve;Me++)if(ne[Me]!=he[Me])return ne[Me]>he[Me]^Z?1:-1;return ke==R?0:R<ke^Z?1:-1}function _(z,G,Z,re){if(z<G||Z<z||z!==(z<0?l(z):u(z)))throw Error(c+(re||"Argument")+(typeof z=="number"?z<G||Z<z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(z))}function A(z){var G=z.c.length-1;return C(z.e/g)==G&&z.c[G]%2!=0}function D(z,G){return(1<z.length?z.charAt(0)+"."+z.slice(1):z)+(G<0?"e":"e+")+G}function U(z,G,Z){var re,ne;if(G<0){for(ne=Z+".";++G;ne+=Z);z=ne+z}else if(++G>(re=z.length)){for(ne=Z,G-=re;--G;ne+=Z);z+=ne}else G<re&&(z=z.slice(0,G)+"."+z.slice(G));return z}(s=function z(G){var Z,re,ne,he,Me,Ve,ke,R,d,m,w=X.prototype={constructor:X,toString:null,valueOf:null},x=new X(1),O=20,H=4,K=-7,B=21,Q=-1e7,ee=1e7,q=!1,me=1,He=0,Pe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},De="0123456789abcdefghijklmnopqrstuvwxyz";function X(b,M){var I,V,N,W,k,L,j,F,Y=this;if(!(Y instanceof X))return new X(b,M);if(M==null){if(b instanceof X)return Y.s=b.s,Y.e=b.e,void(Y.c=(b=b.c)?b.slice():b);if((L=typeof b=="number")&&0*b==0){if(Y.s=1/b<0?(b=-b,-1):1,b===~~b){for(W=0,k=b;10<=k;k/=10,W++);return Y.e=W,void(Y.c=[b])}F=String(b)}else{if(F=String(b),!a.test(F))return ne(Y,F,L);Y.s=F.charCodeAt(0)==45?(F=F.slice(1),-1):1}-1<(W=F.indexOf("."))&&(F=F.replace(".","")),0<(k=F.search(/e/i))?(W<0&&(W=k),W+=+F.slice(k+1),F=F.substring(0,k)):W<0&&(W=F.length)}else{if(_(M,2,De.length,"Base"),F=String(b),M==10)return Le(Y=new X(b instanceof X?b:F),O+Y.e+1,H);if(L=typeof b=="number"){if(0*b!=0)return ne(Y,F,L,M);if(Y.s=1/b<0?(F=F.slice(1),-1):1,X.DEBUG&&15<F.replace(/^0\.0*|\./,"").length)throw Error(h+b);L=!1}else Y.s=F.charCodeAt(0)===45?(F=F.slice(1),-1):1;for(I=De.slice(0,M),W=k=0,j=F.length;k<j;k++)if(I.indexOf(V=F.charAt(k))<0){if(V=="."){if(W<k){W=j;continue}}else if(!N&&(F==F.toUpperCase()&&(F=F.toLowerCase())||F==F.toLowerCase()&&(F=F.toUpperCase()))){N=!0,k=-1,W=0;continue}return ne(Y,String(b),L,M)}-1<(W=(F=re(F,M,10,Y.s)).indexOf("."))?F=F.replace(".",""):W=F.length}for(k=0;F.charCodeAt(k)===48;k++);for(j=F.length;F.charCodeAt(--j)===48;);if(F=F.slice(k,++j)){if(j-=k,L&&X.DEBUG&&15<j&&(p<b||b!==u(b)))throw Error(h+Y.s*b);if(ee<(W=W-k-1))Y.c=Y.e=null;else if(W<Q)Y.c=[Y.e=0];else{if(Y.e=W,Y.c=[],k=(W+1)%g,W<0&&(k+=g),k<j){for(k&&Y.c.push(+F.slice(0,k)),j-=g;k<j;)Y.c.push(+F.slice(k,k+=g));F=F.slice(k),k=g-F.length}else k-=j;for(;k--;F+="0");Y.c.push(+F)}}else Y.c=[Y.e=0]}function Qe(b,M,I,V){var N,W,k,L,j;if(I==null?I=H:_(I,0,8),!b.c)return b.toString();if(N=b.c[0],k=b.e,M==null)j=S(b.c),j=V==1||V==2&&(k<=K||B<=k)?D(j,k):U(j,k,"0");else if(W=(b=Le(new X(b),M,I)).e,L=(j=S(b.c)).length,V==1||V==2&&(M<=W||W<=K)){for(;L<M;j+="0",L++);j=D(j,W)}else if(M-=k,j=U(j,W,"0"),L<W+1){if(0<--M)for(j+=".";M--;j+="0");}else if(0<(M+=W-L))for(W+1==L&&(j+=".");M--;j+="0");return b.s<0&&N?"-"+j:j}function Be(b,M){for(var I,V=1,N=new X(b[0]);V<b.length;V++){if(!(I=new X(b[V])).s){N=I;break}M.call(N,I)&&(N=I)}return N}function Te(b,M,I){for(var V=1,N=M.length;!M[--N];M.pop());for(N=M[0];10<=N;N/=10,V++);return(I=V+I*g-1)>ee?b.c=b.e=null:b.c=I<Q?[b.e=0]:(b.e=I,M),b}function Le(b,M,I,V){var N,W,k,L,j,F,Y,ae=b.c,pe=y;if(ae){e:{for(N=1,L=ae[0];10<=L;L/=10,N++);if((W=M-N)<0)W+=g,k=M,Y=(j=ae[F=0])/pe[N-k-1]%10|0;else if((F=l((W+1)/g))>=ae.length){if(!V)break e;for(;ae.length<=F;ae.push(0));j=Y=0,k=(W%=g)-g+(N=1)}else{for(j=L=ae[F],N=1;10<=L;L/=10,N++);Y=(k=(W%=g)-g+N)<0?0:j/pe[N-k-1]%10|0}if(V=V||M<0||ae[F+1]!=null||(k<0?j:j%pe[N-k-1]),V=I<4?(Y||V)&&(I==0||I==(b.s<0?3:2)):5<Y||Y==5&&(I==4||V||I==6&&(0<W?0<k?j/pe[N-k]:0:ae[F-1])%10&1||I==(b.s<0?8:7)),M<1||!ae[0])return ae.length=0,V?(M-=b.e+1,ae[0]=pe[(g-M%g)%g],b.e=-M||0):ae[0]=b.e=0,b;if(W==0?(ae.length=F,L=1,F--):(ae.length=F+1,L=pe[g-W],ae[F]=0<k?u(j/pe[N-k]%pe[k])*L:0),V)for(;;){if(F==0){for(W=1,k=ae[0];10<=k;k/=10,W++);for(k=ae[0]+=L,L=1;10<=k;k/=10,L++);W!=L&&(b.e++,ae[0]==f&&(ae[0]=1));break}if(ae[F]+=L,ae[F]!=f)break;ae[F--]=0,L=1}for(W=ae.length;ae[--W]===0;ae.pop());}b.e>ee?b.c=b.e=null:b.e<Q&&(b.c=[b.e=0])}return b}function xe(b){var M,I=b.e;return I===null?b.toString():(M=S(b.c),M=I<=K||B<=I?D(M,I):U(M,I,"0"),b.s<0?"-"+M:M)}return X.clone=z,X.ROUND_UP=0,X.ROUND_DOWN=1,X.ROUND_CEIL=2,X.ROUND_FLOOR=3,X.ROUND_HALF_UP=4,X.ROUND_HALF_DOWN=5,X.ROUND_HALF_EVEN=6,X.ROUND_HALF_CEIL=7,X.ROUND_HALF_FLOOR=8,X.EUCLID=9,X.config=X.set=function(b){var M,I;if(b!=null){if(typeof b!="object")throw Error(c+"Object expected: "+b);if(b.hasOwnProperty(M="DECIMAL_PLACES")&&(_(I=b[M],0,v,M),O=I),b.hasOwnProperty(M="ROUNDING_MODE")&&(_(I=b[M],0,8,M),H=I),b.hasOwnProperty(M="EXPONENTIAL_AT")&&((I=b[M])&&I.pop?(_(I[0],-v,0,M),_(I[1],0,v,M),K=I[0],B=I[1]):(_(I,-v,v,M),K=-(B=I<0?-I:I))),b.hasOwnProperty(M="RANGE"))if((I=b[M])&&I.pop)_(I[0],-v,-1,M),_(I[1],1,v,M),Q=I[0],ee=I[1];else{if(_(I,-v,v,M),!I)throw Error(c+M+" cannot be zero: "+I);Q=-(ee=I<0?-I:I)}if(b.hasOwnProperty(M="CRYPTO")){if((I=b[M])!==!!I)throw Error(c+M+" not true or false: "+I);if(I){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw q=!I,Error(c+"crypto unavailable");q=I}else q=I}if(b.hasOwnProperty(M="MODULO_MODE")&&(_(I=b[M],0,9,M),me=I),b.hasOwnProperty(M="POW_PRECISION")&&(_(I=b[M],0,v,M),He=I),b.hasOwnProperty(M="FORMAT")){if(typeof(I=b[M])!="object")throw Error(c+M+" not an object: "+I);Pe=I}if(b.hasOwnProperty(M="ALPHABET")){if(typeof(I=b[M])!="string"||/^.$|[+-.\s]|(.).*\1/.test(I))throw Error(c+M+" invalid: "+I);De=I}}return{DECIMAL_PLACES:O,ROUNDING_MODE:H,EXPONENTIAL_AT:[K,B],RANGE:[Q,ee],CRYPTO:q,MODULO_MODE:me,POW_PRECISION:He,FORMAT:Pe,ALPHABET:De}},X.isBigNumber=function(b){return b instanceof X||b&&b._isBigNumber===!0||!1},X.maximum=X.max=function(){return Be(arguments,w.lt)},X.minimum=X.min=function(){return Be(arguments,w.gt)},X.random=(he=9007199254740992,Me=Math.random()*he&2097151?function(){return u(Math.random()*he)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(b){var M,I,V,N,W,k=0,L=[],j=new X(x);if(b==null?b=O:_(b,0,v),N=l(b/g),q)if(crypto.getRandomValues){for(M=crypto.getRandomValues(new Uint32Array(N*=2));k<N;)9e15<=(W=131072*M[k]+(M[k+1]>>>11))?(I=crypto.getRandomValues(new Uint32Array(2)),M[k]=I[0],M[k+1]=I[1]):(L.push(W%1e14),k+=2);k=N/2}else{if(!crypto.randomBytes)throw q=!1,Error(c+"crypto unavailable");for(M=crypto.randomBytes(N*=7);k<N;)9e15<=(W=281474976710656*(31&M[k])+1099511627776*M[k+1]+4294967296*M[k+2]+16777216*M[k+3]+(M[k+4]<<16)+(M[k+5]<<8)+M[k+6])?crypto.randomBytes(7).copy(M,k):(L.push(W%1e14),k+=7);k=N/7}if(!q)for(;k<N;)(W=Me())<9e15&&(L[k++]=W%1e14);for(N=L[--k],b%=g,N&&b&&(W=y[g-b],L[k]=u(N/W)*W);L[k]===0;L.pop(),k--);if(k<0)L=[V=0];else{for(V=-1;L[0]===0;L.splice(0,1),V-=g);for(k=1,W=L[0];10<=W;W/=10,k++);k<g&&(V-=g-k)}return j.e=V,j.c=L,j}),X.sum=function(){for(var b=1,M=arguments,I=new X(M[0]);b<M.length;)I=I.plus(M[b++]);return I},re=function(){var b="0123456789";function M(I,V,N,W){for(var k,L,j=[0],F=0,Y=I.length;F<Y;){for(L=j.length;L--;j[L]*=V);for(j[0]+=W.indexOf(I.charAt(F++)),k=0;k<j.length;k++)j[k]>N-1&&(j[k+1]==null&&(j[k+1]=0),j[k+1]+=j[k]/N|0,j[k]%=N)}return j.reverse()}return function(I,V,N,W,k){var L,j,F,Y,ae,pe,_e,Ne,Ge=I.indexOf("."),Mt=O,tt=H;for(0<=Ge&&(Y=He,He=0,I=I.replace(".",""),pe=(Ne=new X(V)).pow(I.length-Ge),He=Y,Ne.c=M(U(S(pe.c),pe.e,"0"),10,N,b),Ne.e=Ne.c.length),F=Y=(_e=M(I,V,N,k?(L=De,b):(L=b,De))).length;_e[--Y]==0;_e.pop());if(!_e[0])return L.charAt(0);if(Ge<0?--F:(pe.c=_e,pe.e=F,pe.s=W,_e=(pe=Z(pe,Ne,Mt,tt,N)).c,ae=pe.r,F=pe.e),Ge=_e[j=F+Mt+1],Y=N/2,ae=ae||j<0||_e[j+1]!=null,ae=tt<4?(Ge!=null||ae)&&(tt==0||tt==(pe.s<0?3:2)):Y<Ge||Ge==Y&&(tt==4||ae||tt==6&&1&_e[j-1]||tt==(pe.s<0?8:7)),j<1||!_e[0])I=ae?U(L.charAt(1),-Mt,L.charAt(0)):L.charAt(0);else{if(_e.length=j,ae)for(--N;++_e[--j]>N;)_e[j]=0,j||(++F,_e=[1].concat(_e));for(Y=_e.length;!_e[--Y];);for(Ge=0,I="";Ge<=Y;I+=L.charAt(_e[Ge++]));I=U(I,F,L.charAt(0))}return I}}(),Z=function(){function b(V,N,W){var k,L,j,F,Y=0,ae=V.length,pe=N%E,_e=N/E|0;for(V=V.slice();ae--;)Y=((L=pe*(j=V[ae]%E)+(k=_e*j+(F=V[ae]/E|0)*pe)%E*E+Y)/W|0)+(k/E|0)+_e*F,V[ae]=L%W;return Y&&(V=[Y].concat(V)),V}function M(V,N,W,k){var L,j;if(W!=k)j=k<W?1:-1;else for(L=j=0;L<W;L++)if(V[L]!=N[L]){j=V[L]>N[L]?1:-1;break}return j}function I(V,N,W,k){for(var L=0;W--;)V[W]-=L,L=V[W]<N[W]?1:0,V[W]=L*k+V[W]-N[W];for(;!V[0]&&1<V.length;V.splice(0,1));}return function(V,N,W,k,L){var j,F,Y,ae,pe,_e,Ne,Ge,Mt,tt,mt,kt,vu,wh,tn,Nn,el,ar=V.s==N.s?1:-1,yn=V.c,Pt=N.c;if(!(yn&&yn[0]&&Pt&&Pt[0]))return new X(V.s&&N.s&&(yn?!Pt||yn[0]!=Pt[0]:Pt)?yn&&yn[0]==0||!Pt?0*ar:ar/0:NaN);for(Mt=(Ge=new X(ar)).c=[],ar=W+(F=V.e-N.e)+1,L||(L=f,F=C(V.e/g)-C(N.e/g),ar=ar/g|0),Y=0;Pt[Y]==(yn[Y]||0);Y++);if(Pt[Y]>(yn[Y]||0)&&F--,ar<0)Mt.push(1),ae=!0;else{for(wh=yn.length,Nn=Pt.length,ar+=2,1<(pe=u(L/(Pt[Y=0]+1)))&&(Pt=b(Pt,pe,L),yn=b(yn,pe,L),Nn=Pt.length,wh=yn.length),vu=Nn,mt=(tt=yn.slice(0,Nn)).length;mt<Nn;tt[mt++]=0);el=Pt.slice(),el=[0].concat(el),tn=Pt[0],Pt[1]>=L/2&&tn++;do{if(pe=0,(j=M(Pt,tt,Nn,mt))<0){if(kt=tt[0],Nn!=mt&&(kt=kt*L+(tt[1]||0)),1<(pe=u(kt/tn)))for(L<=pe&&(pe=L-1),Ne=(_e=b(Pt,pe,L)).length,mt=tt.length;M(_e,tt,Ne,mt)==1;)pe--,I(_e,Nn<Ne?el:Pt,Ne,L),Ne=_e.length,j=1;else pe==0&&(j=pe=1),Ne=(_e=Pt.slice()).length;if(Ne<mt&&(_e=[0].concat(_e)),I(tt,_e,mt,L),mt=tt.length,j==-1)for(;M(Pt,tt,Nn,mt)<1;)pe++,I(tt,Nn<mt?el:Pt,mt,L),mt=tt.length}else j===0&&(pe++,tt=[0]);Mt[Y++]=pe,tt[0]?tt[mt++]=yn[vu]||0:(tt=[yn[vu]],mt=1)}while((vu++<wh||tt[0]!=null)&&ar--);ae=tt[0]!=null,Mt[0]||Mt.splice(0,1)}if(L==f){for(Y=1,ar=Mt[0];10<=ar;ar/=10,Y++);Le(Ge,W+(Ge.e=Y+F*g-1)+1,k,ae)}else Ge.e=F,Ge.r=+ae;return Ge}}(),Ve=/^(-?)0([xbo])(?=\w[\w.]*$)/i,ke=/^([^.]+)\.$/,R=/^\.([^.]+)$/,d=/^-?(Infinity|NaN)$/,m=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ne=function(b,M,I,V){var N,W=I?M:M.replace(m,"");if(d.test(W))b.s=isNaN(W)?null:W<0?-1:1,b.c=b.e=null;else{if(!I&&(W=W.replace(Ve,function(k,L,j){return N=(j=j.toLowerCase())=="x"?16:j=="b"?2:8,V&&V!=N?k:L}),V&&(N=V,W=W.replace(ke,"$1").replace(R,"0.$1")),M!=W))return new X(W,N);if(X.DEBUG)throw Error(c+"Not a"+(V?" base "+V:"")+" number: "+M);b.c=b.e=b.s=null}},w.absoluteValue=w.abs=function(){var b=new X(this);return b.s<0&&(b.s=1),b},w.comparedTo=function(b,M){return T(this,new X(b,M))},w.decimalPlaces=w.dp=function(b,M){var I,V,N;if(b!=null)return _(b,0,v),M==null?M=H:_(M,0,8),Le(new X(this),b+this.e+1,M);if(!(I=this.c))return null;if(V=((N=I.length-1)-C(this.e/g))*g,N=I[N])for(;N%10==0;N/=10,V--);return V<0&&(V=0),V},w.dividedBy=w.div=function(b,M){return Z(this,new X(b,M),O,H)},w.dividedToIntegerBy=w.idiv=function(b,M){return Z(this,new X(b,M),0,1)},w.exponentiatedBy=w.pow=function(b,M){var I,V,N,W,k,L,j,F,Y=this;if((b=new X(b)).c&&!b.isInteger())throw Error(c+"Exponent not an integer: "+xe(b));if(M!=null&&(M=new X(M)),k=14<b.e,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!b.c||!b.c[0])return F=new X(Math.pow(+xe(Y),k?2-A(b):+xe(b))),M?F.mod(M):F;if(L=b.s<0,M){if(M.c?!M.c[0]:!M.s)return new X(NaN);(V=!L&&Y.isInteger()&&M.isInteger())&&(Y=Y.mod(M))}else{if(9<b.e&&(0<Y.e||Y.e<-1||(Y.e==0?1<Y.c[0]||k&&24e7<=Y.c[1]:Y.c[0]<8e13||k&&Y.c[0]<=9999975e7)))return W=Y.s<0&&A(b)?-0:0,-1<Y.e&&(W=1/W),new X(L?1/W:W);He&&(W=l(He/g+2))}for(j=k?(I=new X(.5),L&&(b.s=1),A(b)):(N=Math.abs(+xe(b)))%2,F=new X(x);;){if(j){if(!(F=F.times(Y)).c)break;W?F.c.length>W&&(F.c.length=W):V&&(F=F.mod(M))}if(N){if((N=u(N/2))===0)break;j=N%2}else if(Le(b=b.times(I),b.e+1,1),14<b.e)j=A(b);else{if((N=+xe(b))==0)break;j=N%2}Y=Y.times(Y),W?Y.c&&Y.c.length>W&&(Y.c.length=W):V&&(Y=Y.mod(M))}return V?F:(L&&(F=x.div(F)),M?F.mod(M):W?Le(F,He,H,void 0):F)},w.integerValue=function(b){var M=new X(this);return b==null?b=H:_(b,0,8),Le(M,M.e+1,b)},w.isEqualTo=w.eq=function(b,M){return T(this,new X(b,M))===0},w.isFinite=function(){return!!this.c},w.isGreaterThan=w.gt=function(b,M){return 0<T(this,new X(b,M))},w.isGreaterThanOrEqualTo=w.gte=function(b,M){return(M=T(this,new X(b,M)))===1||M===0},w.isInteger=function(){return!!this.c&&C(this.e/g)>this.c.length-2},w.isLessThan=w.lt=function(b,M){return T(this,new X(b,M))<0},w.isLessThanOrEqualTo=w.lte=function(b,M){return(M=T(this,new X(b,M)))===-1||M===0},w.isNaN=function(){return!this.s},w.isNegative=function(){return this.s<0},w.isPositive=function(){return 0<this.s},w.isZero=function(){return!!this.c&&this.c[0]==0},w.minus=function(b,M){var I,V,N,W,k=this,L=k.s;if(M=(b=new X(b,M)).s,!L||!M)return new X(NaN);if(L!=M)return b.s=-M,k.plus(b);var j=k.e/g,F=b.e/g,Y=k.c,ae=b.c;if(!j||!F){if(!Y||!ae)return Y?(b.s=-M,b):new X(ae?k:NaN);if(!Y[0]||!ae[0])return ae[0]?(b.s=-M,b):new X(Y[0]?k:H==3?-0:0)}if(j=C(j),F=C(F),Y=Y.slice(),L=j-F){for((N=(W=L<0)?(L=-L,Y):(F=j,ae)).reverse(),M=L;M--;N.push(0));N.reverse()}else for(V=(W=(L=Y.length)<(M=ae.length))?L:M,L=M=0;M<V;M++)if(Y[M]!=ae[M]){W=Y[M]<ae[M];break}if(W&&(N=Y,Y=ae,ae=N,b.s=-b.s),0<(M=(V=ae.length)-(I=Y.length)))for(;M--;Y[I++]=0);for(M=f-1;L<V;){if(Y[--V]<ae[V]){for(I=V;I&&!Y[--I];Y[I]=M);--Y[I],Y[V]+=f}Y[V]-=ae[V]}for(;Y[0]==0;Y.splice(0,1),--F);return Y[0]?Te(b,Y,F):(b.s=H==3?-1:1,b.c=[b.e=0],b)},w.modulo=w.mod=function(b,M){var I,V,N=this;return b=new X(b,M),!N.c||!b.s||b.c&&!b.c[0]?new X(NaN):!b.c||N.c&&!N.c[0]?new X(N):(me==9?(V=b.s,b.s=1,I=Z(N,b,0,3),b.s=V,I.s*=V):I=Z(N,b,0,me),(b=N.minus(I.times(b))).c[0]||me!=1||(b.s=N.s),b)},w.multipliedBy=w.times=function(b,M){var I,V,N,W,k,L,j,F,Y,ae,pe,_e,Ne,Ge,Mt,tt=this,mt=tt.c,kt=(b=new X(b,M)).c;if(!(mt&&kt&&mt[0]&&kt[0]))return!tt.s||!b.s||mt&&!mt[0]&&!kt||kt&&!kt[0]&&!mt?b.c=b.e=b.s=null:(b.s*=tt.s,mt&&kt?(b.c=[0],b.e=0):b.c=b.e=null),b;for(V=C(tt.e/g)+C(b.e/g),b.s*=tt.s,(j=mt.length)<(ae=kt.length)&&(Ne=mt,mt=kt,kt=Ne,N=j,j=ae,ae=N),N=j+ae,Ne=[];N--;Ne.push(0));for(Ge=f,Mt=E,N=ae;0<=--N;){for(I=0,pe=kt[N]%Mt,_e=kt[N]/Mt|0,W=N+(k=j);N<W;)I=((F=pe*(F=mt[--k]%Mt)+(L=_e*F+(Y=mt[k]/Mt|0)*pe)%Mt*Mt+Ne[W]+I)/Ge|0)+(L/Mt|0)+_e*Y,Ne[W--]=F%Ge;Ne[W]=I}return I?++V:Ne.splice(0,1),Te(b,Ne,V)},w.negated=function(){var b=new X(this);return b.s=-b.s||null,b},w.plus=function(b,M){var I,V=this,N=V.s;if(M=(b=new X(b,M)).s,!N||!M)return new X(NaN);if(N!=M)return b.s=-M,V.minus(b);var W=V.e/g,k=b.e/g,L=V.c,j=b.c;if(!W||!k){if(!L||!j)return new X(N/0);if(!L[0]||!j[0])return j[0]?b:new X(L[0]?V:0*N)}if(W=C(W),k=C(k),L=L.slice(),N=W-k){for((I=0<N?(k=W,j):(N=-N,L)).reverse();N--;I.push(0));I.reverse()}for((N=L.length)-(M=j.length)<0&&(I=j,j=L,L=I,M=N),N=0;M;)N=(L[--M]=L[M]+j[M]+N)/f|0,L[M]=f===L[M]?0:L[M]%f;return N&&(L=[N].concat(L),++k),Te(b,L,k)},w.precision=w.sd=function(b,M){var I,V,N;if(b!=null&&b!==!!b)return _(b,1,v),M==null?M=H:_(M,0,8),Le(new X(this),b,M);if(!(I=this.c))return null;if(V=(N=I.length-1)*g+1,N=I[N]){for(;N%10==0;N/=10,V--);for(N=I[0];10<=N;N/=10,V++);}return b&&this.e+1>V&&(V=this.e+1),V},w.shiftedBy=function(b){return _(b,-p,p),this.times("1e"+b)},w.squareRoot=w.sqrt=function(){var b,M,I,V,N,W=this,k=W.c,L=W.s,j=W.e,F=O+4,Y=new X("0.5");if(L!==1||!k||!k[0])return new X(!L||L<0&&(!k||k[0])?NaN:k?W:1/0);if((I=(L=Math.sqrt(+xe(W)))==0||L==1/0?(((M=S(k)).length+j)%2==0&&(M+="0"),L=Math.sqrt(+M),j=C((j+1)/2)-(j<0||j%2),new X(M=L==1/0?"1e"+j:(M=L.toExponential()).slice(0,M.indexOf("e")+1)+j)):new X(L+"")).c[0]){for((L=(j=I.e)+F)<3&&(L=0);;)if(N=I,I=Y.times(N.plus(Z(W,N,F,1))),S(N.c).slice(0,L)===(M=S(I.c)).slice(0,L)){if(I.e<j&&--L,(M=M.slice(L-3,L+1))!="9999"&&(V||M!="4999")){+M&&(+M.slice(1)||M.charAt(0)!="5")||(Le(I,I.e+O+2,1),b=!I.times(I).eq(W));break}if(!V&&(Le(N,N.e+O+2,0),N.times(N).eq(W))){I=N;break}F+=4,L+=4,V=1}}return Le(I,I.e+O+1,H,b)},w.toExponential=function(b,M){return b!=null&&(_(b,0,v),b++),Qe(this,b,M,1)},w.toFixed=function(b,M){return b!=null&&(_(b,0,v),b=b+this.e+1),Qe(this,b,M)},w.toFormat=function(b,M,I){var V;if(I==null)b!=null&&M&&typeof M=="object"?(I=M,M=null):b&&typeof b=="object"?(I=b,b=M=null):I=Pe;else if(typeof I!="object")throw Error(c+"Argument not an object: "+I);if(V=this.toFixed(b,M),this.c){var N,W=V.split("."),k=+I.groupSize,L=+I.secondaryGroupSize,j=I.groupSeparator||"",F=W[0],Y=W[1],ae=this.s<0,pe=ae?F.slice(1):F,_e=pe.length;if(L&&(N=k,k=L,_e-=L=N),0<k&&0<_e){for(N=_e%k||k,F=pe.substr(0,N);N<_e;N+=k)F+=j+pe.substr(N,k);0<L&&(F+=j+pe.slice(N)),ae&&(F="-"+F)}V=Y?F+(I.decimalSeparator||"")+((L=+I.fractionGroupSize)?Y.replace(new RegExp("\\d{"+L+"}\\B","g"),"$&"+(I.fractionGroupSeparator||"")):Y):F}return(I.prefix||"")+V+(I.suffix||"")},w.toFraction=function(b){var M,I,V,N,W,k,L,j,F,Y,ae,pe,_e=this,Ne=_e.c;if(b!=null&&(!(L=new X(b)).isInteger()&&(L.c||L.s!==1)||L.lt(x)))throw Error(c+"Argument "+(L.isInteger()?"out of range: ":"not an integer: ")+xe(L));if(!Ne)return new X(_e);for(M=new X(x),F=I=new X(x),V=j=new X(x),pe=S(Ne),W=M.e=pe.length-_e.e-1,M.c[0]=y[(k=W%g)<0?g+k:k],b=!b||0<L.comparedTo(M)?0<W?M:F:L,k=ee,ee=1/0,L=new X(pe),j.c[0]=0;Y=Z(L,M,0,1),(N=I.plus(Y.times(V))).comparedTo(b)!=1;)I=V,V=N,F=j.plus(Y.times(N=F)),j=N,M=L.minus(Y.times(N=M)),L=N;return N=Z(b.minus(I),V,0,1),j=j.plus(N.times(F)),I=I.plus(N.times(V)),j.s=F.s=_e.s,ae=Z(F,V,W*=2,H).minus(_e).abs().comparedTo(Z(j,I,W,H).minus(_e).abs())<1?[F,V]:[j,I],ee=k,ae},w.toNumber=function(){return+xe(this)},w.toPrecision=function(b,M){return b!=null&&_(b,1,v),Qe(this,b,M,2)},w.toString=function(b){var M,I=this,V=I.s,N=I.e;return N===null?V?(M="Infinity",V<0&&(M="-"+M)):M="NaN":(M=b==null?N<=K||B<=N?D(S(I.c),N):U(S(I.c),N,"0"):b===10?U(S((I=Le(new X(I),O+N+1,H)).c),I.e,"0"):(_(b,2,De.length,"Base"),re(U(S(I.c),N,"0"),10,b,V,!0)),V<0&&I.c[0]&&(M="-"+M)),M},w.valueOf=w.toJSON=function(){return xe(this)},w._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(w[Symbol.toStringTag]="BigNumber",w[Symbol.for("nodejs.util.inspect.custom")]=w.valueOf),G!=null&&X.set(G),X}()).default=s.BigNumber=s,r!==void 0&&r.exports?r.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(n,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,r,i){function o(C,S){return function(T){if(Array.isArray(T))return T}(C)||function(T,_){var A=[],D=!0,U=!1,z=void 0;try{for(var G,Z=T[Symbol.iterator]();!(D=(G=Z.next()).done)&&(A.push(G.value),!_||A.length!==_);D=!0);}catch(re){U=!0,z=re}finally{try{D||Z.return==null||Z.return()}finally{if(U)throw z}}return A}(C,S)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=n("./globalState"),a=n("./validating"),l=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function f(C){var S=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},T=2<arguments.length?arguments[2]:void 0;if(typeof S=="string"&&(S=l.parseFormat(S)),!a.validateFormat(S))return"ERROR: invalid format";var _=S.prefix||"",A=S.postfix||"",D=function(U,z,G){switch(z.output){case"currency":return z=v(z,s.currentCurrencyDefaultFormat()),function(De,X,Qe){var Be=Qe.currentCurrency(),Te=Object.assign({},h,X),Le=void 0,xe="",b=!!Te.totalLength||!!Te.forceAverage||Te.average,M=X.currencyPosition||Be.position,I=X.currencySymbol||Be.symbol;Te.spaceSeparated&&(xe=" "),M==="infix"&&(Le=xe+I+xe);var V=E({instance:De,providedFormat:X,state:Qe,decimalSeparator:Le});return M==="prefix"&&(V=De._value<0&&Te.negative==="sign"?"-".concat(xe).concat(I).concat(V.slice(1)):I+xe+V),M&&M!=="postfix"||(V=V+(xe=b?"":xe)+I),V}(U,z,s);case"percent":return z=v(z,s.currentPercentageDefaultFormat()),function(De,X,Qe,Be){var Te=X.prefixSymbol,Le=E({instance:Be(100*De._value),providedFormat:X,state:Qe}),xe=Object.assign({},h,X);return Te?"%".concat(xe.spaceSeparated?" ":"").concat(Le):"".concat(Le).concat(xe.spaceSeparated?" ":"","%")}(U,z,s,G);case"byte":return z=v(z,s.currentByteDefaultFormat()),x=U,H=s,K=G,B=(O=z).base||"binary",Q=c[B],ee=g(x._value,Q.suffixes,Q.scale),q=ee.value,me=ee.suffix,He=E({instance:K(q),providedFormat:O,state:H,defaults:H.currentByteDefaultFormat()}),Pe=H.currentAbbreviations(),"".concat(He).concat(Pe.spaced?" ":"").concat(me);case"time":return z=v(z,s.currentTimeDefaultFormat()),R=U,d=Math.floor(R._value/60/60),m=Math.floor((R._value-60*d*60)/60),w=Math.round(R._value-60*d*60-60*m),"".concat(d,":").concat(m<10?"0":"").concat(m,":").concat(w<10?"0":"").concat(w);case"ordinal":return z=v(z,s.currentOrdinalDefaultFormat()),Z=U,re=z,he=(ne=s).currentOrdinal(),Me=Object.assign({},h,re),Ve=E({instance:Z,providedFormat:re,state:ne}),ke=he(Z._value),"".concat(Ve).concat(Me.spaceSeparated?" ":"").concat(ke);case"number":default:return E({instance:U,providedFormat:z,numbro:G})}var Z,re,ne,he,Me,Ve,ke,R,d,m,w,x,O,H,K,B,Q,ee,q,me,He,Pe}(C,S,T);return D=(D=_+D)+A}function g(C,S,T){var _=S[0],A=Math.abs(C);if(T<=A){for(var D=1;D<S.length;++D){var U=Math.pow(T,D),z=Math.pow(T,D+1);if(U<=A&&A<z){_=S[D],C/=U;break}}_===S[0]&&(C/=Math.pow(T,S.length-1),_=S[S.length-1])}return{value:C,suffix:_}}function p(C){for(var S="",T=0;T<C;T++)S+="0";return S}function y(C,S){return C.toString().indexOf("e")!==-1?function(T,_){var A=T.toString(),D=o(A.split("e"),2),U=D[0],z=D[1],G=o(U.split("."),2),Z=G[0],re=G[1],ne=re===void 0?"":re;if(0<+z)A=Z+ne+p(z-ne.length);else{var he=".";he=+Z<0?"-0".concat(he):"0".concat(he);var Me=(p(-z-1)+Math.abs(Z)+ne).substr(0,_);Me.length<_&&(Me+=p(_-Me.length)),A=he+Me}return 0<+z&&0<_&&(A+=".".concat(p(_))),A}(C,S):(Math.round(+"".concat(C,"e+").concat(S))/Math.pow(10,S)).toFixed(S)}function E(C){var S=C.instance,T=C.providedFormat,_=C.state,A=_===void 0?s:_,D=C.decimalSeparator,U=C.defaults,z=U===void 0?A.currentDefaults():U,G=S._value;if(G===0&&A.hasZeroFormat())return A.getZeroFormat();if(!isFinite(G))return G.toString();var Z,re,ne,he,Me,Ve,ke,R,d=Object.assign({},h,z,T),m=d.totalLength,w=m?0:d.characteristic,x=d.optionalCharacteristic,O=d.forceAverage,H=!!m||!!O||d.average,K=m?-1:H&&T.mantissa===void 0?0:d.mantissa,B=!m&&(T.optionalMantissa===void 0?K===-1:d.optionalMantissa),Q=d.trimMantissa,ee=d.thousandSeparated,q=d.spaceSeparated,me=d.negative,He=d.forceSign,Pe=d.exponential,De="";if(H){var X=function(b){var M=b.value,I=b.forceAverage,V=b.abbreviations,N=b.spaceSeparated,W=N!==void 0&&N,k=b.totalLength,L=k===void 0?0:k,j="",F=Math.abs(M),Y=-1;if(F>=Math.pow(10,12)&&!I||I==="trillion"?(j=V.trillion,M/=Math.pow(10,12)):F<Math.pow(10,12)&&F>=Math.pow(10,9)&&!I||I==="billion"?(j=V.billion,M/=Math.pow(10,9)):F<Math.pow(10,9)&&F>=Math.pow(10,6)&&!I||I==="million"?(j=V.million,M/=Math.pow(10,6)):(F<Math.pow(10,6)&&F>=Math.pow(10,3)&&!I||I==="thousand")&&(j=V.thousand,M/=Math.pow(10,3)),j&&(j=(W?" ":"")+j),L){var ae=M.toString().split(".")[0];Y=Math.max(L-ae.length,0)}return{value:M,abbreviation:j,mantissaPrecision:Y}}({value:G,forceAverage:O,abbreviations:A.currentAbbreviations(),spaceSeparated:q,totalLength:m});G=X.value,De+=X.abbreviation,m&&(K=X.mantissaPrecision)}if(Pe){var Qe=(re=(Z={value:G,characteristicPrecision:w}).value,ne=Z.characteristicPrecision,he=ne===void 0?0:ne,Me=o(re.toExponential().split("e"),2),Ve=Me[0],ke=Me[1],R=+Ve,he&&1<he&&(R*=Math.pow(10,he-1),ke=0<=(ke=+ke-(he-1))?"+".concat(ke):ke),{value:R,abbreviation:"e".concat(ke)});G=Qe.value,De=Qe.abbreviation+De}var Be,Te,Le,xe=function(b,M,I,V,N){if(V===-1)return b;var W=y(M,V),k=o(W.toString().split("."),2),L=k[0],j=k[1],F=j===void 0?"":j;if(F.match(/^0+$/)&&(I||N))return L;var Y=F.match(/0+$/);return N&&Y?"".concat(L,".").concat(F.toString().slice(0,Y.index)):W.toString()}(G.toString(),G,B,K,Q);return xe=function(b,M,I,V,N){var W=V.currentDelimiters(),k=W.thousands;N=N||W.decimal;var L=W.thousandsSize||3,j=b.toString(),F=j.split(".")[0],Y=j.split(".")[1];return I&&(M<0&&(F=F.slice(1)),function(ae,pe){for(var _e=[],Ne=0,Ge=ae;0<Ge;Ge--)Ne===pe&&(_e.unshift(Ge),Ne=0),Ne++;return _e}(F.length,L).forEach(function(ae,pe){F=F.slice(0,ae+pe)+k+F.slice(ae+pe)}),M<0&&(F="-".concat(F))),j=Y?F+N+Y:F}(xe=function(b,M,I,V){var N=b,W=o(N.toString().split("."),2),k=W[0],L=W[1];if(k.match(/^-?0$/)&&I)return L?"".concat(k.replace("0",""),".").concat(L):k.replace("0","");if(k.length<V)for(var j=V-k.length,F=0;F<j;F++)N="0".concat(N);return N.toString()}(xe,0,x,w),G,ee,A,D),(H||Pe)&&(xe=xe+De),(He||G<0)&&(Be=xe,Le=me,xe=(Te=G)===0?Be:+Be==0?Be.replace("-",""):0<Te?"+".concat(Be):Le==="sign"?Be:"(".concat(Be.replace("-",""),")")),xe}function v(C,S){if(!C)return S;var T=Object.keys(C);return T.length===1&&T[0]==="output"?S:C}r.exports=function(C){return{format:function(){for(var S=arguments.length,T=new Array(S),_=0;_<S;_++)T[_]=arguments[_];return f.apply(void 0,T.concat([C]))},getByteUnit:function(){for(var S=arguments.length,T=new Array(S),_=0;_<S;_++)T[_]=arguments[_];return(function(A){var D=c.general;return g(A._value,D.suffixes,D.scale).suffix}).apply(void 0,T.concat([C]))},getBinaryByteUnit:function(){for(var S=arguments.length,T=new Array(S),_=0;_<S;_++)T[_]=arguments[_];return(function(A){var D=c.binary;return g(A._value,D.suffixes,D.scale).suffix}).apply(void 0,T.concat([C]))},getDecimalByteUnit:function(){for(var S=arguments.length,T=new Array(S),_=0;_<S;_++)T[_]=arguments[_];return(function(A){var D=c.decimal;return g(A._value,D.suffixes,D.scale).suffix}).apply(void 0,T.concat([C]))},formatOrDefault:v}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,r,i){var o=n("./en-US"),s=n("./validating"),a=n("./parsing"),l={},u=void 0,c={},h=null,f={};function g(y){u=y}function p(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return p().currency},l.currentAbbreviations=function(){return p().abbreviations},l.currentDelimiters=function(){return p().delimiters},l.currentOrdinal=function(){return p().ordinal},l.currentDefaults=function(){return Object.assign({},p().defaults,f)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().timeFormat)},l.setDefaults=function(y){y=a.parseFormat(y),s.validateFormat(y)&&(f=y)},l.getZeroFormat=function(){return h},l.setZeroFormat=function(y){return h=typeof y=="string"?y:null},l.hasZeroFormat=function(){return h!==null},l.languageData=function(y){if(y){if(c[y])return c[y];throw new Error('Unknown tag "'.concat(y,'"'))}return p()},l.registerLanguage=function(y){var E=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(y))throw new Error("Invalid language data");c[y.languageTag]=y,E&&g(y.languageTag)},l.setLanguage=function(y){var E=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[y]){var v=y.split("-")[0],C=Object.keys(c).find(function(S){return S.split("-")[0]===v});return c[C]?void g(C):void g(E)}g(y)},l.registerLanguage(o),u=o.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,r,i){r.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(l){var u=void 0;try{u=n("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(n,r,i){var o=n("bignumber.js");function s(a,l,u){var c=new o(a._value),h=l;return u.isNumbro(l)&&(h=l._value),h=new o(h),a._value=c.minus(h).toNumber(),a}r.exports=function(a){return{add:function(l,u){return h=u,f=a,g=new o((c=l)._value),p=h,f.isNumbro(h)&&(p=h._value),p=new o(p),c._value=g.plus(p).toNumber(),c;var c,h,f,g,p},subtract:function(l,u){return s(l,u,a)},multiply:function(l,u){return h=u,f=a,g=new o((c=l)._value),p=h,f.isNumbro(h)&&(p=h._value),p=new o(p),c._value=g.times(p).toNumber(),c;var c,h,f,g,p},divide:function(l,u){return h=u,f=a,g=new o((c=l)._value),p=h,f.isNumbro(h)&&(p=h._value),p=new o(p),c._value=g.dividedBy(p).toNumber(),c;var c,h,f,g,p},set:function(l,u){return c=l,f=h=u,a.isNumbro(h)&&(f=h._value),c._value=f,c;var c,h,f},difference:function(l,u){return c=u,s(f=(h=a)(l._value),c,h),Math.abs(f._value);var c,h,f}}}},{"bignumber.js":1}],7:[function(n,r,i){function o(E,v){for(var C=0;C<v.length;C++){var S=v[C];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(E,S.key,S)}}var s=n("./globalState"),a=n("./validating"),l=n("./loading")(y),u=n("./unformatting"),c=n("./formatting")(y),h=n("./manipulating")(y),f=n("./parsing"),g=function(){function E(S){(function(T,_){if(!(T instanceof _))throw new TypeError("Cannot call a class as a function")})(this,E),this._value=S}var v,C;return v=E,(C=[{key:"clone",value:function(){return y(this._value)}},{key:"format",value:function(){var S=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,S)}},{key:"formatCurrency",value:function(S){return typeof S=="string"&&(S=f.parseFormat(S)),(S=c.formatOrDefault(S,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,S)}},{key:"formatTime",value:function(){var S=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return S.output="time",c.format(this,S)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(S){return h.difference(this,S)}},{key:"add",value:function(S){return h.add(this,S)}},{key:"subtract",value:function(S){return h.subtract(this,S)}},{key:"multiply",value:function(S){return h.multiply(this,S)}},{key:"divide",value:function(S){return h.divide(this,S)}},{key:"set",value:function(S){return h.set(this,p(S))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(v.prototype,C),E}();function p(E){var v=E;return y.isNumbro(E)?v=E._value:typeof E=="string"?v=y.unformat(E):isNaN(E)&&(v=NaN),v}function y(E){return new g(p(E))}y.version="2.1.2",y.isNumbro=function(E){return E instanceof g},y.language=s.currentLanguage,y.registerLanguage=s.registerLanguage,y.setLanguage=s.setLanguage,y.languages=s.languages,y.languageData=s.languageData,y.zeroFormat=s.setZeroFormat,y.defaultFormat=s.currentDefaults,y.setDefaults=s.setDefaults,y.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,y.validate=a.validate,y.loadLanguagesInNode=l.loadLanguagesInNode,y.unformat=u.unformat,r.exports=y},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,r,i){r.exports={parseFormat:function(o){var s,a,l,u,c,h,f,g,p,y,E,v,C,S,T,_,A,D,U,z,G=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=G,o=(l=(s=o).match(/^{([^}]*)}/))?(a.prefix=l[1],s.slice(l[0].length)):s,c=G,function(Z,re){if(Z.indexOf("$")===-1){if(Z.indexOf("%")===-1)return Z.indexOf("bd")!==-1?(re.output="byte",re.base="general"):Z.indexOf("b")!==-1?(re.output="byte",re.base="binary"):Z.indexOf("d")!==-1?(re.output="byte",re.base="decimal"):Z.indexOf(":")===-1?Z.indexOf("o")!==-1&&(re.output="ordinal"):re.output="time";re.output="percent"}else re.output="currency"}(o=(h=(u=o).match(/{([^}]*)}$/))?(c.postfix=h[1],u.slice(0,-h[0].length)):u,G),f=G,(g=o.match(/[1-9]+[0-9]*/))&&(f.totalLength=+g[0]),p=G,(y=o.split(".")[0].match(/0+/))&&(p.characteristic=y[0].length),function(Z,re){if(Z.indexOf(".")!==-1){var ne=Z.split(".")[0];re.optionalCharacteristic=ne.indexOf("0")===-1}}(o,G),E=G,o.indexOf("a")!==-1&&(E.average=!0),C=G,(v=o).indexOf("K")!==-1?C.forceAverage="thousand":v.indexOf("M")!==-1?C.forceAverage="million":v.indexOf("B")!==-1?C.forceAverage="billion":v.indexOf("T")!==-1&&(C.forceAverage="trillion"),function(Z,re){var ne=Z.split(".")[1];if(ne){var he=ne.match(/0+/);he&&(re.mantissa=he[0].length)}}(o,G),T=G,(S=o).match(/\[\.]/)?T.optionalMantissa=!0:S.match(/\./)&&(T.optionalMantissa=!1),_=G,o.indexOf(",")!==-1&&(_.thousandSeparated=!0),A=G,o.indexOf(" ")!==-1&&(A.spaceSeparated=!0),U=G,(D=o).match(/^\+?\([^)]*\)$/)&&(U.negative="parenthesis"),D.match(/^\+?-/)&&(U.negative="sign"),z=G,o.match(/^\+/)&&(z.forceSign=!0),G)}}},{}],9:[function(n,r,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<arguments.length?arguments[5]:void 0,p=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===f?0:function y(E,v){var C=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=3<arguments.length?arguments[3]:void 0,T=4<arguments.length?arguments[4]:void 0,_=5<arguments.length?arguments[5]:void 0,A=6<arguments.length?arguments[6]:void 0;if(!isNaN(+E))return+E;var D="",U=E.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(U!==E)return-1*y(U,v,C,S,T,_,A);for(var z=0;z<o.length;z++){var G=o[z];if((D=E.replace(G.key,""))!==E)return y(D,v,C,S,T,_,A)*G.factor}if((D=E.replace("%",""))!==E)return y(D,v,C,S,T,_,A)/100;var Z=parseFloat(E);if(!isNaN(Z)){var re=S(Z);if(re&&re!=="."&&(D=E.replace(new RegExp("".concat(s(re),"$")),""))!==E)return y(D,v,C,S,T,_,A);var ne={};Object.keys(_).forEach(function(m){ne[_[m]]=m});for(var he=Object.keys(ne).sort().reverse(),Me=he.length,Ve=0;Ve<Me;Ve++){var ke=he[Ve],R=ne[ke];if((D=E.replace(ke,""))!==E){var d=void 0;switch(R){case"thousand":d=Math.pow(10,3);break;case"million":d=Math.pow(10,6);break;case"billion":d=Math.pow(10,9);break;case"trillion":d=Math.pow(10,12)}return y(D,v,C,S,T,_,A)*d}}}}(function(y,E){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",C=y.replace(v,"");return C=(C=C.replace(new RegExp("([0-9])".concat(s(E.thousands),"([0-9])"),"g"),"$1$2")).replace(E.decimal,".")}(l,u,c),u,c,h,f,g,p)}r.exports={unformat:function(l,u){var c,h,f,g=n("./globalState"),p=g.currentDelimiters(),y=g.currentCurrency().symbol,E=g.currentOrdinal(),v=g.getZeroFormat(),C=g.currentAbbreviations(),S=void 0;if(typeof l=="string")S=function(T,_){if(!T.indexOf(":")||_.thousands===":")return!1;var A=T.split(":");if(A.length!==3)return!1;var D=+A[0],U=+A[1],z=+A[2];return!isNaN(D)&&!isNaN(U)&&!isNaN(z)}(l,p)?(c=l.split(":"),h=+c[0],f=+c[1],+c[2]+60*f+3600*h):a(l,p,y,E,v,C,u);else{if(typeof l!="number")return;S=l}if(S!==void 0)return S}}},{"./globalState":4}],10:[function(n,r,i){function o(p){return function(y){if(Array.isArray(y)){for(var E=0,v=new Array(y.length);E<y.length;E++)v[E]=y[E];return v}}(p)||function(y){if(Symbol.iterator in Object(y)||Object.prototype.toString.call(y)==="[object Arguments]")return Array.from(y)}(p)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(p){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(p)}var a=n("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(p,y){return y.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(p){return p.output==="byte"}},characteristic:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(p){return 0<=p},message:"value must be positive"},{restriction:function(p,y){return!y.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(p,y){return y.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(p){return p.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(p){return!!a.unformat(p)}function f(p,y,E){var v=3<arguments.length&&arguments[3]!==void 0&&arguments[3],C=Object.keys(p).map(function(S){if(!y[S])return console.error("".concat(E," Invalid key: ").concat(S)),!1;var T=p[S],_=y[S];if(typeof _=="string"&&(_={type:_}),_.type==="format"){if(!f(T,u,"[Validate ".concat(S,"]"),!0))return!1}else if(s(T)!==_.type)return console.error("".concat(E," ").concat(S,' type mismatched: "').concat(_.type,'" expected, "').concat(s(T),'" provided')),!1;if(_.restrictions&&_.restrictions.length)for(var A=_.restrictions.length,D=0;D<A;D++){var U=_.restrictions[D],z=U.restriction,G=U.message;if(!z(T,p))return console.error("".concat(E," ").concat(S," invalid value: ").concat(G)),!1}return _.restriction&&!_.restriction(T,p)?(console.error("".concat(E," ").concat(S," invalid value: ").concat(_.message)),!1):_.validValues&&_.validValues.indexOf(T)===-1?(console.error("".concat(E," ").concat(S," invalid value: must be among ").concat(JSON.stringify(_.validValues),', "').concat(T,'" provided')),!1):!(_.children&&!f(T,_.children,"[Validate ".concat(S,"]")))});return v||C.push.apply(C,o(Object.keys(y).map(function(S){var T=y[S];if(typeof T=="string"&&(T={type:T}),T.mandatory){var _=T.mandatory;if(typeof _=="function"&&(_=_(p)),_&&p[S]===void 0)return console.error("".concat(E,' Missing mandatory key "').concat(S,'"')),!1}return!0}))),C.reduce(function(S,T){return S&&T},!0)}function g(p){return f(p,u,"[Validate format]")}r.exports={validate:function(p,y){var E=h(p),v=g(y);return E&&v},validateFormat:g,validateInput:h,validateLanguage:function(p){return f(p,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(JB);var jae=JB.exports;const cl=Vf(jae),Yae="numeric";function PM(t,e,n,r,i,o,s){let a=o;if(vr(a)){const l=s.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,h=s.className||"",f=h.length?h.split(" "):[];if(typeof u<"u"&&!cl.languages()[u]){const g=u.replace("-",""),p=cl.allLanguages?cl.allLanguages[u]:cl[g];p&&cl.registerLanguage(p)}cl.setLanguage(u),a=cl(a).format(c||"0"),f.indexOf("htLeft")<0&&f.indexOf("htCenter")<0&&f.indexOf("htRight")<0&&f.indexOf("htJustify")<0&&f.push("htRight"),f.indexOf("htNumeric")<0&&f.push("htNumeric"),s.className=f.join(" "),e.dir="ltr"}Ys(t,e,n,r,i,a,s)}PM.RENDERER_TYPE=Yae;const Kae="password";function OM(t,e,n,r,i,o,s){Ys.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";Re(a-1,()=>{u+=l}),fu(e,u)}OM.RENDERER_TYPE=Kae;const Xae="time";function AM(t,e,n,r,i,o,s){Ys.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}AM.RENDERER_TYPE=Xae;function qae(){Mo(gh),Mo(ug),Mo(MM),Mo(_M),Mo(PM),Mo(OM),Mo(Ys),Mo(AM)}const Qae="autocomplete";function SC(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,rI(n,e)):rI(n,e)(this.source):e(!0)}SC.VALIDATOR_TYPE=Qae;function rI(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function eU(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const Zae=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:eU},Symbol.toStringTag,{value:"Module"})),Jae="date";function IM(t,e){const n=n2(jB,this.instance);let r=t,i=!0;r==null&&(r="");let o=J(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=J(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=ele(r,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),i=!0}else i=!1;e(i)}IM.VALIDATOR_TYPE=Jae;function ele(t,e){const n=J(eU(t)),r=J(t,e),i=t.search(/[A-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const tle="numeric";function HM(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:vr(t))}HM.VALIDATOR_TYPE=tle;const nle=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],rle="time";function DM(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=J(i,nle,!0).isValid()?J(i):J(i,n);let a=s.isValid(),l=J(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n),c=this.instance.toVisualRow(this.row),h=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,h,u,"timeValidator"),r=!0}else r=!1;e(r)}DM.VALIDATOR_TYPE=rle;function ile(){Mc(SC),Mc(IM),Mc(HM),Mc(DM)}const ole="autocomplete",sle={CELL_TYPE:ole,editor:EM,renderer:gh,validator:SC},ale="checkbox",lle={CELL_TYPE:ale,editor:zB,renderer:MM},ule="date";function tU(t,e,n,r,i,o,s){gh.apply(this,[t,e,n,r,i,o,s])}tU.RENDERER_TYPE=ule;const cle="date",hle={CELL_TYPE:cle,editor:YB,renderer:tU,validator:IM},dle="dropdown",fle={CELL_TYPE:dle,editor:TM,renderer:gh,validator:SC},gle="handsontable";function nU(t,e,n,r,i,o,s){gh.apply(this,[t,e,n,r,i,o,s])}nU.RENDERER_TYPE=gle;const mle="handsontable",ple={CELL_TYPE:mle,editor:RM,renderer:nU},wle="numeric",vle={CELL_TYPE:wle,editor:KB,renderer:PM,validator:HM,dataType:"number"},Cle="password",yle={CELL_TYPE:Cle,editor:XB,renderer:OM,copyable:!1},Sle="select";function rU(t,e,n,r,i,o,s){Ys.apply(this,[t,e,n,r,i,o,s])}rU.RENDERER_TYPE=Sle;const ble="select",Rle={CELL_TYPE:ble,editor:qB,renderer:rU},Ele="time",Tle={CELL_TYPE:Ele,editor:QB,renderer:AM,validator:DM};function _le(){di(sle),di(lle),di(hle),di(fle),di(ple),di(vle),di(yle),di(Rle),di(_B),di(Tle)}function Mle(t,e){iU(t,e),e.add(t)}function xle(t,e,n){iU(t,e),e.set(t,n)}function iU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pu(t,e,n){return e=Ple(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ple(t){var e=Ole(t,"string");return typeof e=="symbol"?e:String(e)}function Ole(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ale(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ou(t,e){var n=Ile(t,e,"get");return Hle(t,n)}function Ile(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Hle(t,e){return e.get?e.get.call(t):e.value}const iI=new Map([["plugin",UZ],["cell-type",pB],["editor",t2],["renderer",c2],["validator",h2]]),Dle="base",TS=[];let wo=null;var hl=new WeakMap,oI=new WeakSet;class ct{static get PLUGIN_KEY(){return Dle}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){Mle(this,oI),Pu(this,"eventManager",new ri(this)),Pu(this,"pluginName",null),Pu(this,"pluginsInitializedCallbacks",[]),Pu(this,"isPluginsReady",!1),Pu(this,"enabled",!1),Pu(this,"initialized",!1),xle(this,hl,{writable:!0,value:{}}),Go(this,"hot",e,{writable:!1}),wo=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!iI.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);iI.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");TS.push(o)}}if(wo||(wo=c1()),wo.indexOf("UndoRedo")>=0&&wo.splice(wo.indexOf("UndoRedo"),1),wo.indexOf(this.pluginName)>=0&&wo.splice(wo.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),wo.length===0){if(TS.length>0){const i=[`${TS.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n){Ou(this,hl)[e]=Ou(this,hl)[e]||[];const r=Ou(this,hl)[e];this.hot.addHook(e,n),r.push(n),Ou(this,hl)[e]=r}removeHooks(e){P(Ou(this,hl)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Ou(this,hl);Ke(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){P(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=Ale(this,oI,Nle).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ke(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function Nle(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function dl(t,e,n){return e=kle(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kle(t){var e=Lle(t,"string");return typeof e=="symbol"?e:String(e)}function Lle(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let $le=class{constructor(e){dl(this,"hot",null),dl(this,"container",null),dl(this,"injected",!1),dl(this,"rows",[]),dl(this,"columns",[]),dl(this,"samples",null),dl(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),P(this.rows,n=>{e(n.row,Bt(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),P(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{P(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{P(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{P(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),P(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{P(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e);a.col=e,a.row=s;const l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),te(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return te(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const NM=$le;function wm(t,e,n){return e=Fle(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fle(t){var e=Wle(t,"string");return typeof e=="symbol"?e:String(e)}function Wle(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kM{static get SAMPLE_COUNT(){return 3}constructor(e){wm(this,"samples",null),wm(this,"dataFactory",null),wm(this,"customSampleCount",null),wm(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:kM.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return Re(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return Re(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let f;h?f=c:je(u)?f=`${Object.keys(u).length}`:Array.isArray(u)?f=`${u.length}`:f=`${Qt(u).length}`,i.has(f)||i.set(f,{needed:this.getSampleCount(),strings:[]});const g=i.get(f);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}const oU=kM;function Au(t,e){sU(t,e),e.add(t)}function Vle(t,e,n){sU(t,e),e.set(t,n)}function sU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Iu(t,e,n){return e=Ble(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ble(t){var e=Ule(t,"string");return typeof e=="symbol"?e:String(e)}function Ule(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zle(t,e,n){var r=aU(t,e,"set");return Gle(t,r,n),n}function Gle(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function vm(t,e){var n=aU(t,e,"get");return jle(t,n)}function aU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function jle(t,e){return e.get?e.get.call(t):e.value}function fl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ve.getSingleton().register("modifyAutoColumnSizeSeed");const Bh="autoColumnSize",Yle=10,Kle="autoColumnSize";var uc=new WeakMap,sI=new WeakSet,aI=new WeakSet,lI=new WeakSet,_S=new WeakSet,uI=new WeakSet,cI=new WeakSet;class Vd extends ct{static get PLUGIN_KEY(){return Bh}static get PLUGIN_PRIORITY(){return Yle}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Au(this,cI),Au(this,uI),Au(this,_S),Au(this,lI),Au(this,aI),Au(this,sI),Iu(this,"ghostTable",new NM(this.hot)),Iu(this,"samplesGenerator",new oU((n,r)=>{const i=this.hot.getCellMeta(n,r);let o="";i.spanned||(o=this.hot.getDataAtCell(n,r));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,o)),{value:o,bundleSeed:s}})),Iu(this,"firstCalculation",!0),Iu(this,"inProgress",!1),Iu(this,"measuredColumns",0),Iu(this,"columnWidthsMap",new Ja),Vle(this,uc,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(Kle,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>fl(this,_S,hI).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[Bh]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Bh];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fl(e,aI,qle).call(e,...i)}),this.addHook("beforeChangeRender",r=>fl(this,lI,Qle).call(this,r)),this.addHook("afterFormulasValuesUpdate",r=>fl(this,cI,Jle).call(this,r)),this.addHook("beforeViewRender",r=>fl(this,sI,Xle).call(this,r)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("afterInit",()=>fl(this,uI,Zle).call(this)),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>fl(this,_S,hI).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const n=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();r===-1||i===-1||this.calculateColumnsWidth({from:r,to:i},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;Re(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);if(a===null&&(a=s),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(s,o);P(l,u=>{let[c,h]=u;return this.ghostTable.addColumn(c,h)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){xf(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+Vd.CALCULATION_STEP,r)},e),n=n+Vd.CALCULATION_STEP+1,n<r?i=nC(o):(xf(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[Bh],n=e&&Vt(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Vt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Bh];let n=Vd.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return je(e)&&(n=e.syncLimit,UT(n)?n=l1(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,f1.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getFirstVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getFirstRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getLastVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getLastRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader();return sn(e,(r,i,o)=>{const s=vm(this,uc).length;return(s-1<o||vm(this,uc)[o]!==i)&&r.push(o),s-1<o?vm(this,uc).push(i):vm(this,uc)[o]=i,r},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{P(e,n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!ni(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Xle(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function qle(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function Qle(t){const e=Ye(t,n=>{let[,r]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(r))});this.clearCache(Array.from(new Set(e)))}function hI(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function Zle(){zle(this,uc,this.hot.getColHeader())}function Jle(t){const e=ni(t,r=>{var i;return fe((i=r.address)===null||i===void 0?void 0:i.col)}),n=Ye(e,r=>r.address.col);this.clearCache(Array.from(new Set(n)))}const Wl={horizontal:"horizontal",vertical:"vertical"};function eue(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function tue(t){const e={};return t===!0?(e.directions=Object.keys(Wl),e.autoInsertRow=!0):je(t)?(fe(t.autoInsertRow)?t.direction===Wl.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,fe(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Wl)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Uh(t,e){nue(t,e),e.add(t)}function nue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hu(t,e,n){return e=rue(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rue(t){var e=iue(t,"string");return typeof e=="symbol"?e:String(e)}function iue(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ve.getSingleton().register("modifyAutofillRange");ve.getSingleton().register("beforeAutofill");ve.getSingleton().register("afterAutofill");const dI="autofill",oue=20,sue=["fillHandle"],aue="insert_row_below",lue=200;var fI=new WeakSet,gI=new WeakSet,mI=new WeakSet,pI=new WeakSet,wI=new WeakSet;class uue extends ct{constructor(){super(...arguments),Uh(this,wI),Uh(this,pI),Uh(this,mI),Uh(this,gI),Uh(this,fI),Hu(this,"addingStarted",!1),Hu(this,"mouseDownOnCellCorner",!1),Hu(this,"mouseDragOutside",!1),Hu(this,"handleDraggedCells",0),Hu(this,"directions",[]),Hu(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return dI}static get PLUGIN_PRIORITY(){return oue}static get SETTING_KEYS(){return[dI,...sue]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>zh(this,gI,hue).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>zh(this,fI,cue).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>zh(this,mI,due).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return P(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),P(a,c=>{const h=[];P(l,f=>{h.push(this.hot.getCopyableData(c,f))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:f}=eue(l,u,(g,p)=>this.hot._createCellCoords(g,p));if(h&&h.row>-1&&h.col>-1){const g=this.getSelectionData(),p=o.clone(),y=this.hot._createCellRange(h,h,f),E=this.hot.runHooks("beforeAutofill",g,p,y,c);if(E===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let v=E;const C=E;if(["up","left"].indexOf(c)>-1&&!(C.length===1&&C[0].length===0))if(v=[],c==="up"){const S=f.row-h.row+1,T=S%C.length;for(let _=0;_<S;_++)v.push(C[(_+(C.length-T))%C.length])}else{const S=f.col-h.col+1,T=S%C[0].length;for(let _=0;_<C.length;_++){v.push([]);for(let A=0;A<S;A++)v[_].push(C[_][(A+(C[_].length-T))%C[_].length])}}this.hot.populateFromArray(h.row,h.col,v,f.row,f.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",v,p,y,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Wl.vertical)&&this.directions.includes(Wl.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Wl.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Wl.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(aue,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},lue)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++)if(n[o][l])return-1;const s=n[o][e[1]-1],a=n[o][e[3]+1];(s||a)&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ye(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=cn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+Bt(this.hot.table),i=cn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+wt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>zh(this,pI,fue).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>zh(this,wI,gue).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=tue(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function cue(){this.selectAdjacent()&&this.fillIn()}function hue(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function due(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function fue(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function gue(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Cm(t,e){mue(t,e),e.add(t)}function mue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gl(t,e,n){return e=pue(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pue(t){var e=wue(t,"string");return typeof e=="symbol"?e:String(e)}function wue(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const ym="autoRowSize",vue=40,Cue="autoRowSize";var vI=new WeakSet,MS=new WeakSet,CI=new WeakSet,yI=new WeakSet;class Bd extends ct{static get PLUGIN_KEY(){return ym}static get PLUGIN_PRIORITY(){return vue}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Cm(this,yI),Cm(this,CI),Cm(this,MS),Cm(this,vI),gl(this,"headerHeight",null),gl(this,"ghostTable",new NM(this.hot)),gl(this,"samplesGenerator",new oU((n,r)=>{if(n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let i;return n>=0?i=this.hot.getDataAtCell(n,r):n===-1&&(i=this.hot.getColHeader(r)),{value:i}})),gl(this,"firstCalculation",!0),gl(this,"inProgress",!1),gl(this,"measuredRows",0),gl(this,"rowHeightsMap",new Ja),this.hot.rowIndexMapper.registerMap(Cue,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>Gh(this,MS,SI).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[ym];return e===!0||je(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Gh(e,CI,Sue).call(e,...r)}),this.addHook("beforeChangeRender",n=>Gh(this,yI,bue).call(this,n)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",n=>Gh(this,vI,yue).call(this,n)),this.addHook("modifyRowHeight",(n,r)=>this.getRowHeight(r,n)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>Gh(this,MS,SI).call(this,e,n,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}Re(i.from,i.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){const a=this.samplesGenerator.generateRowSamples(s,o);P(a,l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){xf(i),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+Bd.CALCULATION_STEP,r)},e),n=n+Bd.CALCULATION_STEP+1,n<r?i=nC(o):(xf(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[ym],n=e&&Vt(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Vt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){Ga(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[ym];let n=Bd.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return je(e)&&(n=e.syncLimit,UT(n)?n=l1(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Re(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!ni(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function yue(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(!(n===-1||r===-1)){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-e,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function SI(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function Sue(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function bue(t){let e=null;t.length===1?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),e!==null&&this.clearCacheByRange(e)}const{getListWithInsertedItems:Rue,getListWithRemovedItems:Eue}=K2("physicallyIndexed");class Tue extends gu{constructor(){super(e=>e)}insert(e,n){const r=F1(this.indexedValues,n);this.indexedValues=Rue(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=Eue(this.indexedValues,e);this.indexedValues=$1(n,e),super.remove(e)}}const _ue=Tue,{getListWithInsertedItems:Mue,getListWithRemovedItems:xue}=K2("physicallyIndexed");class Pue extends gu{constructor(){super(e=>e)}insert(e,n){this.indexedValues=Mue(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=xue(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const Oue=Pue;function Aue(t,e){Iue(t,e),e.add(t)}function Iue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hue(t,e,n){return e=Due(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Due(t){var e=Nue(t,"string");return typeof e=="symbol"?e:String(e)}function Nue(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kue(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const xS="bindRowsWithHeaders",Lue=210,$ue="loose",Fue=new Map([["loose",_ue],["strict",Oue]]);var bI=new WeakSet;class Wue extends ct{constructor(){super(...arguments),Aue(this,bI),Hue(this,"headerIndexes",null)}static get PLUGIN_KEY(){return xS}static get PLUGIN_PRIORITY(){return Lue}isEnabled(){return!!this.hot.getSettings()[xS]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[xS];typeof e!="string"&&(e=$ue);const n=Fue.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>kue(this,bI,Vue).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function Vue(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Sm(t,e){lU(t,e),e.add(t)}function Bue(t,e,n){lU(t,e),e.set(t,n)}function lU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RI(t,e,n){return e=Uue(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uue(t){var e=zue(t,"string");return typeof e=="symbol"?e:String(e)}function zue(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EI(t,e){var n=uU(t,e,"get");return Gue(t,n)}function Gue(t,e){return e.get?e.get.call(t):e.value}function bm(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function PS(t,e,n){var r=uU(t,e,"set");return jue(t,r,n),n}function uU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function jue(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const Pp="collapsibleColumns",Yue=290,Kue=["nestedHeaders"],Fc="collapsibleIndicator",TI=Pp,_I=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Du=new WeakMap,MI=new WeakSet,xI=new WeakSet,PI=new WeakSet,OI=new WeakSet;class Xue extends ct{constructor(){super(...arguments),Sm(this,OI),Sm(this,PI),Sm(this,xI),Sm(this,MI),RI(this,"nestedHeadersPlugin",null),RI(this,"headerStateManager",null),Bue(this,Du,{writable:!0,value:null})}static get PLUGIN_KEY(){return Pp}static get PLUGIN_PRIORITY(){return Yue}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Pp,...Kue]}isEnabled(){return!!this.hot.getSettings()[Pp]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||_t("You need to configure the Nested Headers plugin in order to use collapsible headers."),PS(this,Du,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>bm(this,PI,Zue).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return bm(e,OI,Jue).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return bm(e,MI,que).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>bm(this,xI,Que).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),PS(this,Du,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};i&&(o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:TI})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(TI)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};Re(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;Re(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Fc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Fc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Fc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!_I.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=ni(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;P(r,f=>{var g;let{row:p,col:y}=f;const{collapsible:E,isCollapsed:v}=(g=this.headerStateManager.getHeaderSettings(p,y))!==null&&g!==void 0?g:{};if(!E||v&&n==="collapse"||!v&&n==="expand")return i=!1,!1});const o=[],s=[];i&&P(r,f=>{let{row:g,col:p}=f;const{colspanCompensation:y,affectedColumns:E,rollbackModification:v}=this.headerStateManager.triggerNodeModification(n,g,p);y>0&&(s.push(...E),o.push(v))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=VT([...a,...s]):n==="expand"&&(l=ni(a,f=>!s.includes(f)));const u=_I.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){P(o,f=>{f()});return}this.hot.batchExecution(()=>{P(s,f=>{EI(this,Du).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return EI(this,Du).getHiddenIndexes()}destroy(){PS(this,Du,null),super.destroy()}}function que(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Fc}`);if(du(e,[bi("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),te(u,Fc),e.querySelector("div:first-child").appendChild(u)),We(u,["collapsed","expanded"]),s?(te(u,"collapsed"),za(u,"+"),l&&Ae(e,...bi(!1))):(te(u,"expanded"),za(u,"-"),l&&Ae(e,...bi(!0))),l&&Ae(u,...Us());else{var c;(c=u)===null||c===void 0||c.remove()}}function Que(t,e){$e(t.target,Fc)&&($e(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):$e(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Pi(t))}function Zue(){this.updatePlugin()}function Jue(t,e){e||this.updatePlugin()}function ml(t,e,n){return e=ece(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ece(t){var e=tce(t,"string");return typeof e=="symbol"?e:String(e)}function tce(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const nce=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],rce=!1,ice=!0,oce=!0;class sce{constructor(e,n){ml(this,"hot",void 0),ml(this,"sortingStates",new oC),ml(this,"sortEmptyCells",rce),ml(this,"indicator",ice),ml(this,"headerAction",oce),ml(this,"compareFunctionFactory",void 0),ml(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){je(e)&&Ke(e,(n,r)=>{nce.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return je(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(fe(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const Fw="asc",Ww="desc",cU="colHeader";function ace(t){if(je(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Fw,Ww].includes(n)}function lce(t){if(t.some(n=>ace(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function AI(t){if(t!==Ww)return t===Fw?Ww:Fw}function hU(t){return t.querySelector(`.${cU}`)}function dU(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function LM(t,e,n){return t===-1&&e>=0&&ja(n)===!1}const uce="ascending",cce="descending",fU="indicatorDisabled",gU="columnSorting",mU="sortAction",pU=new Map([[Fw,uce],[Ww,cce]]);function hce(t,e,n,r){const i=[gU];if(r&&i.push(mU),n===!1)return i.push(fU),i;const o=t.getSortOrderOfColumn(e);return fe(o)&&i.push(pU.get(o)),i}function dce(){return Array.from(pU.values()).concat(mU,fU,gU)}function wU(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Fo:Cn(i)?Cn(o)?Fo:s&&t==="asc"?Xt:qt:Cn(o)?s&&t==="asc"?qt:Xt:isNaN(i)&&!isNaN(o)?t==="asc"?qt:Xt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Xt:qt:i>o?t==="asc"?qt:Xt:Fo}}const vU="default";function fce(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Fo;if(a){if(Cn(r))return t==="asc"?Xt:qt;if(Cn(i))return t==="asc"?qt:Xt}return isNaN(o)?qt:isNaN(s)?Xt:o<s?t==="asc"?Xt:qt:o>s?t==="asc"?qt:Xt:Fo}}const gce="numeric";function mce(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Cn(s),u=Cn(a),c=l?i:s,h=u?i:a,f=c===i||c===r,g=h===i||h===r;if(o===!1){if(l&&u===!1)return qt;if(l===!1&&u)return Xt}return f===!1&&g?t==="asc"?Xt:qt:f&&g===!1?t==="asc"?qt:Xt:f===!1&&g===!1?wU(t,e,n)(s,a):c===i&&h===r?t==="asc"?Xt:qt:c===r&&h===i?t==="asc"?qt:Xt:Fo}}const pce="checkbox";function wce(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Fo;if(Cn(r))return Cn(i)?Fo:o&&t==="asc"?Xt:qt;if(Cn(i))return o&&t==="asc"?qt:Xt;const s=e.dateFormat,a=J(r,s),l=J(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?t==="asc"?Xt:qt:l.isBefore(a)?t==="asc"?qt:Xt:Fo:Xt:qt}}const vce="date",{register:bC,getItem:II,hasItem:Cce}=lo("sorting.compareFunctionFactory"),{register:CU,getItem:yce}=lo("sorting.mainSortComparator");function yU(t){return Cce(t)?II(t):II(vU)}bC(gce,fce);bC(pce,mce);bC(vce,wce);bC(vU,wU);const Fo=0,Xt=-1,qt=1;function Sce(t,e){const n=yce(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}function bce(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],f=u.columnSorting;return(f.compareFunctionFactory?f.compareFunctionFactory:yU(u.type))(l,u,f)(c,h)}(0)}}function Rm(t,e){Rce(t,e),e.add(t)}function Rce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Em(t,e,n){return e=Ece(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ece(t){var e=Tce(t,"string");return typeof e=="symbol"?e:String(e)}function Tce(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cc(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Vw="columnSorting",_ce=50,Bw="append",Mce="replace",HI=Vw;CU(Vw,bce);ve.getSingleton().register("beforeColumnSort");ve.getSingleton().register("afterColumnSort");var Op=new WeakSet,DI=new WeakSet,NI=new WeakSet,kI=new WeakSet;class SU extends ct{constructor(){super(...arguments),Rm(this,kI),Rm(this,NI),Rm(this,DI),Rm(this,Op),Em(this,"columnStatesManager",null),Em(this,"columnMetaCache",null),Em(this,"pluginKey",Vw),Em(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Vw}static get PLUGIN_PRIORITY(){return _ce}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new sce(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Ja(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>cc(this,DI,xce).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return cc(e,kI,Oce).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>cc(this,Op,WR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return cc(e,NI,Pce).call(e,...r)}),this.hot.view&&cc(this,Op,WR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=hU(r);dU(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:HI})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(HI)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new X2),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return fe(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return lce(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ye(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return fe(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ye(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(fe(n)){const i=AI(n);return fe(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:AI()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bw;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Tt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===Bw)return[...o.slice(0,r),...o.slice(r+1),s];if(n===Mce)return[...o.slice(0,r),s,...o.slice(r+1)]}return fe(s)?o.concat(s):o}getPluginColumnConfig(e){if(je(e)){const n=e[this.pluginKey];if(je(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):Et(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const n=[],r=this.hot.countRows(),i=u=>Ye(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ye(n,u=>u[0]);Sce(n,this.pluginKey,Ye(e,u=>u.sortOrder),Ye(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ye(n,u=>u[0]),a=new Map(Ye(o,(u,c)=>[u,s[c]])),l=Ye(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(je(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||je(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(We(e,dce()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];te(e,hce(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),fe(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&$e(e.target,cU)}onAfterOnCellMouseDown(e,n){LM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function WR(){const t=this.getAllSavedSortSettings();if(je(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function xce(t,e){const n=hU(e);if(dU(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Ae(e,...dQ(s?`${s}ending`:"none"))}}function Pce(t){t===!0&&this.hot.view&&cc(this,Op,WR).call(this)}function Oce(t,e,n,r){LM(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function pl(t,e,n){return e=Ace(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ace(t){var e=Ice(t,"string");return typeof e=="symbol"?e:String(e)}function Ice(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hce{constructor(e,n){pl(this,"plugin",void 0),pl(this,"hot",void 0),pl(this,"endpoints",[]),pl(this,"settings",void 0),pl(this,"settingsType","array"),pl(this,"currentEndpoint",null),pl(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),P(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();P(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const f=()=>(this.hot.removeHook("beforeViewRender",f),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",f);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;P(u,f=>{a==="row"&&f.destinationRow>=h&&(f.alterRowOffset=l*r),a==="col"&&f.destinationColumn>=h&&(f.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?P(u,f=>{this.extendEndpointRanges(f,h,i[0],i.length),this.recreatePhysicalRanges(f),this.clearOffsetInformation(f)}):P(u,f=>{this.shiftEndpointCoordinates(f,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){P(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];P(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),P(i,o=>{let s=[];P(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,P(e.ranges,r=>{P(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],P(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],P(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],P(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&P(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),P(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){_t("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const Dce=Hce;function OS(t){return t==null||isNaN(t)}function AS(t,e){Nce(t,e),e.add(t)}function Nce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kce(t,e,n){return e=Lce(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lce(t){var e=$ce(t,"string");return typeof e=="symbol"?e:String(e)}function $ce(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IS(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const HS="columnSummary",Fce=220;var LI=new WeakSet,$I=new WeakSet,FI=new WeakSet;class Wce extends ct{constructor(){super(...arguments),AS(this,FI),AS(this,$I),AS(this,LI),kce(this,"endpoints",null)}static get PLUGIN_KEY(){return HS}static get PLUGIN_PRIORITY(){return Fce}isEnabled(){return!!this.hot.getSettings()[HS]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[HS],this.endpoints=new Dce(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return IS(e,LI,Vce).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return IS(e,$I,Bce).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return IS(e,FI,Uce).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ke(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=OS(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Ke(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=OS(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=OS(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Ke(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(vt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function Vce(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}function Bce(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function Uce(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Nu(t,e,n){return e=zce(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zce(t){var e=Gce(t,"string");return typeof e=="symbol"?e:String(e)}function Gce(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pc{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){Nu(this,"rootDocument",void 0),Nu(this,"isRtl",!1),Nu(this,"container",null),Nu(this,"editor",void 0),Nu(this,"editorStyle",void 0),Nu(this,"hidden",!0),this.rootDocument=e,this.isRtl=n,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,n){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:wt(this.getInputElement()),height:Bt(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),te(this.container,Pc.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),te(e,Pc.CLASS_EDITOR),te(n,Pc.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${Pc.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const jce=Pc;function DS(t,e,n){return e=Yce(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yce(t){var e=Kce(t,"string");return typeof e=="symbol"?e:String(e)}function Kce(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Xce=250,qce=250;class bU{constructor(e){DS(this,"wasLastActionShow",!0),DS(this,"showDebounced",null),DS(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},qce)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Xce;this.showDebounced=qv(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}St(bU,Ur);const Qce=bU;function Zce(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Jce(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function wl(t,e){const n={};return P(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function ua(t,e,n,r,i){P(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&ehe(s,a,e,n,r,i)})})}function ehe(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=Zce(s.className,r):a=Jce(s.className,r)),o(t,e,"className",a)}function fs(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function Oo(t,e){let n=!1;return Array.isArray(t)&&P(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function RC(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const qe="---------";function the(){return{name:qe}}const mi="alignment";function nhe(){return{key:mi,name(){return this.getTranslatedPhrase(h_)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${mi}:left`,name(){let t=this.getTranslatedPhrase(d_);return Oo(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(t=fs(t)),t},callback(){const t=this.getSelectedRange(),e=wl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),ua(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mi}:center`,name(){let t=this.getTranslatedPhrase(f_);return Oo(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(t=fs(t)),t},callback(){const t=this.getSelectedRange(),e=wl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),ua(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mi}:right`,name(){let t=this.getTranslatedPhrase(g_);return Oo(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(t=fs(t)),t},callback(){const t=this.getSelectedRange(),e=wl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),ua(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mi}:justify`,name(){let t=this.getTranslatedPhrase(m_);return Oo(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(t=fs(t)),t},callback(){const t=this.getSelectedRange(),e=wl(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),ua(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:qe},{key:`${mi}:top`,name(){let t=this.getTranslatedPhrase(p_);return Oo(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(t=fs(t)),t},callback(){const t=this.getSelectedRange(),e=wl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),ua(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mi}:middle`,name(){let t=this.getTranslatedPhrase(w_);return Oo(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(t=fs(t)),t},callback(){const t=this.getSelectedRange(),e=wl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),ua(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${mi}:bottom`,name(){let t=this.getTranslatedPhrase(v_);return Oo(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(t=fs(t)),t},callback(){const t=this.getSelectedRange(),e=wl(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),ua(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const EC="clear_column";function rhe(){return{key:EC,name(){return this.getTranslatedPhrase(Q1)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const cg="col_left";function ihe(){return{key:cg,name(){return this.getTranslatedPhrase(z1)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const hg="col_right";function ohe(){return{key:hg,name(){return this.getTranslatedPhrase(G1)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const dg="make_read_only";function she(){return{key:dg,name(){let t=this.getTranslatedPhrase(q1);return Oo(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=fs(t)),t},callback(){const t=this.getSelectedRange(),e=Oo(t,(n,r)=>this.getCellMeta(n,r).readOnly);P(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const TC="redo";function ahe(){return{key:TC,name(){return this.getTranslatedPhrase(X1)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const fg="remove_col";function lhe(){return{key:fg,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(Y1,e)},callback(){this.alter("remove_col",Lre(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const _C="remove_row";function uhe(){return{key:_C,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(j1,e)},callback(){this.alter("remove_row",$re(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const MC="row_above";function che(){return{key:MC,name(){return this.getTranslatedPhrase(B1)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const xC="row_below";function hhe(){return{key:xC,name(){return this.getTranslatedPhrase(U1)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Df="no_items";function dhe(){return{key:Df,name(){return this.getTranslatedPhrase(V1)},disabled:!0,isCommand:!1}}const PC="undo";function fhe(){return{key:PC,name(){return this.getTranslatedPhrase(K1)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const ghe=[MC,xC,cg,hg,EC,_C,fg,PC,TC,dg,mi,qe,Df],mhe={[qe]:the,[Df]:dhe,[MC]:che,[xC]:hhe,[cg]:ihe,[hg]:ohe,[EC]:rhe,[_C]:uhe,[fg]:lhe,[PC]:fhe,[TC]:ahe,[dg]:she,[mi]:nhe};function RU(){const t={};return Ke(mhe,(e,n)=>{t[n]=e()}),t}function phe(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(l_):this.getTranslatedPhrase(a_)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function whe(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(u_)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function vhe(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(c_);return Oo(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Ap))?fs(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Ap);t.updateCommentMeta(n,r,{[Ap]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function vo(t,e){EU(t,e),e.add(t)}function vl(t,e,n){EU(t,e),e.set(t,n)}function EU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Che(t,e,n){return e=yhe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yhe(t){var e=She(t,"string");return typeof e=="symbol"?e:String(e)}function She(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Co(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Es(t,e,n){var r=TU(t,e,"set");return bhe(t,r,n),n}function bhe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function nt(t,e){var n=TU(t,e,"get");return Rhe(t,n)}function TU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Rhe(t,e){return e.get?e.get.call(t):e.value}const Ud="comments",Ehe=60,gs="comment",Sd="value",_U="style",Ap="readOnly",Tm=Ud,VR=`plugin:${Ud}`;var It=new WeakMap,Bi=new WeakMap,OC=new WeakMap,Ip=new WeakMap,Uw=new WeakMap,BR=new WeakMap,zw=new WeakMap,WI=new WeakSet,VI=new WeakSet,BI=new WeakSet,UI=new WeakSet,zI=new WeakSet,GI=new WeakSet,jI=new WeakSet,YI=new WeakSet,KI=new WeakSet,XI=new WeakSet;class The extends ct{constructor(){super(...arguments),vo(this,XI),vo(this,KI),vo(this,YI),vo(this,jI),vo(this,GI),vo(this,zI),vo(this,UI),vo(this,BI),vo(this,VI),vo(this,WI),Che(this,"range",{}),vl(this,It,{writable:!0,value:null}),vl(this,Bi,{writable:!0,value:null}),vl(this,OC,{writable:!0,value:!1}),vl(this,Ip,{writable:!0,value:!1}),vl(this,Uw,{writable:!0,value:{}}),vl(this,BR,{writable:!0,value:null}),vl(this,zw,{writable:!0,value:""})}static get PLUGIN_KEY(){return Ud}static get PLUGIN_PRIORITY(){return Ehe}isEnabled(){return!!this.hot.getSettings()[Ud]}enablePlugin(){this.enabled||(nt(this,It)||Es(this,It,new jce(this.hot.rootDocument,this.hot.isRtl())),nt(this,Bi)||Es(this,Bi,new Qce(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,n,r,i,o,s)=>Co(this,UI,Phe).call(this,e,s)),this.addHook("afterScroll",()=>Co(this,XI,Nhe).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>Co(this,KI,Dhe).call(this,e)),nt(this,Bi).addLocalHook("hide",()=>this.hide()),nt(this,Bi).addLocalHook("show",(e,n)=>this.showAtCell(e,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){nt(this,Bi).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(VR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Es(this,Ip,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(VR),this.hot._registerTimeout(()=>{Es(this,Ip,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!nt(this,It).isVisible()},group:Tm}),r.addShortcut({keys:[["Escape"]],callback:()=>{nt(this,It).setValue(nt(this,zw)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&nt(this,It).isVisible()},group:Tm}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&nt(this,It).isVisible()},group:Tm})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Tm)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Co(this,VI,Mhe).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Co(this,WI,_he).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Co(this,BI,xhe).call(this)),this.eventManager.addEventListener(n,"focus",()=>Co(this,GI,Ahe).call(this)),this.eventManager.addEventListener(n,"blur",()=>Co(this,zI,Ohe).call(this)),this.eventManager.addEventListener(n,"mousedown",r=>Co(this,jI,Ihe).call(this,r)),this.eventManager.addEventListener(n,"mouseup",r=>Co(this,YI,Hhe).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Ua(e.target,"TD","TBODY");return!!(n&&$e(n,"htCommentCell")&&Ua(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=nt(this,It).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Sd]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,gs),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Sd)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Sd)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return nt(this,Bi).cancelHiding(),nt(this,It).setValue((e=i[gs]?i[gs][Sd]:null)!==null&&e!==void 0?e:""),nt(this,It).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){nt(this,It).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!nt(this,It).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(s),u=o.getRenderableFromVisualIndex(a);const c=l===null;nt(this,It).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),u===null&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));const h=l===null,f=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:g,view:{_wt:p}}=this.hot,{wtTable:y}=p,E=p.getCell({row:l,col:u},!0),v=this.getCommentMeta(s,a,_U);v?nt(this,It).setSize(v.width,v.height):nt(this,It).resetSize();const C=f?0:y.getStretchedColumnWidth(u),S=c&&!h?Bt(E):0,{left:T,top:_,width:A,height:D}=E.getBoundingClientRect(),{width:U,height:z}=nt(this,It).getSize(),{innerWidth:G,innerHeight:Z}=this.hot.rootWindow,re=this.hot.rootDocument.documentElement;let ne=T+g.scrollX+C,he=_+g.scrollY+S;this.hot.isRtl()&&(ne-=U+C),this.hot.isLtr()&&T+A+U>G?ne=T+g.scrollX-U-1:this.hot.isRtl()&&ne<-(re.scrollWidth-re.clientWidth)&&(ne=T+g.scrollX+C+1),_+z>Z&&(he-=z-D+1),nt(this,It).setPosition(ne,he),nt(this,It).setReadOnlyState(this.getCommentMeta(s,a,Ap))}focusEditor(){nt(this,It).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[gs];let o;i?(o=rr(i),ig(o,r)):o=r,this.hot.setCellMeta(e,n,gs,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[gs])return i[gs][r]}addToContextMenu(e){e.items.push({name:qe},phe(this),whe(this),vhe(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[Ud];if(je(e))return e.displayDelay}getEditorInputElement(){return nt(this,It).getInputElement()}destroy(){nt(this,It)&&nt(this,It).destroy(),nt(this,Bi)&&nt(this,Bi).destroy(),super.destroy()}}function _he(t){if(!(!this.hot.view||!this.hot.view._wt)&&!nt(this,OC)&&!this.targetIsCommentTextArea(t)){const e=Ua(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function Mhe(t){const{rootDocument:e}=this.hot;if(!(nt(this,OC)||nt(this,It).isFocused()||$e(t.target,"wtBorder")||nt(this,BR)===t.target||!nt(this,It)))if(Es(this,BR,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));nt(this,Bi).show(n)}else ka(t.target,e)&&!this.targetIsCommentTextArea(t)&&nt(this,Bi).hide()}function xhe(){Es(this,OC,!1)}function Phe(t,e){e[gs]&&e[gs][Sd]&&te(t,e.commentedCellClassName)}function Ohe(){Es(this,zw,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Ahe(){Es(this,zw,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(VR)}function Ihe(t){Es(this,Uw,{width:wt(t.target),height:Bt(t.target)})}function Hhe(t){const e=wt(t.target),n=Bt(t.target);(e!==nt(this,Uw).width+1||n!==nt(this,Uw).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[_U]:{width:e,height:n}})}function Dhe(t){nt(this,It).isVisible()&&Pi(t)}function Nhe(){nt(this,Ip)||this.hide()}var qI=zF,khe=TypeError,Lhe=function(t,e){if(!delete t[e])throw new khe("Cannot delete property "+qI(e)+" of "+qI(t))},$he=uu,Fhe=Pv,Whe=Av,Vhe=aW,Bhe=Lhe,Uhe=lW,zhe=[].unshift(0)!==1,Ghe=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},jhe=zhe||!Ghe();$he({target:"Array",proto:!0,arity:1,forced:jhe},{unshift:function(e){var n=Fhe(this),r=Whe(n),i=arguments.length;if(i){Uhe(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:Bhe(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return Vhe(n,r+i)}});function NS(t,e,n){return e=Yhe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yhe(t){var e=Khe(t,"string");return typeof e=="symbol"?e:String(e)}function Khe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MU{constructor(e){NS(this,"hot",void 0),NS(this,"commands",{}),NS(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=Xhe(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Vt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),P(u,c=>c.apply(this.hot,r))}}function Xhe(t,e){let n;return P(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function kS(t,e,n){return e=qhe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qhe(t){var e=Qhe(t,"string");return typeof e=="symbol"?e:String(e)}function Qhe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xU{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;kS(this,"hot",void 0),kS(this,"predefinedItems",RU()),kS(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ke(e,(r,i)=>{let o="";r.name===qe?(n[qe]=r,o=qe):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Zhe(e,this.defaultOrderPattern,this.predefinedItems)}}function Zhe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),je(i)?Ke(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),je(o)?hn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):P(i,(o,s)=>{let a=n[o];!a&&ghe.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),je(o)&&hn(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function Js(t,e,n){return e=Jhe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jhe(t){var e=ede(t,"string");return typeof e=="symbol"?e:String(e)}function ede(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tde{constructor(e,n){Js(this,"top",void 0),Js(this,"topRelative",void 0),Js(this,"left",void 0),Js(this,"leftRelative",void 0),Js(this,"scrollTop",void 0),Js(this,"scrollLeft",void 0),Js(this,"cellHeight",void 0),Js(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function jh(t,e,n){nde(t,e),e.set(t,n)}function nde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Je(t,e){var n=PU(t,e,"get");return rde(t,n)}function rde(t,e){return e.get?e.get.call(t):e.value}function _m(t,e,n){var r=PU(t,e,"set");return ide(t,r,n),n}function PU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ide(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var cr=new WeakMap,ea=new WeakMap,Ln=new WeakMap,LS=new WeakMap,ku=new WeakMap;class ode{constructor(e){jh(this,cr,{writable:!0,value:void 0}),jh(this,ea,{writable:!0,value:void 0}),jh(this,Ln,{writable:!0,value:void 0}),jh(this,LS,{writable:!0,value:!1}),jh(this,ku,{writable:!0,value:{above:0,below:0,left:0,right:0}}),_m(this,LS,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Je(this,ku)[e]=n,this}setElement(e){return _m(this,cr,e),this}setParentElement(e){return _m(this,ea,e),this}updatePosition(e){_m(this,Ln,new tde(e,Je(this,cr).ownerDocument.defaultView)),Je(this,LS)?(Je(this,Ln).fitsBelow(Je(this,cr))?this.setPositionBelowCursor():Je(this,Ln).fitsAbove(Je(this,cr))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Je(this,cr).dir==="rtl"?Je(this,Ln).fitsOnLeft(Je(this,cr))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Je(this,Ln).fitsOnRight(Je(this,cr))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Je(this,ku).above+Je(this,Ln).top-Je(this,cr).offsetHeight;Je(this,ea)&&(e=Je(this,Ln).top+Je(this,Ln).cellHeight-Je(this,cr).offsetHeight+3),Je(this,cr).style.top=`${e}px`}setPositionBelowCursor(){let e=Je(this,ku).below+Je(this,Ln).top+1;Je(this,ea)&&(e=Je(this,Ln).top-1),Je(this,cr).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Je(this,Ln).left;if(Je(this,ea)){const{right:n}=Je(this,ea).getBoundingClientRect();e+=Je(this,Ln).cellWidth+n-(Je(this,Ln).left+Je(this,Ln).cellWidth)}else e+=Je(this,ku).right;Je(this,cr).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Je(this,ku).left+Je(this,Ln).left-Je(this,cr).offsetWidth;if(Je(this,ea)){const{left:n}=Je(this,ea).getBoundingClientRect();e-=Je(this,Ln).left-n}Je(this,cr).style.left=`${e}px`}}function OU(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=$r(e,-1,p()-1);function a(E,v){const C=p()-1;return E<0&&(E=C),E>C&&(E=0),o.has(E)?-1:(o.add(E),r(E,!1)===!1&&(E=a(v===1?++E:--E,v)),E)}function l(E){E>-1&&E<p()&&r(E,!0)!==!1&&(s=E)}function u(){return s}function c(){p()>0&&(o.clear(),s=a(0,1))}function h(){p()>0&&(o.clear(),s=a(p()-1,-1))}function f(){p()>0&&(o.clear(),s=a(++s,1))}function g(){p()>0&&(o.clear(),s=a(--s,-1))}function p(){return Math.max(n(),0)}function y(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:f,toPreviousItem:g,getSize:p,clear:y}}function sde(t){return Ye(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function UR(t){return Vt(t,"submenu")}function zR(t){return new RegExp(qe,"i").test(t.name)}function Hp(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function QI(t){return Vt(t,"disableSelection")}function ade(t){return $e(t,"htSeparator")}function lde(t){return $e(t,"htSubmenu")}function ude(t){return $e(t,"htDisabled")}function cde(t){return $e(t,"htSelectionDisabled")}function hde(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function AU(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function dde(t,e){let n=t.slice(0);return n.reverse(),n=AU(n,e),n.reverse(),n}function fde(t){const e=[];return P(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function gde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qe,n=t.slice(0);return n=AU(n,e),n=dde(n,e),n=fde(n),n}function mde(t){return OU({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||ade(r)||ude(r)||cde(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function pde(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.hotMenu.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const n=t.hotMenu.getSelectedLast();n&&(t.hotMenu.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const IU="menu",ZI=IU;function wde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(pde(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:IU})}function i(u,c){const h=a(c);u.forEach(f=>{let{keys:g}=f;g.forEach(p=>h.removeShortcutsByKeys(p))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${ZI}:${u}`:ZI}function a(u){var c;const h=t.hotMenu.getShortcutManager(),f=s(u);return(c=h.getContext(f))!==null&&c!==void 0?c:h.addContext(f)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function vde(t){return(e,n,r,i,o,s)=>{if(n.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s;if(so(n),te(l,"htItemWrapper"),t.getSettings().ariaTags){const c=!Hp(a,t)&&!QI(a)&&!zR(a);Ae(n,[rQ(),GT(u),...c?[uh(-1)]:[],...Hp(a,t)?[cQ()]:[],...UR(a)?[bi(!1)]:[]])}n.className="",n.appendChild(l),zR(a)?te(n,"htSeparator"):typeof a.renderer=="function"?(te(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):fu(l,u),Hp(a,t)?te(n,"htDisabled"):QI(a)?te(n,"htSelectionDisabled"):UR(a)&&te(n,"htSubmenu")}}function JI(t,e,n){Cde(t,e),e.set(t,n)}function Cde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yo(t,e,n){return e=yde(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yde(t){var e=Sde(t,"string");return typeof e=="symbol"?e:String(e)}function Sde(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eH(t,e,n){var r=HU(t,e,"set");return bde(t,r,n),n}function bde(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Yh(t,e){var n=HU(t,e,"get");return Rde(t,n)}function HU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Rde(t,e){return e.get?e.get.call(t):e.value}const tH=215;var Kh=new WeakMap,Mm=new WeakMap;class mh{constructor(e,n){var r=this;yo(this,"hot",void 0),yo(this,"options",void 0),yo(this,"eventManager",new ri(this)),yo(this,"container",void 0),yo(this,"positioner",void 0),yo(this,"hotMenu",null),yo(this,"hotSubMenus",{}),yo(this,"parentMenu",void 0),yo(this,"menuItems",null),yo(this,"origOutsideClickDeselects",null),JI(this,Kh,{writable:!0,value:void 0}),JI(this,Mm,{writable:!0,value:void 0}),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:tH,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new ode(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Ef(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Yh(this,Kh)}getKeyboardShortcutsCtrl(){return Yh(this,Mm)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=qv(a=>this.openSubMenu(a),300),n=this.options.minWidth||tH;let r=!1,i=ni(this.menuItems,a=>(a.key===Df&&(r=!0),hde(a,this.hot)));if(i.length<1&&!r)i.push(RU()[Df]);else if(i.length===0)return;i=gde(i,qe);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return fe(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:vde(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{Yh(this,Kh).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===qe?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),wR()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!wR()||!ja(a))&&o&&this.hasSelectedItem()&&(Rs()||i1()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),eH(this,Kh,mde(this.hotMenu)),eH(this,Mm,wde(this)),Yh(this,Mm).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Yh(this,Kh).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Ae(r,[bi(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!lde(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new mh(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Ae(n,[bi(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ae(i,[bi(!1)])}}closeAllSubMenus(){P(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?sde(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||zR(e)||Hp(e,this.hot)||UR(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(Et(r)&&(r=r.call(this.hot),r===null||Tt(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),te(i,`htMenu ${this.options.className}`),r&&te(i,r),this.options.container.appendChild(i)),i}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=sn(n,(a,l)=>a+(l.name===qe?1:26),0);i.width=`${o+3}px`,i.height=`${s+3}px`,r.height=i.height,this.hot.getSettings().ariaTags&&Ae(this.hotMenu.rootElement,[nQ(),uh(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ka(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ka(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&$e(e.target,"htCore")&&ka(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}St(mh,Ur);function xm(t,e){Ede(t,e),e.add(t)}function Ede(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $S(t,e,n){return e=Tde(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tde(t){var e=_de(t,"string");return typeof e=="symbol"?e:String(e)}function _de(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pm(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const bd="contextMenu",Mde=70,nH=bd;ve.getSingleton().register("afterContextMenuDefaultOptions");ve.getSingleton().register("beforeContextMenuShow");ve.getSingleton().register("afterContextMenuShow");ve.getSingleton().register("afterContextMenuHide");ve.getSingleton().register("afterContextMenuExecute");var rH=new WeakSet,iH=new WeakSet,oH=new WeakSet,sH=new WeakSet;class AC extends ct{constructor(){super(...arguments),xm(this,sH),xm(this,oH),xm(this,iH),xm(this,rH),$S(this,"commandExecutor",new MU(this.hot)),$S(this,"itemsFactory",null),$S(this,"menu",null)}static get PLUGIN_KEY(){return bd}static get PLUGIN_PRIORITY(){return Mde}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[MC,xC,qe,cg,hg,qe,_C,fg,qe,PC,TC,qe,dg,qe,mi]}isEnabled(){return!!this.hot.getSettings()[bd]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[bd];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new mh(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Pm(this,iH,Pde).call(this)),this.menu.addLocalHook("afterOpen",()=>Pm(this,oH,Ode).call(this)),this.menu.addLocalHook("afterClose",()=>Pm(this,sH,Ade).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Pm(this,rH,xde).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=RC(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:nH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(nH)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Ke(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new xU(this.hot,AC.DEFAULT_ITEMS);const e=this.hot.getSettings()[bd],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),P(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function xde(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),$e(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!($e(o,"current")&&$e(o,"wtBorder"))))return;const s=RC(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Pde(){this.hot.runHooks("beforeContextMenuShow",this)}function Ode(){this.hot.runHooks("afterContextMenuShow",this)}function Ade(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}AC.SEPARATOR={name:qe};function Ide(t){return{key:"copy",name(){return this.getTranslatedPhrase(Z1)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Hde(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?$r(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(t_,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Dde(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?$r(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(e_,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Nde(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?$r(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(J1,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function kde(t){return{key:"cut",name(){return this.getTranslatedPhrase(n_)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class Lde{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class $de{constructor(){this.clipboardData=new Lde}}function aH(t,e){DU(t,e),e.add(t)}function Lu(t,e,n){DU(t,e),e.set(t,n)}function DU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Om(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function fr(t,e){var n=NU(t,e,"get");return Fde(t,n)}function Fde(t,e){return e.get?e.get.call(t):e.value}function $u(t,e,n){var r=NU(t,e,"set");return Wde(t,r,n),n}function NU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Wde(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ta=new WeakMap,FS=new WeakMap,Xh=new WeakMap,GR=new WeakMap,jR=new WeakMap,qh=new WeakMap,Am=new WeakSet,lH=new WeakSet;class Vde{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;aH(this,lH),aH(this,Am),Lu(this,ta,{writable:!0,value:void 0}),Lu(this,FS,{writable:!0,value:void 0}),Lu(this,Xh,{writable:!0,value:void 0}),Lu(this,GR,{writable:!0,value:void 0}),Lu(this,jR,{writable:!0,value:void 0}),Lu(this,qh,{writable:!0,value:void 0}),$u(this,FS,n),$u(this,Xh,r),$u(this,GR,i),$u(this,jR,o),$u(this,qh,s)}setSelectedRange(e){$u(this,ta,e)}getCellsRange(){if(fr(this,FS).call(this)===0||fr(this,Xh).call(this)===0)return null;const{row:e,col:n}=fr(this,ta).getTopStartCorner(),{row:r,col:i}=fr(this,ta).getBottomEndCorner(),o=Om(this,lH,Bde).call(this,e,r),s=Om(this,Am,WS).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(fr(this,Xh).call(this)===0||fr(this,qh).call(this)===0)return null;const{col:e}=fr(this,ta).getTopStartCorner(),{col:n}=fr(this,ta).getBottomEndCorner(),r=Om(this,Am,WS).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(fr(this,Xh).call(this)===0||fr(this,qh).call(this)===0)return null;const{col:e}=fr(this,ta).getTopStartCorner(),{col:n}=fr(this,ta).getBottomEndCorner(),r=Om(this,Am,WS).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-fr(this,qh).call(this),startCol:e,endRow:-1,endCol:r}}}function WS(t,e){return Math.min(e,Math.max(t+fr(this,jR).call(this)-1,t))}function Bde(t,e){return Math.min(e,Math.max(t+fr(this,GR).call(this)-1,t))}function kU(t){const e=[],n=[];return P(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);Re(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);Re(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function ts(t,e){LU(t,e),e.add(t)}function Cl(t,e,n){LU(t,e),e.set(t,n)}function LU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qh(t,e,n){return e=Ude(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ude(t){var e=zde(t,"string");return typeof e=="symbol"?e:String(e)}function zde(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gr(t,e){var n=$U(t,e,"get");return Gde(t,n)}function Gde(t,e){return e.get?e.get.call(t):e.value}function Gi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ns(t,e,n){var r=$U(t,e,"set");return jde(t,r,n),n}function $U(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function jde(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}ve.getSingleton().register("afterCopyLimit");ve.getSingleton().register("modifyCopyableRange");ve.getSingleton().register("beforeCut");ve.getSingleton().register("afterCut");ve.getSingleton().register("beforePaste");ve.getSingleton().register("afterPaste");ve.getSingleton().register("beforeCopy");ve.getSingleton().register("afterCopy");const Im="copyPaste",Yde=80,Kde=["fragmentSelection"],uH=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var YR=new WeakMap,KR=new WeakMap,XR=new WeakMap,Fu=new WeakMap,Hm=new WeakMap,Dm=new WeakMap,Wu=new WeakMap,VS=new WeakSet,cH=new WeakSet,FU=new WeakSet,$M=new WeakSet,hH=new WeakSet,dH=new WeakSet,fH=new WeakSet,gH=new WeakSet,mH=new WeakSet;class Xde extends ct{constructor(){super(...arguments),ts(this,mH),ts(this,gH),ts(this,fH),ts(this,dH),ts(this,hH),ts(this,$M),ts(this,FU),ts(this,cH),ts(this,VS),Qh(this,"columnsLimit",1/0),Qh(this,"rowsLimit",1/0),Qh(this,"pasteMode","overwrite"),Qh(this,"uiContainer",this.hot.rootDocument.body),Cl(this,YR,{writable:!0,value:!1}),Cl(this,KR,{writable:!0,value:!1}),Cl(this,XR,{writable:!0,value:!1}),Cl(this,Fu,{writable:!0,value:"cells-only"}),Cl(this,Hm,{writable:!0,value:!1}),Cl(this,Dm,{writable:!0,value:!1}),Cl(this,Wu,{writable:!0,value:new Vde({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),Qh(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Im}static get SETTING_KEYS(){return[Im,...Kde]}static get PLUGIN_PRIORITY(){return Yde}isEnabled(){return!!this.hot.getSettings()[Im]}enablePlugin(){var e=this;if(this.enabled)return;const{[Im]:n}=this.hot.getSettings();if(typeof n=="object"){var r,i;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,ns(this,YR,!!n.copyColumnHeaders),ns(this,KR,!!n.copyColumnGroupHeaders),ns(this,XR,!!n.copyColumnHeadersOnly),this.uiContainer=(i=n.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>Gi(this,hH,Zde).call(this,o)),this.addHook("afterSelectionEnd",()=>Gi(this,dH,Jde).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),n1()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Gi(e,fH,efe).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Gi(e,gH,tfe).call(e,...s)}),this.addHook("afterSelection",()=>Gi(this,mH,nfe).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";ns(this,Fu,e),ns(this,Hm,!0),Gi(this,VS,pH).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){ns(this,Dm,!0),Gi(this,VS,pH).call(this,"cut")}getRangedCopyableData(e){return Wd(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=kU(e);return P(r,o=>{const s=[];P(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new $de;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Gr(this,Wu).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Gr(this,Fu)==="column-headers-only"?n.set("headers",Gr(this,Wu).getMostBottomColumnHeadersRange()):(Gr(this,Fu)==="with-column-headers"?n.set("headers",Gr(this,Wu).getMostBottomColumnHeadersRange()):Gr(this,Fu)==="with-column-group-headers"&&n.set("headers",Gr(this,Wu).getAllColumnHeadersRange()),n.set("cells",Gr(this,Wu).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,f=s,g=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:p,visualRow:y}=this.hot.getCellMeta(c,a);if(c=y+1,p===!0)continue;f=y,h=a;const E=[],v=o.length%r;for(;E.length<i||h<=u;){const{skipColumnOnPaste:C,visualCol:S}=this.hot.getCellMeta(s,h);if(h=S+1,C===!0)continue;g=S;const T=E.length%i;E.push(e[v][T])}o.push(E)}return this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,f,g]}onCopy(e){if(!this.hot.isListening()&&!Gr(this,Hm)||this.isEditorOpened())return;this.setCopyableText(),ns(this,Hm,!1);const n=this.getRangedData(this.copyableRanges),r=Gi(this,cH,qde).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){const o=Wd(n);if(e&&e.clipboardData){const s=SR(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[uH,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}ns(this,Fu,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!Gr(this,Dm)||this.isEditorOpened())return;this.setCopyableText(),ns(this,Dm,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const i=Wd(n);if(e&&e.clipboardData){const o=SR(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[uH,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const a=Gv(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=s2(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=Yre(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[r,i,o,s]=this.populateValues(n);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function pH(t){if(n1()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&LV(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function qde(t){const{rows:e}=kU(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function Qde(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&ZT(r)}}}function WU(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&JT(r)}}}function Zde(t){t.items.push({name:"---------"},Ide(this)),Gr(this,YR)&&t.items.push(Nde(this)),Gr(this,KR)&&t.items.push(Dde(this)),Gr(this,XR)&&t.items.push(Hde(this)),t.items.push(kde(this))}function Jde(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function efe(){Gi(this,$M,WU).call(this)}function tfe(){Gi(this,FU,Qde).call(this)}function nfe(){Gi(this,$M,WU).call(this)}function VU(t,e){return`border_row${t}col${e}`}function Rd(){return{width:1,color:"#000"}}function Ts(){return{hide:!0}}function rfe(){return{width:1,color:"#000",cornerVisible:!1}}function BS(t){if(fe(t.start)||fe(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(fe(t.end)||fe(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Zh(t){return fe(t.start)&&(t.left=t.start),fe(t.end)&&(t.right=t.end),t}function US(t,e){return{id:VU(t,e),border:rfe(),row:t,col:e,top:Ts(),bottom:Ts(),start:Ts(),end:Ts()}}function ife(t,e){return Vt(e,"border")&&e.border&&(t.border=e.border),Vt(e,"top")&&fe(e.top)&&(e.top?(je(e.top)||(e.top=Rd()),t.top=e.top):(e.top=Ts(),t.top=e.top)),Vt(e,"bottom")&&fe(e.bottom)&&(e.bottom?(je(e.bottom)||(e.bottom=Rd()),t.bottom=e.bottom):(e.bottom=Ts(),t.bottom=e.bottom)),Vt(e,"start")&&fe(e.start)&&(e.start?(je(e.start)||(e.start=Rd()),t.start=e.start):(e.start=Ts(),t.start=e.start)),Vt(e,"end")&&fe(e.end)&&(e.end?(je(e.end)||(e.end=Rd()),t.end=e.end):(e.end=Ts(),t.end=e.end)),t}function Ls(t,e){let n=!1;return P(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!Vt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function IC(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function ofe(t){return t.some(e=>fe(e.left)||fe(e.right))}function sfe(t){return t.some(e=>fe(e.start)||fe(e.end))}const afe=new Map([["left","start"],["right","end"]]);function lfe(t){var e;return(e=afe.get(t))!==null&&e!==void 0?e:t}function ufe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(b_);return Ls(this,"bottom")&&(e=IC(e)),e},callback(e,n){const r=Ls(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function cfe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(R_);return Ls(this,e)&&(n=IC(n)),n},callback(n,r){const i=Ls(this,e);t.prepareBorder(r,e,i)}}}function hfe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(E_)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Ls(this)}}}function dfe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(S_);return Ls(this,e)&&(n=IC(n)),n},callback(n,r){const i=Ls(this,e);t.prepareBorder(r,e,i)}}}function ffe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(y_);return Ls(this,"top")&&(e=IC(e)),e},callback(e,n){const r=Ls(this,"top");t.prepareBorder(n,"top",r)}}}function wH(t,e){gfe(t,e),e.add(t)}function gfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mfe(t,e,n){return e=pfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pfe(t){var e=wfe(t,"string");return typeof e=="symbol"?e:String(e)}function wfe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vH(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Dp="customBorders",vfe=90;var CH=new WeakSet,yH=new WeakSet;class Cfe extends ct{constructor(){super(...arguments),wH(this,yH),wH(this,CH),mfe(this,"savedBorders",[])}static get PLUGIN_KEY(){return Dp}static get PLUGIN_PRIORITY(){return vfe}isEnabled(){return!!this.hot.getSettings()[Dp]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>vH(this,CH,yfe).call(this,e)),this.addHook("init",()=>vH(this,yH,Sfe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=BS(n));const o=Zc(e),s=Of(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});P(e,a=>{s(a).forAll((l,u)=>{P(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,lfe(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Zc(e),r=Of(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return P(e,o=>{r(o).forAll((s,a)=>{P(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(Zh(l))})})}),i}clearBorders(e){e?this.setBorders(e):(P(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=US(e,n);r&&(a=ife(a,r),P(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Zh(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);Re(e.from.row,r,o=>{Re(e.from.col,i,s=>{const a=US(o,s);let l=0;o===e.from.row&&Vt(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&Vt(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&Vt(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&Vt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Zh(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=VU(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=US(e,n):o=BS(o),i?(o[r]=Ts(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Zh(o)))):(o[r]=Rd(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Zh(o)))}prepareBorder(e,n,r){P(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":Re(o.col,s.col,a=>{Re(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":Re(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":Re(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":Re(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":Re(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){P(e,n=>{const r=BS(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return sn([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ye(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){P(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){P(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ye(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):P(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return P(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return P(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):P(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);P(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Dp];if(Array.isArray(e)){const n=rr(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=ofe(e),r=sfe(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function yfe(t){this.hot.getSettings()[Dp]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(C_)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[ffe(this),dfe(this),ufe(this),cfe(this),hfe(this)]}})}function Sfe(){this.changeBorderSettings()}function bfe(t,e){Rfe(t,e),e.add(t)}function Rfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zS(t,e,n){return e=Efe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Efe(t){var e=Tfe(t,"string");return typeof e=="symbol"?e:String(e)}function Tfe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SH(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const bH="dragToScroll",_fe=100;var GS=new WeakSet;class Mfe extends ct{constructor(){super(...arguments),bfe(this,GS),zS(this,"boundaries",null),zS(this,"callback",null),zS(this,"listening",!1)}static get PLUGIN_KEY(){return bH}static get PLUGIN_PRIORITY(){return _fe}isEnabled(){return!!this.hot.getSettings()[bH]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>SH(this,GS,RH).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>SH(this,GS,RH).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=Ef(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function RH(t){if(ja(t))return;const e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback((n,r)=>{n<0?e.scrollLeft-=50:n>0&&(e.scrollLeft+=50),r<0?e.scrollTop-=20:r>0&&(e.scrollTop+=20)}),this.listen())}function yl(t,e){xfe(t,e),e.add(t)}function xfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jS(t,e,n){return e=Pfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pfe(t){var e=Ofe(t,"string");return typeof e=="symbol"?e:String(e)}function Ofe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function da(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ve.getSingleton().register("afterDropdownMenuDefaultOptions");ve.getSingleton().register("beforeDropdownMenuShow");ve.getSingleton().register("afterDropdownMenuShow");ve.getSingleton().register("afterDropdownMenuHide");ve.getSingleton().register("afterDropdownMenuExecute");const Np="dropdownMenu",Afe=230,qR="changeType",YS=Np;var FM=new WeakSet,EH=new WeakSet,TH=new WeakSet,_H=new WeakSet,MH=new WeakSet,xH=new WeakSet,PH=new WeakSet;class HC extends ct{static get PLUGIN_KEY(){return Np}static get PLUGIN_PRIORITY(){return Afe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[cg,hg,qe,fg,qe,EC,qe,dg,qe,mi]}constructor(e){super(e),yl(this,PH),yl(this,xH),yl(this,MH),yl(this,_H),yl(this,TH),yl(this,EH),yl(this,FM),jS(this,"commandExecutor",new MU(this.hot)),jS(this,"itemsFactory",null),jS(this,"menu",null),this.hot.addHook("afterGetColHeader",(n,r)=>da(this,TH,Hfe).call(this,n,r))}isEnabled(){return this.hot.getSettings()[Np]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new xU(this.hot,HC.DEFAULT_ITEMS);const n=this.hot.getSettings()[Np],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new mh(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>da(this,_H,Dfe).call(this)),this.menu.addLocalHook("afterOpen",()=>da(this,MH,Nfe).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>da(this,xH,kfe).call(this,o)),this.menu.addLocalHook("afterClose",()=>da(this,PH,Lfe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),P(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=RC(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:YS},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:YS}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(YS)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>da(this,EH,Ife).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ke(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function BU(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Ife(t){if(t.stopPropagation(),$e(t.target,qR)){const e=RC(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function Hfe(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${qR}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=qR,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ae(s,[Us(),GT(" ")]),Ae(e,[RV("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function Dfe(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Nfe(){this.hot.runHooks("afterDropdownMenuShow",this),da(this,FM,BU).call(this,this.menu)}function kfe(t){da(this,FM,BU).call(this,t)}function Lfe(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}HC.SEPARATOR={name:qe};function OH(t,e,n){return e=$fe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $fe(t){var e=Ffe(t,"string");return typeof e=="symbol"?e:String(e)}function Ffe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wfe{constructor(e){OH(this,"hot",void 0),OH(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return Re(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(Re(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();Re(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();Re(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const Vfe=Wfe;function AH(t,e,n){return e=Bfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bfe(t){var e=Ufe(t,"string");return typeof e=="symbol"?e:String(e)}function Ufe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WM{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){AH(this,"dataProvider",void 0),AH(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=yr(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=hn(yr(WM.DEFAULT_OPTIONS),n),n=hn(n,e),n.filename=zT(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const zfe=WM,Gfe=String.fromCharCode(13),jfe=String.fromCharCode(34),Yfe=String.fromCharCode(10);class Kfe extends zfe{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?String.fromCharCode(65279):"";return i&&(r=Ye(r,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),P(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Qt(e);return r!==""&&(n||r.indexOf(Gfe)>=0||r.indexOf(jfe)>=0||r.indexOf(Yfe)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const Xfe=Kfe,qfe="csv",QR={[qfe]:Xfe};function Qfe(t,e,n){return typeof QR[t]=="function"?new QR[t](e,n):null}const Zfe="exportFile",Jfe=240;class ege extends ct{static get PLUGIN_KEY(){return Zfe}static get PLUGIN_PRIORITY(){return Jfe}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!QR[e])throw new Error(`Export format type "${e}" is not supported.`);return Qfe(e,new Vfe(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Vu(t,e,n){return e=tge(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tge(t){var e=nge(t,"string");return typeof e=="symbol"?e:String(e)}function nge(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gg{constructor(e,n){let{id:r,stateless:i=!0}=n;Vu(this,"hot",void 0),Vu(this,"id",void 0),Vu(this,"elements",[]),Vu(this,"hidden",!1),Vu(this,"stateId",""),Vu(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new oC)}getElements(){return this.elements}reset(){P(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),P(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}St(gg,Ur);const Nf={};function Ka(t,e){if(!Nf[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Nf[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function Vl(t){if(!Nf[t])throw Error(`Filter condition "${t}" does not exist.`);return Nf[t].descriptor}function dn(t,e,n){n.key=t,Nf[t]={condition:e,descriptor:n}}const In="none";function rge(){return!0}dn(In,rge,{name:sC,inputsCount:0,showOperators:!1});const zd="empty";function ige(t){return Cn(t.value)}dn(zd,ige,{name:A_,inputsCount:0,showOperators:!0});const kp="not_empty";function oge(t,e){return!Ka(zd,e)(t)}dn(kp,oge,{name:I_,inputsCount:0,showOperators:!0});const Gd="eq";function sge(t,e){let[n]=e;return Qt(t.value).toLocaleLowerCase(t.meta.locale)===Qt(n)}dn(Gd,sge,{name:H_,inputsCount:1,showOperators:!0});const Lp="neq";function age(t,e){return!Ka(Gd,e)(t)}dn(Lp,age,{name:D_,inputsCount:1,showOperators:!0});const UU="gt";function lge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}dn(UU,lge,{name:F_,inputsCount:1,showOperators:!0});const zU="gte";function uge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}dn(zU,uge,{name:W_,inputsCount:1,showOperators:!0});const GU="lt";function cge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}dn(GU,cge,{name:V_,inputsCount:1,showOperators:!0});const jU="lte";function hge(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}dn(jU,hge,{name:B_,inputsCount:1,showOperators:!0});const VM="date_after";function dge(t,e){let[n]=e;const r=J(t.value,t.meta.dateFormat),i=J(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}dn(VM,dge,{name:G_,inputsCount:1,showOperators:!0});const BM="date_before";function fge(t,e){let[n]=e;const r=J(t.value,t.meta.dateFormat),i=J(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}dn(BM,fge,{name:j_,inputsCount:1,showOperators:!0});const Gw="between";function gge(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Ka(BM,[o]),a=Ka(VM,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}dn(Gw,gge,{name:U_,inputsCount:2,showOperators:!0});const YU="not_between";function mge(t,e){return!Ka(Gw,e)(t)}dn(YU,mge,{name:z_,inputsCount:2,showOperators:!0});const KU="begins_with";function pge(t,e){let[n]=e;return Qt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Qt(n))}dn(KU,pge,{name:N_,inputsCount:1,showOperators:!0});const XU="ends_with";function wge(t,e){let[n]=e;return Qt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Qt(n))}dn(XU,wge,{name:k_,inputsCount:1,showOperators:!0});const UM="contains";function vge(t,e){let[n]=e;return Qt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Qt(n))>=0}dn(UM,vge,{name:L_,inputsCount:1,showOperators:!0});const qU="not_contains";function Cge(t,e){return!Ka(UM,e)(t)}dn(qU,Cge,{name:$_,inputsCount:1,showOperators:!0});const QU="date_tomorrow";function yge(t){const e=J(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(J().subtract(-1,"days").startOf("day"),"d"):!1}dn(QU,yge,{name:K_,inputsCount:0});const ZU="date_today";function Sge(t){const e=J(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(J().startOf("day"),"d"):!1}dn(ZU,Sge,{name:Y_,inputsCount:0});const JU="date_yesterday";function bge(t){const e=J(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(J().subtract(1,"days").startOf("day"),"d"):!1}dn(JU,bge,{name:X_,inputsCount:0});S2();function Rge(t,e){let n=t;return n===""&&(n=`(${e})`),n}const ZR=new Set([1]).has(1),Ege=ZR&&typeof Array.from=="function";function mg(t){let e=t;return ZR&&(e=new Set(e)),function(n){let r;return ZR?r=e.has(n):r=!!~e.indexOf(n),r}}function ez(t){return t??""}function JR(t){let e=t;return Ege?e=Array.from(new Set(e)):e=VT(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function IH(t,e,n,r){const i=[],o=t===e;let s;return o||(s=mg(e)),P(t,a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:Rge(a,n)};r&&r(u),i.push(u)}),i}const Bl="by_value";function Tge(t,e){let[n]=e;return n(t.value)}dn(Bl,Tge,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[mg(e)]},showOperators:!1});const kf={};function _ge(t){if(!kf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=kf[t].func;return function(n,r){return e(n,r)}}function Mge(t){return kf[t].name}function zM(t,e,n){kf[t]={name:e,func:n}}const Fa="conjunction",xge=Z_;function Pge(t,e){return t.every(n=>n.func(e))}zM(Fa,xge,Pge);const jw="disjunction",Oge=aC;function Age(t,e){return t.some(n=>n.func(e))}zM(jw,Oge,Age);const GM="disjunctionWithExtraCondition",Ige=aC;function Hge(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}zM(GM,Ige,Hge);const Dge="numeric",tz="text",Nge="date",HH={[Dge]:[In,qe,zd,kp,qe,Gd,Lp,qe,UU,zU,GU,jU,Gw,YU],[tz]:[In,qe,zd,kp,qe,Gd,Lp,qe,KU,XU,qe,UM,qU],[Nge]:[In,qe,zd,kp,qe,Gd,Lp,qe,BM,VM,Gw,qe,QU,ZU,JU]};function kge(t){const e=[];let n=t;return HH[n]||(n=tz),P(HH[n],r=>{let i;r===qe?i={name:qe}:i=yr(Vl(r)),e.push(i)}),e}function Jh(t,e,n){return e=Lge(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lge(t){var e=$ge(t,"string");return typeof e=="symbol"?e:String(e)}function $ge(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const KS="built",XS="building",DH=["click","input","keydown","keypress","keyup","focus","blur","change"];let to=class nz{static get DEFAULTS(){return yr({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Jh(this,"hot",void 0),Jh(this,"eventManager",new ri(this)),Jh(this,"options",void 0),Jh(this,"_element",void 0),Jh(this,"buildState",void 0),this.hot=e,this.options=hn(nz.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===XS?this._element:this.buildState===KS?(this.update(),this._element):(this.buildState=XS,this.build(),this.buildState=KS,this._element)}isBuilt(){return this.buildState===KS}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Tr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=XS),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&te(this._element,this.options.className),this.options.children.length)P(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ke(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),P(DH,r=>e(n,r))}else P(DH,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};St(to,Ur);function Fge(t,e){rz(t,e),e.add(t)}function Wge(t,e,n){rz(t,e),e.set(t,n)}function rz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nm(t,e){var n=iz(t,e,"get");return Vge(t,n)}function Vge(t,e){return e.get?e.get.call(t):e.value}function Bge(t,e,n){var r=iz(t,e,"set");return Uge(t,r,n),n}function iz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Uge(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function zge(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Bu=new WeakMap,NH=new WeakSet;class Wa extends to{static get DEFAULTS(){return yr({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,hn(Wa.DEFAULTS,n)),Fge(this,NH),Wge(this,Bu,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>zge(this,NH,Gge).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Bge(this,Bu,this._element.firstChild),te(this._element,"htUIInput"),te(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Nm(this,Bu).type=this.options.type,Nm(this,Bu).placeholder=this.translateIfPossible(this.options.placeholder),Nm(this,Bu).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Nm(this,Bu).focus()}}function Gge(t){this.options.value=t.target.value}function qS(t,e){oz(t,e),e.add(t)}function ed(t,e,n){oz(t,e),e.set(t,n)}function oz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uu(t,e,n){var r=sz(t,e,"set");return jge(t,r,n),n}function jge(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function QS(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ut(t,e){var n=sz(t,e,"get");return Yge(t,n)}function sz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Yge(t,e){return e.get?e.get.call(t):e.value}var Sn=new WeakMap,km=new WeakMap,Lm=new WeakMap,ZS=new WeakMap,$m=new WeakMap,kH=new WeakSet,LH=new WeakSet,$H=new WeakSet;class Lf extends to{static get DEFAULTS(){return yr({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,hn(Lf.DEFAULTS,n)),qS(this,$H),qS(this,LH),qS(this,kH),ed(this,Sn,{writable:!0,value:null}),ed(this,km,{writable:!0,value:[]}),ed(this,Lm,{writable:!0,value:void 0}),ed(this,ZS,{writable:!0,value:void 0}),ed(this,$m,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return Ut(this,Sn)}registerHooks(){this.addLocalHook("click",()=>QS(this,$H,qge).call(this))}setItems(e){Uu(this,km,this.translateNames(e)),Ut(this,Sn)&&Ut(this,Sn).setMenuItems(Ut(this,km))}translateNames(e){return P(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Uu(this,Sn,new mh(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Ut(this,Sn).setMenuItems(Ut(this,km));const e=new to(this.hot,{className:"htUISelectCaption"}),n=new to(this.hot,{className:"htUISelectDropdown"});Uu(this,Lm,e),Uu(this,ZS,e.element),Uu(this,$m,n),this.hot.getSettings().ariaTags&&(Ae(n.element,[Us()]),Ae(this._element,[bV()])),P([e,n],r=>this._element.appendChild(r.element)),Ut(this,Sn).addLocalHook("select",r=>QS(this,kH,Kge).call(this,r)),Ut(this,Sn).addLocalHook("afterClose",()=>QS(this,LH,Xge).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Ut(this,Sn).hot.getTranslatedPhrase(sC),Ut(this,ZS).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Ut(this,Sn)&&(Ut(this,Sn).open(),Ut(this,Sn).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Ut(this,Sn).getNavigator().toFirstItem(),Ut(this,Sn).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Ut(this,Sn)&&Ut(this,Sn).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Ut(this,Sn)&&(Ut(this,Sn).destroy(),Uu(this,Sn,null)),Ut(this,Lm)&&Ut(this,Lm).destroy(),Ut(this,$m)&&Ut(this,$m).destroy(),super.destroy()}}function Kge(t){t.name!==qe&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Xge(){this.runLocalHooks("afterClose")}function qge(){this.openOptions()}function FH(t,e){Qge(t,e),e.add(t)}function Qge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WH(t,e,n){return e=Zge(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zge(t){var e=Jge(t,"string");return typeof e=="symbol"?e:String(e)}function Jge(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VH(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var BH=new WeakSet,UH=new WeakSet;class eE extends gg{constructor(e,n){super(e,{id:n.id,stateless:!1}),FH(this,UH),FH(this,BH),WH(this,"name",""),WH(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Lf(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Wa(this.hot,{placeholder:iM})),this.elements.push(new Wa(this.hot,{placeholder:oM})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>VH(this,BH,eme).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),P(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>VH(this,UH,tme).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=yr(e.command);n.name.startsWith(en)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),P(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Vl(In),n=[];return P(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=Vl(e?e.name:In);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||P(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Lf)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Wa)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{te(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&te(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return te(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),P(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Vl(In)];if(e!==null){const{visualIndex:r}=e;n=kge(this.hot.getDataType(0,r,this.hot.countRows(),r))}P(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function eme(t){P(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function tme(t){hh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Pi(t))}function zH(t,e,n){nme(t,e),e.set(t,n)}function nme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function td(t,e){var n=az(t,e,"get");return rme(t,n)}function rme(t,e){return e.get?e.get.call(t):e.value}function GH(t,e,n){var r=az(t,e,"set");return ime(t,r,n),n}function az(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ime(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var zu=new WeakMap,JS=new WeakMap;class Yw extends to{static get DEFAULTS(){return yr({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,hn(Yw.DEFAULTS,n)),zH(this,zu,{writable:!0,value:void 0}),zH(this,JS,{writable:!0,value:void 0})}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),GH(this,JS,e),GH(this,zu,this._element.firstChild),td(this,zu).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(td(this,JS).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return td(this,zu).checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(td(this,zu).checked=e)}focus(){this.isBuilt()&&td(this,zu).focus()}}function ome(t,e){sme(t,e),e.add(t)}function sme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ame(t,e,n){return e=lme(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lme(t){var e=ume(t,"string");return typeof e=="symbol"?e:String(e)}function ume(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cme(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const jH=0;var YH=new WeakSet;class hme extends gg{constructor(e,n){super(e,{id:n.id,stateless:!1}),ome(this,YH),ame(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(te(n.parentNode,"htFiltersMenuOperators"),P(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[Fa,jw];P(e,n=>{const r=new Yw(this.hot,{name:"operator",label:{htmlFor:n,textContent:Mge(n)},value:n,checked:n===e[jH],id:n});r.addLocalHook("change",i=>cme(this,YH,dme).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(vt`Radio button with index ${e} doesn't exist.`);P(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Yw&&n.isChecked());return e?e.getValue():Fa}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&P(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fa,n=arguments.length>1?arguments[1]:void 0,r=e;r===GM&&(r=jw),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(jH)}}function dme(t){this.setState(t.target.value)}function fme(t,e,n){gme(t,e),e.set(t,n)}function gme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eb(t,e){var n=lz(t,e,"get");return mme(t,n)}function mme(t,e){return e.get?e.get.call(t):e.value}function pme(t,e,n){var r=lz(t,e,"set");return wme(t,r,n),n}function lz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function wme(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var nd=new WeakMap;class $f extends to{static get DEFAULTS(){return yr({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,hn($f.DEFAULTS,n)),fme(this,nd,{writable:!0,value:void 0})}build(){super.build(),pme(this,nd,this._element.firstChild)}update(){this.isBuilt()&&(eb(this,nd).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&eb(this,nd).focus()}activate(){eb(this,nd).click()}}function Fm(t,e){uz(t,e),e.add(t)}function Gu(t,e,n){uz(t,e),e.set(t,n)}function uz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wm(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Fe(t,e){var n=cz(t,e,"get");return vme(t,n)}function vme(t,e){return e.get?e.get.call(t):e.value}function Li(t,e,n){var r=cz(t,e,"set");return Cme(t,r,n),n}function cz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Cme(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const KH="multipleSelect.itemBox";var Ui=new WeakMap,$t=new WeakMap,tb=new WeakMap,rs=new WeakMap,na=new WeakMap,ra=new WeakMap,XH=new WeakSet,qH=new WeakSet,QH=new WeakSet,ZH=new WeakSet;class Ff extends to{static get DEFAULTS(){return yr({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,hn(Ff.DEFAULTS,n)),Fm(this,ZH),Fm(this,QH),Fm(this,qH),Fm(this,XH),Gu(this,Ui,{writable:!0,value:[]}),Gu(this,$t,{writable:!0,value:void 0}),Gu(this,tb,{writable:!0,value:void 0}),Gu(this,rs,{writable:!0,value:void 0}),Gu(this,na,{writable:!0,value:void 0}),Gu(this,ra,{writable:!0,value:void 0}),Li(this,rs,new Wa(this.hot,{placeholder:rM,className:"htUIMultipleSelectSearch"})),Li(this,na,new $f(this.hot,{textContent:J_,className:"htUISelectAll"})),Li(this,ra,new $f(this.hot,{textContent:eM,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Fe(this,$t)}registerHooks(){Fe(this,rs).addLocalHook("keydown",e=>Wm(this,qH,Sme).call(this,e)),Fe(this,rs).addLocalHook("input",e=>Wm(this,XH,yme).call(this,e)),Fe(this,na).addLocalHook("click",e=>Wm(this,QH,bme).call(this,e)),Fe(this,ra).addLocalHook("click",e=>Wm(this,ZH,Rme).call(this,e))}setItems(e){Li(this,Ui,e),Fe(this,$t)&&Fe(this,$t).loadData(Fe(this,Ui))}setLocale(e){Li(this,tb,e)}getLocale(){return Fe(this,tb)}getItems(){return[...Fe(this,Ui)]}getValue(){return Tme(Fe(this,Ui))}getSearchInputElement(){return Fe(this,rs)}getSelectAllElement(){return Fe(this,na)}getClearAllElement(){return Fe(this,ra)}isSelectedAllValues(){return Fe(this,Ui).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new to(this.hot,{className:"htUISelectionControls",children:[Fe(this,na),Fe(this,ra)]});this._element.appendChild(Fe(this,rs).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{if(!this._element)return;Fe(this,$t)&&Fe(this,$t).destroy(),te(o,"htUIMultipleSelectHot"),Li(this,$t,new this.hot.constructor(o,{data:Fe(this,Ui),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,h,f,g)=>{l.title=g.instance.getDataAtRowProp(u,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Fe(this,$t).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>Fe(this,$t).container.scrollWidth-Tn(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Fe(this,$t).init();const a=Fe(this,$t).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:KH}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{Fe(this,$t).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:KH})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Fe(this,$t).listen()}reset(){Fe(this,rs).reset(),Fe(this,na).reset(),Fe(this,ra).reset()}update(){this.isBuilt()&&(Fe(this,$t).loadData(Eme(Fe(this,Ui),this.options.value)),super.update())}destroy(){Fe(this,$t)&&Fe(this,$t).destroy(),Fe(this,rs).destroy(),Fe(this,ra).destroy(),Fe(this,na).destroy(),Li(this,rs,null),Li(this,ra,null),Li(this,na,null),Li(this,$t,null),Li(this,Ui,null),super.destroy()}}function yme(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Fe(this,Ui)]:n=ni(Fe(this,Ui),r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Fe(this,$t).loadData(n)}function Sme(t){this.runLocalHooks("keydown",t,this),e1(hh,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Pi(t),Fe(this,$t).listen(),Fe(this,$t).selectCell(0,0))}function bme(t){const e=[];t.preventDefault(),P(Fe(this,$t).getSourceData(),(n,r)=>{n.checked=!0,e.push(H1(n,r)[0])}),Fe(this,$t).setSourceDataAtCell(e)}function Rme(t){const e=[];t.preventDefault(),P(Fe(this,$t).getSourceData(),(n,r)=>{n.checked=!1,e.push(H1(n,r)[0])}),Fe(this,$t).setSourceDataAtCell(e)}function Eme(t,e){const n=mg(e);return Ye(t,r=>(r.checked=n(r.value),r))}function Tme(t){const e=[];return P(t,n=>{n.checked&&e.push(n.value)}),e}function _me(t,e){Mme(t,e),e.add(t)}function Mme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xme(t,e,n){return e=Pme(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pme(t){var e=Ome(t,"string");return typeof e=="symbol"?e:String(e)}function Ome(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ame(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var JH=new WeakSet;class Ime extends gg{constructor(e,n){super(e,{id:n.id,stateless:!1}),_me(this,JH),xme(this,"name",""),this.name=n.name,this.elements.push(new Ff(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Ame(this,JH,Hme).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Bl){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?In:Bl},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=ni(i,h=>h.name===Bl),u={},c=this.hot.getTranslatedPhrase(Nw);if(l){const h=JR(Ye(s(r,a),y=>y.value));o&&(l.args[0]=o);const f=[],g=IH(h,l.args[0],c,y=>{y.checked&&f.push(y.value)}),p=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,p).locale,u.args=[f],u.command=Vl(Bl),u.itemsSnapshot=g}else u.args=[],u.command=Vl(In);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Ff)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{te(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return te(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),P(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Nw),n=JR(this._getColumnVisibleValues()),r=IH(n,n,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(n);const i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ye(this.hot.getDataAtCol(e.visualIndex),n=>ez(n))}}function Hme(t){hh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Pi(t))}var hz;function Dme(t,e){Nme(t,e),e.add(t)}function Nme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kme(t,e,n){return e=Lme(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lme(t){var e=$me(t,"string");return typeof e=="symbol"?e:String(e)}function $me(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fme(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var eD=new WeakSet;class Wf extends gg{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Dme(this,eD),kme(this,"name",""),this.name=n.name,this.elements.push(new Wa(this.hot,{type:"button",value:tM,className:"htUIButton htUIButtonOK",identifier:Wf.BUTTON_OK})),this.elements.push(new Wa(this.hot,{type:"button",value:nM,className:"htUIButton htUIButtonCancel",identifier:Wf.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){P(this.elements,e=>{e.addLocalHook("click",(n,r)=>Fme(this,eD,Wme).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(te(n.parentNode,"htFiltersMenuActionBar"),P(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}hz=Wf;function Wme(t,e){e.options.identifier===hz.BUTTON_OK?this.accept():this.cancel()}function nb(t,e,n){return e=Vme(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vme(t){var e=Bme(t,"string");return typeof e=="symbol"?e:String(e)}function Bme(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const tD="ConditionCollection.filteringStates";class dz{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;nb(this,"hot",void 0),nb(this,"isMapRegistrable",void 0),nb(this,"filteringStates",new oC),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(tD,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Fa;return e.length?_ge(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Fa,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=Ye(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(vt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Tt(kf[r]))throw new Error(vt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:Ka(a,s)}]},i):u.push({name:a,args:s,func:Ka(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return sn(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:Ye(o,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),P(e,n=>{P(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(tD),this.filteringStates=null,this.clearLocalHooks()}}St(dz,Ur);const fz=dz;function nD(t,e,n){return e=Ume(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ume(t){var e=zme(t,"string");return typeof e=="symbol"?e:String(e)}function zme(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gme{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];nD(this,"conditionCollection",void 0),nD(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return P(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return P(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return P(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}const gz=Gme;function rb(t,e){jme(t,e),e.add(t)}function jme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sl(t,e,n){return e=Yme(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yme(t){var e=Kme(t,"string");return typeof e=="symbol"?e:String(e)}function Kme(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ib(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var rD=new WeakSet,iD=new WeakSet,oD=new WeakSet;class mz{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];rb(this,oD),rb(this,iD),rb(this,rD),Sl(this,"hot",void 0),Sl(this,"conditionCollection",void 0),Sl(this,"columnDataFactory",void 0),Sl(this,"changes",[]),Sl(this,"grouping",!1),Sl(this,"latestEditedColumnPosition",-1),Sl(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>ib(this,rD,Xme).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>ib(this,iD,qme).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>ib(this,oD,Qme).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,P(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=FV(function(c,h){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const g=new fz(r.hot,!1),p=[].concat(c,f);g.importAllConditions(p);const y=r.columnDataFactory(h);let E;g.isEmpty()?E=y:E=new gz(g,C=>r.columnDataFactory(C)).filter(),E=Ye(E,C=>C.meta.visualRow);const v=mg(E);return g.destroy(),ni(y,C=>v(C.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ke(this,(e,n)=>{this[n]=null})}}function Xme(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function qme(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Qme(){P(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}St(mz,Ur);const Zme=mz;function Jme(t){return OU({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Ff)return r;if(i.element&&!Ga(i.element))return!1;i.focus()}})}const rd="filters";function epe(t,e){let n=-1;const r=Jme(e),i=l=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(rd),r.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof to&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),t.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||r.clear()});function o(l){const u=t.getKeyboardShortcutsCtrl(),c=l.getKeyboardShortcutsCtrl();r.clear(),c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(rd),callback:()=>{l.isSubMenu()&&l.close(),u.listen(rd)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:h=>{const f=t.getNavigator();f.getCurrentPage()>-1&&(n=f.getCurrentPage()),f.clear(),h.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:h=>{const f=e[r.getCurrentPage()];f instanceof Lf&&(f.openOptions(),h.preventDefault()),f instanceof $f&&(f.activate(),h.preventDefault()),f instanceof to||h.preventDefault()}}],rd)}t.addLocalHook("afterSubmenuOpen",o),t.addLocalHook("afterOpen",o);function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen(rd)}function a(){return n}return{...r,listen:s,getLastMenuPage:a}}function is(t,e){pz(t,e),e.add(t)}function tpe(t,e,n){pz(t,e),e.set(t,n)}function pz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function id(t,e,n){return e=npe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function npe(t){var e=rpe(t,"string");return typeof e=="symbol"?e:String(e)}function rpe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ipe(t,e,n){var r=wz(t,e,"set");return ope(t,r,n),n}function ope(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function od(t,e){var n=wz(t,e,"get");return spe(t,n)}function wz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function spe(t,e){return e.get?e.get.call(t):e.value}function $i(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const tE="filters",ape=250,sD=tE;var bl=new WeakMap,aD=new WeakSet,lD=new WeakSet,uD=new WeakSet,cD=new WeakSet,ob=new WeakSet,hD=new WeakSet,sb=new WeakSet,dD=new WeakSet,fD=new WeakSet;class lpe extends ct{static get PLUGIN_KEY(){return tE}static get PLUGIN_PRIORITY(){return ape}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),is(this,fD),is(this,dD),is(this,sb),is(this,hD),is(this,ob),is(this,cD),is(this,uD),is(this,lD),is(this,aD),id(this,"dropdownMenuPlugin",null),id(this,"conditionCollection",null),id(this,"conditionUpdateObserver",null),id(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),id(this,"filtersRowsMap",null),tpe(this,bl,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(n,r)=>$i(this,dD,gpe).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[tE]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new lg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>$i(this,ob,gD).call(this,"accept")),s.addLocalHook("cancel",()=>$i(this,ob,gD).call(this,"cancel")),s.addLocalHook("change",a=>$i(this,hD,fpe).call(this,s,a)),s),i=()=>`${this.hot.getTranslatedPhrase(q_)}:`,o=()=>`${this.hot.getTranslatedPhrase(Q_)}:`;if(!this.components.get("filter_by_condition")){const s=new eE(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>$i(this,sb,mD).call(this)),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new hme(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new eE(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>$i(this,sb,mD).call(this)),this.components.set("filter_by_condition2",r(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new Ime(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Wf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new fz(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new Zme(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>$i(this,fD,mpe).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>$i(this,cD,dpe).call(this,s)),this.addHook("afterDropdownMenuShow",()=>$i(this,lD,cpe).call(this)),this.addHook("afterDropdownMenuHide",()=>$i(this,uD,hpe).call(this)),this.addHook("afterChange",s=>$i(this,aD,upe).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!od(this,bl)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=s.getNavigator(),c=od(this,bl).getLastMenuPage();s.focus(),c>0?u.setCurrentPage(c):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];ipe(this,bl,epe(s,a));const l=u=>{od(this,bl).listen(),u.preventDefault(),hh(u.keyCode,"TAB")&&(u.shiftKey?od(this,bl).toPreviousItem():od(this,bl).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:sD})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sD)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Fa;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ye(n.filter(),u=>u.meta.visualRow);const l=mg(i);Re(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),P(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return P(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:f,dateFormat:g,locale:p}=this.hot.getCellMeta(o,n),y=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:f,dateFormat:g,locale:p},value:ez(y)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=JR(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===jw&&n.command.key!==In&&r.command.key!==In&&i.command.key!==In?o=GM:i.command.key!==In&&(n.command.key===In||r.command.key===In)&&(o=Fa),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new gz(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return P(i,s=>{P(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function upe(t){t&&P(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function cpe(){this.restoreComponents(Array.from(this.components.values()))}function hpe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function dpe(t){t.items.push({name:qe}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function gD(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==In&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==In&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==In&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function fpe(t,e){this.updateDependentComponentsVisibility(),t.constructor===eE&&!e.inputsCount&&this.setListeningDropdownMenu()}function mD(){this.setListeningDropdownMenu()}function gpe(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?te(e,"htFiltersActive"):We(e,"htFiltersActive")}function mpe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(s=>s.name===Bl),o=n.filter(s=>s.name!==Bl);if(i.length>=2||o.length>=3)_t(vt`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(s,r),this.components.get("filter_by_value").updateState(t)}}const vz="internal-use-in-handsontable",nE={licenseKey:vz,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function Cz(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Jn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function yz(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function ppe(t){var e;const n=t[Jn],r=yz(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=Cz(t);return{...nE,...r,...i}}function wpe(t){var e;const n=t[Jn],r=yz(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=Cz(t);return{...r,...i}}function vpe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function DC(){const t="engine_relationship",e=lo(Jn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function jM(){const t="shared_engine_usage",e=lo(Jn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Cpe(t){const e=t.getSettings(),n=e[Jn],r=n==null?void 0:n.engine;if(n===!0||Tt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return ype((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Tt(r.hyperformula)){const o=DC(),s=jM().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:vz}),(r.getConfig().leapYear1900!==nE.leapYear1900||Qv(r.getConfig().nullDate,nE.nullDate)===!1)&&_t(vt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function ype(t,e,n){const r=e[Jn],i=ppe(e),o=DC(),s=jM();Spe(t,r.functions),bpe(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Rpe(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function pD(t){var e;const n=DC(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function wD(t,e){if(t){const n=DC(),r=n.get(t),i=jM(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Spe(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){_t(s.message)}})}function bpe(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){_t(r.message)}}}function Rpe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){_t(a.message)}}),t.resumeEvaluation())}function Epe(t,e){return(Tt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const Sz="DD/MM/YYYY";function bz(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Tpe(t){return bz(t)?t.substr(1):t}function _pe(t){return typeof t=="string"&&t.startsWith("=")}function YM(t,e){return typeof t=="string"&&e==="date"}function Rz(t,e){return J(t,e,!0).isValid()}function Ez(t,e){return J(t,e,!0).format(Sz)}function Mpe(t,e){return J(t,Sz,!0).format(e)}function Tz(t,e){const r=new Date(Date.UTC(0,0,t+-1));return J(r).format(e)}function Rl(t,e,n){xpe(t,e),e.set(t,n)}function xpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ot(t,e){var n=_z(t,e,"get");return Ppe(t,n)}function Ppe(t,e){return e.get?e.get.call(t):e.value}function ia(t,e,n){var r=_z(t,e,"set");return Ope(t,r,n),n}function _z(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ope(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var sd=new WeakMap,oa=new WeakMap,zr=new WeakMap,Vm=new WeakMap,ab=new WeakMap,lb=new WeakMap,Bm=new WeakMap;class Ape{constructor(e,n,r){Rl(this,sd,{writable:!0,value:void 0}),Rl(this,oa,{writable:!0,value:void 0}),Rl(this,zr,{writable:!0,value:void 0}),Rl(this,Vm,{writable:!0,value:[]}),Rl(this,ab,{writable:!0,value:[]}),Rl(this,lb,{writable:!0,value:void 0}),Rl(this,Bm,{writable:!0,value:[]}),ia(this,sd,e),ia(this,oa,n),ia(this,zr,r)}setRemovedHfIndexes(e){return ia(this,Bm,e.map(n=>{const r=Ot(this,oa).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Ot(this,Bm)}getRemovedHfIndexes(){return Ot(this,Bm)}getHfIndexFromVisualIndex(e){const n=Ot(this,oa).getIndexesSequence(),r=Ot(this,oa).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${nr(Ot(this,sd))}s`;Ot(this,zr).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&Ot(this,zr).getEngine()[r](Ot(this,zr).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(ia(this,ab,e.map(i=>this.getHfIndexFromVisualIndex(i))),ia(this,lb,this.getHfIndexFromVisualIndex(n)))}getMoveLine(e,n){const r=Ot(this,oa).getNumberOfIndexes(),i=Array.from(Array(r).keys()).filter(s=>e.includes(s)===!1);if(n===0){var o;return(o=i[n])!==null&&o!==void 0?o:0}return i[n-1]+1}getInitiallyCalculatedMoves(e,n){let r=this.getMoveLine(e,n);const i=[];return e.forEach(o=>{const s={from:o,to:r};i.forEach(a=>{const l=a.from>a.to,u=a.to<=s.from;a.from>s.from&&u&&l&&(s.from+=1)}),s.from>=r&&(r+=1),i.push(s)}),i}adjustedCalculatedMoves(e){return e.forEach((n,r)=>{e.slice(r+1).forEach(o=>{const s=o.from<o.to;o.from>n.from&&s&&(o.from-=1)})}),e}calculateAndSyncMoves(e,n){if(Ot(this,zr).isPerformingUndoRedo()||e===!1||n===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(Ot(this,ab),Ot(this,lb)));Ot(this,zr).getSheetId()===null?Ot(this,zr).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${nr(Ot(this,sd))}Order`;return n=>{if(Ot(this,zr).isPerformingUndoRedo())return;const r=Ot(this,oa).getIndexesSequence();if(n==="update"){const i=Ot(this,Vm).map(l=>r.indexOf(l)),o=Ot(this,zr).getEngine().getSheetDimensions(Ot(this,zr).getSheetId());let s;Ot(this,sd)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);Ot(this,zr).getEngine()[e](Ot(this,zr).getSheetId(),i)}ia(this,Vm,r)}}init(){ia(this,Vm,Ot(this,oa).getIndexesSequence())}}const vD=Ape;function El(t,e,n){Ipe(t,e),e.set(t,n)}function Ipe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function os(t,e){var n=Mz(t,e,"get");return Hpe(t,n)}function Hpe(t,e){return e.get?e.get.call(t):e.value}function Tl(t,e,n){var r=Mz(t,e,"set");return Dpe(t,r,n),n}function Mz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Dpe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Um=new WeakMap,zm=new WeakMap,ub=new WeakMap,cb=new WeakMap,hb=new WeakMap,db=new WeakMap,fb=new WeakMap;class Npe{constructor(e,n,r){El(this,Um,{writable:!0,value:void 0}),El(this,zm,{writable:!0,value:void 0}),El(this,ub,{writable:!0,value:void 0}),El(this,cb,{writable:!0,value:!1}),El(this,hb,{writable:!0,value:!1}),El(this,db,{writable:!0,value:null}),El(this,fb,{writable:!0,value:null}),Tl(this,Um,new vD("row",e,this)),Tl(this,zm,new vD("column",n,this)),Tl(this,ub,r)}getForAxis(e){return e==="row"?os(this,Um):os(this,zm)}setPerformUndo(e){Tl(this,cb,e)}setPerformRedo(e){Tl(this,hb,e)}isPerformingUndoRedo(){return os(this,cb)||os(this,hb)}getSheetId(){return os(this,fb)}getEngine(){return os(this,db)}getPostponeAction(){return os(this,ub)}setupSyncEndpoint(e,n){Tl(this,db,e),Tl(this,fb,n),os(this,Um).init(),os(this,zm).init()}}const kpe=Npe;function Lt(t,e){xz(t,e),e.add(t)}function ju(t,e,n){return e=Lpe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lpe(t){var e=$pe(t,"string");return typeof e=="symbol"?e:String(e)}function $pe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gb(t,e,n){xz(t,e),e.set(t,n)}function xz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xa(t,e,n){var r=Pz(t,e,"set");return Fpe(t,r,n),n}function Fpe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Wc(t,e){var n=Pz(t,e,"get");return Wpe(t,n)}function Pz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Wpe(t,e){return e.get?e.get.call(t):e.value}function Rt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Jn="formulas",Vpe=["maxRows","maxColumns","language"],Bpe=260;ve.getSingleton().register("afterNamedExpressionAdded");ve.getSingleton().register("afterNamedExpressionRemoved");ve.getSingleton().register("afterSheetAdded");ve.getSingleton().register("afterSheetRemoved");ve.getSingleton().register("afterSheetRenamed");ve.getSingleton().register("afterFormulasValuesUpdate");const ph=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var $s=new WeakMap,KM=new WeakMap,ad=new WeakMap,CD=new WeakSet,yD=new WeakSet,mb=new WeakSet,SD=new WeakSet,pb=new WeakSet,bD=new WeakSet,RD=new WeakSet,wb=new WeakSet,ED=new WeakSet,TD=new WeakSet,_D=new WeakSet,MD=new WeakSet,xD=new WeakSet,PD=new WeakSet,OD=new WeakSet,AD=new WeakSet,ID=new WeakSet,HD=new WeakSet,DD=new WeakSet,ND=new WeakSet,kD=new WeakSet,LD=new WeakSet,$D=new WeakSet,FD=new WeakSet;class Upe extends ct{constructor(){var e;super(...arguments),e=this,Lt(this,FD),Lt(this,$D),Lt(this,LD),Lt(this,kD),Lt(this,ND),Lt(this,DD),Lt(this,HD),Lt(this,ID),Lt(this,AD),Lt(this,OD),Lt(this,PD),Lt(this,xD),Lt(this,MD),Lt(this,_D),Lt(this,TD),Lt(this,ED),Lt(this,wb),Lt(this,RD),Lt(this,bD),Lt(this,pb),Lt(this,SD),Lt(this,mb),Lt(this,yD),Lt(this,CD),gb(this,$s,{writable:!0,value:!1}),gb(this,KM,{writable:!0,value:!1}),gb(this,ad,{writable:!0,value:[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rt(e,DD,owe).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rt(e,ND,swe).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rt(e,kD,awe).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rt(e,LD,lwe).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rt(e,$D,uwe).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rt(e,FD,cwe).call(e,...r)}]]}),ju(this,"staticRegister",lo("formulas")),ju(this,"engine",null),ju(this,"sheetName",null),ju(this,"indexSyncer",null),ju(this,"rowAxisSyncer",null),ju(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Jn}static get PLUGIN_PRIORITY(){return Bpe}static get SETTING_KEYS(){return[Jn,...Vpe]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Jn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Cpe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){_t("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,mb,WD).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,pb,VD).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,mb,WD).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,pb,VD).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,bD,Ype).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,RD,Kpe).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,CD,zpe).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,ED,Xpe).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,wb,BD).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,wb,BD).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,TD,qpe).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,_D,Qpe).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,PD,ewe).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,OD,twe).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,MD,Zpe).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,xD,Jpe).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,AD,nwe).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,ID,rwe).call(n,...i)}),this.indexSyncer=new kpe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,SD,jpe).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,HD,iwe).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rt(n,yD,Gpe).call(n,...i)}),Wc(this,ad).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){Wc(this,ad).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),wD(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=wpe(this.hot.getSettings());vpe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Jn];if(fe(r)&&fe(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Jn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Wc(this,ad).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Xa(this,ad,null),wD(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(fe(n)&&!j2(n))return _t("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return _t("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return _t(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){s1(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${nr(Jn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),pD(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return fe(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(fe(l)===!1||fe(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const f=pD(this.engine).get(c);if(!f)return;f.validateCell(f.getDataAtCell(l,u),f.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){_t(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return YM(r,o.type)&&(Rz(r,o.dateFormat)?r=Ez(r,o.dateFormat):_pe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function zpe(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&vr(s)&&(s=Tz(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Gpe(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(f)===!1)return!1;const g=this.engine.getFillRangeData(h,f),{row:p,col:y}=h.start,{row:E,col:v}=h.end,C=E-p+1,S=v-y+1;for(let T=0;T<g.length;T+=1)for(let _=0;_<g[T].length;_+=1){const A=g[T][_],D=T%C,U=_%S,z=this.hot.getCellMeta(D,U);YM(A,z.type)&&(A.startsWith("'")?g[T][_]=A.slice(1):this.isFormulaCellType(D,U,this.sheetId)===!1&&(g[T][_]=Mpe(A,z.dateFormat)))}return g}function WD(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(nr(Jn))||Xa(this,KM,Tt(this.hot.getSettings().data))}function jpe(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o),a=s.dateFormat;YM(i,s.type)&&(e=!0,Rz(i,a)?t[r][o]=Ez(i,a):this.isFormulaCellType(r,o)===!1&&(t[r][o]=`'${i}`))})}),e===!0&&(Xa(this,$s,!0),this.engine.setSheetContent(this.sheetId,t),Xa(this,$s,!1))}function VD(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(nr(Jn)))if(this.sheetName=Epe(this.engine,this.hot.getSettings()[Jn].sheetName),Wc(this,KM))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){Xa(this,$s,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),Xa(this,$s,!1)}}}function Ype(t,e,n,r){if(r!=="get"||Wc(this,$s)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){bz(n.value)&&(n.value=Tpe(n.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e);l.type==="date"&&vr(a)&&(a=Tz(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function Kpe(t,e,n,r){if(r!=="get"||Wc(this,$s)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null||!this.isFormulaCellType(i,o)&&this.getCellType(i,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function BD(t,e){if(ph(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),f={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:f})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Xpe(t,e){if(ph(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!vr(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){_t(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function qpe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Qpe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Zpe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Jpe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function ewe(t,e,n){if(ph(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function twe(t,e,n){if(ph(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function nwe(t,e,n,r){if(ph(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function rwe(t,e,n,r){if(ph(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function iwe(t,e,n){var r;Xa(this,$s,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Xa(this,$s,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function owe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function swe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function awe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function lwe(t){this.hot.runHooks("afterSheetAdded",t)}function uwe(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}function cwe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function hwe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(M_,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function dwe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(x_,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ye(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,f=l-a+1;if(h>f){const g=u.slice(i,o+1);c.push(...g.filter(p=>n.includes(p)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===f&&h>o&&c.push(...u.slice(o+1))}return P(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function Yu(t,e){Oz(t,e),e.add(t)}function UD(t,e,n){Oz(t,e),e.set(t,n)}function Oz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ku(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function qr(t,e){var n=Az(t,e,"get");return fwe(t,n)}function fwe(t,e){return e.get?e.get.call(t):e.value}function ld(t,e,n){var r=Az(t,e,"set");return gwe(t,r,n),n}function Az(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gwe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}ve.getSingleton().register("beforeHideColumns");ve.getSingleton().register("afterHideColumns");ve.getSingleton().register("beforeUnhideColumns");ve.getSingleton().register("afterUnhideColumns");const vb="hiddenColumns",mwe=310;var ko=new WeakMap,So=new WeakMap,zD=new WeakSet,GD=new WeakSet,jD=new WeakSet,YD=new WeakSet,KD=new WeakSet,XD=new WeakSet;class pwe extends ct{constructor(){super(...arguments),Yu(this,XD),Yu(this,KD),Yu(this,YD),Yu(this,jD),Yu(this,GD),Yu(this,zD),UD(this,ko,{writable:!0,value:{}}),UD(this,So,{writable:!0,value:null})}static get PLUGIN_KEY(){return vb}static get PLUGIN_PRIORITY(){return mwe}isEnabled(){return!!this.hot.getSettings()[vb]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[vb];je(n)&&(ld(this,ko,n),Tt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),ld(this,So,new iC),qr(this,So).addLocalHook("init",()=>Ku(this,XD,bwe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,qr(this,So)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ku(e,KD,Swe).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>Ku(this,GD,vwe).call(this,r,i,o)),this.addHook("modifyColWidth",(r,i)=>Ku(this,zD,wwe).call(this,r,i)),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ku(e,YD,ywe).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Ku(this,jD,Cwe).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),ld(this,ko,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=qr(this,So).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));P(l,u=>{o[u]=!1}),i=sn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&qr(this,So).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,s=>{qr(this,So).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ye(qr(this,So).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return qr(this,So).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){P(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){ld(this,ko,null),ld(this,So,null),super.destroy()}}function wwe(t,e){if(this.isHidden(e))return 0;if(qr(this,ko).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function vwe(t,e,n){if(qr(this,ko).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Cwe(t){if(qr(this,ko).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return P(t,r=>{let i=!0,o=0;Re(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function ywe(t,e){if(!qr(this,ko).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),te(e,n)}function Swe(t){t.items.push({name:qe},hwe(this),dwe(this))}function bwe(){Array.isArray(qr(this,ko).columns)&&this.hideColumns(qr(this,ko).columns)}function Rwe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(P_,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Ewe(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(O_,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ye(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,f=l-a+1;if(h>f){const g=u.slice(i,o+1);c.push(...g.filter(p=>n.includes(p)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===f&&h>o&&c.push(...u.slice(o+1))}return P(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Xu(t,e){Iz(t,e),e.add(t)}function qD(t,e,n){Iz(t,e),e.set(t,n)}function Iz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qu(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function pi(t,e){var n=Hz(t,e,"get");return Twe(t,n)}function Twe(t,e){return e.get?e.get.call(t):e.value}function ud(t,e,n){var r=Hz(t,e,"set");return _we(t,r,n),n}function Hz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function _we(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}ve.getSingleton().register("beforeHideRows");ve.getSingleton().register("afterHideRows");ve.getSingleton().register("beforeUnhideRows");ve.getSingleton().register("afterUnhideRows");const Cb="hiddenRows",Mwe=320;var _s=new WeakMap,bo=new WeakMap,QD=new WeakSet,ZD=new WeakSet,JD=new WeakSet,eN=new WeakSet,tN=new WeakSet,nN=new WeakSet;class xwe extends ct{constructor(){super(...arguments),Xu(this,nN),Xu(this,tN),Xu(this,eN),Xu(this,JD),Xu(this,ZD),Xu(this,QD),qD(this,_s,{writable:!0,value:{}}),qD(this,bo,{writable:!0,value:null})}static get PLUGIN_KEY(){return Cb}static get PLUGIN_PRIORITY(){return Mwe}isEnabled(){return!!this.hot.getSettings()[Cb]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Cb];je(n)&&(ud(this,_s,n),Tt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),ud(this,bo,new iC),pi(this,bo).addLocalHook("init",()=>qu(this,nN,Dwe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,pi(this,bo)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qu(e,tN,Hwe).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>qu(this,ZD,Owe).call(this,r,i,o)),this.addHook("modifyRowHeight",(r,i)=>qu(this,QD,Pwe).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qu(e,eN,Iwe).call(e,...i)}),this.addHook("modifyCopyableRange",r=>qu(this,JD,Awe).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),ud(this,_s,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=pi(this,bo).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));P(l,u=>{o[u]=!1}),i=sn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&pi(this,bo).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,s=>{pi(this,bo).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ye(pi(this,bo).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return pi(this,bo).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){P(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){ud(this,_s,null),ud(this,bo,null),super.destroy()}}function Pwe(t,e){return this.isHidden(e)?0:t}function Owe(t,e,n){if(pi(this,_s).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Awe(t){if(pi(this,_s).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return P(t,r=>{let i=!0,o=0;Re(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function Iwe(t,e){if(!pi(this,_s).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),te(e,n)}function Hwe(t){t.items.push({name:qe},Rwe(this),Ewe(this))}function Dwe(){Array.isArray(pi(this,_s).rows)&&this.hideRows(pi(this,_s).rows)}function Nwe(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(r_)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function kwe(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(i_)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function rN(t,e){Dz(t,e),e.add(t)}function Lwe(t,e,n){Dz(t,e),e.set(t,n)}function Dz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rE(t,e){var n=Nz(t,e,"get");return $we(t,n)}function $we(t,e){return e.get?e.get.call(t):e.value}function yb(t,e,n){var r=Nz(t,e,"set");return Fwe(t,r,n),n}function Nz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Fwe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function iN(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ve.getSingleton().register("beforeColumnFreeze");ve.getSingleton().register("afterColumnFreeze");ve.getSingleton().register("beforeColumnUnfreeze");ve.getSingleton().register("afterColumnUnfreeze");const oN="manualColumnFreeze",Wwe=110;var Dl=new WeakMap,sN=new WeakSet,aN=new WeakSet;class Vwe extends ct{constructor(){super(...arguments),rN(this,aN),rN(this,sN),Lwe(this,Dl,{writable:!0,value:!1})}static get PLUGIN_KEY(){return oN}static get PLUGIN_PRIORITY(){return Wwe}isEnabled(){return!!this.hot.getSettings()[oN]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>iN(this,sN,Bwe).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>iN(this,aN,Uwe).call(this,e,n)),super.enablePlugin())}disablePlugin(){yb(this,Dl,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;rE(this,Dl)||yb(this,Dl,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;rE(this,Dl)||yb(this,Dl,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Bwe(t){t.items.push({name:"---------"},Nwe(this),kwe(this))}function Uwe(t,e){if(rE(this,Dl)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Gm(t,e,n){return e=zwe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zwe(t){var e=Gwe(t,"string");return typeof e=="symbol"?e:String(e)}function Gwe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Sb=0,lN=1,uN=2,Qu="px";let jwe=class{constructor(e){Gm(this,"hot",void 0),Gm(this,"_element",null),Gm(this,"state",Sb),Gm(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=uN}build(){this.state===Sb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=lN)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Sb}isAppended(){return this.state===uN}isBuilt(){return this.state>=lN}setPosition(e,n){vr(e)&&(this._element.style.top=e+Qu),vr(n)&&(this._element.style[this.inlineProperty]=n+Qu)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){vr(e)&&(this._element.style.width=e+Qu),vr(n)&&(this._element.style.height=n+Qu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){vr(e)&&(this._element.style.marginTop=e+Qu),vr(n)&&(this._element.style[`margin${nr(this.inlineProperty)}`]=n+Qu)}getOffset(){const e=this._element.style,n=`margin${nr(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const kz=jwe,Ywe="ht__manualColumnMove--backlight";let Kwe=class extends kz{build(){super.build(),te(this._element,Ywe)}};const Xwe=Kwe,qwe="ht__manualColumnMove--guideline";let Qwe=class extends kz{build(){super.build(),te(this._element,qwe)}};const Zwe=Qwe;function Zu(t,e){Lz(t,e),e.add(t)}function Fi(t,e,n){Lz(t,e),e.set(t,n)}function Lz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nr(t,e,n){var r=$z(t,e,"set");return Jwe(t,r,n),n}function Jwe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Se(t,e){var n=$z(t,e,"get");return eve(t,n)}function $z(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function eve(t,e){return e.get?e.get.call(t):e.value}function Ju(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ve.getSingleton().register("beforeColumnMove");ve.getSingleton().register("afterColumnMove");const bb="manualColumnMove",tve=120,cN="ht__manualColumnMove",Kw="show-ui",iE="on-moving--columns",oE="after-selection--columns";var pr=new WeakMap,wa=new WeakMap,Ms=new WeakMap,$p=new WeakMap,Ta=new WeakMap,mr=new WeakMap,jm=new WeakMap,fi=new WeakMap,hc=new WeakMap,Xw=new WeakMap,jd=new WeakMap,hN=new WeakSet,dN=new WeakSet,fN=new WeakSet,gN=new WeakSet,mN=new WeakSet,pN=new WeakSet;class nve extends ct{constructor(){super(...arguments),Zu(this,pN),Zu(this,mN),Zu(this,gN),Zu(this,fN),Zu(this,dN),Zu(this,hN),Fi(this,pr,{writable:!0,value:new Xwe(this.hot)}),Fi(this,wa,{writable:!0,value:new Zwe(this.hot)}),Fi(this,Ms,{writable:!0,value:[]}),Fi(this,$p,{writable:!0,value:0}),Fi(this,Ta,{writable:!0,value:!1}),Fi(this,mr,{writable:!0,value:{}}),Fi(this,jm,{writable:!0,value:void 0}),Fi(this,fi,{writable:!0,value:void 0}),Fi(this,hc,{writable:!0,value:void 0}),Fi(this,Xw,{writable:!0,value:void 0}),Fi(this,jd,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return bb}static get PLUGIN_PRIORITY(){return tve}isEnabled(){return!!this.hot.getSettings()[bb]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ju(e,hN,rve).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ju(e,fN,ove).call(e,...r)}),this.addHook("afterScrollVertically",()=>Ju(this,mN,ave).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ju(e,pN,lve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,cN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){We(this.hot.rootElement,cN),this.unregisterEvents(),Se(this,pr).destroy(),Se(this,wa).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=Se(this,jm),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Nr(this,jm,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Nr(this,jm,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=sn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[bb];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return Re(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Se(this,fi))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Se(this,fi)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=Se(this,pr).getOffset().start,u=Se(this,pr).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const p=this.hot.rootWindow,y=wt(this.hot.rootElement),E=p.innerWidth-Se(this,hc)-y;h=p.innerWidth-Se(this,mr).eventPageX-E-(r.scrollX===void 0?i:0)}else h=Se(this,mr).eventPageX-(Se(this,hc)-(r.scrollX===void 0?i:0));if(Se(this,Xw)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Se(this,fi))&&(o+=i),o+=c,Se(this,fi)<0)Se(this,jd)>0?Se(this,mr).col=0:Se(this,mr).col=e>0?e-1:e;else if(Se(this,mr).TD.offsetWidth/2+o<=h){const p=Se(this,fi)>=Se(this,$p)?Se(this,$p)-1:Se(this,fi);Se(this,mr).col=p+1,o+=Se(this,mr).TD.offsetWidth}else Se(this,mr).col=Se(this,fi);let f=h,g=o;h+u+l>=s?f=s-u-l:h+l<a+c&&(f=a+c+Math.abs(l)),o>=s-1?g=s-1:g===0?g=1:r.scrollX!==void 0&&Se(this,fi)<Se(this,jd)&&(g-=Se(this,hc)<=r.scrollX?Se(this,hc):0),Se(this,pr).setPosition(null,f),Se(this,wa).setPosition(null,g)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ju(this,dN,ive).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ju(this,gN,sve).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Se(this,pr).build(),Se(this,wa).build()}destroy(){Se(this,pr).destroy(),Se(this,wa).destroy(),super.destroy()}}function rve(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=$e(t.target,"sortAction");if(!s||!o||Se(this,Ta)||t.button!==0||a){Nr(this,Ta,!1),Se(this,Ms).length=0,We(this.hot.rootElement,[iE,Kw]);return}const l=Se(this,wa).isBuilt()&&!Se(this,wa).isAppended(),u=Se(this,pr).isBuilt()&&!Se(this,pr).isAppended();l&&u&&(Se(this,wa).appendTo(i.hider),Se(this,pr).appendTo(i.hider));const{from:c,to:h}=s,f=Math.min(c.col,h.col),g=Math.max(c.col,h.col);if(e.row<0&&e.col>=f&&e.col<=g){r.column=!0,Nr(this,Ta,!0);const p=n.firstChild?ZV(t,n.firstChild).x:t.offsetX;Se(this,mr).eventPageX=t.pageX,Nr(this,fi,e.col),Se(this,mr).TD=n,Se(this,mr).col=e.col,Nr(this,Ms,this.prepareColumnsToMoving(f,g)),Nr(this,Xw,!!this.hot.getSettings().rowHeaders),Nr(this,$p,this.hot.countCols()),Nr(this,jd,this.hot.getSettings().fixedColumnsStart),Nr(this,hc,cn(this.hot.rootElement).left);const y=Se(this,Xw)?-1:0,E=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,v=e.col<Se(this,jd),C=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),S=Math.abs(p-(this.hot.isRtl()?n.offsetWidth:0)),T=this.getColumnsWidth(f,e.col-1)+S,_=this.getColumnsWidth(y,f-1)+(v?C:0)+T;Se(this,pr).setPosition(E,_),Se(this,pr).setSize(this.getColumnsWidth(f,g),i.hider.offsetHeight-E),Se(this,pr).setOffset(null,-T),te(this.hot.rootElement,iE)}else We(this.hot.rootElement,oE),Nr(this,Ta,!1),Se(this,Ms).length=0}function ive(t){Se(this,Ta)&&(Se(this,mr).eventPageX=t.pageX,this.refreshPositions())}function ove(t,e,n,r){!this.hot.getSelectedRangeLast()||!Se(this,Ta)||(Se(this,Ms).indexOf(e.col)>-1?We(this.hot.rootElement,Kw):te(this.hot.rootElement,Kw),r.row=!0,r.column=!0,r.cell=!0,Nr(this,fi,e.col),Se(this,mr).TD=n)}function sve(){const t=Se(this,mr).col,e=Se(this,Ms).length;if(Nr(this,fi,void 0),Nr(this,Ta,!1),We(this.hot.rootElement,[iE,Kw,oE]),this.hot.selection.isSelectedByColumnHeader()&&te(this.hot.rootElement,oE),e<1||t===void 0)return;const n=Se(this,Ms)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(Se(this,Ms),t);if(Se(this,Ms).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function ave(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;Se(this,pr).setPosition(r),Se(this,pr).setSize(null,t.hider.offsetHeight-r)}function lve(){this.moveBySettingsOrLoad()}function ss(t,e){Fz(t,e),e.add(t)}function Yn(t,e,n){Fz(t,e),e.set(t,n)}function Fz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function as(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function rn(t,e,n){var r=Wz(t,e,"set");return uve(t,r,n),n}function uve(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ce(t,e){var n=Wz(t,e,"get");return cve(t,n)}function Wz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function cve(t,e){return e.get?e.get.call(t):e.value}const qw="manualColumnResize",hve=130,wN="manualColumnWidths";var ms=new WeakMap,Ym=new WeakMap,jr=new WeakMap,Qw=new WeakMap,Do=new WeakMap,dve=new WeakMap,Vc=new WeakMap,Km=new WeakMap,Ar=new WeakMap,cs=new WeakMap,ru=new WeakMap,Zw=new WeakMap,Yd=new WeakMap,Kd=new WeakMap,Xr=new WeakMap,Xd=new WeakMap,vN=new WeakSet,CN=new WeakSet,yN=new WeakSet,SN=new WeakSet,bN=new WeakSet,RN=new WeakSet,EN=new WeakSet,TN=new WeakSet,_N=new WeakSet;class fve extends ct{static get PLUGIN_KEY(){return qw}static get PLUGIN_PRIORITY(){return hve}constructor(e){super(e),ss(this,_N),ss(this,TN),ss(this,EN),ss(this,RN),ss(this,bN),ss(this,SN),ss(this,yN),ss(this,CN),ss(this,vN),Yn(this,ms,{writable:!0,value:null}),Yn(this,Ym,{writable:!0,value:null}),Yn(this,jr,{writable:!0,value:[]}),Yn(this,Qw,{writable:!0,value:null}),Yn(this,Do,{writable:!0,value:null}),Yn(this,dve,{writable:!0,value:null}),Yn(this,Vc,{writable:!0,value:null}),Yn(this,Km,{writable:!0,value:null}),Yn(this,Ar,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Yn(this,cs,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Yn(this,ru,{writable:!0,value:null}),Yn(this,Zw,{writable:!0,value:!1}),Yn(this,Yd,{writable:!0,value:0}),Yn(this,Kd,{writable:!0,value:null}),Yn(this,Xr,{writable:!0,value:void 0}),Yn(this,Xd,{writable:!0,value:void 0}),te(ce(this,Ar),"manualColumnResizer"),te(ce(this,cs),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[qw]}enablePlugin(){this.enabled||(rn(this,Xr,new Ja),ce(this,Xr).addLocalHook("init",()=>as(this,vN,gve).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ce(this,Xr)),this.addHook("modifyColWidth",(e,n)=>as(this,EN,yve).call(this,e,n)),this.addHook("beforeStretchingColumnWidth",(e,n)=>as(this,TN,Sve).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,r)=>as(this,_N,bve).call(this,e,n,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){rn(this,Xd,ce(this,Xr).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",wN,ce(this,Xr).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",wN,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return ce(this,Xr).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);ce(this,Xr).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;rn(this,ms,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(ce(this,ms)),i=r.col;if(i<0)return;const o=Bt(ce(this,ms)),s=ce(this,ms).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ce(this,ms),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(ce(this,ms),r.row,r.col)),rn(this,Ym,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),rn(this,jr,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();P(c,h=>{const f=h.getTopStartCorner().col,g=h.getBottomEndCorner().col;Re(f,g,p=>{ce(this,jr).includes(p)||ce(this,jr).push(p)})})}ce(this,jr).includes(ce(this,Ym))||rn(this,jr,[ce(this,Ym)]),rn(this,Km,l.start-6),rn(this,Vc,parseInt(s.width,10)),ce(this,Ar).style.top=`${l.top}px`,ce(this,Ar).style[this.inlineDir]=`${ce(this,Km)+ce(this,Vc)}px`,ce(this,Ar).style.height=`${o}px`,this.hot.rootElement.appendChild(ce(this,Ar))}refreshHandlePosition(){ce(this,Ar).style[this.inlineDir]=`${ce(this,Km)+ce(this,Qw)}px`}setupGuidePosition(){const e=parseInt(Bt(ce(this,Ar)),10),n=parseInt(ce(this,Ar).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);te(ce(this,Ar),"active"),te(ce(this,cs),"active"),ce(this,cs).style.top=`${n}px`,this.refreshGuidePosition(),ce(this,cs).style.height=`${r-e}px`,this.hot.rootElement.appendChild(ce(this,cs))}refreshGuidePosition(){ce(this,cs).style[this.inlineDir]=ce(this,Ar).style[this.inlineDir]}hideHandleAndGuide(){We(ce(this,Ar),"active"),We(ce(this,cs),"active")}checkIfColumnHeader(e){return!!Ua(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",ce(this,Do),r,!0);o!==void 0&&rn(this,Do,o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,ce(this,Do)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ce(this,Do),r,!0),i&&e()};ce(this,Yd)>=2&&(ce(this,jr).length>1?(P(ce(this,jr),i=>{n(i)}),e()):P(ce(this,jr),i=>{n(i,!0)})),rn(this,Yd,0),rn(this,Kd,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>as(this,CN,mve).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>as(this,yN,pve).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>as(this,SN,wve).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>as(this,bN,vve).call(this)),this.eventManager.addEventListener(ce(this,Ar),"contextmenu",()=>as(this,RN,Cve).call(this))}destroy(){super.destroy()}}function gve(){const t=this.hot.getSettings()[qw],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{ce(this,Xr).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{ce(this,Xr).setValueAtIndex(r,n)})},!0),rn(this,Xd,t)):t===!0&&Array.isArray(ce(this,Xd))&&this.hot.batchExecution(()=>{ce(this,Xd).forEach((n,r)=>{ce(this,Xr).setValueAtIndex(r,n)})},!0)}function mve(t){if(!QT(t.target)&&ce(this,Zw)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(ce(this,ru)||this.setupHandlePosition(e))}}function pve(t){$e(t.target,"manualColumnResizer")&&(this.setupHandlePosition(ce(this,ms)),this.setupGuidePosition(),rn(this,ru,!0),ce(this,Kd)===null&&(rn(this,Kd,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ce(this,Kd))),rn(this,Yd,ce(this,Yd)+1),this.startX=t.pageX,rn(this,Do,ce(this,Vc)))}function wve(t){if(ce(this,ru)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();rn(this,Qw,ce(this,Vc)+e),P(ce(this,jr),n=>{rn(this,Do,this.setManualSize(n,ce(this,Qw)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function vve(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",ce(this,Do),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ce(this,Do),n,!1)};ce(this,ru)&&(this.hideHandleAndGuide(),rn(this,ru,!1),ce(this,Do)!==ce(this,Vc)&&(ce(this,jr).length>1?(P(ce(this,jr),r=>{e(r)}),t()):P(ce(this,jr),r=>{e(r,!0)})),this.setupHandlePosition(ce(this,ms)))}function Cve(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ce(this,Ar)),this.hot.rootElement.removeChild(ce(this,cs)),rn(this,ru,!1),rn(this,Zw,!0),this.hot._registerImmediate(()=>{rn(this,Zw,!1)})}function yve(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=ce(this,Xr).getValueAtIndex(r);this.hot.getSettings()[qw]&&i&&(n=i)}return n}function Sve(t,e){let n=ce(this,Xr).getValueAtIndex(e);return n===null&&(n=t),n}function bve(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function Rb(t,e,n){return e=Rve(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rve(t){var e=Eve(t,"string");return typeof e=="symbol"?e:String(e)}function Eve(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Eb=0,MN=1,xN=2,ec="px";let Tve=class{constructor(e){Rb(this,"hot",void 0),Rb(this,"_element",null),Rb(this,"state",Eb),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=xN}build(){this.state===Eb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=MN)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Eb}isAppended(){return this.state===xN}isBuilt(){return this.state>=MN}setPosition(e,n){e!==void 0&&(this._element.style.top=e+ec),n!==void 0&&(this._element.style.left=n+ec)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+ec),n&&(this._element.style.height=n+ec)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+ec),n&&(this._element.style.marginLeft=n+ec)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Vz=Tve,_ve="ht__manualRowMove--backlight";class Mve extends Vz{build(){super.build(),te(this._element,_ve)}}const xve=Mve,Pve="ht__manualRowMove--guideline";class Ove extends Vz{build(){super.build(),te(this._element,Pve)}}const Ave=Ove;function tc(t,e){Bz(t,e),e.add(t)}function nc(t,e,n){Bz(t,e),e.set(t,n)}function Bz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ul(t,e,n){var r=Uz(t,e,"set");return Ive(t,r,n),n}function Ive(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ue(t,e){var n=Uz(t,e,"get");return Hve(t,n)}function Uz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Hve(t,e){return e.get?e.get.call(t):e.value}function rc(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ve.getSingleton().register("beforeRowMove");ve.getSingleton().register("afterRowMove");const Tb="manualRowMove",Dve=140,PN="ht__manualRowMove",Jw="show-ui",sE="on-moving--rows",aE="after-selection--rows";var wr=new WeakMap,va=new WeakMap,xs=new WeakMap,_a=new WeakMap,kr=new WeakMap,Xm=new WeakMap,ON=new WeakSet,AN=new WeakSet,IN=new WeakSet,HN=new WeakSet,DN=new WeakSet,NN=new WeakSet;class Nve extends ct{constructor(){super(...arguments),tc(this,NN),tc(this,DN),tc(this,HN),tc(this,IN),tc(this,AN),tc(this,ON),nc(this,wr,{writable:!0,value:new xve(this.hot)}),nc(this,va,{writable:!0,value:new Ave(this.hot)}),nc(this,xs,{writable:!0,value:[]}),nc(this,_a,{writable:!0,value:void 0}),nc(this,kr,{writable:!0,value:{}}),nc(this,Xm,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return Tb}static get PLUGIN_PRIORITY(){return Dve}isEnabled(){return!!this.hot.getSettings()[Tb]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rc(e,ON,kve).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rc(e,IN,$ve).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>rc(this,DN,Wve).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return rc(e,NN,Vve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,PN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){We(this.hot.rootElement,PN),this.unregisterEvents(),Ue(this,wr).destroy(),Ue(this,va).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Ue(this,Xm),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(Ul(this,Xm,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return Ul(this,Xm,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=sn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Tb];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return Re(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Ue(this,kr).coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Ue(this,kr).TD,a=this.hot.rootElement,l=cn(a),u=Jl(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,f=l.top-h,g=Ue(this,kr).eventPageY-f+c,p=o.hider.offsetHeight,y=o.TBODY.offsetTop,E=Ue(this,wr).getOffset().top,v=Ue(this,wr).getSize().height,C=s.offsetHeight/2,S=s.offsetHeight;let T=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const _=g>=T+C;this.isFixedRowTop(e.row)&&(T+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Ue(this,kr).row=n>0?n-1:n:_?(Ue(this,kr).row=e.row+1,T+=e.row===0?S-1:S):Ue(this,kr).row=e.row;let A=g,D=T;g+v+E>=p?A=p-v-E:g+E<y&&(A=y+Math.abs(E)),T>=p-1&&(D=p-1),Ue(this,wr).setPosition(A),Ue(this,va).setPosition(D)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>rc(this,AN,Lve).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>rc(this,HN,Fve).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Ue(this,wr).build(),Ue(this,va).build()}destroy(){Ue(this,wr).destroy(),Ue(this,va).destroy(),super.destroy()}}function kve(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Ue(this,_a)||t.button!==0){Ul(this,_a,!1),Ue(this,xs).length=0,We(this.hot.rootElement,[sE,Jw]);return}const l=Ue(this,va).isBuilt()&&!Ue(this,va).isAppended(),u=Ue(this,wr).isBuilt()&&!Ue(this,wr).isAppended();l&&u&&(Ue(this,va).appendTo(i.hider),Ue(this,wr).appendTo(i.hider));const{from:c,to:h}=a,f=Math.min(c.row,h.row),g=Math.max(c.row,h.row);if(e.col<0&&e.row>=f&&e.row<=g){r.row=!0,Ul(this,_a,!0),Ue(this,kr).eventPageY=t.pageY,Ue(this,kr).coords=e,Ue(this,kr).TD=n,Ul(this,xs,this.prepareRowsToMoving());const p=i.holder.scrollLeft+o.getRowHeaderWidth(),y=this.getRowsHeight(f,e.row-1)+t.offsetY;Ue(this,wr).setPosition(null,p),Ue(this,wr).setSize(i.hider.offsetWidth-p,this.getRowsHeight(f,g)),Ue(this,wr).setOffset(-y,null),te(this.hot.rootElement,sE),this.refreshPositions()}else We(this.hot.rootElement,aE),Ul(this,_a,!1),Ue(this,xs).length=0}function Lve(t){Ue(this,_a)&&(Ue(this,kr).eventPageY=t.pageY,this.refreshPositions())}function $ve(t,e,n,r){!this.hot.getSelectedRangeLast()||!Ue(this,_a)||(Ue(this,xs).indexOf(e.row)>-1?We(this.hot.rootElement,Jw):te(this.hot.rootElement,Jw),r.row=!0,r.column=!0,r.cell=!0,Ue(this,kr).coords=e,Ue(this,kr).TD=n)}function Fve(){const t=Ue(this,kr).row,e=Ue(this,xs).length;if(Ul(this,_a,!1),We(this.hot.rootElement,[sE,Jw,aE]),this.hot.selection.isSelectedByRowHeader()&&te(this.hot.rootElement,aE),e<1||t===void 0)return;const n=Ue(this,xs)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Ue(this,xs),t);if(Ue(this,xs).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function Wve(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Ue(this,wr).setPosition(null,r),Ue(this,wr).setSize(t.hider.offsetWidth-r)}function Vve(){this.moveBySettingsOrLoad()}function _l(t,e){zz(t,e),e.add(t)}function Kn(t,e,n){zz(t,e),e.set(t,n)}function zz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ml(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Yt(t,e,n){var r=Gz(t,e,"set");return Bve(t,r,n),n}function Bve(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ue(t,e){var n=Gz(t,e,"get");return Uve(t,n)}function Gz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Uve(t,e){return e.get?e.get.call(t):e.value}const ev="manualRowResize",zve=30,kN="manualRowHeights";var xo=new WeakMap,qm=new WeakMap,Yr=new WeakMap,tv=new WeakMap,Ca=new WeakMap,XM=new WeakMap,Bc=new WeakMap,Qm=new WeakMap,dr=new WeakMap,Eo=new WeakMap,iu=new WeakMap,nv=new WeakMap,qd=new WeakMap,Qd=new WeakMap,Yi=new WeakMap,Zd=new WeakMap,LN=new WeakSet,$N=new WeakSet,FN=new WeakSet,WN=new WeakSet,VN=new WeakSet,BN=new WeakSet,UN=new WeakSet;class Gve extends ct{static get PLUGIN_KEY(){return ev}static get PLUGIN_PRIORITY(){return zve}constructor(e){super(e),_l(this,UN),_l(this,BN),_l(this,VN),_l(this,WN),_l(this,FN),_l(this,$N),_l(this,LN),Kn(this,xo,{writable:!0,value:null}),Kn(this,qm,{writable:!0,value:null}),Kn(this,Yr,{writable:!0,value:[]}),Kn(this,tv,{writable:!0,value:null}),Kn(this,Ca,{writable:!0,value:null}),Kn(this,XM,{writable:!0,value:null}),Kn(this,Bc,{writable:!0,value:null}),Kn(this,Qm,{writable:!0,value:null}),Kn(this,dr,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Kn(this,Eo,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Kn(this,iu,{writable:!0,value:!1}),Kn(this,nv,{writable:!0,value:!1}),Kn(this,qd,{writable:!0,value:0}),Kn(this,Qd,{writable:!0,value:null}),Kn(this,Yi,{writable:!0,value:void 0}),Kn(this,Zd,{writable:!0,value:void 0}),te(ue(this,dr),"manualRowResizer"),te(ue(this,Eo),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[ev]}enablePlugin(){this.enabled||(Yt(this,Yi,new Ja),ue(this,Yi).addLocalHook("init",()=>Ml(this,UN,Zve).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ue(this,Yi)),this.addHook("modifyRowHeight",(e,n)=>Ml(this,BN,Qve).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Yt(this,Zd,ue(this,Yi).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",kN,ue(this,Yi).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",kN,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,v2.DEFAULT_HEIGHT);return ue(this,Yi).setValueAtIndex(r,i),i}setupHandlePosition(e){Yt(this,xo,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(ue(this,xo)),o=i.row;if(o<0)return;const s=wt(ue(this,xo)),a=ue(this,xo).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ue(this,xo),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ue(this,xo),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ue(this,xo),i.row,i.col)),Yt(this,qm,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Yt(this,Yr,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const f=this.hot.getSelectedRange();P(f,g=>{const p=g.getTopStartCorner().row,y=g.getBottomStartCorner().row;Re(p,y,E=>{ue(this,Yr).includes(E)||ue(this,Yr).push(E)})})}ue(this,Yr).includes(ue(this,qm))||Yt(this,Yr,[ue(this,qm)]),Yt(this,Qm,c.top-6),Yt(this,Bc,parseInt(a.height,10)),ue(this,dr).style.top=`${ue(this,Qm)+ue(this,Bc)}px`,ue(this,dr).style[this.inlineDir]=`${c.start}px`,ue(this,dr).style.width=`${s}px`,this.hot.rootElement.appendChild(ue(this,dr))}refreshHandlePosition(){ue(this,dr).style.top=`${ue(this,Qm)+ue(this,tv)}px`}setupGuidePosition(){const e=parseInt(wt(ue(this,dr)),10),n=parseInt(ue(this,dr).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);te(ue(this,dr),"active"),te(ue(this,Eo),"active"),ue(this,Eo).style.top=ue(this,dr).style.top,ue(this,Eo).style[this.inlineDir]=`${n}px`,ue(this,Eo).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ue(this,Eo))}refreshGuidePosition(){ue(this,Eo).style.top=ue(this,dr).style.top}hideHandleAndGuide(){We(ue(this,dr),"active"),We(ue(this,Eo),"active")}checkIfRowHeader(e){var n;return Ua(e,["TH"],this.hot.rootElement)&&((n=e.parentNode)===null||n===void 0||(n=n.parentNode)===null||n===void 0?void 0:n.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ue(this,Ca)<n?n:ue(this,Ca)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Yt(this,Ca,o),this.setManualSize(r,ue(this,Ca)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ue(this,qd)>=2&&(ue(this,Yr).length>1?(P(ue(this,Yr),i=>{n(i)}),e()):P(ue(this,Yr),i=>{n(i,!0)})),Yt(this,qd,0),Yt(this,Qd,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Ml(this,LN,jve).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Ml(this,$N,Yve).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Ml(this,FN,Kve).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Ml(this,WN,Xve).call(this)),this.eventManager.addEventListener(ue(this,dr),"contextmenu",()=>Ml(this,VN,qve).call(this))}destroy(){super.destroy()}}function jve(t){if(!QT(t.target)&&ue(this,nv)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ue(this,iu)||this.setupHandlePosition(e))}}function Yve(t){$e(t.target,"manualRowResizer")&&(this.setupHandlePosition(ue(this,xo)),this.setupGuidePosition(),Yt(this,iu,!0),ue(this,Qd)===null&&(Yt(this,Qd,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ue(this,Qd))),Yt(this,qd,ue(this,qd)+1),Yt(this,XM,t.pageY),Yt(this,Ca,ue(this,Bc)))}function Kve(t){ue(this,iu)&&(Yt(this,tv,ue(this,Bc)+(t.pageY-ue(this,XM))),P(ue(this,Yr),e=>{Yt(this,Ca,this.setManualSize(e,ue(this,tv)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Xve(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ue(this,iu)&&(this.hideHandleAndGuide(),Yt(this,iu,!1),ue(this,Ca)!==ue(this,Bc)&&(ue(this,Yr).length>1?(P(ue(this,Yr),r=>{e(r)}),t()):P(ue(this,Yr),r=>{e(r,!0)})),this.setupHandlePosition(ue(this,xo)))}function qve(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ue(this,dr)),this.hot.rootElement.removeChild(ue(this,Eo)),Yt(this,iu,!1),Yt(this,nv,!0),this.hot._registerImmediate(()=>{Yt(this,nv,!1)})}function Qve(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ue(this,Yi).getValueAtIndex(r);this.hot.getSettings()[ev]&&i&&(n=i)}return n}function Zve(){const t=this.hot.getSettings()[ev],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{ue(this,Yi).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{ue(this,Yi).setValueAtIndex(r,n)}),Yt(this,Zd,t)):t===!0&&Array.isArray(ue(this,Zd))&&ue(this,Zd).forEach((n,r)=>{ue(this,Yi).setValueAtIndex(r,n)})},!0)}function xl(t,e,n){return e=Jve(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jve(t){var e=eCe(t,"string");return typeof e=="symbol"?e:String(e)}function eCe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tCe{constructor(e,n,r,i,o,s){xl(this,"row",void 0),xl(this,"col",void 0),xl(this,"rowspan",void 0),xl(this,"colspan",void 0),xl(this,"removed",!1),xl(this,"cellCoordsFactory",void 0),xl(this,"cellRangeFactory",void 0),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return vt`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return vt`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return vt`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return vt`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const h=l-u+1,f=Math.abs(r)-h;this[s]-=f+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const Po=tCe;function lE(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function _b(t,e,n){return e=nCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nCe(t){var e=rCe(t,"string");return typeof e=="symbol"?e:String(e)}function rCe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qM{constructor(e){_b(this,"plugin",void 0),_b(this,"mergedCells",[]),_b(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return vt`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){const r=this.mergedCells;let i=!1;return P(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=n&&o.col+o.colspan-1>=n?(i=o,!1):!0),i}getByRange(e){const n=this.mergedCells;let r=!1;return P(n,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,i=[];let o=e;if(!o.includesRange){const s=this.hot._createCellCoords(o.from.row,o.from.col),a=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(s,s,a)}return P(r,s=>{const a=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),u=this.hot._createCellRange(a,a,l);n?o.overlaps(u)&&i.push(s):o.includesRange(u)&&i.push(s)}),i.length?i:!1}add(e){const n=this.mergedCells,r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new Po(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),n.push(a),a):(_t(qM.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.mergedCells,i=this.get(e,n),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(r.splice(o,1),i):!1}clear(){const e=this.mergedCells,n=[],r=[];P(e,i=>{const o=this.hot.getCell(i.row,i.col);o&&n.push([o,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,P(n,(i,o)=>{Re(0,i.rowspan-1,s=>{Re(0,i.colspan-1,a=>{if(a!==0||s!==0){const l=this.hot.getCell(i.row+s,i.col+a);l&&r.push([l,null,null,null])}})}),n[o][1]=null}),P(n,i=>{lE(...i)}),P(r,i=>{lE(...i)})}isOverlapping(e){const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return P(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(n)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}P(this.mergedCells,o=>{o.shift(i,n)}),Pw(this.mergedCells.length-1,0,o=>{const s=this.mergedCells[o];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}}const iCe=qM;function Mb(t,e,n){return e=oCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oCe(t){var e=sCe(t,"string");return typeof e=="symbol"?e:String(e)}function sCe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aCe{constructor(e){Mb(this,"plugin",void 0),Mb(this,"mergedCellsCollection",void 0),Mb(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,f=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,g=Math.floor(s/f)*f,p=s-g,y=this.getFarthestCollection(e,n,r,i);if(y){if(r==="down"){const E=y.row+y.rowspan-a-p;o[2]+E>=this.plugin.hot.countRows()?o[2]-=p:o[2]+=p?E:0}else if(r==="right"){const E=y.col+y.colspan-l-p;o[3]+E>=this.plugin.hot.countCols()?o[3]-=p:o[3]+=p?E:0}else if(r==="up"){const E=u-p-y.row+1;o[0]+E<0?o[0]+=p:o[0]-=p?E:0}else if(r==="left"){const E=c-p-y.col+1;o[1]+E<0?o[1]+=p:o[1]-=p?E:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:f}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),hn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":return[s+1,o,c,a];case"left":return[l,u,s,o-1];case"right":return[i,a+1,c,h];default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,f=this.getAutofillSize(e,n,r),g=u?a-o+1:l-s+1,p=Math.floor(f/g)*g,y=f-p;let E=null,v=null,C=null;switch(r){case"up":E="includesVertically",C=c-y+1;break;case"left":E="includesHorizontally",C=c-y+1;break;case"down":E="includesVertically",C=h+y-1;break;case"right":E="includesHorizontally",C=h+y-1;break}return P(i,S=>{S[E](C)&&S.isFarther(v,r)&&(v=S)}),v}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return P(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(h,!0)}}const lCe=aCe;function xb(t,e,n){return e=uCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uCe(t){var e=cCe(t,"string");return typeof e=="symbol"?e:String(e)}function cCe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hCe{constructor(e){xb(this,"plugin",void 0),xb(this,"hot",void 0),xb(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}snapDelta(e,n,r){const i=n.to,o=i.row+e.row,s=i.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,s)}jumpOverMergedCell(e,n,r){let i=e.row||e.col,o=null,s=null,a=null;e.row?(o=n.includesVertically(r),s=n.row,a=n.getLastRow()):e.col&&(o=n.includesHorizontally(r),s=n.col,a=n.getLastColumn()),i!==0&&(i>0?o&&r!==s&&(i+=a-r+1):o&&r!==a&&(i-=r-s+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,n){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+n.row,e.to.col+n.col))}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),f=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=f)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const dCe=hCe;function fCe(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(s_)}return this.getTranslatedPhrase(o_)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?Po.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function nn(t,e){jz(t,e),e.add(t)}function gCe(t,e,n){jz(t,e),e.set(t,n)}function jz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pb(t,e,n){return e=mCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mCe(t){var e=pCe(t,"string");return typeof e=="symbol"?e:String(e)}function pCe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ob(t,e,n){var r=Yz(t,e,"set");return wCe(t,r,n),n}function wCe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ic(t,e){var n=Yz(t,e,"get");return vCe(t,n)}function Yz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function vCe(t,e){return e.get?e.get.call(t):e.value}function zt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ve.getSingleton().register("beforeMergeCells");ve.getSingleton().register("afterMergeCells");ve.getSingleton().register("beforeUnmergeCells");ve.getSingleton().register("afterUnmergeCells");const Jd="mergeCells",CCe=150,zN=Jd;var To=new WeakMap,GN=new WeakSet,jN=new WeakSet,YN=new WeakSet,KN=new WeakSet,XN=new WeakSet,qN=new WeakSet,QN=new WeakSet,Ab=new WeakSet,ZN=new WeakSet,JN=new WeakSet,ek=new WeakSet,tk=new WeakSet,nk=new WeakSet,rk=new WeakSet,ik=new WeakSet,ok=new WeakSet,sk=new WeakSet,ak=new WeakSet,lk=new WeakSet,uk=new WeakSet,ck=new WeakSet,hk=new WeakSet;class yCe extends ct{constructor(){super(...arguments),nn(this,hk),nn(this,ck),nn(this,uk),nn(this,lk),nn(this,ak),nn(this,sk),nn(this,ok),nn(this,ik),nn(this,rk),nn(this,nk),nn(this,tk),nn(this,ek),nn(this,JN),nn(this,ZN),nn(this,Ab),nn(this,QN),nn(this,qN),nn(this,XN),nn(this,KN),nn(this,YN),nn(this,jN),nn(this,GN),Pb(this,"mergedCellsCollection",null),Pb(this,"autofillCalculations",null),Pb(this,"selectionCalculations",null),gCe(this,To,{writable:!0,value:null})}static get PLUGIN_KEY(){return Jd}static get PLUGIN_PRIORITY(){return CCe}isEnabled(){return!!this.hot.getSettings()[Jd]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new iCe(this),this.autofillCalculations=new lCe(this),this.selectionCalculations=new dCe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,GN,SCe).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,YN,RCe).call(e,...r)}),this.addHook("afterModifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,uk,FCe).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,KN,ECe).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,XN,TCe).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,Ab,dk).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,Ab,dk).call(e,...r)}),this.addHook("beforeSetRangeEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,ZN,xCe).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,jN,bCe).call(e,...r)}),this.addHook("afterRenderer",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,QN,MCe).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,qN,_Ce).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,JN,PCe).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,ek,OCe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,tk,ACe).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,nk,ICe).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,rk,HCe).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,ik,DCe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,ok,NCe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,sk,kCe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,ak,LCe).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,lk,$Ce).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,ck,WCe).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zt(e,hk,VCe).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[Jd];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!t1())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=qc(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=qc(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let n=!0;return e?(Po.containsNegativeValues(e)?(_t(Po.NEGATIVE_VALUES_WARNING(e)),n=!1):Po.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(_t(Po.IS_OUT_OF_BOUNDS_WARNING(e)),n=!1):Po.isSingleCell(e)?(_t(Po.IS_SINGLE_CELL(e)),n=!1):Po.containsZeroSpan(e)&&(_t(Po.ZERO_SPAN_WARNING(e)),n=!1),n):!1}generateFromSettings(e){if(Array.isArray(e)){const n=[];if(P(e,r=>{if(!this.validateSetting(r))return;const i=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(i,i,o);this.mergeRange(s,!0,!0),Re(r.row,r.row+r.rowspan-1,a=>{Re(r.col,r.col+r.colspan-1,l=>{a===r.row&&l===r.col||n.push([a,l,null])})})}),n.length===0)return;this.hot.setDataAtCell(n)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.toggleMerge(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),Re(0,s.rowspan-1,c=>{Re(0,s.colspan-1,h=>{let f=null;a[c]||(a[c]=[]),c===0&&h===0?f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=f})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),P(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),Re(0,i.rowspan-1,o=>{Re(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:zN})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(zN)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(je(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(je(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(je(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(je(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function SCe(){this.generateFromSettings(this.hot.getSettings()[Jd]),this.hot.render()}function bCe(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1}return t}function RCe(t){const e=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},r=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),o=this.mergedCellsCollection.get(i.row,i.col);if(ic(this,To)||Ob(this,To,this.hot._createCellCoords(null,null)),o){const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);this.hot._createCellRange(a,a,l).includes(ic(this,To))||Ob(this,To,this.hot._createCellCoords(null,null)),n.row=ic(this,To).row?ic(this,To).row-i.row:n.row,n.col=ic(this,To).col?ic(this,To).col-i.col:n.col,t.row>0?n.row=o.row+o.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-o.row+t.row),t.col>0?n.col=o.col+o.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-o.col+t.col)}r=this.hot._createCellCoords(e.highlight.row+n.row,e.highlight.col+n.col);const s=this.mergedCellsCollection.get(r.row,r.col);if(s){const a=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);Ob(this,To,r),n={row:a.row-i.row,col:a.col-i.col}}n.row!==0&&(t.row=n.row),n.col!==0&&(t.col=n.col)}function ECe(t){const e=this.hot.getSelectedRangeLast(),n=yr(t),r=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=yr(n);const o=this.mergedCellsCollection.getWithinRange(r,!0);do i=yr(n),this.selectionCalculations.getUpdatedSelectionRange(e,n),P(o,s=>{this.selectionCalculations.snapDelta(n,e,s)});while(n.row!==i.row||n.col!==i.col);t.row=n.row,t.col=n.col}function TCe(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:r,col:i,colspan:o,rowspan:s}=n;return[r,i,r+s-1,i+o-1]}function _Ce(t){t.items.push({name:"---------"},fCe(this))}function MCe(t,e,n){const r=this.mergedCellsCollection.get(e,n),i=je(r)?yr(r):void 0;if(je(i)){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:a,col:l,colspan:u,rowspan:c}=i,[h,f]=this.translateMergedCellToRenderable(a,c,l,u),g=o.getRenderableFromVisualIndex(e),p=s.getRenderableFromVisualIndex(n),y=h-g+1,E=f-p+1;i.row=o.getNearestNotHiddenIndex(i.row,1),i.col=s.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,y),i.colspan=Math.min(i.colspan,E)}lE(t,i,e,n)}function dk(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function xCe(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){const o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}function PCe(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function OCe(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function ACe(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function ICe(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(r=this.autofillCalculations.snapDragArea(e,r,n,i)),r}function HCe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function DCe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function NCe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function kCe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function LCe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function $Ce(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);P(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function FCe(t,e,n){if(!this.enabled)return;const r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;const i=e>0,o=e<0,s=n<0,a=n>0,l=r.row+r.rowspan-1===this.hot.countRows()-1,u=r.row===0,c=r.col+r.colspan-1===this.hot.countCols()-1,h=r.col===0;(i&&l||o&&u||a&&c||s&&h)&&(t.row=r.row,t.col=r.col)}function WCe(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function VCe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function BCe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],f=u.multiColumnSorting,p=(f.compareFunctionFactory?f.compareFunctionFactory:yU(u.type))(l,u,f)(c,h);if(p===Fo){const y=a+1;if(typeof e[y]<"u")return s(y)}return p}(0)}}function fk(){_t(vt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const Kz="sort";function UCe(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${Kz}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function zCe(t){const e=t.className.split(" "),n=new RegExp(`^${Kz}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function GCe(t,e,n){return e=jCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jCe(t){var e=YCe(t,"string");return typeof e=="symbol"?e:String(e)}function YCe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rv="multiColumnSorting",KCe=170,gk="columnSorting",mk=rv;CU(rv,BCe);class XCe extends SU{constructor(){super(...arguments),GCe(this,"pluginKey",rv)}static get PLUGIN_KEY(){return rv}static get PLUGIN_PRIORITY(){return KCe}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[gk]&&fk(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Bw))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:mk})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(mk)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),We(e,zCe(e)),this.enabled!==!1&&te(e,UCe(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[gk]&&fk(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){LM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Bw))):this.sort(this.getColumnNextConfig(n.col)))}}function pk(t,e,n){return e=qCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qCe(t){var e=QCe(t,"string");return typeof e=="symbol"?e:String(e)}function QCe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ZCe="multipleSelectionHandles",JCe=160;class eye extends ct{constructor(){super(...arguments),pk(this,"dragged",[]),pk(this,"lastSetCell",null)}static get PLUGIN_KEY(){return ZCe}static get PLUGIN_PRIORITY(){return JCe}isEnabled(){return Rs()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if($e(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if($e(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if($e(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if($e(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const f=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!f||f===e.lastSetCell||((f.nodeName==="TD"||f.nodeName==="TH")&&(s=e.hot.getCoords(f),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=f),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function uE(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function Xz(){return{label:"",isPlaceholder:!0}}function tye(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;P(t,i=>{const o=[];let s=0;n.push(o),P(i,a=>{const l=uE();if(je(a)){const{label:c,colspan:h}=a;l.label=Qt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h)}else l.label=Qt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(Xz());return!u})});const r=Math.max(...Ye(n,i=>i.length));return P(n,i=>{if(i.length<r){const o=Ye(new Array(r-i.length),()=>uE());i.splice(i.length,0,...o)}}),n}function Ib(t,e,n){nye(t,e),e.set(t,n)}function nye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wi(t,e){var n=qz(t,e,"get");return rye(t,n)}function rye(t,e){return e.get?e.get.call(t):e.value}function cd(t,e,n){var r=qz(t,e,"set");return iye(t,r,n),n}function qz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function iye(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const wk=["label","collapsible"];var ls=new WeakMap,Pl=new WeakMap,Hb=new WeakMap;class oye{constructor(){Ib(this,ls,{writable:!0,value:[]}),Ib(this,Pl,{writable:!0,value:0}),Ib(this,Hb,{writable:!0,value:1/0})}setColumnsLimit(e){cd(this,Hb,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];cd(this,ls,tye(e,Wi(this,Hb))),cd(this,Pl,Wi(this,ls).length)}getData(){return Wi(this,ls)}mergeWith(e){P(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&hn(s,o,wk)})}map(e){P(Wi(this,ls),n=>{P(n,r=>{const i=e({...r});je(i)&&hn(r,i,wk)})})}getHeaderSettings(e,n){var r;if(e>=Wi(this,Pl)||e<0)return null;const i=Wi(this,ls)[e];return n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Wi(this,Pl)||e<0)return i;const o=Wi(this,ls)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Wi(this,Pl)}getColumnsCount(){return Wi(this,Pl)>0?Wi(this,ls)[0].length:0}clear(){cd(this,ls,[]),cd(this,Pl,0)}}function Db(t,e,n){return e=sye(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sye(t){var e=aye(t,"string");return typeof e=="symbol"?e:String(e)}function aye(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Qz="DF-pre-order";function Zz(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=Zz.call(this.childs[r],t,e)}return n}const lye="DF-post-order";function Jz(t,e){for(let n=0;n<this.childs.length;n++)if(Jz.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const eG="BF";function uye(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const cye=eG,vk=new Map([[Qz,Zz],[lye,Jz],[eG,uye]]);class iv{constructor(e){Db(this,"data",{}),Db(this,"parent",null),Db(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new iv({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cye;if(!vk.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);vk.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function Nb(t,e,n){hye(t,e),e.set(t,n)}function hye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hr(t,e){var n=tG(t,e,"get");return dye(t,n)}function dye(t,e){return e.get?e.get.call(t):e.value}function fye(t,e,n){var r=tG(t,e,"set");return gye(t,r,n),n}function tG(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gye(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var oc=new WeakMap,Ol=new WeakMap,sc=new WeakMap;class mye{constructor(e){Nb(this,oc,{writable:!0,value:new Map}),Nb(this,Ol,{writable:!0,value:new Map}),Nb(this,sc,{writable:!0,value:null}),fye(this,sc,e)}getRoots(){return Array.from(hr(this,oc).values())}getRootByColumn(e){let n;return hr(this,Ol).has(e)&&(n=hr(this,oc).get(hr(this,Ol).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-hr(this,Ol).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;hr(this,Ol).clear(),P(hr(this,oc),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)hr(this,Ol).set(i,e);e+=r})}buildTree(){this.clear();const e=hr(this,sc).getColumnsCount();let n=0;for(;n<e;){const r=hr(this,sc).getHeaderSettings(0,n),i=new iv;hr(this,oc).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=hr(this,sc).getHeadersSettings(r,n,i);r+=1,P(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new iv(a),e.addChild(l)),r<hr(this,sc).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){hr(this,oc).clear(),hr(this,Ol).clear()}}function nG(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function ov(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function sv(t){return ov(t,"origColspan")===t.data.origColspan}function QM(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(sv(t))return QM(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)P(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,nG(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):sv(a)&&(l.isCollapsed=ov(a,"isCollapsed"))}),{rollbackModification:()=>ZM(t),affectedColumns:Array.from(o),colspanCompensation:s}}function ZM(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(sv(t))return ZM(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)P(o,l=>{nG(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=ov(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):sv(l)&&(u.isCollapsed=ov(l,"isCollapsed"))}),{rollbackModification:()=>QM(t),affectedColumns:Array.from(s),colspanCompensation:a}}function pye(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(vt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function wye(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(vt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const Ck=new Map([["collapse",ZM],["expand",QM],["hide-column",pye],["show-column",wye]]);function vye(t,e,n){if(!Ck.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return Ck.get(t)(e,n)}function Zm(t){const e=[];return P(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=yye(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(Xz());else{const g=Cye(i);g.isRoot=!0,u.push(g),c=!0}})}),e}function Cye(t){const{crossHiddenColumns:e,...n}=uE(t);return n}function yye(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function kb(t,e,n){Sye(t,e),e.set(t,n)}function Sye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hd(t,e,n){var r=rG(t,e,"set");return bye(t,r,n),n}function bye(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Gt(t,e){var n=rG(t,e,"get");return Rye(t,n)}function rG(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Rye(t,e){return e.get?e.get.call(t):e.value}var Ro=new WeakMap,xr=new WeakMap,Al=new WeakMap;class Eye{constructor(){kb(this,Ro,{writable:!0,value:new oye}),kb(this,xr,{writable:!0,value:new mye(Gt(this,Ro))}),kb(this,Al,{writable:!0,value:[[]]})}setState(e){Gt(this,Ro).setData(e);let n=!1;try{Gt(this,xr).buildTree()}catch{Gt(this,xr).clear(),Gt(this,Ro).clear(),n=!0}return hd(this,Al,Zm(Gt(this,xr).getRoots())),n}setColumnsLimit(e){Gt(this,Ro).setColumnsLimit(e)}mergeStateWith(e){const n=Ye(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Gt(this,Ro).mergeWith(n),Gt(this,xr).buildTree(),hd(this,Al,Zm(Gt(this,xr).getRoots()))}mapState(e){Gt(this,Ro).map(e),Gt(this,xr).buildTree(),hd(this,Al,Zm(Gt(this,xr).getRoots()))}mapNodes(e){return sn(Gt(this,xr).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Gt(this,xr).getNode(n,r);let o;return i&&(o=vye(e,i,r),hd(this,Al,Zm(Gt(this,xr).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Gt(this,Al)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Gt(this,xr).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let o=!1,s=null;for(let a=e;a<=r;a++){const l=Gt(this,xr).getRootByColumn(a);if(!l)break;o=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:h,origColspan:f,isHidden:g}=u.data;g||f<=i&&c>=e&&c+f-1<=r&&(s===null||h<s)&&(s=h)},Qz)}return o&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Gt(this,Ro).getLayersCount()}getColumnsCount(){return Gt(this,Ro).getColumnsCount()}clear(){hd(this,Al,[]),Gt(this,Ro).clear(),Gt(this,xr).clear()}}function dd(t,e,n){return e=Tye(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tye(t){var e=_ye(t,"string");return typeof e=="symbol"?e:String(e)}function _ye(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mye{constructor(e,n){dd(this,"hot",void 0),dd(this,"nestedHeaderSettingsGetter",void 0),dd(this,"layersCount",0),dd(this,"container",void 0),dd(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const f=n.createElement("th"),g=this.nestedHeaderSettingsGetter(l,h);if(g&&(!g.isPlaceholder||g.isHidden)){let p=g.label;s&&(p+='<button class="changeType"></button>'),fu(f,p),f.colSpan=g.colspan,u.appendChild(f)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}const xye=Mye;function On(t,e){iG(t,e),e.add(t)}function yk(t,e,n){return e=Pye(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pye(t){var e=Oye(t,"string");return typeof e=="symbol"?e:String(e)}function Oye(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jm(t,e,n){iG(t,e),e.set(t,n)}function iG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zl(t,e,n){var r=oG(t,e,"set");return Aye(t,r,n),n}function Aye(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function st(t,e){var n=oG(t,e,"get");return Iye(t,n)}function oG(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Iye(t,e){return e.get?e.get.call(t):e.value}function mn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Sk="nestedHeaders",Hye=280;var pt=new WeakMap,sa=new WeakMap,ef=new WeakMap,NC=new WeakMap,ep=new WeakSet,bk=new WeakSet,Rk=new WeakSet,Ek=new WeakSet,Tk=new WeakSet,_k=new WeakSet,Mk=new WeakSet,xk=new WeakSet,Pk=new WeakSet,Ok=new WeakSet,Ak=new WeakSet,Ik=new WeakSet,Hk=new WeakSet,Dk=new WeakSet,Nk=new WeakSet,kk=new WeakSet,Lk=new WeakSet,$k=new WeakSet;class Dye extends ct{constructor(){super(...arguments),On(this,$k),On(this,Lk),On(this,kk),On(this,Nk),On(this,Dk),On(this,Hk),On(this,Ik),On(this,Ak),On(this,Ok),On(this,Pk),On(this,xk),On(this,Mk),On(this,_k),On(this,Tk),On(this,Ek),On(this,Rk),On(this,bk),On(this,ep),Jm(this,pt,{writable:!0,value:new Eye}),Jm(this,sa,{writable:!0,value:null}),Jm(this,ef,{writable:!0,value:null}),Jm(this,NC,{writable:!0,value:!1}),yk(this,"ghostTable",new xye(this.hot,(e,n)=>this.getHeaderSettings(e,n))),yk(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return Sk}static get PLUGIN_PRIORITY(){return Hye}isEnabled(){return!!this.hot.getSettings()[Sk]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&_t(vt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>mn(this,Lk,qye).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,$k,Qye).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,Tk,$ye).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,_k,Fye).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,Mk,Wye).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,xk,Vye).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,Pk,Bye).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,Ok,Uye).call(e,...i)}),this.addHook("afterSelection",()=>mn(this,ep,Lb).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,bk,Nye).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>mn(this,Ik,Gye).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,Dk,Yye).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,Nk,Kye).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,Rk,kye).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,Ek,Lye).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,Ak,zye).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,Hk,jye).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,kk,Xye).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>mn(this,ep,Lb).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>mn(this,ep,Lb).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();st(this,pt).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=st(this,pt).setState(e)),this.detectedOverlappedHeaders&&_t(vt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";st(this,pt).triggerColumnModification(i,r)}),!st(this,sa)&&this.enabled&&zl(this,sa,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";st(this,pt).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),st(this,pt).clear(),st(this,sa).unsubscribe(),zl(this,sa,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return st(this,pt)}getLayersCount(){return st(this,pt).getLayersCount()}getHeaderSettings(e,n){return st(this,pt).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),We(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),We(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),We(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),We(o,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:f}=(s=st(this,pt).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(f||h)te(o,"hiddenHeader");else if(c>1){var g,p;const{wtOverlays:y}=l._wt,E=(g=y.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),v=(p=y.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o),C=E||v?Math.min(c,r-i):c;C>1&&o.setAttribute("colspan",C)}this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=st(this,pt).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){zl(this,pt,null),st(this,sa)!==null&&(st(this,sa).unsubscribe(),zl(this,sa,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return st(this,pt).getHeaderTreeNodeData(e.row,e.col)}}function Lb(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=st(this,pt).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function Nye(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const i=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=st(this,pt).findLeftMostColumnIndex(n.row,n.col),a=st(this,pt).findRightMostColumnIndex(n.row,n.col);return s<i&&a>o?t:s<i?s:a}function kye(t,e,n){const r=st(this,pt).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=st(this,pt).getHeaderSettings(e,t);if(o===E1){if(!a)return r.columnIndex}else if(o===D2&&(l>s-i||!a))return null;return t}function Lye(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let f=a;f<=u;f++)for(let g=s;g<=l;g++){var i;const p=c+g,y=f-a;if(y===0)continue;((i=st(this,pt).getHeaderTreeNodeData(g,f))===null||i===void 0?void 0:i.isRoot)===!1&&(t[p][y]="")}}}function $ye(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function Fye(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;zl(this,ef,e.clone()),zl(this,NC,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(Jv(t)||ja(t)&&l)&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function Wye(t,e,n,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],f=$r(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,f):e.col>c.col?h.push(l.col,o+s-1,f):h.push(o,o+s-1,f),this.hot.selection.selectColumns(...h)}function Vye(){zl(this,NC,!1)}function Bye(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!st(this,NC)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=st(this,pt).getHeaderTreeNodeData(st(this,ef).row,st(this,ef).col);if(e.setHighlight(st(this,ef)),o>e.getWidth()||i<n||i+o-1>r){const s=st(this,pt).findTopMostEntireHeaderLevel($r(n,i,i+o-1),$r(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Uye(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=st(this,pt).findLeftMostColumnIndex(n.row,n.col),o=st(this,pt).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function zye(t,e){const n=t.row,r=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function Gye(t){t.length=0;for(let e=0;e<st(this,pt).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function jye(t){const e=st(this,pt).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=st(this,pt).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),vr(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?st(this,pt).getHeaderTreeNodeData(0,n).columnIndex:n}function Yye(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Kye(t,e,n){var r;const{label:i}=(r=st(this,pt).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Xye(t,e){if(t<0)return this.hot.getCell(t,st(this,pt).findLeftMostColumnIndex(t,e),!0)}function qye(){this.updatePlugin()}function Qye(t,e){e||this.updatePlugin()}function fd(t,e,n){return e=Zye(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zye(t){var e=Jye(t,"string");return typeof e=="symbol"?e:String(e)}function Jye(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eSe{constructor(e,n){fd(this,"hot",void 0),fd(this,"data",null),fd(this,"plugin",void 0),fd(this,"parentReference",new WeakMap),fd(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Re(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&P(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&P(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ke(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(P(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(Re(e[0],e[2],f=>{const g=this.translateTrimmedRow(f);i.push(this.getDataObject(g))}),Re(0,i.length-2,f=>{this.detachFromParent(i[f],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const f=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,f,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,f,this.plugin.pluginName),u){h=c+this.countChildren(u);const g=this.getChild(u,this.countChildren(u)-1),p=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",p+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];P(r,o=>{i.push(this.getDataObject(o))}),P(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),f=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&f?1:0),1),this.syncRowWithRawSource(s),f||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const tSe=eSe;function Fk(t,e,n){return e=nSe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nSe(t){var e=rSe(t,"string");return typeof e=="symbol"?e:String(e)}function rSe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iSe{constructor(e,n){Fk(this,"hot",void 0),Fk(this,"plugin",void 0),this.hot=n,this.plugin=e}}const JM=iSe;class ps extends JM{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(P(l,c=>{c&&s.removeChild(c)}),te(n,ps.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",Re(0,i-1,()=>{const f=c.createElement("SPAN");te(f,ps.CSS_CLASSES.emptyIndicator),s.appendChild(f)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Ae(c,[Us()]),te(n,ps.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(te(c,`${ps.CSS_CLASSES.button} ${ps.CSS_CLASSES.expandButton}`),u&&Ae(n,[bi(!1)])):(te(c,`${ps.CSS_CLASSES.button} ${ps.CSS_CLASSES.collapseButton}`),u&&Ae(n,[bi(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}const sG=ps;class oSe extends JM{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),P(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{Re(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&P(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];P(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return P(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);P(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return P(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);P(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&P(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];P(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];P(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];P(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{P(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{P(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&P(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);$e(e.target,sG.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Pi(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const sSe=oSe;function aSe(t,e,n){lSe(t,e),e.set(t,n)}function lSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uSe(t,e,n){return e=cSe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cSe(t){var e=hSe(t,"string");return typeof e=="symbol"?e:String(e)}function hSe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dSe(t,e){var n=fSe(t,e,"get");return gSe(t,n)}function fSe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gSe(t,e){return e.get?e.get.call(t):e.value}var Wk=new WeakMap;class mSe extends JM{constructor(){super(...arguments),uSe(this,"dataManager",this.plugin.dataManager),aSe(this,Wk,{writable:!0,value:{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(T_)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(__)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Re(0,e.items.length-1,r=>{if(r===0)return P(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Re(0,e.items.length-1,n=>{const r=dSe(this,Wk)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}const pSe=mSe;function tp(t,e,n){return e=wSe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wSe(t){var e=vSe(t,"string");return typeof e=="symbol"?e:String(e)}function vSe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CSe{constructor(e){tp(this,"plugin",void 0),tp(this,"hot",void 0),tp(this,"dataManager",void 0),tp(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(p=>{if(!l)return!1;const y=this.dataManager.translateTrimmedRow(p);return l=this.shouldAllowMoving(y,a),y}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),f=this.getTargetParent(s,a),g=h===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,g),this.moveRows(u,a,f),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Tt(i)&&(_t(vt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function Xn(t,e){aG(t,e),e.add(t)}function Vk(t,e,n){aG(t,e),e.set(t,n)}function aG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $b(t,e,n){return e=ySe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ySe(t){var e=SSe(t,"string");return typeof e=="symbol"?e:String(e)}function SSe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fp(t,e){var n=lG(t,e,"get");return bSe(t,n)}function bSe(t,e){return e.get?e.get.call(t):e.value}function av(t,e,n){var r=lG(t,e,"set");return RSe(t,r,n),n}function lG(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function RSe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function $n(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const lv="nestedRows",ESe=300,Bk=lv,TSe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var kC=new WeakMap,ac=new WeakMap,Uk=new WeakSet,zk=new WeakSet,Gk=new WeakSet,jk=new WeakSet,Yk=new WeakSet,Kk=new WeakSet,Xk=new WeakSet,qk=new WeakSet,Qk=new WeakSet,Zk=new WeakSet,Jk=new WeakSet,eL=new WeakSet,tL=new WeakSet,nL=new WeakSet,rL=new WeakSet,Fb=new WeakSet;class _Se extends ct{constructor(){super(...arguments),Xn(this,Fb),Xn(this,rL),Xn(this,nL),Xn(this,tL),Xn(this,eL),Xn(this,Jk),Xn(this,Zk),Xn(this,Qk),Xn(this,qk),Xn(this,Xk),Xn(this,Kk),Xn(this,Yk),Xn(this,jk),Xn(this,Gk),Xn(this,zk),Xn(this,Uk),$b(this,"dataManager",null),$b(this,"headersUI",null),$b(this,"collapsedRowsMap",null),Vk(this,kC,{writable:!0,value:!1}),Vk(this,ac,{writable:!0,value:!1})}static get PLUGIN_KEY(){return lv}static get PLUGIN_PRIORITY(){return ESe}isEnabled(){return!!this.hot.getSettings()[lv]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new lg),this.dataManager=new tSe(this,this.hot),this.collapsingUI=new sSe(this,this.hot),this.headersUI=new sG(this,this.hot),this.contextMenuUI=new pSe(this,this.hot),this.rowMoveController=new CSe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $n(e,nL,WSe).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $n(e,rL,VSe).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $n(e,Gk,PSe).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $n(e,jk,OSe).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $n(e,Yk,ASe).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $n(e,zk,xSe).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $n(e,qk,DSe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $n(e,Xk,HSe).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $n(e,Qk,NSe).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $n(e,Zk,kSe).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $n(e,Jk,LSe).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $n(e,eL,$Se).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $n(e,Kk,ISe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $n(e,tL,FSe).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $n(e,Uk,MSe).call(e,...r)}),this.addHook("beforeLoadData",n=>$n(this,Fb,iL).call(this,n)),this.addHook("beforeUpdateData",n=>$n(this,Fb,iL).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){const n=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n)}},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:Bk})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Bk)}disableCoreAPIModifiers(){av(this,ac,!0)}enableCoreAPIModifiers(){av(this,ac,!1)}onModifyRowData(e){if(!Fp(this,ac))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Fp(this,ac))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return Fp(this,ac)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function MSe(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function xSe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function PSe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),av(this,kC,!0),this.dataManager.getData().slice()}function OSe(t){return this.contextMenuUI.appendOptions(t)}function ASe(t,e){this.headersUI.appendLevelIndicators(t,e)}function ISe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function HSe(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{av(this,kC,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function DSe(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function NSe(){this.collapsingUI.collapsedRowsStash.stash()}function kSe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function LSe(){this.collapsingUI.collapsedRowsStash.stash()}function $Se(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function FSe(){this.dataManager.rewriteCache()}function WSe(){this.headersUI.updateRowHeaderWidth()}function VSe(t,e){Fp(this,kC)&&(e.skipRender=!0)}function iL(t){if(!Y2(t)){s1(TSe),this.hot.getSettings()[lv]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function Wb(t,e,n){return e=BSe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BSe(t){var e=USe(t,"string");return typeof e=="symbol"?e:String(e)}function USe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zSe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;Wb(this,"rootWindow",void 0),Wb(this,"prefix",void 0),Wb(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){P(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const GSe=zSe;function jSe(t,e,n){return e=YSe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YSe(t){var e=KSe(t,"string");return typeof e=="symbol"?e:String(e)}function KSe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ve.getSingleton().register("persistentStateSave");ve.getSingleton().register("persistentStateLoad");ve.getSingleton().register("persistentStateReset");const oL="persistentState",XSe=0;class qSe extends ct{constructor(){super(...arguments),jSe(this,"storage",void 0)}static get PLUGIN_KEY(){return oL}static get PLUGIN_PRIORITY(){return XSe}isEnabled(){return!!this.hot.getSettings()[oL]}enablePlugin(){this.enabled||(this.storage||(this.storage=new GSe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function QSe(t,e){ZSe(t,e),e.add(t)}function ZSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vb(t,e,n){return e=JSe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JSe(t){var e=ebe(t,"string");return typeof e=="symbol"?e:String(e)}function ebe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sL(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Bb="search",tbe=190,nbe="htSearchResult",rbe=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},ibe=function(t,e,n){return Tt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Tt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var Ub=new WeakSet;class obe extends ct{constructor(){super(...arguments),QSe(this,Ub),Vb(this,"callback",rbe),Vb(this,"queryMethod",ibe),Vb(this,"searchResultClass",nbe)}static get PLUGIN_KEY(){return Bb}static get PLUGIN_PRIORITY(){return tbe}isEnabled(){return this.hot.getSettings()[Bb]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Bb];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return sL(e,Ub,aL).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return sL(e,Ub,aL).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return Re(0,i-1,l=>{Re(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),f=h.search.callback||n,p=(h.search.queryMethod||r)(e,c,h);if(p){const y={row:l,col:u,data:c};s.push(y)}f&&f(a,l,u,c,p)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){je(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function aL(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function zb(t,e){sbe(t,e),e.add(t)}function sbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function np(t,e,n){return e=abe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function abe(t){var e=lbe(t,"string");return typeof e=="symbol"?e:String(e)}function lbe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gb(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const ube="touchScroll",cbe=200;var lL=new WeakSet,uL=new WeakSet,cL=new WeakSet;class hbe extends ct{constructor(){super(...arguments),zb(this,cL),zb(this,uL),zb(this,lL),np(this,"scrollbars",[]),np(this,"clones",[]),np(this,"lockedCollection",!1),np(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return ube}static get PLUGIN_PRIORITY(){return cbe}static get SETTING_KEYS(){return!0}isEnabled(){return w1()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>Gb(this,lL,dbe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>Gb(this,uL,fbe).call(this)),this.addHook("afterMomentumScroll",()=>Gb(this,cL,gbe).call(this))}}function dbe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function fbe(){this.freezeOverlays=!0,P(this.clones,t=>{te(t,"hide-tween")})}function gbe(){this.freezeOverlays=!1,P(this.clones,t=>{We(t,"hide-tween"),te(t,"show-tween")}),this.hot._registerTimeout(()=>{P(this.clones,t=>{We(t,"show-tween")})},400),P(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function mbe(t,e){pbe(t,e),e.add(t)}function pbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wbe(t,e,n){return e=vbe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vbe(t){var e=Cbe(t,"string");return typeof e=="symbol"?e:String(e)}function Cbe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ybe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Wp="trimRows",Sbe=330;var hL=new WeakSet;class bbe extends ct{constructor(){super(...arguments),mbe(this,hL),wbe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Wp}static get PLUGIN_PRIORITY(){return Sbe}isEnabled(){return!!this.hot.getSettings()[Wp]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new lg),this.trimmedRowsMap.addLocalHook("init",()=>ybe(this,hL,Rbe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Wp];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),P(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(P(e,l=>{o[l]=!1}),i=sn(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function Rbe(){const t=this.hot.getSettings()[Wp];Array.isArray(t)&&this.hot.batchExecution(()=>{P(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}const uG="undoRedo",Ebe="undoRedo";function ge(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(n,r){const i=n&&n.length;if(!i||!n.find(a=>{const[,,l,u]=a;return l!==u}))return;const s=()=>{const a=n.reduce((u,c)=>(u.push([...c]),u),[]);P(a,u=>{u[1]=t.propToCol(u[1])});const l=i>1?this.getSelected():[[a[0][0],a[0][1]]];return new ge.ChangeAction(a,l)};e.done(s,r)}),t.addHook("afterCreateRow",(n,r,i)=>{e.done(()=>new ge.CreateRowAction(n,r),i)}),t.addHook("beforeRemoveRow",(n,r,i,o)=>{const s=()=>{const a=t.toPhysicalRow(n),l=rr(e.instance.getSourceData(a,0,a+r-1,e.instance.countSourceCols()-1));return new ge.RemoveRowAction(a,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(s,o)}),t.addHook("afterCreateCol",(n,r,i)=>{e.done(()=>new ge.CreateColumnAction(n,r),i)}),t.addHook("beforeRemoveCol",(n,r,i,o)=>{const s=()=>{const a=e.instance.getSourceDataArray(),l=(e.instance.countCols()+n)%e.instance.countCols(),u=[],c=[],h=[];Re(a.length-1,p=>{const y=[],E=a[p];Re(l,l+(r-1),v=>{y.push(E[t.toPhysicalColumn(v)])}),u.push(y)}),Re(r-1,p=>{h.push(t.toPhysicalColumn(l+p))}),Array.isArray(t.getSettings().colHeaders)&&Re(r-1,p=>{c.push(t.getSettings().colHeaders[t.toPhysicalColumn(l+p)]||null)});const f=t.columnIndexMapper.getIndexesSequence(),g=t.rowIndexMapper.getIndexesSequence();return new ge.RemoveColumnAction(l,h,u,c,f,g,t.getSettings().fixedColumnsStart)};e.done(s,o)}),t.addHook("beforeCellAlignment",(n,r,i,o)=>{e.done(()=>new ge.CellAlignmentAction(n,r,i,o))}),t.addHook("beforeFilter",n=>{e.done(()=>new ge.FiltersAction(n))}),t.addHook("beforeRowMove",(n,r)=>{n!==!1&&e.done(()=>new ge.RowMoveAction(n,r))}),t.addHook("beforeMergeCells",(n,r)=>{r||e.done(()=>new ge.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",(n,r)=>{r||e.done(()=>new ge.UnmergeCellsAction(t,n))}),t.addHook("afterInit",()=>{e.init()})}ge.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};ge.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=rr(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};ge.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=rr(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};ge.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ge.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ge.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ge.prototype.isEnabled=function(){return this.enabled};ge.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,Mbe(t),this.registerShortcuts(),t.addHook("afterChange",cG)};ge.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,xbe(t),this.unregisterShortcuts(),t.removeHook("afterChange",cG)};ge.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ge.Action=function(){};ge.Action.prototype.undo=function(){};ge.Action.prototype.redo=function(){};ge.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};zs(ge.ChangeAction,ge.Action);ge.ChangeAction.prototype.undo=function(t,e){const n=rr(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let o=0,s=n.length;o<s;o++)n[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let o=0,s=n.length;o<s;o++){const[a,l]=n[o];t.getSettings().minSpareRows&&a+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(a+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&l+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(l+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};ge.ChangeAction.prototype.redo=function(t,e){const n=rr(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};ge.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};zs(ge.CreateRowAction,ge.Action);ge.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ge.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ge.RemoveRowAction=function(t,e,n,r,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i};zs(ge.RemoveRowAction,ge.Action);ge.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,o)=>{Object.keys(i).forEach(s=>{const a=parseInt(s,10);r.push([this.index+o,isNaN(a)?s:a,i[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ge.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ge.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};zs(ge.CreateColumnAction,ge.Action);ge.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ge.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ge.RemoveColumnAction=function(t,e,n,r,i,o,s){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s};zs(ge.RemoveColumnAction,ge.Action);ge.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,h)=>h[this.indexes.indexOf(r[c])],o=this.data.length,s=[];for(let u=0;u<o;u++)s.push(Ye(this.data[u],i));const a=Ye(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),P(t.getSourceDataArray(),(u,c)=>{P(r,(h,f)=>{u[h]=s[c][f],l.push([c,h,u[h]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&P(a,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};ge.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ge.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};ge.CellAlignmentAction.prototype.undo=function(t,e){P(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};ge.CellAlignmentAction.prototype.redo=function(t,e){ua(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,o)=>t.setCellMeta(n,r,i,o)),t.addHookOnce("afterViewRender",e),t.render()};ge.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};zs(ge.FiltersAction,ge.Action);ge.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()};ge.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class Tbe extends ge.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}ge.MergeCellsAction=Tbe;class _be extends ge.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}ge.UnmergeCellsAction=_be;ge.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};zs(ge.RowMoveAction,ge.Action);ge.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(a=>a>this.finalIndex),o=r.filter(a=>a<=this.finalIndex),s=i.sort((a,l)=>l-a).concat(o.sort((a,l)=>a-l));t.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){const l=t.toVisualRow(s[a]);n.moveRow(l,s[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ge.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ge.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ge.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:uG};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};ge.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(uG)};function cG(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function Mbe(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function xbe(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const pg=ve.getSingleton();pg.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});pg.register("beforeUndo");pg.register("afterUndo");pg.register("beforeRedo");pg.register("afterRedo");ge.PLUGIN_KEY=Ebe;ge.SETTING_KEYS=!0;function Pbe(){at(Vd),at(uue),at(Bd),at(Wue),at(Xue),at(SU),at(Wce),at(The),at(AC),at(Xde),at(Cfe),at(Mfe),at(HC),at(ege),at(lpe),at(Upe),at(pwe),at(xwe),at(Vwe),at(nve),at(fve),at(Nve),at(Gve),at(yCe),at(XCe),at(eye),at(Dye),at(_Se),at(qSe),at(obe),at(hbe),at(bbe),at(ge)}function Obe(){Nae(),qae(),ile(),_le(),Pbe()}function Abe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var jb,Yb,Kb,Xb,qb;Obe();Abe(le);le.__GhostTable=NM;le._getListenersCounter=wZ;le._getRegisteredMapsCounter=Hne;le.EventManager=ri;const Ibe=[Gq,ZQ,Cne,Zae,KJ,HQ,Xq,HZ,XQ,Qq,tZ,IZ],Hbe=[PQ,nZ];le.helper={};le.dom={};P(Ibe,t=>{P(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(le.helper[e]=t[e])})});P(Hbe,t=>{P(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(le.dom[e]=t[e])})});le.cellTypes=(jb=le.cellTypes)!==null&&jb!==void 0?jb:{};P(Jre(),t=>{le.cellTypes[t]=hM(t)});le.cellTypes.registerCellType=di;le.cellTypes.getCellType=hM;le.editors=(Yb=le.editors)!==null&&Yb!==void 0?Yb:{};P(cZ(),t=>{le.editors[`${nr(t)}Editor`]=Mw(t)});le.editors.registerEditor=Hr;le.editors.getEditor=Mw;le.renderers=(Kb=le.renderers)!==null&&Kb!==void 0?Kb:{};P(KZ(),t=>{const e=Ow(t);t==="base"&&(le.renderers.cellDecorator=e),le.renderers[`${nr(t)}Renderer`]=e});le.renderers.registerRenderer=Mo;le.renderers.getRenderer=Ow;le.validators=(Xb=le.validators)!==null&&Xb!==void 0?Xb:{};P(QZ(),t=>{le.validators[`${nr(t)}Validator`]=h1(t)});le.validators.registerValidator=Mc;le.validators.getValidator=h1;le.plugins=(qb=le.plugins)!==null&&qb!==void 0?qb:{};P(c1(),t=>{le.plugins[t]=og(t)});le.plugins[`${nr(ct.PLUGIN_KEY)}Plugin`]=ct;le.plugins.registerPlugin=at;le.plugins.getPlugin=og;const dL=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]);function Dbe(t,e){if(t<0)return;const n=this.isRtl()?"htRight":"htLeft";e.firstChild&&(dL.has(t.toString())?(le.dom.removeClass(e.firstChild,n),le.dom.addClass(e.firstChild,dL.get(t.toString()))):le.dom.addClass(e.firstChild,n))}const Nbe={data:UB,height:464,colWidths:[140,165,100,100,100,110,178],colHeaders:["Company name","Product name","Sell date","In stock","Qty","Order ID","Country"],dropdownMenu:!0,hiddenColumns:{indicators:!0},multiColumnSorting:!0,filters:!0,rowHeaders:!0,manualRowMove:!0,afterGetColHeader:Dbe,licenseKey:"non-commercial-and-evaluation"};function kbe(){const[t,e]=cv.useState({tabNavigation:!0,navigableHeaders:!0,renderAllRows:!1,enterBeginsEditing:!0,autoWrapRow:!0,autoWrapCol:!0,enterMoves:{col:0,row:1}});return we.jsxs(we.Fragment,{children:[we.jsx(pae,{changeToggleOptions:e,...t}),we.jsx("input",{className:"placeholder-input",type:"text",placeholder:"Focusable text input"}),we.jsxs(LB,{...Nbe,...t,children:[we.jsx(la,{data:"companyName",type:"text"}),we.jsx(la,{data:"productName",type:"text"}),we.jsx(la,{data:"sellDate",dateFormat:"DD/MM/YYYY",correctFormat:!0,type:"date",allowInvalid:!1}),we.jsx(la,{data:"inStock",type:"checkbox",className:"htCenter"}),we.jsx(la,{data:"qty",type:"numeric"}),we.jsx(la,{data:"orderId",type:"text"}),we.jsx(la,{data:"country",type:"dropdown",source:mae})]},String(t.renderAllRows)),we.jsx("input",{className:"placeholder-input",type:"text",placeholder:"Focusable text input"})]})}Qb.createRoot(document.getElementById("root")).render(we.jsx(wn.StrictMode,{children:we.jsx(kbe,{})}))});export default Lbe();
