var Qz=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Ibe=Qz((Kbe,pp)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Wi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function zk(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var Gk={exports:{}},Hw={},jk={exports:{}},nt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wf=Symbol.for("react.element"),Zz=Symbol.for("react.portal"),Jz=Symbol.for("react.fragment"),eG=Symbol.for("react.strict_mode"),tG=Symbol.for("react.profiler"),nG=Symbol.for("react.provider"),rG=Symbol.for("react.context"),iG=Symbol.for("react.forward_ref"),oG=Symbol.for("react.suspense"),sG=Symbol.for("react.memo"),aG=Symbol.for("react.lazy"),LM=Symbol.iterator;function lG(t){return t===null||typeof t!="object"?null:(t=LM&&t[LM]||t["@@iterator"],typeof t=="function"?t:null)}var Yk={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Kk=Object.assign,Xk={};function Nc(t,e,n){this.props=t,this.context=e,this.refs=Xk,this.updater=n||Yk}Nc.prototype.isReactComponent={};Nc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Nc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function qk(){}qk.prototype=Nc.prototype;function AR(t,e,n){this.props=t,this.context=e,this.refs=Xk,this.updater=n||Yk}var IR=AR.prototype=new qk;IR.constructor=AR;Kk(IR,Nc.prototype);IR.isPureReactComponent=!0;var $M=Array.isArray,Qk=Object.prototype.hasOwnProperty,HR={current:null},Zk={key:!0,ref:!0,__self:!0,__source:!0};function Jk(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)Qk.call(e,r)&&!Zk.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:wf,type:t,key:o,ref:s,props:i,_owner:HR.current}}function uG(t,e){return{$$typeof:wf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function DR(t){return typeof t=="object"&&t!==null&&t.$$typeof===wf}function cG(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var FM=/\/+/g;function aC(t,e){return typeof t=="object"&&t!==null&&t.key!=null?cG(""+t.key):e.toString(36)}function Am(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case wf:case Zz:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+aC(s,0):r,$M(i)?(n="",t!=null&&(n=t.replace(FM,"$&/")+"/"),Am(i,e,n,"",function(u){return u})):i!=null&&(DR(i)&&(i=uG(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(FM,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",$M(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+aC(o,a);s+=Am(o,e,n,l,i)}else if(l=lG(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+aC(o,a++),s+=Am(o,e,n,l,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function qf(t,e,n){if(t==null)return t;var r=[],i=0;return Am(t,r,"","",function(o){return e.call(n,o,i++)}),r}function hG(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var pr={current:null},Im={transition:null},dG={ReactCurrentDispatcher:pr,ReactCurrentBatchConfig:Im,ReactCurrentOwner:HR};nt.Children={map:qf,forEach:function(t,e,n){qf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return qf(t,function(){e++}),e},toArray:function(t){return qf(t,function(e){return e})||[]},only:function(t){if(!DR(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};nt.Component=Nc;nt.Fragment=Jz;nt.Profiler=tG;nt.PureComponent=AR;nt.StrictMode=eG;nt.Suspense=oG;nt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dG;nt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Kk({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=HR.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Qk.call(e,l)&&!Zk.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:wf,type:t.type,key:i,ref:o,props:r,_owner:s}};nt.createContext=function(t){return t={$$typeof:rG,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:nG,_context:t},t.Consumer=t};nt.createElement=Jk;nt.createFactory=function(t){var e=Jk.bind(null,t);return e.type=t,e};nt.createRef=function(){return{current:null}};nt.forwardRef=function(t){return{$$typeof:iG,render:t}};nt.isValidElement=DR;nt.lazy=function(t){return{$$typeof:aG,_payload:{_status:-1,_result:t},_init:hG}};nt.memo=function(t,e){return{$$typeof:sG,type:t,compare:e===void 0?null:e}};nt.startTransition=function(t){var e=Im.transition;Im.transition={};try{t()}finally{Im.transition=e}};nt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};nt.useCallback=function(t,e){return pr.current.useCallback(t,e)};nt.useContext=function(t){return pr.current.useContext(t)};nt.useDebugValue=function(){};nt.useDeferredValue=function(t){return pr.current.useDeferredValue(t)};nt.useEffect=function(t,e){return pr.current.useEffect(t,e)};nt.useId=function(){return pr.current.useId()};nt.useImperativeHandle=function(t,e,n){return pr.current.useImperativeHandle(t,e,n)};nt.useInsertionEffect=function(t,e){return pr.current.useInsertionEffect(t,e)};nt.useLayoutEffect=function(t,e){return pr.current.useLayoutEffect(t,e)};nt.useMemo=function(t,e){return pr.current.useMemo(t,e)};nt.useReducer=function(t,e,n){return pr.current.useReducer(t,e,n)};nt.useRef=function(t){return pr.current.useRef(t)};nt.useState=function(t){return pr.current.useState(t)};nt.useSyncExternalStore=function(t,e,n){return pr.current.useSyncExternalStore(t,e,n)};nt.useTransition=function(){return pr.current.useTransition()};nt.version="18.2.0";jk.exports=nt;var vf=jk.exports;const dn=pf(vf);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fG=vf,gG=Symbol.for("react.element"),mG=Symbol.for("react.fragment"),pG=Object.prototype.hasOwnProperty,wG=fG.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vG={key:!0,ref:!0,__self:!0,__source:!0};function eL(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)pG.call(e,r)&&!vG.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:gG,type:t,key:o,ref:s,props:i,_owner:wG.current}}Hw.Fragment=mG;Hw.jsx=eL;Hw.jsxs=eL;Gk.exports=Hw;var we=Gk.exports,Cb={},tL={exports:{}},Xr={},nL={exports:{}},rL={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(R,d){var m=R.length;R.push(d);e:for(;0<m;){var w=m-1>>>1,x=R[w];if(0<i(x,d))R[w]=d,R[m]=x,m=w;else break e}}function n(R){return R.length===0?null:R[0]}function r(R){if(R.length===0)return null;var d=R[0],m=R.pop();if(m!==d){R[0]=m;e:for(var w=0,x=R.length,O=x>>>1;w<O;){var A=2*(w+1)-1,K=R[A],U=A+1,Q=R[U];if(0>i(K,m))U<x&&0>i(Q,K)?(R[w]=Q,R[U]=m,w=U):(R[w]=K,R[A]=m,w=A);else if(U<x&&0>i(Q,m))R[w]=Q,R[U]=m,w=U;else break e}}return d}function i(R,d){var m=R.sortIndex-d.sortIndex;return m!==0?m:R.id-d.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var l=[],u=[],c=1,h=null,f=3,g=!1,p=!1,y=!1,E=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(R){for(var d=n(u);d!==null;){if(d.callback===null)r(u);else if(d.startTime<=R)r(u),d.sortIndex=d.expirationTime,e(l,d);else break;d=n(u)}}function T(R){if(y=!1,S(R),!p)if(n(l)!==null)p=!0,$e(_);else{var d=n(u);d!==null&&He(T,d.startTime-R)}}function _(R,d){p=!1,y&&(y=!1,v(B),B=-1),g=!0;var m=f;try{for(S(d),h=n(l);h!==null&&(!(h.expirationTime>d)||R&&!Z());){var w=h.callback;if(typeof w=="function"){h.callback=null,f=h.priorityLevel;var x=w(h.expirationTime<=d);d=t.unstable_now(),typeof x=="function"?h.callback=x:h===n(l)&&r(l),S(d)}else r(l);h=n(l)}if(h!==null)var O=!0;else{var A=n(u);A!==null&&He(T,A.startTime-d),O=!1}return O}finally{h=null,f=m,g=!1}}var H=!1,D=null,B=-1,z=5,G=-1;function Z(){return!(t.unstable_now()-G<z)}function re(){if(D!==null){var R=t.unstable_now();G=R;var d=!0;try{d=D(!0,R)}finally{d?ne():(H=!1,D=null)}}else H=!1}var ne;if(typeof C=="function")ne=function(){C(re)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,Ee=ue.port2;ue.port1.onmessage=re,ne=function(){Ee.postMessage(null)}}else ne=function(){E(re,0)};function $e(R){D=R,H||(H=!0,ne())}function He(R,d){B=E(function(){R(t.unstable_now())},d)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(R){R.callback=null},t.unstable_continueExecution=function(){p||g||(p=!0,$e(_))},t.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<R?Math.floor(1e3/R):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(R){switch(f){case 1:case 2:case 3:var d=3;break;default:d=f}var m=f;f=d;try{return R()}finally{f=m}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(R,d){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var m=f;f=R;try{return d()}finally{f=m}},t.unstable_scheduleCallback=function(R,d,m){var w=t.unstable_now();switch(typeof m=="object"&&m!==null?(m=m.delay,m=typeof m=="number"&&0<m?w+m:w):m=w,R){case 1:var x=-1;break;case 2:x=250;break;case 5:x=1073741823;break;case 4:x=1e4;break;default:x=5e3}return x=m+x,R={id:c++,callback:d,priorityLevel:R,startTime:m,expirationTime:x,sortIndex:-1},m>w?(R.sortIndex=m,e(u,R),n(l)===null&&R===n(u)&&(y?(v(B),B=-1):y=!0,He(T,m-w))):(R.sortIndex=x,e(l,R),p||g||(p=!0,$e(_))),R},t.unstable_shouldYield=Z,t.unstable_wrapCallback=function(R){var d=f;return function(){var m=f;f=d;try{return R.apply(this,arguments)}finally{f=m}}}})(rL);nL.exports=rL;var CG=nL.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iL=vf,jr=CG;function ie(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var oL=new Set,Pd={};function zl(t,e){Sc(t,e),Sc(t+"Capture",e)}function Sc(t,e){for(Pd[t]=e,t=0;t<e.length;t++)oL.add(e[t])}var gs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),yb=Object.prototype.hasOwnProperty,yG=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,WM={},VM={};function SG(t){return yb.call(VM,t)?!0:yb.call(WM,t)?!1:yG.test(t)?VM[t]=!0:(WM[t]=!0,!1)}function bG(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function RG(t,e,n,r){if(e===null||typeof e>"u"||bG(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function wr(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var Ln={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ln[t]=new wr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ln[e]=new wr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ln[t]=new wr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ln[t]=new wr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ln[t]=new wr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ln[t]=new wr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ln[t]=new wr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ln[t]=new wr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ln[t]=new wr(t,5,!1,t.toLowerCase(),null,!1,!1)});var NR=/[\-:]([a-z])/g;function kR(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(NR,kR);Ln[e]=new wr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(NR,kR);Ln[e]=new wr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(NR,kR);Ln[e]=new wr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ln[t]=new wr(t,1,!1,t.toLowerCase(),null,!1,!1)});Ln.xlinkHref=new wr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ln[t]=new wr(t,1,!1,t.toLowerCase(),null,!0,!0)});function LR(t,e,n,r){var i=Ln.hasOwnProperty(e)?Ln[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(RG(e,n,i,r)&&(n=null),r||i===null?SG(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var bs=iL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qf=Symbol.for("react.element"),ju=Symbol.for("react.portal"),Yu=Symbol.for("react.fragment"),$R=Symbol.for("react.strict_mode"),Sb=Symbol.for("react.profiler"),sL=Symbol.for("react.provider"),aL=Symbol.for("react.context"),FR=Symbol.for("react.forward_ref"),bb=Symbol.for("react.suspense"),Rb=Symbol.for("react.suspense_list"),WR=Symbol.for("react.memo"),js=Symbol.for("react.lazy"),lL=Symbol.for("react.offscreen"),BM=Symbol.iterator;function Zc(t){return t===null||typeof t!="object"?null:(t=BM&&t[BM]||t["@@iterator"],typeof t=="function"?t:null)}var Xt=Object.assign,lC;function jh(t){if(lC===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);lC=e&&e[1]||""}return`
`+lC+t}var uC=!1;function cC(t,e){if(!t||uC)return"";uC=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var l=`
`+i[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=a);break}}}finally{uC=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?jh(t):""}function EG(t){switch(t.tag){case 5:return jh(t.type);case 16:return jh("Lazy");case 13:return jh("Suspense");case 19:return jh("SuspenseList");case 0:case 2:case 15:return t=cC(t.type,!1),t;case 11:return t=cC(t.type.render,!1),t;case 1:return t=cC(t.type,!0),t;default:return""}}function Eb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Yu:return"Fragment";case ju:return"Portal";case Sb:return"Profiler";case $R:return"StrictMode";case bb:return"Suspense";case Rb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case aL:return(t.displayName||"Context")+".Consumer";case sL:return(t._context.displayName||"Context")+".Provider";case FR:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case WR:return e=t.displayName||null,e!==null?e:Eb(t.type)||"Memo";case js:e=t._payload,t=t._init;try{return Eb(t(e))}catch{}}return null}function TG(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Eb(e);case 8:return e===$R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ya(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function uL(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function _G(t){var e=uL(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Zf(t){t._valueTracker||(t._valueTracker=_G(t))}function cL(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=uL(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function wp(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Tb(t,e){var n=e.checked;return Xt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function UM(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ya(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function hL(t,e){e=e.checked,e!=null&&LR(t,"checked",e,!1)}function _b(t,e){hL(t,e);var n=ya(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Mb(t,e.type,n):e.hasOwnProperty("defaultValue")&&Mb(t,e.type,ya(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function zM(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Mb(t,e,n){(e!=="number"||wp(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Yh=Array.isArray;function cc(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ya(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function xb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ie(91));return Xt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function GM(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ie(92));if(Yh(n)){if(1<n.length)throw Error(ie(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ya(n)}}function dL(t,e){var n=ya(e.value),r=ya(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function jM(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function fL(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?fL(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Jf,gL=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Jf=Jf||document.createElement("div"),Jf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Jf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Od(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var nd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},MG=["Webkit","ms","Moz","O"];Object.keys(nd).forEach(function(t){MG.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),nd[e]=nd[t]})});function mL(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||nd.hasOwnProperty(t)&&nd[t]?(""+e).trim():e+"px"}function pL(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=mL(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var xG=Xt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ob(t,e){if(e){if(xG[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ie(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ie(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ie(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ie(62))}}function Ab(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ib=null;function VR(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Hb=null,hc=null,dc=null;function YM(t){if(t=Sf(t)){if(typeof Hb!="function")throw Error(ie(280));var e=t.stateNode;e&&(e=$w(e),Hb(t.stateNode,t.type,e))}}function wL(t){hc?dc?dc.push(t):dc=[t]:hc=t}function vL(){if(hc){var t=hc,e=dc;if(dc=hc=null,YM(t),e)for(t=0;t<e.length;t++)YM(e[t])}}function CL(t,e){return t(e)}function yL(){}var hC=!1;function SL(t,e,n){if(hC)return t(e,n);hC=!0;try{return CL(t,e,n)}finally{hC=!1,(hc!==null||dc!==null)&&(yL(),vL())}}function Ad(t,e){var n=t.stateNode;if(n===null)return null;var r=$w(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ie(231,e,typeof n));return n}var Db=!1;if(gs)try{var Jc={};Object.defineProperty(Jc,"passive",{get:function(){Db=!0}}),window.addEventListener("test",Jc,Jc),window.removeEventListener("test",Jc,Jc)}catch{Db=!1}function PG(t,e,n,r,i,o,s,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var rd=!1,vp=null,Cp=!1,Nb=null,OG={onError:function(t){rd=!0,vp=t}};function AG(t,e,n,r,i,o,s,a,l){rd=!1,vp=null,PG.apply(OG,arguments)}function IG(t,e,n,r,i,o,s,a,l){if(AG.apply(this,arguments),rd){if(rd){var u=vp;rd=!1,vp=null}else throw Error(ie(198));Cp||(Cp=!0,Nb=u)}}function Gl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function bL(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function KM(t){if(Gl(t)!==t)throw Error(ie(188))}function HG(t){var e=t.alternate;if(!e){if(e=Gl(t),e===null)throw Error(ie(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return KM(i),t;if(o===r)return KM(i),e;o=o.sibling}throw Error(ie(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(ie(189))}}if(n.alternate!==r)throw Error(ie(190))}if(n.tag!==3)throw Error(ie(188));return n.stateNode.current===n?t:e}function RL(t){return t=HG(t),t!==null?EL(t):null}function EL(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=EL(t);if(e!==null)return e;t=t.sibling}return null}var TL=jr.unstable_scheduleCallback,XM=jr.unstable_cancelCallback,DG=jr.unstable_shouldYield,NG=jr.unstable_requestPaint,rn=jr.unstable_now,kG=jr.unstable_getCurrentPriorityLevel,BR=jr.unstable_ImmediatePriority,_L=jr.unstable_UserBlockingPriority,yp=jr.unstable_NormalPriority,LG=jr.unstable_LowPriority,ML=jr.unstable_IdlePriority,Dw=null,bo=null;function $G(t){if(bo&&typeof bo.onCommitFiberRoot=="function")try{bo.onCommitFiberRoot(Dw,t,void 0,(t.current.flags&128)===128)}catch{}}var Vi=Math.clz32?Math.clz32:VG,FG=Math.log,WG=Math.LN2;function VG(t){return t>>>=0,t===0?32:31-(FG(t)/WG|0)|0}var eg=64,tg=4194304;function Kh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Sp(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~i;a!==0?r=Kh(a):(o&=s,o!==0&&(r=Kh(o)))}else s=n&~i,s!==0?r=Kh(s):o!==0&&(r=Kh(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Vi(e),i=1<<n,r|=t[n],e&=~i;return r}function BG(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function UG(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-Vi(o),a=1<<s,l=i[s];l===-1?(!(a&n)||a&r)&&(i[s]=BG(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function kb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function xL(){var t=eg;return eg<<=1,!(eg&4194240)&&(eg=64),t}function dC(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Cf(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Vi(e),t[e]=n}function zG(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Vi(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function UR(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Vi(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var pt=0;function PL(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var OL,zR,AL,IL,HL,Lb=!1,ng=[],sa=null,aa=null,la=null,Id=new Map,Hd=new Map,Xs=[],GG="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qM(t,e){switch(t){case"focusin":case"focusout":sa=null;break;case"dragenter":case"dragleave":aa=null;break;case"mouseover":case"mouseout":la=null;break;case"pointerover":case"pointerout":Id.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hd.delete(e.pointerId)}}function eh(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=Sf(e),e!==null&&zR(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function jG(t,e,n,r,i){switch(e){case"focusin":return sa=eh(sa,t,e,n,r,i),!0;case"dragenter":return aa=eh(aa,t,e,n,r,i),!0;case"mouseover":return la=eh(la,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return Id.set(o,eh(Id.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Hd.set(o,eh(Hd.get(o)||null,t,e,n,r,i)),!0}return!1}function DL(t){var e=Sl(t.target);if(e!==null){var n=Gl(e);if(n!==null){if(e=n.tag,e===13){if(e=bL(n),e!==null){t.blockedOn=e,HL(t.priority,function(){AL(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Hm(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=$b(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Ib=r,n.target.dispatchEvent(r),Ib=null}else return e=Sf(n),e!==null&&zR(e),t.blockedOn=n,!1;e.shift()}return!0}function QM(t,e,n){Hm(t)&&n.delete(e)}function YG(){Lb=!1,sa!==null&&Hm(sa)&&(sa=null),aa!==null&&Hm(aa)&&(aa=null),la!==null&&Hm(la)&&(la=null),Id.forEach(QM),Hd.forEach(QM)}function th(t,e){t.blockedOn===e&&(t.blockedOn=null,Lb||(Lb=!0,jr.unstable_scheduleCallback(jr.unstable_NormalPriority,YG)))}function Dd(t){function e(i){return th(i,t)}if(0<ng.length){th(ng[0],t);for(var n=1;n<ng.length;n++){var r=ng[n];r.blockedOn===t&&(r.blockedOn=null)}}for(sa!==null&&th(sa,t),aa!==null&&th(aa,t),la!==null&&th(la,t),Id.forEach(e),Hd.forEach(e),n=0;n<Xs.length;n++)r=Xs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Xs.length&&(n=Xs[0],n.blockedOn===null);)DL(n),n.blockedOn===null&&Xs.shift()}var fc=bs.ReactCurrentBatchConfig,bp=!0;function KG(t,e,n,r){var i=pt,o=fc.transition;fc.transition=null;try{pt=1,GR(t,e,n,r)}finally{pt=i,fc.transition=o}}function XG(t,e,n,r){var i=pt,o=fc.transition;fc.transition=null;try{pt=4,GR(t,e,n,r)}finally{pt=i,fc.transition=o}}function GR(t,e,n,r){if(bp){var i=$b(t,e,n,r);if(i===null)bC(t,e,r,Rp,n),qM(t,r);else if(jG(i,t,e,n,r))r.stopPropagation();else if(qM(t,r),e&4&&-1<GG.indexOf(t)){for(;i!==null;){var o=Sf(i);if(o!==null&&OL(o),o=$b(t,e,n,r),o===null&&bC(t,e,r,Rp,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else bC(t,e,r,null,n)}}var Rp=null;function $b(t,e,n,r){if(Rp=null,t=VR(r),t=Sl(t),t!==null)if(e=Gl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=bL(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Rp=t,null}function NL(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(kG()){case BR:return 1;case _L:return 4;case yp:case LG:return 16;case ML:return 536870912;default:return 16}default:return 16}}var Js=null,jR=null,Dm=null;function kL(){if(Dm)return Dm;var t,e=jR,n=e.length,r,i="value"in Js?Js.value:Js.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return Dm=i.slice(t,1<r?1-r:void 0)}function Nm(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function rg(){return!0}function ZM(){return!1}function qr(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?rg:ZM,this.isPropagationStopped=ZM,this}return Xt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=rg)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=rg)},persist:function(){},isPersistent:rg}),e}var kc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},YR=qr(kc),yf=Xt({},kc,{view:0,detail:0}),qG=qr(yf),fC,gC,nh,Nw=Xt({},yf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:KR,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==nh&&(nh&&t.type==="mousemove"?(fC=t.screenX-nh.screenX,gC=t.screenY-nh.screenY):gC=fC=0,nh=t),fC)},movementY:function(t){return"movementY"in t?t.movementY:gC}}),JM=qr(Nw),QG=Xt({},Nw,{dataTransfer:0}),ZG=qr(QG),JG=Xt({},yf,{relatedTarget:0}),mC=qr(JG),ej=Xt({},kc,{animationName:0,elapsedTime:0,pseudoElement:0}),tj=qr(ej),nj=Xt({},kc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),rj=qr(nj),ij=Xt({},kc,{data:0}),ex=qr(ij),oj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},aj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lj(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=aj[t])?!!e[t]:!1}function KR(){return lj}var uj=Xt({},yf,{key:function(t){if(t.key){var e=oj[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Nm(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?sj[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:KR,charCode:function(t){return t.type==="keypress"?Nm(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Nm(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),cj=qr(uj),hj=Xt({},Nw,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tx=qr(hj),dj=Xt({},yf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:KR}),fj=qr(dj),gj=Xt({},kc,{propertyName:0,elapsedTime:0,pseudoElement:0}),mj=qr(gj),pj=Xt({},Nw,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),wj=qr(pj),vj=[9,13,27,32],XR=gs&&"CompositionEvent"in window,id=null;gs&&"documentMode"in document&&(id=document.documentMode);var Cj=gs&&"TextEvent"in window&&!id,LL=gs&&(!XR||id&&8<id&&11>=id),nx=String.fromCharCode(32),rx=!1;function $L(t,e){switch(t){case"keyup":return vj.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function FL(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ku=!1;function yj(t,e){switch(t){case"compositionend":return FL(e);case"keypress":return e.which!==32?null:(rx=!0,nx);case"textInput":return t=e.data,t===nx&&rx?null:t;default:return null}}function Sj(t,e){if(Ku)return t==="compositionend"||!XR&&$L(t,e)?(t=kL(),Dm=jR=Js=null,Ku=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return LL&&e.locale!=="ko"?null:e.data;default:return null}}var bj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ix(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!bj[t.type]:e==="textarea"}function WL(t,e,n,r){wL(r),e=Ep(e,"onChange"),0<e.length&&(n=new YR("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var od=null,Nd=null;function Rj(t){QL(t,0)}function kw(t){var e=Qu(t);if(cL(e))return t}function Ej(t,e){if(t==="change")return e}var VL=!1;if(gs){var pC;if(gs){var wC="oninput"in document;if(!wC){var ox=document.createElement("div");ox.setAttribute("oninput","return;"),wC=typeof ox.oninput=="function"}pC=wC}else pC=!1;VL=pC&&(!document.documentMode||9<document.documentMode)}function sx(){od&&(od.detachEvent("onpropertychange",BL),Nd=od=null)}function BL(t){if(t.propertyName==="value"&&kw(Nd)){var e=[];WL(e,Nd,t,VR(t)),SL(Rj,e)}}function Tj(t,e,n){t==="focusin"?(sx(),od=e,Nd=n,od.attachEvent("onpropertychange",BL)):t==="focusout"&&sx()}function _j(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return kw(Nd)}function Mj(t,e){if(t==="click")return kw(e)}function xj(t,e){if(t==="input"||t==="change")return kw(e)}function Pj(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var zi=typeof Object.is=="function"?Object.is:Pj;function kd(t,e){if(zi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!yb.call(e,i)||!zi(t[i],e[i]))return!1}return!0}function ax(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function lx(t,e){var n=ax(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ax(n)}}function UL(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?UL(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function zL(){for(var t=window,e=wp();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=wp(t.document)}return e}function qR(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Oj(t){var e=zL(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&UL(n.ownerDocument.documentElement,n)){if(r!==null&&qR(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=lx(n,o);var s=lx(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Aj=gs&&"documentMode"in document&&11>=document.documentMode,Xu=null,Fb=null,sd=null,Wb=!1;function ux(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Wb||Xu==null||Xu!==wp(r)||(r=Xu,"selectionStart"in r&&qR(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),sd&&kd(sd,r)||(sd=r,r=Ep(Fb,"onSelect"),0<r.length&&(e=new YR("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Xu)))}function ig(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var qu={animationend:ig("Animation","AnimationEnd"),animationiteration:ig("Animation","AnimationIteration"),animationstart:ig("Animation","AnimationStart"),transitionend:ig("Transition","TransitionEnd")},vC={},GL={};gs&&(GL=document.createElement("div").style,"AnimationEvent"in window||(delete qu.animationend.animation,delete qu.animationiteration.animation,delete qu.animationstart.animation),"TransitionEvent"in window||delete qu.transitionend.transition);function Lw(t){if(vC[t])return vC[t];if(!qu[t])return t;var e=qu[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in GL)return vC[t]=e[n];return t}var jL=Lw("animationend"),YL=Lw("animationiteration"),KL=Lw("animationstart"),XL=Lw("transitionend"),qL=new Map,cx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oa(t,e){qL.set(t,e),zl(e,[t])}for(var CC=0;CC<cx.length;CC++){var yC=cx[CC],Ij=yC.toLowerCase(),Hj=yC[0].toUpperCase()+yC.slice(1);Oa(Ij,"on"+Hj)}Oa(jL,"onAnimationEnd");Oa(YL,"onAnimationIteration");Oa(KL,"onAnimationStart");Oa("dblclick","onDoubleClick");Oa("focusin","onFocus");Oa("focusout","onBlur");Oa(XL,"onTransitionEnd");Sc("onMouseEnter",["mouseout","mouseover"]);Sc("onMouseLeave",["mouseout","mouseover"]);Sc("onPointerEnter",["pointerout","pointerover"]);Sc("onPointerLeave",["pointerout","pointerover"]);zl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));zl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));zl("onBeforeInput",["compositionend","keypress","textInput","paste"]);zl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));zl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));zl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dj=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xh));function hx(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,IG(r,e,void 0,t),t.currentTarget=null}function QL(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;hx(i,a,u),o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,u=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;hx(i,a,u),o=l}}}if(Cp)throw t=Nb,Cp=!1,Nb=null,t}function xt(t,e){var n=e[Gb];n===void 0&&(n=e[Gb]=new Set);var r=t+"__bubble";n.has(r)||(ZL(e,t,2,!1),n.add(r))}function SC(t,e,n){var r=0;e&&(r|=4),ZL(n,t,r,e)}var og="_reactListening"+Math.random().toString(36).slice(2);function Ld(t){if(!t[og]){t[og]=!0,oL.forEach(function(n){n!=="selectionchange"&&(Dj.has(n)||SC(n,!1,t),SC(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[og]||(e[og]=!0,SC("selectionchange",!1,e))}}function ZL(t,e,n,r){switch(NL(e)){case 1:var i=KG;break;case 4:i=XG;break;default:i=GR}n=i.bind(null,e,n,t),i=void 0,!Db||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function bC(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;a!==null;){if(s=Sl(a),s===null)return;if(l=s.tag,l===5||l===6){r=o=s;continue e}a=a.parentNode}}r=r.return}SL(function(){var u=o,c=VR(n),h=[];e:{var f=qL.get(t);if(f!==void 0){var g=YR,p=t;switch(t){case"keypress":if(Nm(n)===0)break e;case"keydown":case"keyup":g=cj;break;case"focusin":p="focus",g=mC;break;case"focusout":p="blur",g=mC;break;case"beforeblur":case"afterblur":g=mC;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=JM;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=ZG;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=fj;break;case jL:case YL:case KL:g=tj;break;case XL:g=mj;break;case"scroll":g=qG;break;case"wheel":g=wj;break;case"copy":case"cut":case"paste":g=rj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=tx}var y=(e&4)!==0,E=!y&&t==="scroll",v=y?f!==null?f+"Capture":null:f;y=[];for(var C=u,S;C!==null;){S=C;var T=S.stateNode;if(S.tag===5&&T!==null&&(S=T,v!==null&&(T=Ad(C,v),T!=null&&y.push($d(C,T,S)))),E)break;C=C.return}0<y.length&&(f=new g(f,p,null,n,c),h.push({event:f,listeners:y}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",f&&n!==Ib&&(p=n.relatedTarget||n.fromElement)&&(Sl(p)||p[ms]))break e;if((g||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,g?(p=n.relatedTarget||n.toElement,g=u,p=p?Sl(p):null,p!==null&&(E=Gl(p),p!==E||p.tag!==5&&p.tag!==6)&&(p=null)):(g=null,p=u),g!==p)){if(y=JM,T="onMouseLeave",v="onMouseEnter",C="mouse",(t==="pointerout"||t==="pointerover")&&(y=tx,T="onPointerLeave",v="onPointerEnter",C="pointer"),E=g==null?f:Qu(g),S=p==null?f:Qu(p),f=new y(T,C+"leave",g,n,c),f.target=E,f.relatedTarget=S,T=null,Sl(c)===u&&(y=new y(v,C+"enter",p,n,c),y.target=S,y.relatedTarget=E,T=y),E=T,g&&p)t:{for(y=g,v=p,C=0,S=y;S;S=ru(S))C++;for(S=0,T=v;T;T=ru(T))S++;for(;0<C-S;)y=ru(y),C--;for(;0<S-C;)v=ru(v),S--;for(;C--;){if(y===v||v!==null&&y===v.alternate)break t;y=ru(y),v=ru(v)}y=null}else y=null;g!==null&&dx(h,f,g,y,!1),p!==null&&E!==null&&dx(h,E,p,y,!0)}}e:{if(f=u?Qu(u):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var _=Ej;else if(ix(f))if(VL)_=xj;else{_=_j;var H=Tj}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(_=Mj);if(_&&(_=_(t,u))){WL(h,_,n,c);break e}H&&H(t,f,u),t==="focusout"&&(H=f._wrapperState)&&H.controlled&&f.type==="number"&&Mb(f,"number",f.value)}switch(H=u?Qu(u):window,t){case"focusin":(ix(H)||H.contentEditable==="true")&&(Xu=H,Fb=u,sd=null);break;case"focusout":sd=Fb=Xu=null;break;case"mousedown":Wb=!0;break;case"contextmenu":case"mouseup":case"dragend":Wb=!1,ux(h,n,c);break;case"selectionchange":if(Aj)break;case"keydown":case"keyup":ux(h,n,c)}var D;if(XR)e:{switch(t){case"compositionstart":var B="onCompositionStart";break e;case"compositionend":B="onCompositionEnd";break e;case"compositionupdate":B="onCompositionUpdate";break e}B=void 0}else Ku?$L(t,n)&&(B="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(B="onCompositionStart");B&&(LL&&n.locale!=="ko"&&(Ku||B!=="onCompositionStart"?B==="onCompositionEnd"&&Ku&&(D=kL()):(Js=c,jR="value"in Js?Js.value:Js.textContent,Ku=!0)),H=Ep(u,B),0<H.length&&(B=new ex(B,t,null,n,c),h.push({event:B,listeners:H}),D?B.data=D:(D=FL(n),D!==null&&(B.data=D)))),(D=Cj?yj(t,n):Sj(t,n))&&(u=Ep(u,"onBeforeInput"),0<u.length&&(c=new ex("onBeforeInput","beforeinput",null,n,c),h.push({event:c,listeners:u}),c.data=D))}QL(h,e)})}function $d(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ep(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Ad(t,n),o!=null&&r.unshift($d(t,o,i)),o=Ad(t,e),o!=null&&r.push($d(t,o,i))),t=t.return}return r}function ru(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function dx(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=Ad(n,o),l!=null&&s.unshift($d(n,l,a))):i||(l=Ad(n,o),l!=null&&s.push($d(n,l,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var Nj=/\r\n?/g,kj=/\u0000|\uFFFD/g;function fx(t){return(typeof t=="string"?t:""+t).replace(Nj,`
`).replace(kj,"")}function sg(t,e,n){if(e=fx(e),fx(t)!==e&&n)throw Error(ie(425))}function Tp(){}var Vb=null,Bb=null;function Ub(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var zb=typeof setTimeout=="function"?setTimeout:void 0,Lj=typeof clearTimeout=="function"?clearTimeout:void 0,gx=typeof Promise=="function"?Promise:void 0,$j=typeof queueMicrotask=="function"?queueMicrotask:typeof gx<"u"?function(t){return gx.resolve(null).then(t).catch(Fj)}:zb;function Fj(t){setTimeout(function(){throw t})}function RC(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Dd(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Dd(e)}function ua(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function mx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Lc=Math.random().toString(36).slice(2),vo="__reactFiber$"+Lc,Fd="__reactProps$"+Lc,ms="__reactContainer$"+Lc,Gb="__reactEvents$"+Lc,Wj="__reactListeners$"+Lc,Vj="__reactHandles$"+Lc;function Sl(t){var e=t[vo];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ms]||n[vo]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=mx(t);t!==null;){if(n=t[vo])return n;t=mx(t)}return e}t=n,n=t.parentNode}return null}function Sf(t){return t=t[vo]||t[ms],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Qu(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ie(33))}function $w(t){return t[Fd]||null}var jb=[],Zu=-1;function Aa(t){return{current:t}}function Ot(t){0>Zu||(t.current=jb[Zu],jb[Zu]=null,Zu--)}function Tt(t,e){Zu++,jb[Zu]=t.current,t.current=e}var Sa={},qn=Aa(Sa),Ir=Aa(!1),Hl=Sa;function bc(t,e){var n=t.type.contextTypes;if(!n)return Sa;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Hr(t){return t=t.childContextTypes,t!=null}function _p(){Ot(Ir),Ot(qn)}function px(t,e,n){if(qn.current!==Sa)throw Error(ie(168));Tt(qn,e),Tt(Ir,n)}function JL(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ie(108,TG(t)||"Unknown",i));return Xt({},n,r)}function Mp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Sa,Hl=qn.current,Tt(qn,t),Tt(Ir,Ir.current),!0}function wx(t,e,n){var r=t.stateNode;if(!r)throw Error(ie(169));n?(t=JL(t,e,Hl),r.__reactInternalMemoizedMergedChildContext=t,Ot(Ir),Ot(qn),Tt(qn,t)):Ot(Ir),Tt(Ir,n)}var es=null,Fw=!1,EC=!1;function e$(t){es===null?es=[t]:es.push(t)}function Bj(t){Fw=!0,e$(t)}function Ia(){if(!EC&&es!==null){EC=!0;var t=0,e=pt;try{var n=es;for(pt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}es=null,Fw=!1}catch(i){throw es!==null&&(es=es.slice(t+1)),TL(BR,Ia),i}finally{pt=e,EC=!1}}return null}var Ju=[],ec=0,xp=null,Pp=0,li=[],ui=0,Dl=null,ts=1,ns="";function wl(t,e){Ju[ec++]=Pp,Ju[ec++]=xp,xp=t,Pp=e}function t$(t,e,n){li[ui++]=ts,li[ui++]=ns,li[ui++]=Dl,Dl=t;var r=ts;t=ns;var i=32-Vi(r)-1;r&=~(1<<i),n+=1;var o=32-Vi(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,ts=1<<32-Vi(e)+i|n<<i|r,ns=o+t}else ts=1<<o|n<<i|r,ns=t}function QR(t){t.return!==null&&(wl(t,1),t$(t,1,0))}function ZR(t){for(;t===xp;)xp=Ju[--ec],Ju[ec]=null,Pp=Ju[--ec],Ju[ec]=null;for(;t===Dl;)Dl=li[--ui],li[ui]=null,ns=li[--ui],li[ui]=null,ts=li[--ui],li[ui]=null}var Gr=null,Ur=null,$t=!1,ki=null;function n$(t,e){var n=hi(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function vx(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Gr=t,Ur=ua(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Gr=t,Ur=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Dl!==null?{id:ts,overflow:ns}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=hi(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Gr=t,Ur=null,!0):!1;default:return!1}}function Yb(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Kb(t){if($t){var e=Ur;if(e){var n=e;if(!vx(t,e)){if(Yb(t))throw Error(ie(418));e=ua(n.nextSibling);var r=Gr;e&&vx(t,e)?n$(r,n):(t.flags=t.flags&-4097|2,$t=!1,Gr=t)}}else{if(Yb(t))throw Error(ie(418));t.flags=t.flags&-4097|2,$t=!1,Gr=t}}}function Cx(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Gr=t}function ag(t){if(t!==Gr)return!1;if(!$t)return Cx(t),$t=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ub(t.type,t.memoizedProps)),e&&(e=Ur)){if(Yb(t))throw r$(),Error(ie(418));for(;e;)n$(t,e),e=ua(e.nextSibling)}if(Cx(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ie(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ur=ua(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ur=null}}else Ur=Gr?ua(t.stateNode.nextSibling):null;return!0}function r$(){for(var t=Ur;t;)t=ua(t.nextSibling)}function Rc(){Ur=Gr=null,$t=!1}function JR(t){ki===null?ki=[t]:ki.push(t)}var Uj=bs.ReactCurrentBatchConfig;function Hi(t,e){if(t&&t.defaultProps){e=Xt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Op=Aa(null),Ap=null,tc=null,eE=null;function tE(){eE=tc=Ap=null}function nE(t){var e=Op.current;Ot(Op),t._currentValue=e}function Xb(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function gc(t,e){Ap=t,eE=tc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ar=!0),t.firstContext=null)}function fi(t){var e=t._currentValue;if(eE!==t)if(t={context:t,memoizedValue:e,next:null},tc===null){if(Ap===null)throw Error(ie(308));tc=t,Ap.dependencies={lanes:0,firstContext:t}}else tc=tc.next=t;return e}var bl=null;function rE(t){bl===null?bl=[t]:bl.push(t)}function i$(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,rE(e)):(n.next=i.next,i.next=n),e.interleaved=n,ps(t,r)}function ps(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ys=!1;function iE(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function o$(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ds(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ca(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,st&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ps(t,n)}return i=r.interleaved,i===null?(e.next=e,rE(r)):(e.next=i.next,i.next=e),r.interleaved=e,ps(t,n)}function km(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,UR(t,n)}}function yx(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ip(t,e,n,r){var i=t.updateQueue;Ys=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,s===null?o=u:s.next=u,s=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==s&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(o!==null){var h=i.baseState;s=0,c=u=l=null,a=o;do{var f=a.lane,g=a.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,y=a;switch(f=e,g=n,y.tag){case 1:if(p=y.payload,typeof p=="function"){h=p.call(g,h,f);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=y.payload,f=typeof p=="function"?p.call(g,h,f):p,f==null)break e;h=Xt({},h,f);break e;case 2:Ys=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else g={eventTime:g,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=g,l=h):c=c.next=g,s|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(1);if(c===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);kl|=s,t.lanes=s,t.memoizedState=h}}function Sx(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ie(191,i));i.call(r)}}}var s$=new iL.Component().refs;function qb(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Xt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ww={isMounted:function(t){return(t=t._reactInternals)?Gl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=fr(),i=da(t),o=ds(r,i);o.payload=e,n!=null&&(o.callback=n),e=ca(t,o,i),e!==null&&(Bi(e,t,i,r),km(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=fr(),i=da(t),o=ds(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=ca(t,o,i),e!==null&&(Bi(e,t,i,r),km(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=fr(),r=da(t),i=ds(n,r);i.tag=2,e!=null&&(i.callback=e),e=ca(t,i,r),e!==null&&(Bi(e,t,r,n),km(e,t,r))}};function bx(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!kd(n,r)||!kd(i,o):!0}function a$(t,e,n){var r=!1,i=Sa,o=e.contextType;return typeof o=="object"&&o!==null?o=fi(o):(i=Hr(e)?Hl:qn.current,r=e.contextTypes,o=(r=r!=null)?bc(t,i):Sa),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ww,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function Rx(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ww.enqueueReplaceState(e,e.state,null)}function Qb(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=s$,iE(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=fi(o):(o=Hr(e)?Hl:qn.current,i.context=bc(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(qb(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Ww.enqueueReplaceState(i,i.state,null),Ip(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function rh(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ie(309));var r=n.stateNode}if(!r)throw Error(ie(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=i.refs;a===s$&&(a=i.refs={}),s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(ie(284));if(!n._owner)throw Error(ie(290,t))}return t}function lg(t,e){throw t=Object.prototype.toString.call(e),Error(ie(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ex(t){var e=t._init;return e(t._payload)}function l$(t){function e(v,C){if(t){var S=v.deletions;S===null?(v.deletions=[C],v.flags|=16):S.push(C)}}function n(v,C){if(!t)return null;for(;C!==null;)e(v,C),C=C.sibling;return null}function r(v,C){for(v=new Map;C!==null;)C.key!==null?v.set(C.key,C):v.set(C.index,C),C=C.sibling;return v}function i(v,C){return v=fa(v,C),v.index=0,v.sibling=null,v}function o(v,C,S){return v.index=S,t?(S=v.alternate,S!==null?(S=S.index,S<C?(v.flags|=2,C):S):(v.flags|=2,C)):(v.flags|=1048576,C)}function s(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,C,S,T){return C===null||C.tag!==6?(C=AC(S,v.mode,T),C.return=v,C):(C=i(C,S),C.return=v,C)}function l(v,C,S,T){var _=S.type;return _===Yu?c(v,C,S.props.children,T,S.key):C!==null&&(C.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===js&&Ex(_)===C.type)?(T=i(C,S.props),T.ref=rh(v,C,S),T.return=v,T):(T=Bm(S.type,S.key,S.props,null,v.mode,T),T.ref=rh(v,C,S),T.return=v,T)}function u(v,C,S,T){return C===null||C.tag!==4||C.stateNode.containerInfo!==S.containerInfo||C.stateNode.implementation!==S.implementation?(C=IC(S,v.mode,T),C.return=v,C):(C=i(C,S.children||[]),C.return=v,C)}function c(v,C,S,T,_){return C===null||C.tag!==7?(C=Al(S,v.mode,T,_),C.return=v,C):(C=i(C,S),C.return=v,C)}function h(v,C,S){if(typeof C=="string"&&C!==""||typeof C=="number")return C=AC(""+C,v.mode,S),C.return=v,C;if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Qf:return S=Bm(C.type,C.key,C.props,null,v.mode,S),S.ref=rh(v,null,C),S.return=v,S;case ju:return C=IC(C,v.mode,S),C.return=v,C;case js:var T=C._init;return h(v,T(C._payload),S)}if(Yh(C)||Zc(C))return C=Al(C,v.mode,S,null),C.return=v,C;lg(v,C)}return null}function f(v,C,S,T){var _=C!==null?C.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return _!==null?null:a(v,C,""+S,T);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Qf:return S.key===_?l(v,C,S,T):null;case ju:return S.key===_?u(v,C,S,T):null;case js:return _=S._init,f(v,C,_(S._payload),T)}if(Yh(S)||Zc(S))return _!==null?null:c(v,C,S,T,null);lg(v,S)}return null}function g(v,C,S,T,_){if(typeof T=="string"&&T!==""||typeof T=="number")return v=v.get(S)||null,a(C,v,""+T,_);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Qf:return v=v.get(T.key===null?S:T.key)||null,l(C,v,T,_);case ju:return v=v.get(T.key===null?S:T.key)||null,u(C,v,T,_);case js:var H=T._init;return g(v,C,S,H(T._payload),_)}if(Yh(T)||Zc(T))return v=v.get(S)||null,c(C,v,T,_,null);lg(C,T)}return null}function p(v,C,S,T){for(var _=null,H=null,D=C,B=C=0,z=null;D!==null&&B<S.length;B++){D.index>B?(z=D,D=null):z=D.sibling;var G=f(v,D,S[B],T);if(G===null){D===null&&(D=z);break}t&&D&&G.alternate===null&&e(v,D),C=o(G,C,B),H===null?_=G:H.sibling=G,H=G,D=z}if(B===S.length)return n(v,D),$t&&wl(v,B),_;if(D===null){for(;B<S.length;B++)D=h(v,S[B],T),D!==null&&(C=o(D,C,B),H===null?_=D:H.sibling=D,H=D);return $t&&wl(v,B),_}for(D=r(v,D);B<S.length;B++)z=g(D,v,B,S[B],T),z!==null&&(t&&z.alternate!==null&&D.delete(z.key===null?B:z.key),C=o(z,C,B),H===null?_=z:H.sibling=z,H=z);return t&&D.forEach(function(Z){return e(v,Z)}),$t&&wl(v,B),_}function y(v,C,S,T){var _=Zc(S);if(typeof _!="function")throw Error(ie(150));if(S=_.call(S),S==null)throw Error(ie(151));for(var H=_=null,D=C,B=C=0,z=null,G=S.next();D!==null&&!G.done;B++,G=S.next()){D.index>B?(z=D,D=null):z=D.sibling;var Z=f(v,D,G.value,T);if(Z===null){D===null&&(D=z);break}t&&D&&Z.alternate===null&&e(v,D),C=o(Z,C,B),H===null?_=Z:H.sibling=Z,H=Z,D=z}if(G.done)return n(v,D),$t&&wl(v,B),_;if(D===null){for(;!G.done;B++,G=S.next())G=h(v,G.value,T),G!==null&&(C=o(G,C,B),H===null?_=G:H.sibling=G,H=G);return $t&&wl(v,B),_}for(D=r(v,D);!G.done;B++,G=S.next())G=g(D,v,B,G.value,T),G!==null&&(t&&G.alternate!==null&&D.delete(G.key===null?B:G.key),C=o(G,C,B),H===null?_=G:H.sibling=G,H=G);return t&&D.forEach(function(re){return e(v,re)}),$t&&wl(v,B),_}function E(v,C,S,T){if(typeof S=="object"&&S!==null&&S.type===Yu&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Qf:e:{for(var _=S.key,H=C;H!==null;){if(H.key===_){if(_=S.type,_===Yu){if(H.tag===7){n(v,H.sibling),C=i(H,S.props.children),C.return=v,v=C;break e}}else if(H.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===js&&Ex(_)===H.type){n(v,H.sibling),C=i(H,S.props),C.ref=rh(v,H,S),C.return=v,v=C;break e}n(v,H);break}else e(v,H);H=H.sibling}S.type===Yu?(C=Al(S.props.children,v.mode,T,S.key),C.return=v,v=C):(T=Bm(S.type,S.key,S.props,null,v.mode,T),T.ref=rh(v,C,S),T.return=v,v=T)}return s(v);case ju:e:{for(H=S.key;C!==null;){if(C.key===H)if(C.tag===4&&C.stateNode.containerInfo===S.containerInfo&&C.stateNode.implementation===S.implementation){n(v,C.sibling),C=i(C,S.children||[]),C.return=v,v=C;break e}else{n(v,C);break}else e(v,C);C=C.sibling}C=IC(S,v.mode,T),C.return=v,v=C}return s(v);case js:return H=S._init,E(v,C,H(S._payload),T)}if(Yh(S))return p(v,C,S,T);if(Zc(S))return y(v,C,S,T);lg(v,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,C!==null&&C.tag===6?(n(v,C.sibling),C=i(C,S),C.return=v,v=C):(n(v,C),C=AC(S,v.mode,T),C.return=v,v=C),s(v)):n(v,C)}return E}var Ec=l$(!0),u$=l$(!1),bf={},Ro=Aa(bf),Wd=Aa(bf),Vd=Aa(bf);function Rl(t){if(t===bf)throw Error(ie(174));return t}function oE(t,e){switch(Tt(Vd,e),Tt(Wd,t),Tt(Ro,bf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Pb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Pb(e,t)}Ot(Ro),Tt(Ro,e)}function Tc(){Ot(Ro),Ot(Wd),Ot(Vd)}function c$(t){Rl(Vd.current);var e=Rl(Ro.current),n=Pb(e,t.type);e!==n&&(Tt(Wd,t),Tt(Ro,n))}function sE(t){Wd.current===t&&(Ot(Ro),Ot(Wd))}var zt=Aa(0);function Hp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var TC=[];function aE(){for(var t=0;t<TC.length;t++)TC[t]._workInProgressVersionPrimary=null;TC.length=0}var Lm=bs.ReactCurrentDispatcher,_C=bs.ReactCurrentBatchConfig,Nl=0,Kt=null,wn=null,Tn=null,Dp=!1,ad=!1,Bd=0,zj=0;function Wn(){throw Error(ie(321))}function lE(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!zi(t[n],e[n]))return!1;return!0}function uE(t,e,n,r,i,o){if(Nl=o,Kt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Lm.current=t===null||t.memoizedState===null?Kj:Xj,t=n(r,i),ad){o=0;do{if(ad=!1,Bd=0,25<=o)throw Error(ie(301));o+=1,Tn=wn=null,e.updateQueue=null,Lm.current=qj,t=n(r,i)}while(ad)}if(Lm.current=Np,e=wn!==null&&wn.next!==null,Nl=0,Tn=wn=Kt=null,Dp=!1,e)throw Error(ie(300));return t}function cE(){var t=Bd!==0;return Bd=0,t}function go(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tn===null?Kt.memoizedState=Tn=t:Tn=Tn.next=t,Tn}function gi(){if(wn===null){var t=Kt.alternate;t=t!==null?t.memoizedState:null}else t=wn.next;var e=Tn===null?Kt.memoizedState:Tn.next;if(e!==null)Tn=e,wn=t;else{if(t===null)throw Error(ie(310));wn=t,t={memoizedState:wn.memoizedState,baseState:wn.baseState,baseQueue:wn.baseQueue,queue:wn.queue,next:null},Tn===null?Kt.memoizedState=Tn=t:Tn=Tn.next=t}return Tn}function Ud(t,e){return typeof e=="function"?e(t):e}function MC(t){var e=gi(),n=e.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=t;var r=wn,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,l=null,u=o;do{var c=u.lane;if((Nl&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,s=r):l=l.next=h,Kt.lanes|=c,kl|=c}u=u.next}while(u!==null&&u!==o);l===null?s=r:l.next=a,zi(r,e.memoizedState)||(Ar=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,Kt.lanes|=o,kl|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function xC(t){var e=gi(),n=e.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);zi(o,e.memoizedState)||(Ar=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function h$(){}function d$(t,e){var n=Kt,r=gi(),i=e(),o=!zi(r.memoizedState,i);if(o&&(r.memoizedState=i,Ar=!0),r=r.queue,hE(m$.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Tn!==null&&Tn.memoizedState.tag&1){if(n.flags|=2048,zd(9,g$.bind(null,n,r,i,e),void 0,null),Mn===null)throw Error(ie(349));Nl&30||f$(n,e,i)}return i}function f$(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Kt.updateQueue,e===null?(e={lastEffect:null,stores:null},Kt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function g$(t,e,n,r){e.value=n,e.getSnapshot=r,p$(e)&&w$(t)}function m$(t,e,n){return n(function(){p$(e)&&w$(t)})}function p$(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!zi(t,n)}catch{return!0}}function w$(t){var e=ps(t,1);e!==null&&Bi(e,t,1,-1)}function Tx(t){var e=go();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ud,lastRenderedState:t},e.queue=t,t=t.dispatch=Yj.bind(null,Kt,t),[e.memoizedState,t]}function zd(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Kt.updateQueue,e===null?(e={lastEffect:null,stores:null},Kt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function v$(){return gi().memoizedState}function $m(t,e,n,r){var i=go();Kt.flags|=t,i.memoizedState=zd(1|e,n,void 0,r===void 0?null:r)}function Vw(t,e,n,r){var i=gi();r=r===void 0?null:r;var o=void 0;if(wn!==null){var s=wn.memoizedState;if(o=s.destroy,r!==null&&lE(r,s.deps)){i.memoizedState=zd(e,n,o,r);return}}Kt.flags|=t,i.memoizedState=zd(1|e,n,o,r)}function _x(t,e){return $m(8390656,8,t,e)}function hE(t,e){return Vw(2048,8,t,e)}function C$(t,e){return Vw(4,2,t,e)}function y$(t,e){return Vw(4,4,t,e)}function S$(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function b$(t,e,n){return n=n!=null?n.concat([t]):null,Vw(4,4,S$.bind(null,e,t),n)}function dE(){}function R$(t,e){var n=gi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&lE(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function E$(t,e){var n=gi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&lE(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function T$(t,e,n){return Nl&21?(zi(n,e)||(n=xL(),Kt.lanes|=n,kl|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ar=!0),t.memoizedState=n)}function Gj(t,e){var n=pt;pt=n!==0&&4>n?n:4,t(!0);var r=_C.transition;_C.transition={};try{t(!1),e()}finally{pt=n,_C.transition=r}}function _$(){return gi().memoizedState}function jj(t,e,n){var r=da(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},M$(t))x$(e,n);else if(n=i$(t,e,n,r),n!==null){var i=fr();Bi(n,t,r,i),P$(n,e,r)}}function Yj(t,e,n){var r=da(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(M$(t))x$(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,zi(a,s)){var l=e.interleaved;l===null?(i.next=i,rE(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=i$(t,e,i,r),n!==null&&(i=fr(),Bi(n,t,r,i),P$(n,e,r))}}function M$(t){var e=t.alternate;return t===Kt||e!==null&&e===Kt}function x$(t,e){ad=Dp=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function P$(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,UR(t,n)}}var Np={readContext:fi,useCallback:Wn,useContext:Wn,useEffect:Wn,useImperativeHandle:Wn,useInsertionEffect:Wn,useLayoutEffect:Wn,useMemo:Wn,useReducer:Wn,useRef:Wn,useState:Wn,useDebugValue:Wn,useDeferredValue:Wn,useTransition:Wn,useMutableSource:Wn,useSyncExternalStore:Wn,useId:Wn,unstable_isNewReconciler:!1},Kj={readContext:fi,useCallback:function(t,e){return go().memoizedState=[t,e===void 0?null:e],t},useContext:fi,useEffect:_x,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,$m(4194308,4,S$.bind(null,e,t),n)},useLayoutEffect:function(t,e){return $m(4194308,4,t,e)},useInsertionEffect:function(t,e){return $m(4,2,t,e)},useMemo:function(t,e){var n=go();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=go();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=jj.bind(null,Kt,t),[r.memoizedState,t]},useRef:function(t){var e=go();return t={current:t},e.memoizedState=t},useState:Tx,useDebugValue:dE,useDeferredValue:function(t){return go().memoizedState=t},useTransition:function(){var t=Tx(!1),e=t[0];return t=Gj.bind(null,t[1]),go().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Kt,i=go();if($t){if(n===void 0)throw Error(ie(407));n=n()}else{if(n=e(),Mn===null)throw Error(ie(349));Nl&30||f$(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,_x(m$.bind(null,r,o,t),[t]),r.flags|=2048,zd(9,g$.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=go(),e=Mn.identifierPrefix;if($t){var n=ns,r=ts;n=(r&~(1<<32-Vi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Bd++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=zj++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Xj={readContext:fi,useCallback:R$,useContext:fi,useEffect:hE,useImperativeHandle:b$,useInsertionEffect:C$,useLayoutEffect:y$,useMemo:E$,useReducer:MC,useRef:v$,useState:function(){return MC(Ud)},useDebugValue:dE,useDeferredValue:function(t){var e=gi();return T$(e,wn.memoizedState,t)},useTransition:function(){var t=MC(Ud)[0],e=gi().memoizedState;return[t,e]},useMutableSource:h$,useSyncExternalStore:d$,useId:_$,unstable_isNewReconciler:!1},qj={readContext:fi,useCallback:R$,useContext:fi,useEffect:hE,useImperativeHandle:b$,useInsertionEffect:C$,useLayoutEffect:y$,useMemo:E$,useReducer:xC,useRef:v$,useState:function(){return xC(Ud)},useDebugValue:dE,useDeferredValue:function(t){var e=gi();return wn===null?e.memoizedState=t:T$(e,wn.memoizedState,t)},useTransition:function(){var t=xC(Ud)[0],e=gi().memoizedState;return[t,e]},useMutableSource:h$,useSyncExternalStore:d$,useId:_$,unstable_isNewReconciler:!1};function _c(t,e){try{var n="",r=e;do n+=EG(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function PC(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Zb(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Qj=typeof WeakMap=="function"?WeakMap:Map;function O$(t,e,n){n=ds(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Lp||(Lp=!0,l0=r),Zb(t,e)},n}function A$(t,e,n){n=ds(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Zb(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Zb(t,e),typeof r!="function"&&(ha===null?ha=new Set([this]):ha.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function Mx(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Qj;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=hY.bind(null,t,e,n),e.then(t,t))}function xx(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Px(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ds(-1,1),e.tag=2,ca(n,e,1))),n.lanes|=1),t)}var Zj=bs.ReactCurrentOwner,Ar=!1;function cr(t,e,n,r){e.child=t===null?u$(e,null,n,r):Ec(e,t.child,n,r)}function Ox(t,e,n,r,i){n=n.render;var o=e.ref;return gc(e,i),r=uE(t,e,n,r,o,i),n=cE(),t!==null&&!Ar?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ws(t,e,i)):($t&&n&&QR(e),e.flags|=1,cr(t,e,r,i),e.child)}function Ax(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!yE(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,I$(t,e,o,r,i)):(t=Bm(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:kd,n(s,r)&&t.ref===e.ref)return ws(t,e,i)}return e.flags|=1,t=fa(o,r),t.ref=e.ref,t.return=e,e.child=t}function I$(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(kd(o,r)&&t.ref===e.ref)if(Ar=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(Ar=!0);else return e.lanes=t.lanes,ws(t,e,i)}return Jb(t,e,n,r,i)}function H$(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tt(rc,Wr),Wr|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Tt(rc,Wr),Wr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Tt(rc,Wr),Wr|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,Tt(rc,Wr),Wr|=r;return cr(t,e,i,n),e.child}function D$(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Jb(t,e,n,r,i){var o=Hr(n)?Hl:qn.current;return o=bc(e,o),gc(e,i),n=uE(t,e,n,r,o,i),r=cE(),t!==null&&!Ar?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ws(t,e,i)):($t&&r&&QR(e),e.flags|=1,cr(t,e,n,i),e.child)}function Ix(t,e,n,r,i){if(Hr(n)){var o=!0;Mp(e)}else o=!1;if(gc(e,i),e.stateNode===null)Fm(t,e),a$(e,n,r),Qb(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,u=n.contextType;typeof u=="object"&&u!==null?u=fi(u):(u=Hr(n)?Hl:qn.current,u=bc(e,u));var c=n.getDerivedStateFromProps,h=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";h||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==u)&&Rx(e,s,r,u),Ys=!1;var f=e.memoizedState;s.state=f,Ip(e,r,s,i),l=e.memoizedState,a!==r||f!==l||Ir.current||Ys?(typeof c=="function"&&(qb(e,n,c,r),l=e.memoizedState),(a=Ys||bx(e,n,a,r,f,l,u))?(h||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=u,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,o$(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Hi(e.type,a),s.props=u,h=e.pendingProps,f=s.context,l=n.contextType,typeof l=="object"&&l!==null?l=fi(l):(l=Hr(n)?Hl:qn.current,l=bc(e,l));var g=n.getDerivedStateFromProps;(c=typeof g=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==h||f!==l)&&Rx(e,s,r,l),Ys=!1,f=e.memoizedState,s.state=f,Ip(e,r,s,i);var p=e.memoizedState;a!==h||f!==p||Ir.current||Ys?(typeof g=="function"&&(qb(e,n,g,r),p=e.memoizedState),(u=Ys||bx(e,n,u,r,f,p,l)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),s.props=r,s.state=p,s.context=l,r=u):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return e0(t,e,n,r,o,i)}function e0(t,e,n,r,i,o){D$(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&wx(e,n,!1),ws(t,e,o);r=e.stateNode,Zj.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=Ec(e,t.child,null,o),e.child=Ec(e,null,a,o)):cr(t,e,a,o),e.memoizedState=r.state,i&&wx(e,n,!0),e.child}function N$(t){var e=t.stateNode;e.pendingContext?px(t,e.pendingContext,e.pendingContext!==e.context):e.context&&px(t,e.context,!1),oE(t,e.containerInfo)}function Hx(t,e,n,r,i){return Rc(),JR(i),e.flags|=256,cr(t,e,n,r),e.child}var t0={dehydrated:null,treeContext:null,retryLane:0};function n0(t){return{baseLanes:t,cachePool:null,transitions:null}}function k$(t,e,n){var r=e.pendingProps,i=zt.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Tt(zt,i&1),t===null)return Kb(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=zw(s,r,0,null),t=Al(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=n0(n),e.memoizedState=t0,t):fE(e,s));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return Jj(t,e,s,r,a,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=fa(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=fa(a,o):(o=Al(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?n0(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=t0,r}return o=t.child,t=o.sibling,r=fa(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function fE(t,e){return e=zw({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ug(t,e,n,r){return r!==null&&JR(r),Ec(e,t.child,null,n),t=fE(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Jj(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=PC(Error(ie(422))),ug(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=zw({mode:"visible",children:r.children},i,0,null),o=Al(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&Ec(e,t.child,null,s),e.child.memoizedState=n0(s),e.memoizedState=t0,o);if(!(e.mode&1))return ug(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(ie(419)),r=PC(o,r,void 0),ug(t,e,s,r)}if(a=(s&t.childLanes)!==0,Ar||a){if(r=Mn,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,ps(t,i),Bi(r,t,i,-1))}return CE(),r=PC(Error(ie(421))),ug(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=dY.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,Ur=ua(i.nextSibling),Gr=e,$t=!0,ki=null,t!==null&&(li[ui++]=ts,li[ui++]=ns,li[ui++]=Dl,ts=t.id,ns=t.overflow,Dl=e),e=fE(e,r.children),e.flags|=4096,e)}function Dx(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Xb(t.return,e,n)}function OC(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function L$(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(cr(t,e,r.children,n),r=zt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Dx(t,n,e);else if(t.tag===19)Dx(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Tt(zt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Hp(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),OC(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Hp(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}OC(e,!0,n,null,o);break;case"together":OC(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Fm(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ws(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),kl|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ie(153));if(e.child!==null){for(t=e.child,n=fa(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=fa(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function eY(t,e,n){switch(e.tag){case 3:N$(e),Rc();break;case 5:c$(e);break;case 1:Hr(e.type)&&Mp(e);break;case 4:oE(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Tt(Op,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Tt(zt,zt.current&1),e.flags|=128,null):n&e.child.childLanes?k$(t,e,n):(Tt(zt,zt.current&1),t=ws(t,e,n),t!==null?t.sibling:null);Tt(zt,zt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return L$(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Tt(zt,zt.current),r)break;return null;case 22:case 23:return e.lanes=0,H$(t,e,n)}return ws(t,e,n)}var $$,r0,F$,W$;$$=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};r0=function(){};F$=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Rl(Ro.current);var o=null;switch(n){case"input":i=Tb(t,i),r=Tb(t,r),o=[];break;case"select":i=Xt({},i,{value:void 0}),r=Xt({},r,{value:void 0}),o=[];break;case"textarea":i=xb(t,i),r=xb(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Tp)}Ob(n,r);var s;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Pd.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Pd.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&xt("scroll",t),o||a===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};W$=function(t,e,n,r){n!==r&&(e.flags|=4)};function ih(t,e){if(!$t)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Vn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function tY(t,e,n){var r=e.pendingProps;switch(ZR(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vn(e),null;case 1:return Hr(e.type)&&_p(),Vn(e),null;case 3:return r=e.stateNode,Tc(),Ot(Ir),Ot(qn),aE(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ag(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ki!==null&&(h0(ki),ki=null))),r0(t,e),Vn(e),null;case 5:sE(e);var i=Rl(Vd.current);if(n=e.type,t!==null&&e.stateNode!=null)F$(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ie(166));return Vn(e),null}if(t=Rl(Ro.current),ag(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[vo]=e,r[Fd]=o,t=(e.mode&1)!==0,n){case"dialog":xt("cancel",r),xt("close",r);break;case"iframe":case"object":case"embed":xt("load",r);break;case"video":case"audio":for(i=0;i<Xh.length;i++)xt(Xh[i],r);break;case"source":xt("error",r);break;case"img":case"image":case"link":xt("error",r),xt("load",r);break;case"details":xt("toggle",r);break;case"input":UM(r,o),xt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},xt("invalid",r);break;case"textarea":GM(r,o),xt("invalid",r)}Ob(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&sg(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&sg(r.textContent,a,t),i=["children",""+a]):Pd.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&xt("scroll",r)}switch(n){case"input":Zf(r),zM(r,o,!0);break;case"textarea":Zf(r),jM(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Tp)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=fL(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[vo]=e,t[Fd]=r,$$(t,e,!1,!1),e.stateNode=t;e:{switch(s=Ab(n,r),n){case"dialog":xt("cancel",t),xt("close",t),i=r;break;case"iframe":case"object":case"embed":xt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Xh.length;i++)xt(Xh[i],t);i=r;break;case"source":xt("error",t),i=r;break;case"img":case"image":case"link":xt("error",t),xt("load",t),i=r;break;case"details":xt("toggle",t),i=r;break;case"input":UM(t,r),i=Tb(t,r),xt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Xt({},r,{value:void 0}),xt("invalid",t);break;case"textarea":GM(t,r),i=xb(t,r),xt("invalid",t);break;default:i=r}Ob(n,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?pL(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&gL(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Od(t,l):typeof l=="number"&&Od(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Pd.hasOwnProperty(o)?l!=null&&o==="onScroll"&&xt("scroll",t):l!=null&&LR(t,o,l,s))}switch(n){case"input":Zf(t),zM(t,r,!1);break;case"textarea":Zf(t),jM(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ya(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?cc(t,!!r.multiple,o,!1):r.defaultValue!=null&&cc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Tp)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Vn(e),null;case 6:if(t&&e.stateNode!=null)W$(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ie(166));if(n=Rl(Vd.current),Rl(Ro.current),ag(e)){if(r=e.stateNode,n=e.memoizedProps,r[vo]=e,(o=r.nodeValue!==n)&&(t=Gr,t!==null))switch(t.tag){case 3:sg(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&sg(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[vo]=e,e.stateNode=r}return Vn(e),null;case 13:if(Ot(zt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if($t&&Ur!==null&&e.mode&1&&!(e.flags&128))r$(),Rc(),e.flags|=98560,o=!1;else if(o=ag(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(ie(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ie(317));o[vo]=e}else Rc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Vn(e),o=!1}else ki!==null&&(h0(ki),ki=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||zt.current&1?vn===0&&(vn=3):CE())),e.updateQueue!==null&&(e.flags|=4),Vn(e),null);case 4:return Tc(),r0(t,e),t===null&&Ld(e.stateNode.containerInfo),Vn(e),null;case 10:return nE(e.type._context),Vn(e),null;case 17:return Hr(e.type)&&_p(),Vn(e),null;case 19:if(Ot(zt),o=e.memoizedState,o===null)return Vn(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)ih(o,!1);else{if(vn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=Hp(t),s!==null){for(e.flags|=128,ih(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Tt(zt,zt.current&1|2),e.child}t=t.sibling}o.tail!==null&&rn()>Mc&&(e.flags|=128,r=!0,ih(o,!1),e.lanes=4194304)}else{if(!r)if(t=Hp(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ih(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!$t)return Vn(e),null}else 2*rn()-o.renderingStartTime>Mc&&n!==1073741824&&(e.flags|=128,r=!0,ih(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=rn(),e.sibling=null,n=zt.current,Tt(zt,r?n&1|2:n&1),e):(Vn(e),null);case 22:case 23:return vE(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Wr&1073741824&&(Vn(e),e.subtreeFlags&6&&(e.flags|=8192)):Vn(e),null;case 24:return null;case 25:return null}throw Error(ie(156,e.tag))}function nY(t,e){switch(ZR(e),e.tag){case 1:return Hr(e.type)&&_p(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Tc(),Ot(Ir),Ot(qn),aE(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return sE(e),null;case 13:if(Ot(zt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ie(340));Rc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ot(zt),null;case 4:return Tc(),null;case 10:return nE(e.type._context),null;case 22:case 23:return vE(),null;case 24:return null;default:return null}}var cg=!1,jn=!1,rY=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function nc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Jt(t,e,r)}else n.current=null}function i0(t,e,n){try{n()}catch(r){Jt(t,e,r)}}var Nx=!1;function iY(t,e){if(Vb=bp,t=zL(),qR(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,u=0,c=0,h=t,f=null;t:for(;;){for(var g;h!==n||i!==0&&h.nodeType!==3||(a=s+i),h!==o||r!==0&&h.nodeType!==3||(l=s+r),h.nodeType===3&&(s+=h.nodeValue.length),(g=h.firstChild)!==null;)f=h,h=g;for(;;){if(h===t)break t;if(f===n&&++u===i&&(a=s),f===o&&++c===r&&(l=s),(g=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=g}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Bb={focusedElem:t,selectionRange:n},bp=!1,Ce=e;Ce!==null;)if(e=Ce,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ce=t;else for(;Ce!==null;){e=Ce;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var y=p.memoizedProps,E=p.memoizedState,v=e.stateNode,C=v.getSnapshotBeforeUpdate(e.elementType===e.type?y:Hi(e.type,y),E);v.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ie(163))}}catch(T){Jt(e,e.return,T)}if(t=e.sibling,t!==null){t.return=e.return,Ce=t;break}Ce=e.return}return p=Nx,Nx=!1,p}function ld(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&i0(e,n,o)}i=i.next}while(i!==r)}}function Bw(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function o0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function V$(t){var e=t.alternate;e!==null&&(t.alternate=null,V$(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[vo],delete e[Fd],delete e[Gb],delete e[Wj],delete e[Vj])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function B$(t){return t.tag===5||t.tag===3||t.tag===4}function kx(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||B$(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function s0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Tp));else if(r!==4&&(t=t.child,t!==null))for(s0(t,e,n),t=t.sibling;t!==null;)s0(t,e,n),t=t.sibling}function a0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(a0(t,e,n),t=t.sibling;t!==null;)a0(t,e,n),t=t.sibling}var Nn=null,Ni=!1;function As(t,e,n){for(n=n.child;n!==null;)U$(t,e,n),n=n.sibling}function U$(t,e,n){if(bo&&typeof bo.onCommitFiberUnmount=="function")try{bo.onCommitFiberUnmount(Dw,n)}catch{}switch(n.tag){case 5:jn||nc(n,e);case 6:var r=Nn,i=Ni;Nn=null,As(t,e,n),Nn=r,Ni=i,Nn!==null&&(Ni?(t=Nn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Nn.removeChild(n.stateNode));break;case 18:Nn!==null&&(Ni?(t=Nn,n=n.stateNode,t.nodeType===8?RC(t.parentNode,n):t.nodeType===1&&RC(t,n),Dd(t)):RC(Nn,n.stateNode));break;case 4:r=Nn,i=Ni,Nn=n.stateNode.containerInfo,Ni=!0,As(t,e,n),Nn=r,Ni=i;break;case 0:case 11:case 14:case 15:if(!jn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&i0(n,e,s),i=i.next}while(i!==r)}As(t,e,n);break;case 1:if(!jn&&(nc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Jt(n,e,a)}As(t,e,n);break;case 21:As(t,e,n);break;case 22:n.mode&1?(jn=(r=jn)||n.memoizedState!==null,As(t,e,n),jn=r):As(t,e,n);break;default:As(t,e,n)}}function Lx(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new rY),e.forEach(function(r){var i=fY.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function yi(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:Nn=a.stateNode,Ni=!1;break e;case 3:Nn=a.stateNode.containerInfo,Ni=!0;break e;case 4:Nn=a.stateNode.containerInfo,Ni=!0;break e}a=a.return}if(Nn===null)throw Error(ie(160));U$(o,s,i),Nn=null,Ni=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Jt(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)z$(e,t),e=e.sibling}function z$(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(yi(e,t),Qi(t),r&4){try{ld(3,t,t.return),Bw(3,t)}catch(y){Jt(t,t.return,y)}try{ld(5,t,t.return)}catch(y){Jt(t,t.return,y)}}break;case 1:yi(e,t),Qi(t),r&512&&n!==null&&nc(n,n.return);break;case 5:if(yi(e,t),Qi(t),r&512&&n!==null&&nc(n,n.return),t.flags&32){var i=t.stateNode;try{Od(i,"")}catch(y){Jt(t,t.return,y)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&hL(i,o),Ab(a,s);var u=Ab(a,o);for(s=0;s<l.length;s+=2){var c=l[s],h=l[s+1];c==="style"?pL(i,h):c==="dangerouslySetInnerHTML"?gL(i,h):c==="children"?Od(i,h):LR(i,c,h,u)}switch(a){case"input":_b(i,o);break;case"textarea":dL(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var g=o.value;g!=null?cc(i,!!o.multiple,g,!1):f!==!!o.multiple&&(o.defaultValue!=null?cc(i,!!o.multiple,o.defaultValue,!0):cc(i,!!o.multiple,o.multiple?[]:"",!1))}i[Fd]=o}catch(y){Jt(t,t.return,y)}}break;case 6:if(yi(e,t),Qi(t),r&4){if(t.stateNode===null)throw Error(ie(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(y){Jt(t,t.return,y)}}break;case 3:if(yi(e,t),Qi(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Dd(e.containerInfo)}catch(y){Jt(t,t.return,y)}break;case 4:yi(e,t),Qi(t);break;case 13:yi(e,t),Qi(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(pE=rn())),r&4&&Lx(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(jn=(u=jn)||c,yi(e,t),jn=u):yi(e,t),Qi(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(Ce=t,c=t.child;c!==null;){for(h=Ce=c;Ce!==null;){switch(f=Ce,g=f.child,f.tag){case 0:case 11:case 14:case 15:ld(4,f,f.return);break;case 1:nc(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(y){Jt(r,n,y)}}break;case 5:nc(f,f.return);break;case 22:if(f.memoizedState!==null){Fx(h);continue}}g!==null?(g.return=f,Ce=g):Fx(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,u?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=h.stateNode,l=h.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=mL("display",s))}catch(y){Jt(t,t.return,y)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(y){Jt(t,t.return,y)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:yi(e,t),Qi(t),r&4&&Lx(t);break;case 21:break;default:yi(e,t),Qi(t)}}function Qi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(B$(n)){var r=n;break e}n=n.return}throw Error(ie(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Od(i,""),r.flags&=-33);var o=kx(t);a0(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=kx(t);s0(t,a,s);break;default:throw Error(ie(161))}}catch(l){Jt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function oY(t,e,n){Ce=t,G$(t)}function G$(t,e,n){for(var r=(t.mode&1)!==0;Ce!==null;){var i=Ce,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||cg;if(!s){var a=i.alternate,l=a!==null&&a.memoizedState!==null||jn;a=cg;var u=jn;if(cg=s,(jn=l)&&!u)for(Ce=i;Ce!==null;)s=Ce,l=s.child,s.tag===22&&s.memoizedState!==null?Wx(i):l!==null?(l.return=s,Ce=l):Wx(i);for(;o!==null;)Ce=o,G$(o),o=o.sibling;Ce=i,cg=a,jn=u}$x(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,Ce=o):$x(t)}}function $x(t){for(;Ce!==null;){var e=Ce;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:jn||Bw(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!jn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Hi(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Sx(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Sx(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&Dd(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ie(163))}jn||e.flags&512&&o0(e)}catch(f){Jt(e,e.return,f)}}if(e===t){Ce=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ce=n;break}Ce=e.return}}function Fx(t){for(;Ce!==null;){var e=Ce;if(e===t){Ce=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ce=n;break}Ce=e.return}}function Wx(t){for(;Ce!==null;){var e=Ce;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Bw(4,e)}catch(l){Jt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Jt(e,i,l)}}var o=e.return;try{o0(e)}catch(l){Jt(e,o,l)}break;case 5:var s=e.return;try{o0(e)}catch(l){Jt(e,s,l)}}}catch(l){Jt(e,e.return,l)}if(e===t){Ce=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Ce=a;break}Ce=e.return}}var sY=Math.ceil,kp=bs.ReactCurrentDispatcher,gE=bs.ReactCurrentOwner,di=bs.ReactCurrentBatchConfig,st=0,Mn=null,fn=null,kn=0,Wr=0,rc=Aa(0),vn=0,Gd=null,kl=0,Uw=0,mE=0,ud=null,Pr=null,pE=0,Mc=1/0,Xo=null,Lp=!1,l0=null,ha=null,hg=!1,ea=null,$p=0,cd=0,u0=null,Wm=-1,Vm=0;function fr(){return st&6?rn():Wm!==-1?Wm:Wm=rn()}function da(t){return t.mode&1?st&2&&kn!==0?kn&-kn:Uj.transition!==null?(Vm===0&&(Vm=xL()),Vm):(t=pt,t!==0||(t=window.event,t=t===void 0?16:NL(t.type)),t):1}function Bi(t,e,n,r){if(50<cd)throw cd=0,u0=null,Error(ie(185));Cf(t,n,r),(!(st&2)||t!==Mn)&&(t===Mn&&(!(st&2)&&(Uw|=n),vn===4&&qs(t,kn)),Dr(t,r),n===1&&st===0&&!(e.mode&1)&&(Mc=rn()+500,Fw&&Ia()))}function Dr(t,e){var n=t.callbackNode;UG(t,e);var r=Sp(t,t===Mn?kn:0);if(r===0)n!==null&&XM(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&XM(n),e===1)t.tag===0?Bj(Vx.bind(null,t)):e$(Vx.bind(null,t)),$j(function(){!(st&6)&&Ia()}),n=null;else{switch(PL(r)){case 1:n=BR;break;case 4:n=_L;break;case 16:n=yp;break;case 536870912:n=ML;break;default:n=yp}n=J$(n,j$.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function j$(t,e){if(Wm=-1,Vm=0,st&6)throw Error(ie(327));var n=t.callbackNode;if(mc()&&t.callbackNode!==n)return null;var r=Sp(t,t===Mn?kn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Fp(t,r);else{e=r;var i=st;st|=2;var o=K$();(Mn!==t||kn!==e)&&(Xo=null,Mc=rn()+500,Ol(t,e));do try{uY();break}catch(a){Y$(t,a)}while(1);tE(),kp.current=o,st=i,fn!==null?e=0:(Mn=null,kn=0,e=vn)}if(e!==0){if(e===2&&(i=kb(t),i!==0&&(r=i,e=c0(t,i))),e===1)throw n=Gd,Ol(t,0),qs(t,r),Dr(t,rn()),n;if(e===6)qs(t,r);else{if(i=t.current.alternate,!(r&30)&&!aY(i)&&(e=Fp(t,r),e===2&&(o=kb(t),o!==0&&(r=o,e=c0(t,o))),e===1))throw n=Gd,Ol(t,0),qs(t,r),Dr(t,rn()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ie(345));case 2:vl(t,Pr,Xo);break;case 3:if(qs(t,r),(r&130023424)===r&&(e=pE+500-rn(),10<e)){if(Sp(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){fr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=zb(vl.bind(null,t,Pr,Xo),e);break}vl(t,Pr,Xo);break;case 4:if(qs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-Vi(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=rn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*sY(r/1960))-r,10<r){t.timeoutHandle=zb(vl.bind(null,t,Pr,Xo),r);break}vl(t,Pr,Xo);break;case 5:vl(t,Pr,Xo);break;default:throw Error(ie(329))}}}return Dr(t,rn()),t.callbackNode===n?j$.bind(null,t):null}function c0(t,e){var n=ud;return t.current.memoizedState.isDehydrated&&(Ol(t,e).flags|=256),t=Fp(t,e),t!==2&&(e=Pr,Pr=n,e!==null&&h0(e)),t}function h0(t){Pr===null?Pr=t:Pr.push.apply(Pr,t)}function aY(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!zi(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function qs(t,e){for(e&=~mE,e&=~Uw,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Vi(e),r=1<<n;t[n]=-1,e&=~r}}function Vx(t){if(st&6)throw Error(ie(327));mc();var e=Sp(t,0);if(!(e&1))return Dr(t,rn()),null;var n=Fp(t,e);if(t.tag!==0&&n===2){var r=kb(t);r!==0&&(e=r,n=c0(t,r))}if(n===1)throw n=Gd,Ol(t,0),qs(t,e),Dr(t,rn()),n;if(n===6)throw Error(ie(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,vl(t,Pr,Xo),Dr(t,rn()),null}function wE(t,e){var n=st;st|=1;try{return t(e)}finally{st=n,st===0&&(Mc=rn()+500,Fw&&Ia())}}function Ll(t){ea!==null&&ea.tag===0&&!(st&6)&&mc();var e=st;st|=1;var n=di.transition,r=pt;try{if(di.transition=null,pt=1,t)return t()}finally{pt=r,di.transition=n,st=e,!(st&6)&&Ia()}}function vE(){Wr=rc.current,Ot(rc)}function Ol(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Lj(n)),fn!==null)for(n=fn.return;n!==null;){var r=n;switch(ZR(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&_p();break;case 3:Tc(),Ot(Ir),Ot(qn),aE();break;case 5:sE(r);break;case 4:Tc();break;case 13:Ot(zt);break;case 19:Ot(zt);break;case 10:nE(r.type._context);break;case 22:case 23:vE()}n=n.return}if(Mn=t,fn=t=fa(t.current,null),kn=Wr=e,vn=0,Gd=null,mE=Uw=kl=0,Pr=ud=null,bl!==null){for(e=0;e<bl.length;e++)if(n=bl[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}bl=null}return t}function Y$(t,e){do{var n=fn;try{if(tE(),Lm.current=Np,Dp){for(var r=Kt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Dp=!1}if(Nl=0,Tn=wn=Kt=null,ad=!1,Bd=0,gE.current=null,n===null||n.return===null){vn=1,Gd=e,fn=null;break}e:{var o=t,s=n.return,a=n,l=e;if(e=kn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var g=xx(s);if(g!==null){g.flags&=-257,Px(g,s,a,o,e),g.mode&1&&Mx(o,u,e),e=g,l=u;var p=e.updateQueue;if(p===null){var y=new Set;y.add(l),e.updateQueue=y}else p.add(l);break e}else{if(!(e&1)){Mx(o,u,e),CE();break e}l=Error(ie(426))}}else if($t&&a.mode&1){var E=xx(s);if(E!==null){!(E.flags&65536)&&(E.flags|=256),Px(E,s,a,o,e),JR(_c(l,a));break e}}o=l=_c(l,a),vn!==4&&(vn=2),ud===null?ud=[o]:ud.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var v=O$(o,l,e);yx(o,v);break e;case 1:a=l;var C=o.type,S=o.stateNode;if(!(o.flags&128)&&(typeof C.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(ha===null||!ha.has(S)))){o.flags|=65536,e&=-e,o.lanes|=e;var T=A$(o,a,e);yx(o,T);break e}}o=o.return}while(o!==null)}q$(n)}catch(_){e=_,fn===n&&n!==null&&(fn=n=n.return);continue}break}while(1)}function K$(){var t=kp.current;return kp.current=Np,t===null?Np:t}function CE(){(vn===0||vn===3||vn===2)&&(vn=4),Mn===null||!(kl&268435455)&&!(Uw&268435455)||qs(Mn,kn)}function Fp(t,e){var n=st;st|=2;var r=K$();(Mn!==t||kn!==e)&&(Xo=null,Ol(t,e));do try{lY();break}catch(i){Y$(t,i)}while(1);if(tE(),st=n,kp.current=r,fn!==null)throw Error(ie(261));return Mn=null,kn=0,vn}function lY(){for(;fn!==null;)X$(fn)}function uY(){for(;fn!==null&&!DG();)X$(fn)}function X$(t){var e=Z$(t.alternate,t,Wr);t.memoizedProps=t.pendingProps,e===null?q$(t):fn=e,gE.current=null}function q$(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=nY(n,e),n!==null){n.flags&=32767,fn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{vn=6,fn=null;return}}else if(n=tY(n,e,Wr),n!==null){fn=n;return}if(e=e.sibling,e!==null){fn=e;return}fn=e=t}while(e!==null);vn===0&&(vn=5)}function vl(t,e,n){var r=pt,i=di.transition;try{di.transition=null,pt=1,cY(t,e,n,r)}finally{di.transition=i,pt=r}return null}function cY(t,e,n,r){do mc();while(ea!==null);if(st&6)throw Error(ie(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ie(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(zG(t,o),t===Mn&&(fn=Mn=null,kn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||hg||(hg=!0,J$(yp,function(){return mc(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=di.transition,di.transition=null;var s=pt;pt=1;var a=st;st|=4,gE.current=null,iY(t,n),z$(n,t),Oj(Bb),bp=!!Vb,Bb=Vb=null,t.current=n,oY(n),NG(),st=a,pt=s,di.transition=o}else t.current=n;if(hg&&(hg=!1,ea=t,$p=i),o=t.pendingLanes,o===0&&(ha=null),$G(n.stateNode),Dr(t,rn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Lp)throw Lp=!1,t=l0,l0=null,t;return $p&1&&t.tag!==0&&mc(),o=t.pendingLanes,o&1?t===u0?cd++:(cd=0,u0=t):cd=0,Ia(),null}function mc(){if(ea!==null){var t=PL($p),e=di.transition,n=pt;try{if(di.transition=null,pt=16>t?16:t,ea===null)var r=!1;else{if(t=ea,ea=null,$p=0,st&6)throw Error(ie(331));var i=st;for(st|=4,Ce=t.current;Ce!==null;){var o=Ce,s=o.child;if(Ce.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Ce=u;Ce!==null;){var c=Ce;switch(c.tag){case 0:case 11:case 15:ld(8,c,o)}var h=c.child;if(h!==null)h.return=c,Ce=h;else for(;Ce!==null;){c=Ce;var f=c.sibling,g=c.return;if(V$(c),c===u){Ce=null;break}if(f!==null){f.return=g,Ce=f;break}Ce=g}}}var p=o.alternate;if(p!==null){var y=p.child;if(y!==null){p.child=null;do{var E=y.sibling;y.sibling=null,y=E}while(y!==null)}}Ce=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,Ce=s;else e:for(;Ce!==null;){if(o=Ce,o.flags&2048)switch(o.tag){case 0:case 11:case 15:ld(9,o,o.return)}var v=o.sibling;if(v!==null){v.return=o.return,Ce=v;break e}Ce=o.return}}var C=t.current;for(Ce=C;Ce!==null;){s=Ce;var S=s.child;if(s.subtreeFlags&2064&&S!==null)S.return=s,Ce=S;else e:for(s=C;Ce!==null;){if(a=Ce,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Bw(9,a)}}catch(_){Jt(a,a.return,_)}if(a===s){Ce=null;break e}var T=a.sibling;if(T!==null){T.return=a.return,Ce=T;break e}Ce=a.return}}if(st=i,Ia(),bo&&typeof bo.onPostCommitFiberRoot=="function")try{bo.onPostCommitFiberRoot(Dw,t)}catch{}r=!0}return r}finally{pt=n,di.transition=e}}return!1}function Bx(t,e,n){e=_c(n,e),e=O$(t,e,1),t=ca(t,e,1),e=fr(),t!==null&&(Cf(t,1,e),Dr(t,e))}function Jt(t,e,n){if(t.tag===3)Bx(t,t,n);else for(;e!==null;){if(e.tag===3){Bx(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ha===null||!ha.has(r))){t=_c(n,t),t=A$(e,t,1),e=ca(e,t,1),t=fr(),e!==null&&(Cf(e,1,t),Dr(e,t));break}}e=e.return}}function hY(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=fr(),t.pingedLanes|=t.suspendedLanes&n,Mn===t&&(kn&n)===n&&(vn===4||vn===3&&(kn&130023424)===kn&&500>rn()-pE?Ol(t,0):mE|=n),Dr(t,e)}function Q$(t,e){e===0&&(t.mode&1?(e=tg,tg<<=1,!(tg&130023424)&&(tg=4194304)):e=1);var n=fr();t=ps(t,e),t!==null&&(Cf(t,e,n),Dr(t,n))}function dY(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Q$(t,n)}function fY(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ie(314))}r!==null&&r.delete(e),Q$(t,n)}var Z$;Z$=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ir.current)Ar=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ar=!1,eY(t,e,n);Ar=!!(t.flags&131072)}else Ar=!1,$t&&e.flags&1048576&&t$(e,Pp,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Fm(t,e),t=e.pendingProps;var i=bc(e,qn.current);gc(e,n),i=uE(null,e,r,t,i,n);var o=cE();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Hr(r)?(o=!0,Mp(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,iE(e),i.updater=Ww,e.stateNode=i,i._reactInternals=e,Qb(e,r,t,n),e=e0(null,e,r,!0,o,n)):(e.tag=0,$t&&o&&QR(e),cr(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Fm(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=mY(r),t=Hi(r,t),i){case 0:e=Jb(null,e,r,t,n);break e;case 1:e=Ix(null,e,r,t,n);break e;case 11:e=Ox(null,e,r,t,n);break e;case 14:e=Ax(null,e,r,Hi(r.type,t),n);break e}throw Error(ie(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hi(r,i),Jb(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hi(r,i),Ix(t,e,r,i,n);case 3:e:{if(N$(e),t===null)throw Error(ie(387));r=e.pendingProps,o=e.memoizedState,i=o.element,o$(t,e),Ip(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=_c(Error(ie(423)),e),e=Hx(t,e,r,n,i);break e}else if(r!==i){i=_c(Error(ie(424)),e),e=Hx(t,e,r,n,i);break e}else for(Ur=ua(e.stateNode.containerInfo.firstChild),Gr=e,$t=!0,ki=null,n=u$(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Rc(),r===i){e=ws(t,e,n);break e}cr(t,e,r,n)}e=e.child}return e;case 5:return c$(e),t===null&&Kb(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,Ub(r,i)?s=null:o!==null&&Ub(r,o)&&(e.flags|=32),D$(t,e),cr(t,e,s,n),e.child;case 6:return t===null&&Kb(e),null;case 13:return k$(t,e,n);case 4:return oE(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ec(e,null,r,n):cr(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hi(r,i),Ox(t,e,r,i,n);case 7:return cr(t,e,e.pendingProps,n),e.child;case 8:return cr(t,e,e.pendingProps.children,n),e.child;case 12:return cr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,Tt(Op,r._currentValue),r._currentValue=s,o!==null)if(zi(o.value,s)){if(o.children===i.children&&!Ir.current){e=ws(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=ds(-1,n&-n),l.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Xb(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(ie(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),Xb(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}cr(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,gc(e,n),i=fi(i),r=r(i),e.flags|=1,cr(t,e,r,n),e.child;case 14:return r=e.type,i=Hi(r,e.pendingProps),i=Hi(r.type,i),Ax(t,e,r,i,n);case 15:return I$(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hi(r,i),Fm(t,e),e.tag=1,Hr(r)?(t=!0,Mp(e)):t=!1,gc(e,n),a$(e,r,i),Qb(e,r,i,n),e0(null,e,r,!0,t,n);case 19:return L$(t,e,n);case 22:return H$(t,e,n)}throw Error(ie(156,e.tag))};function J$(t,e){return TL(t,e)}function gY(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hi(t,e,n,r){return new gY(t,e,n,r)}function yE(t){return t=t.prototype,!(!t||!t.isReactComponent)}function mY(t){if(typeof t=="function")return yE(t)?1:0;if(t!=null){if(t=t.$$typeof,t===FR)return 11;if(t===WR)return 14}return 2}function fa(t,e){var n=t.alternate;return n===null?(n=hi(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Bm(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")yE(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case Yu:return Al(n.children,i,o,e);case $R:s=8,i|=8;break;case Sb:return t=hi(12,n,e,i|2),t.elementType=Sb,t.lanes=o,t;case bb:return t=hi(13,n,e,i),t.elementType=bb,t.lanes=o,t;case Rb:return t=hi(19,n,e,i),t.elementType=Rb,t.lanes=o,t;case lL:return zw(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case sL:s=10;break e;case aL:s=9;break e;case FR:s=11;break e;case WR:s=14;break e;case js:s=16,r=null;break e}throw Error(ie(130,t==null?t:typeof t,""))}return e=hi(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function Al(t,e,n,r){return t=hi(7,t,r,e),t.lanes=n,t}function zw(t,e,n,r){return t=hi(22,t,r,e),t.elementType=lL,t.lanes=n,t.stateNode={isHidden:!1},t}function AC(t,e,n){return t=hi(6,t,null,e),t.lanes=n,t}function IC(t,e,n){return e=hi(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function pY(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=dC(0),this.expirationTimes=dC(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dC(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function SE(t,e,n,r,i,o,s,a,l){return t=new pY(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=hi(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},iE(o),t}function wY(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ju,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function eF(t){if(!t)return Sa;t=t._reactInternals;e:{if(Gl(t)!==t||t.tag!==1)throw Error(ie(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Hr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ie(171))}if(t.tag===1){var n=t.type;if(Hr(n))return JL(t,n,e)}return e}function tF(t,e,n,r,i,o,s,a,l){return t=SE(n,r,!0,t,i,o,s,a,l),t.context=eF(null),n=t.current,r=fr(),i=da(n),o=ds(r,i),o.callback=e??null,ca(n,o,i),t.current.lanes=i,Cf(t,i,r),Dr(t,r),t}function Gw(t,e,n,r){var i=e.current,o=fr(),s=da(i);return n=eF(n),e.context===null?e.context=n:e.pendingContext=n,e=ds(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ca(i,e,s),t!==null&&(Bi(t,i,s,o),km(t,i,s)),s}function Wp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ux(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function bE(t,e){Ux(t,e),(t=t.alternate)&&Ux(t,e)}function vY(){return null}var nF=typeof reportError=="function"?reportError:function(t){console.error(t)};function RE(t){this._internalRoot=t}jw.prototype.render=RE.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ie(409));Gw(t,e,null,null)};jw.prototype.unmount=RE.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ll(function(){Gw(null,t,null,null)}),e[ms]=null}};function jw(t){this._internalRoot=t}jw.prototype.unstable_scheduleHydration=function(t){if(t){var e=IL();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Xs.length&&e!==0&&e<Xs[n].priority;n++);Xs.splice(n,0,t),n===0&&DL(t)}};function EE(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Yw(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function zx(){}function CY(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var u=Wp(s);o.call(u)}}var s=tF(e,r,t,0,null,!1,!1,"",zx);return t._reactRootContainer=s,t[ms]=s.current,Ld(t.nodeType===8?t.parentNode:t),Ll(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=Wp(l);a.call(u)}}var l=SE(t,0,!1,null,null,!1,!1,"",zx);return t._reactRootContainer=l,t[ms]=l.current,Ld(t.nodeType===8?t.parentNode:t),Ll(function(){Gw(e,l,n,r)}),l}function Kw(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var l=Wp(s);a.call(l)}}Gw(e,s,t,i)}else s=CY(n,e,t,i,r);return Wp(s)}OL=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Kh(e.pendingLanes);n!==0&&(UR(e,n|1),Dr(e,rn()),!(st&6)&&(Mc=rn()+500,Ia()))}break;case 13:Ll(function(){var r=ps(t,1);if(r!==null){var i=fr();Bi(r,t,1,i)}}),bE(t,1)}};zR=function(t){if(t.tag===13){var e=ps(t,134217728);if(e!==null){var n=fr();Bi(e,t,134217728,n)}bE(t,134217728)}};AL=function(t){if(t.tag===13){var e=da(t),n=ps(t,e);if(n!==null){var r=fr();Bi(n,t,e,r)}bE(t,e)}};IL=function(){return pt};HL=function(t,e){var n=pt;try{return pt=t,e()}finally{pt=n}};Hb=function(t,e,n){switch(e){case"input":if(_b(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=$w(r);if(!i)throw Error(ie(90));cL(r),_b(r,i)}}}break;case"textarea":dL(t,n);break;case"select":e=n.value,e!=null&&cc(t,!!n.multiple,e,!1)}};CL=wE;yL=Ll;var yY={usingClientEntryPoint:!1,Events:[Sf,Qu,$w,wL,vL,wE]},oh={findFiberByHostInstance:Sl,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},SY={bundleType:oh.bundleType,version:oh.version,rendererPackageName:oh.rendererPackageName,rendererConfig:oh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:bs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=RL(t),t===null?null:t.stateNode},findFiberByHostInstance:oh.findFiberByHostInstance||vY,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dg.isDisabled&&dg.supportsFiber)try{Dw=dg.inject(SY),bo=dg}catch{}}Xr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yY;Xr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!EE(e))throw Error(ie(200));return wY(t,e,null,n)};Xr.createRoot=function(t,e){if(!EE(t))throw Error(ie(299));var n=!1,r="",i=nF;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=SE(t,1,!1,null,null,n,!1,r,i),t[ms]=e.current,Ld(t.nodeType===8?t.parentNode:t),new RE(e)};Xr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ie(188)):(t=Object.keys(t).join(","),Error(ie(268,t)));return t=RL(e),t=t===null?null:t.stateNode,t};Xr.flushSync=function(t){return Ll(t)};Xr.hydrate=function(t,e,n){if(!Yw(e))throw Error(ie(200));return Kw(null,t,e,!0,n)};Xr.hydrateRoot=function(t,e,n){if(!EE(t))throw Error(ie(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=nF;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=tF(e,null,t,1,n??null,i,!1,o,s),t[ms]=e.current,Ld(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new jw(e)};Xr.render=function(t,e,n){if(!Yw(e))throw Error(ie(200));return Kw(null,t,e,!1,n)};Xr.unmountComponentAtNode=function(t){if(!Yw(t))throw Error(ie(40));return t._reactRootContainer?(Ll(function(){Kw(null,null,t,!1,function(){t._reactRootContainer=null,t[ms]=null})}),!0):!1};Xr.unstable_batchedUpdates=wE;Xr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Yw(n))throw Error(ie(200));if(t==null||t._reactInternals===void 0)throw Error(ie(38));return Kw(t,e,n,!1,r)};Xr.version="18.2.0-next-9e3b772b8-20220608";function rF(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(rF)}catch(t){console.error(t)}}rF(),tL.exports=Xr;var iF=tL.exports;const oF=pf(iF);var Gx=iF;Cb.createRoot=Gx.createRoot,Cb.hydrateRoot=Gx.hydrateRoot;var fg=function(t){return t&&t.Math===Math&&t},Jn=fg(typeof globalThis=="object"&&globalThis)||fg(typeof window=="object"&&window)||fg(typeof self=="object"&&self)||fg(typeof Wi=="object"&&Wi)||function(){return this}()||Wi||Function("return this")(),TE={},pi=function(t){try{return!!t()}catch{return!0}},bY=pi,_o=!bY(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),RY=pi,Xw=!RY(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),EY=Xw,gg=Function.prototype.call,qw=EY?gg.bind(gg):function(){return gg.apply(gg,arguments)},sF={},aF={}.propertyIsEnumerable,lF=Object.getOwnPropertyDescriptor,TY=lF&&!aF.call({1:2},1);sF.f=TY?function(e){var n=lF(this,e);return!!n&&n.enumerable}:aF;var _E=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},uF=Xw,cF=Function.prototype,d0=cF.call,_Y=uF&&cF.bind.bind(d0,d0),vr=uF?_Y:function(t){return function(){return d0.apply(t,arguments)}},hF=vr,MY=hF({}.toString),xY=hF("".slice),$c=function(t){return xY(MY(t),8,-1)},PY=vr,OY=pi,AY=$c,HC=Object,IY=PY("".split),HY=OY(function(){return!HC("z").propertyIsEnumerable(0)})?function(t){return AY(t)==="String"?IY(t,""):HC(t)}:HC,dF=function(t){return t==null},DY=dF,NY=TypeError,fF=function(t){if(DY(t))throw NY("Can't call method on "+t);return t},kY=HY,LY=fF,Qw=function(t){return kY(LY(t))},f0=typeof document=="object"&&document.all,$Y=typeof f0>"u"&&f0!==void 0,gF={all:f0,IS_HTMLDDA:$Y},mF=gF,FY=mF.all,$n=mF.IS_HTMLDDA?function(t){return typeof t=="function"||t===FY}:function(t){return typeof t=="function"},jx=$n,pF=gF,WY=pF.all,jl=pF.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:jx(t)||t===WY}:function(t){return typeof t=="object"?t!==null:jx(t)},DC=Jn,VY=$n,BY=function(t){return VY(t)?t:void 0},Rf=function(t,e){return arguments.length<2?BY(DC[t]):DC[t]&&DC[t][e]},UY=vr,wF=UY({}.isPrototypeOf),ME=typeof navigator<"u"&&String(navigator.userAgent)||"",vF=Jn,NC=ME,Yx=vF.process,Kx=vF.Deno,Xx=Yx&&Yx.versions||Kx&&Kx.version,qx=Xx&&Xx.v8,Li,Vp;qx&&(Li=qx.split("."),Vp=Li[0]>0&&Li[0]<4?1:+(Li[0]+Li[1]));!Vp&&NC&&(Li=NC.match(/Edge\/(\d+)/),(!Li||Li[1]>=74)&&(Li=NC.match(/Chrome\/(\d+)/),Li&&(Vp=+Li[1])));var zY=Vp,Qx=zY,GY=pi,jY=Jn,YY=jY.String,xE=!!Object.getOwnPropertySymbols&&!GY(function(){var t=Symbol("symbol detection");return!YY(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Qx&&Qx<41}),KY=xE,CF=KY&&!Symbol.sham&&typeof Symbol.iterator=="symbol",XY=Rf,qY=$n,QY=wF,ZY=CF,JY=Object,PE=ZY?function(t){return typeof t=="symbol"}:function(t){var e=XY("Symbol");return qY(e)&&QY(e.prototype,JY(t))},e3=String,yF=function(t){try{return e3(t)}catch{return"Object"}},t3=$n,n3=yF,r3=TypeError,OE=function(t){if(t3(t))return t;throw r3(n3(t)+" is not a function")},i3=OE,o3=dF,s3=function(t,e){var n=t[e];return o3(n)?void 0:i3(n)},kC=qw,LC=$n,$C=jl,a3=TypeError,l3=function(t,e){var n,r;if(e==="string"&&LC(n=t.toString)&&!$C(r=kC(n,t))||LC(n=t.valueOf)&&!$C(r=kC(n,t))||e!=="string"&&LC(n=t.toString)&&!$C(r=kC(n,t)))return r;throw a3("Can't convert object to primitive value")},SF={exports:{}},Zx=Jn,u3=Object.defineProperty,AE=function(t,e){try{u3(Zx,t,{value:e,configurable:!0,writable:!0})}catch{Zx[t]=e}return e},c3=Jn,h3=AE,Jx="__core-js_shared__",d3=c3[Jx]||h3(Jx,{}),IE=d3,eP=IE;(SF.exports=function(t,e){return eP[t]||(eP[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.32.2",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.2/LICENSE",source:"https://github.com/zloirock/core-js"});var bF=SF.exports,f3=fF,g3=Object,Zw=function(t){return g3(f3(t))},m3=vr,p3=Zw,w3=m3({}.hasOwnProperty),Rs=Object.hasOwn||function(e,n){return w3(p3(e),n)},v3=vr,C3=0,y3=Math.random(),S3=v3(1 .toString),RF=function(t){return"Symbol("+(t===void 0?"":t)+")_"+S3(++C3+y3,36)},b3=Jn,R3=bF,tP=Rs,E3=RF,T3=xE,_3=CF,ic=b3.Symbol,FC=R3("wks"),M3=_3?ic.for||ic:ic&&ic.withoutSetter||E3,Jw=function(t){return tP(FC,t)||(FC[t]=T3&&tP(ic,t)?ic[t]:M3("Symbol."+t)),FC[t]},x3=qw,nP=jl,rP=PE,P3=s3,O3=l3,A3=Jw,I3=TypeError,H3=A3("toPrimitive"),D3=function(t,e){if(!nP(t)||rP(t))return t;var n=P3(t,H3),r;if(n){if(e===void 0&&(e="default"),r=x3(n,t,e),!nP(r)||rP(r))return r;throw I3("Can't convert object to primitive value")}return e===void 0&&(e="number"),O3(t,e)},N3=D3,k3=PE,EF=function(t){var e=N3(t,"string");return k3(e)?e:e+""},L3=Jn,iP=jl,g0=L3.document,$3=iP(g0)&&iP(g0.createElement),HE=function(t){return $3?g0.createElement(t):{}},F3=_o,W3=pi,V3=HE,TF=!F3&&!W3(function(){return Object.defineProperty(V3("div"),"a",{get:function(){return 7}}).a!==7}),B3=_o,U3=qw,z3=sF,G3=_E,j3=Qw,Y3=EF,K3=Rs,X3=TF,oP=Object.getOwnPropertyDescriptor;TE.f=B3?oP:function(e,n){if(e=j3(e),n=Y3(n),X3)try{return oP(e,n)}catch{}if(K3(e,n))return G3(!U3(z3.f,e,n),e[n])};var Yl={},q3=_o,Q3=pi,_F=q3&&Q3(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Z3=jl,J3=String,eK=TypeError,Ef=function(t){if(Z3(t))return t;throw eK(J3(t)+" is not an object")},tK=_o,nK=TF,rK=_F,mg=Ef,sP=EF,iK=TypeError,WC=Object.defineProperty,oK=Object.getOwnPropertyDescriptor,VC="enumerable",BC="configurable",UC="writable";Yl.f=tK?rK?function(e,n,r){if(mg(e),n=sP(n),mg(r),typeof e=="function"&&n==="prototype"&&"value"in r&&UC in r&&!r[UC]){var i=oK(e,n);i&&i[UC]&&(e[n]=r.value,r={configurable:BC in r?r[BC]:i[BC],enumerable:VC in r?r[VC]:i[VC],writable:!1})}return WC(e,n,r)}:WC:function(e,n,r){if(mg(e),n=sP(n),mg(r),nK)try{return WC(e,n,r)}catch{}if("get"in r||"set"in r)throw iK("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var sK=_o,aK=Yl,lK=_E,Tf=sK?function(t,e,n){return aK.f(t,e,lK(1,n))}:function(t,e,n){return t[e]=n,t},MF={exports:{}},m0=_o,uK=Rs,xF=Function.prototype,cK=m0&&Object.getOwnPropertyDescriptor,DE=uK(xF,"name"),hK=DE&&(function(){}).name==="something",dK=DE&&(!m0||m0&&cK(xF,"name").configurable),fK={EXISTS:DE,PROPER:hK,CONFIGURABLE:dK},gK=vr,mK=$n,p0=IE,pK=gK(Function.toString);mK(p0.inspectSource)||(p0.inspectSource=function(t){return pK(t)});var wK=p0.inspectSource,vK=Jn,CK=$n,aP=vK.WeakMap,yK=CK(aP)&&/native code/.test(String(aP)),SK=bF,bK=RF,lP=SK("keys"),PF=function(t){return lP[t]||(lP[t]=bK(t))},NE={},RK=yK,OF=Jn,EK=jl,TK=Tf,zC=Rs,GC=IE,_K=PF,MK=NE,uP="Object already initialized",w0=OF.TypeError,xK=OF.WeakMap,Bp,jd,Up,PK=function(t){return Up(t)?jd(t):Bp(t,{})},OK=function(t){return function(e){var n;if(!EK(e)||(n=jd(e)).type!==t)throw w0("Incompatible receiver, "+t+" required");return n}};if(RK||GC.state){var Zi=GC.state||(GC.state=new xK);Zi.get=Zi.get,Zi.has=Zi.has,Zi.set=Zi.set,Bp=function(t,e){if(Zi.has(t))throw w0(uP);return e.facade=t,Zi.set(t,e),e},jd=function(t){return Zi.get(t)||{}},Up=function(t){return Zi.has(t)}}else{var iu=_K("state");MK[iu]=!0,Bp=function(t,e){if(zC(t,iu))throw w0(uP);return e.facade=t,TK(t,iu,e),e},jd=function(t){return zC(t,iu)?t[iu]:{}},Up=function(t){return zC(t,iu)}}var AK={set:Bp,get:jd,has:Up,enforce:PK,getterFor:OK},kE=vr,IK=pi,HK=$n,pg=Rs,v0=_o,DK=fK.CONFIGURABLE,NK=wK,AF=AK,kK=AF.enforce,LK=AF.get,cP=String,Um=Object.defineProperty,$K=kE("".slice),FK=kE("".replace),WK=kE([].join),VK=v0&&!IK(function(){return Um(function(){},"length",{value:8}).length!==8}),BK=String(String).split("String"),UK=MF.exports=function(t,e,n){$K(cP(e),0,7)==="Symbol("&&(e="["+FK(cP(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!pg(t,"name")||DK&&t.name!==e)&&(v0?Um(t,"name",{value:e,configurable:!0}):t.name=e),VK&&n&&pg(n,"arity")&&t.length!==n.arity&&Um(t,"length",{value:n.arity});try{n&&pg(n,"constructor")&&n.constructor?v0&&Um(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=kK(t);return pg(r,"source")||(r.source=WK(BK,typeof e=="string"?e:"")),t};Function.prototype.toString=UK(function(){return HK(this)&&LK(this).source||NK(this)},"toString");var zK=MF.exports,GK=$n,jK=Yl,YK=zK,KK=AE,XK=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(GK(n)&&YK(n,o,r),r.global)i?t[e]=n:KK(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:jK.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},IF={},qK=Math.ceil,QK=Math.floor,ZK=Math.trunc||function(e){var n=+e;return(n>0?QK:qK)(n)},JK=ZK,LE=function(t){var e=+t;return e!==e||e===0?0:JK(e)},e4=LE,t4=Math.max,n4=Math.min,r4=function(t,e){var n=e4(t);return n<0?t4(n+e,0):n4(n,e)},i4=LE,o4=Math.min,s4=function(t){return t>0?o4(i4(t),9007199254740991):0},a4=s4,ev=function(t){return a4(t.length)},l4=Qw,u4=r4,c4=ev,hP=function(t){return function(e,n,r){var i=l4(e),o=c4(i),s=u4(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},h4={includes:hP(!0),indexOf:hP(!1)},d4=vr,jC=Rs,f4=Qw,g4=h4.indexOf,m4=NE,dP=d4([].push),HF=function(t,e){var n=f4(t),r=0,i=[],o;for(o in n)!jC(m4,o)&&jC(n,o)&&dP(i,o);for(;e.length>r;)jC(n,o=e[r++])&&(~g4(i,o)||dP(i,o));return i},$E=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],p4=HF,w4=$E,v4=w4.concat("length","prototype");IF.f=Object.getOwnPropertyNames||function(e){return p4(e,v4)};var DF={};DF.f=Object.getOwnPropertySymbols;var C4=Rf,y4=vr,S4=IF,b4=DF,R4=Ef,E4=y4([].concat),T4=C4("Reflect","ownKeys")||function(e){var n=S4.f(R4(e)),r=b4.f;return r?E4(n,r(e)):n},fP=Rs,_4=T4,M4=TE,x4=Yl,NF=function(t,e,n){for(var r=_4(e),i=x4.f,o=M4.f,s=0;s<r.length;s++){var a=r[s];!fP(t,a)&&!(n&&fP(n,a))&&i(t,a,o(e,a))}},P4=pi,O4=$n,A4=/#|\.prototype\./,_f=function(t,e){var n=H4[I4(t)];return n===N4?!0:n===D4?!1:O4(e)?P4(e):!!e},I4=_f.normalize=function(t){return String(t).replace(A4,".").toLowerCase()},H4=_f.data={},D4=_f.NATIVE="N",N4=_f.POLYFILL="P",k4=_f,YC=Jn,L4=TE.f,$4=Tf,F4=XK,W4=AE,V4=NF,B4=k4,Kl=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=YC:i?s=YC[n]||W4(n,{}):s=(YC[n]||{}).prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=L4(s,a),l=c&&c.value):l=s[a],o=B4(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;V4(u,l)}(t.sham||l&&l.sham)&&$4(u,"sham",!0),F4(s,a,u,t)}},U4=$c,kF=Array.isArray||function(e){return U4(e)==="Array"},z4=_o,G4=kF,j4=TypeError,Y4=Object.getOwnPropertyDescriptor,K4=z4&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),LF=K4?function(t,e){if(G4(t)&&!Y4(t,"length").writable)throw j4("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},X4=TypeError,q4=9007199254740991,$F=function(t){if(t>q4)throw X4("Maximum allowed index exceeded");return t},Q4=Kl,Z4=Zw,J4=ev,e6=LF,t6=$F,n6=pi,r6=n6(function(){return[].push.call({length:4294967296},1)!==4294967297}),i6=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},o6=r6||!i6();Q4({target:"Array",proto:!0,arity:1,forced:o6},{push:function(e){var n=Z4(this),r=J4(n),i=arguments.length;t6(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return e6(n,r),r}});var s6=Xw,FF=Function.prototype,gP=FF.apply,mP=FF.call,tv=typeof Reflect=="object"&&Reflect.apply||(s6?mP.bind(gP):function(){return mP.apply(gP,arguments)}),a6=vr,l6=OE,u6=function(t,e,n){try{return a6(l6(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},c6=$n,h6=String,d6=TypeError,f6=function(t){if(typeof t=="object"||c6(t))return t;throw d6("Can't set "+h6(t)+" as a prototype")},g6=u6,m6=Ef,p6=f6,WF=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=g6(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return m6(i),p6(o),t?n(i,o):i.__proto__=o,i}}():void 0),w6=Yl.f,v6=function(t,e,n){n in t||w6(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},C6=$n,y6=jl,pP=WF,S6=function(t,e,n){var r,i;return pP&&C6(r=e.constructor)&&r!==n&&y6(i=r.prototype)&&i!==n.prototype&&pP(t,i),t},b6=Jw,R6=b6("toStringTag"),VF={};VF[R6]="z";var E6=String(VF)==="[object z]",T6=E6,_6=$n,zm=$c,M6=Jw,x6=M6("toStringTag"),P6=Object,O6=zm(function(){return arguments}())==="Arguments",A6=function(t,e){try{return t[e]}catch{}},I6=T6?zm:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=A6(e=P6(t),x6))=="string"?n:O6?zm(e):(r=zm(e))==="Object"&&_6(e.callee)?"Arguments":r},H6=I6,D6=String,BF=function(t){if(H6(t)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return D6(t)},N6=BF,k6=function(t,e){return t===void 0?arguments.length<2?"":e:N6(t)},L6=jl,$6=Tf,F6=function(t,e){L6(e)&&"cause"in e&&$6(t,"cause",e.cause)},W6=vr,UF=Error,V6=W6("".replace),B6=function(t){return String(UF(t).stack)}("zxcasd"),zF=/\n\s*at [^:]*:[^\n]*/,U6=zF.test(B6),z6=function(t,e){if(U6&&typeof t=="string"&&!UF.prepareStackTrace)for(;e--;)t=V6(t,zF,"");return t},G6=pi,j6=_E,Y6=!G6(function(){var t=Error("a");return"stack"in t?(Object.defineProperty(t,"stack",j6(1,7)),t.stack!==7):!0}),K6=Tf,X6=z6,q6=Y6,wP=Error.captureStackTrace,Q6=function(t,e,n,r){q6&&(wP?wP(t,e):K6(t,"stack",X6(n,r)))},vP=Rf,Z6=Rs,CP=Tf,J6=wF,yP=WF,SP=NF,bP=v6,e8=S6,t8=k6,n8=F6,r8=Q6,i8=_o,o8=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=vP.apply(null,s);if(l){var u=l.prototype;if(Z6(u,"cause")&&delete u.cause,!n)return l;var c=vP("Error"),h=e(function(f,g){var p=t8(r?g:f,void 0),y=r?new l(f):new l;return p!==void 0&&CP(y,"message",p),r8(y,h,y.stack,2),this&&J6(u,this)&&e8(y,this,h),arguments.length>o&&n8(y,arguments[o]),y});h.prototype=u,a!=="Error"?yP?yP(h,c):SP(h,c,{name:!0}):i8&&i in l&&(bP(h,l,i),bP(h,l,"prepareStackTrace")),SP(h,l);try{u.name!==a&&CP(u,"name",a),u.constructor=h}catch{}return h}},GF=Kl,s8=Jn,Mo=tv,jF=o8,C0="WebAssembly",RP=s8[C0],zp=Error("e",{cause:7}).cause!==7,Xl=function(t,e){var n={};n[t]=jF(t,e,zp),GF({global:!0,constructor:!0,arity:1,forced:zp},n)},FE=function(t,e){if(RP&&RP[t]){var n={};n[t]=jF(C0+"."+t,e,zp),GF({target:C0,stat:!0,constructor:!0,arity:1,forced:zp},n)}};Xl("Error",function(t){return function(n){return Mo(t,this,arguments)}});Xl("EvalError",function(t){return function(n){return Mo(t,this,arguments)}});Xl("RangeError",function(t){return function(n){return Mo(t,this,arguments)}});Xl("ReferenceError",function(t){return function(n){return Mo(t,this,arguments)}});Xl("SyntaxError",function(t){return function(n){return Mo(t,this,arguments)}});Xl("TypeError",function(t){return function(n){return Mo(t,this,arguments)}});Xl("URIError",function(t){return function(n){return Mo(t,this,arguments)}});FE("CompileError",function(t){return function(n){return Mo(t,this,arguments)}});FE("LinkError",function(t){return function(n){return Mo(t,this,arguments)}});FE("RuntimeError",function(t){return function(n){return Mo(t,this,arguments)}});var a8=$c,l8=vr,u8=function(t){if(a8(t)==="Function")return l8(t)},EP=u8,c8=OE,h8=Xw,d8=EP(EP.bind),f8=function(t,e){return c8(t),e===void 0?t:h8?d8(t,e):function(){return t.apply(e,arguments)}},g8=Rf,YF=g8("document","documentElement"),m8=vr,WE=m8([].slice),p8=TypeError,KF=function(t,e){if(t<e)throw p8("Not enough arguments");return t},w8=ME,v8=/(?:ipad|iphone|ipod).*applewebkit/i.test(w8),C8=Jn,y8=$c,S8=y8(C8.process)==="process",zr=Jn,b8=tv,R8=f8,TP=$n,E8=Rs,XF=pi,_P=YF,T8=WE,MP=HE,_8=KF,M8=v8,x8=S8,y0=zr.setImmediate,S0=zr.clearImmediate,P8=zr.process,KC=zr.Dispatch,O8=zr.Function,xP=zr.MessageChannel,A8=zr.String,XC=0,hd={},PP="onreadystatechange",Yd,La,qC,QC;XF(function(){Yd=zr.location});var VE=function(t){if(E8(hd,t)){var e=hd[t];delete hd[t],e()}},ZC=function(t){return function(){VE(t)}},OP=function(t){VE(t.data)},AP=function(t){zr.postMessage(A8(t),Yd.protocol+"//"+Yd.host)};(!y0||!S0)&&(y0=function(e){_8(arguments.length,1);var n=TP(e)?e:O8(e),r=T8(arguments,1);return hd[++XC]=function(){b8(n,void 0,r)},La(XC),XC},S0=function(e){delete hd[e]},x8?La=function(t){P8.nextTick(ZC(t))}:KC&&KC.now?La=function(t){KC.now(ZC(t))}:xP&&!M8?(qC=new xP,QC=qC.port2,qC.port1.onmessage=OP,La=R8(QC.postMessage,QC)):zr.addEventListener&&TP(zr.postMessage)&&!zr.importScripts&&Yd&&Yd.protocol!=="file:"&&!XF(AP)?(La=AP,zr.addEventListener("message",OP,!1)):PP in MP("script")?La=function(t){_P.appendChild(MP("script"))[PP]=function(){_P.removeChild(this),VE(t)}}:La=function(t){setTimeout(ZC(t),0)});var qF={set:y0,clear:S0},I8=Kl,H8=Jn,IP=qF.clear;I8({global:!0,bind:!0,enumerable:!0,forced:H8.clearImmediate!==IP},{clearImmediate:IP});var D8=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",QF=Jn,N8=tv,k8=$n,L8=D8,$8=ME,F8=WE,W8=KF,V8=QF.Function,B8=/MSIE .\./.test($8)||L8&&function(){var t=QF.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),U8=function(t,e){var n=e?2:1;return B8?function(r,i){var o=W8(arguments.length,1)>n,s=k8(r)?r:V8(r),a=o?F8(arguments,n):[],l=o?function(){N8(s,this,a)}:s;return e?t(l,i):t(l)}:t},z8=Kl,ZF=Jn,HP=qF.set,G8=U8,DP=ZF.setImmediate?G8(HP,!1):HP;z8({global:!0,bind:!0,enumerable:!0,forced:ZF.setImmediate!==DP},{setImmediate:DP});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function Qs(t){"@babel/helpers - typeof";return Qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qs(t)}function b0(t,e){return b0=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},b0(t,e)}function j8(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gm(t,e,n){return j8()?Gm=Reflect.construct:Gm=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),u=new l;return s&&b0(u,s.prototype),u},Gm.apply(null,arguments)}function Oi(t){return Y8(t)||K8(t)||X8(t)||q8()}function Y8(t){if(Array.isArray(t))return R0(t)}function K8(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function X8(t,e){if(t){if(typeof t=="string")return R0(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R0(t,e)}}function R0(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function q8(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Q8=Object.hasOwnProperty,NP=Object.setPrototypeOf,Z8=Object.isFrozen,J8=Object.getPrototypeOf,e9=Object.getOwnPropertyDescriptor,mr=Object.freeze,Gi=Object.seal,t9=Object.create,JF=typeof Reflect<"u"&&Reflect,Gp=JF.apply,E0=JF.construct;Gp||(Gp=function(e,n,r){return e.apply(n,r)});mr||(mr=function(e){return e});Gi||(Gi=function(e){return e});E0||(E0=function(e,n){return Gm(e,Oi(n))});var n9=mi(Array.prototype.forEach),kP=mi(Array.prototype.pop),sh=mi(Array.prototype.push),jm=mi(String.prototype.toLowerCase),JC=mi(String.prototype.toString),r9=mi(String.prototype.match),Si=mi(String.prototype.replace),i9=mi(String.prototype.indexOf),o9=mi(String.prototype.trim),rr=mi(RegExp.prototype.test),ey=s9(TypeError);function mi(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Gp(t,e,r)}}function s9(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return E0(t,n)}}function qe(t,e,n){var r;n=(r=n)!==null&&r!==void 0?r:jm,NP&&NP(t,null);for(var i=e.length;i--;){var o=e[i];if(typeof o=="string"){var s=n(o);s!==o&&(Z8(e)||(e[i]=s),o=s)}t[o]=!0}return t}function $a(t){var e=t9(null),n;for(n in t)Gp(Q8,t,[n])===!0&&(e[n]=t[n]);return e}function wg(t,e){for(;t!==null;){var n=e9(t,e);if(n){if(n.get)return mi(n.get);if(typeof n.value=="function")return mi(n.value)}t=J8(t)}function r(i){return console.warn("fallback value for",i),null}return r}var LP=mr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ty=mr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ny=mr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),a9=mr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ry=mr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),l9=mr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),$P=mr(["#text"]),FP=mr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),iy=mr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),WP=mr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),vg=mr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),u9=Gi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),c9=Gi(/<%[\w\W]*|[\w\W]*%>/gm),h9=Gi(/\${[\w\W]*}/gm),d9=Gi(/^data-[\-\w.\u00B7-\uFFFF]/),f9=Gi(/^aria-[\-\w]+$/),g9=Gi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),m9=Gi(/^(?:\w+script|data):/i),p9=Gi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),w9=Gi(/^html$/i),v9=function(){return typeof window>"u"?null:window},C9=function(e,n){if(Qs(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function eW(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v9(),e=function($){return eW($)};if(e.version="2.4.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,r=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,h=t.HTMLFormElement,f=t.DOMParser,g=t.trustedTypes,p=a.prototype,y=wg(p,"cloneNode"),E=wg(p,"nextSibling"),v=wg(p,"childNodes"),C=wg(p,"parentNode");if(typeof o=="function"){var S=r.createElement("template");S.content&&S.content.ownerDocument&&(r=S.content.ownerDocument)}var T=C9(g,n),_=T?T.createHTML(""):"",H=r,D=H.implementation,B=H.createNodeIterator,z=H.createDocumentFragment,G=H.getElementsByTagName,Z=n.importNode,re={};try{re=$a(r).documentMode?r.documentMode:{}}catch{}var ne={};e.isSupported=typeof C=="function"&&D&&D.createHTMLDocument!==void 0&&re!==9;var ue=u9,Ee=c9,$e=h9,He=d9,R=f9,d=m9,m=p9,w=g9,x=null,O=qe({},[].concat(Oi(LP),Oi(ty),Oi(ny),Oi(ry),Oi($P))),A=null,K=qe({},[].concat(Oi(FP),Oi(iy),Oi(WP),Oi(vg))),U=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Q=null,J=null,q=!0,fe=!0,Ae=!1,Pe=!0,Oe=!1,X=!1,Xe=!1,Ue=!1,_e=!1,Ne=!1,Te=!1,b=!0,M=!1,I="user-content-",V=!0,N=!1,W={},k=null,L=qe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),j=null,F=qe({},["audio","video","img","source","image","track"]),Y=null,ae=qe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ge="http://www.w3.org/1998/Math/MathML",be="http://www.w3.org/2000/svg",Ie="http://www.w3.org/1999/xhtml",Ve=Ie,Et=!1,Ze=null,dt=qe({},[ge,be,Ie],JC),Ht,nu=["application/xhtml+xml","text/html"],qc="text/html",Qt,On=null,ka=r.createElement("form"),nr=function($){return $ instanceof RegExp||$ instanceof Function},mn=function($){On&&On===$||((!$||Qs($)!=="object")&&($={}),$=$a($),Ht=nu.indexOf($.PARSER_MEDIA_TYPE)===-1?Ht=qc:Ht=$.PARSER_MEDIA_TYPE,Qt=Ht==="application/xhtml+xml"?JC:jm,x="ALLOWED_TAGS"in $?qe({},$.ALLOWED_TAGS,Qt):O,A="ALLOWED_ATTR"in $?qe({},$.ALLOWED_ATTR,Qt):K,Ze="ALLOWED_NAMESPACES"in $?qe({},$.ALLOWED_NAMESPACES,JC):dt,Y="ADD_URI_SAFE_ATTR"in $?qe($a(ae),$.ADD_URI_SAFE_ATTR,Qt):ae,j="ADD_DATA_URI_TAGS"in $?qe($a(F),$.ADD_DATA_URI_TAGS,Qt):F,k="FORBID_CONTENTS"in $?qe({},$.FORBID_CONTENTS,Qt):L,Q="FORBID_TAGS"in $?qe({},$.FORBID_TAGS,Qt):{},J="FORBID_ATTR"in $?qe({},$.FORBID_ATTR,Qt):{},W="USE_PROFILES"in $?$.USE_PROFILES:!1,q=$.ALLOW_ARIA_ATTR!==!1,fe=$.ALLOW_DATA_ATTR!==!1,Ae=$.ALLOW_UNKNOWN_PROTOCOLS||!1,Pe=$.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Oe=$.SAFE_FOR_TEMPLATES||!1,X=$.WHOLE_DOCUMENT||!1,_e=$.RETURN_DOM||!1,Ne=$.RETURN_DOM_FRAGMENT||!1,Te=$.RETURN_TRUSTED_TYPE||!1,Ue=$.FORCE_BODY||!1,b=$.SANITIZE_DOM!==!1,M=$.SANITIZE_NAMED_PROPS||!1,V=$.KEEP_CONTENT!==!1,N=$.IN_PLACE||!1,w=$.ALLOWED_URI_REGEXP||w,Ve=$.NAMESPACE||Ie,U=$.CUSTOM_ELEMENT_HANDLING||{},$.CUSTOM_ELEMENT_HANDLING&&nr($.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(U.tagNameCheck=$.CUSTOM_ELEMENT_HANDLING.tagNameCheck),$.CUSTOM_ELEMENT_HANDLING&&nr($.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(U.attributeNameCheck=$.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),$.CUSTOM_ELEMENT_HANDLING&&typeof $.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(U.allowCustomizedBuiltInElements=$.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Oe&&(fe=!1),Ne&&(_e=!0),W&&(x=qe({},Oi($P)),A=[],W.html===!0&&(qe(x,LP),qe(A,FP)),W.svg===!0&&(qe(x,ty),qe(A,iy),qe(A,vg)),W.svgFilters===!0&&(qe(x,ny),qe(A,iy),qe(A,vg)),W.mathMl===!0&&(qe(x,ry),qe(A,WP),qe(A,vg))),$.ADD_TAGS&&(x===O&&(x=$a(x)),qe(x,$.ADD_TAGS,Qt)),$.ADD_ATTR&&(A===K&&(A=$a(A)),qe(A,$.ADD_ATTR,Qt)),$.ADD_URI_SAFE_ATTR&&qe(Y,$.ADD_URI_SAFE_ATTR,Qt),$.FORBID_CONTENTS&&(k===L&&(k=$a(k)),qe(k,$.FORBID_CONTENTS,Qt)),V&&(x["#text"]=!0),X&&qe(x,["html","head","body"]),x.table&&(qe(x,["tbody"]),delete Q.tbody),mr&&mr($),On=$)},_t=qe({},["mi","mo","mn","ms","mtext"]),PM=qe({},["foreignobject","desc","title","annotation-xml"]),Yz=qe({},["title","style","font","a","script"]),Kf=qe({},ty);qe(Kf,ny),qe(Kf,a9);var iC=qe({},ry);qe(iC,l9);var Kz=function($){var se=C($);(!se||!se.tagName)&&(se={namespaceURI:Ve,tagName:"template"});var ce=jm($.tagName),ht=jm(se.tagName);return Ze[$.namespaceURI]?$.namespaceURI===be?se.namespaceURI===Ie?ce==="svg":se.namespaceURI===ge?ce==="svg"&&(ht==="annotation-xml"||_t[ht]):!!Kf[ce]:$.namespaceURI===ge?se.namespaceURI===Ie?ce==="math":se.namespaceURI===be?ce==="math"&&PM[ht]:!!iC[ce]:$.namespaceURI===Ie?se.namespaceURI===be&&!PM[ht]||se.namespaceURI===ge&&!_t[ht]?!1:!iC[ce]&&(Yz[ce]||!Kf[ce]):!!(Ht==="application/xhtml+xml"&&Ze[$.namespaceURI]):!1},Ao=function($){sh(e.removed,{element:$});try{$.parentNode.removeChild($)}catch{try{$.outerHTML=_}catch{$.remove()}}},oC=function($,se){try{sh(e.removed,{attribute:se.getAttributeNode($),from:se})}catch{sh(e.removed,{attribute:null,from:se})}if(se.removeAttribute($),$==="is"&&!A[$])if(_e||Ne)try{Ao(se)}catch{}else try{se.setAttribute($,"")}catch{}},OM=function($){var se,ce;if(Ue)$="<remove></remove>"+$;else{var ht=r9($,/^[\r\n\t ]+/);ce=ht&&ht[0]}Ht==="application/xhtml+xml"&&Ve===Ie&&($='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+$+"</body></html>");var yr=T?T.createHTML($):$;if(Ve===Ie)try{se=new f().parseFromString(yr,Ht)}catch{}if(!se||!se.documentElement){se=D.createDocument(Ve,"template",null);try{se.documentElement.innerHTML=Et?_:yr}catch{}}var Fn=se.body||se.documentElement;return $&&ce&&Fn.insertBefore(r.createTextNode(ce),Fn.childNodes[0]||null),Ve===Ie?G.call(se,X?"html":"body")[0]:X?se.documentElement:Fn},AM=function($){return B.call($.ownerDocument||$,$,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},Xz=function($){return $ instanceof h&&(typeof $.nodeName!="string"||typeof $.textContent!="string"||typeof $.removeChild!="function"||!($.attributes instanceof c)||typeof $.removeAttribute!="function"||typeof $.setAttribute!="function"||typeof $.namespaceURI!="string"||typeof $.insertBefore!="function"||typeof $.hasChildNodes!="function")},Qc=function($){return Qs(s)==="object"?$ instanceof s:$&&Qs($)==="object"&&typeof $.nodeType=="number"&&typeof $.nodeName=="string"},Io=function($,se,ce){ne[$]&&n9(ne[$],function(ht){ht.call(e,se,ce,On)})},IM=function($){var se;if(Io("beforeSanitizeElements",$,null),Xz($)||rr(/[\u0080-\uFFFF]/,$.nodeName))return Ao($),!0;var ce=Qt($.nodeName);if(Io("uponSanitizeElement",$,{tagName:ce,allowedTags:x}),$.hasChildNodes()&&!Qc($.firstElementChild)&&(!Qc($.content)||!Qc($.content.firstElementChild))&&rr(/<[/\w]/g,$.innerHTML)&&rr(/<[/\w]/g,$.textContent)||ce==="select"&&rr(/<template/i,$.innerHTML))return Ao($),!0;if(!x[ce]||Q[ce]){if(!Q[ce]&&DM(ce)&&(U.tagNameCheck instanceof RegExp&&rr(U.tagNameCheck,ce)||U.tagNameCheck instanceof Function&&U.tagNameCheck(ce)))return!1;if(V&&!k[ce]){var ht=C($)||$.parentNode,yr=v($)||$.childNodes;if(yr&&ht)for(var Fn=yr.length,An=Fn-1;An>=0;--An)ht.insertBefore(y(yr[An],!0),E($))}return Ao($),!0}return $ instanceof a&&!Kz($)||(ce==="noscript"||ce==="noembed"||ce==="noframes")&&rr(/<\/no(script|embed|frames)/i,$.innerHTML)?(Ao($),!0):(Oe&&$.nodeType===3&&(se=$.textContent,se=Si(se,ue," "),se=Si(se,Ee," "),se=Si(se,$e," "),$.textContent!==se&&(sh(e.removed,{element:$.cloneNode()}),$.textContent=se)),Io("afterSanitizeElements",$,null),!1)},HM=function($,se,ce){if(b&&(se==="id"||se==="name")&&(ce in r||ce in ka))return!1;if(!(fe&&!J[se]&&rr(He,se))){if(!(q&&rr(R,se))){if(!A[se]||J[se]){if(!(DM($)&&(U.tagNameCheck instanceof RegExp&&rr(U.tagNameCheck,$)||U.tagNameCheck instanceof Function&&U.tagNameCheck($))&&(U.attributeNameCheck instanceof RegExp&&rr(U.attributeNameCheck,se)||U.attributeNameCheck instanceof Function&&U.attributeNameCheck(se))||se==="is"&&U.allowCustomizedBuiltInElements&&(U.tagNameCheck instanceof RegExp&&rr(U.tagNameCheck,ce)||U.tagNameCheck instanceof Function&&U.tagNameCheck(ce))))return!1}else if(!Y[se]){if(!rr(w,Si(ce,m,""))){if(!((se==="src"||se==="xlink:href"||se==="href")&&$!=="script"&&i9(ce,"data:")===0&&j[$])){if(!(Ae&&!rr(d,Si(ce,m,"")))){if(ce)return!1}}}}}}return!0},DM=function($){return $.indexOf("-")>0},NM=function($){var se,ce,ht,yr;Io("beforeSanitizeAttributes",$,null);var Fn=$.attributes;if(Fn){var An={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:A};for(yr=Fn.length;yr--;){se=Fn[yr];var Xf=se,Sn=Xf.name,sC=Xf.namespaceURI;if(ce=Sn==="value"?se.value:o9(se.value),ht=Qt(Sn),An.attrName=ht,An.attrValue=ce,An.keepAttr=!0,An.forceKeepAttr=void 0,Io("uponSanitizeAttribute",$,An),ce=An.attrValue,!An.forceKeepAttr&&(oC(Sn,$),!!An.keepAttr)){if(!Pe&&rr(/\/>/i,ce)){oC(Sn,$);continue}Oe&&(ce=Si(ce,ue," "),ce=Si(ce,Ee," "),ce=Si(ce,$e," "));var kM=Qt($.nodeName);if(HM(kM,ht,ce)){if(M&&(ht==="id"||ht==="name")&&(oC(Sn,$),ce=I+ce),T&&Qs(g)==="object"&&typeof g.getAttributeType=="function"&&!sC)switch(g.getAttributeType(kM,ht)){case"TrustedHTML":{ce=T.createHTML(ce);break}case"TrustedScriptURL":{ce=T.createScriptURL(ce);break}}try{sC?$.setAttributeNS(sC,Sn,ce):$.setAttribute(Sn,ce),kP(e.removed)}catch{}}}}Io("afterSanitizeAttributes",$,null)}},qz=function Me($){var se,ce=AM($);for(Io("beforeSanitizeShadowDOM",$,null);se=ce.nextNode();)Io("uponSanitizeShadowNode",se,null),!IM(se)&&(se.content instanceof i&&Me(se.content),NM(se));Io("afterSanitizeShadowDOM",$,null)};return e.sanitize=function(Me){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},se,ce,ht,yr,Fn;if(Et=!Me,Et&&(Me="<!-->"),typeof Me!="string"&&!Qc(Me))if(typeof Me.toString=="function"){if(Me=Me.toString(),typeof Me!="string")throw ey("dirty is not a string, aborting")}else throw ey("toString is not a function");if(!e.isSupported){if(Qs(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Me=="string")return t.toStaticHTML(Me);if(Qc(Me))return t.toStaticHTML(Me.outerHTML)}return Me}if(Xe||mn($),e.removed=[],typeof Me=="string"&&(N=!1),N){if(Me.nodeName){var An=Qt(Me.nodeName);if(!x[An]||Q[An])throw ey("root node is forbidden and cannot be sanitized in-place")}}else if(Me instanceof s)se=OM("<!---->"),ce=se.ownerDocument.importNode(Me,!0),ce.nodeType===1&&ce.nodeName==="BODY"||ce.nodeName==="HTML"?se=ce:se.appendChild(ce);else{if(!_e&&!Oe&&!X&&Me.indexOf("<")===-1)return T&&Te?T.createHTML(Me):Me;if(se=OM(Me),!se)return _e?null:Te?_:""}se&&Ue&&Ao(se.firstChild);for(var Xf=AM(N?Me:se);ht=Xf.nextNode();)ht.nodeType===3&&ht===yr||IM(ht)||(ht.content instanceof i&&qz(ht.content),NM(ht),yr=ht);if(yr=null,N)return Me;if(_e){if(Ne)for(Fn=z.call(se.ownerDocument);se.firstChild;)Fn.appendChild(se.firstChild);else Fn=se;return(A.shadowroot||A.shadowrootmod)&&(Fn=Z.call(n,Fn,!0)),Fn}var Sn=X?se.outerHTML:se.innerHTML;return X&&x["!doctype"]&&se.ownerDocument&&se.ownerDocument.doctype&&se.ownerDocument.doctype.name&&rr(w9,se.ownerDocument.doctype.name)&&(Sn="<!DOCTYPE "+se.ownerDocument.doctype.name+`>
`+Sn),Oe&&(Sn=Si(Sn,ue," "),Sn=Si(Sn,Ee," "),Sn=Si(Sn,$e," ")),T&&Te?T.createHTML(Sn):Sn},e.setConfig=function(Me){mn(Me),Xe=!0},e.clearConfig=function(){On=null,Xe=!1},e.isValidAttribute=function(Me,$,se){On||mn({});var ce=Qt(Me),ht=Qt($);return HM(ce,ht,se)},e.addHook=function(Me,$){typeof $=="function"&&(ne[Me]=ne[Me]||[],sh(ne[Me],$))},e.removeHook=function(Me){if(ne[Me])return kP(ne[Me])},e.removeHooks=function(Me){ne[Me]&&(ne[Me]=[])},e.removeAllHooks=function(){ne={}},e}var y9=eW();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var tW;function ee(){return tW.apply(null,arguments)}function S9(t){tW=t}function ji(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Il(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function ut(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function BE(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(ut(t,e))return!1;return!0}function Tr(t){return t===void 0}function vs(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Mf(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function nW(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function ta(t,e){for(var n in e)ut(e,n)&&(t[n]=e[n]);return ut(e,"toString")&&(t.toString=e.toString),ut(e,"valueOf")&&(t.valueOf=e.valueOf),t}function xo(t,e,n,r){return _W(t,e,n,r,!0).utc()}function b9(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ye(t){return t._pf==null&&(t._pf=b9()),t._pf}var T0;Array.prototype.some?T0=Array.prototype.some:T0=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function UE(t){if(t._isValid==null){var e=Ye(t),n=T0.call(e.parsedDateParts,function(i){return i!=null}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r}return t._isValid}function nv(t){var e=xo(NaN);return t!=null?ta(Ye(e),t):Ye(e).userInvalidated=!0,e}var VP=ee.momentProperties=[],oy=!1;function zE(t,e){var n,r,i,o=VP.length;if(Tr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Tr(e._i)||(t._i=e._i),Tr(e._f)||(t._f=e._f),Tr(e._l)||(t._l=e._l),Tr(e._strict)||(t._strict=e._strict),Tr(e._tzm)||(t._tzm=e._tzm),Tr(e._isUTC)||(t._isUTC=e._isUTC),Tr(e._offset)||(t._offset=e._offset),Tr(e._pf)||(t._pf=Ye(e)),Tr(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=VP[n],i=e[r],Tr(i)||(t[r]=i);return t}function xf(t){zE(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),oy===!1&&(oy=!0,ee.updateOffset(this),oy=!1)}function Yi(t){return t instanceof xf||t!=null&&t._isAMomentObject!=null}function rW(t){ee.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function wi(t,e){var n=!0;return ta(function(){if(ee.deprecationHandler!=null&&ee.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])ut(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}rW(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var BP={};function iW(t,e){ee.deprecationHandler!=null&&ee.deprecationHandler(t,e),BP[t]||(rW(e),BP[t]=!0)}ee.suppressDeprecationWarnings=!1;ee.deprecationHandler=null;function Po(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function R9(t){var e,n;for(n in t)ut(t,n)&&(e=t[n],Po(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function _0(t,e){var n=ta({},t),r;for(r in e)ut(e,r)&&(Il(t[r])&&Il(e[r])?(n[r]={},ta(n[r],t[r]),ta(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)ut(t,r)&&!ut(e,r)&&Il(t[r])&&(n[r]=ta({},n[r]));return n}function GE(t){t!=null&&this.set(t)}var M0;Object.keys?M0=Object.keys:M0=function(t){var e,n=[];for(e in t)ut(t,e)&&n.push(e);return n};var E9={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function T9(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Po(r)?r.call(e,n):r}function To(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var jE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Cg=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,sy={},pc={};function xe(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(pc[t]=i),e&&(pc[e[0]]=function(){return To(i.apply(this,arguments),e[1],e[2])}),n&&(pc[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function _9(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function M9(t){var e=t.match(jE),n,r;for(n=0,r=e.length;n<r;n++)pc[e[n]]?e[n]=pc[e[n]]:e[n]=_9(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=Po(e[s])?e[s].call(i,t):e[s];return o}}function Ym(t,e){return t.isValid()?(e=oW(e,t.localeData()),sy[e]=sy[e]||M9(e),sy[e](t)):t.localeData().invalidDate()}function oW(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Cg.lastIndex=0;n>=0&&Cg.test(t);)t=t.replace(Cg,r),Cg.lastIndex=0,n-=1;return t}var x9={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function P9(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(jE).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var O9="Invalid date";function A9(){return this._invalidDate}var I9="%d",H9=/\d{1,2}/;function D9(t){return this._ordinal.replace("%d",t)}var N9={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function k9(t,e,n,r){var i=this._relativeTime[n];return Po(i)?i(t,e,n,r):i.replace(/%d/i,t)}function L9(t,e){var n=this._relativeTime[t>0?"future":"past"];return Po(n)?n(e):n.replace(/%s/i,e)}var dd={};function er(t,e){var n=t.toLowerCase();dd[n]=dd[n+"s"]=dd[e]=t}function vi(t){return typeof t=="string"?dd[t]||dd[t.toLowerCase()]:void 0}function YE(t){var e={},n,r;for(r in t)ut(t,r)&&(n=vi(r),n&&(e[n]=t[r]));return e}var sW={};function tr(t,e){sW[t]=e}function $9(t){var e=[],n;for(n in t)ut(t,n)&&e.push({unit:n,priority:sW[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}function rv(t){return t%4===0&&t%100!==0||t%400===0}function ci(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function tt(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=ci(e)),n}function Fc(t,e){return function(n){return n!=null?(aW(this,t,n),ee.updateOffset(this,e),this):jp(this,t)}}function jp(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function aW(t,e,n){t.isValid()&&!isNaN(n)&&(e==="FullYear"&&rv(t.year())&&t.month()===1&&t.date()===29?(n=tt(n),t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),uv(n,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function F9(t){return t=vi(t),Po(this[t])?this[t]():this}function W9(t,e){if(typeof t=="object"){t=YE(t);var n=$9(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=vi(t),Po(this[t]))return this[t](e);return this}var lW=/\d/,Qr=/\d\d/,uW=/\d{3}/,KE=/\d{4}/,iv=/[+-]?\d{6}/,It=/\d\d?/,cW=/\d\d\d\d?/,hW=/\d\d\d\d\d\d?/,ov=/\d{1,3}/,XE=/\d{1,4}/,sv=/[+-]?\d{1,6}/,Wc=/\d+/,av=/[+-]?\d+/,V9=/Z|[+-]\d\d:?\d\d/gi,lv=/Z|[+-]\d\d(?::?\d\d)?/gi,B9=/[+-]?\d+(\.\d{1,3})?/,Pf=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Yp;Yp={};function ve(t,e,n){Yp[t]=Po(e)?e:function(r,i){return r&&n?n:e}}function U9(t,e){return ut(Yp,t)?Yp[t](e._strict,e._locale):new RegExp(z9(t))}function z9(t){return Br(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Br(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var x0={};function wt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),vs(e)&&(r=function(o,s){s[e]=tt(o)}),i=t.length,n=0;n<i;n++)x0[t[n]]=r}function Of(t,e){wt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function G9(t,e,n){e!=null&&ut(x0,t)&&x0[t](e,n._a,n,t)}var Xn=0,rs=1,Co=2,Cn=3,$i=4,is=5,El=6,j9=7,Y9=8;function K9(t,e){return(t%e+e)%e}var nn;Array.prototype.indexOf?nn=Array.prototype.indexOf:nn=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function uv(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=K9(e,12);return t+=(e-n)/12,n===1?rv(t)?29:28:31-n%7%2}xe("M",["MM",2],"Mo",function(){return this.month()+1});xe("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});xe("MMMM",0,0,function(t){return this.localeData().months(this,t)});er("month","M");tr("month",8);ve("M",It);ve("MM",It,Qr);ve("MMM",function(t,e){return e.monthsShortRegex(t)});ve("MMMM",function(t,e){return e.monthsRegex(t)});wt(["M","MM"],function(t,e){e[rs]=tt(t)-1});wt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[rs]=i:Ye(n).invalidMonth=t});var X9="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),dW="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),fW=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,q9=Pf,Q9=Pf;function Z9(t,e){return t?ji(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||fW).test(e)?"format":"standalone"][t.month()]:ji(this._months)?this._months:this._months.standalone}function J9(t,e){return t?ji(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[fW.test(e)?"format":"standalone"][t.month()]:ji(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function e5(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=xo([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=nn.call(this._shortMonthsParse,s),i!==-1?i:null):(i=nn.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=nn.call(this._shortMonthsParse,s),i!==-1?i:(i=nn.call(this._longMonthsParse,s),i!==-1?i:null)):(i=nn.call(this._longMonthsParse,s),i!==-1?i:(i=nn.call(this._shortMonthsParse,s),i!==-1?i:null))}function t5(t,e,n){var r,i,o;if(this._monthsParseExact)return e5.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=xo([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function gW(t,e){var n;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=tt(e);else if(e=t.localeData().monthsParse(e),!vs(e))return t}return n=Math.min(t.date(),uv(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function mW(t){return t!=null?(gW(this,t),ee.updateOffset(this,!0),this):jp(this,"Month")}function n5(){return uv(this.year(),this.month())}function r5(t){return this._monthsParseExact?(ut(this,"_monthsRegex")||pW.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(ut(this,"_monthsShortRegex")||(this._monthsShortRegex=q9),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function i5(t){return this._monthsParseExact?(ut(this,"_monthsRegex")||pW.call(this),t?this._monthsStrictRegex:this._monthsRegex):(ut(this,"_monthsRegex")||(this._monthsRegex=Q9),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function pW(){function t(s,a){return a.length-s.length}var e=[],n=[],r=[],i,o;for(i=0;i<12;i++)o=xo([2e3,i]),e.push(this.monthsShort(o,"")),n.push(this.months(o,"")),r.push(this.months(o,"")),r.push(this.monthsShort(o,""));for(e.sort(t),n.sort(t),r.sort(t),i=0;i<12;i++)e[i]=Br(e[i]),n[i]=Br(n[i]);for(i=0;i<24;i++)r[i]=Br(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}xe("Y",0,0,function(){var t=this.year();return t<=9999?To(t,4):"+"+t});xe(0,["YY",2],0,function(){return this.year()%100});xe(0,["YYYY",4],0,"year");xe(0,["YYYYY",5],0,"year");xe(0,["YYYYYY",6,!0],0,"year");er("year","y");tr("year",1);ve("Y",av);ve("YY",It,Qr);ve("YYYY",XE,KE);ve("YYYYY",sv,iv);ve("YYYYYY",sv,iv);wt(["YYYYY","YYYYYY"],Xn);wt("YYYY",function(t,e){e[Xn]=t.length===2?ee.parseTwoDigitYear(t):tt(t)});wt("YY",function(t,e){e[Xn]=ee.parseTwoDigitYear(t)});wt("Y",function(t,e){e[Xn]=parseInt(t,10)});function fd(t){return rv(t)?366:365}ee.parseTwoDigitYear=function(t){return tt(t)+(tt(t)>68?1900:2e3)};var wW=Fc("FullYear",!0);function o5(){return rv(this.year())}function s5(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Kd(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Kp(t,e,n){var r=7+e-n,i=(7+Kd(t,0,r).getUTCDay()-e)%7;return-i+r-1}function vW(t,e,n,r,i){var o=(7+n-r)%7,s=Kp(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=fd(l)+a):a>fd(t)?(l=t+1,u=a-fd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Xd(t,e,n){var r=Kp(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+fs(s,e,n)):i>fs(t.year(),e,n)?(o=i-fs(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function fs(t,e,n){var r=Kp(t,e,n),i=Kp(t+1,e,n);return(fd(t)-r+i)/7}xe("w",["ww",2],"wo","week");xe("W",["WW",2],"Wo","isoWeek");er("week","w");er("isoWeek","W");tr("week",5);tr("isoWeek",5);ve("w",It);ve("ww",It,Qr);ve("W",It);ve("WW",It,Qr);Of(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=tt(t)});function a5(t){return Xd(t,this._week.dow,this._week.doy).week}var l5={dow:0,doy:6};function u5(){return this._week.dow}function c5(){return this._week.doy}function h5(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function d5(t){var e=Xd(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}xe("d",0,"do","day");xe("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});xe("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});xe("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});xe("e",0,0,"weekday");xe("E",0,0,"isoWeekday");er("day","d");er("weekday","e");er("isoWeekday","E");tr("day",11);tr("weekday",11);tr("isoWeekday",11);ve("d",It);ve("e",It);ve("E",It);ve("dd",function(t,e){return e.weekdaysMinRegex(t)});ve("ddd",function(t,e){return e.weekdaysShortRegex(t)});ve("dddd",function(t,e){return e.weekdaysRegex(t)});Of(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Ye(n).invalidWeekday=t});Of(["d","e","E"],function(t,e,n,r){e[r]=tt(t)});function f5(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function g5(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function qE(t,e){return t.slice(e,7).concat(t.slice(0,e))}var m5="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),CW="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),p5="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),w5=Pf,v5=Pf,C5=Pf;function y5(t,e){var n=ji(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?qE(n,this._week.dow):t?n[t.day()]:n}function S5(t){return t===!0?qE(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function b5(t){return t===!0?qE(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function R5(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=xo([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=nn.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=nn.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=nn.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=nn.call(this._weekdaysParse,s),i!==-1||(i=nn.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=nn.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=nn.call(this._shortWeekdaysParse,s),i!==-1||(i=nn.call(this._weekdaysParse,s),i!==-1)?i:(i=nn.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=nn.call(this._minWeekdaysParse,s),i!==-1||(i=nn.call(this._weekdaysParse,s),i!==-1)?i:(i=nn.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function E5(t,e,n){var r,i,o;if(this._weekdaysParseExact)return R5.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=xo([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function T5(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=f5(t,this.localeData()),this.add(t-e,"d")):e}function _5(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function M5(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=g5(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function x5(t){return this._weekdaysParseExact?(ut(this,"_weekdaysRegex")||QE.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(ut(this,"_weekdaysRegex")||(this._weekdaysRegex=w5),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function P5(t){return this._weekdaysParseExact?(ut(this,"_weekdaysRegex")||QE.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(ut(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=v5),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function O5(t){return this._weekdaysParseExact?(ut(this,"_weekdaysRegex")||QE.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(ut(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=C5),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function QE(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=xo([2e3,1]).day(o),a=Br(this.weekdaysMin(s,"")),l=Br(this.weekdaysShort(s,"")),u=Br(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function ZE(){return this.hours()%12||12}function A5(){return this.hours()||24}xe("H",["HH",2],0,"hour");xe("h",["hh",2],0,ZE);xe("k",["kk",2],0,A5);xe("hmm",0,0,function(){return""+ZE.apply(this)+To(this.minutes(),2)});xe("hmmss",0,0,function(){return""+ZE.apply(this)+To(this.minutes(),2)+To(this.seconds(),2)});xe("Hmm",0,0,function(){return""+this.hours()+To(this.minutes(),2)});xe("Hmmss",0,0,function(){return""+this.hours()+To(this.minutes(),2)+To(this.seconds(),2)});function yW(t,e){xe(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}yW("a",!0);yW("A",!1);er("hour","h");tr("hour",13);function SW(t,e){return e._meridiemParse}ve("a",SW);ve("A",SW);ve("H",It);ve("h",It);ve("k",It);ve("HH",It,Qr);ve("hh",It,Qr);ve("kk",It,Qr);ve("hmm",cW);ve("hmmss",hW);ve("Hmm",cW);ve("Hmmss",hW);wt(["H","HH"],Cn);wt(["k","kk"],function(t,e,n){var r=tt(t);e[Cn]=r===24?0:r});wt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});wt(["h","hh"],function(t,e,n){e[Cn]=tt(t),Ye(n).bigHour=!0});wt("hmm",function(t,e,n){var r=t.length-2;e[Cn]=tt(t.substr(0,r)),e[$i]=tt(t.substr(r)),Ye(n).bigHour=!0});wt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Cn]=tt(t.substr(0,r)),e[$i]=tt(t.substr(r,2)),e[is]=tt(t.substr(i)),Ye(n).bigHour=!0});wt("Hmm",function(t,e,n){var r=t.length-2;e[Cn]=tt(t.substr(0,r)),e[$i]=tt(t.substr(r))});wt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Cn]=tt(t.substr(0,r)),e[$i]=tt(t.substr(r,2)),e[is]=tt(t.substr(i))});function I5(t){return(t+"").toLowerCase().charAt(0)==="p"}var H5=/[ap]\.?m?\.?/i,D5=Fc("Hours",!0);function N5(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var bW={calendar:E9,longDateFormat:x9,invalidDate:O9,ordinal:I9,dayOfMonthOrdinalParse:H9,relativeTime:N9,months:X9,monthsShort:dW,week:l5,weekdays:m5,weekdaysMin:p5,weekdaysShort:CW,meridiemParse:H5},kt={},ah={},qd;function k5(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function UP(t){return t&&t.toLowerCase().replace("_","-")}function L5(t){for(var e=0,n,r,i,o;e<t.length;){for(o=UP(t[e]).split("-"),n=o.length,r=UP(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=cv(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&k5(o,r)>=n-1)break;n--}e++}return qd}function $5(t){return t.match("^[^/\\\\]*$")!=null}function cv(t){var e=null,n;if(kt[t]===void 0&&typeof pp<"u"&&pp&&pp.exports&&$5(t))try{e=qd._abbr,n=require,n("./locale/"+t),ga(e)}catch{kt[t]=null}return kt[t]}function ga(t,e){var n;return t&&(Tr(e)?n=Es(t):n=JE(t,e),n?qd=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),qd._abbr}function JE(t,e){if(e!==null){var n,r=bW;if(e.abbr=t,kt[t]!=null)iW("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=kt[t]._config;else if(e.parentLocale!=null)if(kt[e.parentLocale]!=null)r=kt[e.parentLocale]._config;else if(n=cv(e.parentLocale),n!=null)r=n._config;else return ah[e.parentLocale]||(ah[e.parentLocale]=[]),ah[e.parentLocale].push({name:t,config:e}),null;return kt[t]=new GE(_0(r,e)),ah[t]&&ah[t].forEach(function(i){JE(i.name,i.config)}),ga(t),kt[t]}else return delete kt[t],null}function F5(t,e){if(e!=null){var n,r,i=bW;kt[t]!=null&&kt[t].parentLocale!=null?kt[t].set(_0(kt[t]._config,e)):(r=cv(t),r!=null&&(i=r._config),e=_0(i,e),r==null&&(e.abbr=t),n=new GE(e),n.parentLocale=kt[t],kt[t]=n),ga(t)}else kt[t]!=null&&(kt[t].parentLocale!=null?(kt[t]=kt[t].parentLocale,t===ga()&&ga(t)):kt[t]!=null&&delete kt[t]);return kt[t]}function Es(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return qd;if(!ji(t)){if(e=cv(t),e)return e;t=[t]}return L5(t)}function W5(){return M0(kt)}function eT(t){var e,n=t._a;return n&&Ye(t).overflow===-2&&(e=n[rs]<0||n[rs]>11?rs:n[Co]<1||n[Co]>uv(n[Xn],n[rs])?Co:n[Cn]<0||n[Cn]>24||n[Cn]===24&&(n[$i]!==0||n[is]!==0||n[El]!==0)?Cn:n[$i]<0||n[$i]>59?$i:n[is]<0||n[is]>59?is:n[El]<0||n[El]>999?El:-1,Ye(t)._overflowDayOfYear&&(e<Xn||e>Co)&&(e=Co),Ye(t)._overflowWeeks&&e===-1&&(e=j9),Ye(t)._overflowWeekday&&e===-1&&(e=Y9),Ye(t).overflow=e),t}var V5=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,B5=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,U5=/Z|[+-]\d\d(?::?\d\d)?/,yg=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],ay=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],z5=/^\/?Date\((-?\d+)/i,G5=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,j5={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function RW(t){var e,n,r=t._i,i=V5.exec(r)||B5.exec(r),o,s,a,l,u=yg.length,c=ay.length;if(i){for(Ye(t).iso=!0,e=0,n=u;e<n;e++)if(yg[e][1].exec(i[1])){s=yg[e][0],o=yg[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(ay[e][1].exec(i[3])){a=(i[2]||" ")+ay[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(U5.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),nT(t)}else t._isValid=!1}function Y5(t,e,n,r,i,o){var s=[K5(t),dW.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function K5(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function X5(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function q5(t,e,n){if(t){var r=CW.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Ye(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function Q5(t,e,n){if(t)return j5[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function EW(t){var e=G5.exec(X5(t._i)),n;if(e){if(n=Y5(e[4],e[3],e[2],e[5],e[6],e[7]),!q5(e[1],n,t))return;t._a=n,t._tzm=Q5(e[8],e[9],e[10]),t._d=Kd.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ye(t).rfc2822=!0}else t._isValid=!1}function Z5(t){var e=z5.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(RW(t),t._isValid===!1)delete t._isValid;else return;if(EW(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:ee.createFromInputFallback(t)}ee.createFromInputFallback=wi("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Bu(t,e,n){return t??e??n}function J5(t){var e=new Date(ee.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function tT(t){var e,n,r=[],i,o,s;if(!t._d){for(i=J5(t),t._w&&t._a[Co]==null&&t._a[rs]==null&&e7(t),t._dayOfYear!=null&&(s=Bu(t._a[Xn],i[Xn]),(t._dayOfYear>fd(s)||t._dayOfYear===0)&&(Ye(t)._overflowDayOfYear=!0),n=Kd(s,0,t._dayOfYear),t._a[rs]=n.getUTCMonth(),t._a[Co]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Cn]===24&&t._a[$i]===0&&t._a[is]===0&&t._a[El]===0&&(t._nextDay=!0,t._a[Cn]=0),t._d=(t._useUTC?Kd:s5).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Cn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Ye(t).weekdayMismatch=!0)}}function e7(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=Bu(e.GG,t._a[Xn],Xd(At(),1,4).year),r=Bu(e.W,1),i=Bu(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Xd(At(),o,s),n=Bu(e.gg,t._a[Xn],u.year),r=Bu(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>fs(n,o,s)?Ye(t)._overflowWeeks=!0:l!=null?Ye(t)._overflowWeekday=!0:(a=vW(n,r,i,o,s),t._a[Xn]=a.year,t._dayOfYear=a.dayOfYear)}ee.ISO_8601=function(){};ee.RFC_2822=function(){};function nT(t){if(t._f===ee.ISO_8601){RW(t);return}if(t._f===ee.RFC_2822){EW(t);return}t._a=[],Ye(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=oW(t._f,t._locale).match(jE)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(U9(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Ye(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),pc[o]?(r?Ye(t).empty=!1:Ye(t).unusedTokens.push(o),G9(o,r,t)):t._strict&&!r&&Ye(t).unusedTokens.push(o);Ye(t).charsLeftOver=a-l,e.length>0&&Ye(t).unusedInput.push(e),t._a[Cn]<=12&&Ye(t).bigHour===!0&&t._a[Cn]>0&&(Ye(t).bigHour=void 0),Ye(t).parsedDateParts=t._a.slice(0),Ye(t).meridiem=t._meridiem,t._a[Cn]=t7(t._locale,t._a[Cn],t._meridiem),u=Ye(t).era,u!==null&&(t._a[Xn]=t._locale.erasConvertYear(u,t._a[Xn])),tT(t),eT(t)}function t7(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function n7(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Ye(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=zE({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],nT(e),UE(e)&&(s=!0),o+=Ye(e).charsLeftOver,o+=Ye(e).unusedTokens.length*10,Ye(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));ta(t,n||e)}function r7(t){if(!t._d){var e=YE(t._i),n=e.day===void 0?e.date:e.day;t._a=nW([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),tT(t)}}function i7(t){var e=new xf(eT(TW(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function TW(t){var e=t._i,n=t._f;return t._locale=t._locale||Es(t._l),e===null||n===void 0&&e===""?nv({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Yi(e)?new xf(eT(e)):(Mf(e)?t._d=e:ji(n)?n7(t):n?nT(t):o7(t),UE(t)||(t._d=null),t))}function o7(t){var e=t._i;Tr(e)?t._d=new Date(ee.now()):Mf(e)?t._d=new Date(e.valueOf()):typeof e=="string"?Z5(t):ji(e)?(t._a=nW(e.slice(0),function(n){return parseInt(n,10)}),tT(t)):Il(e)?r7(t):vs(e)?t._d=new Date(e):ee.createFromInputFallback(t)}function _W(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(Il(t)&&BE(t)||ji(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,i7(o)}function At(t,e,n,r){return _W(t,e,n,r,!1)}var s7=wi("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=At.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:nv()}),a7=wi("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=At.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:nv()});function MW(t,e){var n,r;if(e.length===1&&ji(e[0])&&(e=e[0]),!e.length)return At();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function l7(){var t=[].slice.call(arguments,0);return MW("isBefore",t)}function u7(){var t=[].slice.call(arguments,0);return MW("isAfter",t)}var c7=function(){return Date.now?Date.now():+new Date},lh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function h7(t){var e,n=!1,r,i=lh.length;for(e in t)if(ut(t,e)&&!(nn.call(lh,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[lh[r]]){if(n)return!1;parseFloat(t[lh[r]])!==tt(t[lh[r]])&&(n=!0)}return!0}function d7(){return this._isValid}function f7(){return Xi(NaN)}function hv(t){var e=YE(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=h7(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=Es(),this._bubble()}function Km(t){return t instanceof hv}function P0(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function g7(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)(n&&t[s]!==e[s]||!n&&tt(t[s])!==tt(e[s]))&&o++;return o+i}function xW(t,e){xe(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+To(~~(n/60),2)+e+To(~~n%60,2)})}xW("Z",":");xW("ZZ","");ve("Z",lv);ve("ZZ",lv);wt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=rT(lv,t)});var m7=/([\+\-]|\d\d)/gi;function rT(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(m7)||["-",0,0],o=+(i[1]*60)+tt(i[2]),o===0?0:i[0]==="+"?o:-o)}function iT(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(Yi(t)||Mf(t)?t.valueOf():At(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),ee.updateOffset(n,!1),n):At(t).local()}function O0(t){return-Math.round(t._d.getTimezoneOffset())}ee.updateOffset=function(){};function p7(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=rT(lv,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=O0(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?AW(this,Xi(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ee.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:O0(this)}function w7(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function v7(t){return this.utcOffset(0,t)}function C7(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(O0(this),"m")),this}function y7(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=rT(V9,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function S7(t){return this.isValid()?(t=t?At(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function b7(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function R7(){if(!Tr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return zE(t,this),t=TW(t),t._a?(e=t._isUTC?xo(t._a):At(t._a),this._isDSTShifted=this.isValid()&&g7(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function E7(){return this.isValid()?!this._isUTC:!1}function T7(){return this.isValid()?this._isUTC:!1}function PW(){return this.isValid()?this._isUTC&&this._offset===0:!1}var _7=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,M7=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Xi(t,e){var n=t,r=null,i,o,s;return Km(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:vs(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=_7.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:tt(r[Co])*i,h:tt(r[Cn])*i,m:tt(r[$i])*i,s:tt(r[is])*i,ms:tt(P0(r[El]*1e3))*i}):(r=M7.exec(t))?(i=r[1]==="-"?-1:1,n={y:Fa(r[2],i),M:Fa(r[3],i),w:Fa(r[4],i),d:Fa(r[5],i),h:Fa(r[6],i),m:Fa(r[7],i),s:Fa(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=x7(At(n.from),At(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new hv(n),Km(t)&&ut(t,"_locale")&&(o._locale=t._locale),Km(t)&&ut(t,"_isValid")&&(o._isValid=t._isValid),o}Xi.fn=hv.prototype;Xi.invalid=f7;function Fa(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function zP(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function x7(t,e){var n;return t.isValid()&&e.isValid()?(e=iT(e,t),t.isBefore(e)?n=zP(t,e):(n=zP(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function OW(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(iW(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=Xi(n,r),AW(this,i,t),this}}function AW(t,e,n,r){var i=e._milliseconds,o=P0(e._days),s=P0(e._months);t.isValid()&&(r=r??!0,s&&gW(t,jp(t,"Month")+s*n),o&&aW(t,"Date",jp(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&ee.updateOffset(t,o||s))}var P7=OW(1,"add"),O7=OW(-1,"subtract");function IW(t){return typeof t=="string"||t instanceof String}function A7(t){return Yi(t)||Mf(t)||IW(t)||vs(t)||H7(t)||I7(t)||t===null||t===void 0}function I7(t){var e=Il(t)&&!BE(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||ut(t,o);return e&&n}function H7(t){var e=ji(t),n=!1;return e&&(n=t.filter(function(r){return!vs(r)&&IW(t)}).length===0),e&&n}function D7(t){var e=Il(t)&&!BE(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||ut(t,o);return e&&n}function N7(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function k7(t,e){arguments.length===1&&(arguments[0]?A7(arguments[0])?(t=arguments[0],e=void 0):D7(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||At(),r=iT(n,this).startOf("day"),i=ee.calendarFormat(this,r)||"sameElse",o=e&&(Po(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,At(n)))}function L7(){return new xf(this)}function $7(t,e){var n=Yi(t)?t:At(t);return this.isValid()&&n.isValid()?(e=vi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function F7(t,e){var n=Yi(t)?t:At(t);return this.isValid()&&n.isValid()?(e=vi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function W7(t,e,n,r){var i=Yi(t)?t:At(t),o=Yi(e)?e:At(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function V7(t,e){var n=Yi(t)?t:At(t),r;return this.isValid()&&n.isValid()?(e=vi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function B7(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function U7(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function z7(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=iT(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=vi(e),e){case"year":o=Xm(this,r)/12;break;case"month":o=Xm(this,r);break;case"quarter":o=Xm(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:ci(o)}function Xm(t,e){if(t.date()<e.date())return-Xm(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}ee.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";ee.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function G7(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function j7(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Ym(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Po(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Ym(n,"Z")):Ym(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Y7(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function K7(t){t||(t=this.isUtc()?ee.defaultFormatUtc:ee.defaultFormat);var e=Ym(this,t);return this.localeData().postformat(e)}function X7(t,e){return this.isValid()&&(Yi(t)&&t.isValid()||At(t).isValid())?Xi({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function q7(t){return this.from(At(),t)}function Q7(t,e){return this.isValid()&&(Yi(t)&&t.isValid()||At(t).isValid())?Xi({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Z7(t){return this.to(At(),t)}function HW(t){var e;return t===void 0?this._locale._abbr:(e=Es(t),e!=null&&(this._locale=e),this)}var DW=wi("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function NW(){return this._locale}var Xp=1e3,wc=60*Xp,qp=60*wc,kW=(365*400+97)*24*qp;function vc(t,e){return(t%e+e)%e}function LW(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-kW:new Date(t,e,n).valueOf()}function $W(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-kW:Date.UTC(t,e,n)}function J7(t){var e,n;if(t=vi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?$W:LW,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=vc(e+(this._isUTC?0:this.utcOffset()*wc),qp);break;case"minute":e=this._d.valueOf(),e-=vc(e,wc);break;case"second":e=this._d.valueOf(),e-=vc(e,Xp);break}return this._d.setTime(e),ee.updateOffset(this,!0),this}function eX(t){var e,n;if(t=vi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?$W:LW,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=qp-vc(e+(this._isUTC?0:this.utcOffset()*wc),qp)-1;break;case"minute":e=this._d.valueOf(),e+=wc-vc(e,wc)-1;break;case"second":e=this._d.valueOf(),e+=Xp-vc(e,Xp)-1;break}return this._d.setTime(e),ee.updateOffset(this,!0),this}function tX(){return this._d.valueOf()-(this._offset||0)*6e4}function nX(){return Math.floor(this.valueOf()/1e3)}function rX(){return new Date(this.valueOf())}function iX(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function oX(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function sX(){return this.isValid()?this.toISOString():null}function aX(){return UE(this)}function lX(){return ta({},Ye(this))}function uX(){return Ye(this).overflow}function cX(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}xe("N",0,0,"eraAbbr");xe("NN",0,0,"eraAbbr");xe("NNN",0,0,"eraAbbr");xe("NNNN",0,0,"eraName");xe("NNNNN",0,0,"eraNarrow");xe("y",["y",1],"yo","eraYear");xe("y",["yy",2],0,"eraYear");xe("y",["yyy",3],0,"eraYear");xe("y",["yyyy",4],0,"eraYear");ve("N",oT);ve("NN",oT);ve("NNN",oT);ve("NNNN",SX);ve("NNNNN",bX);wt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Ye(n).era=i:Ye(n).invalidEra=t});ve("y",Wc);ve("yy",Wc);ve("yyy",Wc);ve("yyyy",Wc);ve("yo",RX);wt(["y","yy","yyy","yyyy"],Xn);wt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Xn]=n._locale.eraYearOrdinalParse(t,i):e[Xn]=parseInt(t,10)});function hX(t,e){var n,r,i,o=this._eras||Es("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=ee(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=ee(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function dX(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function fX(t,e){var n=t.since<=t.until?1:-1;return e===void 0?ee(t.since).year():ee(t.since).year()+(e-t.offset)*n}function gX(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function mX(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function pX(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function wX(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-ee(i[t].since).year())*n+i[t].offset;return this.year()}function vX(t){return ut(this,"_erasNameRegex")||sT.call(this),t?this._erasNameRegex:this._erasRegex}function CX(t){return ut(this,"_erasAbbrRegex")||sT.call(this),t?this._erasAbbrRegex:this._erasRegex}function yX(t){return ut(this,"_erasNarrowRegex")||sT.call(this),t?this._erasNarrowRegex:this._erasRegex}function oT(t,e){return e.erasAbbrRegex(t)}function SX(t,e){return e.erasNameRegex(t)}function bX(t,e){return e.erasNarrowRegex(t)}function RX(t,e){return e._eraYearOrdinalRegex||Wc}function sT(){var t=[],e=[],n=[],r=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)e.push(Br(s[i].name)),t.push(Br(s[i].abbr)),n.push(Br(s[i].narrow)),r.push(Br(s[i].name)),r.push(Br(s[i].abbr)),r.push(Br(s[i].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}xe(0,["gg",2],0,function(){return this.weekYear()%100});xe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function dv(t,e){xe(0,[t,t.length],0,e)}dv("gggg","weekYear");dv("ggggg","weekYear");dv("GGGG","isoWeekYear");dv("GGGGG","isoWeekYear");er("weekYear","gg");er("isoWeekYear","GG");tr("weekYear",1);tr("isoWeekYear",1);ve("G",av);ve("g",av);ve("GG",It,Qr);ve("gg",It,Qr);ve("GGGG",XE,KE);ve("gggg",XE,KE);ve("GGGGG",sv,iv);ve("ggggg",sv,iv);Of(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=tt(t)});Of(["gg","GG"],function(t,e,n,r){e[r]=ee.parseTwoDigitYear(t)});function EX(t){return FW.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function TX(t){return FW.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function _X(){return fs(this.year(),1,4)}function MX(){return fs(this.isoWeekYear(),1,4)}function xX(){var t=this.localeData()._week;return fs(this.year(),t.dow,t.doy)}function PX(){var t=this.localeData()._week;return fs(this.weekYear(),t.dow,t.doy)}function FW(t,e,n,r,i){var o;return t==null?Xd(this,r,i).year:(o=fs(t,r,i),e>o&&(e=o),OX.call(this,t,e,n,r,i))}function OX(t,e,n,r,i){var o=vW(t,e,n,r,i),s=Kd(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}xe("Q",0,"Qo","quarter");er("quarter","Q");tr("quarter",7);ve("Q",lW);wt("Q",function(t,e){e[rs]=(tt(t)-1)*3});function AX(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}xe("D",["DD",2],"Do","date");er("date","D");tr("date",9);ve("D",It);ve("DD",It,Qr);ve("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});wt(["D","DD"],Co);wt("Do",function(t,e){e[Co]=tt(t.match(It)[0])});var WW=Fc("Date",!0);xe("DDD",["DDDD",3],"DDDo","dayOfYear");er("dayOfYear","DDD");tr("dayOfYear",4);ve("DDD",ov);ve("DDDD",uW);wt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=tt(t)});function IX(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}xe("m",["mm",2],0,"minute");er("minute","m");tr("minute",14);ve("m",It);ve("mm",It,Qr);wt(["m","mm"],$i);var HX=Fc("Minutes",!1);xe("s",["ss",2],0,"second");er("second","s");tr("second",15);ve("s",It);ve("ss",It,Qr);wt(["s","ss"],is);var DX=Fc("Seconds",!1);xe("S",0,0,function(){return~~(this.millisecond()/100)});xe(0,["SS",2],0,function(){return~~(this.millisecond()/10)});xe(0,["SSS",3],0,"millisecond");xe(0,["SSSS",4],0,function(){return this.millisecond()*10});xe(0,["SSSSS",5],0,function(){return this.millisecond()*100});xe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});xe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});xe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});xe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});er("millisecond","ms");tr("millisecond",16);ve("S",ov,lW);ve("SS",ov,Qr);ve("SSS",ov,uW);var na,VW;for(na="SSSS";na.length<=9;na+="S")ve(na,Wc);function NX(t,e){e[El]=tt(("0."+t)*1e3)}for(na="S";na.length<=9;na+="S")wt(na,NX);VW=Fc("Milliseconds",!1);xe("z",0,0,"zoneAbbr");xe("zz",0,0,"zoneName");function kX(){return this._isUTC?"UTC":""}function LX(){return this._isUTC?"Coordinated Universal Time":""}var oe=xf.prototype;oe.add=P7;oe.calendar=k7;oe.clone=L7;oe.diff=z7;oe.endOf=eX;oe.format=K7;oe.from=X7;oe.fromNow=q7;oe.to=Q7;oe.toNow=Z7;oe.get=F9;oe.invalidAt=uX;oe.isAfter=$7;oe.isBefore=F7;oe.isBetween=W7;oe.isSame=V7;oe.isSameOrAfter=B7;oe.isSameOrBefore=U7;oe.isValid=aX;oe.lang=DW;oe.locale=HW;oe.localeData=NW;oe.max=a7;oe.min=s7;oe.parsingFlags=lX;oe.set=W9;oe.startOf=J7;oe.subtract=O7;oe.toArray=iX;oe.toObject=oX;oe.toDate=rX;oe.toISOString=j7;oe.inspect=Y7;typeof Symbol<"u"&&Symbol.for!=null&&(oe[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});oe.toJSON=sX;oe.toString=G7;oe.unix=nX;oe.valueOf=tX;oe.creationData=cX;oe.eraName=gX;oe.eraNarrow=mX;oe.eraAbbr=pX;oe.eraYear=wX;oe.year=wW;oe.isLeapYear=o5;oe.weekYear=EX;oe.isoWeekYear=TX;oe.quarter=oe.quarters=AX;oe.month=mW;oe.daysInMonth=n5;oe.week=oe.weeks=h5;oe.isoWeek=oe.isoWeeks=d5;oe.weeksInYear=xX;oe.weeksInWeekYear=PX;oe.isoWeeksInYear=_X;oe.isoWeeksInISOWeekYear=MX;oe.date=WW;oe.day=oe.days=T5;oe.weekday=_5;oe.isoWeekday=M5;oe.dayOfYear=IX;oe.hour=oe.hours=D5;oe.minute=oe.minutes=HX;oe.second=oe.seconds=DX;oe.millisecond=oe.milliseconds=VW;oe.utcOffset=p7;oe.utc=v7;oe.local=C7;oe.parseZone=y7;oe.hasAlignedHourOffset=S7;oe.isDST=b7;oe.isLocal=E7;oe.isUtcOffset=T7;oe.isUtc=PW;oe.isUTC=PW;oe.zoneAbbr=kX;oe.zoneName=LX;oe.dates=wi("dates accessor is deprecated. Use date instead.",WW);oe.months=wi("months accessor is deprecated. Use month instead",mW);oe.years=wi("years accessor is deprecated. Use year instead",wW);oe.zone=wi("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",w7);oe.isDSTShifted=wi("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",R7);function $X(t){return At(t*1e3)}function FX(){return At.apply(null,arguments).parseZone()}function BW(t){return t}var ct=GE.prototype;ct.calendar=T9;ct.longDateFormat=P9;ct.invalidDate=A9;ct.ordinal=D9;ct.preparse=BW;ct.postformat=BW;ct.relativeTime=k9;ct.pastFuture=L9;ct.set=R9;ct.eras=hX;ct.erasParse=dX;ct.erasConvertYear=fX;ct.erasAbbrRegex=CX;ct.erasNameRegex=vX;ct.erasNarrowRegex=yX;ct.months=Z9;ct.monthsShort=J9;ct.monthsParse=t5;ct.monthsRegex=i5;ct.monthsShortRegex=r5;ct.week=a5;ct.firstDayOfYear=c5;ct.firstDayOfWeek=u5;ct.weekdays=y5;ct.weekdaysMin=b5;ct.weekdaysShort=S5;ct.weekdaysParse=E5;ct.weekdaysRegex=x5;ct.weekdaysShortRegex=P5;ct.weekdaysMinRegex=O5;ct.isPM=I5;ct.meridiem=N5;function Qp(t,e,n,r){var i=Es(),o=xo().set(r,e);return i[n](o,t)}function UW(t,e,n){if(vs(t)&&(e=t,t=void 0),t=t||"",e!=null)return Qp(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Qp(t,r,n,"month");return i}function aT(t,e,n,r){typeof t=="boolean"?(vs(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,vs(e)&&(n=e,e=void 0),e=e||"");var i=Es(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Qp(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Qp(e,(s+o)%7,r,"day");return a}function WX(t,e){return UW(t,e,"months")}function VX(t,e){return UW(t,e,"monthsShort")}function BX(t,e,n){return aT(t,e,n,"weekdays")}function UX(t,e,n){return aT(t,e,n,"weekdaysShort")}function zX(t,e,n){return aT(t,e,n,"weekdaysMin")}ga("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=tt(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});ee.lang=wi("moment.lang is deprecated. Use moment.locale instead.",ga);ee.langData=wi("moment.langData is deprecated. Use moment.localeData instead.",Es);var Ho=Math.abs;function GX(){var t=this._data;return this._milliseconds=Ho(this._milliseconds),this._days=Ho(this._days),this._months=Ho(this._months),t.milliseconds=Ho(t.milliseconds),t.seconds=Ho(t.seconds),t.minutes=Ho(t.minutes),t.hours=Ho(t.hours),t.months=Ho(t.months),t.years=Ho(t.years),this}function zW(t,e,n,r){var i=Xi(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function jX(t,e){return zW(this,t,e,1)}function YX(t,e){return zW(this,t,e,-1)}function GP(t){return t<0?Math.floor(t):Math.ceil(t)}function KX(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=GP(A0(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=ci(t/1e3),r.seconds=i%60,o=ci(i/60),r.minutes=o%60,s=ci(o/60),r.hours=s%24,e+=ci(s/24),l=ci(GW(e)),n+=l,e-=GP(A0(l)),a=ci(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function GW(t){return t*4800/146097}function A0(t){return t*146097/4800}function XX(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=vi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+GW(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(A0(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function qX(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+tt(this._months/12)*31536e6:NaN}function Ts(t){return function(){return this.as(t)}}var QX=Ts("ms"),ZX=Ts("s"),JX=Ts("m"),eq=Ts("h"),tq=Ts("d"),nq=Ts("w"),rq=Ts("M"),iq=Ts("Q"),oq=Ts("y");function sq(){return Xi(this)}function aq(t){return t=vi(t),this.isValid()?this[t+"s"]():NaN}function ql(t){return function(){return this.isValid()?this._data[t]:NaN}}var lq=ql("milliseconds"),uq=ql("seconds"),cq=ql("minutes"),hq=ql("hours"),dq=ql("days"),fq=ql("months"),gq=ql("years");function mq(){return ci(this.days()/7)}var qo=Math.round,oc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function pq(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function wq(t,e,n,r){var i=Xi(t).abs(),o=qo(i.as("s")),s=qo(i.as("m")),a=qo(i.as("h")),l=qo(i.as("d")),u=qo(i.as("M")),c=qo(i.as("w")),h=qo(i.as("y")),f=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(f=f||c<=1&&["w"]||c<n.w&&["ww",c]),f=f||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],f[2]=e,f[3]=+t>0,f[4]=r,pq.apply(null,f)}function vq(t){return t===void 0?qo:typeof t=="function"?(qo=t,!0):!1}function Cq(t,e){return oc[t]===void 0?!1:e===void 0?oc[t]:(oc[t]=e,t==="s"&&(oc.ss=e-1),!0)}function yq(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=oc,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},oc,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=wq(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var ly=Math.abs;function ou(t){return(t>0)-(t<0)||+t}function fv(){if(!this.isValid())return this.localeData().invalidDate();var t=ly(this._milliseconds)/1e3,e=ly(this._days),n=ly(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=ci(t/60),i=ci(r/60),t%=60,r%=60,o=ci(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=ou(this._months)!==ou(a)?"-":"",c=ou(this._days)!==ou(a)?"-":"",h=ou(this._milliseconds)!==ou(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var ot=hv.prototype;ot.isValid=d7;ot.abs=GX;ot.add=jX;ot.subtract=YX;ot.as=XX;ot.asMilliseconds=QX;ot.asSeconds=ZX;ot.asMinutes=JX;ot.asHours=eq;ot.asDays=tq;ot.asWeeks=nq;ot.asMonths=rq;ot.asQuarters=iq;ot.asYears=oq;ot.valueOf=qX;ot._bubble=KX;ot.clone=sq;ot.get=aq;ot.milliseconds=lq;ot.seconds=uq;ot.minutes=cq;ot.hours=hq;ot.days=dq;ot.weeks=mq;ot.months=fq;ot.years=gq;ot.humanize=yq;ot.toISOString=fv;ot.toString=fv;ot.toJSON=fv;ot.locale=HW;ot.localeData=NW;ot.toIsoString=wi("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",fv);ot.lang=DW;xe("X",0,0,"unix");xe("x",0,0,"valueOf");ve("x",av);ve("X",B9);wt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});wt("x",function(t,e,n){n._d=new Date(tt(t))});//! moment.js
ee.version="2.29.4";S9(At);ee.fn=oe;ee.min=l7;ee.max=u7;ee.now=c7;ee.utc=xo;ee.unix=$X;ee.months=WX;ee.isDate=Mf;ee.locale=ga;ee.invalid=nv;ee.duration=Xi;ee.isMoment=Yi;ee.weekdays=BX;ee.parseZone=FX;ee.localeData=Es;ee.isDuration=Km;ee.monthsShort=VX;ee.weekdaysMin=zX;ee.defineLocale=JE;ee.updateLocale=F5;ee.locales=W5;ee.weekdaysShort=UX;ee.normalizeUnits=vi;ee.relativeTimeRounding=vq;ee.relativeTimeThreshold=Cq;ee.calendarFormat=N7;ee.prototype=oe;ee.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Sq=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));function jW(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function I0(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function gd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function en(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Yr(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ge(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function P(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function YW(t){return en(t,(e,n)=>e+n,0)}function bq(t){return en(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function Rq(t){return en(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function Eq(t){return t.length?YW(t)/t.length:0}function KW(t){return en(t,(e,n)=>e.concat(Array.isArray(n)?KW(n):n),[])}function lT(t){const e=[];return P(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function H0(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return P(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function Tq(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return P(i,s=>{o=o.filter(a=>s.includes(a))}),o}function _q(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return P(i,s=>{P(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function D0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const Mq=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:Eq,arrayEach:P,arrayFilter:Yr,arrayFlatten:KW,arrayMap:Ge,arrayMax:bq,arrayMin:Rq,arrayReduce:en,arraySum:YW,arrayUnique:lT,extendArray:I0,getDifferenceOfArrays:H0,getIntersectionOfArrays:Tq,getUnionOfArrays:_q,pivot:gd,stringToArray:D0,to2dArray:jW},Symbol.toStringTag,{value:"Module"}));function mt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return en(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Yt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function he(t){return typeof t<"u"}function bt(t){return typeof t>"u"}function gn(t){return t===null||t===""||bt(t)}function XW(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const qh="length",md=t=>parseInt(t,16),jP=t=>parseInt(t,10),Zp=(t,e,n)=>t.substr(e,n),pd=t=>t.codePointAt(0)-65,N0=t=>`${t}`.replace(/\-/g,""),xq=t=>md(Zp(N0(t),md("12"),pd("F")))/(md(Zp(N0(t),pd("B"),~~![][qh]))||9),Pq=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let YP=!1;const KP={invalid:()=>mt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return mt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>mt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},XP={invalid:()=>mt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return mt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>mt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function qW(t,e){const n=!gn(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.0.0-next-b24d538-20231108";let o,s="invalid",a="invalid";t=N0(t||"");const l=Oq(t);if(n||r||l)if(l){const u=ee("15/11/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=xq(t);o=ee((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(Pq()&&(s="valid",a="valid"),!YP&&s!=="valid"&&(KP[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](KP[s]({keyValidityDate:o,hotVersion:i})),YP=!0),a!=="valid"&&e.parentNode&&XP[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=XP[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function Oq(t){let e=[][qh],n=e;if(t[qh]!==pd("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=pd(i.shift());o;o=pd(i.shift()||"A"))--o<""[qh]?n=n|(jP(`${jP(md(r)+(md(Zp(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Zp(t,o,o?i[qh]===1?9:8:6);return n===e}const Aq=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:qW,isDefined:he,isEmpty:gn,isRegExp:XW,isUndefined:bt,stringify:Yt},Symbol.toStringTag,{value:"Module"}));function Qn(t){return t[0].toUpperCase()+t.substr(1)}function Iq(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Yt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function uT(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function cT(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function hT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function k0(t){return gv(`${t}`,{ALLOWED_TAGS:[]})}function gv(t,e){return y9.sanitize(t,e)}const Hq=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:Iq,isPercentValue:cT,randomString:uT,sanitize:gv,stripTags:k0,substitute:hT,toUpperCaseFirst:Qn},Symbol.toStringTag,{value:"Module"})),Vc=t=>["tabindex",t],Dq=()=>["role","treegrid"],Fi=()=>["role","presentation"],Nq=()=>["role","gridcell"],kq=()=>["role","rowheader"],Lq=()=>["role","columnheader"],QW=()=>["role","row"],$q=()=>["role","menu"],Fq=()=>["role","menuitem"],Wq=()=>["role","combobox"],ZW=()=>["role","listbox"],Vq=()=>["role","option"],Bq=()=>["role","checkbox"],Uq=()=>["scope","col"],zq=()=>["scope","row"],Gq=()=>["type","text"],ba=t=>["aria-label",t],Qd=t=>["aria-description",t],_s=()=>["aria-hidden","true"],jq=()=>["aria-disabled","true"],Yq=()=>["aria-multiselectable","true"],Bc=t=>["aria-haspopup",t],JW=t=>["aria-rowcount",t],eV=t=>["aria-colcount",t],tV=t=>["aria-rowindex",t],dT=t=>["aria-colindex",t],xn=t=>["aria-expanded",t],Kq=t=>["aria-sort",t],qP=()=>["aria-readonly","true"],QP=()=>["aria-invalid","true"],Xq=t=>["aria-checked",t],L0=()=>["aria-selected","true"],qq=()=>["aria-autocomplete","list"],Qq=t=>["aria-controls",t],Zq=t=>["aria-activedescendant",t],Jq=t=>["aria-live",t],eQ=t=>["aria-relevant",t],tQ=t=>["aria-setsize",t],nQ=t=>["aria-posinset",t];function nV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function rV(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function iV(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Zd(t){return iV(t)&&t.parent}function rQ(t){return!!Object.getPrototypeOf(t.parent)}function Ra(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Qh(t,e,n){const r=[];let i=t;for(;i&&(i=Ra(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function ma(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function oV(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function zs(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function sV(t){return!t||!t.length?[]:t.filter(e=>!!e)}function aV(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),e?{regexFree:r,regexes:n}:r}function De(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function te(t,e){typeof e=="string"&&(e=e.split(" ")),e=sV(e),e.length>0&&t.classList.add(...e)}function Le(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=aV(e,!0);n=sV(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Re(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Ha(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=aV(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function fT(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)fT(e[n])}}function Ki(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const lV=/(<(.*)>|&(.*);)/;function Ql(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;lV.test(e)?t.innerHTML=n?gv(e):e:Ea(t,e)}function Ea(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(Ki(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Ta(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Ta(n.host.impl);if(n.host)return Ta(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(Cs(n).display==="none")return!1;n=n.parentNode}return!0}function on(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function gT(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function mv(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Jd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?gT(e):t.scrollTop}function Jp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?mv(e):t.scrollLeft}function ef(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function $l(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=Cs(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function xc(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=Cs(t,n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function iQ(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function Cs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function gt(t){return t.offsetWidth}function Wt(t){return t.offsetHeight}function os(t){return t.clientHeight||t.innerHeight}function wd(t){return t.clientWidth||t.innerWidth}function oQ(t,e,n){t.addEventListener(e,n,!1)}function sQ(t,e,n){t.removeEventListener(e,n,!1)}function mT(t){return t.selectionStart?t.selectionStart:0}function uV(t){return t.selectionEnd?t.selectionEnd:0}function aQ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function $0(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Af(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let uy;function lQ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function yn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return uy===void 0&&(uy=lQ(t)),uy}function cV(t){return t.offsetWidth!==t.clientWidth}function hV(t){return t.offsetHeight!==t.clientHeight}function pv(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function uQ(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function If(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function ew(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function wv(t){return ew(t)&&t.hasAttribute("data-hot-input")===!1}function cQ(t){const e=t.ownerDocument.activeElement;wv(e)||t.select()}function pT(t){return!t.parentNode}function dV(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function wT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Re(t,"contenteditable",!0),n&&Re(t,..._s()),e&&te(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function vT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&Le(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function fV(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;wT(t,n),e(),vT(t,n)}function Fl(t,e){let{tagName:n,className:r,attributes:i}=e;const o=t.ownerDocument.createElement(n);return r&&te(o,r),i&&i.length&&Re(o,i),t.appendChild(o),o}const hQ=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:lV,addClass:te,addEvent:oQ,appendElement:Fl,clearTextSelection:$0,closest:Ra,closestDown:Qh,empty:Ki,fastInnerHTML:Ql,fastInnerText:Ea,getCaretPosition:mT,getComputedStyle:Cs,getCssTransform:uQ,getFrameElement:iV,getParent:nV,getParentWindow:Zd,getScrollLeft:Jp,getScrollTop:Jd,getScrollableElement:ef,getScrollbarWidth:yn,getSelectionEndPosition:uV,getSelectionText:aQ,getStyle:xc,getTrimmingContainer:$l,getWindowScrollLeft:mv,getWindowScrollTop:gT,hasAccessToParentWindow:rQ,hasClass:De,hasHorizontalScrollbar:hV,hasVerticalScrollbar:cV,index:oV,innerHeight:os,innerWidth:wd,isChildOf:ma,isDetached:pT,isInput:ew,isOutsideInput:wv,isThisHotChild:rV,isVisible:Ta,makeElementContentEditableAndSelectItsContent:wT,matchesCSSRules:iQ,observeVisibilityChangeOnce:dV,offset:on,outerHeight:Wt,outerWidth:gt,overlayContainsElement:zs,removeAttribute:Ha,removeClass:Le,removeContentEditableFromElementAndDeselect:vT,removeEvent:sQ,removeTextNodes:fT,resetCssTransform:If,runWithSelectedContendEditableElement:fV,selectElementIfAllowed:cQ,setAttribute:Re,setCaretPosition:Af,setOverlayPosition:pv},Symbol.toStringTag,{value:"Module"}));function St(t){return typeof t=="function"}function gV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function dQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=gV(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function CT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function fQ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return en(i,(u,c)=>c(u),r.apply(this,a))}}function yT(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function mV(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function gQ(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function tw(t,e,n,r,i,o,s,a){return he(a)?t.call(e,n,r,i,o,s,a):he(s)?t.call(e,n,r,i,o,s):he(o)?t.call(e,n,r,i,o):he(i)?t.call(e,n,r,i):he(r)?t.call(e,n,r):he(n)?t.call(e,n):t.call(e)}const mQ=Object.freeze(Object.defineProperty({__proto__:null,curry:mV,curryRight:gQ,debounce:CT,fastCall:tw,isFunction:St,partial:yT,pipe:fQ,throttle:gV,throttleAfterHits:dQ},Symbol.toStringTag,{value:"Module"}));var pQ=vr,ZP=kF,wQ=$n,JP=$c,vQ=BF,eO=pQ([].push),CQ=function(t){if(wQ(t))return t;if(ZP(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?eO(n,i):(typeof i=="number"||JP(i)==="Number"||JP(i)==="String")&&eO(n,vQ(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(ZP(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},yQ=Kl,pV=Rf,wV=tv,SQ=qw,Hf=vr,vV=pi,tO=$n,nO=PE,CV=WE,bQ=CQ,RQ=xE,EQ=String,pa=pV("JSON","stringify"),Sg=Hf(/./.exec),rO=Hf("".charAt),TQ=Hf("".charCodeAt),_Q=Hf("".replace),MQ=Hf(1 .toString),xQ=/[\uD800-\uDFFF]/g,iO=/^[\uD800-\uDBFF]$/,oO=/^[\uDC00-\uDFFF]$/,sO=!RQ||vV(function(){var t=pV("Symbol")("stringify detection");return pa([t])!=="[null]"||pa({a:t})!=="{}"||pa(Object(t))!=="{}"}),aO=vV(function(){return pa("\uDF06\uD834")!=='"\\udf06\\ud834"'||pa("\uDEAD")!=='"\\udead"'}),PQ=function(t,e){var n=CV(arguments),r=bQ(e);if(!(!tO(r)&&(t===void 0||nO(t))))return n[1]=function(i,o){if(tO(r)&&(o=SQ(r,this,EQ(i),o)),!nO(o))return o},wV(pa,null,n)},OQ=function(t,e,n){var r=rO(n,e-1),i=rO(n,e+1);return Sg(iO,t)&&!Sg(oO,i)||Sg(oO,t)&&!Sg(iO,r)?"\\u"+MQ(TQ(t,0),16):t};pa&&yQ({target:"JSON",stat:!0,arity:3,forced:sO||aO},{stringify:function(e,n,r){var i=CV(arguments),o=wV(sO?PQ:pa,null,i);return aO&&typeof o=="string"?_Q(o,xQ,OQ):o}});function Pc(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},je(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Pc(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Pc(n[0])]:e[r]=[]:e[r]=null)})),e}function Ms(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function sn(t,e,n){const r=Array.isArray(n);return je(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function Df(t,e){je(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),Df(t[r],e[r])):t[r]=e[r]})}function Zn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function gr(t){const e={};return je(t,(n,r)=>{e[r]=n}),e}function vt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return P(n,i=>{t.MIXINS.push(i.MIXIN_NAME),je(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const f=`_${c}`,g=p=>{let y=p;return(Array.isArray(y)||Be(y))&&(y=Zn(y)),y};return function(){return this[f]===void 0&&(this[f]=g(h)),this[f]}},l=function(c){const h=`_${c}`;return function(f){this[h]=f}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function vv(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Be(t){return Object.prototype.toString.call(t)==="[object Object]"}function Oo(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function je(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function yV(t,e){const n=e.split(".");let r=t;return je(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function qm(t,e,n){const r=e.split(".");let i=t;r.forEach((o,s)=>{s!==r.length-1?(Ft(i,o)||(i[o]={}),i=i[o]):i[o]=n})}function Cv(t){if(!Be(t))return 0;const e=function(n){let r=0;return Be(n)?je(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Wl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Ft(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const AQ=Object.freeze(Object.defineProperty({__proto__:null,clone:gr,createObjectPropListener:Wl,deepClone:Zn,deepExtend:Df,deepObjectSize:Cv,defineGetter:Oo,duckSchema:Pc,extend:sn,getProperty:yV,hasOwnProperty:Ft,inherit:Ms,isObject:Be,isObjectEqual:vv,mixin:vt,objectEach:je,setProperty:qm},Symbol.toStringTag,{value:"Module"})),oi=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},xs={chrome:oi((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:oi(t=>/CriOS/.test(t)),edge:oi(t=>/Edge/.test(t)),edgeWebKit:oi(t=>/EdgiOS/.test(t)),firefox:oi(t=>/Firefox/.test(t)),firefoxWebKit:oi(t=>/FxiOS/.test(t)),mobile:oi(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:oi((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Uc={mac:oi(t=>/^Mac/.test(t)),win:oi(t=>/^Win/.test(t)),linux:oi(t=>/^Linux/.test(t)),ios:oi(t=>/iPhone|iPad|iPod/i.test(t))};function SV(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};je(xs,n=>{let{test:r}=n;return void r(t,e)})}function bV(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};je(Uc,e=>{let{test:n}=e;return void n(t)})}SV();bV();function ST(){return xs.chrome.value}function RV(){return xs.chromeWebKit.value}function Qm(){return xs.firefox.value}function EV(){return xs.firefoxWebKit.value}function bT(){return xs.safari.value}function TV(){return xs.edge.value}function IQ(){return xs.edgeWebKit.value}function ss(){return xs.mobile.value}function RT(){return Uc.ios.value}function ET(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Uc.mac.value}function F0(){return Uc.win.value}function tf(){return Uc.mac.value}function HQ(){return Uc.linux.value}const DQ=Object.freeze(Object.defineProperty({__proto__:null,isChrome:ST,isChromeWebKit:RV,isEdge:TV,isEdgeWebKit:IQ,isFirefox:Qm,isFirefoxWebKit:EV,isIOS:RT,isIpadOS:ET,isLinuxOS:HQ,isMacOS:tf,isMobileBrowser:ss,isSafari:bT,isWindowsOS:F0,setBrowserMeta:SV,setPlatformMeta:bV},Symbol.toStringTag,{value:"Module"})),pe={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Qm()?182:174,AUDIO_MUTE:Qm()?181:173,AUDIO_UP:Qm()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},NQ=[pe.ALT,pe.ARROW_DOWN,pe.ARROW_LEFT,pe.ARROW_RIGHT,pe.ARROW_UP,pe.AUDIO_DOWN,pe.AUDIO_MUTE,pe.AUDIO_UP,pe.BACKSPACE,pe.CAPS_LOCK,pe.DELETE,pe.END,pe.ENTER,pe.ESCAPE,pe.F1,pe.F2,pe.F3,pe.F4,pe.F5,pe.F6,pe.F7,pe.F8,pe.F9,pe.F10,pe.F11,pe.F12,pe.F13,pe.F14,pe.F15,pe.F16,pe.F17,pe.F18,pe.F19,pe.HOME,pe.INSERT,pe.MEDIA_NEXT,pe.MEDIA_PLAY_PAUSE,pe.MEDIA_PREV,pe.MEDIA_STOP,pe.NULL,pe.NUM_LOCK,pe.PAGE_DOWN,pe.PAGE_UP,pe.PAUSE,pe.SCROLL_LOCK,pe.SHIFT,pe.TAB];function _V(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function TT(t){return NQ.includes(t)}function kQ(t){const e=[];return tf()?e.push(pe.COMMAND_LEFT,pe.COMMAND_RIGHT,pe.COMMAND_FIREFOX):e.push(pe.CONTROL),e.includes(t)}function MV(t){return[pe.CONTROL,pe.COMMAND_LEFT,pe.COMMAND_RIGHT,pe.COMMAND_FIREFOX].includes(t)}function zc(t,e){const n=e.split("|");let r=!1;return P(n,i=>{if(t===pe[i])return r=!0,!1}),r}const LQ=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:pe,isCtrlKey:kQ,isCtrlMetaKey:MV,isFunctionKey:TT,isKey:zc,isPrintableChar:_V},Symbol.toStringTag,{value:"Module"}));function Ci(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Zs(t){return t.isImmediatePropagationEnabled===!1}function _a(t){return t.button===2}function yv(t){return t.button===0}function xV(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const $Q=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Zs,isLeftClick:yv,isRightClick:_a,offsetRelativeTo:xV,stopImmediatePropagation:Ci},Symbol.toStringTag,{value:"Module"}));function Rt(){he(console)&&console.warn(...arguments)}function _T(){he(console)&&console.error(...arguments)}function FQ(t,e,n){return e=WQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WQ(t){var e=VQ(t,"string");return typeof e=="symbol"?e:String(e)}function VQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const su=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],BQ=mt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,cy=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),hy=new Map([[]]);class PV{static getSingleton(){return zQ()}constructor(){FQ(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return P(su,n=>e[n]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))P(n,i=>this.add(e,i,r));else{cy.has(e)&&Rt(hT(BQ,{hookName:e,removedInVersion:cy.get(e)})),hy.has(e)&&Rt(hy.get(e));const i=this.getBucket(r);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),n.skip=!1,i[e].indexOf(n)===-1){let o=!1;n.initialHook&&P(i[e],(s,a)=>{if(s.initialHook)return i[e][a]=n,o=!0,!1}),o||i[e].push(n)}}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?P(n,i=>this.once(e,i,r)):(n.runOnce=!0,this.add(e,n,r))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,i,o,s,a,l){{const u=this.globalBucket[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const f=tw(u[h],e,r,i,o,s,a,l);f!==void 0&&(r=f),u[h]&&u[h].runOnce&&this.remove(n,u[h]),h+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const f=tw(u[h],e,r,i,o,s,a,l);f!==void 0&&(r=f),u[h]&&u[h].runOnce&&this.remove(n,u[h],e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;je(this.getBucket(e),(n,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||su.push(e)}deregister(e){this.isRegistered(e)&&su.splice(su.indexOf(e),1)}isDeprecated(e){return hy.has(e)||cy.has(e)}isRegistered(e){return su.indexOf(e)>=0}getRegistered(){return su}}const UQ=new PV;function zQ(){return UQ}const me=PV,dy=new Map;function qi(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";dy.has(t)||dy.set(t,new Map);const e=dy.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const W0=new WeakMap,{register:GQ,getItem:OV,hasItem:AV,getNames:jQ,getValues:Nbe}=qi("editors");function YQ(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},me.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function IV(t,e){let n;if(typeof t=="function")W0.get(t)||_r(null,t),n=W0.get(t);else if(typeof t=="string")n=OV(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function nw(t){if(typeof t=="function")return t;if(!AV(t))throw Error(`No registered editor found under "${t}" name`);return OV(t).getConstructor()}function _r(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new YQ(e);typeof t=="string"&&GQ(t,n),W0.set(e,n)}function KQ(t,e,n){return e=XQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XQ(t){var e=qQ(t,"string");return typeof e=="symbol"?e:String(e)}function qQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Zm=0;class QQ{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;KQ(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,ZQ(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Zm+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Zm-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Zm-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function ZQ(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Ci(this)},t}const Kr=QQ;function JQ(){return Zm}function lO(t,e){eZ(t,e),e.add(t)}function eZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Is(t,e,n){return e=tZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tZ(t){var e=nZ(t,"string");return typeof e=="symbol"?e:String(e)}function nZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uO(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Sv="editorManager.navigation";var cO=new WeakSet,hO=new WeakSet;class V0{constructor(e,n,r){lO(this,hO),lO(this,cO),Is(this,"hot",void 0),Is(this,"tableMeta",void 0),Is(this,"selection",void 0),Is(this,"eventManager",void 0),Is(this,"destroyed",!1),Is(this,"lock",!1),Is(this,"activeEditor",void 0),Is(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Kr(e),this.hot.addHook("afterDocumentKeyDown",i=>uO(this,cO,rZ).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>uO(this,hO,iZ).call(this,i,o,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,l=>{l&&this.prepareEditor()});return}const{highlight:e}=this.hot.getSelectedRangeLast();if(e.isHeader())return;const{row:n,col:r}=e,i=this.hot.runHooks("modifyGetCellCoords",n,r);let o=n,s=r;if(Array.isArray(i)&&([o,s]=i),this.cellProperties=this.hot.getCellMeta(o,s),!this.isCellEditable()){this.clearActiveEditor();return}const a=this.hot.getCell(n,r,!0);if(a){const l=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(s),c=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),s);this.activeEditor=IV(l,this.hot),this.activeEditor.prepare(n,r,u,a,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function rZ(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Zs(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!TT(n)&&!MV(n)&&!r&&!this.isEditorOpened()){const o=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>he(this.hot.getSelected()),group:Sv};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.openEditor("",t)}}function iZ(t,e,n){n.nodeName==="TD"&&this.openEditor(null,t,!0)}const dO=new WeakMap;V0.getInstance=function(t,e,n){let r=dO.get(t);return r||(r=new V0(t,e,n),dO.set(t,r)),r};const oZ=V0;function bg(t,e){HV(t,e),e.add(t)}function Rg(t,e,n){HV(t,e),e.set(t,n)}function HV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sc(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function zn(t,e){var n=DV(t,e,"get");return sZ(t,n)}function sZ(t,e){return e.get?e.get.call(t):e.value}function uh(t,e,n){var r=DV(t,e,"set");return aZ(t,r,n),n}function DV(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function aZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const ra=Object.freeze({CELL:"cell",MIXED:"mixed"});var Fr=new WeakMap,Eg=new WeakMap,Tg=new WeakMap,_g=new WeakMap,B0=new WeakSet,U0=new WeakSet,fO=new WeakSet,gO=new WeakSet;class lZ{constructor(e){var n=this;bg(this,gO),bg(this,fO),bg(this,U0),bg(this,B0),Rg(this,Fr,{writable:!0,value:void 0}),Rg(this,Eg,{writable:!0,value:void 0}),Rg(this,Tg,{writable:!0,value:50}),Rg(this,_g,{writable:!0,value:null});const r=e.getSettings();uh(this,Fr,e),uh(this,Eg,r.imeFastEdit?ra.MIXED:ra.CELL),zn(this,Fr).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return sc(n,gO,cZ).call(n,...o)}),zn(this,Fr).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return sc(n,fO,uZ).call(n,...o)})}getFocusMode(){return zn(this,Eg)}setFocusMode(e){Object.values(ra).includes(e)?uh(this,Eg,e):Rt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return zn(this,Tg)}setRefocusDelay(e){uh(this,Tg,e)}setRefocusElementGetter(e){uh(this,_g,e)}getRefocusElement(){if(typeof zn(this,_g)=="function")return zn(this,_g).call(this);var e;return(e=zn(this,Fr).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){var n;const r=sc(this,B0,NV).call(this),i=e||sc(this,U0,kV).call(this);let o=zn(this,Fr).runHooks("modifyFocusedElement",r.row,r.col,i);o instanceof HTMLElement||(o=i),o&&!((n=zn(this,Fr).getActiveEditor())!==null&&n!==void 0&&n.isOpened())&&o.focus({preventScroll:!0})}refocusToEditorTextarea(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zn(this,Tg);const n=this.getRefocusElement();zn(this,Fr).getSettings().imeFastEdit&&n&&zn(this,Fr)._registerTimeout(()=>{n.select()},e)}}function NV(){return zn(this,Fr).getSelectedRangeLast().highlight}function kV(){const t=sc(this,B0,NV).call(this);return zn(this,Fr).getCell(t.row,t.col,!0)}function uZ(){const t=sc(this,U0,kV).call(this),{activeElement:e}=zn(this,Fr).rootDocument;e&&wv(e)&&e.blur(),this.focusOnHighlightedCell(t),this.getFocusMode()===ra.MIXED&&t.nodeName==="TD"&&zn(this,Fr).addHookOnce("afterSelectionEnd",()=>{this.refocusToEditorTextarea()})}function cZ(t){t.imeFastEdit&&this.getFocusMode()!==ra.MIXED?this.setFocusMode(ra.MIXED):!t.imeFastEdit&&this.getFocusMode()!==ra.CELL&&this.setFocusMode(ra.CELL)}const LV={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},hZ=new RegExp(Object.keys(LV).map(t=>`(${t})`).join("|"),"gi");function dZ(t){return(t&&t.nodeName||"")==="TABLE"}function z0(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let f=0;f<o;f+=1){const g=e&&f===0,p=[];for(let E=0;E<s;E+=1){const v=!g&&n&&E===0;let C="";if(g)C=`<th>${t.getColHeader(E-c)}</th>`;else if(v)C=`<th>${t.getRowHeader(f-h)}</th>`;else{const S=i[f][E],{hidden:T,rowspan:_,colspan:H}=t.getCellMeta(f-h,E-c);if(!T){const D=[];if(_&&D.push(`rowspan="${_}"`),H&&D.push(`colspan="${H}"`),gn(S))C=`<td ${D.join(" ")}></td>`;else{const B=S.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");C=`<td ${D.join(" ")}>${B}</td>`}}}p.push(C)}const y=["<tr>",...p,"</tr>"].join("");g?l.splice(1,0,y):u.splice(-1,0,y)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function G0(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=gn(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function $V(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const S=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,T=>{const _=T.match(/<td\b[^>]*?>/g)[0],H=T.substring(_.length,T.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${_}${H}</td>`});i.insertAdjacentHTML("afterbegin",`${S}`),o=i.querySelector("table")}if(!o||!dZ(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((S,T)=>S+T.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let f=!1,g=0,p=0;if(o.tHead){const S=Array.from(o.tHead.rows).filter(T=>{const _=T.querySelector("td")!==null;return _&&h.push(T),!_});g=S.length,f=g>0,g>1?n.nestedHeaders=Array.from(S).reduce((T,_)=>{const H=Array.from(_.cells).reduce((D,B,z)=>{if(a&&z===0)return D;const{colSpan:G,innerHTML:Z}=B,re=G>1?{label:Z,colspan:G}:Z;return D.push(re),D},[]);return T.push(H),T},[]):f&&(n.colHeaders=Array.from(S[0].children).reduce((T,_,H)=>(a&&H===0||T.push(_.innerHTML),T),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const y=[...h,...Array.from(o.tBodies).reduce((S,T)=>(S.push(...Array.from(T.rows)),S),[]),...c];p=y.length;const E=new Array(p);for(let S=0;S<p;S++)E[S]=new Array(u);const v=[],C=[];for(let S=0;S<p;S++){const T=y[S],_=Array.from(T.cells),H=_.length;for(let D=0;D<H;D++){const B=_[D],{nodeName:z,innerHTML:G,rowSpan:Z,colSpan:re}=B,ne=E[S].findIndex(ue=>ue===void 0);if(z==="TD"){if(Z>1||re>1){for(let He=S;He<S+Z;He++)if(He<p)for(let R=ne;R<ne+re;R++)E[He][R]=null;const Ee=B.getAttribute("style");Ee&&Ee.includes("mso-ignore:colspan")||v.push({col:ne,row:S,rowspan:Z,colspan:re})}let ue="";s&&/excel/gi.test(s.content)?ue=G.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ue=G.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),E[S][ne]=ue.replace(hZ,Ee=>LV[Ee])}else C.push(G)}}return v.length&&(n.mergeCells=v),C.length&&(n.rowHeaders=C),E.length&&(n.data=E),n}const fZ=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:G0,htmlToGridSettings:$V,instanceToHTML:z0},Symbol.toStringTag,{value:"Module"}));function dr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function FV(t){return dr(t,[","])}function ye(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function rw(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function MT(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Or(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const gZ=Object.freeze(Object.defineProperty({__proto__:null,clamp:Or,isNumeric:dr,isNumericLike:FV,rangeEach:ye,rangeEachReverse:rw,valueAccordingPercent:MT},Symbol.toStringTag,{value:"Module"})),j0="asc",mZ="desc",mO=new Map([[j0,[-1,1]],[mZ,[1,-1]]]),pZ=t=>`The priority '${t}' is already declared in a map.`,wZ=t=>`The priority '${t}' is not a number.`;function vZ(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=St(t)?t:pZ,e=St(e)?e:wZ;function r(o,s){if(!dr(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:j0;const[s,a]=mO.get(o)||mO.get(j0);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const CZ=t=>`The id '${t}' is already declared in a map.`;function bv(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=St(t)?t:CZ;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[f,g]=h;return u===g?f:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const yZ=t=>`'${t}' value is already declared in a unique set.`;function SZ(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=St(t)?t:yZ;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const xT=t=>`There is already registered "${t}" plugin.`,bZ=t=>`There is already registered plugin on priority "${t}".`,RZ=t=>`The priority "${t}" is not a number.`,WV=vZ({errorPriorityExists:bZ,errorPriorityNaN:RZ}),VV=SZ({errorItemExists:xT}),Y0=bv({errorIdExists:xT});function PT(){return[...WV.getItems(),...VV.getItems()]}function Nf(t){const e=Qn(t);return Y0.getItem(e)}function EZ(t){return!!Nf(t)}function it(t,e,n){[t,e,n]=_Z(t,e,n),Nf(t)===void 0&&TZ(t,e,n)}function TZ(t,e,n){const r=Qn(t);if(Y0.hasItem(r))throw new Error(xT(r));n===void 0?VV.addItem(r):WV.addItem(n,r),Y0.addItem(r,e)}function _Z(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:MZ,getItem:xZ,hasItem:BV,getNames:PZ,getValues:kbe}=qi("renderers");function iw(t){if(typeof t=="function")return t;if(!BV(t))throw Error(`No registered renderer found under "${t}" name`);return xZ(t)}function mo(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),MZ(t,e)}const{register:OZ,getItem:AZ,hasItem:UV,getNames:IZ,getValues:Lbe}=qi("validators");function OT(t){if(typeof t=="function")return t;if(!UV(t))throw Error(`No registered validator found under "${t}" name`);return AZ(t)}function ac(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),OZ(t,e)}var zV={},HZ=HF,DZ=$E,NZ=Object.keys||function(e){return HZ(e,DZ)},kZ=_o,LZ=_F,$Z=Yl,FZ=Ef,WZ=Qw,VZ=NZ;zV.f=kZ&&!LZ?Object.defineProperties:function(e,n){FZ(e);for(var r=WZ(n),i=VZ(n),o=i.length,s=0,a;o>s;)$Z.f(e,a=i[s++],r[a]);return e};var BZ=Ef,UZ=zV,pO=$E,zZ=NE,GZ=YF,jZ=HE,YZ=PF,wO=">",vO="<",K0="prototype",X0="script",GV=YZ("IE_PROTO"),fy=function(){},jV=function(t){return vO+X0+wO+t+vO+"/"+X0+wO},CO=function(t){t.write(jV("")),t.close();var e=t.parentWindow.Object;return t=null,e},KZ=function(){var t=jZ("iframe"),e="java"+X0+":",n;return t.style.display="none",GZ.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(jV("document.F=Object")),n.close(),n.F},Mg,Jm=function(){try{Mg=new ActiveXObject("htmlfile")}catch{}Jm=typeof document<"u"?document.domain&&Mg?CO(Mg):KZ():CO(Mg);for(var t=pO.length;t--;)delete Jm[K0][pO[t]];return Jm()};zZ[GV]=!0;var XZ=Object.create||function(e,n){var r;return e!==null?(fy[K0]=BZ(e),r=new fy,fy[K0]=null,r[GV]=e):r=Jm(),n===void 0?r:UZ.f(r,n)},qZ=Jw,QZ=XZ,ZZ=Yl.f,q0=qZ("unscopables"),Q0=Array.prototype;Q0[q0]===void 0&&ZZ(Q0,q0,{configurable:!0,value:QZ(null)});var YV=function(t){Q0[q0][t]=!0},JZ=Kl,eJ=Zw,tJ=ev,nJ=LE,rJ=YV;JZ({target:"Array",proto:!0},{at:function(e){var n=eJ(this),r=tJ(n),i=nJ(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});rJ("at");const yl=1,Yn=2;function yO(t,e,n){iJ(t,e),e.set(t,n)}function iJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Do(t,e,n){return e=oJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oJ(t){var e=sJ(t,"string");return typeof e=="symbol"?e:String(e)}function sJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ln(t,e){var n=KV(t,e,"get");return aJ(t,n)}function aJ(t,e){return e.get?e.get.call(t):e.value}function SO(t,e,n){var r=KV(t,e,"set");return lJ(t,r,n),n}function KV(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function lJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var xg=new WeakMap,un=new WeakMap;class AT{static get DEFAULT_WIDTH(){return 50}constructor(e){Do(this,"count",0),Do(this,"startColumn",null),Do(this,"endColumn",null),Do(this,"startPosition",null),Do(this,"isVisibleInTrimmingContainer",!1),Do(this,"stretchAllRatio",0),Do(this,"stretchLastWidth",0),yO(this,xg,{writable:!0,value:0}),Do(this,"needVerifyLastColumnWidth",!0),Do(this,"stretchAllColumnsWidth",[]),yO(this,un,{writable:!0,value:void 0}),SO(this,un,e),typeof ln(this,un).stretchingColumnWidthFn!="function"&&(ln(this,un).stretchingColumnWidthFn=n=>n),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,scrollOffset:r,totalColumns:i,viewportWidth:o}=ln(this,un),s=Math.max(ln(this,un).scrollOffset,0),a=s>0?o+1:o;let l=0,u=!0;const c=[];let h,f=0,g=0;for(let v=0;v<i;v++)if(h=this._getColumnWidth(v),l<=s&&e!==Yn&&(this.startColumn=v,f=h),l>=s&&l+(e===Yn?h:0)<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=v,f=h),this.endColumn=v),c.push(l),l+=h,g=h,e!==Yn&&(this.endColumn=v),l>=s+o){u=!1;break}const p=r+o-a,y=e===Yn?0:g,E=e===Yn?f:0;if(p<-1*ln(this,un).inlineStartOffset||r>c.at(-1)+y||-1*ln(this,un).scrollOffset-ln(this,un).viewportWidth>-1*E?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===i-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const v=c[this.endColumn]+h-c[this.startColumn-1];if((v<=o||e!==Yn)&&(this.startColumn-=1),v>o)break}e===yl&&this.startColumn!==null&&n&&n(this),this.startPosition=c[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(ln(this,un).stretchMode==="none")return;let n=e;SO(this,xg,n);const r=ln(this,un).totalColumns;let i=0;for(let s=0;s<r;s++){const a=this._getColumnWidth(s),l=ln(this,un).stretchingColumnWidthFn(void 0,s);typeof l=="number"?n-=l:i+=a}const o=n-i;if(ln(this,un).stretchMode==="all"&&o>0)this.stretchAllRatio=n/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(ln(this,un).stretchMode==="last"&&n!==1/0){const s=this._getColumnWidth(r-1),a=o+s;this.stretchLastWidth=a>=0?a:s}}getStretchedColumnWidth(e,n){let r=null;return ln(this,un).stretchMode==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):ln(this,un).stretchMode==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0;const i=ln(this,un).totalColumns;if(!this.stretchAllColumnsWidth[e]){const o=Math.round(n*this.stretchAllRatio),s=ln(this,un).stretchingColumnWidthFn(o,e);s===void 0?this.stretchAllColumnsWidth[e]=o:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let o=0;o<this.stretchAllColumnsWidth.length;o++)r+=this.stretchAllColumnsWidth[o];r!==ln(this,xg)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=ln(this,xg)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const n=ln(this,un).totalColumns;return e===n-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=ln(this,un).columnWidthFn(e);return isNaN(n)&&(n=AT.DEFAULT_WIDTH),n}}const IT=AT;function uJ(t,e,n){cJ(t,e),e.set(t,n)}function cJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ch(t,e,n){return e=hJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hJ(t){var e=dJ(t,"string");return typeof e=="symbol"?e:String(e)}function dJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gy(t,e){var n=XV(t,e,"get");return fJ(t,n)}function fJ(t,e){return e.get?e.get.call(t):e.value}function gJ(t,e,n){var r=XV(t,e,"set");return mJ(t,r,n),n}function XV(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function mJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var hh=new WeakMap;class HT{static get DEFAULT_HEIGHT(){return 23}constructor(e){ch(this,"count",0),ch(this,"startRow",null),ch(this,"endRow",null),ch(this,"startPosition",null),ch(this,"isVisibleInTrimmingContainer",!1),uJ(this,hh,{writable:!0,value:void 0}),gJ(this,hh,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,rowHeightFn:r,scrollOffset:i,totalRows:o,viewportHeight:s}=gy(this,hh),a=Math.max(gy(this,hh).scrollOffset,0),l=gy(this,hh).horizontalScrollbarHeight||0;let u=0,c=!0;const h=[];let f,g=0,p=0;for(let C=0;C<o;C++)if(f=r(C),isNaN(f)&&(f=HT.DEFAULT_HEIGHT),u<=a&&e!==Yn&&(this.startRow=C,g=f),u>=a&&u+(e===Yn?f:0)<=a+s-l&&(this.startRow===null&&(this.startRow=C,g=f),this.endRow=C),h.push(u),u+=f,p=f,e!==Yn&&(this.endRow=C),u>=a+s-l){c=!1;break}const y=i+s-l,E=e===Yn?g:0,v=e===Yn?0:p;if(y<E||i>h.at(-1)+v?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const C=h[this.endRow]+f-h[this.startRow-1];if((C<=s-l||e!==Yn)&&(this.startRow-=1),C>=s-l)break}e===yl&&this.startRow!==null&&n&&n(this),this.startPosition=h[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}const qV=HT;function pJ(t,e,n){wJ(t,e),e.set(t,n)}function wJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bO(t,e,n){return e=vJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vJ(t){var e=CJ(t,"string");return typeof e=="symbol"?e:String(e)}function CJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function au(t,e){var n=QV(t,e,"get");return yJ(t,n)}function yJ(t,e){return e.get?e.get.call(t):e.value}function RO(t,e,n){var r=QV(t,e,"set");return SJ(t,r,n),n}function QV(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function SJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var No=new WeakMap;class ow{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;bO(this,"row",null),bO(this,"col",null),pJ(this,No,{writable:!0,value:!1}),RO(this,No,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return au(this,No)}isSouthEastOf(e){return this.row>=e.row&&(au(this,No)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(au(this,No)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(au(this,No)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(au(this,No)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof ow&&RO(this,No,e.isRtl()),this}clone(){return new ow(this.row,this.col,au(this,No))}toObject(){return{row:this.row,col:this.col}}}const sw=ow;function bJ(t,e,n){RJ(t,e),e.set(t,n)}function RJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function my(t,e,n){return e=EJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EJ(t){var e=TJ(t,"string");return typeof e=="symbol"?e:String(e)}function TJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ji(t,e){var n=ZV(t,e,"get");return _J(t,n)}function _J(t,e){return e.get?e.get.call(t):e.value}function MJ(t,e,n){var r=ZV(t,e,"set");return xJ(t,r,n),n}function ZV(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function xJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Jr=new WeakMap;class DT{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;my(this,"highlight",null),my(this,"from",null),my(this,"to",null),bJ(this,Jr,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),MJ(this,Jr,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(r.row,s.row),c=Math.max(r.col,s.col),h=this._createCellCoords(a,l),f=this._createCellCoords(u,c);return this.from=h,this.to=f,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Ji(this,Jr)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Ji(this,Jr)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Ji(this,Jr)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Ji(this,Jr)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Ji(this,Jr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Ji(this,Jr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Ji(this,Jr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Ji(this,Jr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,n){return n&&n.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,n){if(!(e instanceof sw))return!1;if(n){const{from:r,to:i}=n;if(n.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(r.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,r.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push("right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push("left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new DT(this.highlight,this.from,this.to,Ji(this,Jr))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new sw(e,n,Ji(this,Jr))}}const NT=DT;function Rv(t){return window.requestAnimationFrame(t)}function nf(t){window.cancelAnimationFrame(t)}function kT(){return"ontouchstart"in window}let lu;function JV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return lu||(typeof Intl=="object"?lu=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?lu=(n,r)=>`${n}`.localeCompare(r):lu=(n,r)=>n===r?0:n>r?-1:1,lu)}const PJ=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:nf,getComparisonFunction:JV,isTouchSupported:kT,requestAnimationFrame:Rv},Symbol.toStringTag,{value:"Module"}));function eo(t,e,n){OJ(t,e),e.set(t,n)}function OJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Se(t,e){var n=eB(t,e,"get");return AJ(t,n)}function AJ(t,e){return e.get?e.get.call(t):e.value}function Hs(t,e,n){var r=eB(t,e,"set");return IJ(t,r,n),n}function eB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function IJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ei=new WeakMap,py=new WeakMap,bn=new WeakMap,uu=new WeakMap,Pg=new WeakMap,bi=new WeakMap,wy=new WeakMap,dh=new WeakMap,Wa=new WeakMap,to=new WeakMap;let HJ=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;eo(this,ei,{writable:!0,value:void 0}),eo(this,py,{writable:!0,value:void 0}),eo(this,bn,{writable:!0,value:void 0}),eo(this,uu,{writable:!0,value:void 0}),eo(this,Pg,{writable:!0,value:void 0}),eo(this,bi,{writable:!0,value:void 0}),eo(this,wy,{writable:!0,value:void 0}),eo(this,dh,{writable:!0,value:void 0}),eo(this,Wa,{writable:!0,value:[null,null]}),eo(this,to,{writable:!0,value:[null,null]}),Hs(this,ei,r),Hs(this,py,n),Hs(this,bn,o),Hs(this,uu,s),Hs(this,Pg,a),Hs(this,bi,i),Hs(this,wy,e),this.registerEvents()}registerEvents(){Se(this,bi).addEventListener(Se(this,bn).holder,"contextmenu",r=>this.onContextMenu(r)),Se(this,bi).addEventListener(Se(this,bn).TABLE,"mouseover",r=>this.onMouseOver(r)),Se(this,bi).addEventListener(Se(this,bn).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{Se(this,bi).addEventListener(Se(this,bn).holder,"touchstart",r=>this.onTouchStart(r)),Se(this,bi).addEventListener(Se(this,bn).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),Se(this,bi).addEventListener(Se(this,bn).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Se(this,ei).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Se(this,ei).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{Se(this,bi).addEventListener(Se(this,bn).holder,"mouseup",r=>this.onMouseUp(r)),Se(this,bi).addEventListener(Se(this,bn).holder,"mousedown",r=>this.onMouseDown(r))};ss()?e():(kT()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(Se(this,dh)&&r){const[i,o]=[r.row,Se(this,dh).from.row],[s,a]=[r.col,Se(this,dh).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=Se(this,bn).TABLE,i=Qh(e,["TD","TH"],r);return i?(n.coords=Se(this,bn).getCoords(i),n.TD=i):De(e,"wtBorder")&&De(e,"current")?(n.coords=Se(this,uu).getFocusSelection().cellRange.highlight,n.TD=Se(this,bn).getCell(n.coords)):De(e,"wtBorder")&&De(e,"area")&&Se(this,uu).getAreaSelection().cellRange&&(n.coords=Se(this,uu).getAreaSelection().cellRange.to,n.TD=Se(this,bn).getCell(n.coords)),n}onMouseDown(e){const n=Se(this,py).rootDocument.activeElement,r=yT(nV,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);De(i,"corner")?Se(this,ei).getSetting("onCellCornerMouseDown",e,i):o.TD&&Se(this,ei).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(Se(this,to)[0]=o.TD,clearTimeout(Se(this,Wa)[0]),Se(this,Wa)[0]=setTimeout(()=>{Se(this,to)[0]=null},1e3))}onContextMenu(e){if(Se(this,ei).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!Se(this,ei).has("onCellMouseOver"))return;const n=Se(this,bn).TABLE,r=Qh(e.target,["TD","TH"],n),i=Se(this,Pg)||this;r&&r!==i.lastMouseOver&&ma(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,Se(this,bn).getCoords(r),r))}onMouseOut(e){if(!Se(this,ei).has("onCellMouseOut"))return;const n=Se(this,bn).TABLE,r=Qh(e.target,["TD","TH"],n),i=Qh(e.relatedTarget,["TD","TH"],n),o=Se(this,Pg)||this;r&&r!==i&&ma(r,n)&&(this.callListener("onCellMouseOut",e,Se(this,bn).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&Se(this,ei).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===Se(this,to)[0]&&n.TD===Se(this,to)[1]?(De(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),Se(this,to)[0]=null,Se(this,to)[1]=null):n.TD===Se(this,to)[0]&&(Se(this,to)[1]=n.TD,clearTimeout(Se(this,Wa)[1]),Se(this,Wa)[1]=setTimeout(()=>{Se(this,to)[1]=null},500)))}onTouchStart(e){Hs(this,dh,Se(this,uu).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=he(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&Se(this,ei).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];RT()&&(RV()||EV())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=Se(this,ei).getSettingPure(e);o&&o(n,r,i,Se(this,wy).call(this))}destroy(){clearTimeout(Se(this,Wa)[0]),clearTimeout(Se(this,Wa)[1]),Se(this,bi).destroy()}};const tB=HJ;function vy(t,e,n){return e=DJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DJ(t){var e=NJ(t,"string");return typeof e=="symbol"?e:String(e)}function NJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kJ{constructor(e,n,r){vy(this,"offset",void 0),vy(this,"total",void 0),vy(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const LJ=kJ;function Cy(t,e,n){return e=$J(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $J(t){var e=FJ(t,"string");return typeof e=="symbol"?e:String(e)}function FJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WJ{constructor(e,n,r){Cy(this,"offset",void 0),Cy(this,"total",void 0),Cy(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const VJ=WJ,BJ=0,aw=1,lw=2;function Og(t,e,n){return e=UJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UJ(t){var e=zJ(t,"string");return typeof e=="symbol"?e:String(e)}function zJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EO{constructor(){Og(this,"currentSize",0),Og(this,"nextSize",0),Og(this,"currentOffset",0),Og(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function yy(t,e,n){return e=GJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GJ(t){var e=jJ(t,"string");return typeof e=="symbol"?e:String(e)}function jJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YJ{constructor(){yy(this,"size",new EO),yy(this,"workingSpace",BJ),yy(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof EO}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=aw,e.workingSpace=lw,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=lw,e.workingSpace=aw,this.sharedSize=e.getViewSize()}}function cu(t,e,n){return e=KJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KJ(t){var e=XJ(t,"string");return typeof e=="symbol"?e:String(e)}function XJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nB{constructor(e,n,r){cu(this,"rootNode",void 0),cu(this,"nodesPool",void 0),cu(this,"sizeSet",new YJ),cu(this,"childNodeType",void 0),cu(this,"visualIndex",0),cu(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(aw))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn(lw)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}const s=r&&n.isPlaceOn(aw);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(lw)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class rB extends nB{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function qJ(t,e,n){return e=QJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QJ(t){var e=ZJ(t,"string");return typeof e=="symbol"?e:String(e)}function ZJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JJ{constructor(e){qJ(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function fh(t,e,n){return e=eee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eee(t){var e=tee(t,"string");return typeof e=="symbol"?e:String(e)}function tee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kf{constructor(e,n){fh(this,"nodesPool",null),fh(this,"nodeType",void 0),fh(this,"rootNode",void 0),fh(this,"table",null),fh(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new JJ(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function TO(t,e,n){return e=nee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nee(t){var e=ree(t,"string");return typeof e=="symbol"?e:String(e)}function ree(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iee extends kf{constructor(){super("TH"),TO(this,"orderViews",new WeakMap),TO(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new rB(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<r;h++){u.render();const f=u.getCurrentNode();f.className="",f.removeAttribute("style"),Ha(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Re(f,[kq(),zq(),dT(h+1),Vc(-1)]),n[h](a,f,h)}u.end()}}}class oee extends kf{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Ki(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Re(this.rootNode,[Fi()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Re(s,[QW(),tV(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Ha(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Re(u,[dT(a+1+this.table.rowHeadersCount),Vc(-1),...a<0?[Fi()]:[Lq(),Uq()]]),r[n](l,u,n)}}}}class see extends kf{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&te(r,"rowHeader")}}function aee(t,e,n){return e=lee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lee(t){var e=uee(t,"string");return typeof e=="symbol"?e:String(e)}function uee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let _O=!1;class cee extends kf{constructor(e){super("TR",e),aee(this,"orderView",void 0),this.orderView=new nB(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!_O&&e>1e3&&(_O=!0,Rt(mt`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Re(this.rootNode,[Fi()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Re(o,[QW(),tV(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}function MO(t,e,n){return e=hee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hee(t){var e=dee(t,"string");return typeof e=="symbol"?e:String(e)}function dee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fee extends kf{constructor(){super("TD"),MO(this,"orderViews",new WeakMap),MO(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new rB(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let f=0;f<n;f++){c.render();const g=c.getCurrentNode(),p=this.table.renderedColumnToSource(f);if(De(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),Ha(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,p,g),this.table.isAriaEnabled()){var o,s;Re(g,[...g.hasAttribute("role")?[]:[Nq()],Vc(-1),dT(p+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function Rn(t,e,n){return e=gee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gee(t){var e=mee(t,"string");return typeof e=="symbol"?e:String(e)}function mee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pee{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Rn(this,"rootNode",void 0),Rn(this,"rootDocument",void 0),Rn(this,"rowHeaders",null),Rn(this,"columnHeaders",null),Rn(this,"colGroup",null),Rn(this,"rows",null),Rn(this,"cells",null),Rn(this,"rowFilter",null),Rn(this,"columnFilter",null),Rn(this,"rowUtils",null),Rn(this,"columnUtils",null),Rn(this,"rowsToRender",0),Rn(this,"columnsToRender",0),Rn(this,"rowHeaderFunctions",[]),Rn(this,"rowHeadersCount",0),Rn(this,"columnHeaderFunctions",[]),Rn(this,"columnHeadersCount",0),Rn(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r);if(i.firstChild){const o=this.renderedRowToSource(r),s=this.rowUtils.getHeight(o);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}}class wee{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new pee(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new iee,columnHeaders:new oee(n),colGroup:new see(r),rows:new cee(i),cells:new fee}),this.renderer.setAxisUtils(o,s)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Sy(t,e,n){return e=vee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vee(t){var e=Cee(t,"string");return typeof e=="symbol"?e:String(e)}function Cee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yee{constructor(e,n){Sy(this,"dataAccessObject",void 0),Sy(this,"wtSettings",void 0),Sy(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const n=this.dataAccessObject.wtViewport.columnsRenderCalculator;let r=this.getWidth(e);if(n){const i=n.getStretchedColumnWidth(e,r);i&&(r=i)}return r}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:n,wtViewport:r,cloneSource:i}=this.dataAccessObject,o=i?i.wtTable.holder:n.holder,s=o.offsetHeight<o.scrollHeight?yn():0;let a=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-s),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){const l=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth");for(let c=0;c<l;c++){let h=Array.isArray(a)?a[c]:a;h=h??u,this.headerWidths.set(c,h)}}}}function xO(t,e,n){return e=See(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function See(t){var e=bee(t,"string");return typeof e=="symbol"?e:String(e)}function bee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ree{constructor(e,n){xO(this,"dataAccessObject",void 0),xO(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}}function no(t,e,n){return e=Eee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eee(t){var e=Tee(t,"string");return typeof e=="symbol"?e:String(e)}function Tee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _ee{constructor(e,n,r,i,o){no(this,"wtSettings",null),no(this,"domBindings",void 0),no(this,"TBODY",null),no(this,"THEAD",null),no(this,"COLGROUP",null),no(this,"hasTableHeight",!0),no(this,"hasTableWidth",!0),no(this,"isTableVisible",!1),no(this,"tableOffset",0),no(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,fT(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new Ree(this.dataAccessObject,this.wtSettings),this.columnUtils=new yee(this.dataAccessObject,this.wtSettings),this.tableRenderer=new wee({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Re(r,[Fi()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Re(r,[Fi()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Re(r.parentNode,[Fi()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Re(r,[Fi()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=!1,f=e;if(this.isMaster&&(this.holderOffset=on(this.holder),f=i.createRenderCalculators(f),l&&!n.getSetting("fixedColumnsStart"))){const p=r.inlineStartOverlay.getScrollPosition(),y=this.correctHeaderWidth;this.correctHeaderWidth=p!==0,y!==this.correctHeaderWidth&&(f=!1)}if(this.isMaster&&(h=r.updateStateOfRendering()),f)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=on(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const p=o>0?this.getFirstRenderedRow():0,y=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new VJ(p,o,c),this.columnFilter=new LJ(y,s,l);let E=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const v={};this.wtSettings.getSetting("beforeDraw",!0,v),E=v.skipRender!==!0}if(E){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(yo)||this.is(wa))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let v;if(this.isMaster&&(v=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(yo))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const C=gt(this.hider),S=gt(this.TABLE);C!==0&&S!==C&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),v!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(yo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let g=!1;return this.isMaster&&(g=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(g=r.bottomOverlay.resetFixedPosition()||g),g=r.inlineStartOverlay.resetFixedPosition()||g,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),g?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(f),h&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=os(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(yo))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Ra(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let o=oV(r),s=n.cellIndex;return zs(Ul,n,this.wtRootElement)||zs(Vl,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):zs(wa,n,this.wtRootElement)||zs(yo,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),zs(Ul,n,this.wtRootElement)||zs(Bl,n,this.wtRootElement)||zs(wa,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),r=os(this.TBODY)-1;let i,o,s,a,l;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=os(l):o=os(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return gt(this.TABLE)}getHeight(){return Wt(this.TABLE)}getTotalWidth(){const e=gt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Wt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Ta(this.TABLE)}_modifyRowHeaderWidth(e){let n=St(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Gc=_ee,Mee="stickyRowsBottom",iB={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Oo(iB,"MIXIN_NAME",Mee,{writable:!1,enumerable:!1});const oB=iB,xee="stickyColumnsStart",sB={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Oo(sB,"MIXIN_NAME",xee,{writable:!1,enumerable:!1});const LT=sB;class $T extends Gc{constructor(e,n,r,i){super(e,n,r,i,wa)}}vt($T,oB);vt($T,LT);const Pee=$T,Vl="top",yo="bottom",Bl="inline_start",Ul="top_inline_start_corner",wa="bottom_inline_start_corner",Oee=[Vl,yo,Bl,Ul,wa],Aee=new Map([[Vl,`ht_clone_${Vl}`],[yo,`ht_clone_${yo}`],[Bl,`ht_clone_${Bl} ht_clone_left`],[Ul,`ht_clone_${Ul} ht_clone_top_left_corner`],[wa,`ht_clone_${wa} ht_clone_bottom_left_corner`]]);function by(t,e,n){return e=Iee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iee(t){var e=Hee(t,"string");return typeof e=="symbol"?e:String(e)}function Hee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dee{constructor(e){by(this,"dataAccessObject",void 0),by(this,"lastScrolledColumnPos",-1),by(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,n,r,i,o){const s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,n,i);return s||a}scrollViewportHorizontally(e,n,r){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=n===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let h=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?h=c.scrollTo(e,l?e>this.lastScrolledColumnPos:n):(l&&(e<s||e>a)||!l)&&(h=c.scrollTo(e,l?e>a:n)),h&&(this.lastScrolledColumnPos=e),h}scrollViewportVertically(e,n,r){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=n===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:h}=this.dataAccessObject;if(l&&(e<c||e>o-u-1))return!1;let f=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?f=h.scrollTo(e,l?e>this.lastScrolledRowPos:r):(l&&(e<s||e>a)||!l)&&(f=h.scrollTo(e,l?e>a:r)),f&&(this.lastScrolledRowPos=e),f}getFirstVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,fixedRowsTop:o,rootWindow:s}=this.dataAccessObject;let a=n.getFirstVisibleRow();if(e.mainTableScrollableElement===s){const l=on(n.wtRootElement),u=os(n.hider),c=os(s),h=Jd(s,s);if(l.top+u-c<=h){let f=r.getColumnHeaderHeight();f+=e.sumCellSizes(0,o);for(let g=i;g>0;g--)if(f+=e.sumCellSizes(g-1,g),l.top+u-f<=h){a=g;break}}}return a}getLastVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;let s=n.getLastVisibleRow();if(e.mainTableScrollableElement===o){const a=on(n.wtRootElement),l=Jd(o,o);if(a.top>l){const u=os(o);let c=r.getColumnHeaderHeight();for(let h=1;h<=i;h++)if(c+=e.sumCellSizes(h-1,h),a.top+c-l>=u){s=h-2;break}}}return s}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:n,wtViewport:r,totalColumns:i,rootWindow:o}=this.dataAccessObject;let s=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===o){const a=on(n.wtRootElement),l=wd(n.hider),u=wd(o),c=Math.abs(Jp(o,o));if(a.left+l-u<=c){let h=r.getRowHeaderWidth();for(let f=i;f>0;f--)if(h+=e.sumCellSizes(f-1,f),a.left+l-h<=c){s=f;break}}}return s}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;let a=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){const l=e.getSetting("rtlMode");let u=null;if(l){const h=r.TABLE.getBoundingClientRect(),g=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(h.right-g)}else u=on(r.wtRootElement).left;const c=Math.abs(Jp(s,s));if(u>c){const h=wd(s);let f=i.getRowHeaderWidth();for(let g=1;g<=o;g++)if(f+=n.sumCellSizes(g-1,g),u+f-c>=h){a=g-2;break}}}return a}}const Nee=Dee;function Ri(t,e,n){return e=kee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kee(t){var e=Lee(t,"string");return typeof e=="symbol"?e:String(e)}function Lee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FT{get eventManager(){return new Kr(this)}constructor(e,n){Ri(this,"wtTable",void 0),Ri(this,"wtScroll",void 0),Ri(this,"wtViewport",void 0),Ri(this,"wtOverlays",void 0),Ri(this,"selectionManager",void 0),Ri(this,"wtEvent",void 0),Ri(this,"guid",`wt_${uT()}`),Ri(this,"drawInterrupted",!1),Ri(this,"drawn",!1),Ri(this,"domBindings",void 0),Ri(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new Nee(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Ea(r,e[n])}])}}createCellCoords(e,n){return new sw(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new NT(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function PO(t,e,n){return e=$ee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ee(t){var e=Fee(t,"string");return typeof e=="symbol"?e:String(e)}function Fee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wee extends FT{constructor(e,n,r){super(e,n),PO(this,"cloneSource",void 0),PO(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new tB(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function Vee(t,e,n){return e=Bee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bee(t){var e=Uee(t,"string");return typeof e=="symbol"?e:String(e)}function Uee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lf{constructor(e,n,r,i,o){Vee(this,"wtSettings",null),Oo(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=$l(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=$l(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=ef(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){Rt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+yn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(Oee.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("DIV"),s=r.createElement("TABLE"),a=e.wtRootElement.parentNode;o.className=`${Aee.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Re(o,[Fi()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Vl||u==="vertical"&&this.type===Bl?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=ef(e.TABLE),new Wee(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;P([r,i,o],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class zee extends Lf{constructor(e,n,r,i,o,s){super(e,n,wa,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Pee(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else If(n),this.repositionOverlay();let r=Wt(this.clone.wtTable.TABLE);const i=gt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=yn(r)),i.style.bottom=`${o}px`}}const Gee="calculatedColumns",aB={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Oo(aB,"MIXIN_NAME",Gee,{writable:!1,enumerable:!1});const WT=aB;class VT extends Gc{constructor(e,n,r,i){super(e,n,r,i,yo)}}vt(VT,oB);vt(VT,WT);const jee=VT;function Yee(t,e,n){return e=Kee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kee(t){var e=Xee(t,"string");return typeof e=="symbol"?e:String(e)}function Xee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qee extends Lf{constructor(e,n,r,i){super(e,n,yo,r,i),Yee(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new jee(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=yn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(mv(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=yn(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=o),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Wt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=yn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Jd(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=De(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(te(s,"innerBorderBottom"),o=!a):(Le(s,"innerBorderBottom"),o=a)}return o}}const Qee="calculatedRows",lB={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Oo(lB,"MIXIN_NAME",Qee,{writable:!1,enumerable:!1});const uB=lB;class BT extends Gc{constructor(e,n,r,i){super(e,n,r,i,Bl)}}vt(BT,uB);vt(BT,LT);const Zee=BT,Jee="localHooks",cB={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)tw(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Oo(cB,"MIXIN_NAME",Jee,{writable:!1,enumerable:!1});const Nr=cB;let hB=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};vt(hB,Nr);const ete=hB,dB="active-header",UT="header",zT="area",GT="focus",tte="fill",nte="row",rte="column",ite="custom-selection",jT=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var ote=YV;ote("flat");function ste(t,e){fB(t,e),e.add(t)}function OO(t,e,n){fB(t,e),e.set(t,n)}function fB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ry(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function tn(t,e){var n=gB(t,e,"get");return ate(t,n)}function ate(t,e){return e.get?e.get.call(t):e.value}function AO(t,e,n){var r=gB(t,e,"set");return lte(t,r,n),n}function gB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function lte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ei=new WeakMap,Rr=new WeakMap,Ag=new WeakSet;class ute{constructor(){ste(this,Ag),OO(this,Ei,{writable:!0,value:void 0}),OO(this,Rr,{writable:!0,value:void 0})}setActiveOverlay(e){return AO(this,Rr,e),this}setActiveSelection(e){return AO(this,Ei,e),this}scan(){const e=tn(this,Ei).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=tn(this,Ei).getCorners(),{wtTable:s}=tn(this,Rr),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let f=-l;f<0;f++){if(f<n||f>i)continue;const g=f+l;let p=s.getColumnHeader(h,g);const y=tn(this,Rr).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:tn(this,Ei).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});y!==null&&(y!==h&&(p=s.getColumnHeader(y,g)),e(p))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=tn(this,Ei).getCorners(),{wtTable:s}=tn(this,Rr),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let f=-l;f<0;f++){if(f<r||f>o)continue;const g=f+l;let p=s.getRowHeader(h,g);const y=tn(this,Rr).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:tn(this,Ei).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});y!==null&&(y!==h&&(p=s.getRowHeader(y,g)),e(p))}u+=1}}}scanCellsRange(e){const[n,r,i,o]=tn(this,Ei).getCorners(),{wtTable:s}=tn(this,Rr);Ry(this,Ag,Ey).call(this,(a,l)=>{if(a>=n&&a<=i&&l>=r&&l<=o){const u=s.getCell(tn(this,Rr).createCellCoords(a,l)),c=tn(this,Rr).getSetting("onAfterDrawSelection",a,l,tn(this,Ei).settings.layerLevel);typeof c=="string"&&te(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,r]=tn(this,Ei).getCorners(),{wtTable:i}=tn(this,Rr);Ry(this,Ag,Ey).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(tn(this,Rr).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=tn(this,Ei).getCorners(),{wtTable:i}=tn(this,Rr);Ry(this,Ag,Ey).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(tn(this,Rr).createCellCoords(o,s));e(a)}})}}function Ey(t){const{wtTable:e}=tn(this,Rr),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class cte{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=jT,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ci(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),ss()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};je(i,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};je(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:f}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),p=parseInt(u.width,10),y=parseInt(c.width,10),E=this.wot.wtTable.getWidth(),v=this.wot.wtTable.getHeight();u.top=`${parseInt(r-p-1,10)}px`,u[l]=`${parseInt(i-p-1,10)}px`,c.top=`${parseInt(r-y/4*3,10)}px`,c[l]=`${parseInt(i-y/4*3,10)}px`;const C=Math.min(parseInt(i+o,10),E-p-g*2),S=Math.min(parseInt(i+o-y/4,10),E-y-g*2);h[l]=`${C}px`,f[l]=`${S}px`;const T=Math.min(parseInt(r+s,10),v-p-g*2),_=Math.min(parseInt(r+s-y/4,10),v-y-g*2);h.top=`${T}px`,f.top=`${_}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",f.display="none"):(h.display="block",f.display="block")):(u.display="none",h.display="none",c.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:r,rootWindow:i}=this.wot;let o,s,a,l,u,c;const h=n.getRenderedRowsCount();for(let R=0;R<h;R+=1){const d=n.rowFilter.renderedToSource(R);if(d>=e[0]&&d<=e[2]){o=d,u=e[0];break}}for(let R=h-1;R>=0;R-=1){const d=n.rowFilter.renderedToSource(R);if(d>=e[0]&&d<=e[2]){s=d;break}}const f=n.getRenderedColumnsCount();for(let R=0;R<f;R+=1){const d=n.columnFilter.renderedToSource(R);if(d>=e[1]&&d<=e[3]){a=d,c=e[1];break}}for(let R=f-1;R>=0;R-=1){const d=n.columnFilter.renderedToSource(R);if(d>=e[1]&&d<=e[3]){l=d;break}}if(o===void 0||a===void 0){this.disappear();return}let g=n.getCell(this.wot.createCellCoords(o,a));const p=o!==s||a!==l,y=p?n.getCell(this.wot.createCellCoords(s,l)):g,E=on(g),v=p?on(y):E,C=on(n.TABLE),S=gt(n.TABLE),T=E.top,_=E.left,H=this.wot.wtSettings.getSetting("rtlMode");let D=0,B=0;if(H){const R=gt(g),d=i.innerWidth-C.left-S;B=_+R-v.left,D=i.innerWidth-_-R-d-1}else B=v.left+gt(y)-_,D=_-C.left-1;if(this.isEntireColumnSelected(o,s)){const R=this.getDimensionsFromHeader("columns",a,l,u,C);let d=null;R&&([d,D,B]=R),d&&(g=d)}let z=T-C.top-1,G=v.top+Wt(y)-T;if(this.isEntireRowSelected(a,l)){const R=this.getDimensionsFromHeader("rows",o,s,c,C);let d=null;R&&([d,z,G]=R),d&&(g=d)}const Z=Cs(g,i);parseInt(Z.borderTopWidth,10)>0&&(z+=1,G=G>0?G-1:0),parseInt(Z[H?"borderRightWidth":"borderLeftWidth"],10)>0&&(D+=1,B=B>0?B-1:0);const re=H?"right":"left";this.topStyle.top=`${z}px`,this.topStyle[re]=`${D}px`,this.topStyle.width=`${B}px`,this.topStyle.display="block",this.startStyle.top=`${z}px`,this.startStyle[re]=`${D}px`,this.startStyle.height=`${G}px`,this.startStyle.display="block";const ne=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${z+G-ne}px`,this.bottomStyle[re]=`${D}px`,this.bottomStyle.width=`${B}px`,this.bottomStyle.display="block",this.endStyle.top=`${z}px`,this.endStyle[re]=`${D+B-ne}px`,this.endStyle.height=`${G+1}px`,this.endStyle.display="block";let ue=this.settings.border.cornerVisible;ue=typeof ue=="function"?ue(this.settings.layerLevel):ue;const Ee=this.wot.getSetting("onModifyGetCellCoords",s,l);let[$e,He]=[s,l];if(Ee&&Array.isArray(Ee)&&([,,$e,He]=Ee),ss()||!ue||this.isPartRange($e,He))this.cornerStyle.display="none";else{this.cornerStyle.top=`${z+G+this.cornerCenterPointOffset-1}px`,this.cornerStyle[re]=`${D+B+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let R=$l(n.TABLE);const d=R===i;d&&(R=r.documentElement);const m=parseInt(this.cornerDefaultStyle.width,10)/2,w=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const x=d?y.getBoundingClientRect().left:y.offsetLeft;let O=!1,A=0;H?(A=x-parseInt(this.cornerDefaultStyle.width,10)/2,O=A<0):(A=x+gt(y)+parseInt(this.cornerDefaultStyle.width,10)/2,O=A>=wd(R)),O&&(this.cornerStyle[re]=`${Math.floor(D+B+this.cornerCenterPointOffset-m)}px`,this.cornerStyle[H?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(d?y.getBoundingClientRect().top:y.offsetTop)+Wt(y)+parseInt(this.cornerDefaultStyle.height,10)/2>=os(R)&&(this.cornerStyle.top=`${Math.floor(z+G+this.cornerCenterPointOffset-w)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}ss()&&this.updateMultipleSelectionHandlesPosition(s,l,z,D,B,G)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,f=null,g=null,p=null,y=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return Wt(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return gt(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const E=this.wot.getSetting("columnHeaders").length;if(p=l(n,E-i),y=l(r,E-i),!p||!y)return!1;const v=on(p),C=on(y);return p&&y&&(h=v[g]-o[g]-1,f=C[g]+u(y)-v[g]),[p,h,f]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?te(this[e],"hidden"):(De(this[e],"hidden")&&Le(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?te(this[e],"hidden"):Le(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",ss()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const IO=cte;function hte(t,e){mB(t,e),e.add(t)}function hu(t,e,n){mB(t,e),e.set(t,n)}function mB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dte(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ze(t,e){var n=pB(t,e,"get");return fte(t,n)}function fte(t,e){return e.get?e.get.call(t):e.value}function HO(t,e,n){var r=pB(t,e,"set");return gte(t,r,n),n}function pB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Un=new WeakMap,Gn=new WeakMap,Ty=new WeakMap,Zh=new WeakMap,_y=new WeakMap,Va=new WeakMap,DO=new WeakSet;class mte{constructor(e){hte(this,DO),hu(this,Un,{writable:!0,value:void 0}),hu(this,Gn,{writable:!0,value:void 0}),hu(this,Ty,{writable:!0,value:new ute}),hu(this,Zh,{writable:!0,value:new WeakMap}),hu(this,_y,{writable:!0,value:new WeakSet}),hu(this,Va,{writable:!0,value:new Map}),HO(this,Gn,e)}setActiveOverlay(e){return HO(this,Un,e),ze(this,Ty).setActiveOverlay(ze(this,Un)),ze(this,Zh).has(ze(this,Un))||ze(this,Zh).set(ze(this,Un),new Set),this}getFocusSelection(){return ze(this,Gn)!==null?ze(this,Gn).getFocus():null}getAreaSelection(){return ze(this,Gn)!==null?ze(this,Gn).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(ze(this,Va).has(e)){const r=ze(this,Va).get(e);if(r.has(ze(this,Un)))return r.get(ze(this,Un));const i=new IO(ze(this,Un),e.settings);return r.set(ze(this,Un),i),i}const n=new IO(ze(this,Un),e.settings);return ze(this,Va).set(e,new Map([[ze(this,Un),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=ze(this,Va).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){ze(this,Va).get(e).forEach(n=>n.destroy()),ze(this,Va).delete(e)}render(e){if(ze(this,Gn)===null)return;e&&dte(this,DO,pte).call(this);const n=Array.from(ze(this,Gn)),r=new Map;for(let i=0;i<n.length;i++){const o=n[i],{className:s,createLayers:a,selectionType:l}=o.settings;ze(this,_y).has(o)||(ze(this,_y).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const u=this.getBorderInstance(o);if(o.isEmpty()){u==null||u.disappear();continue}s&&ze(this,Ty).setActiveSelection(o).scan().forEach(f=>{if(r.has(f)){const g=r.get(f);g.has(s)&&a===!0?g.set(s,g.get(s)+1):g.set(s,1)}else r.set(f,new Map([[s,1]]))});const c=o.getCorners();ze(this,Un).getSetting("onBeforeDrawBorders",c,l),u==null||u.appear(c)}r.forEach((i,o)=>{var s,a;const l=Array.from(i).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(f,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>ze(this,Zh).get(ze(this,Un)).add(u)),te(o,l),o.nodeName==="TD"&&Array.isArray((s=ze(this,Gn).options)===null||s===void 0?void 0:s.cellAttributes)?Re(o,ze(this,Gn).options.cellAttributes):o.nodeName==="TH"&&Array.isArray((a=ze(this,Gn).options)===null||a===void 0?void 0:a.headerAttributes)&&Re(o,ze(this,Gn).options.headerAttributes)})}}function pte(){const t=ze(this,Zh).get(ze(this,Un)),e=ze(this,Un).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=ze(this,Un).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=ze(this,Gn).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=ze(this,Gn).options.cellAttributes.map(a=>a[0])),Array.isArray((i=ze(this,Gn).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...ze(this,Gn).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)Le(o[a],n),Ha(o[a],s)}),t.clear()}class wte extends Lf{constructor(e,n,r,i){super(e,n,Bl,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Zee(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),pv(r,`${o}px`,"0px")):(o=this.getScrollPosition(),If(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,gT(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=yn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=gt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(jT.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;if(n){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(n=!1)}return n&&o.offsetWidth!==o.clientWidth&&(s=yn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(Jp(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?Le(n,"emptyRows"):te(n,"emptyRows");let s=!1;if(i&&!r.length)te(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const a=De(n,"innerBorderInlineStart");e?(te(n,"innerBorderLeft innerBorderInlineStart"),s=!a):(Le(n,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}}const vte="stickyRowsTop",wB={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Oo(wB,"MIXIN_NAME",vte,{writable:!1,enumerable:!1});const vB=wB;class YT extends Gc{constructor(e,n,r,i){super(e,n,r,i,Ul)}}vt(YT,vB);vt(YT,LT);const Cte=YT;function NO(t,e,n){return e=yte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yte(t){var e=Ste(t,"string");return typeof e=="symbol"?e:String(e)}function Ste(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bte extends Lf{constructor(e,n,r,i,o,s){super(e,n,Ul,r,i),NO(this,"topOverlay",void 0),NO(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Cte(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();pv(e,`${i}px`,`${o}px`)}else If(e);let n=Wt(this.clone.wtTable.TABLE);const r=gt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class KT extends Gc{constructor(e,n,r,i){super(e,n,r,i,Vl)}}vt(KT,vB);vt(KT,WT);const Rte=KT;function Ete(t,e,n){return e=Tte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tte(t){var e=_te(t,"string");return typeof e=="symbol"?e:String(e)}function _te(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mte extends Lf{constructor(e,n,r,i){super(e,n,Vl,r,i),Ete(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Rte(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),pv(e,"0px",`${i}px`)}else i=this.getScrollPosition(),If(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(mv(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=yn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Wt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(jT.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(n){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(l=yn(this.domBindings.rootDocument)),n){const u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Jd(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?Le(r,"emptyColumns"):te(r,"emptyColumns");let o=!1;if(!n){const s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,l=this.wtSettings.getSetting("columnHeaders");if((a||s===0)&&l.length>0){const u=De(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(te(r,"innerBorderTop"),o=!u):(Le(r,"innerBorderTop"),o=u)}}return o}}function ko(t,e,n){return e=xte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xte(t){var e=Pte(t,"string");return typeof e=="symbol"?e:String(e)}function Pte(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ote{constructor(e,n,r,i,o,s){ko(this,"wot",null),ko(this,"topOverlay",null),ko(this,"bottomOverlay",null),ko(this,"inlineStartOverlay",null),ko(this,"topInlineStartCornerOverlay",null),ko(this,"bottomInlineStartCornerOverlay",null),ko(this,"browserLineHeight",void 0),ko(this,"wtSettings",null),ko(this,"resizeObserver",new ResizeObserver(c=>{Rv(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=yn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:ef(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Mte(...e),this.bottomOverlay=new qee(...e),this.inlineStartOverlay=new wte(...e),this.topInlineStartCornerOverlay=new bte(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new zee(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!ST())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:f}=h.clone.wtTable;this.eventManager.addEventListener(f,"wheel",g=>this.onCloneWheel(g,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=zc(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=ef(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:n}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),a=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,o)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:h,scrollWidth:f}=r.holder;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<f,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return P(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];P(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}const Ate=Ote;function kO(t,e,n){return e=Ite(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ite(t){var e=Hte(t,"string");return typeof e=="symbol"?e:String(e)}function Hte(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dte{constructor(e){kO(this,"settings",{}),kO(this,"defaults",Object.freeze(this.getDefaults())),je(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Ea(r,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?je(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class XT extends Gc{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=$l(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=xc(e,"height",n),o=xc(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?r.insertBefore(f,e.nextElementSibling):r.appendChild(f);const g=parseInt(Cs(f,n).height,10);r.removeChild(f),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Ta(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}vt(XT,uB);vt(XT,WT);const Nte=XT;class kte{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=Wt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-o:u.left,h=o-c;let f,g;if(a)return gt(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?f=Math.min(h,o):f=Math.min(this.getContainerFillWidth(),h,o),i===r&&s>0&&this.sumColumnWidths(0,s-1)>f)return n.documentElement.clientWidth;if(i!==r&&(g=xc(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(f,i.clientWidth);const p=e.getSetting("stretchH");return p==="none"||!p?Math.max(f,gt(this.wtTable.TABLE)):f}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return on(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Wt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=gt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yl;const{wtSettings:n,wtTable:r}=this;let i,o,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&e===yl?i=1/0:i=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=yn(this.domBindings.rootDocument),new qV({viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yl;const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=yn(this.domBindings.rootDocument)),new IT({viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:n.getSetting("stretchH"),stretchingColumnWidthFn:(a,l)=>n.getSetting("onBeforeStretchingColumnWidth",a,l),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(n){const r=this.createRowsCalculator(Yn),i=this.createColumnsCalculator(Yn);this.areAllProposedVisibleRowsAlreadyRendered(r)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(yl),this.columnsRenderCalculator=this.createColumnsCalculator(yl)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(Yn),this.columnsVisibleCalculator=this.createColumnsCalculator(Yn)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:n,endRow:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startRow:o,endRow:s}=this.rowsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:n,endColumn:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){je(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}const Lte=kte;class $te extends FT{constructor(e,n){super(e,new Dte(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new Nte(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new Lte(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new mte(this.wtSettings.getSetting("selections")),this.wtEvent=new tB(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Ate(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];je(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),Le(this.wtTable.wtRootElement.parentNode,n),te(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class qT{constructor(e){e instanceof FT?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new qT(n);return()=>r},this._wot=new $te(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,i,o){return this._wot.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function LO(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),f=n||r&&h;i.row<0&&i.col>=0&&!s.column?f&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?f&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?f&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function Fte(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n)}const Wte=new Map([["mousedown",LO],["mouseover",Fte],["touchstart",LO]]);function $O(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;Wte.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:yv(t)||t.type==="touchstart",isRightClick:_a(t)})}const CB=new WeakMap,QT=Symbol("rootInstance");function Vte(t){CB.set(t,!0)}function Bte(t){return t===QT}function ep(t){return CB.has(t)}function Ba(t,e,n){Ute(t,e),e.set(t,n)}function Ute(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ds(t,e,n){return e=zte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zte(t){var e=Gte(t,"string");return typeof e=="symbol"?e:String(e)}function Gte(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function In(t,e){var n=yB(t,e,"get");return jte(t,n)}function jte(t,e){return e.get?e.get.call(t):e.value}function ti(t,e,n){var r=yB(t,e,"set");return Yte(t,r,n),n}function yB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Yte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var My=new WeakMap,xy=new WeakMap,Ig=new WeakMap,Lo=new WeakMap,Ti=new WeakMap,Py=new WeakMap,Oy=new WeakMap;class Kte{constructor(e){Ds(this,"hot",void 0),Ds(this,"eventManager",void 0),Ds(this,"settings",void 0),Ds(this,"THEAD",void 0),Ds(this,"TBODY",void 0),Ds(this,"_wt",void 0),Ds(this,"activeWt",void 0),Ba(this,My,{writable:!0,value:0}),Ba(this,xy,{writable:!0,value:0}),Ds(this,"postponedAdjustElementsSize",!1),Ba(this,Ig,{writable:!0,value:!1}),Ba(this,Lo,{writable:!0,value:void 0}),Ba(this,Ti,{writable:!0,value:void 0}),Ba(this,Py,{writable:!0,value:0}),Ba(this,Oy,{writable:!0,value:0}),this.hot=e,this.eventManager=new Kr(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,i,o){return this._wt.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),te(e,"handsontable"),ti(this,Ti,n.createElement("TABLE")),te(In(this,Ti),"htCore"),this.hot.getSettings().tableClassName&&te(In(this,Ti),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Re(In(this,Ti),[Fi()]),Re(e,[Dq(),JW(this.hot.countRows()),eV(this.hot.countCols()),Yq()])),this.THEAD=n.createElement("THEAD"),In(this,Ti).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),In(this,Ti).appendChild(this.TBODY),this.hot.table=In(this,Ti),this.hot.container.insertBefore(In(this,Ti),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r}=this.hot,i=n.documentElement;this.eventManager.addEventListener(e,"mousedown",o=>{if(ti(this,Ig,!0),!this.isTextSelectionAllowed(o.target)){const{rootWindow:s}=this.hot;$0(s),o.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{ti(this,Ig,!1)}),this.eventManager.addEventListener(e,"mousemove",o=>{In(this,Ig)&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&$0(this.hot.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(i,"keyup",o=>{r.isInProgress()&&!o.shiftKey&&r.finish()}),this.eventManager.addEventListener(i,"mouseup",o=>{r.isInProgress()&&yv(o)&&r.finish(),ti(this,Lo,!1);const s=wv(n.activeElement);s&&(s||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(o.target)&&!_a(o))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",o=>{r.isInProgress()&&_a(o)&&(r.finish(),ti(this,Lo,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{r.isInProgress()&&r.finish(),ti(this,Lo,!1)}),this.eventManager.addEventListener(i,"mousedown",o=>{const s=o.target,a=o.x||o.clientX,l=o.y||o.clientY;let u=o.target;if(In(this,Lo)||!e||!this.hot.view)return;const{holder:c}=this.hot.view._wt.wtTable;if(u===c){const f=yn(n);if(n.elementFromPoint(a+f,l)!==c||n.elementFromPoint(a,l+f)!==c)return}else for(;u!==i;){if(u===null){if(o.isTargetWebComponent)break;return}if(u===e)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(In(this,Ti),"selectstart",o=>{this.settings.fragmentSelection||ew(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:In(this,Ti),isDataViewInstance:()=>ep(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),ti(this,xy,o.length),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),ti(this,My,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let h=l,f=u;Array.isArray(c)&&([h,f]=c);const g=this.hot.getCellMeta(h,f),p=this.hot.colToProp(f);let y=this.hot.getDataAtRowProp(h,p);this.hot.hasHook("beforeValueRender")&&(y=this.hot.runHooks("beforeValueRender",y,g)),this.hot.runHooks("beforeRenderer",a,l,u,p,y,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,p,y,g),this.hot.runHooks("afterRenderer",a,l,u,p,y,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Ta(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,ti(this,Lo,!0),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Zs(o)&&($O(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,ti(this,Lo,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Zs(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Zs(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Zs(o)&&(In(this,Lo)&&$O(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Zs(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,h=o>=0?l.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",h,c,a);if(Array.isArray(f)){const[g,p,y,E]=f;return[g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g,p>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(p,1)):p,y>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(y,-1)):y,E>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(E,-1)):E]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.ceil(u/a*12);o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.ceil(u/a*6);o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new qT(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(ew(e))return!0;const n=ma(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return In(this,Lo)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!De(r,"relative")){Ki(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){const o=n.firstChild;De(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,i):(Ki(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span");s.className="relative",a.className="colHeader",this.updateCellHeader(a,e,r,i),s.appendChild(a),n.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(De(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):De(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Ql(e,r(n,i)):(Ea(e,String.fromCharCode(160)),te(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){ti(this,Py,e),ti(this,Oy,n)}getLastSize(){return{width:In(this,Py),height:In(this,Oy)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return In(this,My)}getRowHeadersCount(){return In(this,xy)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}const Xte=Kte,SB="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Z0=SB.length;function Ev(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%Z0,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/Z0,10);return n}function qte(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=Z0**r*(SB.indexOf(t[n])+1);return e-=1,e}function Qte(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(Ev(i)+(r+1));n.push(o)}return n}function Zte(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=Ev(i)+(r+1);n.push(o)}return n}function Jte(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function ZT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function JT(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Be(t[0])&&(e=Cv(t[0]))),e}function bB(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function RB(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const ene=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:JT,createEmptySpreadsheetData:Jte,createSpreadsheetData:Qte,createSpreadsheetObjectData:Zte,dataRowToChangesArray:ZT,isArrayOfArrays:bB,isArrayOfObjects:RB,spreadsheetColumnIndex:qte,spreadsheetColumnLabel:Ev},Symbol.toStringTag,{value:"Module"}));function gh(t,e,n){return e=tne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tne(t){var e=nne(t,"string");return typeof e=="symbol"?e:String(e)}function nne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rne{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];gh(this,"hot",void 0),gh(this,"data",void 0),gh(this,"dataType","array"),gh(this,"colToProp",()=>{}),gh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return P(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0;let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,s)}):ye(n,r,l=>{a[l-n]=this.getAtPhysicalCell(e,l,s)});else if(Be(s)||St(s))if(i?a=[]:a={},!o||i){const u=this.countFirstRowKeys()-1;ye(0,u,c=>{const h=this.colToProp(c);if(c>=(n||0)&&c<=(r||u)&&!Number.isInteger(h)){const f=this.getAtPhysicalCell(e,h,s);i?a.push(f):qm(a,h,f)}})}else je(s,(l,u)=>{qm(a,u,this.getAtPhysicalCell(e,u,s))});return a}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Wl(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:qm(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r&&(typeof n=="string"?i=yV(r,n):typeof n=="function"?i=n(r):i=r[n]),this.hot.hasHook("modifySourceData")){const o=Wl(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return ye(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return JT(this.data)}destroy(){this.data=null,this.hot=null}}const ine=rne;function FO(t,e,n){return e=one(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function one(t){var e=sne(t,"string");return typeof e=="symbol"?e:String(e)}function sne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;FO(this,"indexedValues",[]),FO(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,St(this.initValueOrFn)?ye(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):ye(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}vt(Zl,Nr);function e1(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>St(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function t1(t,e){return Yr(t,(n,r)=>e.includes(r)===!1)}class Da extends Zl{insert(e,n){this.indexedValues=e1(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=t1(this.indexedValues,e),super.remove(e)}}class Tv extends Da{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return en(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function n1(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function rf(t,e){return Yr(t,n=>e.includes(n)===!1)}function r1(t,e){return Ge(t,n=>n-e.filter(r=>r<n).length)}function i1(t,e){const n=e[0],r=e.length;return Ge(t,i=>i>=n?i+r:i)}function ane(t,e,n){return e=lne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lne(t){var e=une(t,"string");return typeof e=="symbol"?e:String(e)}function une(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _v extends Zl{constructor(){super(...arguments),ane(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=rf(this.orderOfIndexes,[e]),St(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=e1(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=i1(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=t1(this.indexedValues,e),this.orderOfIndexes=rf(this.orderOfIndexes,e),this.orderOfIndexes=r1(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class $f extends Da{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return en(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const WO=new Map([["indexesSequence",{getListWithInsertedItems:n1,getListWithRemovedItems:rf}],["physicallyIndexed",{getListWithInsertedItems:e1,getListWithRemovedItems:t1}]]),EB=t=>{if(WO.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return WO.get(t)};class TB extends Zl{constructor(){super(e=>e)}insert(e,n){const r=i1(this.indexedValues,n);this.indexedValues=n1(r,e,n),super.insert(e,n)}remove(e){const n=rf(this.indexedValues,e);this.indexedValues=r1(n,e),super.remove(e)}}const VO=new Map([["hiding",Tv],["index",Zl],["linkedPhysicalIndexToValue",_v],["physicalIndexToValue",Da],["trimming",$f]]);function cne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!VO.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(VO.get(t))(e)}function hne(t,e,n){return e=dne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dne(t){var e=fne(t,"string");return typeof e=="symbol"?e:String(e)}function fne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let J0=0;class o1{constructor(){hne(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),J0+=1)}unregister(e){const n=this.collection.get(e);he(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),J0-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return bt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}vt(o1,Nr);function gne(){return J0}function Ay(t,e,n){return e=mne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mne(t){var e=pne(t,"string");return typeof e=="symbol"?e:String(e)}function pne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BO extends o1{constructor(e,n){super(),Ay(this,"mergedValuesCache",[]),Ay(this,"aggregationFunction",void 0),Ay(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ge(this.get(),o=>o.getValues()),r=[],i=he(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ge(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return he(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function wne(t,e,n){vne(t,e),e.set(t,n)}function vne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cne(t,e,n){var r=_B(t,e,"set");return yne(t,r,n),n}function yne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Sne(t,e){var n=_B(t,e,"get");return bne(t,n)}function _B(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function bne(t,e){return e.get?e.get.call(t):e.value}var Iy=new WeakMap;class MB{constructor(){wne(this,Iy,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(Sne(this,Iy)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Cne(this,Iy,e)}}vt(MB,Nr);function UO(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function mh(t,e,n){Rne(t,e),e.set(t,n)}function Rne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ni(t,e){var n=xB(t,e,"get");return Ene(t,n)}function Ene(t,e){return e.get?e.get.call(t):e.value}function Hg(t,e,n){var r=xB(t,e,"set");return Tne(t,r,n),n}function xB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Tne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Dg=new WeakMap,ph=new WeakMap,Ng=new WeakMap,kg=new WeakMap,Lg=new WeakMap;class _ne{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};mh(this,Dg,{writable:!0,value:new Set}),mh(this,ph,{writable:!0,value:[]}),mh(this,Ng,{writable:!0,value:[]}),mh(this,kg,{writable:!0,value:!1}),mh(this,Lg,{writable:!0,value:!1}),Hg(this,Lg,e??!1)}createObserver(){const e=new MB;return ni(this,Dg).add(e),e.addLocalHook("unsubscribe",()=>{ni(this,Dg).delete(e)}),e._writeInitialChanges(UO(ni(this,ph),ni(this,Ng))),e}emit(e){let n=ni(this,Ng);(!ni(this,kg)||ni(this,ph).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(ni(this,Lg)):Hg(this,ph,new Array(e.length).fill(ni(this,Lg))),ni(this,kg)||(Hg(this,kg,!0),n=ni(this,ph)));const r=UO(n,e);ni(this,Dg).forEach(i=>i._write(r)),Hg(this,Ng,e)}}function ir(t,e,n){return e=Mne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mne(t){var e=xne(t,"string");return typeof e=="symbol"?e:String(e)}function xne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eR{constructor(){ir(this,"indexesSequence",new TB),ir(this,"trimmingMapsCollection",new BO(e=>e.some(n=>n===!0),!1)),ir(this,"hidingMapsCollection",new BO(e=>e.some(n=>n===!0),!1)),ir(this,"variousMapsCollection",new o1),ir(this,"hidingChangesObservable",new _ne({initialIndexValue:!1})),ir(this,"notTrimmedIndexesCache",[]),ir(this,"notHiddenIndexesCache",[]),ir(this,"isBatched",!1),ir(this,"indexesSequenceChanged",!1),ir(this,"indexesChangeSource",void 0),ir(this,"trimmedIndexesChanged",!1),ir(this,"hiddenIndexesChanged",!1),ir(this,"renderablePhysicalIndexesCache",[]),ir(this,"fromPhysicalToVisualIndexesCache",new Map),ir(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,cne(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof $f?this.trimmingMapsCollection.register(e,n):n instanceof Tv?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return he(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return he(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return he(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return he(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ge(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=rf(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(n1(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=he(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ge(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}vt(eR,Nr);function Pne(t,e){return je(e,(n,r)=>{bt(t[r])&&(t[r]=n)}),t}function PB(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function OB(t){he(t)&&_T(mt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function One(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:Ane,getValues:Ine}=qi("phraseFormatters");function Hne(t,e){Ane(t,e)}function Dne(){return Ine()}Hne("pluralize",One);const AB="ContextMenu:items",We=AB,s1=`${We}.noItems`,a1=`${We}.insertRowAbove`,l1=`${We}.insertRowBelow`,u1=`${We}.insertColumnOnTheLeft`,c1=`${We}.insertColumnOnTheRight`,h1=`${We}.removeRow`,d1=`${We}.removeColumn`,f1=`${We}.undo`,g1=`${We}.redo`,m1=`${We}.readOnly`,p1=`${We}.clearColumn`,w1=`${We}.copy`,v1=`${We}.copyWithHeaders`,C1=`${We}.copyWithGroupHeaders`,y1=`${We}.copyHeadersOnly`,S1=`${We}.cut`,b1=`${We}.freezeColumn`,R1=`${We}.unfreezeColumn`,E1=`${We}.mergeCells`,T1=`${We}.unmergeCells`,_1=`${We}.addComment`,M1=`${We}.editComment`,x1=`${We}.removeComment`,P1=`${We}.readOnlyComment`,O1=`${We}.align`,A1=`${We}.align.left`,I1=`${We}.align.center`,H1=`${We}.align.right`,D1=`${We}.align.justify`,N1=`${We}.align.top`,k1=`${We}.align.middle`,L1=`${We}.align.bottom`,$1=`${We}.borders`,F1=`${We}.borders.top`,W1=`${We}.borders.right`,V1=`${We}.borders.bottom`,B1=`${We}.borders.left`,U1=`${We}.borders.remove`,z1=`${We}.nestedHeaders.insertChildRow`,G1=`${We}.nestedHeaders.detachFromParent`,j1=`${We}.hideColumn`,Y1=`${We}.showColumn`,K1=`${We}.hideRow`,X1=`${We}.showRow`,Cr="Filters:",qt=`${Cr}conditions`,Mv=`${qt}.none`,q1=`${qt}.isEmpty`,Q1=`${qt}.isNotEmpty`,Z1=`${qt}.isEqualTo`,J1=`${qt}.isNotEqualTo`,e_=`${qt}.beginsWith`,t_=`${qt}.endsWith`,n_=`${qt}.contains`,r_=`${qt}.doesNotContain`,Nne=`${qt}.byValue`,i_=`${qt}.greaterThan`,o_=`${qt}.greaterThanOrEqualTo`,s_=`${qt}.lessThan`,a_=`${qt}.lessThanOrEqualTo`,l_=`${qt}.isBetween`,u_=`${qt}.isNotBetween`,c_=`${qt}.after`,h_=`${qt}.before`,d_=`${qt}.today`,f_=`${qt}.tomorrow`,g_=`${qt}.yesterday`,m_=`${Cr}labels.filterByCondition`,p_=`${Cr}labels.filterByValue`,w_=`${Cr}labels.conjunction`,xv=`${Cr}labels.disjunction`,uw=`${Cr}values.blankCells`,v_=`${Cr}buttons.selectAll`,C_=`${Cr}buttons.clear`,y_=`${Cr}buttons.ok`,S_=`${Cr}buttons.cancel`,b_=`${Cr}buttons.placeholder.search`,R_=`${Cr}buttons.placeholder.value`,E_=`${Cr}buttons.placeholder.secondValue`,T_="CheckboxRenderer:",__=`${T_}checked`,M_=`${T_}unchecked`,Na="ColumnHeader:",x_=`${Na}description.expandColumn`,P_=`${Na}description.collapseColumn`,O_=`${Na}description.sortRows`,A_=`${Na}label.multiColumnSortOrder`,I_=`${Na}label.openMenu`,H_=`${Na}label.beforeHiddenColumn`,D_=`${Na}label.afterHiddenColumn`,Ff="RowHeader:",N_=`${Ff}description.expandRow`,k_=`${Ff}description.collapseRow`,L_=`${Ff}label.beforeHiddenRow`,$_=`${Ff}label.afterHiddenRow`,kne=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:__,CHECKBOX_RENDERER_NAMESPACE:T_,CHECKBOX_UNCHECKED:M_,COLUMN_HEADER_DESCRIPTION_COLLAPSE_COLUMN:P_,COLUMN_HEADER_DESCRIPTION_EXPAND_COLUMN:x_,COLUMN_HEADER_DESCRIPTION_SORT_ROWS:O_,COLUMN_HEADER_LABEL_AFTER_HIDDEN_COLUMN:D_,COLUMN_HEADER_LABEL_BEFORE_HIDDEN_COLUMN:H_,COLUMN_HEADER_LABEL_MULTI_COLUMN_SORT_ORDER:A_,COLUMN_HEADER_LABEL_OPEN_MENU:I_,COLUMN_HEADER_NAMESPACE:Na,CONTEXTMENU_ITEMS_ADD_COMMENT:_1,CONTEXTMENU_ITEMS_ALIGNMENT:O1,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:L1,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:I1,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:D1,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:A1,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:k1,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:H1,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:N1,CONTEXTMENU_ITEMS_BORDERS:$1,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:V1,CONTEXTMENU_ITEMS_BORDERS_LEFT:B1,CONTEXTMENU_ITEMS_BORDERS_RIGHT:W1,CONTEXTMENU_ITEMS_BORDERS_TOP:F1,CONTEXTMENU_ITEMS_CLEAR_COLUMN:p1,CONTEXTMENU_ITEMS_COPY:w1,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:y1,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:C1,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:v1,CONTEXTMENU_ITEMS_CUT:S1,CONTEXTMENU_ITEMS_EDIT_COMMENT:M1,CONTEXTMENU_ITEMS_FREEZE_COLUMN:b1,CONTEXTMENU_ITEMS_HIDE_COLUMN:j1,CONTEXTMENU_ITEMS_HIDE_ROW:K1,CONTEXTMENU_ITEMS_INSERT_LEFT:u1,CONTEXTMENU_ITEMS_INSERT_RIGHT:c1,CONTEXTMENU_ITEMS_MERGE_CELLS:E1,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:G1,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:z1,CONTEXTMENU_ITEMS_NO_ITEMS:s1,CONTEXTMENU_ITEMS_READ_ONLY:m1,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:P1,CONTEXTMENU_ITEMS_REDO:g1,CONTEXTMENU_ITEMS_REMOVE_BORDERS:U1,CONTEXTMENU_ITEMS_REMOVE_COLUMN:d1,CONTEXTMENU_ITEMS_REMOVE_COMMENT:x1,CONTEXTMENU_ITEMS_REMOVE_ROW:h1,CONTEXTMENU_ITEMS_ROW_ABOVE:a1,CONTEXTMENU_ITEMS_ROW_BELOW:l1,CONTEXTMENU_ITEMS_SHOW_COLUMN:Y1,CONTEXTMENU_ITEMS_SHOW_ROW:X1,CONTEXTMENU_ITEMS_UNDO:f1,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:R1,CONTEXTMENU_ITEMS_UNMERGE_CELLS:T1,CONTEXT_MENU_ITEMS_NAMESPACE:AB,FILTERS_BUTTONS_CANCEL:S_,FILTERS_BUTTONS_CLEAR:C_,FILTERS_BUTTONS_OK:y_,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:b_,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:E_,FILTERS_BUTTONS_PLACEHOLDER_VALUE:R_,FILTERS_BUTTONS_SELECT_ALL:v_,FILTERS_CONDITIONS_AFTER:c_,FILTERS_CONDITIONS_BEFORE:h_,FILTERS_CONDITIONS_BEGINS_WITH:e_,FILTERS_CONDITIONS_BETWEEN:l_,FILTERS_CONDITIONS_BY_VALUE:Nne,FILTERS_CONDITIONS_CONTAINS:n_,FILTERS_CONDITIONS_EMPTY:q1,FILTERS_CONDITIONS_ENDS_WITH:t_,FILTERS_CONDITIONS_EQUAL:Z1,FILTERS_CONDITIONS_GREATER_THAN:i_,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:o_,FILTERS_CONDITIONS_LESS_THAN:s_,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:a_,FILTERS_CONDITIONS_NAMESPACE:qt,FILTERS_CONDITIONS_NONE:Mv,FILTERS_CONDITIONS_NOT_BETWEEN:u_,FILTERS_CONDITIONS_NOT_CONTAIN:r_,FILTERS_CONDITIONS_NOT_EMPTY:Q1,FILTERS_CONDITIONS_NOT_EQUAL:J1,FILTERS_CONDITIONS_TODAY:d_,FILTERS_CONDITIONS_TOMORROW:f_,FILTERS_CONDITIONS_YESTERDAY:g_,FILTERS_DIVS_FILTER_BY_CONDITION:m_,FILTERS_DIVS_FILTER_BY_VALUE:p_,FILTERS_LABELS_CONJUNCTION:w_,FILTERS_LABELS_DISJUNCTION:xv,FILTERS_NAMESPACE:Cr,FILTERS_VALUES_BLANK_CELLS:uw,ROW_HEADER_DESCRIPTION_COLLAPSE_ROW:k_,ROW_HEADER_DESCRIPTION_EXPAND_ROW:N_,ROW_HEADER_LABEL_AFTER_HIDDEN_ROW:$_,ROW_HEADER_LABEL_BEFORE_HIDDEN_ROW:L_,ROW_HEADER_NAMESPACE:Ff},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const Lne={languageCode:"en-US",[s1]:"No available options",[a1]:"Insert row above",[l1]:"Insert row below",[u1]:"Insert column left",[c1]:"Insert column right",[h1]:["Remove row","Remove rows"],[d1]:["Remove column","Remove columns"],[f1]:"Undo",[g1]:"Redo",[m1]:"Read only",[p1]:"Clear column",[O1]:"Alignment",[A1]:"Left",[I1]:"Center",[H1]:"Right",[D1]:"Justify",[N1]:"Top",[k1]:"Middle",[L1]:"Bottom",[b1]:"Freeze column",[R1]:"Unfreeze column",[$1]:"Borders",[F1]:"Top",[W1]:"Right",[V1]:"Bottom",[B1]:"Left",[U1]:"Remove border(s)",[_1]:"Add comment",[M1]:"Edit comment",[x1]:"Delete comment",[P1]:"Read-only comment",[E1]:"Merge cells",[T1]:"Unmerge cells",[w1]:"Copy",[v1]:["Copy with header","Copy with headers"],[C1]:["Copy with group header","Copy with group headers"],[y1]:["Copy header only","Copy headers only"],[S1]:"Cut",[z1]:"Insert child row",[G1]:"Detach from parent",[j1]:["Hide column","Hide columns"],[Y1]:["Show column","Show columns"],[K1]:["Hide row","Hide rows"],[X1]:["Show row","Show rows"],[Mv]:"None",[q1]:"Is empty",[Q1]:"Is not empty",[Z1]:"Is equal to",[J1]:"Is not equal to",[e_]:"Begins with",[t_]:"Ends with",[n_]:"Contains",[r_]:"Does not contain",[i_]:"Greater than",[o_]:"Greater than or equal to",[s_]:"Less than",[a_]:"Less than or equal to",[l_]:"Is between",[u_]:"Is not between",[c_]:"After",[h_]:"Before",[d_]:"Today",[f_]:"Tomorrow",[g_]:"Yesterday",[uw]:"Blank cells",[m_]:"Filter by condition",[p_]:"Filter by value",[w_]:"And",[xv]:"Or",[v_]:"Select all",[C_]:"Clear",[y_]:"OK",[S_]:"Cancel",[b_]:"Search",[R_]:"Value",[E_]:"Second value",[__]:"Checked",[M_]:"Unchecked",[x_]:"Press ENTER to expand column.",[P_]:"Press ENTER to collapse column.",[O_]:"Press ENTER to change sorting.",[A_]:"Multi-column sorting order:",[I_]:"Press CTRL/CMD+ENTER to open menu.",[H_]:"The next column is hidden.",[D_]:"The previous column is hidden.",[N_]:"Press ENTER to expand row.",[k_]:"Press ENTER to collapse row.",[L_]:"The next row is hidden.",[$_]:"The previous row is hidden."},IB=Lne,$ne=kne,tR=IB.languageCode,{register:Fne,getItem:HB,hasItem:Wne,getValues:Vne}=qi("languagesDictionaries");DB(IB);function DB(t,e){let n=t,r=e;return Be(t)&&(r=t,n=r.languageCode),Bne(n,r),Fne(n,Zn(r)),Zn(r)}function Bne(t,e){t!==tR&&Pne(e,HB(tR))}function NB(t){return F_(t)?Zn(HB(t)):null}function F_(t){return Wne(t)}function Une(){return Vne()}function kB(t,e,n){const r=NB(t);if(r===null)return null;const i=r[e];if(bt(i))return null;const o=zne(i,n);return Array.isArray(o)?o[0]:o}function zne(t,e){let n=t;return P(Dne(),r=>{n=r(t,e)}),n}function Gne(t){let e=PB(t);return F_(e)||(e=tR,OB(t)),e}function jne(t,e,n){return e=Yne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yne(t){var e=Kne(t,"string");return typeof e=="symbol"?e:String(e)}function Kne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xne extends ete{constructor(e,n){super(e,null),jne(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}const Ps=Xne;function Hy(t){let{activeHeaderClassName:e,...n}=t;return new Ps({className:e,...n,selectionType:dB})}function qne(t){let{areaCornerVisible:e,...n}=t;return new Ps({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:zT})}function Qne(t){let{...e}=t;return new Ps({className:"highlight",...e,selectionType:zT})}function Zne(t){let{columnClassName:e,...n}=t;return new Ps({className:e,...n,selectionType:rte})}function Jne(t){let{cellCornerVisible:e,...n}=t;return new Ps({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:GT})}function ere(t){let{border:e,visualCellRange:n,...r}=t;return new Ps({...e,...r,selectionType:ite},n)}function tre(t){let{...e}=t;return new Ps({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:tte})}function zO(t){let{headerClassName:e,...n}=t;return new Ps({className:e,...n,selectionType:UT})}function nre(t){let{rowClassName:e,...n}=t;return new Ps({className:e,...n,selectionType:nte})}let LB;function rre(t,e){ire(t,e),e.add(t)}function ire(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sr(t,e,n){return e=ore(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ore(t){var e=sre(t,"string");return typeof e=="symbol"?e:String(e)}function sre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $o(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var ro=new WeakSet;LB=Symbol.iterator;class are{constructor(e){rre(this,ro),Sr(this,"options",void 0),Sr(this,"layerLevel",0),Sr(this,"focus",void 0),Sr(this,"fill",void 0),Sr(this,"layeredAreas",new Map),Sr(this,"areas",new Map),Sr(this,"rowHeaders",new Map),Sr(this,"columnHeaders",new Map),Sr(this,"activeRowHeaders",new Map),Sr(this,"activeColumnHeaders",new Map),Sr(this,"activeCornerHeaders",new Map),Sr(this,"rowHighlights",new Map),Sr(this,"columnHighlights",new Map),Sr(this,"customSelections",[]),this.options=e,this.focus=Jne(e),this.fill=tre(e)}isEnabledFor(e,n){let r=e;e===GT&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return $o(this,ro,Fo).call(this,this.layeredAreas,qne)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return $o(this,ro,Fo).call(this,this.areas,Qne)}getAreas(){return[...this.areas.values()]}createRowHeader(){return $o(this,ro,Fo).call(this,this.rowHeaders,zO)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return $o(this,ro,Fo).call(this,this.columnHeaders,zO)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return $o(this,ro,Fo).call(this,this.activeRowHeaders,Hy)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return $o(this,ro,Fo).call(this,this.activeColumnHeaders,Hy)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return $o(this,ro,Fo).call(this,this.activeCornerHeaders,Hy)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return $o(this,ro,Fo).call(this,this.rowHighlights,nre)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return $o(this,ro,Fo).call(this,this.columnHighlights,Zne)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(ere({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),P(this.areas.values(),e=>void e.clear()),P(this.layeredAreas.values(),e=>void e.clear()),P(this.rowHeaders.values(),e=>void e.clear()),P(this.columnHeaders.values(),e=>void e.clear()),P(this.activeRowHeaders.values(),e=>void e.clear()),P(this.activeColumnHeaders.values(),e=>void e.clear()),P(this.activeCornerHeaders.values(),e=>void e.clear()),P(this.rowHighlights.values(),e=>void e.clear()),P(this.columnHighlights.values(),e=>void e.clear())}[LB](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Fo(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}const lre=are;let $B;function GO(t,e,n){return e=ure(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ure(t){var e=cre(t,"string");return typeof e=="symbol"?e:String(e)}function cre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}$B=Symbol.iterator;class hre{constructor(e){GO(this,"ranges",[]),GO(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[$B](){return this.ranges[Symbol.iterator]()}}const dre=hre;function wh(t,e){FB(t,e),e.add(t)}function Dy(t,e,n){FB(t,e),e.set(t,n)}function FB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function et(t,e){var n=WB(t,e,"get");return fre(t,n)}function fre(t,e){return e.get?e.get.call(t):e.value}function Er(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function nR(t,e,n){var r=WB(t,e,"set");return gre(t,r,n),n}function WB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var $g=new WeakMap,lt=new WeakMap,Ma=new WeakMap,Ny=new WeakSet,ky=new WeakSet,rR=new WeakSet,Ly=new WeakSet,Ua=new WeakSet;class VB{constructor(e,n){wh(this,Ua),wh(this,Ly),wh(this,rR),wh(this,ky),wh(this,Ny),Dy(this,$g,{writable:!0,value:void 0}),Dy(this,lt,{writable:!0,value:void 0}),Dy(this,Ma,{writable:!0,value:{x:0,y:0}}),nR(this,$g,e),nR(this,lt,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Er(this,Ny,jO).call(this,{x:et(this,lt).navigableHeaders()?et(this,lt).countRowHeaders():0,y:et(this,lt).navigableHeaders()?et(this,lt).countColHeaders():0});const i=et(this,lt).createCellCoords(e,n);let o=et(this,$g).current().highlight;const s=et(this,lt).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=Er(this,rR,BB).call(this),{row:h,col:f}=Er(this,Ly,KO).call(this,o),g=et(this,lt).fixedRowsBottom(),p=et(this,lt).minSpareRows(),y=et(this,lt).minSpareCols(),E=et(this,lt).autoWrapRow(),v=et(this,lt).autoWrapCol(),C=et(this,lt).createCellCoords(h+i.row,f+i.col);if(C.row>=c){const _=r&&p>0&&g===0,H=!_&&v,D=C.col+1,B=et(this,lt).createCellCoords(C.row-c,D>=u?D-u:D);this.runLocalHooks("beforeColumnWrap",H,Er(this,Ua,du).call(this,B),D>=u),_?this.runLocalHooks("insertRowRequire",et(this,lt).countRenderableRows()):H&&C.assign(B)}else if(C.row<0){const _=C.col-1,H=et(this,lt).createCellCoords(c+C.row,_<0?u+_:_);this.runLocalHooks("beforeColumnWrap",v,Er(this,Ua,du).call(this,H),_<0),v&&C.assign(H)}if(C.col>=u){const _=r&&y>0,H=!_&&E,D=C.row+1,B=et(this,lt).createCellCoords(D>=c?D-c:D,C.col-u);this.runLocalHooks("beforeRowWrap",H,Er(this,Ua,du).call(this,B),D>=c),_?this.runLocalHooks("insertColRequire",et(this,lt).countRenderableColumns()):H&&C.assign(B)}else if(C.col<0){const _=C.row-1,H=et(this,lt).createCellCoords(_<0?c+_:_,u+C.col);this.runLocalHooks("beforeRowWrap",E,Er(this,Ua,du).call(this,H),_<0),E&&C.assign(H)}const{rowDir:S,colDir:T}=Er(this,ky,YO).call(this,C);a=S,l=T,o=Er(this,Ua,du).call(this,C)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){Er(this,Ny,jO).call(this,{x:et(this,lt).navigableHeaders()?et(this,lt).countRowHeaders():0,y:et(this,lt).navigableHeaders()?et(this,lt).countColHeaders():0});const r=et(this,lt).createCellCoords(e,n),i=et(this,$g).current(),o=et(this,lt).visualToRenderableCoords(i.highlight),s=i.to.clone();let a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null){const{row:u,col:c}=Er(this,Ly,KO).call(this,i.to),h=et(this,lt).createCellCoords(u+r.row,c+r.col),{rowDir:f,colDir:g}=Er(this,ky,YO).call(this,h);a=f,l=g;const p=Er(this,Ua,du).call(this,h);r.row===0&&r.col!==0?s.col=p.col:r.row!==0&&r.col===0?s.row=p.row:(s.row=p.row,s.col=p.col)}return this.runLocalHooks("afterTransformEnd",s,a,l),s}}function jO(t){let{x:e,y:n}=t;nR(this,Ma,{x:e,y:n})}function YO(t){const{width:e,height:n}=Er(this,rR,BB).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function BB(){return{width:et(this,Ma).x+et(this,lt).countRenderableColumns(),height:et(this,Ma).y+et(this,lt).countRenderableRows()}}function KO(t){const{row:e,col:n}=et(this,lt).visualToRenderableCoords(t);return et(this,lt).createCellCoords(et(this,Ma).y+e,et(this,Ma).x+n)}function du(t){const e=t.clone();return e.col=t.col-et(this,Ma).x,e.row=t.row-et(this,Ma).y,et(this,lt).renderableToVisualCoords(e)}vt(VB,Nr);const mre=VB,Pv=0,Ov=1,UB=2,W_=3,pre=[W_,UB],wre=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],$y=Symbol("root"),XO=Symbol("child");function Oc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$y;if(e!==$y&&e!==XO)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===$y;let i=Pv;if(n){const o=t[0];t.length===0?i=Ov:r&&o instanceof NT?i=W_:r&&Array.isArray(o)?i=Oc(o,XO):t.length>=2&&t.length<=4&&!t.some((a,l)=>!wre[l].includes(typeof a))&&(i=UB)}return i}function of(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!pre.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===W_;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),bt(u)&&(u=a),bt(c)&&(c=l),!r){const g=a,p=l,y=u,E=c;a=Math.min(g,y),l=Math.min(p,E),u=Math.max(g,y),c=Math.max(p,E)}const h=e(a,l),f=e(u,c);return n(h,h,f)}}function vre(t){const e=Oc(t.getSelected());if(e===Pv||e===Ov)return[];const n=of(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;P(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;P(Array.from(new Array(c),(h,f)=>u+f),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return en(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Cre(t){const e=Oc(t.getSelected());if(e===Pv||e===Ov)return[];const n=of(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;P(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;P(Array.from(new Array(c),(h,f)=>u+f),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return en(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function yre(t,e,n){Sre(t,e),e.set(t,n)}function Sre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ns(t,e,n){return e=bre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bre(t){var e=Rre(t,"string");return typeof e=="symbol"?e:String(e)}function Rre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qO(t,e,n){var r=zB(t,e,"set");return Ere(t,r,n),n}function Ere(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function QO(t,e){var n=zB(t,e,"get");return Tre(t,n)}function zB(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Tre(t,e){return e.get?e.get.call(t):e.value}var vh=new WeakMap;class GB{constructor(e,n){var r=this;Ns(this,"settings",void 0),Ns(this,"tableProps",void 0),Ns(this,"inProgress",!1),Ns(this,"selectedRange",new dre((i,o,s)=>this.tableProps.createCellRange(i,o,s))),Ns(this,"highlight",void 0),Ns(this,"transformation",void 0),Ns(this,"selectedByRowHeader",new Set),Ns(this,"selectedByColumnHeader",new Set),yre(this,vh,{writable:!0,value:!1}),this.settings=e,this.tableProps=n,this.highlight=new lre({headerClassName:e.currentHeaderClassName,headerAttributes:[L0()],activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[L0()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),this.transformation=new mre(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=bt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&bt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(n),r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(GT,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(P(this.highlight.getAreas(),C=>void C.clear()),P(this.highlight.getLayeredAreas(),C=>void C.clear()),P(this.highlight.getRowHeaders(),C=>void C.clear()),P(this.highlight.getColumnHeaders(),C=>void C.clear()),P(this.highlight.getActiveRowHeaders(),C=>void C.clear()),P(this.highlight.getActiveColumnHeaders(),C=>void C.clear()),P(this.highlight.getActiveCornerHeaders(),C=>void C.clear()),P(this.highlight.getRowHighlights(),C=>void C.clear()),P(this.highlight.getColumnHighlights(),C=>void C.clear())),this.highlight.useLayerLevel(l);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),h=this.highlight.createRowHeader(),f=this.highlight.createColumnHeader(),g=this.highlight.createActiveRowHeader(),p=this.highlight.createActiveColumnHeader(),y=this.highlight.createActiveCornerHeader(),E=this.highlight.createRowHighlight(),v=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),h.clear(),f.clear(),g.clear(),p.clear(),y.clear(),E.clear(),v.clear(),this.highlight.isEnabledFor(zT,s.highlight)&&(this.isMultiple()||l>=1)&&(u.add(s.from).add(s.to).commit(),c.add(s.from).add(s.to).commit(),l===1)){const C=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(C.from).commit().syncWith(C),this.highlight.createLayeredArea().add(C.from).commit().syncWith(C),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(UT,s.highlight)){if(!s.isSingleHeader()){const T=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),_=this.tableProps.createCellCoords(s.to.row,-1),H=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),D=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(h.add(T).commit(),f.add(H).commit(),E.add(T).commit(),v.add(H).commit()):(h.add(T).add(_).commit(),f.add(H).add(D).commit(),E.add(T).add(_).commit(),v.add(H).add(D).commit())}const C=!QO(this,vh)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||i===0&&this.isSelectedByRowHeader()),S=!QO(this,vh)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||r===0&&this.isSelectedByColumnHeader());C&&g.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),S&&p.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),C&&S&&y.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=Wl(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,r))}transformEnd(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:f,disableHeadersHighlight:g}=i;qO(this,vh,g),f&&Number.isInteger(f==null?void 0:f.row)&&Number.isInteger(f==null?void 0:f.col)&&(h=this.tableProps.createCellCoords(Or(f.row,u,o-1),Or(f.col,c,s-1)));const p=this.tableProps.createCellCoords(u,c),y=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(p,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.finish(),qO(this,vh,!1)}selectCells(e){var n=this;const r=Oc(e);if(r===Ov)return!1;if(r===Pv)throw new Error(mt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=of(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),P(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone()),this.finish()})),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),f=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(f){const g=l===0?0:Or(r,u,-1),p=s-1,y=this.tableProps.createCellCoords(g,i),E=this.tableProps.createCellCoords(p,o),v=this.tableProps.createCellCoords(Or(r,u,s-1),i);this.runLocalHooks("beforeSelectColumns",y,E,v),y.row=g,E.row=p,this.setRangeStartOnly(y,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectColumns",y,E,v),this.finish()}return f}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){const h=s===0?0:Or(r,a,-1),f=o-1,g=this.tableProps.createCellCoords(e,h),p=this.tableProps.createCellCoords(n,f),y=this.tableProps.createCellCoords(e,Or(r,a,o-1));this.runLocalHooks("beforeSelectRows",g,p,y),g.col=h,p.col=f,this.setRangeStartOnly(g,void 0,y),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.runLocalHooks("afterSelectRows",g,p,y),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),f.commit(),g.commit()}this.highlight.useLayerLevel(r)}}vt(GB,Nr);const _re=GB,ZO=/^(\r\n|\n\r|\r|\n)/,Mre=/^[^\t\r\n]+/,JO=/^\t/;function xre(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(JO))t=t.replace(JO,""),n+=1,e[r][n]="";else if(t.match(ZO))t=t.replace(ZO,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(Mre);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function vd(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function za(t,e,n){return e=Pre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pre(t){var e=Ore(t,"string");return typeof e=="symbol"?e:String(e)}function Ore(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){za(this,"hot",void 0),za(this,"metaManager",void 0),za(this,"tableMeta",void 0),za(this,"dataSource",void 0),za(this,"duckSchema",void 0),za(this,"colToPropCache",void 0),za(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=Cv(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Be(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return JT(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&je(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&he(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(he(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Pc(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,f=[];for(;a<n&&o+a<c;){let p=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?p=Zn(this.getSchema()):(p=[],ye(h-1,()=>p.push(null))):this.hot.dataType==="function"?p=this.tableMeta.dataSchema(l+a):(p={},Df(p,this.getSchema())),f.push(p),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,f);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===f.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",g,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let f=this.hot.countCols(),g=0,p=c;i==="end"&&(p=Math.min(p+1,a));const y=p;for(;g<n&&f<s;){if(typeof l!="number"||l>=f)if(h>0)for(let v=0;v<h;v+=1)typeof o[v]>"u"&&(o[v]=[]),o[v].push(null);else o.push([null]);else for(let v=0;v<h;v++)o[v].splice(p,0,null);g+=1,p+=1,f+=1}this.hot.columnIndexMapper.insertIndexes(l,g),g>0&&(e==null?this.metaManager.createColumn(null,g):r!=="auto"&&this.metaManager.createColumn(y,n));const E=this.hot.toVisualColumn(y);return this.hot.runHooks("afterCreateCol",E,g,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:y}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=he(this.tableMeta.columns)||he(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,f)=>f-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,f=this.hot.countSourceRows();h<f;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,f=this.hot.countSourceRows();h<f;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];I0(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return jW(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];I0(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;let s=null;if(i&&i.hasOwnProperty&&Ft(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){const a=n.split(".");let l=i;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;s=l}else typeof n=="function"&&(s=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const a=Wl(s);this.hot.runHooks("modifyData",r,this.propToCol(n),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const l=Wl(o);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"set"),l.isTouched()&&(o=l.value)}if(s&&s.hasOwnProperty&&Ft(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){const l=n.split(".");let u=s,c=0,h;for(c=0,h=l.length-1;c<h;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=o}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,lc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===lc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),f=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=f&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,n){return vd(this.getRange(e,n,lc.DESTINATION_RENDERER))}getCopyableText(e,n){return vd(this.getRange(e,n,lc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const Are=lc,{register:Ire,getItem:Hre,hasItem:jB,getNames:Dre,getValues:Wbe}=qi("cellTypes");function V_(t){if(!jB(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Hre(t)}function ri(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&_r(t,n),r&&mo(t,r),i&&ac(t,i),Ire(t,e)}function Nre(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Ft(e,t)}function Av(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?V_(e.type):e.type;if(t._automaticallyAssignedMetaProps&&je(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Be(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};je(r,(o,s)=>{if(Nre(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),sn(t,i)}function kre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}Ms(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function tp(t){return Number.isInteger(t)&&t>=0}function np(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Fg(t){return t==null}const YB=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),gn(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),gn(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),vv(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,disableTabNavigation:!1,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function eA(t,e,n){return e=Lre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lre(t){var e=$re(t,"string");return typeof e=="symbol"?e:String(e)}function $re(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fre(){return class{}}class Wre{constructor(e){eA(this,"metaCtor",Fre()),eA(this,"meta",void 0),this.meta=this.metaCtor.prototype,sn(this.meta,YB()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;sn(this.meta,e),Av(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function Vre(t,e,n){return e=Bre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bre(t){var e=Ure(t,"string");return typeof e=="symbol"?e:String(e)}function Ure(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zre{constructor(e){Vre(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){sn(this.meta,e),Av(this.meta,e,e)}}let KB;function Wg(t,e,n){return e=Gre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gre(t){var e=jre(t,"string");return typeof e=="symbol"?e:String(e)}function jre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}KB=Symbol.iterator;class cw{constructor(e){Wg(this,"valueFactory",void 0),Wg(this,"data",[]),Wg(this,"index",[]),Wg(this,"holes",new Set),this.valueFactory=e}obtain(e){np(()=>tp(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;np(()=>tp(e)||Fg(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=Fg(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;np(()=>tp(e)||Fg(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Fg(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return Yr(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[KB](){return this.entries()}}function tA(t,e,n){return e=Yre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yre(t){var e=Kre(t,"string");return typeof e=="symbol"?e:String(e)}function Kre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Xre=["data","width"];class qre{constructor(e){tA(this,"globalMeta",void 0),tA(this,"metas",new cw(()=>this._createMeta())),this.globalMeta=e,this.metas=new cw(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);sn(r,n),Av(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return kre(this.globalMeta.getMetaConstructor(),Xre).prototype}}function nA(t,e,n){return e=Qre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qre(t){var e=Zre(t,"string");return typeof e=="symbol"?e:String(e)}function Zre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jre{constructor(e){nA(this,"columnMeta",void 0),nA(this,"metas",new cw(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);sn(i,r),Av(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)e.push(...n[r].values());return e}getMetasAtRow(e){np(()=>tp(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new cw(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class XB{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Wre(e),this.tableMeta=new zre(this.globalMeta),this.columnMeta=new qre(this.globalMeta),this.cellMeta=new Jre(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:o}=r;const s=this.cellMeta.getMeta(e,n);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}vt(XB,Nr);function rA(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=Qn(a),f=i.getSettings();Array.isArray(f.dataSchema)?i.dataType="array":St(f.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new Are(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const p=g.getSchema();t=[];let y,E=0,v=0;for(E=0,v=f.startRows;E<v;E++)if((i.dataType==="object"||i.dataType==="function")&&f.dataSchema)y=Zn(p),t.push(y);else if(i.dataType==="array")y=Zn(p[0]),t.push(y);else{y=[];for(let C=0,S=f.startCols;C<S;C++)y.push(null);t.push(y)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),f.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),n(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Re(i.rootElement,[JW(i.countRows()),eV(i.countCols())])}function iA(t,e,n){return e=eie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eie(t){var e=tie(t,"string");return typeof e=="symbol"?e:String(e)}function tie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nie{constructor(e){iA(this,"metaManager",void 0),iA(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),me.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Ft(e,"type")?e.type:null;let c=St(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function Fy(t,e,n){return e=rie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rie(t){var e=iie(t,"string");return typeof e=="symbol"?e:String(e)}function iie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oie{constructor(e){Fy(this,"metaManager",void 0),Fy(this,"usageTracker",new Set),Fy(this,"propDescriptors",new Map([["ariaTags",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{target:r,onChange:i=()=>{}}=e,o=typeof r=="string",s=o?r:n,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(n,a,i),o&&this.installPropWatcher(r,a,i)})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const qB="gridDefault",B_="editorManager.handlingEditor",sie={name:"editorCloseAndSave",callback(t,e,n){const r=t._getEditorManager();r.closeEditorAndSaveChanges(t.getShortcutManager().isCtrlPressed()),r.moveSelectionAfterEnter(n.includes("shift"))}},aie={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},lie={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},uie={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(n.includes("shift")),Ci(e))}};function cie(){return[sie,aie,lie,uie]}const hie={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},die={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},fie={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},gie={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},mie={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e.row)}},pie={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},wie={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},vie={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}},Cie={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},yie={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},Sie={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},bie={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e.col)}},Rie={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},Eie={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function Tie(){return[hie,die,fie,gie,mie,pie,wie,vie,Cie,yie,Sie,bie,Rie,Eie]}const _ie={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},Mie={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},xie={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-r.row,-r.col)}},Pie={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(r.row,r.col,!0)}},Oie={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},Aie={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},Iie={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},Hie={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},Die={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},Nie={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,o))}},kie={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},Lie={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},$ie={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},Fie={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},Wie={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},Vie={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function Bie(){return[_ie,Mie,xie,Pie,Oie,Aie,Iie,Hie,Die,Nie,kie,Lie,$ie,Fie,Wie,Vie]}const Uie={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},zie={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},Gie={name:"selectAll",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},jie={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},Yie=[...cie(),...Tie(),...Bie(),Uie,zie,Gie,jie];function QB(t){const e={};return Yie.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function Kie(t){const e=t.getShortcutManager().addContext("editor"),n=QB(t),r={group:B_};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function Xie(t){const e=t.getShortcutManager().addContext("grid"),n=QB(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return he(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:qB};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:B_,runOnlyIf:()=>he(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"],["Control/Meta","Shift","Space"]],callback:()=>n.selectAll()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function qie(t){[Kie,Xie].forEach(e=>e(t))}function Qie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=oA(t),i=oA(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function oA(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Re(n,[Fi()]),n}function Zie(t){let e;const{activate:n,deactivate:r}=Qie(t,{onFocusFromTop(){var s;const a=(s=e)!==null&&s!==void 0?s:sA(t);a&&(t.runHooks("modifyFocusOnTabNavigation","from_above",a),t.selectCell(a.row,a.col)),t.listen()},onFocusFromBottom(){var s;const a=(s=e)!==null&&s!==void 0?s:aA(t);a&&(t.runHooks("modifyFocusOnTabNavigation","from_below",a),t.selectCell(a.row,a.col)),t.listen()}}),i={wrapped:!1,flipped:!1};t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",()=>{var s;e=(s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight}),t.addHook("beforeRowWrap",(s,a,l)=>{i.wrapped=!0,i.flipped=l});function o(){i.wrapped=!1,i.flipped=!1,t.deselectCell(),t.unlisten()}t.getShortcutManager().getContext("grid").addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:s=>{const{disableTabNavigation:a,autoWrapRow:l}=t.getSettings();if(a||!t.selection.isSelected()||l&&i.wrapped&&i.flipped||!l&&i.wrapped)return l&&i.wrapped&&i.flipped&&(e=s.shiftKey?sA(t):aA(t)),o(),!1;s.preventDefault()},runOnlyIf:()=>!t.getSettings().minSpareCols,preventDefault:!1,stopPropagation:!1,position:"after",relativeToGroup:qB,group:"focusCatcher"})}function sA(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function aA(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}const lA=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Vg=t=>t.map(e=>{const n=e.toLowerCase();return lA.has(n)?lA.get(n):n}).sort().join("+"),Jie=t=>t.split("+"),uA=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),Wy=t=>{let{key:e,code:n}=t;return(uA.test(n)?n.replace(uA,"$1"):e).toLowerCase()},ZB=Symbol("shortcut-context");function JB(t){return Be(t)&&t.__kindOf===ZB}const eoe=t=>{const e=bv({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:f=!1,preventDefault:g=!0,stopPropagation:p=!1,relativeToGroup:y,position:E,forwardToContext:v}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(bt(c))throw new Error("You need to define the shortcut's group.");if(St(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(mt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const C={callback:u,group:c,runOnlyIf:h,captureCtrl:f,preventDefault:g,stopPropagation:p};he(y)&&([C.relativeToGroup,C.position]=[y,E]),JB(v)&&(C.forwardToContext=v),l.forEach(S=>{const T=Vg(S);if(e.hasItem(T)){const H=e.getItem(T);let D=H.findIndex(B=>B.group===y);D!==-1?E==="before"?D-=1:D+=1:D=H.length,H.splice(D,0,C)}else e.addItem(T,[C])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{je(u,(h,f)=>{Object.prototype.hasOwnProperty.call(c,f)===!1&&(c[f]=u[f])}),n(c)})},i=l=>{const u=Vg(l);e.removeItem(u)};return{__kindOf:ZB,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=Vg(l),c=e.getItem(u);return he(c)?c.slice():[]},hasShortcut:l=>{const u=Vg(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,f]=c;const g=f.filter(p=>p.group!==l);g.length===0?i(Jie(h)):(f.length=0,f.push(...g))})}}};function toe(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const noe=["meta","alt","shift","control"],Ch=toe();let Bg=0;function roe(t,e,n,r,i){const o=g=>noe.includes(g),s=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=[];return g.altKey&&y.push("alt"),p&&(g.ctrlKey||g.metaKey)?y.push("control/meta"):(g.ctrlKey&&y.push("control"),g.metaKey&&y.push("meta")),g.shiftKey&&y.push("shift"),y},a=g=>{if(e(g)===!1)return;const p=n(g);if(g.keyCode===229||p===!1||Zs(g))return;const y=Wy(g);let E=[];o(y)||(E=s(g));const v=[y].concat(E);!i(g,v)&&(tf()&&E.includes("meta")||!tf()&&E.includes("control"))&&i(g,[y].concat(s(g,!0))),r(g)},l=g=>{const p=Wy(g);o(p)&&Ch.press(p)},u=g=>{const p=Wy(g);o(p)&&Ch.release(p)},c=()=>{Ch.releaseAll()};return{mount:()=>{let g=t;for(Bg+=1;g;)Bg===1&&(g.document.documentElement.addEventListener("keydown",l),g.document.documentElement.addEventListener("keyup",u)),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=Zd(g)},unmount:()=>{let g=t;for(Bg-=1;g;)Bg===0&&(g.document.documentElement.removeEventListener("keydown",l),g.document.documentElement.removeEventListener("keyup",u)),g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=Zd(g)},isPressed:g=>Ch.isPressed(g),releasePressedKeys:()=>Ch.releaseAll()}}const ioe=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=bv({errorIdExists:p=>`The "${p}" context name is already registered.`});let s="grid";const a=p=>{const y=eoe(p);return o.addItem(p,y),y},l=()=>s,u=p=>o.getItem(p),c=p=>{if(!o.hasItem(p))throw new Error(mt`You've tried to activate the "${p}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=p};let h=!1;const f=function(p,y){let E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const v=JB(E)?E:u(E);let C=!1;if(!v.hasShortcut(y))return C;const S=v.getShortcuts(y);for(let T=0;T<S.length;T++){const{callback:_,runOnlyIf:H,preventDefault:D,stopPropagation:B,captureCtrl:z,forwardToContext:G}=S[T];if(H(p)===!0){if(h=z,C=_(p,y)===!1,h=!1,D&&p.preventDefault(),B&&(Ci(p),p.stopPropagation()),C)break;G&&f(p,y,G)}}return C},g=roe(e,n,r,i,f);return g.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};let Vy=null;const By=new Map;function e2(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this;const a=new Kr(s);let l,u,c,h,f,g=!0;Bte(i)&&Vte(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const p=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",y=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",y),this.isRtl=function(){return y==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=Gne(e.language);const E=new XB(s,e,[nie,oie]),v=E.getTableMeta(),C=E.getGlobalMeta(),S=bv();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),ep(this)&&qW(e.licenseKey,t),this.guid=`ht_${uT()}`,By.set(this.guid,this),this.columnIndexMapper=new eR,this.rowIndexMapper=new eR,this.columnIndexMapper.addLocalHook("indexesSequenceChange",d=>{s.runHooks("afterColumnSequenceChange",d)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",d=>{s.runHooks("afterRowSequenceChange",d)}),u=new ine(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const T=d=>{const{row:m,col:w}=d;return s._createCellCoords(m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m,w>=0?s.columnIndexMapper.getRenderableFromVisualIndex(w):w)},_=d=>{const{row:m,col:w}=d;return s._createCellCoords(m>=0?s.rowIndexMapper.getVisualFromRenderableIndex(m):m,w>=0?s.columnIndexMapper.getVisualFromRenderableIndex(w):w)};let H=new _re(v,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:d=>l.propToCol(d),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(d,m)=>s._createCellCoords(d,m),createCellRange:(d,m,w)=>s._createCellRange(d,m,w),visualToRenderableCoords:T,renderableToVisualCoords:_,isDisabledCellSelection:(d,m)=>d<0||m<0?s.getSettings().disableVisualSelection:s.getCellMeta(d,m).disableVisualSelection});this.selection=H;const D=d=>{let{hiddenIndexesChanged:m}=d;m&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",D),this.rowIndexMapper.addLocalHook("cacheUpdated",D),this.selection.addLocalHook("afterSetRangeEnd",d=>{const m=Wl(!1),w=this.selection.getSelectedRange(),{from:x,to:O}=w.current(),A=w.size()-1;this.runHooks("afterSelection",x.row,x.col,O.row,O.col,m,A),this.runHooks("afterSelectionByProp",x.row,s.colToProp(x.col),O.row,s.colToProp(O.col),m,A);let K=!0;o&&(K=!1),m.isTouched()&&(K=!m.value);const U=this.selection.selectedRange.current(),Q=this.selection.isSelectedByAnyHeader(),J=this.selection.isSelectedByRowHeader(),q=this.selection.isSelectedByColumnHeader();if(K!==!1)if(Q)J?this.scrollViewportTo({row:d.row}):q&&this.scrollViewportTo({col:d.col});else if(U&&!this.selection.isMultiple()){const{row:fe,col:Ae}=U.from;fe<0&&Ae>=0?this.scrollViewportTo({col:Ae}):Ae<0&&fe>=0?this.scrollViewportTo({row:fe}):this.scrollViewportTo({row:fe,col:Ae})}else this.scrollViewportTo(d.toObject());J&&q?te(this.rootElement,["ht__selection--rows","ht__selection--columns"]):J?(Le(this.rootElement,"ht__selection--columns"),te(this.rootElement,"ht__selection--rows")):q?(Le(this.rootElement,"ht__selection--rows"),te(this.rootElement,"ht__selection--columns")):Le(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",d=>{const m=d.length-1,{from:w,to:x}=d[m];this.runHooks("afterSelectionEnd",w.row,w.col,x.row,x.col,m),this.runHooks("afterSelectionEndByProp",w.row,s.colToProp(w.col),x.row,s.colToProp(x.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",d=>{const m=this.runHooks("afterIsMultipleSelection",d.value);d.value&&(d.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{h.destroyEditor(),this._refreshBorders(),Le(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("afterSelectRows",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var d=arguments.length,m=new Array(d),w=0;w<d;w++)m[w]=arguments[w];return r.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",d=>this.alter("insert_row_above",d,1,"auto")).addLocalHook("insertColRequire",d=>this.alter("insert_col_start",d,1,"auto")),c={alter(d,m){var w,x;let O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,A=arguments.length>3?arguments[3]:void 0,K=arguments.length>4?arguments[4]:void 0;const U=Q=>{if(Q.length===0)return[];const J=[...Q];return J.sort((fe,Ae)=>{let[Pe]=fe,[Oe]=Ae;return Pe===Oe?0:Pe>Oe?1:-1}),en(J,(fe,Ae)=>{let[Pe,Oe]=Ae;const X=fe[fe.length-1],[Xe,Ue]=X,_e=Xe+Ue;if(Pe<=_e){const Ne=Math.max(Oe-(_e-Pe),0);X[1]+=Ne}else fe.push([Pe,Oe]);return fe},[J[0]])};switch(d){case"insert_row_below":case"insert_row_above":const Q=s.countSourceRows();if(v.maxRows===Q)return;const J=d==="insert_row_below"?"below":"above";m=(w=m)!==null&&w!==void 0?w:J==="below"?Q:0;const{delta:q,startPhysicalIndex:fe}=l.createRow(m,O,{source:A,mode:J});if(q){const Ue=H.selectedRange.current(),_e=Ue==null?void 0:Ue.from,Ne=_e==null?void 0:_e.row,Te=s.toVisualRow(fe);if(H.isSelectedByCorner())H.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(he(Ne)&&Ne>=Te){const{row:b,col:M}=Ue.to;let I=_e.col;H.isSelectedByRowHeader()&&(I=-1),H.getSelectedRange().pop(),H.setRangeStartOnly(s._createCellCoords(Ne+q,I),!0),H.setRangeEnd(s._createCellCoords(b+q,M))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Ae=d==="insert_col_end"?"end":"start";m=(x=m)!==null&&x!==void 0?x:Ae==="end"?s.countSourceCols():0;const{delta:Pe,startPhysicalIndex:Oe}=l.createCol(m,O,{source:A,mode:Ae});if(Pe){if(Array.isArray(v.colHeaders)){const b=[s.toVisualColumn(Oe),0];b.length+=Pe,Array.prototype.splice.apply(v.colHeaders,b)}const Ue=H.selectedRange.current(),_e=Ue==null?void 0:Ue.from,Ne=_e==null?void 0:_e.col,Te=s.toVisualColumn(Oe);if(H.isSelectedByCorner())H.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(he(Ne)&&Ne>=Te){const{row:b,col:M}=Ue.to;let I=_e.row;H.isSelectedByColumnHeader()&&(I=-1),H.getSelectedRange().pop(),H.setRangeStartOnly(s._createCellCoords(I,Ne+Pe),!0),H.setRangeEnd(s._createCellCoords(b,M+Pe))}else s._refreshBorders()}break;case"remove_row":const X=Ue=>{let _e=0;P(Ue,Ne=>{let[Te,b]=Ne;const M=gn(Te)?s.countRows()-1:Math.max(Te-_e,0);if(Number.isInteger(Te)&&(Te=Math.max(Te-_e,0)),!l.removeRow(Te,b,A))return;const V=s.countRows(),N=v.fixedRowsTop;N>=M+1&&(v.fixedRowsTop-=Math.min(b,N-M));const W=v.fixedRowsBottom;W&&M>=V-W&&(v.fixedRowsBottom-=Math.min(b,W)),_e+=b})};Array.isArray(m)?X(U(m)):X([[m,O]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const Xe=Ue=>{let _e=0;P(Ue,Ne=>{let[Te,b]=Ne;const M=gn(Te)?s.countCols()-1:Math.max(Te-_e,0);let I=s.toPhysicalColumn(M);if(Number.isInteger(Te)&&(Te=Math.max(Te-_e,0)),!l.removeCol(Te,b,A))return;const N=v.fixedColumnsStart;N>=M+1&&(v.fixedColumnsStart-=Math.min(b,N-M)),Array.isArray(v.colHeaders)&&(typeof I>"u"&&(I=-1),v.colHeaders.splice(I,b)),_e+=b})};Array.isArray(m)?Xe(U(m)):Xe([[m,O]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${d}"`)}K||c.adjustRowsAndCols()},adjustRowsAndCols(){const d=v.minRows,m=v.minSpareRows,w=v.minCols,x=v.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&H.deselect(),d){const O=s.countRows();O<d&&l.createRow(O,d-O,{source:"auto"})}if(m){const O=s.countEmptyRows(!0);if(O<m){const A=m-O,K=Math.min(A,v.maxRows-s.countSourceRows());l.createRow(s.countRows(),K,{source:"auto"})}}{let O;(w||x)&&(O=s.countEmptyCols(!0));let A=s.countCols();if(w&&!v.columns&&A<w){const K=w-A;O+=K,l.createCol(A,K,{source:"auto"})}if(x&&!v.columns&&s.dataType==="array"&&O<x){A=s.countCols();const K=x-O,U=Math.min(K,v.maxCols-A);l.createCol(A,U,{source:"auto"})}}if(H.isSelected()){const O=s.countRows(),A=s.countCols();P(H.selectedRange,K=>{let U=!1,Q=K.from.row,J=K.from.col,q=K.to.row,fe=K.to.col;Q>O-1?(Q=O-1,U=!0,q>Q&&(q=Q)):q>O-1&&(q=O-1,U=!0,Q>q&&(Q=q)),J>A-1?(J=A-1,U=!0,fe>J&&(fe=J)):fe>A-1&&(fe=A-1,U=!0,J>fe&&(J=fe)),U&&s.selectCell(Q,J,q,fe)})}s.view&&s.view.adjustElementsSize()},populateFromArray(d,m,w,x,O){let A,K,U,Q;const J=[],q={},fe=[],Ae=d.row,Pe=d.col;if(K=m.length,K===0)return!1;let Oe=0,X=0;switch(Be(w)&&(Oe=w.col-Pe+1,X=w.row-Ae+1),O){case"shift_down":const Xe=gd(m),Ue=Xe.length,_e=Math.max(Ue,Oe),Ne=s.getData().slice(Ae),Te=gd(Ne).slice(Pe,Pe+_e);for(U=0;U<_e;U+=1)if(U<Ue){for(A=0,K=Xe[U].length;A<X-K;A+=1)Xe[U].push(Xe[U][A%K]);U<Te.length?fe.push(Xe[U].concat(Te[U])):fe.push(Xe[U].concat(new Array(Ne.length).fill(null)))}else fe.push(Xe[U%Ue].concat(Te[U]));s.populateFromArray(Ae,Pe,gd(fe));break;case"shift_right":const b=m.length,M=Math.max(b,X),I=s.getData().slice(Ae).map(Y=>Y.slice(Pe));for(A=0;A<M;A+=1)if(A<b){for(U=0,Q=m[A].length;U<Oe-Q;U+=1)m[A].push(m[A][U%Q]);if(A<I.length)for(let Y=0;Y<I[A].length;Y+=1)m[A].push(I[A][Y]);else m[A].push(...new Array(I[0].length).fill(null))}else m.push(m[A%K].slice(0,M).concat(I[A]));s.populateFromArray(Ae,Pe,m);break;case"overwrite":default:q.row=d.row,q.col=d.col;let V=0,N=0,W=!0,k;const L=function(ae){let ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const be=m[ae%m.length];return ge!==null?be[ge%be.length]:be},j=m.length,F=w?w.row-d.row+1:0;for(w?K=F:K=Math.max(j,F),A=0;A<K&&!(w&&q.row>w.row&&F>j||!v.allowInsertRow&&q.row>s.countRows()-1||q.row>=v.maxRows);A++){const Y=A-V,ae=L(Y).length,ge=w?w.col-d.col+1:0;if(w?Q=ge:Q=Math.max(ae,ge),q.col=d.col,k=s.getCellMeta(q.row,q.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&k.skipRowOnPaste){V+=1,q.row+=1,K+=1;continue}for(N=0,U=0;U<Q&&!(w&&q.col>w.col&&ge>ae||!v.allowInsertColumn&&q.col>s.countCols()-1||q.col>=v.maxCols);U++){if(k=s.getCellMeta(q.row,q.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&k.skipColumnOnPaste){N+=1,q.col+=1,Q+=1;continue}if(k.readOnly&&x!=="UndoRedo.undo"){q.col+=1;continue}const be=U-N;let Ie=L(Y,be),Ve=s.getDataAtCell(q.row,q.col);if(Ie!==null&&typeof Ie=="object")if(Array.isArray(Ie)&&Ve===null&&(Ve=[]),Ve===null||typeof Ve!="object")W=!1;else{const Et=Pc(Array.isArray(Ve)?Ve:Ve[0]||Ve),Ze=Pc(Array.isArray(Ie)?Ie:Ie[0]||Ie);vv(Et,Ze)||Array.isArray(Et)&&Array.isArray(Ze)?Ie=Zn(Ie):W=!1}else Ve!==null&&typeof Ve=="object"&&(W=!1);W&&J.push([q.row,q.col,Ie]),W=!0,q.col+=1}q.row+=1}s.setDataAtCell(J,null,null,x||"populateFromArray");break}}};function B(d){const m=PB(d);F_(m)?(s.runHooks("beforeLanguageChange",m),C.language=m,s.runHooks("afterLanguageChange",m)):OB(d)}function z(d,m){const w=d==="className"?s.rootElement:s.table;if(g)te(w,m);else{let x=[],O=[];C[d]&&(x=Array.isArray(C[d])?C[d]:D0(C[d])),m&&(O=Array.isArray(m)?m:D0(m));const A=H0(x,O),K=H0(O,x);A.length&&Le(w,A),K.length&&te(w,K)}C[d]=m}this.init=function(){u.setData(v.data),s.runHooks("beforeInit"),(ss()||ET())&&te(s.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new Xte(this),h=oZ.getInstance(s,v,H),f=new lZ(s),ep(this)&&Zie(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&s.rootElement.offsetParent===null&&dV(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof g=="object"&&(s.runHooks("afterChange",g[0],g[1]),g=!1),s.runHooks("afterInit")};function G(){let d=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,d=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&d===!1&&(d=!0,this.onQueueEmpty(this.valid))}}}function Z(d){const m=d.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):d}function re(d,m,w){if(!d.length)return;const x=s.getActiveEditor(),O=new G;let A=!0;O.onQueueEmpty=K=>{x&&A&&x.cancelChanges(),w(K)};for(let K=d.length-1;K>=0;K--){const[U,Q,,J]=d[K],q=l.propToCol(Q),fe=s.getCellMeta(U,q);fe.type==="numeric"&&typeof J=="string"&&FV(J)&&(d[K][3]=Z(J)),s.getCellValidator(fe)&&(O.addValidatorToQueue(),s.validateCell(d[K][3],fe,function(Ae,Pe){return function(Oe){if(typeof Oe!="boolean")throw new Error("Validation error: result is not boolean");if(Oe===!1&&Pe.allowInvalid===!1){A=!1,d.splice(Ae,1),Pe.valid=!0;const X=s.getCell(Pe.visualRow,Pe.visualCol);X!==null&&Le(X,v.invalidCellClassName)}O.removeValidatorFormQueue()}}(K,fe),m))}O.checkIfQueueIsEmpty()}function ne(d,m){let w=d.length-1;if(w<0)return;for(;w>=0;w--){let O=!1;if(d[w]===null){d.splice(w,1);continue}if(!((d[w][2]===null||d[w][2]===void 0)&&(d[w][3]===null||d[w][3]===void 0))){if(v.allowInsertRow)for(;d[w][0]>s.countRows()-1;){const{delta:A}=l.createRow(void 0,void 0,{source:m});if(A===0){O=!0;break}}if(s.dataType==="array"&&(!v.columns||v.columns.length===0)&&v.allowInsertColumn)for(;l.propToCol(d[w][1])>s.countCols()-1;){const{delta:A}=l.createCol(void 0,void 0,{source:m});if(A===0){O=!0;break}}O||l.set(d[w][0],d[w][1],d[w][3])}}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",d,m),h.lockEditor(),s._refreshBorders(null),h.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",d,m||"edit");const x=s.getActiveEditor();x&&he(x.refreshValue)&&x.refreshValue()}this._createCellCoords=function(d,m){return s.view._wt.createCellCoords(d,m)},this._createCellRange=function(d,m,w){return s.view._wt.createCellRange(d,m,w)},this.validateCell=function(d,m,w,x){let O=s.getCellValidator(m);function A(K){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){w(K);return}const Q=m.visualCol,J=m.visualRow,q=s.getCell(J,Q,!0);if(q&&q.nodeName!=="TH"){const fe=s.rowIndexMapper.getRenderableFromVisualIndex(J),Ae=s.columnIndexMapper.getRenderableFromVisualIndex(Q);s.view._wt.getSetting("cellRenderer",fe,Ae,q)}w(K)}XW(O)&&(O=function(K){return function(U,Q){Q(K.test(U))}}(O)),St(O)?(d=s.runHooks("beforeValidate",d,m.visualRow,m.prop,x),s._registerImmediate(()=>{O.call(m,d,K=>{s&&(K=s.runHooks("afterValidate",K,d,m.visualRow,m.prop,x),m.valid=K,A(K),s.runHooks("postAfterValidate",K,d,m.visualRow,m.prop,x))})})):s._registerImmediate(()=>{m.valid=!0,A(m.valid,!1)})};function ue(d,m,w){return Array.isArray(d)?d:[[d,m,w]]}function Ee(d,m){const w=s.getActiveEditor(),x=s.runHooks("beforeChange",d,m||"edit"),O=d.filter(A=>A!==null);return x===!1||O.length===0?(w&&w.cancelChanges(),[]):O}this.setDataAtCell=function(d,m,w,x){const O=ue(d,m,w),A=[];let K=x,U,Q,J;for(U=0,Q=O.length;U<Q;U++){if(typeof O[U]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof O[U][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");O[U][1]>=this.countCols()?J=O[U][1]:J=l.colToProp(O[U][1]),A.push([O[U][0],J,u.getAtCell(this.toPhysicalRow(O[U][0]),O[U][1]),O[U][2]])}!K&&typeof d=="object"&&(K=m);const q=Ee(A,x);s.runHooks("afterSetDataAtCell",q,K),re(q,K,()=>{ne(q,K)})},this.setDataAtRowProp=function(d,m,w,x){const O=ue(d,m,w),A=[];let K=x,U,Q;for(U=0,Q=O.length;U<Q;U++)A.push([O[U][0],O[U][1],u.getAtCell(this.toPhysicalRow(O[U][0]),O[U][1]),O[U][2]]);!K&&typeof d=="object"&&(K=m);const J=Ee(A,x);s.runHooks("afterSetDataAtRowProp",J,K),re(J,K,()=>{ne(J,K)})},this.listen=function(){s&&!s.isListening()&&(By.forEach(d=>{s!==d&&d.unlisten()}),Vy=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Vy=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Vy===s.guid},this.destroyEditor=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(d,m)},this.populateFromArray=function(d,m,w,x,O,A,K){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const U=typeof x=="number"?s._createCellCoords(x,O):null;return c.populateFromArray(s._createCellCoords(d,m),w,U,A,K)},this.spliceCol=function(d,m,w){for(var x=arguments.length,O=new Array(x>3?x-3:0),A=3;A<x;A++)O[A-3]=arguments[A];return l.spliceCol(d,m,w,...O)},this.spliceRow=function(d,m,w){for(var x=arguments.length,O=new Array(x>3?x-3:0),A=3;A<x;A++)O[A-3]=arguments[A];return l.spliceRow(d,m,w,...O)},this.getSelected=function(){if(H.isSelected())return Ge(H.getSelectedRange(),d=>{let{from:m,to:w}=d;return[m.row,m.col,w.row,w.col]})},this.getSelectedLast=function(){const d=this.getSelected();let m;return d&&d.length>0&&(m=d[d.length-1]),m},this.getSelectedRange=function(){if(H.isSelected())return Array.from(H.getSelectedRange())},this.getSelectedRangeLast=function(){const d=this.getSelectedRange();let m;return d&&d.length>0&&(m=d[d.length-1]),m},this.emptySelectedCells=function(d){if(!H.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];P(H.getSelectedRange(),w=>{if(w.isSingleHeader())return;const x=w.getTopStartCorner(),O=w.getBottomEndCorner();ye(x.row,O.row,A=>{ye(x.col,O.col,K=>{this.getCellMeta(A,K).readOnly||m.push([A,K,null])})})}),m.length>0&&this.setDataAtCell(m,d)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const d=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(d,0),!this.isRenderSuspended()&&d===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(h.lockEditor(),this._refreshBorders(null),h.unlockEditor()))},this.batchRender=function(d){this.suspendRender();const m=d();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||d)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const w=d();return this.resumeExecution(m),w},this.batch=function(d){this.suspendRender(),this.suspendExecution();const m=d();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!s.view)return;const{width:d,height:m}=s.view.getLastSize(),{width:w,height:x}=s.rootElement.getBoundingClientRect(),O=w!==d||x!==m;s.runHooks("beforeRefreshDimensions",{width:d,height:m},{width:w,height:x},O)!==!1&&((O||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(w,x),s.render()),s.runHooks("afterRefreshDimensions",{width:d,height:m},{width:w,height:x},O))},this.updateData=function(d,m){rA(d,w=>{l=w},w=>{l=w,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:m,metaManager:E,firstRun:g})},this.loadData=function(d,m){rA(d,w=>{l=w},()=>{E.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),g&&(g=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:m,metaManager:E,firstRun:g})},this.getInitialColumnCount=function(){const d=v.columns;let m=0;if(Array.isArray(d))m=d.length;else if(St(d))if(s.dataType==="array"){const w=this.countSourceCols();for(let x=0;x<w;x+=1)d(x)&&(m+=1)}else(s.dataType==="object"||s.dataType==="function")&&(m=l.colToPropCache.length);else if(he(v.dataSchema)){const w=l.getSchema();m=Array.isArray(w)?w.length:Cv(w)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(d,m,w,x){return bt(d)?l.getAll():l.getRange(s._createCellCoords(d,m),s._createCellCoords(w,x),l.DESTINATION_RENDERER)},this.getCopyableText=function(d,m,w,x){return l.getCopyableText(s._createCellCoords(d,m),s._createCellCoords(w,x))},this.getCopyableData=function(d,m){return l.getCopyable(d,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=(g?s.loadData:s.updateData).bind(this);let x=!1,O,A;if(he(d.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(he(d.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(he(d.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(O in d)O==="data"||(O==="language"?B(d.language):O==="className"?z("className",d.className):O==="tableClassName"&&s.table?(z("tableClassName",d.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):me.getSingleton().isRegistered(O)||me.getSingleton().isDeprecated(O)?(St(d[O])||Array.isArray(d[O]))&&(d[O].initialHook=!0,s.addHook(O,d[O])):!m&&Ft(d,O)&&(C[O]=d[O]));d.data===void 0&&v.data===void 0?w(null,"updateSettings"):d.data!==void 0?w(d.data,"updateSettings"):d.columns!==void 0&&(l.createMap(),s.initIndexMappers());const K=s.countCols(),U=v.columns;if(U&&St(U)&&(x=!0),(d.cell!==void 0||d.cells!==void 0||d.columns!==void 0)&&E.clearCache(),K>0)for(O=0,A=0;O<K;O++){if(U){const q=x?U(O):U[A];q&&E.updateColumnMeta(A,q)}A+=1}he(d.cell)&&je(d.cell,q=>{s.setCellMetaObject(q.row,q.col,q)}),s.runHooks("afterCellMetaReset");let Q=s.rootElement.style.height;Q!==""&&(Q=parseInt(s.rootElement.style.height,10));let J=d.height;if(St(J)&&(J=J()),m&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),J===null){const q=s.rootElement.getAttribute("data-initialstyle");q&&(q.indexOf("height")>-1||q.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",q):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else J!==void 0&&(s.rootElement.style.height=isNaN(J)?`${J}`:`${J}px`,s.rootElement.style.overflow="hidden");if(typeof d.width<"u"){let q=d.width;St(q)&&(q=q()),s.rootElement.style.width=isNaN(q)?`${q}`:`${q}px`}m||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",d)),c.adjustRowsAndCols(),s.view&&!g&&(s.forceFullRender=!0,h.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),h.unlockEditor()),!m&&s.view&&(Q===""||J===""||J===void 0)&&Q!==J&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const d=s.getSelectedLast();if(v.getValue){if(St(v.getValue))return v.getValue.call(s);if(d)return s.getData()[d[0][0]][v.getValue]}else if(d)return s.getDataAtCell(d[0],d[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(d,m,w,x,O){c.alter(d,m,w,x,O)},this.getCell=function(d,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,x=m,O=d;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;x=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(d>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(d)))return null;O=this.rowIndexMapper.getRenderableFromVisualIndex(d)}return O===null||x===null?null:s.view.getCellAtCoords(s._createCellCoords(O,x),w)},this.getCoords=function(d){const m=this.view._wt.wtTable.getCoords(d);if(m===null)return null;const{row:w,col:x}=m;let O=w,A=x;return w>=0&&(O=this.rowIndexMapper.getVisualFromRenderableIndex(w)),x>=0&&(A=this.columnIndexMapper.getVisualFromRenderableIndex(x)),s._createCellCoords(O,A)},this.colToProp=function(d){return l.colToProp(d)},this.propToCol=function(d){return l.propToCol(d)},this.toVisualRow=d=>this.rowIndexMapper.getVisualFromPhysicalIndex(d),this.toVisualColumn=d=>this.columnIndexMapper.getVisualFromPhysicalIndex(d),this.toPhysicalRow=d=>this.rowIndexMapper.getPhysicalFromVisualIndex(d),this.toPhysicalColumn=d=>this.columnIndexMapper.getPhysicalFromVisualIndex(d),this.getDataAtCell=function(d,m){return l.get(d,l.colToProp(m))},this.getDataAtRowProp=function(d,m){return l.get(d,m)},this.getDataAtCol=function(d){const m=[],w=l.getRange(s._createCellCoords(0,d),s._createCellCoords(v.data.length-1,d),l.DESTINATION_RENDERER);for(let x=0;x<w.length;x+=1)for(let O=0;O<w[x].length;O+=1)m.push(w[x][O]);return m},this.getDataAtProp=function(d){const m=[],w=l.getRange(s._createCellCoords(0,l.propToCol(d)),s._createCellCoords(v.data.length-1,l.propToCol(d)),l.DESTINATION_RENDERER);for(let x=0;x<w.length;x+=1)for(let O=0;O<w[x].length;O+=1)m.push(w[x][O]);return m},this.getSourceData=function(d,m,w,x){let O;return d===void 0?O=u.getData():O=u.getByRange(s._createCellCoords(d,m),s._createCellCoords(w,x)),O},this.getSourceDataArray=function(d,m,w,x){let O;return d===void 0?O=u.getData(!0):O=u.getByRange(s._createCellCoords(d,m),s._createCellCoords(w,x),!0),O},this.getSourceDataAtCol=function(d){return u.getAtColumn(d)},this.setSourceDataAtCell=function(d,m,w,x){const O=ue(d,m,w),A=this.hasHook("afterSetSourceDataAtCell"),K=[];A&&P(O,Q=>{let[J,q,fe]=Q;K.push([J,q,u.getAtCell(J,q),fe])}),P(O,Q=>{let[J,q,fe]=Q;u.setAtCell(J,q,fe)}),A&&this.runHooks("afterSetSourceDataAtCell",K,x),this.render();const U=s.getActiveEditor();U&&he(U.refreshValue)&&U.refreshValue()},this.getSourceDataAtRow=function(d){return u.getAtRow(d)},this.getSourceDataAtCell=function(d,m){return u.getAtCell(d,m)},this.getDataAtRow=function(d){return l.getRange(s._createCellCoords(d,0),s._createCellCoords(d,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(d,m,w,x){const O=d===void 0?[0,0,this.countRows(),this.countCols()]:[d,m,w,x],[A,K]=O;let[,,U,Q]=O,J=null,q=null;U===void 0&&(U=A),Q===void 0&&(Q=K);let fe="mixed";return ye(Math.max(Math.min(A,U),0),Math.max(A,U),Ae=>{let Pe=!0;return ye(Math.max(Math.min(K,Q),0),Math.max(K,Q),Oe=>(q=this.getCellMeta(Ae,Oe).type,J?Pe=J===q:J=q,Pe)),fe=Pe?q:"mixed",Pe}),fe},this.removeCellMeta=function(d,m,w){const[x,O]=[this.toPhysicalRow(d),this.toPhysicalColumn(m)];let A=E.getCellMetaKeyValue(x,O,w);s.runHooks("beforeRemoveCellMeta",d,m,w,A)!==!1&&(E.removeCellMeta(x,O,w),s.runHooks("afterRemoveCellMeta",d,m,w,A)),A=null},this.spliceCellsMeta=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,x=new Array(w>2?w-2:0),O=2;O<w;O++)x[O-2]=arguments[O];if(x.length>0&&!Array.isArray(x[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&E.removeRow(this.toPhysicalRow(d),m),x.length>0&&P(x.reverse(),A=>{E.createRow(this.toPhysicalRow(d)),P(A,(K,U)=>this.setCellMetaObject(d,U,K))}),s.render()},this.setCellMetaObject=function(d,m,w){typeof w=="object"&&je(w,(x,O)=>{this.setCellMeta(d,m,O,x)})},this.setCellMeta=function(d,m,w,x){if(s.runHooks("beforeSetCellMeta",d,m,w,x)===!1)return;let A=d,K=m;d<this.countRows()&&(A=this.toPhysicalRow(d)),m<this.countCols()&&(K=this.toPhysicalColumn(m)),E.setCellMeta(A,K,w,x),s.runHooks("afterSetCellMeta",d,m,w,x)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(d,m){let w=this.toPhysicalRow(d),x=this.toPhysicalColumn(m);return w===null&&(w=d),x===null&&(x=m),E.getCellMeta(w,x,{visualRow:d,visualColumn:m})},this.getCellMetaAtRow=function(d){return E.getCellsMetaAtRow(d)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||v.columns)},this.getCellRenderer=function(d,m){const w=typeof d=="number"?s.getCellMeta(d,m).renderer:d.renderer;return typeof w=="string"?iw(w):bt(w)?iw("text"):w},this.getCellEditor=function(d,m){const w=typeof d=="number"?s.getCellMeta(d,m).editor:d.editor;return typeof w=="string"?nw(w):bt(w)?nw("text"):w},this.getCellValidator=function(d,m){const w=typeof d=="number"?s.getCellMeta(d,m).validator:d.validator;return typeof w=="string"?OT(w):w},this.validateCells=function(d){this._validateCells(d)},this.validateRows=function(d,m){if(!Array.isArray(d))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,d)},this.validateColumns=function(d,m){if(!Array.isArray(d))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,d)},this._validateCells=function(d,m,w){const x=new G;d&&(x.onQueueEmpty=d);let O=s.countRows()-1;for(;O>=0;){if(m!==void 0&&m.indexOf(O)===-1){O-=1;continue}let A=s.countCols()-1;for(;A>=0;){if(w!==void 0&&w.indexOf(A)===-1){A-=1;continue}x.addValidatorToQueue(),s.validateCell(s.getDataAtCell(O,A),s.getCellMeta(O,A),K=>{if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&(x.valid=!1),x.removeValidatorFormQueue()},"validateCells"),A-=1}O-=1}x.checkIfQueueIsEmpty()},this.getRowHeader=function(d){let m=v.rowHeaders,w=d;return w!==void 0&&(w=s.runHooks("modifyRowHeader",w)),w===void 0?(m=[],ye(s.countRows()-1,x=>{m.push(s.getRowHeader(x))})):Array.isArray(m)&&m[w]!==void 0?m=m[w]:St(m)?m=m(w):m&&typeof m!="string"&&typeof m!="number"&&(m=w+1),m},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(v.colHeaders!==void 0&&v.colHeaders!==null)return!!v.colHeaders;for(let d=0,m=s.countCols();d<m;d++)if(s.getColHeader(d))return!0;return!1},this.getColHeader=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const w=s.runHooks("modifyColHeader",d);if(w===void 0){const U=[],Q=s.countCols();for(let J=0;J<Q;J++)U.push(s.getColHeader(J));return U}let x=v.colHeaders;const O=function(U){const Q=[],J=s.countCols();let q=0;for(;q<J;q++)St(v.columns)&&v.columns(q)&&Q.push(q);return Q[U]},A=s.toPhysicalColumn(w),K=O(A);return v.colHeaders===!1?x=null:v.columns&&St(v.columns)&&v.columns(K)&&v.columns(K).title?x=v.columns(K).title:v.columns&&v.columns[A]&&v.columns[A].title?x=v.columns[A].title:Array.isArray(v.colHeaders)&&v.colHeaders[A]!==void 0?x=v.colHeaders[A]:St(v.colHeaders)?x=v.colHeaders(A):v.colHeaders&&typeof v.colHeaders!="string"&&typeof v.colHeaders!="number"&&(x=Ev(w)),x=s.runHooks("modifyColumnHeaderValue",x,d,m),x},this._getColWidthFromSettings=function(d){let m;if(d>=0&&(m=s.getCellMeta(0,d).width),(m===void 0||m===v.width)&&(m=v.colWidths),m!=null){switch(typeof m){case"object":m=m[d];break;case"function":m=m(d);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(d){let m=s._getColWidthFromSettings(d);return m=s.runHooks("modifyColWidth",m,d),m===void 0&&(m=IT.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(d){let m=v.rowHeights;if(m!=null){switch(typeof m){case"object":m=m[d];break;case"function":m=m(d);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(d){let m=s._getRowHeightFromSettings(d);return m=s.runHooks("modifyRowHeight",m,d),m},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const d=v.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(d,m)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return rw(s.countRows()-1,w=>{if(s.isEmptyRow(w))m+=1;else if(d===!0)return!1}),m},this.countEmptyCols=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return rw(s.countCols()-1,w=>{if(s.isEmptyCol(w))m+=1;else if(d===!0)return!1}),m},this.isEmptyRow=function(d){return v.isEmptyRow.call(s,d)},this.isEmptyCol=function(d){return v.isEmptyCol.call(s,d)},this.selectCell=function(d,m,w,x){let O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,A=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return bt(d)||bt(m)?!1:this.selectCells([[d,m,w,x]],O,A)},this.selectCells=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(o=!0);const x=H.selectCells(d);return x&&w&&s.listen(),o=!1,x},this.selectColumns=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,w=arguments.length>2?arguments[2]:void 0;return H.selectColumns(d,m,w)},this.selectRows=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,w=arguments.length>2?arguments[2]:void 0;return H.selectRows(d,m,w)},this.deselectCell=function(){H.deselect()},this.selectAll=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,w=arguments.length>2?arguments[2]:void 0;o=!0,H.selectAll(d,m,w),o=!1};const $e=(d,m)=>d.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(){let{row:d,col:m,verticalSnap:w,horizontalSnap:x,considerHiddenIndexes:O}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},A,K,U,Q;w!==void 0&&(A=w==="top",K=!A),x!==void 0&&(U=x==="start",Q=!U);let J=d,q=m;if(O===void 0||O){const Pe=Number.isInteger(d)&&d>=0,Oe=Number.isInteger(m)&&m>=0,X=Pe?$e(this.rowIndexMapper,d):void 0,Xe=Oe?$e(this.columnIndexMapper,m):void 0;if(X===null||Xe===null)return!1;J=Pe?s.rowIndexMapper.getRenderableFromVisualIndex(X):d,q=Oe?s.columnIndexMapper.getRenderableFromVisualIndex(Xe):m}const fe=Number.isInteger(J),Ae=Number.isInteger(q);return fe&&J>=0&&Ae&&q>=0?s.view.scrollViewport(s._createCellCoords(J,q),A,Q,K,U):fe&&J>=0&&(Ae&&q<0||!Ae)?s.view.scrollViewportVertically(J,A,K):Ae&&q>=0&&(fe&&J<0||!fe)?s.view.scrollViewportHorizontally(q,Q,U):!1},this.scrollToFocusedCell=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",d);const{highlight:m}=this.getSelectedRangeLast();this.scrollViewportTo(m.toObject())?this.view.render():(this.removeHook("afterScroll",d),this._registerImmediate(()=>d()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),E.clearCache(),By.delete(this.guid),ep(s)){const d=this.rootDocument.querySelector(".hot-display-license-info");d&&d.parentNode.removeChild(d)}Ki(s.rootElement),a.destroy(),h&&h.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),S.getItems().forEach(d=>{let[,m]=d;m.destroy()}),S.clear(),s.runHooks("afterDestroy")},!0),me.getSingleton().destroy(s),je(s,(d,m,w)=>{St(d)?w[m]=He(m):m!=="guid"&&(w[m]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,H=null,h=null,s=null};function He(d){return()=>{throw new Error(`The "${d}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getPlugin=function(d){const m=Qn(d);return m==="UndoRedo"?this.undoRedo:S.getItem(m)},this.getPluginName=function(d){return d===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:S.getId(d)},this.getInstance=function(){return s},this.addHook=function(d,m){me.getSingleton().add(d,m,s)},this.hasHook=function(d){return me.getSingleton().has(d,s)||me.getSingleton().has(d)},this.addHookOnce=function(d,m){me.getSingleton().once(d,m,s)},this.removeHook=function(d,m){me.getSingleton().remove(d,m,s)},this.runHooks=function(d,m,w,x,O,A,K){return me.getSingleton().run(s,d,m,w,x,O,A,K)},this.getTranslatedPhrase=function(d,m){return kB(v.language,d,m)},this.toHTML=()=>z0(this),this.toTableElement=()=>{const d=this.rootDocument.createElement("div");return d.insertAdjacentHTML("afterbegin",z0(this)),d.firstElementChild},this.timeouts=[],this._registerTimeout=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=d;typeof w=="function"&&(w=setTimeout(w,m)),this.timeouts.push(w)},this._clearTimeouts=function(){P(this.timeouts,d=>{clearTimeout(d)})},this.immediates=[],this._registerImmediate=function(d){this.immediates.push(setImmediate(d))},this._clearImmediates=function(){P(this.immediates,d=>{clearImmediate(d)})},this._refreshBorders=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.destroyEditor(d),s.view.render(),m&&H.isSelected()&&h.prepareEditor()},this._getEditorManager=function(){return h},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const R=ioe({handleEvent(){return s.isListening()},beforeKeyDown:d=>this.runHooks("beforeKeyDown",d),afterKeyDown:d=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",d)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",d=>{d.ctrlKey===!1&&d.metaKey===!1&&R.releasePressedKeys()}),this.getShortcutManager=function(){return R},this.getFocusManager=function(){return f},PT().forEach(d=>{const m=Nf(d);S.addItem(d,new m(this))}),qie(s),R.setActiveContextName("grid"),me.getSingleton().run(s,"construct")}const ooe="hooksRefRegisterer",t2={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){P(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){je(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Oo(t2,"MIXIN_NAME",ooe,{writable:!1,enumerable:!1});const soe=t2;function _i(t,e,n){return e=aoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aoe(t){var e=loe(t,"string");return typeof e=="symbol"?e:String(e)}function loe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uoe="base",hn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),iR="baseEditor";class jc{static get EDITOR_TYPE(){return uoe}constructor(e){_i(this,"hot",void 0),_i(this,"state",hn.VIRGIN),_i(this,"_opened",!1),_i(this,"_fullEditMode",!1),_i(this,"_closeCallback",null),_i(this,"TD",null),_i(this,"row",null),_i(this,"col",null),_i(this,"prop",null),_i(this,"originalValue",null),_i(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=hn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const h=this.hot.getSelectedLast();r=Math.max(Math.min(h[0],h[2]),0),i=Math.max(Math.min(h[1],h[3]),0),o=Math.max(h[0],h[2]),s=Math.max(h[1],h[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>he(this.hot.getSelected()),group:iR};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==hn.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=hn.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:Yt(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let i;if(r){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),r(l),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(iR),s.removeShortcutsByGroup(Sv),this.state===hn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===hn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=hn.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=hn.FINISHED,this.discardEditor(l)}):(this.state=hn.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=hn.FINISHED,this.discardEditor()}discardEditor(e){this.state===hn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=hn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=hn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===hn.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=on(n),a=gt(n),l=on(this.hot.rootElement),u=gt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,f=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,p=o.innerWidth-l.left-u,{wtTable:y}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,E=y.name,v=["master","inline_start"].includes(E)?f:0,C=["master","top","bottom"].includes(E)?g:0,S=s.top===l.top?0:1;let T=s.top-l.top-S-v,_=0;this.hot.isRtl()?_=o.innerWidth-s.left-a-p-1+C:_=s.left-l.left-1-C,["top","top_inline_start_corner"].includes(E)&&(T+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(E)&&(_+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const H=this.hot.hasColHeaders(),D=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),B=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),G=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(H&&D<=0||D===G)&&(T+=1),B<=0&&(_+=1);const Z=i.rowsRenderCalculator.startPosition,re=i.columnsRenderCalculator.startPosition,ne=Math.abs(r.inlineStartOverlay.getScrollPosition()),ue=r.topOverlay.getScrollPosition(),Ee=yn(this.hot.rootDocument);let $e=n.offsetTop;if(["inline_start","master"].includes(E)&&($e+=Z-ue),["bottom","bottom_inline_start_corner"].includes(E)){const{wtViewport:J,wtTable:q}=r.bottomOverlay.clone;$e+=J.getWorkspaceHeight()-q.getHeight()-Ee}let He=n.offsetLeft;this.hot.isRtl()?(He>=0?He=y.getWidth()-n.offsetLeft:He=Math.abs(He),He+=re-ne-a):["top","master","bottom"].includes(E)&&(He+=re-ne);const R=Cs(this.TD,this.hot.rootWindow),d=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",m=parseInt(R[d],10)>0?0:1,w=parseInt(R.borderTopWidth,10)>0?0:1,x=gt(n)+m,O=Wt(n)+w,A=cV(c)?Ee:0,K=hV(h)?Ee:0,U=this.hot.view.maximumVisibleElementWidth(He)-A+m,Q=Math.max(this.hot.view.maximumVisibleElementHeight($e)-K+w,23);return{top:T,start:_,height:O,maxHeight:Q,width:x,maxWidth:U}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}vt(jc,soe);function coe(){var t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},e,n=document.body,r=document.createTextNode(""),i=document.createElement("SPAN"),o=function(f,g,p){f.addEventListener(g,p,!1)},s=function(f,g,p){f.removeEventListener(g,p,!1)},a=function(f){var g,p;f?/^[a-zA-Z \.,\\\/\|0-9]$/.test(f)||(f="."):f="",r.textContent!==void 0?r.textContent=e.value+f:r.data=e.value+f,i.style.position="absolute",i.style.fontSize=h(e).fontSize,i.style.fontFamily=h(e).fontFamily,i.style.whiteSpace="pre",n.appendChild(i),g=i.clientWidth+2,n.removeChild(i),e.style.height=t.minHeight+"px",t.minWidth>g?e.style.width=t.minWidth+"px":g>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=g+"px",p=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>p?e.style.height=t.minHeight+"px":t.maxHeight<p?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=p+"px"},l=function(){window.setTimeout(a,0)},u=function(f){if(f&&f.minHeight)if(f.minHeight=="inherit")t.minHeight=e.clientHeight;else{var g=parseInt(f.minHeight);isNaN(g)||(t.minHeight=g)}if(f&&f.maxHeight)if(f.maxHeight=="inherit")t.maxHeight=e.clientHeight;else{var p=parseInt(f.maxHeight);isNaN(p)||(t.maxHeight=p)}if(f&&f.minWidth)if(f.minWidth=="inherit")t.minWidth=e.clientWidth;else{var y=parseInt(f.minWidth);isNaN(y)||(t.minWidth=y)}if(f&&f.maxWidth)if(f.maxWidth=="inherit")t.maxWidth=e.clientWidth;else{var E=parseInt(f.maxWidth);isNaN(E)||(t.maxWidth=E)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))},c=function(f,g,p){e=f,u(g),e.nodeName=="TEXTAREA"&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),p&&(o(e,"change",a),o(e,"cut",l),o(e,"paste",l),o(e,"drop",l),o(e,"keydown",l),o(e,"focus",a),o(e,"compositionstart",l),o(e,"compositionupdate",l),o(e,"compositionend",l)),a()};function h(f){return f.currentStyle||document.defaultView.getComputedStyle(f)}return{init:function(f,g,p){c(f,g,p)},unObserve:function(){s(e,"change",a),s(e,"cut",l),s(e,"paste",l),s(e,"drop",l),s(e,"keydown",l),s(e,"focus",a),s(e,"compositionstart",l),s(e,"compositionupdate",l),s(e,"compositionend",l)},resize:a}}function cA(t,e){const n=mT(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}Af(e,i)}function Ga(t,e,n){return e=hoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hoe(t){var e=doe(t,"string");return typeof e=="symbol"?e:String(e)}function doe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const foe="ht_editor_visible",Ug="ht_editor_hidden",hA="textEditor",goe="text";class Jl extends jc{static get EDITOR_TYPE(){return goe}constructor(e){super(e),Ga(this,"eventManager",new Kr(this)),Ga(this,"autoResize",coe()),Ga(this,"TEXTAREA",void 0),Ga(this,"textareaStyle",void 0),Ga(this,"TEXTAREA_PARENT",void 0),Ga(this,"textareaParentStyle",void 0),Ga(this,"layerClass",void 0),this.eventManager=new Kr(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",n=>this.onAfterDocumentKeyDown(n)),this.registerShortcuts()}close(){this.autoResize.unObserve(),rV(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&(this.TEXTAREA.value=""),a!==hn.FINISHED&&this.hideEditableElement()}}beginEditing(e,n){this.state===hn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Af(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Re(this.TEXTAREA,[["data-hot-input",""],Vc(-1)]),this.hot.getSettings().ariaTags&&Re(this.TEXTAREA,[_s()]),te(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),te(this.TEXTAREA_PARENT,"handsontableInputHolder"),De(this.TEXTAREA_PARENT,this.layerClass)&&Le(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,Ug),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){TV()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Le(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,Ug)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;ye(e.length-1,r=>{const i=e[r];if(De(i,"handsontableEditor"))return n=!0,!1}),De(this.TEXTAREA_PARENT,Ug)&&Le(this.TEXTAREA_PARENT,Ug),n?(this.layerClass=foe,te(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),te(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==hn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=Cs(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=Cs(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),h=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),f=i-c,g=s-h,p=o-c,y=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(f,p),minHeight:Math.min(g,y),maxWidth:p,maxHeight:y},!0)}bindEvents(){RT()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===hn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===hn.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>he(this.hot.getSelected()),group:hA},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Tab"]],callback:o=>{const s=this.hot.getSettings(),a=typeof s.tabMoves=="function"?s.tabMoves(o):s.tabMoves;this.hot.selection.transformStart(a.row,a.col,!0)}},{keys:[["Shift","Tab"]],callback:o=>{const s=this.hot.getSettings(),a=typeof s.tabMoves=="function"?s.tabMoves(o):s.tabMoves;this.hot.selection.transformStart(-a.row,-a.col)}},{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;cA(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;cA(a,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}}],r)}unregisterShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");n.removeShortcutsByGroup(Sv),n.removeShortcutsByGroup(hA),n.removeShortcutsByGroup(iR)}onAfterDocumentKeyDown(e){[pe.ARROW_UP,pe.ARROW_RIGHT,pe.ARROW_DOWN,pe.ARROW_LEFT].indexOf(e.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}const moe="base";function Wf(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&te(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(qP())):a&&c.push(qP()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(QP())):(u.push(s.invalidCellClassName),a&&c.push(QP()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),Le(e,u),te(e,l),Ha(e,c),Re(e,h)}Wf.RENDERER_TYPE=moe;const poe="text";function Os(t,e,n,r,i,o,s){Wf.apply(this,[t,e,n,r,i,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Yt(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){Ki(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else Ea(e,a)}Os.RENDERER_TYPE=poe;const woe="text",n2={CELL_TYPE:woe,editor:Jl,renderer:Os};ri(n2);le.editors={BaseEditor:jc};function le(t,e){const n=new e2(t,e||{},QT);return n.init(),n}le.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new e2(t,e,QT)};le.DefaultSettings=YB();le.hooks=me.getSingleton();le.CellCoords=sw;le.CellRange=NT;le.packageName="handsontable";le.buildDate="08/11/2023 09:43:05";le.version="14.0.0-next-b24d538-20231108";le.languages={dictionaryKeys:$ne,getLanguageDictionary:NB,getLanguagesDictionaries:Une,registerLanguageDictionary:DB,getTranslatedPhrase:kB};function dA(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function voe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?dA(Object(n),!0).forEach(function(r){Coe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dA(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function sf(t){"@babel/helpers - typeof";return sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sf(t)}function Ac(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fA(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,i2(r.key),r)}}function Ic(t,e,n){return e&&fA(t.prototype,e),n&&fA(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Coe(t,e,n){return e=i2(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function af(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oR(t,e)}function hw(t){return hw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},hw(t)}function oR(t,e){return oR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},oR(t,e)}function yoe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function r2(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Soe(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r2(t)}function lf(t){var e=yoe();return function(){var r=hw(t),i;if(e){var o=hw(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return Soe(this,i)}}function boe(t){return Roe(t)||Eoe(t)||Toe(t)||_oe()}function Roe(t){if(Array.isArray(t))return sR(t)}function Eoe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Toe(t,e){if(t){if(typeof t=="string")return sR(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sR(t,e)}}function sR(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _oe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Moe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function i2(t){var e=Moe(t,"string");return typeof e=="symbol"?e:String(e)}var Uy=null,xoe="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",Poe="The Handsontable instance bound to this component was destroyed and cannot be used properly.",dw="global",Ooe="hot-wrapper-editor-container";function Aoe(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function aR(t,e){var n=dn.Children.toArray(t),r=dn.Children.count(t),i=null;return r!==0&&(r===1&&n[0].props[e]?i=n[0]:i=n.find(function(o){return o.props[e]!==void 0})),i||null}function o2(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function s2(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=arguments.length>1?arguments[1]:void 0;if(e===null)return null;var n=l2(e.props,!1);return n.className="".concat(Ooe," ").concat(n.className),oF.createPortal(dn.createElement("div",Object.assign({},n),e),t.body)}function a2(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:dw,r=aR(t,"hot-editor"),i=o2(r);return r?dn.cloneElement(r,{emitEditorInstance:function(s,a){e.get(i)||e.set(i,new Map);var l=e.get(i);l.set(a??dw,s)},editorColumnScope:n,isEditor:!0}):null}function Ioe(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;n||(n=document),Uy||(Uy=n.createDocumentFragment());var r=n.createElement("DIV");Uy.appendChild(r);var i=dn.cloneElement(t,voe({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:oF.createPortal(i,r,"".concat(e.row,"-").concat(e.col,"-").concat(Math.random())),portalContainer:r}}function l2(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}var u2=function(){function t(){Ac(this,t)}return Ic(t,null,[{key:"getSettings",value:function(n){var r={};if(n.settings){var i=n.settings;for(var o in i)i.hasOwnProperty(o)&&(r[o]=i[o])}for(var s in n)s!=="settings"&&s!=="children"&&n.hasOwnProperty(s)&&(r[s]=n[s]);return r}}]),t}(),ho=function(t){af(n,t);var e=lf(n);function n(){return Ac(this,n),e.apply(this,arguments)}return Ic(n,[{key:"getSettingsProps",value:function(){var i=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(o){return!i.internalProps.includes(o)}).reduce(function(o,s){return o[s]=i.props[s],o},{})}},{key:"getLocalEditorElement",value:function(){return a2(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var i=this.props._getChildElementByType(this.props.children,"hot-renderer"),o=this.getLocalEditorElement();this.columnSettings=u2.getSettings(this.getSettingsProps()),i!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(i),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),o!==null&&(this.columnSettings.editor=this.props._getEditorClass(o,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var i=this.props._getOwnerDocument(),o=s2(i,this.getLocalEditorElement());return dn.createElement(dn.Fragment,null,o)}}]),n}(dn.Component),Hoe=function(t){af(n,t);var e=lf(n);function n(){var r;return Ac(this,n),r=e.apply(this,arguments),r.state={portals:[]},r}return Ic(n,[{key:"render",value:function(){return dn.createElement(dn.Fragment,null,this.state.portals)}}]),n}(dn.Component),Doe="14.0.0-next-b24d538-20231108";function U_(t,e){return e={exports:{}},t(e,e.exports),e.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pn=typeof Symbol=="function"&&Symbol.for,z_=Pn?Symbol.for("react.element"):60103,G_=Pn?Symbol.for("react.portal"):60106,Iv=Pn?Symbol.for("react.fragment"):60107,Hv=Pn?Symbol.for("react.strict_mode"):60108,Dv=Pn?Symbol.for("react.profiler"):60114,Nv=Pn?Symbol.for("react.provider"):60109,kv=Pn?Symbol.for("react.context"):60110,j_=Pn?Symbol.for("react.async_mode"):60111,Lv=Pn?Symbol.for("react.concurrent_mode"):60111,$v=Pn?Symbol.for("react.forward_ref"):60112,Fv=Pn?Symbol.for("react.suspense"):60113,Noe=Pn?Symbol.for("react.suspense_list"):60120,Wv=Pn?Symbol.for("react.memo"):60115,Vv=Pn?Symbol.for("react.lazy"):60116,koe=Pn?Symbol.for("react.block"):60121,Loe=Pn?Symbol.for("react.fundamental"):60117,$oe=Pn?Symbol.for("react.responder"):60118,Foe=Pn?Symbol.for("react.scope"):60119;function Zr(t){if(sf(t)==="object"&&t!==null){var e=t.$$typeof;switch(e){case z_:switch(t=t.type,t){case j_:case Lv:case Iv:case Dv:case Hv:case Fv:return t;default:switch(t=t&&t.$$typeof,t){case kv:case $v:case Vv:case Wv:case Nv:return t;default:return e}}case G_:return e}}}function c2(t){return Zr(t)===Lv}var Woe=j_,Voe=Lv,Boe=kv,Uoe=Nv,zoe=z_,Goe=$v,joe=Iv,Yoe=Vv,Koe=Wv,Xoe=G_,qoe=Dv,Qoe=Hv,Zoe=Fv,Joe=function(e){return c2(e)||Zr(e)===j_},ese=c2,tse=function(e){return Zr(e)===kv},nse=function(e){return Zr(e)===Nv},rse=function(e){return sf(e)==="object"&&e!==null&&e.$$typeof===z_},ise=function(e){return Zr(e)===$v},ose=function(e){return Zr(e)===Iv},sse=function(e){return Zr(e)===Vv},ase=function(e){return Zr(e)===Wv},lse=function(e){return Zr(e)===G_},use=function(e){return Zr(e)===Dv},cse=function(e){return Zr(e)===Hv},hse=function(e){return Zr(e)===Fv},dse=function(e){return typeof e=="string"||typeof e=="function"||e===Iv||e===Lv||e===Dv||e===Hv||e===Fv||e===Noe||sf(e)==="object"&&e!==null&&(e.$$typeof===Vv||e.$$typeof===Wv||e.$$typeof===Nv||e.$$typeof===kv||e.$$typeof===$v||e.$$typeof===Loe||e.$$typeof===$oe||e.$$typeof===Foe||e.$$typeof===koe)},fse=Zr,gse={AsyncMode:Woe,ConcurrentMode:Voe,ContextConsumer:Boe,ContextProvider:Uoe,Element:zoe,ForwardRef:Goe,Fragment:joe,Lazy:Yoe,Memo:Koe,Portal:Xoe,Profiler:qoe,StrictMode:Qoe,Suspense:Zoe,isAsyncMode:Joe,isConcurrentMode:ese,isContextConsumer:tse,isContextProvider:nse,isElement:rse,isForwardRef:ise,isFragment:ose,isLazy:sse,isMemo:ase,isPortal:lse,isProfiler:use,isStrictMode:cse,isSuspense:hse,isValidElementType:dse,typeOf:fse},Ct=U_(function(t,e){});Ct.AsyncMode;Ct.ConcurrentMode;Ct.ContextConsumer;Ct.ContextProvider;Ct.Element;Ct.ForwardRef;Ct.Fragment;Ct.Lazy;Ct.Memo;Ct.Portal;Ct.Profiler;Ct.StrictMode;Ct.Suspense;Ct.isAsyncMode;Ct.isConcurrentMode;Ct.isContextConsumer;Ct.isContextProvider;Ct.isElement;Ct.isForwardRef;Ct.isFragment;Ct.isLazy;Ct.isMemo;Ct.isPortal;Ct.isProfiler;Ct.isStrictMode;Ct.isSuspense;Ct.isValidElementType;Ct.typeOf;U_(function(t){t.exports=gse});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var gA=Object.getOwnPropertySymbols,mse=Object.prototype.hasOwnProperty,pse=Object.prototype.propertyIsEnumerable;function wse(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function vse(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(e).map(function(o){return e[o]});if(r.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(o){i[o]=o}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}vse();var Cse="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",yse=Cse;Function.call.bind(Object.prototype.hasOwnProperty);function h2(){}function d2(){}d2.resetWarningCache=h2;var Sse=function(){function e(i,o,s,a,l,u){if(u!==yse){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function n(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:n,element:e,elementType:e,instanceOf:n,node:e,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:d2,resetWarningCache:h2};return r.PropTypes=r,r},bse=U_(function(t){t.exports=Sse()}),zy=bse,f2=function(t){af(n,t);var e=lf(n);function n(){var r;return Ac(this,n),r=e.apply(this,arguments),r.id=null,r.__hotInstance=null,r.hotElementRef=null,r.columnSettings=[],r.renderersPortalManager=null,r.portalCacheArray=[],r.renderedCellCache=new Map,r.editorCache=new Map,r.componentRendererColumns=new Map,r}return Ic(n,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(Poe),null)},set:function(i){this.__hotInstance=i}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(i){this.hotElementRef=i}},{key:"getRendererWrapper",value:function(i){var o=this;return function(s,a,l,u,c,h,f){var g=o.getRenderedCellCache();if(g.has("".concat(l,"-").concat(u))&&(a.innerHTML=g.get("".concat(l,"-").concat(u)).innerHTML),a&&!a.getAttribute("ghost-table")){for(var p=Ioe(i,{TD:a,row:l,col:u,prop:c,value:h,cellProperties:f,isRenderer:!0},a.ownerDocument),y=p.portal,E=p.portalContainer;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(E),o.portalCacheArray.push(y)}return g.set("".concat(l,"-").concat(u),a),a}}},{key:"getEditorClass",value:function(i){var o,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dw,a=o2(i),l=(o=this.getEditorCache().get(a))===null||o===void 0?void 0:o.get(s);return this.makeEditorClass(l)}},{key:"makeEditorClass",value:function(i){var o=function(s){af(l,s);var a=lf(l);function l(u){var c;return Ac(this,l),c=a.call(this,u),i.hotCustomEditorInstance=r2(c),c.editorComponent=i,c}return Ic(l,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),l}(le.editors.BaseEditor);return Object.getOwnPropertyNames(le.editors.BaseEditor.prototype).forEach(function(s){s!=="constructor"&&(o.prototype[s]=function(){for(var a,l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];return(a=i[s]).call.apply(a,[i].concat(u))})}),o}},{key:"getGlobalRendererElement",value:function(){return aR(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return a2(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var i=u2.getSettings(this.props),o=this.getGlobalRendererElement(),s=this.getGlobalEditorElement();return i.columns=this.columnSettings.length?this.columnSettings:i.columns,s?i.editor=this.getEditorClass(s,dw):i.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),o?(i.renderer=this.getRendererWrapper(o),this.componentRendererColumns.set("global",!0)):i.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),i}},{key:"displayAutoSizeWarning",value:function(i){var o,s;this.hotInstance&&((o=this.hotInstance.getPlugin("autoRowSize"))!==null&&o!==void 0&&o.enabled||(s=this.hotInstance.getPlugin("autoColumnSize"))!==null&&s!==void 0&&s.enabled)&&this.componentRendererColumns.size>0&&Aoe(xoe)}},{key:"setHotColumnSettings",value:function(i,o){this.columnSettings[o]=i}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var i=this;this.renderersPortalManager.setState({portals:boe(this.portalCacheArray)},function(){i.portalCacheArray=[]})}},{key:"updateHot",value:function(i){this.hotInstance&&this.hotInstance.updateSettings(i,!1)}},{key:"setRenderersPortalManagerRef",value:function(i){this.renderersPortalManager=i}},{key:"componentDidMount",value:function(){var i=this,o=this.createNewGlobalSettings();this.hotInstance=new le.Core(this.hotElementRef,o),this.hotInstance.addHook("beforeViewRender",function(){return i.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return i.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(o)}},{key:"componentDidUpdate",value:function(){this.clearCache();var i=this.createNewGlobalSettings();this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var i=this,o=l2(this.props),s=function(h){return h.type===ho},a=dn.Children.toArray(this.props.children),l=a.filter(function(c){return s(c)}).map(function(c,h){return dn.cloneElement(c,{_componentRendererColumns:i.componentRendererColumns,_emitColumnSettings:i.setHotColumnSettings.bind(i),_columnIndex:h,_getChildElementByType:aR.bind(i),_getRendererWrapper:i.getRendererWrapper.bind(i),_getEditorClass:i.getEditorClass.bind(i),_getOwnerDocument:i.getOwnerDocument.bind(i),_getEditorCache:i.getEditorCache.bind(i),children:c.props.children})}),u=s2(this.getOwnerDocument(),this.getGlobalEditorElement());return dn.createElement(dn.Fragment,null,dn.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},o),l),dn.createElement(Hoe,{ref:this.setRenderersPortalManagerRef.bind(this)}),u)}}],[{key:"version",get:function(){return Doe}}]),n}(dn.Component);f2.propTypes={style:zy.object,id:zy.string,className:zy.string};dn.Component;const mA="handsontableEditor",Rse="handsontable";class Y_ extends Jl{static get EDITOR_TYPE(){return Rse}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Af(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions(),this.hot.getSettings().ariaTags&&Re(this.TD,[xn("true")])}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Re(this.TD,[xn("false")])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&sn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:mA,relativeToGroup:Sv,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Ci(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(mA)}}function Ese(t,e,n){Tse(t,e),e.set(t,n)}function Tse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zg(t,e,n){return e=_se(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _se(t){var e=Mse(t,"string");return typeof e=="symbol"?e:String(e)}function Mse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pA(t,e){var n=xse(t,e,"get");return Pse(t,n)}function xse(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Pse(t,e){return e.get?e.get.call(t):e.value}const Ose="autocomplete";var Gy=new WeakMap;class K_ extends Y_{constructor(){super(...arguments),zg(this,"query",null),zg(this,"strippedChoices",[]),zg(this,"rawChoices",[]),Ese(this,Gy,{writable:!0,value:this.hot.guid.slice(0,9)}),zg(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=k0(Yt(n[c])),r)h=u.indexOf(e);else{const f=this.cellProperties.locale;h=u.toLocaleLowerCase(f).indexOf(e.toLocaleLowerCase(f))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((f,g)=>{if(g.index===-1)return-1;if(f.index===-1)return 1;if(f.index<g.index)return-1;if(g.index<f.index)return 1;if(f.index===g.index){if(f.charsLeft<g.charsLeft)return-1;if(f.charsLeft>g.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return Ose}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return he(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),te(this.htContainer,"autocompleteEditor"),te(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Re(this.TEXTAREA,[Gq(),Wq(),Bc("listbox"),qq()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&Re(this.TEXTAREA,[xn("false"),Qq(`${pA(this,Gy)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=yn();a===0&&tf()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[gt(this.TEXTAREA)-2]:void 0,width:e?gt(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,h,f,g,p)=>{Os(l,u,c,h,f,g,p);const{filteringCaseSensitive:y,allowHtml:E,locale:v}=this.cellProperties,C=this.query;let S=Yt(g),T,_;S&&!E&&(T=y===!0?S.indexOf(C):S.toLocaleLowerCase(v).indexOf(C.toLocaleLowerCase(v)),T!==-1&&(_=S.substr(T,C.length),S=S.replace(_,`<strong>${_}</strong>`))),n&&Re(u,[Vq(),...r?[tQ(i)]:[],...r?[nQ(r.indexOf(g)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${h}`]]),u.innerHTML=S},afterSelection:(l,u)=>{if(n){const c=this.htEditor.getCell(l,u,!0);Re(c,[L0()]),Re(this.TEXTAREA,...Zq(c.id))}}}),n&&(Re(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Fi()),Re(this.htEditor.rootElement,[ZW(),Jq("polite"),eQ("text"),["id",`${pA(this,Gy)}-listbox-${o}-${s}`]]),Re(this.TEXTAREA,...xn("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Re(this.TEXTAREA,[xn("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=mT(this.TEXTAREA),r=uV(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,f=l.length;h<f&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(gd([l])),l.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Af(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=$l(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const i=on(this.TEXTAREA),o=Wt(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=Wt(this.hot.view._wt.wtTable.THEAD),u=on(e),c=i.top-u.top-l+a,h=e.scrollHeight-c-l-o,f=s>h&&c>h;return f?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(f?c:h,s),f}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+yn(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ge(e,o=>Yt(o));return Ge(r,o=>n?o:k0(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===pe.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===pe.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(_V(e.keyCode)||e.keyCode===pe.BACKSPACE||e.keyCode===pe.DELETE||e.keyCode===pe.INSERT){let n=10;if(e.keyCode===pe.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const Ase="checkbox";class g2 extends jc{static get EDITOR_TYPE(){return Ase}beginEditing(e,n){if(n&&n.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');De(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var m2={exports:{}};const Ise=zk(Sq);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,e){(function(n,r){var i;{try{i=Ise}catch{}t.exports=r(i)}})(Wi,function(n){var r=typeof n=="function",i=!!window.addEventListener,o=window.document,s=window.setTimeout,a=function(R,d,m,w){i?R.addEventListener(d,m,!!w):R.attachEvent("on"+d,m)},l=function(R,d,m,w){i?R.removeEventListener(d,m,!!w):R.detachEvent("on"+d,m)},u=function(R){return R.trim?R.trim():R.replace(/^\s+|\s+$/g,"")},c=function(R,d){return(" "+R.className+" ").indexOf(" "+d+" ")!==-1},h=function(R,d){c(R,d)||(R.className=R.className===""?d:R.className+" "+d)},f=function(R,d){R.className=u((" "+R.className+" ").replace(" "+d+" "," "))},g=function(R){return/Array/.test(Object.prototype.toString.call(R))},p=function(R){return/Date/.test(Object.prototype.toString.call(R))&&!isNaN(R.getTime())},y=function(R){var d=R.getDay();return d===0||d===6},E=function(R){return R%4===0&&R%100!==0||R%400===0},v=function(R,d){return[31,E(R)?29:28,31,30,31,30,31,31,30,31,30,31][d]},C=function(R){p(R)&&R.setHours(0,0,0,0)},S=function(R,d){return R.getTime()===d.getTime()},T=function(R,d,m){var w,x;for(w in d)x=R[w]!==void 0,x&&typeof d[w]=="object"&&d[w]!==null&&d[w].nodeName===void 0?p(d[w])?m&&(R[w]=new Date(d[w].getTime())):g(d[w])?m&&(R[w]=d[w].slice(0)):R[w]=T({},d[w],m):(m||!x)&&(R[w]=d[w]);return R},_=function(R,d,m){var w;o.createEvent?(w=o.createEvent("HTMLEvents"),w.initEvent(d,!0,!1),w=T(w,m),R.dispatchEvent(w)):o.createEventObject&&(w=o.createEventObject(),w=T(w,m),R.fireEvent("on"+d,w))},H=function(R){return R.month<0&&(R.year-=Math.ceil(Math.abs(R.month)/12),R.month+=12),R.month>11&&(R.year+=Math.floor(Math.abs(R.month)/12),R.month-=12),R},D={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},B=function(R,d,m){for(d+=R.firstDay;d>=7;)d-=7;return m?R.i18n.weekdaysShort[d]:R.i18n.weekdays[d]},z=function(R){var d=[],m="false";if(R.isEmpty)if(R.showDaysInNextAndPreviousMonths)d.push("is-outside-current-month"),R.enableSelectionDaysInNextAndPreviousMonths||d.push("is-selection-disabled");else return'<td class="is-empty"></td>';return R.isDisabled&&d.push("is-disabled"),R.isToday&&d.push("is-today"),R.isSelected&&(d.push("is-selected"),m="true"),R.hasEvent&&d.push("has-event"),R.isInRange&&d.push("is-inrange"),R.isStartRange&&d.push("is-startrange"),R.isEndRange&&d.push("is-endrange"),'<td data-day="'+R.day+'" class="'+d.join(" ")+'" aria-selected="'+m+'"><button class="pika-button pika-day" type="button" data-pika-year="'+R.year+'" data-pika-month="'+R.month+'" data-pika-day="'+R.day+'">'+R.day+"</button></td>"},G=function(R,d){R.setHours(0,0,0,0);var m=R.getDate(),w=R.getDay(),x=d,O=x-1,A=7,K=function(fe){return(fe+A-1)%A};R.setDate(m+O-K(w));var U=new Date(R.getFullYear(),0,x),Q=24*60*60*1e3,J=(R.getTime()-U.getTime())/Q,q=1+Math.round((J-O+K(U.getDay()))/A);return q},Z=function(R,d,m,w){var x=new Date(m,d,R),O=r?n(x).isoWeek():G(x,w);return'<td class="pika-week">'+O+"</td>"},re=function(R,d,m,w){return'<tr class="pika-row'+(m?" pick-whole-week":"")+(w?" is-selected":"")+'">'+(d?R.reverse():R).join("")+"</tr>"},ne=function(R){return"<tbody>"+R.join("")+"</tbody>"},ue=function(R){var d,m=[];for(R.showWeekNumber&&m.push("<th></th>"),d=0;d<7;d++)m.push('<th scope="col"><abbr title="'+B(R,d)+'">'+B(R,d,!0)+"</abbr></th>");return"<thead><tr>"+(R.isRTL?m.reverse():m).join("")+"</tr></thead>"},Ee=function(R,d,m,w,x,O){var A,K,U,Q=R._o,J=m===Q.minYear,q=m===Q.maxYear,fe='<div id="'+O+'" class="pika-title" role="heading" aria-live="assertive">',Ae,Pe,Oe=!0,X=!0;for(U=[],A=0;A<12;A++)U.push('<option value="'+(m===x?A-d:12+A-d)+'"'+(A===w?' selected="selected"':"")+(J&&A<Q.minMonth||q&&A>Q.maxMonth?' disabled="disabled"':"")+">"+Q.i18n.months[A]+"</option>");for(Ae='<div class="pika-label">'+Q.i18n.months[w]+'<select class="pika-select pika-select-month" tabindex="-1">'+U.join("")+"</select></div>",g(Q.yearRange)?(A=Q.yearRange[0],K=Q.yearRange[1]+1):(A=m-Q.yearRange,K=1+m+Q.yearRange),U=[];A<K&&A<=Q.maxYear;A++)A>=Q.minYear&&U.push('<option value="'+A+'"'+(A===m?' selected="selected"':"")+">"+A+"</option>");return Pe='<div class="pika-label">'+m+Q.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+U.join("")+"</select></div>",Q.showMonthAfterYear?fe+=Pe+Ae:fe+=Ae+Pe,J&&(w===0||Q.minMonth>=w)&&(Oe=!1),q&&(w===11||Q.maxMonth<=w)&&(X=!1),d===0&&(fe+='<button class="pika-prev'+(Oe?"":" is-disabled")+'" type="button">'+Q.i18n.previousMonth+"</button>"),d===R._o.numberOfMonths-1&&(fe+='<button class="pika-next'+(X?"":" is-disabled")+'" type="button">'+Q.i18n.nextMonth+"</button>"),fe+="</div>"},$e=function(R,d,m){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+m+'">'+ue(R)+ne(d)+"</table>"},He=function(R){var d=this,m=d.config(R);d._onMouseDown=function(x){if(d._v){x=x||window.event;var O=x.target||x.srcElement;if(O)if(c(O,"is-disabled")||(c(O,"pika-button")&&!c(O,"is-empty")&&!c(O.parentNode,"is-disabled")?(d.setDate(new Date(O.getAttribute("data-pika-year"),O.getAttribute("data-pika-month"),O.getAttribute("data-pika-day"))),m.bound&&s(function(){d.hide(),m.blurFieldOnSelect&&m.field&&m.field.blur()},100)):c(O,"pika-prev")?d.prevMonth():c(O,"pika-next")&&d.nextMonth()),c(O,"pika-select"))d._c=!0;else if(x.preventDefault)x.preventDefault();else return x.returnValue=!1,!1}},d._onChange=function(x){x=x||window.event;var O=x.target||x.srcElement;O&&(c(O,"pika-select-month")?d.gotoMonth(O.value):c(O,"pika-select-year")&&d.gotoYear(O.value))},d._onKeyChange=function(x){if(x=x||window.event,d.isVisible())switch(x.keyCode){case 13:case 27:m.field&&m.field.blur();break;case 37:d.adjustDate("subtract",1);break;case 38:d.adjustDate("subtract",7);break;case 39:d.adjustDate("add",1);break;case 40:d.adjustDate("add",7);break;case 8:case 46:d.setDate(null);break}},d._parseFieldValue=function(){if(m.parse)return m.parse(m.field.value,m.format);if(r){var x=n(m.field.value,m.format,m.formatStrict);return x&&x.isValid()?x.toDate():null}else return new Date(Date.parse(m.field.value))},d._onInputChange=function(x){var O;x.firedBy!==d&&(O=d._parseFieldValue(),p(O)&&d.setDate(O),d._v||d.show())},d._onInputFocus=function(){d.show()},d._onInputClick=function(){d.show()},d._onInputBlur=function(){var x=o.activeElement;do if(c(x,"pika-single"))return;while(x=x.parentNode);d._c||(d._b=s(function(){d.hide()},50)),d._c=!1},d._onClick=function(x){x=x||window.event;var O=x.target||x.srcElement,A=O;if(O){!i&&c(O,"pika-select")&&(O.onchange||(O.setAttribute("onchange","return;"),a(O,"change",d._onChange)));do if(c(A,"pika-single")||A===m.trigger)return;while(A=A.parentNode);d._v&&O!==m.trigger&&A!==m.trigger&&d.hide()}},d.el=o.createElement("div"),d.el.className="pika-single"+(m.isRTL?" is-rtl":"")+(m.theme?" "+m.theme:""),a(d.el,"mousedown",d._onMouseDown,!0),a(d.el,"touchend",d._onMouseDown,!0),a(d.el,"change",d._onChange),m.keyboardInput&&a(o,"keydown",d._onKeyChange),m.field&&(m.container?m.container.appendChild(d.el):m.bound?o.body.appendChild(d.el):m.field.parentNode.insertBefore(d.el,m.field.nextSibling),a(m.field,"change",d._onInputChange),m.defaultDate||(m.defaultDate=d._parseFieldValue(),m.setDefaultDate=!0));var w=m.defaultDate;p(w)?m.setDefaultDate?d.setDate(w,!0):d.gotoDate(w):d.gotoDate(new Date),m.bound?(this.hide(),d.el.className+=" is-bound",a(m.trigger,"click",d._onInputClick),a(m.trigger,"focus",d._onInputFocus),a(m.trigger,"blur",d._onInputBlur)):this.show()};return He.prototype={config:function(R){this._o||(this._o=T({},D,!0));var d=T(this._o,R,!0);d.isRTL=!!d.isRTL,d.field=d.field&&d.field.nodeName?d.field:null,d.theme=typeof d.theme=="string"&&d.theme?d.theme:null,d.bound=!!(d.bound!==void 0?d.field&&d.bound:d.field),d.trigger=d.trigger&&d.trigger.nodeName?d.trigger:d.field,d.disableWeekends=!!d.disableWeekends,d.disableDayFn=typeof d.disableDayFn=="function"?d.disableDayFn:null;var m=parseInt(d.numberOfMonths,10)||1;if(d.numberOfMonths=m>4?4:m,p(d.minDate)||(d.minDate=!1),p(d.maxDate)||(d.maxDate=!1),d.minDate&&d.maxDate&&d.maxDate<d.minDate&&(d.maxDate=d.minDate=!1),d.minDate&&this.setMinDate(d.minDate),d.maxDate&&this.setMaxDate(d.maxDate),g(d.yearRange)){var w=new Date().getFullYear()-10;d.yearRange[0]=parseInt(d.yearRange[0],10)||w,d.yearRange[1]=parseInt(d.yearRange[1],10)||w}else d.yearRange=Math.abs(parseInt(d.yearRange,10))||D.yearRange,d.yearRange>100&&(d.yearRange=100);return d},toString:function(R){return R=R||this._o.format,p(this._d)?this._o.toString?this._o.toString(this._d,R):r?n(this._d).format(R):this._d.toDateString():""},getMoment:function(){return r?n(this._d):null},setMoment:function(R,d){r&&n.isMoment(R)&&this.setDate(R.toDate(),d)},getDate:function(){return p(this._d)?new Date(this._d.getTime()):null},setDate:function(R,d){if(!R)return this._d=null,this._o.field&&(this._o.field.value="",_(this._o.field,"change",{firedBy:this})),this.draw();if(typeof R=="string"&&(R=new Date(Date.parse(R))),!!p(R)){var m=this._o.minDate,w=this._o.maxDate;p(m)&&R<m?R=m:p(w)&&R>w&&(R=w),this._d=new Date(R.getTime()),C(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),_(this._o.field,"change",{firedBy:this})),!d&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(R){var d=!0;if(p(R)){if(this.calendars){var m=new Date(this.calendars[0].year,this.calendars[0].month,1),w=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),x=R.getTime();w.setMonth(w.getMonth()+1),w.setDate(w.getDate()-1),d=x<m.getTime()||w.getTime()<x}d&&(this.calendars=[{month:R.getMonth(),year:R.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(R,d){var m=this.getDate()||new Date,w=parseInt(d)*24*60*60*1e3,x;R==="add"?x=new Date(m.valueOf()+w):R==="subtract"&&(x=new Date(m.valueOf()-w)),this.setDate(x)},adjustCalendars:function(){this.calendars[0]=H(this.calendars[0]);for(var R=1;R<this._o.numberOfMonths;R++)this.calendars[R]=H({month:this.calendars[0].month+R,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(R){isNaN(R)||(this.calendars[0].month=parseInt(R,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(R){isNaN(R)||(this.calendars[0].year=parseInt(R,10),this.adjustCalendars())},setMinDate:function(R){R instanceof Date?(C(R),this._o.minDate=R,this._o.minYear=R.getFullYear(),this._o.minMonth=R.getMonth()):(this._o.minDate=D.minDate,this._o.minYear=D.minYear,this._o.minMonth=D.minMonth,this._o.startRange=D.startRange),this.draw()},setMaxDate:function(R){R instanceof Date?(C(R),this._o.maxDate=R,this._o.maxYear=R.getFullYear(),this._o.maxMonth=R.getMonth()):(this._o.maxDate=D.maxDate,this._o.maxYear=D.maxYear,this._o.maxMonth=D.maxMonth,this._o.endRange=D.endRange),this.draw()},setStartRange:function(R){this._o.startRange=R},setEndRange:function(R){this._o.endRange=R},draw:function(R){if(!(!this._v&&!R)){var d=this._o,m=d.minYear,w=d.maxYear,x=d.minMonth,O=d.maxMonth,A="",K;this._y<=m&&(this._y=m,!isNaN(x)&&this._m<x&&(this._m=x)),this._y>=w&&(this._y=w,!isNaN(O)&&this._m>O&&(this._m=O));for(var U=0;U<d.numberOfMonths;U++)K="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),A+='<div class="pika-lendar">'+Ee(this,U,this.calendars[U].year,this.calendars[U].month,this.calendars[0].year,K)+this.render(this.calendars[U].year,this.calendars[U].month,K)+"</div>";this.el.innerHTML=A,d.bound&&d.field.type!=="hidden"&&s(function(){d.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),d.bound&&d.field.setAttribute("aria-label",d.ariaLabel)}},adjustPosition:function(){var R,d,m,w,x,O,A,K,U,Q,J,q;if(!this._o.container){if(this.el.style.position="absolute",R=this._o.trigger,d=R,m=this.el.offsetWidth,w=this.el.offsetHeight,x=window.innerWidth||o.documentElement.clientWidth,O=window.innerHeight||o.documentElement.clientHeight,A=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,J=!0,q=!0,typeof R.getBoundingClientRect=="function")Q=R.getBoundingClientRect(),K=Q.left+window.pageXOffset,U=Q.bottom+window.pageYOffset;else for(K=d.offsetLeft,U=d.offsetTop+d.offsetHeight;d=d.offsetParent;)K+=d.offsetLeft,U+=d.offsetTop;(this._o.reposition&&K+m>x||this._o.position.indexOf("right")>-1&&K-m+R.offsetWidth>0)&&(K=K-m+R.offsetWidth,J=!1),(this._o.reposition&&U+w>O+A||this._o.position.indexOf("top")>-1&&U-w-R.offsetHeight>0)&&(U=U-w-R.offsetHeight,q=!1),this.el.style.left=K+"px",this.el.style.top=U+"px",h(this.el,J?"left-aligned":"right-aligned"),h(this.el,q?"bottom-aligned":"top-aligned"),f(this.el,J?"right-aligned":"left-aligned"),f(this.el,q?"top-aligned":"bottom-aligned")}},render:function(R,d,m){var w=this._o,x=new Date,O=v(R,d),A=new Date(R,d,1).getDay(),K=[],U=[];C(x),w.firstDay>0&&(A-=w.firstDay,A<0&&(A+=7));for(var Q=d===0?11:d-1,J=d===11?0:d+1,q=d===0?R-1:R,fe=d===11?R+1:R,Ae=v(q,Q),Pe=O+A,Oe=Pe;Oe>7;)Oe-=7;Pe+=7-Oe;for(var X=!1,Xe=0,Ue=0;Xe<Pe;Xe++){var _e=new Date(R,d,1+(Xe-A)),Ne=p(this._d)?S(_e,this._d):!1,Te=S(_e,x),b=w.events.indexOf(_e.toDateString())!==-1,M=Xe<A||Xe>=O+A,I=1+(Xe-A),V=d,N=R,W=w.startRange&&S(w.startRange,_e),k=w.endRange&&S(w.endRange,_e),L=w.startRange&&w.endRange&&w.startRange<_e&&_e<w.endRange,j=w.minDate&&_e<w.minDate||w.maxDate&&_e>w.maxDate||w.disableWeekends&&y(_e)||w.disableDayFn&&w.disableDayFn(_e);M&&(Xe<A?(I=Ae+I,V=Q,N=q):(I=I-O,V=J,N=fe));var F={day:I,month:V,year:N,hasEvent:b,isSelected:Ne,isToday:Te,isDisabled:j,isEmpty:M,isStartRange:W,isEndRange:k,isInRange:L,showDaysInNextAndPreviousMonths:w.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:w.enableSelectionDaysInNextAndPreviousMonths};w.pickWholeWeek&&Ne&&(X=!0),U.push(z(F)),++Ue===7&&(w.showWeekNumber&&U.unshift(Z(Xe-A,d,R,w.firstWeekOfYearMinDays)),K.push(re(U,w.isRTL,w.pickWholeWeek,X)),U=[],Ue=0,X=!1)}return $e(w,K,m)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),f(this.el,"is-hidden"),this._o.bound&&(a(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var R=this._v;R!==!1&&(this._o.bound&&l(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),h(this.el,"is-hidden"),this._v=!1,R!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var R=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),R.keyboardInput&&l(o,"keydown",this._onKeyChange),R.field&&(l(R.field,"change",this._onInputChange),R.bound&&(l(R.trigger,"click",this._onInputClick),l(R.trigger,"focus",this._onInputFocus),l(R.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},He})})(m2);var Hse=m2.exports;const wA=pf(Hse);function Gg(t,e,n){return e=Dse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dse(t){var e=Nse(t,"string");return typeof e=="symbol"?e:String(e)}function Nse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const p2="date",vA="dateEditor";class w2 extends Jl{constructor(){super(...arguments),Gg(this,"defaultDateFormat","DD/MM/YYYY"),Gg(this,"isCellEdited",!1),Gg(this,"parentDestroyed",!1),Gg(this,"$datePicker",null)}static get EDITOR_TYPE(){return p2}init(){if(typeof ee!="function")throw new Error("You need to include moment.js to your project.");if(typeof wA!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),te(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);const e=new Kr(this);e.addEventListener(this.datePicker,"mousedown",n=>{De(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()}),e.addEventListener(this.TEXTAREA,"keydown",n=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(n.code)&&n.preventDefault()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),this.hot.getSettings().ariaTags&&Re(this.TD,[xn("true")]),r.addShortcut({keys:[["Enter"]],callback:i=>{i.stopPropagation()},group:vA})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.TD&&this.hot.getSettings().ariaTags&&Re(this.TD,[xn("false")]),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(vA),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const r=this.originalValue;r!==void 0&&this.setValue(r)}super.finishEditing(e,n)}showDatepicker(e){const n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?TT(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new wA(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+n.top+Wt(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=n.right-gt(this.datePicker):a=n.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(s=this.originalValue,ee(s,r,!0).isValid()&&this.$datePicker.setMoment(ee(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,ee(s,r,!0).isValid()&&this.$datePicker.setMoment(ee(s,r),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&Df(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=ee(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}}const kse="dropdown";class X_ extends K_{static get EDITOR_TYPE(){return kse}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}me.getSingleton().add("beforeValidate",function(t,e,n){const r=this.getCellMeta(e,this.propToCol(n));r.editor===X_&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const Lse="numeric";class v2 extends Jl{static get EDITOR_TYPE(){return Lse}}const $se="password";class C2 extends Jl{static get EDITOR_TYPE(){return $se}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Ki(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const jy="ht_editor_visible",CA="selectEditor",Fse="select";class y2 extends jc{static get EDITOR_TYPE(){return Fse}init(){this.select=this.hot.rootDocument.createElement("SELECT"),te(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",De(this.select,jy)&&Le(this.select,jy),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Ki(this.select),je(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Ql(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==hn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",te(this.select,jy)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:CA};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(CA)}}const Wse="time";class S2 extends Jl{static get EDITOR_TYPE(){return Wse}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function Vse(){_r(jc),_r(K_),_r(g2),_r(w2),_r(X_),_r(Y_),_r(v2),_r(C2),_r(y2),_r(Jl),_r(S2)}const Bse="html";function q_(t,e,n,r,i,o,s){Wf.apply(this,[t,e,n,r,i,o,s]),Ql(e,o??"",!1)}q_.RENDERER_TYPE=Bse;const Use="autocomplete";function Yc(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?q_:Os,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(..._s()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),te(e,"htAutocomplete"),c&&e.setAttribute(...Bc("listbox")),!t.acArrowListener){const h=new Kr(t);t.acArrowListener=function(f){De(f.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Yc.RENDERER_TYPE=Use;const yA=new WeakMap,SA=new WeakMap,zse="htBadValue",Hc="data-row",Dc="data-col",Gse="checkboxRenderer",b2="checkbox";me.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===b2){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function Q_(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Wf.apply(this,[t,e,n,r,i,o,s]),jse(t);let u=Yse(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),Ki(e),o===s.checkedTemplate||Yt(o).toLocaleLowerCase(s.locale)===Yt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Yt(o).toLocaleLowerCase(s.locale)===Yt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:gn(o)?te(u,"noValue"):(u.style.display="none",te(u,zse),h=!0),Re(u,[[Hc,n],[Dc,r]]),l&&Re(u,[ba(u.checked?t.getTranslatedPhrase(__):t.getTranslatedPhrase(M_)),Xq(u.checked),Bq()]),!h&&c){let y="";if(c.value)y=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const v=t.getDataAtRowProp(n,c.property);y=v!==null?v:""}const E=Kse(a,y,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(E),e.appendChild(u)):(E.appendChild(u),u=E):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(E)):(E.insertBefore(u,E.firstChild),u=E))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),yA.has(t)||(yA.set(t,!0),f());function f(){const E=t.getShortcutManager().getContext("grid"),v={group:Gse};E.addShortcuts([{keys:[["space"]],callback:()=>(g(),!p())},{keys:[["enter"]],callback:()=>(g(),!p()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!p()),relativeToGroup:B_,position:"before"}],v)}function g(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const E=t.getSelectedRange();if(E)for(let v=0;v<E.length;v++){const{row:C,col:S}=E[v].getTopStartCorner(),{row:T,col:_}=E[v].getBottomEndCorner(),H=[];for(let D=C;D<=T;D+=1)for(let B=S;B<=_;B+=1){const z=t.getCellMeta(D,B);if(z.type!=="checkbox")return;if(z.readOnly===!0)continue;typeof z.checkedTemplate>"u"&&(z.checkedTemplate=!0),typeof z.uncheckedTemplate>"u"&&(z.uncheckedTemplate=!1);const G=t.getDataAtCell(D,B);y===!1?[z.checkedTemplate,z.checkedTemplate.toString()].includes(G)?H.push([D,B,z.uncheckedTemplate]):[z.uncheckedTemplate,z.uncheckedTemplate.toString(),null,void 0].includes(G)&&H.push([D,B,z.checkedTemplate]):H.push([D,B,z.uncheckedTemplate])}H.length>0&&t.setDataAtCell(H)}}function p(){const y=t.getSelectedRange();if(y){for(let E=0;E<y.length;E++){const v=y[E].getTopStartCorner(),C=y[E].getBottomEndCorner();for(let S=v.row;S<=C.row;S++)for(let T=v.col;T<=C.col;T++){const _=t.getCellMeta(S,T);if(_.type!=="checkbox")return!1;const H=t.getCell(S,T);if(H==null)return!0;if(H.querySelectorAll("input[type=checkbox]").length>0&&!_.readOnly)return!0}}return!1}}}Q_.RENDERER_TYPE=b2;function jse(t){let e=SA.get(t);if(!e){const{rootElement:n}=t;e=new Kr(t),e.addEventListener(n,"click",r=>qse(r,t)),e.addEventListener(n,"mouseup",r=>Xse(r,t)),e.addEventListener(n,"change",r=>Qse(r,t)),SA.set(t,e)}return e}function Yse(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Kse(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function Xse(t,e){const{target:n}=t;Z_(n)&&(!n.hasAttribute(Hc)||!n.hasAttribute(Dc)||setTimeout(e.listen,10))}function qse(t,e){const{target:n}=t;if(!Z_(n)||!n.hasAttribute(Hc)||!n.hasAttribute(Dc))return;const r=parseInt(n.getAttribute(Hc),10),i=parseInt(n.getAttribute(Dc),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function Qse(t,e){const{target:n}=t;if(!Z_(n)||!n.hasAttribute(Hc)||!n.hasAttribute(Dc))return;const r=parseInt(n.getAttribute(Hc),10),i=parseInt(n.getAttribute(Dc),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function Z_(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}function jg(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var R2={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(u,c){if(!i[u]){if(!r[u]){var h=typeof jg=="function"&&jg;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var g=i[u]={exports:{}};r[u][0].call(g.exports,function(p){return s(r[u][1][p]||p)},g,g.exports,n,r,i,o)}return i[u].exports}for(var a=typeof jg=="function"&&jg,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",f=1e14,g=14,p=9007199254740991,y=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],E=1e7,v=1e9;function C(z){var G=0|z;return 0<z||z===G?G:G-1}function S(z){for(var G,Z,re=1,ne=z.length,ue=z[0]+"";re<ne;){for(G=z[re++]+"",Z=g-G.length;Z--;G="0"+G);ue+=G}for(ne=ue.length;ue.charCodeAt(--ne)===48;);return ue.slice(0,ne+1||1)}function T(z,G){var Z,re,ne=z.c,ue=G.c,Ee=z.s,$e=G.s,He=z.e,R=G.e;if(!Ee||!$e)return null;if(Z=ne&&!ne[0],re=ue&&!ue[0],Z||re)return Z?re?0:-$e:Ee;if(Ee!=$e)return Ee;if(Z=Ee<0,re=He==R,!ne||!ue)return re?0:!ne^Z?1:-1;if(!re)return R<He^Z?1:-1;for($e=(He=ne.length)<(R=ue.length)?He:R,Ee=0;Ee<$e;Ee++)if(ne[Ee]!=ue[Ee])return ne[Ee]>ue[Ee]^Z?1:-1;return He==R?0:R<He^Z?1:-1}function _(z,G,Z,re){if(z<G||Z<z||z!==(z<0?l(z):u(z)))throw Error(c+(re||"Argument")+(typeof z=="number"?z<G||Z<z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(z))}function H(z){var G=z.c.length-1;return C(z.e/g)==G&&z.c[G]%2!=0}function D(z,G){return(1<z.length?z.charAt(0)+"."+z.slice(1):z)+(G<0?"e":"e+")+G}function B(z,G,Z){var re,ne;if(G<0){for(ne=Z+".";++G;ne+=Z);z=ne+z}else if(++G>(re=z.length)){for(ne=Z,G-=re;--G;ne+=Z);z+=ne}else G<re&&(z=z.slice(0,G)+"."+z.slice(G));return z}(s=function z(G){var Z,re,ne,ue,Ee,$e,He,R,d,m,w=X.prototype={constructor:X,toString:null,valueOf:null},x=new X(1),O=20,A=4,K=-7,U=21,Q=-1e7,J=1e7,q=!1,fe=1,Ae=0,Pe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Oe="0123456789abcdefghijklmnopqrstuvwxyz";function X(b,M){var I,V,N,W,k,L,j,F,Y=this;if(!(Y instanceof X))return new X(b,M);if(M==null){if(b instanceof X)return Y.s=b.s,Y.e=b.e,void(Y.c=(b=b.c)?b.slice():b);if((L=typeof b=="number")&&0*b==0){if(Y.s=1/b<0?(b=-b,-1):1,b===~~b){for(W=0,k=b;10<=k;k/=10,W++);return Y.e=W,void(Y.c=[b])}F=String(b)}else{if(F=String(b),!a.test(F))return ne(Y,F,L);Y.s=F.charCodeAt(0)==45?(F=F.slice(1),-1):1}-1<(W=F.indexOf("."))&&(F=F.replace(".","")),0<(k=F.search(/e/i))?(W<0&&(W=k),W+=+F.slice(k+1),F=F.substring(0,k)):W<0&&(W=F.length)}else{if(_(M,2,Oe.length,"Base"),F=String(b),M==10)return Ne(Y=new X(b instanceof X?b:F),O+Y.e+1,A);if(L=typeof b=="number"){if(0*b!=0)return ne(Y,F,L,M);if(Y.s=1/b<0?(F=F.slice(1),-1):1,X.DEBUG&&15<F.replace(/^0\.0*|\./,"").length)throw Error(h+b);L=!1}else Y.s=F.charCodeAt(0)===45?(F=F.slice(1),-1):1;for(I=Oe.slice(0,M),W=k=0,j=F.length;k<j;k++)if(I.indexOf(V=F.charAt(k))<0){if(V=="."){if(W<k){W=j;continue}}else if(!N&&(F==F.toUpperCase()&&(F=F.toLowerCase())||F==F.toLowerCase()&&(F=F.toUpperCase()))){N=!0,k=-1,W=0;continue}return ne(Y,String(b),L,M)}-1<(W=(F=re(F,M,10,Y.s)).indexOf("."))?F=F.replace(".",""):W=F.length}for(k=0;F.charCodeAt(k)===48;k++);for(j=F.length;F.charCodeAt(--j)===48;);if(F=F.slice(k,++j)){if(j-=k,L&&X.DEBUG&&15<j&&(p<b||b!==u(b)))throw Error(h+Y.s*b);if(J<(W=W-k-1))Y.c=Y.e=null;else if(W<Q)Y.c=[Y.e=0];else{if(Y.e=W,Y.c=[],k=(W+1)%g,W<0&&(k+=g),k<j){for(k&&Y.c.push(+F.slice(0,k)),j-=g;k<j;)Y.c.push(+F.slice(k,k+=g));F=F.slice(k),k=g-F.length}else k-=j;for(;k--;F+="0");Y.c.push(+F)}}else Y.c=[Y.e=0]}function Xe(b,M,I,V){var N,W,k,L,j;if(I==null?I=A:_(I,0,8),!b.c)return b.toString();if(N=b.c[0],k=b.e,M==null)j=S(b.c),j=V==1||V==2&&(k<=K||U<=k)?D(j,k):B(j,k,"0");else if(W=(b=Ne(new X(b),M,I)).e,L=(j=S(b.c)).length,V==1||V==2&&(M<=W||W<=K)){for(;L<M;j+="0",L++);j=D(j,W)}else if(M-=k,j=B(j,W,"0"),L<W+1){if(0<--M)for(j+=".";M--;j+="0");}else if(0<(M+=W-L))for(W+1==L&&(j+=".");M--;j+="0");return b.s<0&&N?"-"+j:j}function Ue(b,M){for(var I,V=1,N=new X(b[0]);V<b.length;V++){if(!(I=new X(b[V])).s){N=I;break}M.call(N,I)&&(N=I)}return N}function _e(b,M,I){for(var V=1,N=M.length;!M[--N];M.pop());for(N=M[0];10<=N;N/=10,V++);return(I=V+I*g-1)>J?b.c=b.e=null:b.c=I<Q?[b.e=0]:(b.e=I,M),b}function Ne(b,M,I,V){var N,W,k,L,j,F,Y,ae=b.c,ge=y;if(ae){e:{for(N=1,L=ae[0];10<=L;L/=10,N++);if((W=M-N)<0)W+=g,k=M,Y=(j=ae[F=0])/ge[N-k-1]%10|0;else if((F=l((W+1)/g))>=ae.length){if(!V)break e;for(;ae.length<=F;ae.push(0));j=Y=0,k=(W%=g)-g+(N=1)}else{for(j=L=ae[F],N=1;10<=L;L/=10,N++);Y=(k=(W%=g)-g+N)<0?0:j/ge[N-k-1]%10|0}if(V=V||M<0||ae[F+1]!=null||(k<0?j:j%ge[N-k-1]),V=I<4?(Y||V)&&(I==0||I==(b.s<0?3:2)):5<Y||Y==5&&(I==4||V||I==6&&(0<W?0<k?j/ge[N-k]:0:ae[F-1])%10&1||I==(b.s<0?8:7)),M<1||!ae[0])return ae.length=0,V?(M-=b.e+1,ae[0]=ge[(g-M%g)%g],b.e=-M||0):ae[0]=b.e=0,b;if(W==0?(ae.length=F,L=1,F--):(ae.length=F+1,L=ge[g-W],ae[F]=0<k?u(j/ge[N-k]%ge[k])*L:0),V)for(;;){if(F==0){for(W=1,k=ae[0];10<=k;k/=10,W++);for(k=ae[0]+=L,L=1;10<=k;k/=10,L++);W!=L&&(b.e++,ae[0]==f&&(ae[0]=1));break}if(ae[F]+=L,ae[F]!=f)break;ae[F--]=0,L=1}for(W=ae.length;ae[--W]===0;ae.pop());}b.e>J?b.c=b.e=null:b.e<Q&&(b.c=[b.e=0])}return b}function Te(b){var M,I=b.e;return I===null?b.toString():(M=S(b.c),M=I<=K||U<=I?D(M,I):B(M,I,"0"),b.s<0?"-"+M:M)}return X.clone=z,X.ROUND_UP=0,X.ROUND_DOWN=1,X.ROUND_CEIL=2,X.ROUND_FLOOR=3,X.ROUND_HALF_UP=4,X.ROUND_HALF_DOWN=5,X.ROUND_HALF_EVEN=6,X.ROUND_HALF_CEIL=7,X.ROUND_HALF_FLOOR=8,X.EUCLID=9,X.config=X.set=function(b){var M,I;if(b!=null){if(typeof b!="object")throw Error(c+"Object expected: "+b);if(b.hasOwnProperty(M="DECIMAL_PLACES")&&(_(I=b[M],0,v,M),O=I),b.hasOwnProperty(M="ROUNDING_MODE")&&(_(I=b[M],0,8,M),A=I),b.hasOwnProperty(M="EXPONENTIAL_AT")&&((I=b[M])&&I.pop?(_(I[0],-v,0,M),_(I[1],0,v,M),K=I[0],U=I[1]):(_(I,-v,v,M),K=-(U=I<0?-I:I))),b.hasOwnProperty(M="RANGE"))if((I=b[M])&&I.pop)_(I[0],-v,-1,M),_(I[1],1,v,M),Q=I[0],J=I[1];else{if(_(I,-v,v,M),!I)throw Error(c+M+" cannot be zero: "+I);Q=-(J=I<0?-I:I)}if(b.hasOwnProperty(M="CRYPTO")){if((I=b[M])!==!!I)throw Error(c+M+" not true or false: "+I);if(I){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw q=!I,Error(c+"crypto unavailable");q=I}else q=I}if(b.hasOwnProperty(M="MODULO_MODE")&&(_(I=b[M],0,9,M),fe=I),b.hasOwnProperty(M="POW_PRECISION")&&(_(I=b[M],0,v,M),Ae=I),b.hasOwnProperty(M="FORMAT")){if(typeof(I=b[M])!="object")throw Error(c+M+" not an object: "+I);Pe=I}if(b.hasOwnProperty(M="ALPHABET")){if(typeof(I=b[M])!="string"||/^.$|[+-.\s]|(.).*\1/.test(I))throw Error(c+M+" invalid: "+I);Oe=I}}return{DECIMAL_PLACES:O,ROUNDING_MODE:A,EXPONENTIAL_AT:[K,U],RANGE:[Q,J],CRYPTO:q,MODULO_MODE:fe,POW_PRECISION:Ae,FORMAT:Pe,ALPHABET:Oe}},X.isBigNumber=function(b){return b instanceof X||b&&b._isBigNumber===!0||!1},X.maximum=X.max=function(){return Ue(arguments,w.lt)},X.minimum=X.min=function(){return Ue(arguments,w.gt)},X.random=(ue=9007199254740992,Ee=Math.random()*ue&2097151?function(){return u(Math.random()*ue)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(b){var M,I,V,N,W,k=0,L=[],j=new X(x);if(b==null?b=O:_(b,0,v),N=l(b/g),q)if(crypto.getRandomValues){for(M=crypto.getRandomValues(new Uint32Array(N*=2));k<N;)9e15<=(W=131072*M[k]+(M[k+1]>>>11))?(I=crypto.getRandomValues(new Uint32Array(2)),M[k]=I[0],M[k+1]=I[1]):(L.push(W%1e14),k+=2);k=N/2}else{if(!crypto.randomBytes)throw q=!1,Error(c+"crypto unavailable");for(M=crypto.randomBytes(N*=7);k<N;)9e15<=(W=281474976710656*(31&M[k])+1099511627776*M[k+1]+4294967296*M[k+2]+16777216*M[k+3]+(M[k+4]<<16)+(M[k+5]<<8)+M[k+6])?crypto.randomBytes(7).copy(M,k):(L.push(W%1e14),k+=7);k=N/7}if(!q)for(;k<N;)(W=Ee())<9e15&&(L[k++]=W%1e14);for(N=L[--k],b%=g,N&&b&&(W=y[g-b],L[k]=u(N/W)*W);L[k]===0;L.pop(),k--);if(k<0)L=[V=0];else{for(V=-1;L[0]===0;L.splice(0,1),V-=g);for(k=1,W=L[0];10<=W;W/=10,k++);k<g&&(V-=g-k)}return j.e=V,j.c=L,j}),X.sum=function(){for(var b=1,M=arguments,I=new X(M[0]);b<M.length;)I=I.plus(M[b++]);return I},re=function(){var b="0123456789";function M(I,V,N,W){for(var k,L,j=[0],F=0,Y=I.length;F<Y;){for(L=j.length;L--;j[L]*=V);for(j[0]+=W.indexOf(I.charAt(F++)),k=0;k<j.length;k++)j[k]>N-1&&(j[k+1]==null&&(j[k+1]=0),j[k+1]+=j[k]/N|0,j[k]%=N)}return j.reverse()}return function(I,V,N,W,k){var L,j,F,Y,ae,ge,be,Ie,Ve=I.indexOf("."),Et=O,Ze=A;for(0<=Ve&&(Y=Ae,Ae=0,I=I.replace(".",""),ge=(Ie=new X(V)).pow(I.length-Ve),Ae=Y,Ie.c=M(B(S(ge.c),ge.e,"0"),10,N,b),Ie.e=Ie.c.length),F=Y=(be=M(I,V,N,k?(L=Oe,b):(L=b,Oe))).length;be[--Y]==0;be.pop());if(!be[0])return L.charAt(0);if(Ve<0?--F:(ge.c=be,ge.e=F,ge.s=W,be=(ge=Z(ge,Ie,Et,Ze,N)).c,ae=ge.r,F=ge.e),Ve=be[j=F+Et+1],Y=N/2,ae=ae||j<0||be[j+1]!=null,ae=Ze<4?(Ve!=null||ae)&&(Ze==0||Ze==(ge.s<0?3:2)):Y<Ve||Ve==Y&&(Ze==4||ae||Ze==6&&1&be[j-1]||Ze==(ge.s<0?8:7)),j<1||!be[0])I=ae?B(L.charAt(1),-Et,L.charAt(0)):L.charAt(0);else{if(be.length=j,ae)for(--N;++be[--j]>N;)be[j]=0,j||(++F,be=[1].concat(be));for(Y=be.length;!be[--Y];);for(Ve=0,I="";Ve<=Y;I+=L.charAt(be[Ve++]));I=B(I,F,L.charAt(0))}return I}}(),Z=function(){function b(V,N,W){var k,L,j,F,Y=0,ae=V.length,ge=N%E,be=N/E|0;for(V=V.slice();ae--;)Y=((L=ge*(j=V[ae]%E)+(k=be*j+(F=V[ae]/E|0)*ge)%E*E+Y)/W|0)+(k/E|0)+be*F,V[ae]=L%W;return Y&&(V=[Y].concat(V)),V}function M(V,N,W,k){var L,j;if(W!=k)j=k<W?1:-1;else for(L=j=0;L<W;L++)if(V[L]!=N[L]){j=V[L]>N[L]?1:-1;break}return j}function I(V,N,W,k){for(var L=0;W--;)V[W]-=L,L=V[W]<N[W]?1:0,V[W]=L*k+V[W]-N[W];for(;!V[0]&&1<V.length;V.splice(0,1));}return function(V,N,W,k,L){var j,F,Y,ae,ge,be,Ie,Ve,Et,Ze,dt,Ht,nu,qc,Qt,On,ka,nr=V.s==N.s?1:-1,mn=V.c,_t=N.c;if(!(mn&&mn[0]&&_t&&_t[0]))return new X(V.s&&N.s&&(mn?!_t||mn[0]!=_t[0]:_t)?mn&&mn[0]==0||!_t?0*nr:nr/0:NaN);for(Et=(Ve=new X(nr)).c=[],nr=W+(F=V.e-N.e)+1,L||(L=f,F=C(V.e/g)-C(N.e/g),nr=nr/g|0),Y=0;_t[Y]==(mn[Y]||0);Y++);if(_t[Y]>(mn[Y]||0)&&F--,nr<0)Et.push(1),ae=!0;else{for(qc=mn.length,On=_t.length,nr+=2,1<(ge=u(L/(_t[Y=0]+1)))&&(_t=b(_t,ge,L),mn=b(mn,ge,L),On=_t.length,qc=mn.length),nu=On,dt=(Ze=mn.slice(0,On)).length;dt<On;Ze[dt++]=0);ka=_t.slice(),ka=[0].concat(ka),Qt=_t[0],_t[1]>=L/2&&Qt++;do{if(ge=0,(j=M(_t,Ze,On,dt))<0){if(Ht=Ze[0],On!=dt&&(Ht=Ht*L+(Ze[1]||0)),1<(ge=u(Ht/Qt)))for(L<=ge&&(ge=L-1),Ie=(be=b(_t,ge,L)).length,dt=Ze.length;M(be,Ze,Ie,dt)==1;)ge--,I(be,On<Ie?ka:_t,Ie,L),Ie=be.length,j=1;else ge==0&&(j=ge=1),Ie=(be=_t.slice()).length;if(Ie<dt&&(be=[0].concat(be)),I(Ze,be,dt,L),dt=Ze.length,j==-1)for(;M(_t,Ze,On,dt)<1;)ge++,I(Ze,On<dt?ka:_t,dt,L),dt=Ze.length}else j===0&&(ge++,Ze=[0]);Et[Y++]=ge,Ze[0]?Ze[dt++]=mn[nu]||0:(Ze=[mn[nu]],dt=1)}while((nu++<qc||Ze[0]!=null)&&nr--);ae=Ze[0]!=null,Et[0]||Et.splice(0,1)}if(L==f){for(Y=1,nr=Et[0];10<=nr;nr/=10,Y++);Ne(Ve,W+(Ve.e=Y+F*g-1)+1,k,ae)}else Ve.e=F,Ve.r=+ae;return Ve}}(),$e=/^(-?)0([xbo])(?=\w[\w.]*$)/i,He=/^([^.]+)\.$/,R=/^\.([^.]+)$/,d=/^-?(Infinity|NaN)$/,m=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ne=function(b,M,I,V){var N,W=I?M:M.replace(m,"");if(d.test(W))b.s=isNaN(W)?null:W<0?-1:1,b.c=b.e=null;else{if(!I&&(W=W.replace($e,function(k,L,j){return N=(j=j.toLowerCase())=="x"?16:j=="b"?2:8,V&&V!=N?k:L}),V&&(N=V,W=W.replace(He,"$1").replace(R,"0.$1")),M!=W))return new X(W,N);if(X.DEBUG)throw Error(c+"Not a"+(V?" base "+V:"")+" number: "+M);b.c=b.e=b.s=null}},w.absoluteValue=w.abs=function(){var b=new X(this);return b.s<0&&(b.s=1),b},w.comparedTo=function(b,M){return T(this,new X(b,M))},w.decimalPlaces=w.dp=function(b,M){var I,V,N;if(b!=null)return _(b,0,v),M==null?M=A:_(M,0,8),Ne(new X(this),b+this.e+1,M);if(!(I=this.c))return null;if(V=((N=I.length-1)-C(this.e/g))*g,N=I[N])for(;N%10==0;N/=10,V--);return V<0&&(V=0),V},w.dividedBy=w.div=function(b,M){return Z(this,new X(b,M),O,A)},w.dividedToIntegerBy=w.idiv=function(b,M){return Z(this,new X(b,M),0,1)},w.exponentiatedBy=w.pow=function(b,M){var I,V,N,W,k,L,j,F,Y=this;if((b=new X(b)).c&&!b.isInteger())throw Error(c+"Exponent not an integer: "+Te(b));if(M!=null&&(M=new X(M)),k=14<b.e,!Y.c||!Y.c[0]||Y.c[0]==1&&!Y.e&&Y.c.length==1||!b.c||!b.c[0])return F=new X(Math.pow(+Te(Y),k?2-H(b):+Te(b))),M?F.mod(M):F;if(L=b.s<0,M){if(M.c?!M.c[0]:!M.s)return new X(NaN);(V=!L&&Y.isInteger()&&M.isInteger())&&(Y=Y.mod(M))}else{if(9<b.e&&(0<Y.e||Y.e<-1||(Y.e==0?1<Y.c[0]||k&&24e7<=Y.c[1]:Y.c[0]<8e13||k&&Y.c[0]<=9999975e7)))return W=Y.s<0&&H(b)?-0:0,-1<Y.e&&(W=1/W),new X(L?1/W:W);Ae&&(W=l(Ae/g+2))}for(j=k?(I=new X(.5),L&&(b.s=1),H(b)):(N=Math.abs(+Te(b)))%2,F=new X(x);;){if(j){if(!(F=F.times(Y)).c)break;W?F.c.length>W&&(F.c.length=W):V&&(F=F.mod(M))}if(N){if((N=u(N/2))===0)break;j=N%2}else if(Ne(b=b.times(I),b.e+1,1),14<b.e)j=H(b);else{if((N=+Te(b))==0)break;j=N%2}Y=Y.times(Y),W?Y.c&&Y.c.length>W&&(Y.c.length=W):V&&(Y=Y.mod(M))}return V?F:(L&&(F=x.div(F)),M?F.mod(M):W?Ne(F,Ae,A,void 0):F)},w.integerValue=function(b){var M=new X(this);return b==null?b=A:_(b,0,8),Ne(M,M.e+1,b)},w.isEqualTo=w.eq=function(b,M){return T(this,new X(b,M))===0},w.isFinite=function(){return!!this.c},w.isGreaterThan=w.gt=function(b,M){return 0<T(this,new X(b,M))},w.isGreaterThanOrEqualTo=w.gte=function(b,M){return(M=T(this,new X(b,M)))===1||M===0},w.isInteger=function(){return!!this.c&&C(this.e/g)>this.c.length-2},w.isLessThan=w.lt=function(b,M){return T(this,new X(b,M))<0},w.isLessThanOrEqualTo=w.lte=function(b,M){return(M=T(this,new X(b,M)))===-1||M===0},w.isNaN=function(){return!this.s},w.isNegative=function(){return this.s<0},w.isPositive=function(){return 0<this.s},w.isZero=function(){return!!this.c&&this.c[0]==0},w.minus=function(b,M){var I,V,N,W,k=this,L=k.s;if(M=(b=new X(b,M)).s,!L||!M)return new X(NaN);if(L!=M)return b.s=-M,k.plus(b);var j=k.e/g,F=b.e/g,Y=k.c,ae=b.c;if(!j||!F){if(!Y||!ae)return Y?(b.s=-M,b):new X(ae?k:NaN);if(!Y[0]||!ae[0])return ae[0]?(b.s=-M,b):new X(Y[0]?k:A==3?-0:0)}if(j=C(j),F=C(F),Y=Y.slice(),L=j-F){for((N=(W=L<0)?(L=-L,Y):(F=j,ae)).reverse(),M=L;M--;N.push(0));N.reverse()}else for(V=(W=(L=Y.length)<(M=ae.length))?L:M,L=M=0;M<V;M++)if(Y[M]!=ae[M]){W=Y[M]<ae[M];break}if(W&&(N=Y,Y=ae,ae=N,b.s=-b.s),0<(M=(V=ae.length)-(I=Y.length)))for(;M--;Y[I++]=0);for(M=f-1;L<V;){if(Y[--V]<ae[V]){for(I=V;I&&!Y[--I];Y[I]=M);--Y[I],Y[V]+=f}Y[V]-=ae[V]}for(;Y[0]==0;Y.splice(0,1),--F);return Y[0]?_e(b,Y,F):(b.s=A==3?-1:1,b.c=[b.e=0],b)},w.modulo=w.mod=function(b,M){var I,V,N=this;return b=new X(b,M),!N.c||!b.s||b.c&&!b.c[0]?new X(NaN):!b.c||N.c&&!N.c[0]?new X(N):(fe==9?(V=b.s,b.s=1,I=Z(N,b,0,3),b.s=V,I.s*=V):I=Z(N,b,0,fe),(b=N.minus(I.times(b))).c[0]||fe!=1||(b.s=N.s),b)},w.multipliedBy=w.times=function(b,M){var I,V,N,W,k,L,j,F,Y,ae,ge,be,Ie,Ve,Et,Ze=this,dt=Ze.c,Ht=(b=new X(b,M)).c;if(!(dt&&Ht&&dt[0]&&Ht[0]))return!Ze.s||!b.s||dt&&!dt[0]&&!Ht||Ht&&!Ht[0]&&!dt?b.c=b.e=b.s=null:(b.s*=Ze.s,dt&&Ht?(b.c=[0],b.e=0):b.c=b.e=null),b;for(V=C(Ze.e/g)+C(b.e/g),b.s*=Ze.s,(j=dt.length)<(ae=Ht.length)&&(Ie=dt,dt=Ht,Ht=Ie,N=j,j=ae,ae=N),N=j+ae,Ie=[];N--;Ie.push(0));for(Ve=f,Et=E,N=ae;0<=--N;){for(I=0,ge=Ht[N]%Et,be=Ht[N]/Et|0,W=N+(k=j);N<W;)I=((F=ge*(F=dt[--k]%Et)+(L=be*F+(Y=dt[k]/Et|0)*ge)%Et*Et+Ie[W]+I)/Ve|0)+(L/Et|0)+be*Y,Ie[W--]=F%Ve;Ie[W]=I}return I?++V:Ie.splice(0,1),_e(b,Ie,V)},w.negated=function(){var b=new X(this);return b.s=-b.s||null,b},w.plus=function(b,M){var I,V=this,N=V.s;if(M=(b=new X(b,M)).s,!N||!M)return new X(NaN);if(N!=M)return b.s=-M,V.minus(b);var W=V.e/g,k=b.e/g,L=V.c,j=b.c;if(!W||!k){if(!L||!j)return new X(N/0);if(!L[0]||!j[0])return j[0]?b:new X(L[0]?V:0*N)}if(W=C(W),k=C(k),L=L.slice(),N=W-k){for((I=0<N?(k=W,j):(N=-N,L)).reverse();N--;I.push(0));I.reverse()}for((N=L.length)-(M=j.length)<0&&(I=j,j=L,L=I,M=N),N=0;M;)N=(L[--M]=L[M]+j[M]+N)/f|0,L[M]=f===L[M]?0:L[M]%f;return N&&(L=[N].concat(L),++k),_e(b,L,k)},w.precision=w.sd=function(b,M){var I,V,N;if(b!=null&&b!==!!b)return _(b,1,v),M==null?M=A:_(M,0,8),Ne(new X(this),b,M);if(!(I=this.c))return null;if(V=(N=I.length-1)*g+1,N=I[N]){for(;N%10==0;N/=10,V--);for(N=I[0];10<=N;N/=10,V++);}return b&&this.e+1>V&&(V=this.e+1),V},w.shiftedBy=function(b){return _(b,-p,p),this.times("1e"+b)},w.squareRoot=w.sqrt=function(){var b,M,I,V,N,W=this,k=W.c,L=W.s,j=W.e,F=O+4,Y=new X("0.5");if(L!==1||!k||!k[0])return new X(!L||L<0&&(!k||k[0])?NaN:k?W:1/0);if((I=(L=Math.sqrt(+Te(W)))==0||L==1/0?(((M=S(k)).length+j)%2==0&&(M+="0"),L=Math.sqrt(+M),j=C((j+1)/2)-(j<0||j%2),new X(M=L==1/0?"1e"+j:(M=L.toExponential()).slice(0,M.indexOf("e")+1)+j)):new X(L+"")).c[0]){for((L=(j=I.e)+F)<3&&(L=0);;)if(N=I,I=Y.times(N.plus(Z(W,N,F,1))),S(N.c).slice(0,L)===(M=S(I.c)).slice(0,L)){if(I.e<j&&--L,(M=M.slice(L-3,L+1))!="9999"&&(V||M!="4999")){+M&&(+M.slice(1)||M.charAt(0)!="5")||(Ne(I,I.e+O+2,1),b=!I.times(I).eq(W));break}if(!V&&(Ne(N,N.e+O+2,0),N.times(N).eq(W))){I=N;break}F+=4,L+=4,V=1}}return Ne(I,I.e+O+1,A,b)},w.toExponential=function(b,M){return b!=null&&(_(b,0,v),b++),Xe(this,b,M,1)},w.toFixed=function(b,M){return b!=null&&(_(b,0,v),b=b+this.e+1),Xe(this,b,M)},w.toFormat=function(b,M,I){var V;if(I==null)b!=null&&M&&typeof M=="object"?(I=M,M=null):b&&typeof b=="object"?(I=b,b=M=null):I=Pe;else if(typeof I!="object")throw Error(c+"Argument not an object: "+I);if(V=this.toFixed(b,M),this.c){var N,W=V.split("."),k=+I.groupSize,L=+I.secondaryGroupSize,j=I.groupSeparator||"",F=W[0],Y=W[1],ae=this.s<0,ge=ae?F.slice(1):F,be=ge.length;if(L&&(N=k,k=L,be-=L=N),0<k&&0<be){for(N=be%k||k,F=ge.substr(0,N);N<be;N+=k)F+=j+ge.substr(N,k);0<L&&(F+=j+ge.slice(N)),ae&&(F="-"+F)}V=Y?F+(I.decimalSeparator||"")+((L=+I.fractionGroupSize)?Y.replace(new RegExp("\\d{"+L+"}\\B","g"),"$&"+(I.fractionGroupSeparator||"")):Y):F}return(I.prefix||"")+V+(I.suffix||"")},w.toFraction=function(b){var M,I,V,N,W,k,L,j,F,Y,ae,ge,be=this,Ie=be.c;if(b!=null&&(!(L=new X(b)).isInteger()&&(L.c||L.s!==1)||L.lt(x)))throw Error(c+"Argument "+(L.isInteger()?"out of range: ":"not an integer: ")+Te(L));if(!Ie)return new X(be);for(M=new X(x),F=I=new X(x),V=j=new X(x),ge=S(Ie),W=M.e=ge.length-be.e-1,M.c[0]=y[(k=W%g)<0?g+k:k],b=!b||0<L.comparedTo(M)?0<W?M:F:L,k=J,J=1/0,L=new X(ge),j.c[0]=0;Y=Z(L,M,0,1),(N=I.plus(Y.times(V))).comparedTo(b)!=1;)I=V,V=N,F=j.plus(Y.times(N=F)),j=N,M=L.minus(Y.times(N=M)),L=N;return N=Z(b.minus(I),V,0,1),j=j.plus(N.times(F)),I=I.plus(N.times(V)),j.s=F.s=be.s,ae=Z(F,V,W*=2,A).minus(be).abs().comparedTo(Z(j,I,W,A).minus(be).abs())<1?[F,V]:[j,I],J=k,ae},w.toNumber=function(){return+Te(this)},w.toPrecision=function(b,M){return b!=null&&_(b,1,v),Xe(this,b,M,2)},w.toString=function(b){var M,I=this,V=I.s,N=I.e;return N===null?V?(M="Infinity",V<0&&(M="-"+M)):M="NaN":(M=b==null?N<=K||U<=N?D(S(I.c),N):B(S(I.c),N,"0"):b===10?B(S((I=Ne(new X(I),O+N+1,A)).c),I.e,"0"):(_(b,2,Oe.length,"Base"),re(B(S(I.c),N,"0"),10,b,V,!0)),V<0&&I.c[0]&&(M="-"+M)),M},w.valueOf=w.toJSON=function(){return Te(this)},w._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(w[Symbol.toStringTag]="BigNumber",w[Symbol.for("nodejs.util.inspect.custom")]=w.valueOf),G!=null&&X.set(G),X}()).default=s.BigNumber=s,r!==void 0&&r.exports?r.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(n,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,r,i){function o(C,S){return function(T){if(Array.isArray(T))return T}(C)||function(T,_){var H=[],D=!0,B=!1,z=void 0;try{for(var G,Z=T[Symbol.iterator]();!(D=(G=Z.next()).done)&&(H.push(G.value),!_||H.length!==_);D=!0);}catch(re){B=!0,z=re}finally{try{D||Z.return==null||Z.return()}finally{if(B)throw z}}return H}(C,S)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=n("./globalState"),a=n("./validating"),l=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function f(C){var S=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},T=2<arguments.length?arguments[2]:void 0;if(typeof S=="string"&&(S=l.parseFormat(S)),!a.validateFormat(S))return"ERROR: invalid format";var _=S.prefix||"",H=S.postfix||"",D=function(B,z,G){switch(z.output){case"currency":return z=v(z,s.currentCurrencyDefaultFormat()),function(Oe,X,Xe){var Ue=Xe.currentCurrency(),_e=Object.assign({},h,X),Ne=void 0,Te="",b=!!_e.totalLength||!!_e.forceAverage||_e.average,M=X.currencyPosition||Ue.position,I=X.currencySymbol||Ue.symbol;_e.spaceSeparated&&(Te=" "),M==="infix"&&(Ne=Te+I+Te);var V=E({instance:Oe,providedFormat:X,state:Xe,decimalSeparator:Ne});return M==="prefix"&&(V=Oe._value<0&&_e.negative==="sign"?"-".concat(Te).concat(I).concat(V.slice(1)):I+Te+V),M&&M!=="postfix"||(V=V+(Te=b?"":Te)+I),V}(B,z,s);case"percent":return z=v(z,s.currentPercentageDefaultFormat()),function(Oe,X,Xe,Ue){var _e=X.prefixSymbol,Ne=E({instance:Ue(100*Oe._value),providedFormat:X,state:Xe}),Te=Object.assign({},h,X);return _e?"%".concat(Te.spaceSeparated?" ":"").concat(Ne):"".concat(Ne).concat(Te.spaceSeparated?" ":"","%")}(B,z,s,G);case"byte":return z=v(z,s.currentByteDefaultFormat()),x=B,A=s,K=G,U=(O=z).base||"binary",Q=c[U],J=g(x._value,Q.suffixes,Q.scale),q=J.value,fe=J.suffix,Ae=E({instance:K(q),providedFormat:O,state:A,defaults:A.currentByteDefaultFormat()}),Pe=A.currentAbbreviations(),"".concat(Ae).concat(Pe.spaced?" ":"").concat(fe);case"time":return z=v(z,s.currentTimeDefaultFormat()),R=B,d=Math.floor(R._value/60/60),m=Math.floor((R._value-60*d*60)/60),w=Math.round(R._value-60*d*60-60*m),"".concat(d,":").concat(m<10?"0":"").concat(m,":").concat(w<10?"0":"").concat(w);case"ordinal":return z=v(z,s.currentOrdinalDefaultFormat()),Z=B,re=z,ue=(ne=s).currentOrdinal(),Ee=Object.assign({},h,re),$e=E({instance:Z,providedFormat:re,state:ne}),He=ue(Z._value),"".concat($e).concat(Ee.spaceSeparated?" ":"").concat(He);case"number":default:return E({instance:B,providedFormat:z,numbro:G})}var Z,re,ne,ue,Ee,$e,He,R,d,m,w,x,O,A,K,U,Q,J,q,fe,Ae,Pe}(C,S,T);return D=(D=_+D)+H}function g(C,S,T){var _=S[0],H=Math.abs(C);if(T<=H){for(var D=1;D<S.length;++D){var B=Math.pow(T,D),z=Math.pow(T,D+1);if(B<=H&&H<z){_=S[D],C/=B;break}}_===S[0]&&(C/=Math.pow(T,S.length-1),_=S[S.length-1])}return{value:C,suffix:_}}function p(C){for(var S="",T=0;T<C;T++)S+="0";return S}function y(C,S){return C.toString().indexOf("e")!==-1?function(T,_){var H=T.toString(),D=o(H.split("e"),2),B=D[0],z=D[1],G=o(B.split("."),2),Z=G[0],re=G[1],ne=re===void 0?"":re;if(0<+z)H=Z+ne+p(z-ne.length);else{var ue=".";ue=+Z<0?"-0".concat(ue):"0".concat(ue);var Ee=(p(-z-1)+Math.abs(Z)+ne).substr(0,_);Ee.length<_&&(Ee+=p(_-Ee.length)),H=ue+Ee}return 0<+z&&0<_&&(H+=".".concat(p(_))),H}(C,S):(Math.round(+"".concat(C,"e+").concat(S))/Math.pow(10,S)).toFixed(S)}function E(C){var S=C.instance,T=C.providedFormat,_=C.state,H=_===void 0?s:_,D=C.decimalSeparator,B=C.defaults,z=B===void 0?H.currentDefaults():B,G=S._value;if(G===0&&H.hasZeroFormat())return H.getZeroFormat();if(!isFinite(G))return G.toString();var Z,re,ne,ue,Ee,$e,He,R,d=Object.assign({},h,z,T),m=d.totalLength,w=m?0:d.characteristic,x=d.optionalCharacteristic,O=d.forceAverage,A=!!m||!!O||d.average,K=m?-1:A&&T.mantissa===void 0?0:d.mantissa,U=!m&&(T.optionalMantissa===void 0?K===-1:d.optionalMantissa),Q=d.trimMantissa,J=d.thousandSeparated,q=d.spaceSeparated,fe=d.negative,Ae=d.forceSign,Pe=d.exponential,Oe="";if(A){var X=function(b){var M=b.value,I=b.forceAverage,V=b.abbreviations,N=b.spaceSeparated,W=N!==void 0&&N,k=b.totalLength,L=k===void 0?0:k,j="",F=Math.abs(M),Y=-1;if(F>=Math.pow(10,12)&&!I||I==="trillion"?(j=V.trillion,M/=Math.pow(10,12)):F<Math.pow(10,12)&&F>=Math.pow(10,9)&&!I||I==="billion"?(j=V.billion,M/=Math.pow(10,9)):F<Math.pow(10,9)&&F>=Math.pow(10,6)&&!I||I==="million"?(j=V.million,M/=Math.pow(10,6)):(F<Math.pow(10,6)&&F>=Math.pow(10,3)&&!I||I==="thousand")&&(j=V.thousand,M/=Math.pow(10,3)),j&&(j=(W?" ":"")+j),L){var ae=M.toString().split(".")[0];Y=Math.max(L-ae.length,0)}return{value:M,abbreviation:j,mantissaPrecision:Y}}({value:G,forceAverage:O,abbreviations:H.currentAbbreviations(),spaceSeparated:q,totalLength:m});G=X.value,Oe+=X.abbreviation,m&&(K=X.mantissaPrecision)}if(Pe){var Xe=(re=(Z={value:G,characteristicPrecision:w}).value,ne=Z.characteristicPrecision,ue=ne===void 0?0:ne,Ee=o(re.toExponential().split("e"),2),$e=Ee[0],He=Ee[1],R=+$e,ue&&1<ue&&(R*=Math.pow(10,ue-1),He=0<=(He=+He-(ue-1))?"+".concat(He):He),{value:R,abbreviation:"e".concat(He)});G=Xe.value,Oe=Xe.abbreviation+Oe}var Ue,_e,Ne,Te=function(b,M,I,V,N){if(V===-1)return b;var W=y(M,V),k=o(W.toString().split("."),2),L=k[0],j=k[1],F=j===void 0?"":j;if(F.match(/^0+$/)&&(I||N))return L;var Y=F.match(/0+$/);return N&&Y?"".concat(L,".").concat(F.toString().slice(0,Y.index)):W.toString()}(G.toString(),G,U,K,Q);return Te=function(b,M,I,V,N){var W=V.currentDelimiters(),k=W.thousands;N=N||W.decimal;var L=W.thousandsSize||3,j=b.toString(),F=j.split(".")[0],Y=j.split(".")[1];return I&&(M<0&&(F=F.slice(1)),function(ae,ge){for(var be=[],Ie=0,Ve=ae;0<Ve;Ve--)Ie===ge&&(be.unshift(Ve),Ie=0),Ie++;return be}(F.length,L).forEach(function(ae,ge){F=F.slice(0,ae+ge)+k+F.slice(ae+ge)}),M<0&&(F="-".concat(F))),j=Y?F+N+Y:F}(Te=function(b,M,I,V){var N=b,W=o(N.toString().split("."),2),k=W[0],L=W[1];if(k.match(/^-?0$/)&&I)return L?"".concat(k.replace("0",""),".").concat(L):k.replace("0","");if(k.length<V)for(var j=V-k.length,F=0;F<j;F++)N="0".concat(N);return N.toString()}(Te,0,x,w),G,J,H,D),(A||Pe)&&(Te=Te+Oe),(Ae||G<0)&&(Ue=Te,Ne=fe,Te=(_e=G)===0?Ue:+Ue==0?Ue.replace("-",""):0<_e?"+".concat(Ue):Ne==="sign"?Ue:"(".concat(Ue.replace("-",""),")")),Te}function v(C,S){if(!C)return S;var T=Object.keys(C);return T.length===1&&T[0]==="output"?S:C}r.exports=function(C){return{format:function(){for(var S=arguments.length,T=new Array(S),_=0;_<S;_++)T[_]=arguments[_];return f.apply(void 0,T.concat([C]))},getByteUnit:function(){for(var S=arguments.length,T=new Array(S),_=0;_<S;_++)T[_]=arguments[_];return(function(H){var D=c.general;return g(H._value,D.suffixes,D.scale).suffix}).apply(void 0,T.concat([C]))},getBinaryByteUnit:function(){for(var S=arguments.length,T=new Array(S),_=0;_<S;_++)T[_]=arguments[_];return(function(H){var D=c.binary;return g(H._value,D.suffixes,D.scale).suffix}).apply(void 0,T.concat([C]))},getDecimalByteUnit:function(){for(var S=arguments.length,T=new Array(S),_=0;_<S;_++)T[_]=arguments[_];return(function(H){var D=c.decimal;return g(H._value,D.suffixes,D.scale).suffix}).apply(void 0,T.concat([C]))},formatOrDefault:v}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,r,i){var o=n("./en-US"),s=n("./validating"),a=n("./parsing"),l={},u=void 0,c={},h=null,f={};function g(y){u=y}function p(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return p().currency},l.currentAbbreviations=function(){return p().abbreviations},l.currentDelimiters=function(){return p().delimiters},l.currentOrdinal=function(){return p().ordinal},l.currentDefaults=function(){return Object.assign({},p().defaults,f)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().timeFormat)},l.setDefaults=function(y){y=a.parseFormat(y),s.validateFormat(y)&&(f=y)},l.getZeroFormat=function(){return h},l.setZeroFormat=function(y){return h=typeof y=="string"?y:null},l.hasZeroFormat=function(){return h!==null},l.languageData=function(y){if(y){if(c[y])return c[y];throw new Error('Unknown tag "'.concat(y,'"'))}return p()},l.registerLanguage=function(y){var E=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(y))throw new Error("Invalid language data");c[y.languageTag]=y,E&&g(y.languageTag)},l.setLanguage=function(y){var E=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[y]){var v=y.split("-")[0],C=Object.keys(c).find(function(S){return S.split("-")[0]===v});return c[C]?void g(C):void g(E)}g(y)},l.registerLanguage(o),u=o.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,r,i){r.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(l){var u=void 0;try{u=n("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(n,r,i){var o=n("bignumber.js");function s(a,l,u){var c=new o(a._value),h=l;return u.isNumbro(l)&&(h=l._value),h=new o(h),a._value=c.minus(h).toNumber(),a}r.exports=function(a){return{add:function(l,u){return h=u,f=a,g=new o((c=l)._value),p=h,f.isNumbro(h)&&(p=h._value),p=new o(p),c._value=g.plus(p).toNumber(),c;var c,h,f,g,p},subtract:function(l,u){return s(l,u,a)},multiply:function(l,u){return h=u,f=a,g=new o((c=l)._value),p=h,f.isNumbro(h)&&(p=h._value),p=new o(p),c._value=g.times(p).toNumber(),c;var c,h,f,g,p},divide:function(l,u){return h=u,f=a,g=new o((c=l)._value),p=h,f.isNumbro(h)&&(p=h._value),p=new o(p),c._value=g.dividedBy(p).toNumber(),c;var c,h,f,g,p},set:function(l,u){return c=l,f=h=u,a.isNumbro(h)&&(f=h._value),c._value=f,c;var c,h,f},difference:function(l,u){return c=u,s(f=(h=a)(l._value),c,h),Math.abs(f._value);var c,h,f}}}},{"bignumber.js":1}],7:[function(n,r,i){function o(E,v){for(var C=0;C<v.length;C++){var S=v[C];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(E,S.key,S)}}var s=n("./globalState"),a=n("./validating"),l=n("./loading")(y),u=n("./unformatting"),c=n("./formatting")(y),h=n("./manipulating")(y),f=n("./parsing"),g=function(){function E(S){(function(T,_){if(!(T instanceof _))throw new TypeError("Cannot call a class as a function")})(this,E),this._value=S}var v,C;return v=E,(C=[{key:"clone",value:function(){return y(this._value)}},{key:"format",value:function(){var S=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,S)}},{key:"formatCurrency",value:function(S){return typeof S=="string"&&(S=f.parseFormat(S)),(S=c.formatOrDefault(S,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,S)}},{key:"formatTime",value:function(){var S=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return S.output="time",c.format(this,S)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(S){return h.difference(this,S)}},{key:"add",value:function(S){return h.add(this,S)}},{key:"subtract",value:function(S){return h.subtract(this,S)}},{key:"multiply",value:function(S){return h.multiply(this,S)}},{key:"divide",value:function(S){return h.divide(this,S)}},{key:"set",value:function(S){return h.set(this,p(S))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(v.prototype,C),E}();function p(E){var v=E;return y.isNumbro(E)?v=E._value:typeof E=="string"?v=y.unformat(E):isNaN(E)&&(v=NaN),v}function y(E){return new g(p(E))}y.version="2.1.2",y.isNumbro=function(E){return E instanceof g},y.language=s.currentLanguage,y.registerLanguage=s.registerLanguage,y.setLanguage=s.setLanguage,y.languages=s.languages,y.languageData=s.languageData,y.zeroFormat=s.setZeroFormat,y.defaultFormat=s.currentDefaults,y.setDefaults=s.setDefaults,y.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,y.validate=a.validate,y.loadLanguagesInNode=l.loadLanguagesInNode,y.unformat=u.unformat,r.exports=y},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,r,i){r.exports={parseFormat:function(o){var s,a,l,u,c,h,f,g,p,y,E,v,C,S,T,_,H,D,B,z,G=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=G,o=(l=(s=o).match(/^{([^}]*)}/))?(a.prefix=l[1],s.slice(l[0].length)):s,c=G,function(Z,re){if(Z.indexOf("$")===-1){if(Z.indexOf("%")===-1)return Z.indexOf("bd")!==-1?(re.output="byte",re.base="general"):Z.indexOf("b")!==-1?(re.output="byte",re.base="binary"):Z.indexOf("d")!==-1?(re.output="byte",re.base="decimal"):Z.indexOf(":")===-1?Z.indexOf("o")!==-1&&(re.output="ordinal"):re.output="time";re.output="percent"}else re.output="currency"}(o=(h=(u=o).match(/{([^}]*)}$/))?(c.postfix=h[1],u.slice(0,-h[0].length)):u,G),f=G,(g=o.match(/[1-9]+[0-9]*/))&&(f.totalLength=+g[0]),p=G,(y=o.split(".")[0].match(/0+/))&&(p.characteristic=y[0].length),function(Z,re){if(Z.indexOf(".")!==-1){var ne=Z.split(".")[0];re.optionalCharacteristic=ne.indexOf("0")===-1}}(o,G),E=G,o.indexOf("a")!==-1&&(E.average=!0),C=G,(v=o).indexOf("K")!==-1?C.forceAverage="thousand":v.indexOf("M")!==-1?C.forceAverage="million":v.indexOf("B")!==-1?C.forceAverage="billion":v.indexOf("T")!==-1&&(C.forceAverage="trillion"),function(Z,re){var ne=Z.split(".")[1];if(ne){var ue=ne.match(/0+/);ue&&(re.mantissa=ue[0].length)}}(o,G),T=G,(S=o).match(/\[\.]/)?T.optionalMantissa=!0:S.match(/\./)&&(T.optionalMantissa=!1),_=G,o.indexOf(",")!==-1&&(_.thousandSeparated=!0),H=G,o.indexOf(" ")!==-1&&(H.spaceSeparated=!0),B=G,(D=o).match(/^\+?\([^)]*\)$/)&&(B.negative="parenthesis"),D.match(/^\+?-/)&&(B.negative="sign"),z=G,o.match(/^\+/)&&(z.forceSign=!0),G)}}},{}],9:[function(n,r,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<arguments.length?arguments[5]:void 0,p=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===f?0:function y(E,v){var C=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",S=3<arguments.length?arguments[3]:void 0,T=4<arguments.length?arguments[4]:void 0,_=5<arguments.length?arguments[5]:void 0,H=6<arguments.length?arguments[6]:void 0;if(!isNaN(+E))return+E;var D="",B=E.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(B!==E)return-1*y(B,v,C,S,T,_,H);for(var z=0;z<o.length;z++){var G=o[z];if((D=E.replace(G.key,""))!==E)return y(D,v,C,S,T,_,H)*G.factor}if((D=E.replace("%",""))!==E)return y(D,v,C,S,T,_,H)/100;var Z=parseFloat(E);if(!isNaN(Z)){var re=S(Z);if(re&&re!=="."&&(D=E.replace(new RegExp("".concat(s(re),"$")),""))!==E)return y(D,v,C,S,T,_,H);var ne={};Object.keys(_).forEach(function(m){ne[_[m]]=m});for(var ue=Object.keys(ne).sort().reverse(),Ee=ue.length,$e=0;$e<Ee;$e++){var He=ue[$e],R=ne[He];if((D=E.replace(He,""))!==E){var d=void 0;switch(R){case"thousand":d=Math.pow(10,3);break;case"million":d=Math.pow(10,6);break;case"billion":d=Math.pow(10,9);break;case"trillion":d=Math.pow(10,12)}return y(D,v,C,S,T,_,H)*d}}}}(function(y,E){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",C=y.replace(v,"");return C=(C=C.replace(new RegExp("([0-9])".concat(s(E.thousands),"([0-9])"),"g"),"$1$2")).replace(E.decimal,".")}(l,u,c),u,c,h,f,g,p)}r.exports={unformat:function(l,u){var c,h,f,g=n("./globalState"),p=g.currentDelimiters(),y=g.currentCurrency().symbol,E=g.currentOrdinal(),v=g.getZeroFormat(),C=g.currentAbbreviations(),S=void 0;if(typeof l=="string")S=function(T,_){if(!T.indexOf(":")||_.thousands===":")return!1;var H=T.split(":");if(H.length!==3)return!1;var D=+H[0],B=+H[1],z=+H[2];return!isNaN(D)&&!isNaN(B)&&!isNaN(z)}(l,p)?(c=l.split(":"),h=+c[0],f=+c[1],+c[2]+60*f+3600*h):a(l,p,y,E,v,C,u);else{if(typeof l!="number")return;S=l}if(S!==void 0)return S}}},{"./globalState":4}],10:[function(n,r,i){function o(p){return function(y){if(Array.isArray(y)){for(var E=0,v=new Array(y.length);E<y.length;E++)v[E]=y[E];return v}}(p)||function(y){if(Symbol.iterator in Object(y)||Object.prototype.toString.call(y)==="[object Arguments]")return Array.from(y)}(p)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(p){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(p)}var a=n("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(p,y){return y.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(p){return p.output==="byte"}},characteristic:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(p){return 0<=p},message:"value must be positive"},{restriction:function(p,y){return!y.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(p,y){return y.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(p){return p.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(p){return!!a.unformat(p)}function f(p,y,E){var v=3<arguments.length&&arguments[3]!==void 0&&arguments[3],C=Object.keys(p).map(function(S){if(!y[S])return console.error("".concat(E," Invalid key: ").concat(S)),!1;var T=p[S],_=y[S];if(typeof _=="string"&&(_={type:_}),_.type==="format"){if(!f(T,u,"[Validate ".concat(S,"]"),!0))return!1}else if(s(T)!==_.type)return console.error("".concat(E," ").concat(S,' type mismatched: "').concat(_.type,'" expected, "').concat(s(T),'" provided')),!1;if(_.restrictions&&_.restrictions.length)for(var H=_.restrictions.length,D=0;D<H;D++){var B=_.restrictions[D],z=B.restriction,G=B.message;if(!z(T,p))return console.error("".concat(E," ").concat(S," invalid value: ").concat(G)),!1}return _.restriction&&!_.restriction(T,p)?(console.error("".concat(E," ").concat(S," invalid value: ").concat(_.message)),!1):_.validValues&&_.validValues.indexOf(T)===-1?(console.error("".concat(E," ").concat(S," invalid value: must be among ").concat(JSON.stringify(_.validValues),', "').concat(T,'" provided')),!1):!(_.children&&!f(T,_.children,"[Validate ".concat(S,"]")))});return v||C.push.apply(C,o(Object.keys(y).map(function(S){var T=y[S];if(typeof T=="string"&&(T={type:T}),T.mandatory){var _=T.mandatory;if(typeof _=="function"&&(_=_(p)),_&&p[S]===void 0)return console.error("".concat(E,' Missing mandatory key "').concat(S,'"')),!1}return!0}))),C.reduce(function(S,T){return S&&T},!0)}function g(p){return f(p,u,"[Validate format]")}r.exports={validate:function(p,y){var E=h(p),v=g(y);return E&&v},validateFormat:g,validateInput:h,validateLanguage:function(p){return f(p,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(R2);var Zse=R2.exports;const ja=pf(Zse),Jse="numeric";function J_(t,e,n,r,i,o,s){let a=o;if(dr(a)){const l=s.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,h=s.className||"",f=h.length?h.split(" "):[];if(typeof u<"u"&&!ja.languages()[u]){const g=u.replace("-",""),p=ja.allLanguages?ja.allLanguages[u]:ja[g];p&&ja.registerLanguage(p)}ja.setLanguage(u),a=ja(a).format(c||"0"),f.indexOf("htLeft")<0&&f.indexOf("htCenter")<0&&f.indexOf("htRight")<0&&f.indexOf("htJustify")<0&&f.push("htRight"),f.indexOf("htNumeric")<0&&f.push("htNumeric"),s.className=f.join(" "),e.dir="ltr"}Os(t,e,n,r,i,a,s)}J_.RENDERER_TYPE=Jse;const eae="password";function eM(t,e,n,r,i,o,s){Os.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";ye(a-1,()=>{u+=l}),Ql(e,u)}eM.RENDERER_TYPE=eae;const tae="time";function tM(t,e,n,r,i,o,s){Os.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}tM.RENDERER_TYPE=tae;function nae(){mo(Yc),mo(Wf),mo(Q_),mo(q_),mo(J_),mo(eM),mo(Os),mo(tM)}const rae="autocomplete";function Bv(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,bA(n,e)):bA(n,e)(this.source):e(!0)}Bv.VALIDATOR_TYPE=rae;function bA(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function E2(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const iae=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:E2},Symbol.toStringTag,{value:"Module"})),oae="date";function nM(t,e){const n=IV(p2,this.instance);let r=t,i=!0;r==null&&(r="");let o=ee(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=ee(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=sae(r,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),i=!0}else i=!1;e(i)}nM.VALIDATOR_TYPE=oae;function sae(t,e){const n=ee(E2(t)),r=ee(t,e),i=t.search(/[A-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const aae="numeric";function rM(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:dr(t))}rM.VALIDATOR_TYPE=aae;const lae=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],uae="time";function iM(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=ee(i,lae,!0).isValid()?ee(i):ee(i,n);let a=s.isValid(),l=ee(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n),c=this.instance.toVisualRow(this.row),h=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,h,u,"timeValidator"),r=!0}else r=!1;e(r)}iM.VALIDATOR_TYPE=uae;function cae(){ac(Bv),ac(nM),ac(rM),ac(iM)}const hae="autocomplete",dae={CELL_TYPE:hae,editor:K_,renderer:Yc,validator:Bv},fae="checkbox",gae={CELL_TYPE:fae,editor:g2,renderer:Q_},mae="date";function T2(t,e,n,r,i,o,s){Yc.apply(this,[t,e,n,r,i,o,s]),t.getSettings().ariaTags&&Re(e,[Bc("dialog"),xn("false")])}T2.RENDERER_TYPE=mae;const pae="date",wae={CELL_TYPE:pae,editor:w2,renderer:T2,validator:nM},vae="dropdown",Cae={CELL_TYPE:vae,editor:X_,renderer:Yc,validator:Bv},yae="handsontable";function _2(t,e,n,r,i,o,s){Yc.apply(this,[t,e,n,r,i,o,s]),t.getSettings().ariaTags&&Re(e,[Bc("true"),xn("false")])}_2.RENDERER_TYPE=yae;const Sae="handsontable",bae={CELL_TYPE:Sae,editor:Y_,renderer:_2},Rae="numeric",Eae={CELL_TYPE:Rae,editor:v2,renderer:J_,validator:rM,dataType:"number"},Tae="password",_ae={CELL_TYPE:Tae,editor:C2,renderer:eM,copyable:!1},Mae="select";function M2(t,e,n,r,i,o,s){Os.apply(this,[t,e,n,r,i,o,s]),t.getSettings().ariaTags&&Re(e,...Bc("listbox"))}M2.RENDERER_TYPE=Mae;const xae="select",Pae={CELL_TYPE:xae,editor:y2,renderer:M2},Oae="time",Aae={CELL_TYPE:Oae,editor:S2,renderer:tM,validator:iM};function Iae(){ri(dae),ri(gae),ri(wae),ri(Cae),ri(bae),ri(Eae),ri(_ae),ri(Pae),ri(n2),ri(Aae)}function Hae(t,e){x2(t,e),e.add(t)}function Dae(t,e,n){x2(t,e),e.set(t,n)}function x2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fu(t,e,n){return e=Nae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nae(t){var e=kae(t,"string");return typeof e=="symbol"?e:String(e)}function kae(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lae(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function gu(t,e){var n=$ae(t,e,"get");return Fae(t,n)}function $ae(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Fae(t,e){return e.get?e.get.call(t):e.value}const RA=new Map([["plugin",EZ],["cell-type",jB],["editor",AV],["renderer",BV],["validator",UV]]),Wae="base",Yy=[];let io=null;var Ya=new WeakMap,EA=new WeakSet;class at{static get PLUGIN_KEY(){return Wae}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){Hae(this,EA),fu(this,"eventManager",new Kr(this)),fu(this,"pluginName",null),fu(this,"pluginsInitializedCallbacks",[]),fu(this,"isPluginsReady",!1),fu(this,"enabled",!1),fu(this,"initialized",!1),Dae(this,Ya,{writable:!0,value:{}}),Oo(this,"hot",e,{writable:!1}),io=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!RA.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);RA.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Yy.push(o)}}if(io||(io=PT()),io.indexOf("UndoRedo")>=0&&io.splice(io.indexOf("UndoRedo"),1),io.indexOf(this.pluginName)>=0&&io.splice(io.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),io.length===0){if(Yy.length>0){const i=[`${Yy.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n){gu(this,Ya)[e]=gu(this,Ya)[e]||[];const r=gu(this,Ya)[e];this.hot.addHook(e,n),r.push(n),gu(this,Ya)[e]=r}removeHooks(e){P(gu(this,Ya)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=gu(this,Ya);je(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){P(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=Lae(this,EA,Vae).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),je(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function Vae(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Ka(t,e,n){return e=Bae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bae(t){var e=Uae(t,"string");return typeof e=="symbol"?e:String(e)}function Uae(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let zae=class{constructor(e){Ka(this,"hot",null),Ka(this,"container",null),Ka(this,"injected",!1),Ka(this,"rows",[]),Ka(this,"columns",[]),Ka(this,"samples",null),Ka(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),P(this.rows,n=>{e(n.row,Wt(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),P(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{P(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{P(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{P(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),P(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{P(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e);a.col=e,a.row=s;const l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),te(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return te(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const oM=zae;function Yg(t,e,n){return e=Gae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gae(t){var e=jae(t,"string");return typeof e=="symbol"?e:String(e)}function jae(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sM{static get SAMPLE_COUNT(){return 3}constructor(e){Yg(this,"samples",null),Yg(this,"dataFactory",null),Yg(this,"customSampleCount",null),Yg(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:sM.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return ye(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return ye(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let f;h?f=c:Be(u)?f=`${Object.keys(u).length}`:Array.isArray(u)?f=`${u.length}`:f=`${Yt(u).length}`,i.has(f)||i.set(f,{needed:this.getSampleCount(),strings:[]});const g=i.get(f);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}const P2=sM;function mu(t,e){O2(t,e),e.add(t)}function Yae(t,e,n){O2(t,e),e.set(t,n)}function O2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pu(t,e,n){return e=Kae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kae(t){var e=Xae(t,"string");return typeof e=="symbol"?e:String(e)}function Xae(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qae(t,e,n){var r=A2(t,e,"set");return Qae(t,r,n),n}function Qae(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Kg(t,e){var n=A2(t,e,"get");return Zae(t,n)}function A2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Zae(t,e){return e.get?e.get.call(t):e.value}function Xa(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}me.getSingleton().register("modifyAutoColumnSizeSeed");const yh="autoColumnSize",Jae=10,ele="autoColumnSize";var Uu=new WeakMap,TA=new WeakSet,_A=new WeakSet,MA=new WeakSet,Ky=new WeakSet,xA=new WeakSet,PA=new WeakSet;class Cd extends at{static get PLUGIN_KEY(){return yh}static get PLUGIN_PRIORITY(){return Jae}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),mu(this,PA),mu(this,xA),mu(this,Ky),mu(this,MA),mu(this,_A),mu(this,TA),pu(this,"ghostTable",new oM(this.hot)),pu(this,"samplesGenerator",new P2((n,r)=>{const i=this.hot.getCellMeta(n,r);let o="";i.spanned||(o=this.hot.getDataAtCell(n,r));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,o)),{value:o,bundleSeed:s}})),pu(this,"firstCalculation",!0),pu(this,"inProgress",!1),pu(this,"measuredColumns",0),pu(this,"columnWidthsMap",new Da),Yae(this,Uu,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(ele,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>Xa(this,Ky,OA).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[yh]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[yh];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xa(e,_A,nle).call(e,...i)}),this.addHook("beforeChangeRender",r=>Xa(this,MA,rle).call(this,r)),this.addHook("afterFormulasValuesUpdate",r=>Xa(this,PA,ole).call(this,r)),this.addHook("beforeViewRender",r=>Xa(this,TA,tle).call(this,r)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("afterInit",()=>Xa(this,xA,ile).call(this)),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>Xa(this,Ky,OA).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const n=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();r===-1||i===-1||this.calculateColumnsWidth({from:r,to:i},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;ye(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);if(a===null&&(a=s),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(s,o);P(l,u=>{let[c,h]=u;return this.ghostTable.addColumn(c,h)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){nf(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+Cd.CALCULATION_STEP,r)},e),n=n+Cd.CALCULATION_STEP+1,n<r?i=Rv(o):(nf(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[yh],n=e&&Ft(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Ft(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[yh];let n=Cd.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Be(e)&&(n=e.syncLimit,cT(n)?n=MT(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,IT.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getFirstVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getFirstRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getLastVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getLastRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader();return en(e,(r,i,o)=>{const s=Kg(this,Uu).length;return(s-1<o||Kg(this,Uu)[o]!==i)&&r.push(o),s-1<o?Kg(this,Uu).push(i):Kg(this,Uu)[o]=i,r},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{P(e,n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!Yr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function tle(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function nle(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function rle(t){const e=Ge(t,n=>{let[,r]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(r))});this.clearCache(Array.from(new Set(e)))}function OA(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function ile(){qae(this,Uu,this.hot.getColHeader())}function ole(t){const e=Yr(t,r=>{var i;return he((i=r.address)===null||i===void 0?void 0:i.col)}),n=Ge(e,r=>r.address.col);this.clearCache(Array.from(new Set(n)))}const Tl={horizontal:"horizontal",vertical:"vertical"};function sle(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function ale(t){const e={};return t===!0?(e.directions=Object.keys(Tl),e.autoInsertRow=!0):Be(t)?(he(t.autoInsertRow)?t.direction===Tl.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,he(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Tl)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Sh(t,e){lle(t,e),e.add(t)}function lle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wu(t,e,n){return e=ule(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ule(t){var e=cle(t,"string");return typeof e=="symbol"?e:String(e)}function cle(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}me.getSingleton().register("modifyAutofillRange");me.getSingleton().register("beforeAutofill");me.getSingleton().register("afterAutofill");const AA="autofill",hle=20,dle=["fillHandle"],fle="insert_row_below",gle=200;var IA=new WeakSet,HA=new WeakSet,DA=new WeakSet,NA=new WeakSet,kA=new WeakSet;class mle extends at{constructor(){super(...arguments),Sh(this,kA),Sh(this,NA),Sh(this,DA),Sh(this,HA),Sh(this,IA),wu(this,"addingStarted",!1),wu(this,"mouseDownOnCellCorner",!1),wu(this,"mouseDragOutside",!1),wu(this,"handleDraggedCells",0),wu(this,"directions",[]),wu(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return AA}static get PLUGIN_PRIORITY(){return hle}static get SETTING_KEYS(){return[AA,...dle]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>bh(this,HA,wle).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>bh(this,IA,ple).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>bh(this,DA,vle).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return P(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),P(a,c=>{const h=[];P(l,f=>{h.push(this.hot.getCopyableData(c,f))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:f}=sle(l,u,(g,p)=>this.hot._createCellCoords(g,p));if(h&&h.row>-1&&h.col>-1){const g=this.getSelectionData(),p=o.clone(),y=this.hot._createCellRange(h,h,f),E=this.hot.runHooks("beforeAutofill",g,p,y,c);if(E===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let v=E;const C=E;if(["up","left"].indexOf(c)>-1&&!(C.length===1&&C[0].length===0))if(v=[],c==="up"){const S=f.row-h.row+1,T=S%C.length;for(let _=0;_<S;_++)v.push(C[(_+(C.length-T))%C.length])}else{const S=f.col-h.col+1,T=S%C[0].length;for(let _=0;_<C.length;_++){v.push([]);for(let H=0;H<S;H++)v[_].push(C[_][(H+(C[_].length-T))%C[_].length])}}this.hot.populateFromArray(h.row,h.col,v,f.row,f.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",v,p,y,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Tl.vertical)&&this.directions.includes(Tl.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Tl.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Tl.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(fle,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},gle)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++)if(n[o][l])return-1;const s=n[o][e[1]-1],a=n[o][e[3]+1];(s||a)&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ge(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=on(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+Wt(this.hot.table),i=on(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+gt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>bh(this,NA,Cle).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>bh(this,kA,yle).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=ale(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function ple(){this.selectAdjacent()&&this.fillIn()}function wle(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function vle(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Cle(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function yle(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Xg(t,e){Sle(t,e),e.add(t)}function Sle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qa(t,e,n){return e=ble(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ble(t){var e=Rle(t,"string");return typeof e=="symbol"?e:String(e)}function Rle(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const qg="autoRowSize",Ele=40,Tle="autoRowSize";var LA=new WeakSet,Xy=new WeakSet,$A=new WeakSet,FA=new WeakSet;class yd extends at{static get PLUGIN_KEY(){return qg}static get PLUGIN_PRIORITY(){return Ele}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Xg(this,FA),Xg(this,$A),Xg(this,Xy),Xg(this,LA),qa(this,"headerHeight",null),qa(this,"ghostTable",new oM(this.hot)),qa(this,"samplesGenerator",new P2((n,r)=>{if(n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let i;return n>=0?i=this.hot.getDataAtCell(n,r):n===-1&&(i=this.hot.getColHeader(r)),{value:i}})),qa(this,"firstCalculation",!0),qa(this,"inProgress",!1),qa(this,"measuredRows",0),qa(this,"rowHeightsMap",new Da),this.hot.rowIndexMapper.registerMap(Tle,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>Rh(this,Xy,WA).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[qg];return e===!0||Be(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rh(e,$A,Mle).call(e,...r)}),this.addHook("beforeChangeRender",n=>Rh(this,FA,xle).call(this,n)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",n=>Rh(this,LA,_le).call(this,n)),this.addHook("modifyRowHeight",(n,r)=>this.getRowHeight(r,n)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>Rh(this,Xy,WA).call(this,e,n,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}ye(i.from,i.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){const a=this.samplesGenerator.generateRowSamples(s,o);P(a,l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){nf(i),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+yd.CALCULATION_STEP,r)},e),n=n+yd.CALCULATION_STEP+1,n<r?i=Rv(o):(nf(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[qg],n=e&&Ft(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Ft(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){Ta(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[qg];let n=yd.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Be(e)&&(n=e.syncLimit,cT(n)?n=MT(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{ye(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!Yr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function _le(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(!(n===-1||r===-1)){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-e,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function WA(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function Mle(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function xle(t){let e=null;t.length===1?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),e!==null&&this.clearCacheByRange(e)}const{getListWithInsertedItems:Ple,getListWithRemovedItems:Ole}=EB("physicallyIndexed");class Ale extends Zl{constructor(){super(e=>e)}insert(e,n){const r=i1(this.indexedValues,n);this.indexedValues=Ple(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=Ole(this.indexedValues,e);this.indexedValues=r1(n,e),super.remove(e)}}const Ile=Ale,{getListWithInsertedItems:Hle,getListWithRemovedItems:Dle}=EB("physicallyIndexed");class Nle extends Zl{constructor(){super(e=>e)}insert(e,n){this.indexedValues=Hle(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=Dle(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const kle=Nle;function Lle(t,e){$le(t,e),e.add(t)}function $le(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fle(t,e,n){return e=Wle(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wle(t){var e=Vle(t,"string");return typeof e=="symbol"?e:String(e)}function Vle(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ble(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const qy="bindRowsWithHeaders",Ule=210,zle="loose",Gle=new Map([["loose",Ile],["strict",kle]]);var VA=new WeakSet;class jle extends at{constructor(){super(...arguments),Lle(this,VA),Fle(this,"headerIndexes",null)}static get PLUGIN_KEY(){return qy}static get PLUGIN_PRIORITY(){return Ule}isEnabled(){return!!this.hot.getSettings()[qy]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[qy];typeof e!="string"&&(e=zle);const n=Gle.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>Ble(this,VA,Yle).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function Yle(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Qg(t,e){I2(t,e),e.add(t)}function Kle(t,e,n){I2(t,e),e.set(t,n)}function I2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BA(t,e,n){return e=Xle(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xle(t){var e=qle(t,"string");return typeof e=="symbol"?e:String(e)}function qle(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UA(t,e){var n=H2(t,e,"get");return Qle(t,n)}function Qle(t,e){return e.get?e.get.call(t):e.value}function Zg(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Qy(t,e,n){var r=H2(t,e,"set");return Zle(t,r,n),n}function H2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Zle(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const rp="collapsibleColumns",Jle=290,eue=["nestedHeaders"],Cc="collapsibleIndicator",zA=rp,GA=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var vu=new WeakMap,jA=new WeakSet,YA=new WeakSet,KA=new WeakSet,XA=new WeakSet;class tue extends at{constructor(){super(...arguments),Qg(this,XA),Qg(this,KA),Qg(this,YA),Qg(this,jA),BA(this,"nestedHeadersPlugin",null),BA(this,"headerStateManager",null),Kle(this,vu,{writable:!0,value:null})}static get PLUGIN_KEY(){return rp}static get PLUGIN_PRIORITY(){return Jle}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[rp,...eue]}isEnabled(){return!!this.hot.getSettings()[rp]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||Rt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Qy(this,vu,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Zg(this,KA,iue).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Zg(e,XA,oue).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Zg(e,jA,nue).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Zg(this,YA,rue).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Qy(this,vu,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};i&&(o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:zA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(zA)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};ye(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;ye(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Cc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Cc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Cc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!GA.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Yr(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;P(r,f=>{var g;let{row:p,col:y}=f;const{collapsible:E,isCollapsed:v}=(g=this.headerStateManager.getHeaderSettings(p,y))!==null&&g!==void 0?g:{};if(!E||v&&n==="collapse"||!v&&n==="expand")return i=!1,!1});const o=[],s=[];i&&P(r,f=>{let{row:g,col:p}=f;const{colspanCompensation:y,affectedColumns:E,rollbackModification:v}=this.headerStateManager.triggerNodeModification(n,g,p);y>0&&(s.push(...E),o.push(v))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=lT([...a,...s]):n==="expand"&&(l=Yr(a,f=>!s.includes(f)));const u=GA.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){P(o,f=>{f()});return}this.hot.batchExecution(()=>{P(s,f=>{UA(this,vu).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return UA(this,vu).getHiddenIndexes()}destroy(){Qy(this,vu,null),super.destroy()}}function nue(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Cc}`);if(Ha(e,[xn("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),te(u,Cc),e.querySelector("div:first-child").appendChild(u)),Le(u,["collapsed","expanded"]),s?(te(u,"collapsed"),Ea(u,"+"),l&&Re(e,[xn(!1),Qd(this.hot.getTranslatedPhrase(x_))])):(te(u,"expanded"),Ea(u,"-"),l&&Re(e,[xn(!0),Qd(this.hot.getTranslatedPhrase(P_))])),l&&Re(u,..._s());else{var c;(c=u)===null||c===void 0||c.remove()}}function rue(t,e){De(t.target,Cc)&&(De(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):De(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Ci(t))}function iue(){this.updatePlugin()}function oue(t,e){e||this.updatePlugin()}function Qa(t,e,n){return e=sue(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sue(t){var e=aue(t,"string");return typeof e=="symbol"?e:String(e)}function aue(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const lue=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],uue=!1,cue=!0,hue=!0;class due{constructor(e,n){Qa(this,"hot",void 0),Qa(this,"sortingStates",new _v),Qa(this,"sortEmptyCells",uue),Qa(this,"indicator",cue),Qa(this,"headerAction",hue),Qa(this,"compareFunctionFactory",void 0),Qa(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Be(e)&&je(e,(n,r)=>{lue.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Be(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(he(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const fw="asc",gw="desc",fue="colHeader";function gue(t){if(Be(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[fw,gw].includes(n)}function mue(t){if(t.some(n=>gue(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function qA(t){if(t!==gw)return t===fw?gw:fw}function D2(t){return t.querySelector(`.${fue}`)}function N2(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function aM(t,e,n){return t===-1&&e>=0&&_a(n)===!1}const pue="ascending",wue="descending",k2="indicatorDisabled",L2="columnSorting",$2="sortAction",F2=new Map([[fw,pue],[gw,wue]]);function vue(t,e,n,r){const i=[L2];if(r&&i.push($2),n===!1)return i.push(k2),i;const o=t.getSortOrderOfColumn(e);return he(o)&&i.push(F2.get(o)),i}function Cue(){return Array.from(F2.values()).concat($2,k2,L2)}function W2(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Eo:gn(i)?gn(o)?Eo:s&&t==="asc"?Gt:jt:gn(o)?s&&t==="asc"?jt:Gt:isNaN(i)&&!isNaN(o)?t==="asc"?jt:Gt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Gt:jt:i>o?t==="asc"?jt:Gt:Eo}}const V2="default";function yue(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Eo;if(a){if(gn(r))return t==="asc"?Gt:jt;if(gn(i))return t==="asc"?jt:Gt}return isNaN(o)?jt:isNaN(s)?Gt:o<s?t==="asc"?Gt:jt:o>s?t==="asc"?jt:Gt:Eo}}const Sue="numeric";function bue(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=gn(s),u=gn(a),c=l?i:s,h=u?i:a,f=c===i||c===r,g=h===i||h===r;if(o===!1){if(l&&u===!1)return jt;if(l===!1&&u)return Gt}return f===!1&&g?t==="asc"?Gt:jt:f&&g===!1?t==="asc"?jt:Gt:f===!1&&g===!1?W2(t,e,n)(s,a):c===i&&h===r?t==="asc"?Gt:jt:c===r&&h===i?t==="asc"?jt:Gt:Eo}}const Rue="checkbox";function Eue(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Eo;if(gn(r))return gn(i)?Eo:o&&t==="asc"?Gt:jt;if(gn(i))return o&&t==="asc"?jt:Gt;const s=e.dateFormat,a=ee(r,s),l=ee(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?t==="asc"?Gt:jt:l.isBefore(a)?t==="asc"?jt:Gt:Eo:Gt:jt}}const Tue="date",{register:Uv,getItem:QA,hasItem:_ue}=qi("sorting.compareFunctionFactory"),{register:B2,getItem:Mue}=qi("sorting.mainSortComparator");function U2(t){return _ue(t)?QA(t):QA(V2)}Uv(Sue,yue);Uv(Rue,bue);Uv(Tue,Eue);Uv(V2,W2);const Eo=0,Gt=-1,jt=1;function xue(t,e){const n=Mue(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}function Pue(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],f=u.columnSorting;return(f.compareFunctionFactory?f.compareFunctionFactory:U2(u.type))(l,u,f)(c,h)}(0)}}function Jg(t,e){Oue(t,e),e.add(t)}function Oue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function em(t,e,n){return e=Aue(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aue(t){var e=Iue(t,"string");return typeof e=="symbol"?e:String(e)}function Iue(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zu(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const mw="columnSorting",Hue=50,pw="append",Due="replace",ZA=mw,JA="columnSortingIndicator";B2(mw,Pue);me.getSingleton().register("beforeColumnSort");me.getSingleton().register("afterColumnSort");var ip=new WeakSet,eI=new WeakSet,tI=new WeakSet,nI=new WeakSet;class z2 extends at{constructor(){super(...arguments),Jg(this,nI),Jg(this,tI),Jg(this,eI),Jg(this,ip),em(this,"columnStatesManager",null),em(this,"columnMetaCache",null),em(this,"pluginKey",mw),em(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return mw}static get PLUGIN_PRIORITY(){return Hue}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new due(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Da(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>zu(this,eI,Nue).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zu(e,nI,Lue).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>zu(this,ip,lR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zu(e,tI,kue).call(e,...r)}),this.hot.view&&zu(this,ip,lR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=D2(r);N2(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:ZA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ZA)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new TB),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return he(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return mue(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ge(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return he(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ge(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(he(n)){const i=qA(n);return he(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:qA()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pw;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(bt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===pw)return[...o.slice(0,r),...o.slice(r+1),s];if(n===Due)return[...o.slice(0,r),s,...o.slice(r+1)]}return he(s)?o.concat(s):o}getPluginColumnConfig(e){if(Be(e)){const n=e[this.pluginKey];if(Be(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):St(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const n=[],r=this.hot.countRows(),i=u=>Ge(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ge(n,u=>u[0]);xue(n,this.pluginKey,Ge(e,u=>u.sortOrder),Ge(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ge(n,u=>u[0]),a=new Map(Ge(o,(u,c)=>[u,s[c]])),l=Ge(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Be(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Be(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(Le(e,Cue()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];te(e,vue(...r))}}updateSortingIndicator(e,n){const r=this.getFirstCellSettings(e)[this.pluginKey],i=this.hot.getSettings().ariaTags,o=r.indicator,s=this.columnStatesManager.isColumnSorted(e),a=n.querySelector(`.${JA}`);o&&s&&!a&&Fl(n,{tagName:"div",className:JA,attributes:i?[_s()]:[]})}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),he(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&e.target.nodeName==="SPAN"}onAfterOnCellMouseDown(e,n){aM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function lR(){const t=this.getAllSavedSortSettings();if(Be(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Nue(t,e){const n=D2(e);if(N2(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=this.hot.getSettings().ariaTags,o=r.indicator,s=r.headerAction,a=this.columnStatesManager.getSortOrderOfColumn(t);this.updateHeaderClasses(n,this.columnStatesManager,t,o,s),this.updateSortingIndicator(t,n),i&&Re(e,[Kq(a?`${a}ending`:"none"),Qd(this.hot.getTranslatedPhrase(O_))])}function kue(t){t===!0&&this.hot.view&&zu(this,ip,lR).call(this)}function Lue(t,e,n,r){aM(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function Za(t,e,n){return e=$ue(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ue(t){var e=Fue(t,"string");return typeof e=="symbol"?e:String(e)}function Fue(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wue{constructor(e,n){Za(this,"plugin",void 0),Za(this,"hot",void 0),Za(this,"endpoints",[]),Za(this,"settings",void 0),Za(this,"settingsType","array"),Za(this,"currentEndpoint",null),Za(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),P(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();P(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const f=()=>(this.hot.removeHook("beforeViewRender",f),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",f);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;P(u,f=>{a==="row"&&f.destinationRow>=h&&(f.alterRowOffset=l*r),a==="col"&&f.destinationColumn>=h&&(f.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?P(u,f=>{this.extendEndpointRanges(f,h,i[0],i.length),this.recreatePhysicalRanges(f),this.clearOffsetInformation(f)}):P(u,f=>{this.shiftEndpointCoordinates(f,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){P(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];P(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),P(i,o=>{let s=[];P(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,P(e.ranges,r=>{P(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],P(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],P(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],P(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&P(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),P(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Rt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const Vue=Wue;function Zy(t){return t==null||isNaN(t)}function Jy(t,e){Bue(t,e),e.add(t)}function Bue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uue(t,e,n){return e=zue(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zue(t){var e=Gue(t,"string");return typeof e=="symbol"?e:String(e)}function Gue(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eS(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const tS="columnSummary",jue=220;var rI=new WeakSet,iI=new WeakSet,oI=new WeakSet;class Yue extends at{constructor(){super(...arguments),Jy(this,oI),Jy(this,iI),Jy(this,rI),Uue(this,"endpoints",null)}static get PLUGIN_KEY(){return tS}static get PLUGIN_PRIORITY(){return jue}isEnabled(){return!!this.hot.getSettings()[tS]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[tS],this.endpoints=new Vue(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return eS(e,rI,Kue).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return eS(e,iI,Xue).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return eS(e,oI,que).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return je(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=Zy(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return je(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=Zy(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=Zy(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return je(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(mt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function Kue(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}function Xue(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function que(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Cu(t,e,n){return e=Que(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Que(t){var e=Zue(t,"string");return typeof e=="symbol"?e:String(e)}function Zue(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uc{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){Cu(this,"rootDocument",void 0),Cu(this,"isRtl",!1),Cu(this,"container",null),Cu(this,"editor",void 0),Cu(this,"editorStyle",void 0),Cu(this,"hidden",!0),this.rootDocument=e,this.isRtl=n,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,n){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:gt(this.getInputElement()),height:Wt(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),te(this.container,uc.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),te(e,uc.CLASS_EDITOR),te(n,uc.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${uc.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const Jue=uc;function nS(t,e,n){return e=ece(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ece(t){var e=tce(t,"string");return typeof e=="symbol"?e:String(e)}function tce(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const nce=250,rce=250;class G2{constructor(e){nS(this,"wasLastActionShow",!0),nS(this,"showDebounced",null),nS(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},rce)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:nce;this.showDebounced=CT(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}vt(G2,Nr);const ice=G2;function oce(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function sce(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ja(t,e){const n={};return P(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function Gs(t,e,n,r,i){P(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&ace(s,a,e,n,r,i)})})}function ace(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=oce(s.className,r):a=sce(s.className,r)),o(t,e,"className",a)}function Qo(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function wo(t,e){let n=!1;return Array.isArray(t)&&P(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function zv(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Ke="---------";function lce(){return{name:Ke}}const si="alignment";function uce(){return{key:si,name(){return this.getTranslatedPhrase(O1)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${si}:left`,name(){let t=this.getTranslatedPhrase(A1);return wo(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(t=Qo(t)),t},callback(){const t=this.getSelectedRange(),e=Ja(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Gs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${si}:center`,name(){let t=this.getTranslatedPhrase(I1);return wo(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(t=Qo(t)),t},callback(){const t=this.getSelectedRange(),e=Ja(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Gs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${si}:right`,name(){let t=this.getTranslatedPhrase(H1);return wo(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(t=Qo(t)),t},callback(){const t=this.getSelectedRange(),e=Ja(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Gs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${si}:justify`,name(){let t=this.getTranslatedPhrase(D1);return wo(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(t=Qo(t)),t},callback(){const t=this.getSelectedRange(),e=Ja(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Gs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Ke},{key:`${si}:top`,name(){let t=this.getTranslatedPhrase(N1);return wo(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(t=Qo(t)),t},callback(){const t=this.getSelectedRange(),e=Ja(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Gs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${si}:middle`,name(){let t=this.getTranslatedPhrase(k1);return wo(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(t=Qo(t)),t},callback(){const t=this.getSelectedRange(),e=Ja(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Gs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${si}:bottom`,name(){let t=this.getTranslatedPhrase(L1);return wo(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(t=Qo(t)),t},callback(){const t=this.getSelectedRange(),e=Ja(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Gs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Gv="clear_column";function cce(){return{key:Gv,name(){return this.getTranslatedPhrase(p1)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const Vf="col_left";function hce(){return{key:Vf,name(){return this.getTranslatedPhrase(u1)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Bf="col_right";function dce(){return{key:Bf,name(){return this.getTranslatedPhrase(c1)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Uf="make_read_only";function fce(){return{key:Uf,name(){let t=this.getTranslatedPhrase(m1);return wo(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=Qo(t)),t},callback(){const t=this.getSelectedRange(),e=wo(t,(n,r)=>this.getCellMeta(n,r).readOnly);P(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const jv="redo";function gce(){return{key:jv,name(){return this.getTranslatedPhrase(g1)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const zf="remove_col";function mce(){return{key:zf,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(d1,e)},callback(){this.alter("remove_col",vre(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Yv="remove_row";function pce(){return{key:Yv,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(h1,e)},callback(){this.alter("remove_row",Cre(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Kv="row_above";function wce(){return{key:Kv,name(){return this.getTranslatedPhrase(a1)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Xv="row_below";function vce(){return{key:Xv,name(){return this.getTranslatedPhrase(l1)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const uf="no_items";function Cce(){return{key:uf,name(){return this.getTranslatedPhrase(s1)},disabled:!0,isCommand:!1}}const qv="undo";function yce(){return{key:qv,name(){return this.getTranslatedPhrase(f1)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Sce=[Kv,Xv,Vf,Bf,Gv,Yv,zf,qv,jv,Uf,si,Ke,uf],bce={[Ke]:lce,[uf]:Cce,[Kv]:wce,[Xv]:vce,[Vf]:hce,[Bf]:dce,[Gv]:cce,[Yv]:pce,[zf]:mce,[qv]:yce,[jv]:gce,[Uf]:fce,[si]:uce};function j2(){const t={};return je(bce,(e,n)=>{t[n]=e()}),t}function Rce(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(M1):this.getTranslatedPhrase(_1)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Ece(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(x1)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Tce(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(P1);return wo(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,op))?Qo(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,op);t.updateCommentMeta(n,r,{[op]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function oo(t,e){Y2(t,e),e.add(t)}function el(t,e,n){Y2(t,e),e.set(t,n)}function Y2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _ce(t,e,n){return e=Mce(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mce(t){var e=xce(t,"string");return typeof e=="symbol"?e:String(e)}function xce(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function so(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function as(t,e,n){var r=K2(t,e,"set");return Pce(t,r,n),n}function Pce(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Je(t,e){var n=K2(t,e,"get");return Oce(t,n)}function K2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Oce(t,e){return e.get?e.get.call(t):e.value}const Sd="comments",Ace=60,Zo="comment",Jh="value",X2="style",op="readOnly",tm=Sd,uR=`plugin:${Sd}`;var Pt=new WeakMap,Ai=new WeakMap,Qv=new WeakMap,sp=new WeakMap,ww=new WeakMap,cR=new WeakMap,vw=new WeakMap,sI=new WeakSet,aI=new WeakSet,lI=new WeakSet,uI=new WeakSet,cI=new WeakSet,hI=new WeakSet,dI=new WeakSet,fI=new WeakSet,gI=new WeakSet,mI=new WeakSet;class Ice extends at{constructor(){super(...arguments),oo(this,mI),oo(this,gI),oo(this,fI),oo(this,dI),oo(this,hI),oo(this,cI),oo(this,uI),oo(this,lI),oo(this,aI),oo(this,sI),_ce(this,"range",{}),el(this,Pt,{writable:!0,value:null}),el(this,Ai,{writable:!0,value:null}),el(this,Qv,{writable:!0,value:!1}),el(this,sp,{writable:!0,value:!1}),el(this,ww,{writable:!0,value:{}}),el(this,cR,{writable:!0,value:null}),el(this,vw,{writable:!0,value:""})}static get PLUGIN_KEY(){return Sd}static get PLUGIN_PRIORITY(){return Ace}isEnabled(){return!!this.hot.getSettings()[Sd]}enablePlugin(){this.enabled||(Je(this,Pt)||as(this,Pt,new Jue(this.hot.rootDocument,this.hot.isRtl())),Je(this,Ai)||as(this,Ai,new ice(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,n,r,i,o,s)=>so(this,uI,kce).call(this,e,s)),this.addHook("afterScroll",()=>so(this,mI,Bce).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>so(this,gI,Vce).call(this,e)),Je(this,Ai).addLocalHook("hide",()=>this.hide()),Je(this,Ai).addLocalHook("show",(e,n)=>this.showAtCell(e,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Je(this,Ai).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(uR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();as(this,sp,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(uR),this.hot._registerTimeout(()=>{as(this,sp,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!Je(this,Pt).isVisible()},group:tm}),r.addShortcut({keys:[["Escape"]],callback:()=>{Je(this,Pt).setValue(Je(this,vw)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&Je(this,Pt).isVisible()},group:tm}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&Je(this,Pt).isVisible()},group:tm})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tm)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>so(this,aI,Dce).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>so(this,sI,Hce).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>so(this,lI,Nce).call(this)),this.eventManager.addEventListener(n,"focus",()=>so(this,hI,$ce).call(this)),this.eventManager.addEventListener(n,"blur",()=>so(this,cI,Lce).call(this)),this.eventManager.addEventListener(n,"mousedown",r=>so(this,dI,Fce).call(this,r)),this.eventManager.addEventListener(n,"mouseup",r=>so(this,fI,Wce).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Ra(e.target,"TD","TBODY");return!!(n&&De(n,"htCommentCell")&&Ra(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=Je(this,Pt).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Jh]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Zo),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Jh)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Jh)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Je(this,Ai).cancelHiding(),Je(this,Pt).setValue((e=i[Zo]?i[Zo][Jh]:null)!==null&&e!==void 0?e:""),Je(this,Pt).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){Je(this,Pt).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Je(this,Pt).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(s),u=o.getRenderableFromVisualIndex(a);const c=l===null;Je(this,Pt).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),u===null&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));const h=l===null,f=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:g,view:{_wt:p}}=this.hot,{wtTable:y}=p,E=p.getCell({row:l,col:u},!0),v=this.getCommentMeta(s,a,X2);v?Je(this,Pt).setSize(v.width,v.height):Je(this,Pt).resetSize();const C=f?0:y.getStretchedColumnWidth(u),S=c&&!h?Wt(E):0,{left:T,top:_,width:H,height:D}=E.getBoundingClientRect(),{width:B,height:z}=Je(this,Pt).getSize(),{innerWidth:G,innerHeight:Z}=this.hot.rootWindow,re=this.hot.rootDocument.documentElement;let ne=T+g.scrollX+C,ue=_+g.scrollY+S;this.hot.isRtl()&&(ne-=B+C),this.hot.isLtr()&&T+H+B>G?ne=T+g.scrollX-B-1:this.hot.isRtl()&&ne<-(re.scrollWidth-re.clientWidth)&&(ne=T+g.scrollX+C+1),_+z>Z&&(ue-=z-D+1),Je(this,Pt).setPosition(ne,ue),Je(this,Pt).setReadOnlyState(this.getCommentMeta(s,a,op))}focusEditor(){Je(this,Pt).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Zo];let o;i?(o=Zn(i),Df(o,r)):o=r,this.hot.setCellMeta(e,n,Zo,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Zo])return i[Zo][r]}addToContextMenu(e){e.items.push({name:Ke},Rce(this),Ece(this),Tce(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[Sd];if(Be(e))return e.displayDelay}getEditorInputElement(){return Je(this,Pt).getInputElement()}destroy(){Je(this,Pt)&&Je(this,Pt).destroy(),Je(this,Ai)&&Je(this,Ai).destroy(),super.destroy()}}function Hce(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Je(this,Qv)&&!this.targetIsCommentTextArea(t)){const e=Ra(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function Dce(t){const{rootDocument:e}=this.hot;if(!(Je(this,Qv)||Je(this,Pt).isFocused()||De(t.target,"wtBorder")||Je(this,cR)===t.target||!Je(this,Pt)))if(as(this,cR,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));Je(this,Ai).show(n)}else ma(t.target,e)&&!this.targetIsCommentTextArea(t)&&Je(this,Ai).hide()}function Nce(){as(this,Qv,!1)}function kce(t,e){e[Zo]&&e[Zo][Jh]&&te(t,e.commentedCellClassName)}function Lce(){as(this,vw,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function $ce(){as(this,vw,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(uR)}function Fce(t){as(this,ww,{width:gt(t.target),height:Wt(t.target)})}function Wce(t){const e=gt(t.target),n=Wt(t.target);(e!==Je(this,ww).width+1||n!==Je(this,ww).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[X2]:{width:e,height:n}})}function Vce(t){Je(this,Pt).isVisible()&&Ci(t)}function Bce(){Je(this,sp)||this.hide()}var pI=yF,Uce=TypeError,zce=function(t,e){if(!delete t[e])throw Uce("Cannot delete property "+pI(e)+" of "+pI(t))},Gce=Kl,jce=Zw,Yce=ev,Kce=LF,Xce=zce,qce=$F,Qce=[].unshift(0)!==1,Zce=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},Jce=Qce||!Zce();Gce({target:"Array",proto:!0,arity:1,forced:Jce},{unshift:function(e){var n=jce(this),r=Yce(n),i=arguments.length;if(i){qce(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:Xce(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return Kce(n,r+i)}});function rS(t,e,n){return e=ehe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ehe(t){var e=the(t,"string");return typeof e=="symbol"?e:String(e)}function the(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q2{constructor(e){rS(this,"hot",void 0),rS(this,"commands",{}),rS(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=nhe(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Ft(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),P(u,c=>c.apply(this.hot,r))}}function nhe(t,e){let n;return P(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function iS(t,e,n){return e=rhe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rhe(t){var e=ihe(t,"string");return typeof e=="symbol"?e:String(e)}function ihe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Q2{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;iS(this,"hot",void 0),iS(this,"predefinedItems",j2()),iS(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,je(e,(r,i)=>{let o="";r.name===Ke?(n[Ke]=r,o=Ke):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return ohe(e,this.defaultOrderPattern,this.predefinedItems)}}function ohe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Be(i)?je(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Be(o)?sn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):P(i,(o,s)=>{let a=n[o];!a&&Sce.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Be(o)&&sn(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function ks(t,e,n){return e=she(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function she(t){var e=ahe(t,"string");return typeof e=="symbol"?e:String(e)}function ahe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lhe{constructor(e,n){ks(this,"top",void 0),ks(this,"topRelative",void 0),ks(this,"left",void 0),ks(this,"leftRelative",void 0),ks(this,"scrollTop",void 0),ks(this,"scrollLeft",void 0),ks(this,"cellHeight",void 0),ks(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Eh(t,e,n){uhe(t,e),e.set(t,n)}function uhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qe(t,e){var n=Z2(t,e,"get");return che(t,n)}function che(t,e){return e.get?e.get.call(t):e.value}function nm(t,e,n){var r=Z2(t,e,"set");return hhe(t,r,n),n}function Z2(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function hhe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var or=new WeakMap,Ls=new WeakMap,Hn=new WeakMap,oS=new WeakMap,yu=new WeakMap;class dhe{constructor(e){Eh(this,or,{writable:!0,value:void 0}),Eh(this,Ls,{writable:!0,value:void 0}),Eh(this,Hn,{writable:!0,value:void 0}),Eh(this,oS,{writable:!0,value:!1}),Eh(this,yu,{writable:!0,value:{above:0,below:0,left:0,right:0}}),nm(this,oS,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Qe(this,yu)[e]=n,this}setElement(e){return nm(this,or,e),this}setParentElement(e){return nm(this,Ls,e),this}updatePosition(e){nm(this,Hn,new lhe(e,Qe(this,or).ownerDocument.defaultView)),Qe(this,oS)?(Qe(this,Hn).fitsBelow(Qe(this,or))?this.setPositionBelowCursor():Qe(this,Hn).fitsAbove(Qe(this,or))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Qe(this,or).dir==="rtl"?Qe(this,Hn).fitsOnLeft(Qe(this,or))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Qe(this,Hn).fitsOnRight(Qe(this,or))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Qe(this,yu).above+Qe(this,Hn).top-Qe(this,or).offsetHeight;Qe(this,Ls)&&(e=Qe(this,Hn).top+Qe(this,Hn).cellHeight-Qe(this,or).offsetHeight+3),Qe(this,or).style.top=`${e}px`}setPositionBelowCursor(){let e=Qe(this,yu).below+Qe(this,Hn).top+1;Qe(this,Ls)&&(e=Qe(this,Hn).top-1),Qe(this,or).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Qe(this,Hn).left;if(Qe(this,Ls)){const{right:n}=Qe(this,Ls).getBoundingClientRect();e+=Qe(this,Hn).cellWidth+n-(Qe(this,Hn).left+Qe(this,Hn).cellWidth)}else e+=Qe(this,yu).right;Qe(this,or).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Qe(this,yu).left+Qe(this,Hn).left-Qe(this,or).offsetWidth;if(Qe(this,Ls)){const{left:n}=Qe(this,Ls).getBoundingClientRect();e-=Qe(this,Hn).left-n}Qe(this,or).style.left=`${e}px`}}function J2(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Or(e,-1,p()-1);function a(E,v){const C=p()-1;return E<0&&(E=C),E>C&&(E=0),o.has(E)?-1:(o.add(E),r(E,!1)===!1&&(E=a(v===1?++E:--E,v)),E)}function l(E){E>-1&&E<p()&&r(E,!0)!==!1&&(s=E)}function u(){return s}function c(){p()>0&&(o.clear(),s=a(0,1))}function h(){p()>0&&(o.clear(),s=a(p()-1,-1))}function f(){p()>0&&(o.clear(),s=a(++s,1))}function g(){p()>0&&(o.clear(),s=a(--s,-1))}function p(){return Math.max(n(),0)}function y(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:f,toPreviousItem:g,getSize:p,clear:y}}function fhe(t){return Ge(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function ap(t){return Ft(t,"submenu")}function hR(t){return new RegExp(Ke,"i").test(t.name)}function lp(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function wI(t){return Ft(t,"disableSelection")}function ghe(t){return De(t,"htSeparator")}function mhe(t){return De(t,"htSubmenu")}function phe(t){return De(t,"htDisabled")}function whe(t){return De(t,"htSelectionDisabled")}function vhe(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function eU(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function Che(t,e){let n=t.slice(0);return n.reverse(),n=eU(n,e),n.reverse(),n}function yhe(t){const e=[];return P(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function She(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ke,n=t.slice(0);return n=eU(n,e),n=Che(n,e),n=yhe(n),n}function bhe(t){return J2({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||ghe(r)||phe(r)||whe(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Rhe(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.hotMenu.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const n=t.hotMenu.getSelectedLast();n&&(t.hotMenu.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const tU="menu",vI=tU;function Ehe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(Rhe(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:tU})}function i(u,c){const h=a(c);u.forEach(f=>{let{keys:g}=f;g.forEach(p=>h.removeShortcutsByKeys(p))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${vI}:${u}`:vI}function a(u){var c;const h=t.hotMenu.getShortcutManager(),f=s(u);return(c=h.getContext(f))!==null&&c!==void 0?c:h.addContext(f)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}const The="submenuIndicator";function _he(t){return(e,n,r,i,o,s)=>{if(n.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s;if(Ki(n),te(l,"htItemWrapper"),t.getSettings().ariaTags){const c=!lp(a,t)&&!wI(a)&&!hR(a);Re(n,[Fq(),ba(u),...c?[Vc(-1)]:[],...lp(a,t)?[jq()]:[],...ap(a)?[xn(!1)]:[]])}ap(a)&&(n.querySelector(".submenuIndicator")||Fl(n,{tagName:"div",attributes:t.getSettings().ariaTags?[_s()]:[],className:The})),n.className="",n.appendChild(l),hR(a)?te(n,"htSeparator"):typeof a.renderer=="function"?(te(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Ql(l,u),lp(a,t)?te(n,"htDisabled"):wI(a)?te(n,"htSelectionDisabled"):ap(a)&&te(n,"htSubmenu")}}function CI(t,e,n){Mhe(t,e),e.set(t,n)}function Mhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ao(t,e,n){return e=xhe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xhe(t){var e=Phe(t,"string");return typeof e=="symbol"?e:String(e)}function Phe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yI(t,e,n){var r=nU(t,e,"set");return Ohe(t,r,n),n}function Ohe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Th(t,e){var n=nU(t,e,"get");return Ahe(t,n)}function nU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ahe(t,e){return e.get?e.get.call(t):e.value}const SI=215;var _h=new WeakMap,rm=new WeakMap;class Kc{constructor(e,n){var r=this;ao(this,"hot",void 0),ao(this,"options",void 0),ao(this,"eventManager",new Kr(this)),ao(this,"container",void 0),ao(this,"positioner",void 0),ao(this,"hotMenu",null),ao(this,"hotSubMenus",{}),ao(this,"parentMenu",void 0),ao(this,"menuItems",null),ao(this,"origOutsideClickDeselects",null),CI(this,_h,{writable:!0,value:void 0}),CI(this,rm,{writable:!0,value:void 0}),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:SI,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new dhe(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Zd(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Th(this,_h)}getKeyboardShortcutsCtrl(){return Th(this,rm)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=CT(a=>this.openSubMenu(a),300),n=this.options.minWidth||SI;let r=!1,i=Yr(this.menuItems,a=>(a.key===uf&&(r=!0),vhe(a,this.hot)));if(i.length<1&&!r)i.push(j2()[uf]);else if(i.length===0)return;i=She(i,Ke);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return he(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:_he(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{Th(this,_h).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===Ke?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),F0()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!F0()||!_a(a))&&o&&this.hasSelectedItem()&&(ss()||ET()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),yI(this,_h,bhe(this.hotMenu)),yI(this,rm,Ehe(this)),Th(this,rm).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Th(this,_h).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Re(r,[xn(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!mhe(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Kc(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Re(n,[xn(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Re(i,[xn(!1)])}}closeAllSubMenus(){P(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?fhe(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||hR(e)||lp(e,this.hot)||ap(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(St(r)&&(r=r.call(this.hot),r===null||bt(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),te(i,`htMenu ${this.options.className}`),r&&te(i,r),this.options.container.appendChild(i)),i}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=en(n,(a,l)=>a+(l.name===Ke?1:26),0);i.width=`${o+3}px`,i.height=`${s+3}px`,r.height=i.height,this.hot.getSettings().ariaTags&&Re(this.hotMenu.rootElement,[$q(),Vc(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ma(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ma(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&De(e.target,"htCore")&&ma(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}vt(Kc,Nr);function im(t,e){Ihe(t,e),e.add(t)}function Ihe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sS(t,e,n){return e=Hhe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hhe(t){var e=Dhe(t,"string");return typeof e=="symbol"?e:String(e)}function Dhe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function om(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const ed="contextMenu",Nhe=70,bI=ed;me.getSingleton().register("afterContextMenuDefaultOptions");me.getSingleton().register("beforeContextMenuShow");me.getSingleton().register("afterContextMenuShow");me.getSingleton().register("afterContextMenuHide");me.getSingleton().register("afterContextMenuExecute");var RI=new WeakSet,EI=new WeakSet,TI=new WeakSet,_I=new WeakSet;class Zv extends at{constructor(){super(...arguments),im(this,_I),im(this,TI),im(this,EI),im(this,RI),sS(this,"commandExecutor",new q2(this.hot)),sS(this,"itemsFactory",null),sS(this,"menu",null)}static get PLUGIN_KEY(){return ed}static get PLUGIN_PRIORITY(){return Nhe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Kv,Xv,Ke,Vf,Bf,Ke,Yv,zf,Ke,qv,jv,Ke,Uf,Ke,si]}isEnabled(){return!!this.hot.getSettings()[ed]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[ed];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Kc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>om(this,EI,Lhe).call(this)),this.menu.addLocalHook("afterOpen",()=>om(this,TI,$he).call(this)),this.menu.addLocalHook("afterClose",()=>om(this,_I,Fhe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>om(this,RI,khe).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","\\"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=zv(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height})},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:bI})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(bI)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),je(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new Q2(this.hot,Zv.DEFAULT_ITEMS);const e=this.hot.getSettings()[ed],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),P(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function khe(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),De(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(De(o,"current")&&De(o,"wtBorder"))))return;const s=zv(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Lhe(){this.hot.runHooks("beforeContextMenuShow",this)}function $he(){this.hot.runHooks("afterContextMenuShow",this)}function Fhe(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Zv.SEPARATOR={name:Ke};function Whe(t){return{key:"copy",name(){return this.getTranslatedPhrase(w1)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Vhe(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Or(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(y1,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Bhe(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Or(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(C1,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Uhe(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Or(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(v1,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function zhe(t){return{key:"cut",name(){return this.getTranslatedPhrase(S1)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class Ghe{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class jhe{constructor(){this.clipboardData=new Ghe}}function MI(t,e){rU(t,e),e.add(t)}function Su(t,e,n){rU(t,e),e.set(t,n)}function rU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sm(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ur(t,e){var n=iU(t,e,"get");return Yhe(t,n)}function Yhe(t,e){return e.get?e.get.call(t):e.value}function bu(t,e,n){var r=iU(t,e,"set");return Khe(t,r,n),n}function iU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Khe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var $s=new WeakMap,aS=new WeakMap,Mh=new WeakMap,dR=new WeakMap,fR=new WeakMap,xh=new WeakMap,am=new WeakSet,xI=new WeakSet;class Xhe{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;MI(this,xI),MI(this,am),Su(this,$s,{writable:!0,value:void 0}),Su(this,aS,{writable:!0,value:void 0}),Su(this,Mh,{writable:!0,value:void 0}),Su(this,dR,{writable:!0,value:void 0}),Su(this,fR,{writable:!0,value:void 0}),Su(this,xh,{writable:!0,value:void 0}),bu(this,aS,n),bu(this,Mh,r),bu(this,dR,i),bu(this,fR,o),bu(this,xh,s)}setSelectedRange(e){bu(this,$s,e)}getCellsRange(){if(ur(this,aS).call(this)===0||ur(this,Mh).call(this)===0)return null;const{row:e,col:n}=ur(this,$s).getTopStartCorner(),{row:r,col:i}=ur(this,$s).getBottomEndCorner(),o=sm(this,xI,qhe).call(this,e,r),s=sm(this,am,lS).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(ur(this,Mh).call(this)===0||ur(this,xh).call(this)===0)return null;const{col:e}=ur(this,$s).getTopStartCorner(),{col:n}=ur(this,$s).getBottomEndCorner(),r=sm(this,am,lS).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(ur(this,Mh).call(this)===0||ur(this,xh).call(this)===0)return null;const{col:e}=ur(this,$s).getTopStartCorner(),{col:n}=ur(this,$s).getBottomEndCorner(),r=sm(this,am,lS).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-ur(this,xh).call(this),startCol:e,endRow:-1,endCol:r}}}function lS(t,e){return Math.min(e,Math.max(t+ur(this,fR).call(this)-1,t))}function qhe(t,e){return Math.min(e,Math.max(t+ur(this,dR).call(this)-1,t))}function oU(t){const e=[],n=[];return P(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);ye(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);ye(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Wo(t,e){sU(t,e),e.add(t)}function tl(t,e,n){sU(t,e),e.set(t,n)}function sU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ph(t,e,n){return e=Qhe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qhe(t){var e=Zhe(t,"string");return typeof e=="symbol"?e:String(e)}function Zhe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $r(t,e){var n=aU(t,e,"get");return Jhe(t,n)}function Jhe(t,e){return e.get?e.get.call(t):e.value}function Di(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Vo(t,e,n){var r=aU(t,e,"set");return ede(t,r,n),n}function aU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ede(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}me.getSingleton().register("afterCopyLimit");me.getSingleton().register("modifyCopyableRange");me.getSingleton().register("beforeCut");me.getSingleton().register("afterCut");me.getSingleton().register("beforePaste");me.getSingleton().register("afterPaste");me.getSingleton().register("beforeCopy");me.getSingleton().register("afterCopy");const lm="copyPaste",tde=80,nde=["fragmentSelection"],PI=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var gR=new WeakMap,mR=new WeakMap,pR=new WeakMap,Ru=new WeakMap,um=new WeakMap,cm=new WeakMap,Eu=new WeakMap,uS=new WeakSet,OI=new WeakSet,lU=new WeakSet,lM=new WeakSet,AI=new WeakSet,II=new WeakSet,HI=new WeakSet,DI=new WeakSet,NI=new WeakSet;class rde extends at{constructor(){super(...arguments),Wo(this,NI),Wo(this,DI),Wo(this,HI),Wo(this,II),Wo(this,AI),Wo(this,lM),Wo(this,lU),Wo(this,OI),Wo(this,uS),Ph(this,"columnsLimit",1/0),Ph(this,"rowsLimit",1/0),Ph(this,"pasteMode","overwrite"),Ph(this,"uiContainer",this.hot.rootDocument.body),tl(this,gR,{writable:!0,value:!1}),tl(this,mR,{writable:!0,value:!1}),tl(this,pR,{writable:!0,value:!1}),tl(this,Ru,{writable:!0,value:"cells-only"}),tl(this,um,{writable:!0,value:!1}),tl(this,cm,{writable:!0,value:!1}),tl(this,Eu,{writable:!0,value:new Xhe({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),Ph(this,"copyableRanges",[])}static get PLUGIN_KEY(){return lm}static get SETTING_KEYS(){return[lm,...nde]}static get PLUGIN_PRIORITY(){return tde}isEnabled(){return!!this.hot.getSettings()[lm]}enablePlugin(){var e=this;if(this.enabled)return;const{[lm]:n}=this.hot.getSettings();if(typeof n=="object"){var r,i;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,Vo(this,gR,!!n.copyColumnHeaders),Vo(this,mR,!!n.copyColumnGroupHeaders),Vo(this,pR,!!n.copyColumnHeadersOnly),this.uiContainer=(i=n.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>Di(this,AI,sde).call(this,o)),this.addHook("afterSelectionEnd",()=>Di(this,II,ade).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),bT()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Di(e,HI,lde).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Di(e,DI,ude).call(e,...s)}),this.addHook("afterSelection",()=>Di(this,NI,cde).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Vo(this,Ru,e),Vo(this,um,!0),Di(this,uS,kI).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Vo(this,cm,!0),Di(this,uS,kI).call(this,"cut")}getRangedCopyableData(e){return vd(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=oU(e);return P(r,o=>{const s=[];P(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new jhe;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}$r(this,Eu).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);$r(this,Ru)==="column-headers-only"?n.set("headers",$r(this,Eu).getMostBottomColumnHeadersRange()):($r(this,Ru)==="with-column-headers"?n.set("headers",$r(this,Eu).getMostBottomColumnHeadersRange()):$r(this,Ru)==="with-column-group-headers"&&n.set("headers",$r(this,Eu).getAllColumnHeadersRange()),n.set("cells",$r(this,Eu).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,f=s,g=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:p,visualRow:y}=this.hot.getCellMeta(c,a);if(c=y+1,p===!0)continue;f=y,h=a;const E=[],v=o.length%r;for(;E.length<i||h<=u;){const{skipColumnOnPaste:C,visualCol:S}=this.hot.getCellMeta(s,h);if(h=S+1,C===!0)continue;g=S;const T=E.length%i;E.push(e[v][T])}o.push(E)}return this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,f,g]}onCopy(e){if(!this.hot.isListening()&&!$r(this,um)||this.isEditorOpened())return;this.setCopyableText(),Vo(this,um,!1);const n=this.getRangedData(this.copyableRanges),r=Di(this,OI,ide).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){const o=vd(n);if(e&&e.clipboardData){const s=G0(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[PI,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}Vo(this,Ru,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!$r(this,cm)||this.isEditorOpened())return;this.setCopyableText(),Vo(this,cm,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const i=vd(n);if(e&&e.clipboardData){const o=G0(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[PI,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const a=gv(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=$V(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=xre(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[r,i,o,s]=this.populateValues(n);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function kI(t){if(bT()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&fV(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function ide(t){const{rows:e}=oU(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function ode(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&wT(r)}}}function uU(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&vT(r)}}}function sde(t){t.items.push({name:"---------"},Whe(this)),$r(this,gR)&&t.items.push(Uhe(this)),$r(this,mR)&&t.items.push(Bhe(this)),$r(this,pR)&&t.items.push(Vhe(this)),t.items.push(zhe(this))}function ade(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function lde(){Di(this,lM,uU).call(this)}function ude(){Di(this,lU,ode).call(this)}function cde(){Di(this,lM,uU).call(this)}function cU(t,e){return`border_row${t}col${e}`}function td(){return{width:1,color:"#000"}}function ls(){return{hide:!0}}function hde(){return{width:1,color:"#000",cornerVisible:!1}}function cS(t){if(he(t.start)||he(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(he(t.end)||he(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Oh(t){return he(t.start)&&(t.left=t.start),he(t.end)&&(t.right=t.end),t}function hS(t,e){return{id:cU(t,e),border:hde(),row:t,col:e,top:ls(),bottom:ls(),start:ls(),end:ls()}}function dde(t,e){return Ft(e,"border")&&e.border&&(t.border=e.border),Ft(e,"top")&&he(e.top)&&(e.top?(Be(e.top)||(e.top=td()),t.top=e.top):(e.top=ls(),t.top=e.top)),Ft(e,"bottom")&&he(e.bottom)&&(e.bottom?(Be(e.bottom)||(e.bottom=td()),t.bottom=e.bottom):(e.bottom=ls(),t.bottom=e.bottom)),Ft(e,"start")&&he(e.start)&&(e.start?(Be(e.start)||(e.start=td()),t.start=e.start):(e.start=ls(),t.start=e.start)),Ft(e,"end")&&he(e.end)&&(e.end?(Be(e.end)||(e.end=td()),t.end=e.end):(e.end=ls(),t.end=e.end)),t}function ys(t,e){let n=!1;return P(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!Ft(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function Jv(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function fde(t){return t.some(e=>he(e.left)||he(e.right))}function gde(t){return t.some(e=>he(e.start)||he(e.end))}const mde=new Map([["left","start"],["right","end"]]);function pde(t){var e;return(e=mde.get(t))!==null&&e!==void 0?e:t}function wde(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(V1);return ys(this,"bottom")&&(e=Jv(e)),e},callback(e,n){const r=ys(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function vde(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(B1);return ys(this,e)&&(n=Jv(n)),n},callback(n,r){const i=ys(this,e);t.prepareBorder(r,e,i)}}}function Cde(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(U1)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!ys(this)}}}function yde(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(W1);return ys(this,e)&&(n=Jv(n)),n},callback(n,r){const i=ys(this,e);t.prepareBorder(r,e,i)}}}function Sde(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(F1);return ys(this,"top")&&(e=Jv(e)),e},callback(e,n){const r=ys(this,"top");t.prepareBorder(n,"top",r)}}}function LI(t,e){bde(t,e),e.add(t)}function bde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rde(t,e,n){return e=Ede(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ede(t){var e=Tde(t,"string");return typeof e=="symbol"?e:String(e)}function Tde(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $I(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const up="customBorders",_de=90;var FI=new WeakSet,WI=new WeakSet;class Mde extends at{constructor(){super(...arguments),LI(this,WI),LI(this,FI),Rde(this,"savedBorders",[])}static get PLUGIN_KEY(){return up}static get PLUGIN_PRIORITY(){return _de}isEnabled(){return!!this.hot.getSettings()[up]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>$I(this,FI,xde).call(this,e)),this.addHook("init",()=>$I(this,WI,Pde).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=cS(n));const o=Oc(e),s=of(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});P(e,a=>{s(a).forAll((l,u)=>{P(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,pde(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Oc(e),r=of(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return P(e,o=>{r(o).forAll((s,a)=>{P(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(Oh(l))})})}),i}clearBorders(e){e?this.setBorders(e):(P(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=hS(e,n);r&&(a=dde(a,r),P(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Oh(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);ye(e.from.row,r,o=>{ye(e.from.col,i,s=>{const a=hS(o,s);let l=0;o===e.from.row&&Ft(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&Ft(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&Ft(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&Ft(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Oh(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=cU(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=hS(e,n):o=cS(o),i?(o[r]=ls(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Oh(o)))):(o[r]=td(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Oh(o)))}prepareBorder(e,n,r){P(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":ye(o.col,s.col,a=>{ye(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":ye(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":ye(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":ye(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":ye(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){P(e,n=>{const r=cS(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return en([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ge(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){P(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){P(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ge(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):P(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return P(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return P(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):P(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);P(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[up];if(Array.isArray(e)){const n=Zn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=fde(e),r=gde(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function xde(t){this.hot.getSettings()[up]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase($1)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Sde(this),yde(this),wde(this),vde(this),Cde(this)]}})}function Pde(){this.changeBorderSettings()}function Ode(t,e){Ade(t,e),e.add(t)}function Ade(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dS(t,e,n){return e=Ide(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ide(t){var e=Hde(t,"string");return typeof e=="symbol"?e:String(e)}function Hde(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VI(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const BI="dragToScroll",Dde=100;var fS=new WeakSet;class Nde extends at{constructor(){super(...arguments),Ode(this,fS),dS(this,"boundaries",null),dS(this,"callback",null),dS(this,"listening",!1)}static get PLUGIN_KEY(){return BI}static get PLUGIN_PRIORITY(){return Dde}isEnabled(){return!!this.hot.getSettings()[BI]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>VI(this,fS,UI).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>VI(this,fS,UI).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=Zd(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function UI(t){if(_a(t))return;const e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback((n,r)=>{n<0?e.scrollLeft-=50:n>0&&(e.scrollLeft+=50),r<0?e.scrollTop-=20:r>0&&(e.scrollTop+=20)}),this.listen())}function nl(t,e){kde(t,e),e.add(t)}function kde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gS(t,e,n){return e=Lde(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lde(t){var e=$de(t,"string");return typeof e=="symbol"?e:String(e)}function $de(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ks(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}me.getSingleton().register("afterDropdownMenuDefaultOptions");me.getSingleton().register("beforeDropdownMenuShow");me.getSingleton().register("afterDropdownMenuShow");me.getSingleton().register("afterDropdownMenuHide");me.getSingleton().register("afterDropdownMenuExecute");const cp="dropdownMenu",Fde=230,wR="changeType",mS=cp;var uM=new WeakSet,zI=new WeakSet,GI=new WeakSet,jI=new WeakSet,YI=new WeakSet,KI=new WeakSet,XI=new WeakSet;class eC extends at{static get PLUGIN_KEY(){return cp}static get PLUGIN_PRIORITY(){return Fde}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Vf,Bf,Ke,zf,Ke,Gv,Ke,Uf,Ke,si]}constructor(e){super(e),nl(this,XI),nl(this,KI),nl(this,YI),nl(this,jI),nl(this,GI),nl(this,zI),nl(this,uM),gS(this,"commandExecutor",new q2(this.hot)),gS(this,"itemsFactory",null),gS(this,"menu",null),this.hot.addHook("afterGetColHeader",(n,r)=>Ks(this,GI,Vde).call(this,n,r))}isEnabled(){return this.hot.getSettings()[cp]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new Q2(this.hot,eC.DEFAULT_ITEMS);const n=this.hot.getSettings()[cp],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Kc(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>Ks(this,jI,Bde).call(this)),this.menu.addLocalHook("afterOpen",()=>Ks(this,YI,Ude).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>Ks(this,KI,zde).call(this,o)),this.menu.addLocalHook("afterClose",()=>Ks(this,XI,Gde).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),P(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=zv(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width})}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:mS},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:mS}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(mS)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Ks(this,zI,Wde).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),je(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function hU(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Wde(t){if(t.stopPropagation(),De(t.target,wR)){const e=zv(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function Vde(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${wR}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=wR,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Re(s,[ba(this.hot.getTranslatedPhrase(I_))]),Re(e,[Bc("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function Bde(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Ude(){this.hot.runHooks("afterDropdownMenuShow",this),Ks(this,uM,hU).call(this,this.menu)}function zde(t){Ks(this,uM,hU).call(this,t)}function Gde(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}eC.SEPARATOR={name:Ke};function qI(t,e,n){return e=jde(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jde(t){var e=Yde(t,"string");return typeof e=="symbol"?e:String(e)}function Yde(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kde{constructor(e){qI(this,"hot",void 0),qI(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return ye(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(ye(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();ye(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();ye(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const Xde=Kde;function QI(t,e,n){return e=qde(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qde(t){var e=Qde(t,"string");return typeof e=="symbol"?e:String(e)}function Qde(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cM{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){QI(this,"dataProvider",void 0),QI(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=gr(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=sn(gr(cM.DEFAULT_OPTIONS),n),n=sn(n,e),n.filename=hT(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const Zde=cM,Jde=String.fromCharCode(13),efe=String.fromCharCode(34),tfe=String.fromCharCode(10);class nfe extends Zde{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?String.fromCharCode(65279):"";return i&&(r=Ge(r,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),P(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Yt(e);return r!==""&&(n||r.indexOf(Jde)>=0||r.indexOf(efe)>=0||r.indexOf(tfe)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const rfe=nfe,ife="csv",vR={[ife]:rfe};function ofe(t,e,n){return typeof vR[t]=="function"?new vR[t](e,n):null}const sfe="exportFile",afe=240;class lfe extends at{static get PLUGIN_KEY(){return sfe}static get PLUGIN_PRIORITY(){return afe}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!vR[e])throw new Error(`Export format type "${e}" is not supported.`);return ofe(e,new Xde(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Tu(t,e,n){return e=ufe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ufe(t){var e=cfe(t,"string");return typeof e=="symbol"?e:String(e)}function cfe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gf{constructor(e,n){let{id:r,stateless:i=!0}=n;Tu(this,"hot",void 0),Tu(this,"id",void 0),Tu(this,"elements",[]),Tu(this,"hidden",!1),Tu(this,"stateId",""),Tu(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new _v)}getElements(){return this.elements}reset(){P(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),P(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}vt(Gf,Nr);const cf={};function xa(t,e){if(!cf[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=cf[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function _l(t){if(!cf[t])throw Error(`Filter condition "${t}" does not exist.`);return cf[t].descriptor}function an(t,e,n){n.key=t,cf[t]={condition:e,descriptor:n}}const _n="none";function hfe(){return!0}an(_n,hfe,{name:Mv,inputsCount:0,showOperators:!1});const bd="empty";function dfe(t){return gn(t.value)}an(bd,dfe,{name:q1,inputsCount:0,showOperators:!0});const hp="not_empty";function ffe(t,e){return!xa(bd,e)(t)}an(hp,ffe,{name:Q1,inputsCount:0,showOperators:!0});const Rd="eq";function gfe(t,e){let[n]=e;return Yt(t.value).toLocaleLowerCase(t.meta.locale)===Yt(n)}an(Rd,gfe,{name:Z1,inputsCount:1,showOperators:!0});const dp="neq";function mfe(t,e){return!xa(Rd,e)(t)}an(dp,mfe,{name:J1,inputsCount:1,showOperators:!0});const dU="gt";function pfe(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}an(dU,pfe,{name:i_,inputsCount:1,showOperators:!0});const fU="gte";function wfe(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}an(fU,wfe,{name:o_,inputsCount:1,showOperators:!0});const gU="lt";function vfe(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}an(gU,vfe,{name:s_,inputsCount:1,showOperators:!0});const mU="lte";function Cfe(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}an(mU,Cfe,{name:a_,inputsCount:1,showOperators:!0});const hM="date_after";function yfe(t,e){let[n]=e;const r=ee(t.value,t.meta.dateFormat),i=ee(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}an(hM,yfe,{name:c_,inputsCount:1,showOperators:!0});const dM="date_before";function Sfe(t,e){let[n]=e;const r=ee(t.value,t.meta.dateFormat),i=ee(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}an(dM,Sfe,{name:h_,inputsCount:1,showOperators:!0});const Cw="between";function bfe(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=xa(dM,[o]),a=xa(hM,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}an(Cw,bfe,{name:l_,inputsCount:2,showOperators:!0});const pU="not_between";function Rfe(t,e){return!xa(Cw,e)(t)}an(pU,Rfe,{name:u_,inputsCount:2,showOperators:!0});const wU="begins_with";function Efe(t,e){let[n]=e;return Yt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Yt(n))}an(wU,Efe,{name:e_,inputsCount:1,showOperators:!0});const vU="ends_with";function Tfe(t,e){let[n]=e;return Yt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Yt(n))}an(vU,Tfe,{name:t_,inputsCount:1,showOperators:!0});const fM="contains";function _fe(t,e){let[n]=e;return Yt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Yt(n))>=0}an(fM,_fe,{name:n_,inputsCount:1,showOperators:!0});const CU="not_contains";function Mfe(t,e){return!xa(fM,e)(t)}an(CU,Mfe,{name:r_,inputsCount:1,showOperators:!0});const yU="date_tomorrow";function xfe(t){const e=ee(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ee().subtract(-1,"days").startOf("day"),"d"):!1}an(yU,xfe,{name:f_,inputsCount:0});const SU="date_today";function Pfe(t){const e=ee(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ee().startOf("day"),"d"):!1}an(SU,Pfe,{name:d_,inputsCount:0});const bU="date_yesterday";function Ofe(t){const e=ee(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(ee().subtract(1,"days").startOf("day"),"d"):!1}an(bU,Ofe,{name:g_,inputsCount:0});JV();function Afe(t,e){let n=t;return n===""&&(n=`(${e})`),n}const CR=new Set([1]).has(1),Ife=CR&&typeof Array.from=="function";function jf(t){let e=t;return CR&&(e=new Set(e)),function(n){let r;return CR?r=e.has(n):r=!!~e.indexOf(n),r}}function RU(t){return t??""}function yR(t){let e=t;return Ife?e=Array.from(new Set(e)):e=lT(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function ZI(t,e,n,r){const i=[],o=t===e;let s;return o||(s=jf(e)),P(t,a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:Afe(a,n)};r&&r(u),i.push(u)}),i}const Ml="by_value";function Hfe(t,e){let[n]=e;return n(t.value)}an(Ml,Hfe,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[jf(e)]},showOperators:!1});const hf={};function Dfe(t){if(!hf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=hf[t].func;return function(n,r){return e(n,r)}}function Nfe(t){return hf[t].name}function gM(t,e,n){hf[t]={name:e,func:n}}const va="conjunction",kfe=w_;function Lfe(t,e){return t.every(n=>n.func(e))}gM(va,kfe,Lfe);const yw="disjunction",$fe=xv;function Ffe(t,e){return t.some(n=>n.func(e))}gM(yw,$fe,Ffe);const mM="disjunctionWithExtraCondition",Wfe=xv;function Vfe(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}gM(mM,Wfe,Vfe);const Bfe="numeric",EU="text",Ufe="date",JI={[Bfe]:[_n,Ke,bd,hp,Ke,Rd,dp,Ke,dU,fU,gU,mU,Cw,pU],[EU]:[_n,Ke,bd,hp,Ke,Rd,dp,Ke,wU,vU,Ke,fM,CU],[Ufe]:[_n,Ke,bd,hp,Ke,Rd,dp,Ke,dM,hM,Cw,Ke,yU,SU,bU]};function zfe(t){const e=[];let n=t;return JI[n]||(n=EU),P(JI[n],r=>{let i;r===Ke?i={name:Ke}:i=gr(_l(r)),e.push(i)}),e}function Ah(t,e,n){return e=Gfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gfe(t){var e=jfe(t,"string");return typeof e=="symbol"?e:String(e)}function jfe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pS="built",wS="building",eH=["click","input","keydown","keypress","keyup","focus","blur","change"];let Ui=class TU{static get DEFAULTS(){return gr({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Ah(this,"hot",void 0),Ah(this,"eventManager",new Kr(this)),Ah(this,"options",void 0),Ah(this,"_element",void 0),Ah(this,"buildState",void 0),this.hot=e,this.options=sn(TU.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===wS?this._element:this.buildState===pS?(this.update(),this._element):(this.buildState=wS,this.build(),this.buildState=pS,this._element)}isBuilt(){return this.buildState===pS}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Cr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=wS),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&te(this._element,this.options.className),this.options.children.length)P(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),je(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),P(eH,r=>e(n,r))}else P(eH,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};vt(Ui,Nr);function Yfe(t,e){_U(t,e),e.add(t)}function Kfe(t,e,n){_U(t,e),e.set(t,n)}function _U(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hm(t,e){var n=MU(t,e,"get");return Xfe(t,n)}function Xfe(t,e){return e.get?e.get.call(t):e.value}function qfe(t,e,n){var r=MU(t,e,"set");return Qfe(t,r,n),n}function MU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Qfe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Zfe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var _u=new WeakMap,tH=new WeakSet;class Ca extends Ui{static get DEFAULTS(){return gr({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,sn(Ca.DEFAULTS,n)),Yfe(this,tH),Kfe(this,_u,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>Zfe(this,tH,Jfe).call(this,e))}build(){super.build(),qfe(this,_u,this._element.firstChild),te(this._element,"htUIInput"),this.update()}update(){this.isBuilt()&&(hm(this,_u).type=this.options.type,hm(this,_u).placeholder=this.translateIfPossible(this.options.placeholder),hm(this,_u).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&hm(this,_u).focus()}}function Jfe(t){this.options.value=t.target.value}function vS(t,e){xU(t,e),e.add(t)}function Ih(t,e,n){xU(t,e),e.set(t,n)}function xU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mu(t,e,n){var r=PU(t,e,"set");return ege(t,r,n),n}function ege(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function CS(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Vt(t,e){var n=PU(t,e,"get");return tge(t,n)}function PU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function tge(t,e){return e.get?e.get.call(t):e.value}var pn=new WeakMap,dm=new WeakMap,fm=new WeakMap,yS=new WeakMap,gm=new WeakMap,nH=new WeakSet,rH=new WeakSet,iH=new WeakSet;class df extends Ui{static get DEFAULTS(){return gr({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,sn(df.DEFAULTS,n)),vS(this,iH),vS(this,rH),vS(this,nH),Ih(this,pn,{writable:!0,value:null}),Ih(this,dm,{writable:!0,value:[]}),Ih(this,fm,{writable:!0,value:void 0}),Ih(this,yS,{writable:!0,value:void 0}),Ih(this,gm,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return Vt(this,pn)}registerHooks(){this.addLocalHook("click",()=>CS(this,iH,ige).call(this))}setItems(e){Mu(this,dm,this.translateNames(e)),Vt(this,pn)&&Vt(this,pn).setMenuItems(Vt(this,dm))}translateNames(e){return P(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Mu(this,pn,new Kc(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Vt(this,pn).setMenuItems(Vt(this,dm));const e=new Ui(this.hot,{className:"htUISelectCaption"}),n=new Ui(this.hot,{className:"htUISelectDropdown"});Mu(this,fm,e),Mu(this,yS,e.element),Mu(this,gm,n),this.hot.getSettings().ariaTags&&(Re(n.element,[_s()]),Re(this._element,[ZW()])),P([e,n],r=>this._element.appendChild(r.element)),Vt(this,pn).addLocalHook("select",r=>CS(this,nH,nge).call(this,r)),Vt(this,pn).addLocalHook("afterClose",()=>CS(this,rH,rge).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Vt(this,pn).hot.getTranslatedPhrase(Mv),Vt(this,yS).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Vt(this,pn)&&(Vt(this,pn).open(),Vt(this,pn).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Vt(this,pn).getNavigator().toFirstItem(),Vt(this,pn).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Vt(this,pn)&&Vt(this,pn).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Vt(this,pn)&&(Vt(this,pn).destroy(),Mu(this,pn,null)),Vt(this,fm)&&Vt(this,fm).destroy(),Vt(this,gm)&&Vt(this,gm).destroy(),super.destroy()}}function nge(t){t.name!==Ke&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function rge(){this.runLocalHooks("afterClose")}function ige(){this.openOptions()}function oH(t,e){oge(t,e),e.add(t)}function oge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sH(t,e,n){return e=sge(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sge(t){var e=age(t,"string");return typeof e=="symbol"?e:String(e)}function age(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aH(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var lH=new WeakSet,uH=new WeakSet;class SR extends Gf{constructor(e,n){super(e,{id:n.id,stateless:!1}),oH(this,uH),oH(this,lH),sH(this,"name",""),sH(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new df(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Ca(this.hot,{placeholder:R_})),this.elements.push(new Ca(this.hot,{placeholder:E_})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>aH(this,lH,lge).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),P(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>aH(this,uH,uge).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=gr(e.command);n.name.startsWith(qt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),P(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||_l(_n),n=[];return P(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=_l(e?e.name:_n);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||P(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof df)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Ca)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{te(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&te(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return te(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),P(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[_l(_n)];if(e!==null){const{visualIndex:r}=e;n=zfe(this.hot.getDataType(0,r,this.hot.countRows(),r))}P(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function lge(t){P(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function uge(t){zc(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ci(t))}function cH(t,e,n){cge(t,e),e.set(t,n)}function cge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hh(t,e){var n=OU(t,e,"get");return hge(t,n)}function hge(t,e){return e.get?e.get.call(t):e.value}function hH(t,e,n){var r=OU(t,e,"set");return dge(t,r,n),n}function OU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function dge(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var xu=new WeakMap,SS=new WeakMap;class Sw extends Ui{static get DEFAULTS(){return gr({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,sn(Sw.DEFAULTS,n)),cH(this,xu,{writable:!0,value:void 0}),cH(this,SS,{writable:!0,value:void 0})}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),hH(this,SS,e),hH(this,xu,this._element.firstChild),Hh(this,xu).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Hh(this,SS).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return Hh(this,xu).checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Hh(this,xu).checked=e)}focus(){this.isBuilt()&&Hh(this,xu).focus()}}function fge(t,e){gge(t,e),e.add(t)}function gge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mge(t,e,n){return e=pge(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pge(t){var e=wge(t,"string");return typeof e=="symbol"?e:String(e)}function wge(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vge(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const dH=0;var fH=new WeakSet;class Cge extends Gf{constructor(e,n){super(e,{id:n.id,stateless:!1}),fge(this,fH),mge(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(te(n.parentNode,"htFiltersMenuOperators"),P(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[va,yw];P(e,n=>{const r=new Sw(this.hot,{name:"operator",label:{htmlFor:n,textContent:Nfe(n)},value:n,checked:n===e[dH],id:n});r.addLocalHook("change",i=>vge(this,fH,yge).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(mt`Radio button with index ${e} doesn't exist.`);P(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Sw&&n.isChecked());return e?e.getValue():va}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&P(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:va,n=arguments.length>1?arguments[1]:void 0,r=e;r===mM&&(r=yw),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(dH)}}function yge(t){this.setState(t.target.value)}function Sge(t,e,n){bge(t,e),e.set(t,n)}function bge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bS(t,e){var n=AU(t,e,"get");return Rge(t,n)}function Rge(t,e){return e.get?e.get.call(t):e.value}function Ege(t,e,n){var r=AU(t,e,"set");return Tge(t,r,n),n}function AU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Tge(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Dh=new WeakMap;class ff extends Ui{static get DEFAULTS(){return gr({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,sn(ff.DEFAULTS,n)),Sge(this,Dh,{writable:!0,value:void 0})}build(){super.build(),Ege(this,Dh,this._element.firstChild)}update(){this.isBuilt()&&(bS(this,Dh).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&bS(this,Dh).focus()}activate(){bS(this,Dh).click()}}function mm(t,e){IU(t,e),e.add(t)}function Pu(t,e,n){IU(t,e),e.set(t,n)}function IU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pm(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ke(t,e){var n=HU(t,e,"get");return _ge(t,n)}function _ge(t,e){return e.get?e.get.call(t):e.value}function Mi(t,e,n){var r=HU(t,e,"set");return Mge(t,r,n),n}function HU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Mge(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const gH="multipleSelect.itemBox";var Ii=new WeakMap,Nt=new WeakMap,RS=new WeakMap,Bo=new WeakMap,Fs=new WeakMap,Ws=new WeakMap,mH=new WeakSet,pH=new WeakSet,wH=new WeakSet,vH=new WeakSet;class gf extends Ui{static get DEFAULTS(){return gr({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,sn(gf.DEFAULTS,n)),mm(this,vH),mm(this,wH),mm(this,pH),mm(this,mH),Pu(this,Ii,{writable:!0,value:[]}),Pu(this,Nt,{writable:!0,value:void 0}),Pu(this,RS,{writable:!0,value:void 0}),Pu(this,Bo,{writable:!0,value:void 0}),Pu(this,Fs,{writable:!0,value:void 0}),Pu(this,Ws,{writable:!0,value:void 0}),Mi(this,Bo,new Ca(this.hot,{placeholder:b_,className:"htUIMultipleSelectSearch"})),Mi(this,Fs,new ff(this.hot,{textContent:v_,className:"htUISelectAll"})),Mi(this,Ws,new ff(this.hot,{textContent:C_,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return ke(this,Nt)}registerHooks(){ke(this,Bo).addLocalHook("keydown",e=>pm(this,pH,Pge).call(this,e)),ke(this,Bo).addLocalHook("input",e=>pm(this,mH,xge).call(this,e)),ke(this,Fs).addLocalHook("click",e=>pm(this,wH,Oge).call(this,e)),ke(this,Ws).addLocalHook("click",e=>pm(this,vH,Age).call(this,e))}setItems(e){Mi(this,Ii,e),ke(this,Nt)&&ke(this,Nt).loadData(ke(this,Ii))}setLocale(e){Mi(this,RS,e)}getLocale(){return ke(this,RS)}getItems(){return[...ke(this,Ii)]}getValue(){return Hge(ke(this,Ii))}getSearchInputElement(){return ke(this,Bo)}getSelectAllElement(){return ke(this,Fs)}getClearAllElement(){return ke(this,Ws)}isSelectedAllValues(){return ke(this,Ii).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new Ui(this.hot,{className:"htUISelectionControls",children:[ke(this,Fs),ke(this,Ws)]});this._element.appendChild(ke(this,Bo).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{if(!this._element)return;ke(this,Nt)&&ke(this,Nt).destroy(),te(o,"htUIMultipleSelectHot"),Mi(this,Nt,new this.hot.constructor(o,{data:ke(this,Ii),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,h,f,g)=>{l.title=g.instance.getDataAtRowProp(u,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{ke(this,Nt).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>ke(this,Nt).container.scrollWidth-yn(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),ke(this,Nt).init();const a=ke(this,Nt).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:gH}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{ke(this,Nt).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:gH})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&ke(this,Nt).listen()}reset(){ke(this,Bo).reset(),ke(this,Fs).reset(),ke(this,Ws).reset()}update(){this.isBuilt()&&(ke(this,Nt).loadData(Ige(ke(this,Ii),this.options.value)),super.update())}destroy(){ke(this,Nt)&&ke(this,Nt).destroy(),ke(this,Bo).destroy(),ke(this,Ws).destroy(),ke(this,Fs).destroy(),Mi(this,Bo,null),Mi(this,Ws,null),Mi(this,Fs,null),Mi(this,Nt,null),Mi(this,Ii,null),super.destroy()}}function xge(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...ke(this,Ii)]:n=Yr(ke(this,Ii),r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),ke(this,Nt).loadData(n)}function Pge(t){this.runLocalHooks("keydown",t,this),yT(zc,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Ci(t),ke(this,Nt).listen(),ke(this,Nt).selectCell(0,0))}function Oge(t){const e=[];t.preventDefault(),P(ke(this,Nt).getSourceData(),(n,r)=>{n.checked=!0,e.push(ZT(n,r)[0])}),ke(this,Nt).setSourceDataAtCell(e)}function Age(t){const e=[];t.preventDefault(),P(ke(this,Nt).getSourceData(),(n,r)=>{n.checked=!1,e.push(ZT(n,r)[0])}),ke(this,Nt).setSourceDataAtCell(e)}function Ige(t,e){const n=jf(e);return Ge(t,r=>(r.checked=n(r.value),r))}function Hge(t){const e=[];return P(t,n=>{n.checked&&e.push(n.value)}),e}function Dge(t,e){Nge(t,e),e.add(t)}function Nge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kge(t,e,n){return e=Lge(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lge(t){var e=$ge(t,"string");return typeof e=="symbol"?e:String(e)}function $ge(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fge(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var CH=new WeakSet;class Wge extends Gf{constructor(e,n){super(e,{id:n.id,stateless:!1}),Dge(this,CH),kge(this,"name",""),this.name=n.name,this.elements.push(new gf(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Fge(this,CH,Vge).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Ml){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?_n:Ml},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=Yr(i,h=>h.name===Ml),u={},c=this.hot.getTranslatedPhrase(uw);if(l){const h=yR(Ge(s(r,a),y=>y.value));o&&(l.args[0]=o);const f=[],g=ZI(h,l.args[0],c,y=>{y.checked&&f.push(y.value)}),p=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,p).locale,u.args=[f],u.command=_l(Ml),u.itemsSnapshot=g}else u.args=[],u.command=_l(_n);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof gf)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{te(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return te(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),P(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(uw),n=yR(this._getColumnVisibleValues()),r=ZI(n,n,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(n);const i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ge(this.hot.getDataAtCol(e.visualIndex),n=>RU(n))}}function Vge(t){zc(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ci(t))}var DU;function Bge(t,e){Uge(t,e),e.add(t)}function Uge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zge(t,e,n){return e=Gge(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gge(t){var e=jge(t,"string");return typeof e=="symbol"?e:String(e)}function jge(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yge(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var yH=new WeakSet;class mf extends Gf{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Bge(this,yH),zge(this,"name",""),this.name=n.name,this.elements.push(new Ca(this.hot,{type:"button",value:y_,className:"htUIButton htUIButtonOK",identifier:mf.BUTTON_OK})),this.elements.push(new Ca(this.hot,{type:"button",value:S_,className:"htUIButton htUIButtonCancel",identifier:mf.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){P(this.elements,e=>{e.addLocalHook("click",(n,r)=>Yge(this,yH,Kge).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(te(n.parentNode,"htFiltersMenuActionBar"),P(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}DU=mf;function Kge(t,e){e.options.identifier===DU.BUTTON_OK?this.accept():this.cancel()}function ES(t,e,n){return e=Xge(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xge(t){var e=qge(t,"string");return typeof e=="symbol"?e:String(e)}function qge(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const SH="ConditionCollection.filteringStates";class NU{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;ES(this,"hot",void 0),ES(this,"isMapRegistrable",void 0),ES(this,"filteringStates",new _v),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(SH,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:va;return e.length?Dfe(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:va,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=Ge(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(mt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(bt(hf[r]))throw new Error(mt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:xa(a,s)}]},i):u.push({name:a,args:s,func:xa(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return en(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:Ge(o,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),P(e,n=>{P(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(SH),this.filteringStates=null,this.clearLocalHooks()}}vt(NU,Nr);const kU=NU;function bH(t,e,n){return e=Qge(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qge(t){var e=Zge(t,"string");return typeof e=="symbol"?e:String(e)}function Zge(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jge{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];bH(this,"conditionCollection",void 0),bH(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return P(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return P(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return P(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}const LU=Jge;function TS(t,e){eme(t,e),e.add(t)}function eme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rl(t,e,n){return e=tme(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tme(t){var e=nme(t,"string");return typeof e=="symbol"?e:String(e)}function nme(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _S(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var RH=new WeakSet,EH=new WeakSet,TH=new WeakSet;class $U{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];TS(this,TH),TS(this,EH),TS(this,RH),rl(this,"hot",void 0),rl(this,"conditionCollection",void 0),rl(this,"columnDataFactory",void 0),rl(this,"changes",[]),rl(this,"grouping",!1),rl(this,"latestEditedColumnPosition",-1),rl(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>_S(this,RH,rme).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>_S(this,EH,ime).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>_S(this,TH,ome).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,P(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=mV(function(c,h){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const g=new kU(r.hot,!1),p=[].concat(c,f);g.importAllConditions(p);const y=r.columnDataFactory(h);let E;g.isEmpty()?E=y:E=new LU(g,C=>r.columnDataFactory(C)).filter(),E=Ge(E,C=>C.meta.visualRow);const v=jf(E);return g.destroy(),Yr(y,C=>v(C.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),je(this,(e,n)=>{this[n]=null})}}function rme(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function ime(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function ome(){P(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}vt($U,Nr);const sme=$U;function ame(t){return J2({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof gf)return r;if(i.element&&!Ta(i.element))return!1;i.focus()}})}const Nh="filters";function lme(t,e){const n=ame(e),r=s=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(Nh),n.setCurrentPage(e.indexOf(s))};e.forEach(s=>{s instanceof Ui&&(s.addLocalHook("click",r(s)),s.addLocalHook("focus",r(s)),s.addLocalHook("afterClose",r(s)))}),t.addLocalHook("afterSelectionChange",s=>{s.key.startsWith("filter_")||n.clear()});function i(s){const a=t.getKeyboardShortcutsCtrl(),l=s.getKeyboardShortcutsCtrl();n.clear(),l.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:a.getContext(Nh),callback:()=>{s.isSubMenu()&&s.close(),a.listen(Nh)}}]),!s.isSubMenu()&&a.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:u=>{t.getNavigator().clear(),u.shiftKey?n.toPreviousItem():n.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:u=>{const c=e[n.getCurrentPage()];c instanceof df&&(c.openOptions(),u.preventDefault()),c instanceof ff&&(c.activate(),u.preventDefault()),c instanceof Ui||u.preventDefault()}}],Nh)}t.addLocalHook("afterSubmenuOpen",i),t.addLocalHook("afterOpen",i);function o(){t.focus(),t.getKeyboardShortcutsCtrl().listen(Nh)}return{...n,listen:o}}function Uo(t,e){FU(t,e),e.add(t)}function ume(t,e,n){FU(t,e),e.set(t,n)}function FU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kh(t,e,n){return e=cme(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cme(t){var e=hme(t,"string");return typeof e=="symbol"?e:String(e)}function hme(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dme(t,e,n){var r=WU(t,e,"set");return fme(t,r,n),n}function fme(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function wm(t,e){var n=WU(t,e,"get");return gme(t,n)}function WU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gme(t,e){return e.get?e.get.call(t):e.value}function xi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const bR="filters",mme=250,_H=bR;var Ou=new WeakMap,MH=new WeakSet,xH=new WeakSet,PH=new WeakSet,OH=new WeakSet,MS=new WeakSet,AH=new WeakSet,xS=new WeakSet,IH=new WeakSet,HH=new WeakSet;class pme extends at{static get PLUGIN_KEY(){return bR}static get PLUGIN_PRIORITY(){return mme}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),Uo(this,HH),Uo(this,IH),Uo(this,xS),Uo(this,AH),Uo(this,MS),Uo(this,OH),Uo(this,PH),Uo(this,xH),Uo(this,MH),kh(this,"dropdownMenuPlugin",null),kh(this,"conditionCollection",null),kh(this,"conditionUpdateObserver",null),kh(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),kh(this,"filtersRowsMap",null),ume(this,Ou,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(n,r)=>xi(this,IH,bme).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[bR]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new $f),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>xi(this,MS,DH).call(this,"accept")),s.addLocalHook("cancel",()=>xi(this,MS,DH).call(this,"cancel")),s.addLocalHook("change",a=>xi(this,AH,Sme).call(this,s,a)),s),i=()=>`${this.hot.getTranslatedPhrase(m_)}:`,o=()=>`${this.hot.getTranslatedPhrase(p_)}:`;if(!this.components.get("filter_by_condition")){const s=new SR(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>xi(this,xS,NH).call(this)),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Cge(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new SR(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>xi(this,xS,NH).call(this)),this.components.set("filter_by_condition2",r(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new Wge(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new mf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new kU(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new sme(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>xi(this,HH,Rme).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>xi(this,OH,yme).call(this,s)),this.addHook("afterDropdownMenuShow",()=>xi(this,xH,vme).call(this)),this.addHook("afterDropdownMenuHide",()=>xi(this,PH,Cme).call(this)),this.addHook("afterChange",s=>xi(this,MH,wme).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!wm(this,Ou)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>s.focus()},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];dme(this,Ou,lme(s,a));const l=u=>{wm(this,Ou).listen(),u.preventDefault(),zc(u.keyCode,"TAB")&&(u.shiftKey?wm(this,Ou).toPreviousItem():wm(this,Ou).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:_H})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(_H)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:va;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ge(n.filter(),u=>u.meta.visualRow);const l=jf(i);ye(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),P(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return P(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:f,dateFormat:g,locale:p}=this.hot.getCellMeta(o,n),y=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:f,dateFormat:g,locale:p},value:RU(y)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=yR(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===yw&&n.command.key!==_n&&r.command.key!==_n&&i.command.key!==_n?o=mM:i.command.key!==_n&&(n.command.key===_n||r.command.key===_n)&&(o=va),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new LU(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return P(i,s=>{P(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function wme(t){t&&P(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function vme(){this.restoreComponents(Array.from(this.components.values()))}function Cme(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function yme(t){t.items.push({name:Ke}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function DH(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==_n&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==_n&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==_n&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Sme(t,e){this.updateDependentComponentsVisibility(),t.constructor===SR&&!e.inputsCount&&this.setListeningDropdownMenu()}function NH(){this.setListeningDropdownMenu()}function bme(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?te(e,"htFiltersActive"):Le(e,"htFiltersActive")}function Rme(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(s=>s.name===Ml),o=n.filter(s=>s.name!==Ml);if(i.length>=2||o.length>=3)Rt(mt`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(s,r),this.components.get("filter_by_value").updateState(t)}}const VU="internal-use-in-handsontable",RR={licenseKey:VU,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function BU(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Kn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function UU(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Eme(t){var e;const n=t[Kn],r=UU(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=BU(t);return{...RR,...r,...i}}function Tme(t){var e;const n=t[Kn],r=UU(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=BU(t);return{...r,...i}}function _me(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function tC(){const t="engine_relationship",e=qi(Kn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function pM(){const t="shared_engine_usage",e=qi(Kn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Mme(t){const e=t.getSettings(),n=e[Kn],r=n==null?void 0:n.engine;if(n===!0||bt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return xme((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&bt(r.hyperformula)){const o=tC(),s=pM().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:VU}),(r.getConfig().leapYear1900!==RR.leapYear1900||vv(r.getConfig().nullDate,RR.nullDate)===!1)&&Rt(mt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function xme(t,e,n){const r=e[Kn],i=Eme(e),o=tC(),s=pM();Pme(t,r.functions),Ome(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Ame(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function kH(t){var e;const n=tC(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function LH(t,e){if(t){const n=tC(),r=n.get(t),i=pM(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Pme(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){Rt(s.message)}})}function Ome(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){Rt(r.message)}}}function Ame(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){Rt(a.message)}}),t.resumeEvaluation())}function Ime(t,e){return(bt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const zU="DD/MM/YYYY";function GU(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Hme(t){return GU(t)?t.substr(1):t}function Dme(t){return typeof t=="string"&&t.startsWith("=")}function wM(t,e){return typeof t=="string"&&e==="date"}function jU(t,e){return ee(t,e,!0).isValid()}function YU(t,e){return ee(t,e,!0).format(zU)}function Nme(t,e){return ee(t,zU,!0).format(e)}function KU(t,e){const r=new Date(Date.UTC(0,0,t+-1));return ee(r).format(e)}function il(t,e,n){kme(t,e),e.set(t,n)}function kme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mt(t,e){var n=XU(t,e,"get");return Lme(t,n)}function Lme(t,e){return e.get?e.get.call(t):e.value}function Vs(t,e,n){var r=XU(t,e,"set");return $me(t,r,n),n}function XU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function $me(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Lh=new WeakMap,Bs=new WeakMap,kr=new WeakMap,vm=new WeakMap,PS=new WeakMap,OS=new WeakMap,Cm=new WeakMap;class Fme{constructor(e,n,r){il(this,Lh,{writable:!0,value:void 0}),il(this,Bs,{writable:!0,value:void 0}),il(this,kr,{writable:!0,value:void 0}),il(this,vm,{writable:!0,value:[]}),il(this,PS,{writable:!0,value:[]}),il(this,OS,{writable:!0,value:void 0}),il(this,Cm,{writable:!0,value:[]}),Vs(this,Lh,e),Vs(this,Bs,n),Vs(this,kr,r)}setRemovedHfIndexes(e){return Vs(this,Cm,e.map(n=>{const r=Mt(this,Bs).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Mt(this,Cm)}getRemovedHfIndexes(){return Mt(this,Cm)}getHfIndexFromVisualIndex(e){const n=Mt(this,Bs).getIndexesSequence(),r=Mt(this,Bs).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${Qn(Mt(this,Lh))}s`;Mt(this,kr).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&Mt(this,kr).getEngine()[r](Mt(this,kr).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(Vs(this,PS,e.map(i=>this.getHfIndexFromVisualIndex(i))),Vs(this,OS,this.getHfIndexFromVisualIndex(n)))}getMoveLine(e,n){const r=Mt(this,Bs).getNumberOfIndexes(),i=Array.from(Array(r).keys()).filter(s=>e.includes(s)===!1);if(n===0){var o;return(o=i[n])!==null&&o!==void 0?o:0}return i[n-1]+1}getInitiallyCalculatedMoves(e,n){let r=this.getMoveLine(e,n);const i=[];return e.forEach(o=>{const s={from:o,to:r};i.forEach(a=>{const l=a.from>a.to,u=a.to<=s.from;a.from>s.from&&u&&l&&(s.from+=1)}),s.from>=r&&(r+=1),i.push(s)}),i}adjustedCalculatedMoves(e){return e.forEach((n,r)=>{e.slice(r+1).forEach(o=>{const s=o.from<o.to;o.from>n.from&&s&&(o.from-=1)})}),e}calculateAndSyncMoves(e,n){if(Mt(this,kr).isPerformingUndoRedo()||e===!1||n===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(Mt(this,PS),Mt(this,OS)));Mt(this,kr).getSheetId()===null?Mt(this,kr).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Qn(Mt(this,Lh))}Order`;return n=>{if(Mt(this,kr).isPerformingUndoRedo())return;const r=Mt(this,Bs).getIndexesSequence();if(n==="update"){const i=Mt(this,vm).map(l=>r.indexOf(l)),o=Mt(this,kr).getEngine().getSheetDimensions(Mt(this,kr).getSheetId());let s;Mt(this,Lh)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);Mt(this,kr).getEngine()[e](Mt(this,kr).getSheetId(),i)}Vs(this,vm,r)}}init(){Vs(this,vm,Mt(this,Bs).getIndexesSequence())}}const $H=Fme;function ol(t,e,n){Wme(t,e),e.set(t,n)}function Wme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zo(t,e){var n=qU(t,e,"get");return Vme(t,n)}function Vme(t,e){return e.get?e.get.call(t):e.value}function sl(t,e,n){var r=qU(t,e,"set");return Bme(t,r,n),n}function qU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Bme(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ym=new WeakMap,Sm=new WeakMap,AS=new WeakMap,IS=new WeakMap,HS=new WeakMap,DS=new WeakMap,NS=new WeakMap;class Ume{constructor(e,n,r){ol(this,ym,{writable:!0,value:void 0}),ol(this,Sm,{writable:!0,value:void 0}),ol(this,AS,{writable:!0,value:void 0}),ol(this,IS,{writable:!0,value:!1}),ol(this,HS,{writable:!0,value:!1}),ol(this,DS,{writable:!0,value:null}),ol(this,NS,{writable:!0,value:null}),sl(this,ym,new $H("row",e,this)),sl(this,Sm,new $H("column",n,this)),sl(this,AS,r)}getForAxis(e){return e==="row"?zo(this,ym):zo(this,Sm)}setPerformUndo(e){sl(this,IS,e)}setPerformRedo(e){sl(this,HS,e)}isPerformingUndoRedo(){return zo(this,IS)||zo(this,HS)}getSheetId(){return zo(this,NS)}getEngine(){return zo(this,DS)}getPostponeAction(){return zo(this,AS)}setupSyncEndpoint(e,n){sl(this,DS,e),sl(this,NS,n),zo(this,ym).init(),zo(this,Sm).init()}}const zme=Ume;function Dt(t,e){QU(t,e),e.add(t)}function Au(t,e,n){return e=Gme(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gme(t){var e=jme(t,"string");return typeof e=="symbol"?e:String(e)}function jme(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kS(t,e,n){QU(t,e),e.set(t,n)}function QU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pa(t,e,n){var r=ZU(t,e,"set");return Yme(t,r,n),n}function Yme(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function yc(t,e){var n=ZU(t,e,"get");return Kme(t,n)}function ZU(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Kme(t,e){return e.get?e.get.call(t):e.value}function yt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Kn="formulas",Xme=["maxRows","maxColumns","language"],qme=260;me.getSingleton().register("afterNamedExpressionAdded");me.getSingleton().register("afterNamedExpressionRemoved");me.getSingleton().register("afterSheetAdded");me.getSingleton().register("afterSheetRemoved");me.getSingleton().register("afterSheetRenamed");me.getSingleton().register("afterFormulasValuesUpdate");const Xc=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Ss=new WeakMap,vM=new WeakMap,$h=new WeakMap,FH=new WeakSet,WH=new WeakSet,LS=new WeakSet,VH=new WeakSet,$S=new WeakSet,BH=new WeakSet,UH=new WeakSet,FS=new WeakSet,zH=new WeakSet,GH=new WeakSet,jH=new WeakSet,YH=new WeakSet,KH=new WeakSet,XH=new WeakSet,qH=new WeakSet,QH=new WeakSet,ZH=new WeakSet,JH=new WeakSet,eD=new WeakSet,tD=new WeakSet,nD=new WeakSet,rD=new WeakSet,iD=new WeakSet,oD=new WeakSet;class Qme extends at{constructor(){var e;super(...arguments),e=this,Dt(this,oD),Dt(this,iD),Dt(this,rD),Dt(this,nD),Dt(this,tD),Dt(this,eD),Dt(this,JH),Dt(this,ZH),Dt(this,QH),Dt(this,qH),Dt(this,XH),Dt(this,KH),Dt(this,YH),Dt(this,jH),Dt(this,GH),Dt(this,zH),Dt(this,FS),Dt(this,UH),Dt(this,BH),Dt(this,$S),Dt(this,VH),Dt(this,LS),Dt(this,WH),Dt(this,FH),kS(this,Ss,{writable:!0,value:!1}),kS(this,vM,{writable:!0,value:!1}),kS(this,$h,{writable:!0,value:[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yt(e,eD,fpe).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yt(e,tD,gpe).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yt(e,nD,mpe).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yt(e,rD,ppe).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yt(e,iD,wpe).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yt(e,oD,vpe).call(e,...r)}]]}),Au(this,"staticRegister",qi("formulas")),Au(this,"engine",null),Au(this,"sheetName",null),Au(this,"indexSyncer",null),Au(this,"rowAxisSyncer",null),Au(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Kn}static get PLUGIN_PRIORITY(){return qme}static get SETTING_KEYS(){return[Kn,...Xme]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Kn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Mme(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Rt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,LS,sD).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,$S,aD).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,LS,sD).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,$S,aD).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,BH,tpe).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,UH,npe).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,FH,Zme).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,zH,rpe).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,FS,lD).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,FS,lD).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,GH,ipe).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,jH,ope).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,XH,lpe).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,qH,upe).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,YH,spe).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,KH,ape).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,QH,cpe).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,ZH,hpe).call(n,...i)}),this.indexSyncer=new zme(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,VH,epe).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,JH,dpe).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return yt(n,WH,Jme).call(n,...i)}),yc(this,$h).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){yc(this,$h).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),LH(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Tme(this.hot.getSettings());_me(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Kn];if(he(r)&&he(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Kn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){yc(this,$h).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Pa(this,$h,null),LH(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(he(n)&&!bB(n))return Rt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Rt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return Rt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){_T(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Qn(Kn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),kH(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return he(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(he(l)===!1||he(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const f=kH(this.engine).get(c);if(!f)return;f.validateCell(f.getDataAtCell(l,u),f.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){Rt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return wM(r,o.type)&&(jU(r,o.dateFormat)?r=YU(r,o.dateFormat):Dme(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function Zme(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&dr(s)&&(s=KU(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Jme(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(f)===!1)return!1;const g=this.engine.getFillRangeData(h,f),{row:p,col:y}=h.start,{row:E,col:v}=h.end,C=E-p+1,S=v-y+1;for(let T=0;T<g.length;T+=1)for(let _=0;_<g[T].length;_+=1){const H=g[T][_],D=T%C,B=_%S,z=this.hot.getCellMeta(D,B);wM(H,z.type)&&(H.startsWith("'")?g[T][_]=H.slice(1):this.isFormulaCellType(D,B,this.sheetId)===!1&&(g[T][_]=Nme(H,z.dateFormat)))}return g}function sD(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Qn(Kn))||Pa(this,vM,bt(this.hot.getSettings().data))}function epe(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o),a=s.dateFormat;wM(i,s.type)&&(e=!0,jU(i,a)?t[r][o]=YU(i,a):this.isFormulaCellType(r,o)===!1&&(t[r][o]=`'${i}`))})}),e===!0&&(Pa(this,Ss,!0),this.engine.setSheetContent(this.sheetId,t),Pa(this,Ss,!1))}function aD(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Qn(Kn)))if(this.sheetName=Ime(this.engine,this.hot.getSettings()[Kn].sheetName),yc(this,vM))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){Pa(this,Ss,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),Pa(this,Ss,!1)}}}function tpe(t,e,n,r){if(r!=="get"||yc(this,Ss)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){GU(n.value)&&(n.value=Hme(n.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e);l.type==="date"&&dr(a)&&(a=KU(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function npe(t,e,n,r){if(r!=="get"||yc(this,Ss)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null||!this.isFormulaCellType(i,o)&&this.getCellType(i,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function lD(t,e){if(Xc(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),f={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:f})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function rpe(t,e){if(Xc(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!dr(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){Rt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function ipe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function ope(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function spe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function ape(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function lpe(t,e,n){if(Xc(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function upe(t,e,n){if(Xc(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function cpe(t,e,n,r){if(Xc(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function hpe(t,e,n,r){if(Xc(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function dpe(t,e,n){var r;Pa(this,Ss,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Pa(this,Ss,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function fpe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function gpe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function mpe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function ppe(t){this.hot.runHooks("afterSheetAdded",t)}function wpe(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}function vpe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Cpe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(j1,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function ype(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(Y1,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ge(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,f=l-a+1;if(h>f){const g=u.slice(i,o+1);c.push(...g.filter(p=>n.includes(p)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===f&&h>o&&c.push(...u.slice(o+1))}return P(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function al(t,e){JU(t,e),e.add(t)}function uD(t,e,n){JU(t,e),e.set(t,n)}function JU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ll(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Vr(t,e){var n=ez(t,e,"get");return Spe(t,n)}function Spe(t,e){return e.get?e.get.call(t):e.value}function Fh(t,e,n){var r=ez(t,e,"set");return bpe(t,r,n),n}function ez(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function bpe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}me.getSingleton().register("beforeHideColumns");me.getSingleton().register("afterHideColumns");me.getSingleton().register("beforeUnhideColumns");me.getSingleton().register("afterUnhideColumns");const WS="hiddenColumns",Rpe=310,tz="beforeHiddenColumnIndicator",nz="afterHiddenColumnIndicator";var So=new WeakMap,lo=new WeakMap,cD=new WeakSet,hD=new WeakSet,dD=new WeakSet,fD=new WeakSet,gD=new WeakSet,mD=new WeakSet,pD=new WeakSet;class Epe extends at{constructor(){super(...arguments),al(this,pD),al(this,mD),al(this,gD),al(this,fD),al(this,dD),al(this,hD),al(this,cD),uD(this,So,{writable:!0,value:{}}),uD(this,lo,{writable:!0,value:null})}static get PLUGIN_KEY(){return WS}static get PLUGIN_PRIORITY(){return Rpe}isEnabled(){return!!this.hot.getSettings()[WS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[WS];Be(n)&&(Fh(this,So,n),bt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Fh(this,lo,new Tv),Vr(this,lo).addLocalHook("init",()=>ll(this,pD,Ape).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Vr(this,lo)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ll(e,mD,Ope).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>ll(this,dD,Mpe).call(this,r,i,o)),this.addHook("modifyColWidth",(r,i)=>ll(this,hD,_pe).call(this,r,i)),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ll(e,gD,Ppe).call(e,...i)}),this.addHook("modifyCopyableRange",r=>ll(this,fD,xpe).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=(n,r)=>{ll(this,cD,Tpe).call(this,r)};this.hot.columnIndexMapper.unregisterMap(this.pluginName),Fh(this,So,{}),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=Vr(this,lo).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));P(l,u=>{o[u]=!1}),i=en(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&Vr(this,lo).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,s=>{Vr(this,lo).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ge(Vr(this,lo).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Vr(this,lo).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){P(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){Fh(this,So,null),Fh(this,lo,null),super.destroy()}}function Tpe(t){Array.from(t.querySelectorAll(`.${nz}, .${tz}`)).forEach(e=>{e.remove()})}function _pe(t,e){if(this.isHidden(e))return 0;if(Vr(this,So).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Mpe(t,e,n){if(Vr(this,So).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function xpe(t){if(Vr(this,So).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return P(t,r=>{let i=!0,o=0;ye(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Ppe(t,e){const n=this.hot.getSettings().ariaTags,r=e.querySelector(".beforeHiddenColumnIndicator"),i=e.querySelector(".afterHiddenColumnIndicator");if(!Vr(this,So).indicators||t<0){r==null||r.remove(),i==null||i.remove();return}const o=[];if(t>=1&&this.isHidden(t-1)){if(!i){const s=n?[ba(this.hot.getTranslatedPhrase(D_))]:[];Fl(e,{tagName:"div",attributes:s,className:nz})}o.push("afterHiddenColumn")}if(t<this.hot.countCols()-1&&this.isHidden(t+1)){if(!r){const s=n?[ba(this.hot.getTranslatedPhrase(H_))]:[];Fl(e,{tagName:"div",attributes:s,className:tz})}o.push("beforeHiddenColumn")}te(e,o)}function Ope(t){t.items.push({name:Ke},Cpe(this),ype(this))}function Ape(){Array.isArray(Vr(this,So).columns)&&this.hideColumns(Vr(this,So).columns)}function Ipe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(K1,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Hpe(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(X1,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ge(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,f=l-a+1;if(h>f){const g=u.slice(i,o+1);c.push(...g.filter(p=>n.includes(p)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===f&&h>o&&c.push(...u.slice(o+1))}return P(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function ul(t,e){rz(t,e),e.add(t)}function wD(t,e,n){rz(t,e),e.set(t,n)}function rz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ai(t,e){var n=iz(t,e,"get");return Dpe(t,n)}function Dpe(t,e){return e.get?e.get.call(t):e.value}function Wh(t,e,n){var r=iz(t,e,"set");return Npe(t,r,n),n}function iz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Npe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}me.getSingleton().register("beforeHideRows");me.getSingleton().register("afterHideRows");me.getSingleton().register("beforeUnhideRows");me.getSingleton().register("afterUnhideRows");const VS="hiddenRows",kpe=320,oz="afterHiddenRowIndicator",sz="beforeHiddenRowIndicator";var us=new WeakMap,uo=new WeakMap,vD=new WeakSet,CD=new WeakSet,yD=new WeakSet,SD=new WeakSet,bD=new WeakSet,RD=new WeakSet,ED=new WeakSet;class Lpe extends at{constructor(){super(...arguments),ul(this,ED),ul(this,RD),ul(this,bD),ul(this,SD),ul(this,yD),ul(this,CD),ul(this,vD),wD(this,us,{writable:!0,value:{}}),wD(this,uo,{writable:!0,value:null})}static get PLUGIN_KEY(){return VS}static get PLUGIN_PRIORITY(){return kpe}isEnabled(){return!!this.hot.getSettings()[VS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[VS];Be(n)&&(Wh(this,us,n),bt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Wh(this,uo,new Tv),ai(this,uo).addLocalHook("init",()=>cl(this,ED,zpe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ai(this,uo)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cl(e,RD,Upe).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>cl(this,yD,Wpe).call(this,r,i,o)),this.addHook("modifyRowHeight",(r,i)=>cl(this,CD,Fpe).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cl(e,bD,Bpe).call(e,...i)}),this.addHook("modifyCopyableRange",r=>cl(this,SD,Vpe).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=(n,r)=>{cl(this,vD,$pe).call(this,r)};this.hot.rowIndexMapper.unregisterMap(this.pluginName),Wh(this,us,{}),this.hot.addHook("afterGetRowHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetRowHeader",e)}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=ai(this,uo).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));P(l,u=>{o[u]=!1}),i=en(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&ai(this,uo).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,s=>{ai(this,uo).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ge(ai(this,uo).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return ai(this,uo).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){P(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){Wh(this,us,null),Wh(this,uo,null),super.destroy()}}function $pe(t){Array.from(t.querySelectorAll(`.${oz}, .${sz}`)).forEach(e=>{e.remove()})}function Fpe(t,e){return this.isHidden(e)?0:t}function Wpe(t,e,n){if(ai(this,us).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Vpe(t){if(ai(this,us).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return P(t,r=>{let i=!0,o=0;ye(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function Bpe(t,e){const n=this.hot.getSettings().ariaTags,r=e.querySelector(".beforeHiddenRowIndicator"),i=e.querySelector(".afterHiddenRowIndicator");if(!ai(this,us).indicators||t<0){r==null||r.remove(),i==null||i.remove();return}const o=[];if(t>=1&&this.isHidden(t-1)){if(!i){const s=n?[ba(this.hot.getTranslatedPhrase($_))]:[];Fl(e,{tagName:"div",attributes:s,className:oz})}o.push("afterHiddenRow")}if(t<this.hot.countRows()-1&&this.isHidden(t+1)){if(!r){const s=n?[ba(this.hot.getTranslatedPhrase(L_))]:[];Fl(e,{tagName:"div",attributes:s,className:sz})}o.push("beforeHiddenRow")}te(e,o)}function Upe(t){t.items.push({name:Ke},Ipe(this),Hpe(this))}function zpe(){Array.isArray(ai(this,us).rows)&&this.hideRows(ai(this,us).rows)}function Gpe(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(b1)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function jpe(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(R1)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function TD(t,e){az(t,e),e.add(t)}function Ype(t,e,n){az(t,e),e.set(t,n)}function az(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ER(t,e){var n=lz(t,e,"get");return Kpe(t,n)}function Kpe(t,e){return e.get?e.get.call(t):e.value}function BS(t,e,n){var r=lz(t,e,"set");return Xpe(t,r,n),n}function lz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Xpe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function _D(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}me.getSingleton().register("beforeColumnFreeze");me.getSingleton().register("afterColumnFreeze");me.getSingleton().register("beforeColumnUnfreeze");me.getSingleton().register("afterColumnUnfreeze");const MD="manualColumnFreeze",qpe=110;var Cl=new WeakMap,xD=new WeakSet,PD=new WeakSet;class Qpe extends at{constructor(){super(...arguments),TD(this,PD),TD(this,xD),Ype(this,Cl,{writable:!0,value:!1})}static get PLUGIN_KEY(){return MD}static get PLUGIN_PRIORITY(){return qpe}isEnabled(){return!!this.hot.getSettings()[MD]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>_D(this,xD,Zpe).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>_D(this,PD,Jpe).call(this,e,n)),super.enablePlugin())}disablePlugin(){BS(this,Cl,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;ER(this,Cl)||BS(this,Cl,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;ER(this,Cl)||BS(this,Cl,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Zpe(t){t.items.push({name:"---------"},Gpe(this),jpe(this))}function Jpe(t,e){if(ER(this,Cl)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function bm(t,e,n){return e=ewe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ewe(t){var e=twe(t,"string");return typeof e=="symbol"?e:String(e)}function twe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const US=0,OD=1,AD=2,Iu="px";let nwe=class{constructor(e){bm(this,"hot",void 0),bm(this,"_element",null),bm(this,"state",US),bm(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=AD}build(){this.state===US&&(this._element=this.hot.rootDocument.createElement("div"),this.state=OD)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=US}isAppended(){return this.state===AD}isBuilt(){return this.state>=OD}setPosition(e,n){dr(e)&&(this._element.style.top=e+Iu),dr(n)&&(this._element.style[this.inlineProperty]=n+Iu)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){dr(e)&&(this._element.style.width=e+Iu),dr(n)&&(this._element.style.height=n+Iu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){dr(e)&&(this._element.style.marginTop=e+Iu),dr(n)&&(this._element.style[`margin${Qn(this.inlineProperty)}`]=n+Iu)}getOffset(){const e=this._element.style,n=`margin${Qn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const uz=nwe,rwe="ht__manualColumnMove--backlight";let iwe=class extends uz{build(){super.build(),te(this._element,rwe)}};const owe=iwe,swe="ht__manualColumnMove--guideline";let awe=class extends uz{build(){super.build(),te(this._element,swe)}};const lwe=awe;function Hu(t,e){cz(t,e),e.add(t)}function Go(t,e,n){cz(t,e),e.set(t,n)}function cz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ID(t,e,n){return e=uwe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uwe(t){var e=cwe(t,"string");return typeof e=="symbol"?e:String(e)}function cwe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mr(t,e,n){var r=hz(t,e,"set");return hwe(t,r,n),n}function hwe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Fe(t,e){var n=hz(t,e,"get");return dwe(t,n)}function hz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function dwe(t,e){return e.get?e.get.call(t):e.value}function Du(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}me.getSingleton().register("beforeColumnMove");me.getSingleton().register("afterColumnMove");const zS="manualColumnMove",fwe=120,HD="ht__manualColumnMove",bw="show-ui",TR="on-moving--columns",_R="after-selection--columns";var cs=new WeakMap,fp=new WeakMap,ia=new WeakMap,hr=new WeakMap,Rm=new WeakMap,ii=new WeakMap,Gu=new WeakMap,Rw=new WeakMap,Ed=new WeakMap,DD=new WeakSet,ND=new WeakSet,kD=new WeakSet,LD=new WeakSet,$D=new WeakSet,FD=new WeakSet;class gwe extends at{constructor(){super(...arguments),Hu(this,FD),Hu(this,$D),Hu(this,LD),Hu(this,kD),Hu(this,ND),Hu(this,DD),ID(this,"backlight",new owe(this.hot)),ID(this,"guideline",new lwe(this.hot)),Go(this,cs,{writable:!0,value:[]}),Go(this,fp,{writable:!0,value:0}),Go(this,ia,{writable:!0,value:!1}),Go(this,hr,{writable:!0,value:{}}),Go(this,Rm,{writable:!0,value:void 0}),Go(this,ii,{writable:!0,value:void 0}),Go(this,Gu,{writable:!0,value:void 0}),Go(this,Rw,{writable:!0,value:void 0}),Go(this,Ed,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return zS}static get PLUGIN_PRIORITY(){return fwe}isEnabled(){return!!this.hot.getSettings()[zS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Du(e,DD,mwe).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Du(e,kD,wwe).call(e,...r)}),this.addHook("afterScrollVertically",()=>Du(this,$D,Cwe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Du(e,FD,ywe).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,HD),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Le(this.hot.rootElement,HD),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=Fe(this,Rm),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Mr(this,Rm,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Mr(this,Rm,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=en(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[zS];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return ye(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Fe(this,ii))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Fe(this,ii)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=this.backlight.getOffset().start,u=this.backlight.getSize().width;let c=0,h=0;if(this.hot.isRtl()){const p=this.hot.rootWindow,y=gt(this.hot.rootElement),E=p.innerWidth-Fe(this,Gu)-y;h=p.innerWidth-Fe(this,hr).eventPageX-E-(r.scrollX===void 0?i:0)}else h=Fe(this,hr).eventPageX-(Fe(this,Gu)-(r.scrollX===void 0?i:0));if(Fe(this,Rw)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Fe(this,ii))&&(o+=i),o+=c,Fe(this,ii)<0)Fe(this,Ed)>0?Fe(this,hr).col=0:Fe(this,hr).col=e>0?e-1:e;else if(Fe(this,hr).TD.offsetWidth/2+o<=h){const p=Fe(this,ii)>=Fe(this,fp)?Fe(this,fp)-1:Fe(this,ii);Fe(this,hr).col=p+1,o+=Fe(this,hr).TD.offsetWidth}else Fe(this,hr).col=Fe(this,ii);let f=h,g=o;h+u+l>=s?f=s-u-l:h+l<a+c&&(f=a+c+Math.abs(l)),o>=s-1?g=s-1:g===0?g=1:r.scrollX!==void 0&&Fe(this,ii)<Fe(this,Ed)&&(g-=Fe(this,Gu)<=r.scrollX?Fe(this,Gu):0),this.backlight.setPosition(null,f),this.guideline.setPosition(null,g)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Du(this,ND,pwe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Du(this,LD,vwe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){this.backlight.build(),this.guideline.build()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}function mwe(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=De(t.target,"sortAction");if(!s||!o||Fe(this,ia)||t.button!==0||a){Mr(this,ia,!1),Fe(this,cs).length=0,Le(this.hot.rootElement,[TR,bw]);return}const l=this.guideline.isBuilt()&&!this.guideline.isAppended(),u=this.backlight.isBuilt()&&!this.backlight.isAppended();l&&u&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:c,to:h}=s,f=Math.min(c.col,h.col),g=Math.max(c.col,h.col);if(e.row<0&&e.col>=f&&e.col<=g){r.column=!0,Mr(this,ia,!0);const p=n.firstChild?xV(t,n.firstChild).x:t.offsetX;Fe(this,hr).eventPageX=t.pageX,Mr(this,ii,e.col),Fe(this,hr).TD=n,Fe(this,hr).col=e.col,Mr(this,cs,this.prepareColumnsToMoving(f,g)),Mr(this,Rw,!!this.hot.getSettings().rowHeaders),Mr(this,fp,this.hot.countCols()),Mr(this,Ed,this.hot.getSettings().fixedColumnsStart),Mr(this,Gu,on(this.hot.rootElement).left);const y=Fe(this,Rw)?-1:0,E=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,v=e.col<Fe(this,Ed),C=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),S=Math.abs(p-(this.hot.isRtl()?n.offsetWidth:0)),T=this.getColumnsWidth(f,e.col-1)+S,_=this.getColumnsWidth(y,f-1)+(v?C:0)+T;this.backlight.setPosition(E,_),this.backlight.setSize(this.getColumnsWidth(f,g),i.hider.offsetHeight-E),this.backlight.setOffset(null,-T),te(this.hot.rootElement,TR)}else Le(this.hot.rootElement,_R),Mr(this,ia,!1),Fe(this,cs).length=0}function pwe(t){Fe(this,ia)&&(Fe(this,hr).eventPageX=t.pageX,this.refreshPositions())}function wwe(t,e,n,r){!this.hot.getSelectedRangeLast()||!Fe(this,ia)||(Fe(this,cs).indexOf(e.col)>-1?Le(this.hot.rootElement,bw):te(this.hot.rootElement,bw),r.row=!0,r.column=!0,r.cell=!0,Mr(this,ii,e.col),Fe(this,hr).TD=n)}function vwe(){const t=Fe(this,hr).col,e=Fe(this,cs).length;if(Mr(this,ii,void 0),Mr(this,ia,!1),Le(this.hot.rootElement,[TR,bw,_R]),this.hot.selection.isSelectedByColumnHeader()&&te(this.hot.rootElement,_R),e<1||t===void 0)return;const n=Fe(this,cs)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(Fe(this,cs),t);if(Fe(this,cs).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function Cwe(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;this.backlight.setPosition(r),this.backlight.setSize(null,t.hider.offsetHeight-r)}function ywe(){this.moveBySettingsOrLoad()}function jo(t,e){dz(t,e),e.add(t)}function Swe(t,e,n){dz(t,e),e.set(t,n)}function dz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sr(t,e,n){return e=bwe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bwe(t){var e=Rwe(t,"string");return typeof e=="symbol"?e:String(e)}function Rwe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WD(t,e){var n=gz(t,e,"get");return Ewe(t,n)}function Ewe(t,e){return e.get?e.get.call(t):e.value}function fz(t,e,n){var r=gz(t,e,"set");return Twe(t,r,n),n}function gz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Twe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Yo(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Ew="manualColumnResize",_we=130,VD="manualColumnWidths";var Td=new WeakMap,BD=new WeakSet,UD=new WeakSet,zD=new WeakSet,GD=new WeakSet,jD=new WeakSet,YD=new WeakSet,KD=new WeakSet,XD=new WeakSet,qD=new WeakSet;class Mwe extends at{static get PLUGIN_KEY(){return Ew}static get PLUGIN_PRIORITY(){return _we}constructor(e){super(e),jo(this,qD),jo(this,XD),jo(this,KD),jo(this,YD),jo(this,jD),jo(this,GD),jo(this,zD),jo(this,UD),jo(this,BD),sr(this,"currentTH",null),sr(this,"currentCol",null),sr(this,"selectedCols",[]),sr(this,"currentWidth",null),sr(this,"newSize",null),sr(this,"startY",null),sr(this,"startWidth",null),sr(this,"startOffset",null),sr(this,"handle",this.hot.rootDocument.createElement("DIV")),sr(this,"guide",this.hot.rootDocument.createElement("DIV")),sr(this,"pressed",null),sr(this,"isTriggeredByRMB",!1),sr(this,"dblclick",0),sr(this,"autoresizeTimeout",null),sr(this,"columnWidthsMap",void 0),Swe(this,Td,{writable:!0,value:void 0}),te(this.handle,"manualColumnResizer"),te(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Ew]}enablePlugin(){this.enabled||(this.columnWidthsMap=new Da,this.columnWidthsMap.addLocalHook("init",()=>Yo(this,BD,xwe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(e,n)=>Yo(this,KD,Dwe).call(this,e,n)),this.addHook("beforeStretchingColumnWidth",(e,n)=>Yo(this,XD,Nwe).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,r)=>Yo(this,qD,kwe).call(this,e,n,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){fz(this,Td,this.columnWidthsMap.getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",VD,this.columnWidthsMap.getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",VD,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;this.currentTH=e;const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(this.currentTH),i=r.col;if(i<0)return;const o=Wt(this.currentTH),s=this.currentTH.getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),this.selectedCols=[];const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();P(c,h=>{const f=h.getTopStartCorner().col,g=h.getBottomEndCorner().col;ye(f,g,p=>{this.selectedCols.includes(p)||this.selectedCols.push(p)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=l.start-6,this.startWidth=parseInt(s.width,10),this.handle.style.top=`${l.top}px`,this.handle.style[this.inlineDir]=`${this.startOffset+this.startWidth}px`,this.handle.style.height=`${o}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style[this.inlineDir]=`${this.startOffset+this.currentWidth}px`}setupGuidePosition(){const e=parseInt(Wt(this.handle),10),n=parseInt(this.handle.style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);te(this.handle,"active"),te(this.guide,"active"),this.guide.style.top=`${n}px`,this.refreshGuidePosition(),this.guide.style.height=`${r-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){Le(this.handle,"active"),Le(this.guide,"active")}checkIfColumnHeader(e){return!!Ra(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",this.newSize,r,!0);o!==void 0&&(this.newSize=o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,r,!0),i&&e()};this.dblclick>=2&&(this.selectedCols.length>1?(P(this.selectedCols,i=>{n(i)}),e()):P(this.selectedCols,i=>{n(i,!0)})),this.dblclick=0,this.autoresizeTimeout=null}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Yo(this,UD,Pwe).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Yo(this,zD,Owe).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Yo(this,GD,Awe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Yo(this,jD,Iwe).call(this)),this.eventManager.addEventListener(this.handle,"contextmenu",()=>Yo(this,YD,Hwe).call(this))}destroy(){super.destroy()}}function xwe(){const t=this.hot.getSettings()[Ew],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{this.columnWidthsMap.setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{this.columnWidthsMap.setValueAtIndex(r,n)})},!0),fz(this,Td,t)):t===!0&&Array.isArray(WD(this,Td))&&this.hot.batchExecution(()=>{WD(this,Td).forEach((n,r)=>{this.columnWidthsMap.setValueAtIndex(r,n)})},!0)}function Pwe(t){if(!pT(t.target)&&this.isTriggeredByRMB!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(this.pressed||this.setupHandlePosition(e))}}function Owe(t){De(t.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=t.pageX,this.newSize=this.startWidth)}function Awe(t){if(this.pressed){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+e,P(this.selectedCols,n=>{this.newSize=this.setManualSize(n,this.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Iwe(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",this.newSize,n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?(P(this.selectedCols,r=>{e(r)}),t()):P(this.selectedCols,r=>{e(r,!0)})),this.setupHandlePosition(this.currentTH))}function Hwe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}function Dwe(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=this.columnWidthsMap.getValueAtIndex(r);this.hot.getSettings()[Ew]&&i&&(n=i)}return n}function Nwe(t,e){let n=this.columnWidthsMap.getValueAtIndex(e);return n===null&&(n=t),n}function kwe(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function GS(t,e,n){return e=Lwe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lwe(t){var e=$we(t,"string");return typeof e=="symbol"?e:String(e)}function $we(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const jS=0,QD=1,ZD=2,Nu="px";let Fwe=class{constructor(e){GS(this,"hot",void 0),GS(this,"_element",null),GS(this,"state",jS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=ZD}build(){this.state===jS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=QD)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=jS}isAppended(){return this.state===ZD}isBuilt(){return this.state>=QD}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Nu),n!==void 0&&(this._element.style.left=n+Nu)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Nu),n&&(this._element.style.height=n+Nu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Nu),n&&(this._element.style.marginLeft=n+Nu)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const mz=Fwe,Wwe="ht__manualRowMove--backlight";class Vwe extends mz{build(){super.build(),te(this._element,Wwe)}}const Bwe=Vwe,Uwe="ht__manualRowMove--guideline";class zwe extends mz{build(){super.build(),te(this._element,Uwe)}}const Gwe=zwe;function ku(t,e){pz(t,e),e.add(t)}function Em(t,e,n){pz(t,e),e.set(t,n)}function pz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JD(t,e,n){return e=jwe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jwe(t){var e=Ywe(t,"string");return typeof e=="symbol"?e:String(e)}function Ywe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xl(t,e,n){var r=wz(t,e,"set");return Kwe(t,r,n),n}function Kwe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Lt(t,e){var n=wz(t,e,"get");return Xwe(t,n)}function wz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Xwe(t,e){return e.get?e.get.call(t):e.value}function Lu(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}me.getSingleton().register("beforeRowMove");me.getSingleton().register("afterRowMove");const YS="manualRowMove",qwe=140,eN="ht__manualRowMove",Tw="show-ui",MR="on-moving--rows",xR="after-selection--rows";var hs=new WeakMap,oa=new WeakMap,xr=new WeakMap,Tm=new WeakMap,tN=new WeakSet,nN=new WeakSet,rN=new WeakSet,iN=new WeakSet,oN=new WeakSet,sN=new WeakSet;class Qwe extends at{constructor(){super(...arguments),ku(this,sN),ku(this,oN),ku(this,iN),ku(this,rN),ku(this,nN),ku(this,tN),JD(this,"backlight",new Bwe(this.hot)),JD(this,"guideline",new Gwe(this.hot)),Em(this,hs,{writable:!0,value:[]}),Em(this,oa,{writable:!0,value:void 0}),Em(this,xr,{writable:!0,value:{}}),Em(this,Tm,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return YS}static get PLUGIN_PRIORITY(){return qwe}isEnabled(){return!!this.hot.getSettings()[YS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Lu(e,tN,Zwe).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Lu(e,rN,eve).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Lu(this,oN,nve).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Lu(e,sN,rve).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,eN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Le(this.hot.rootElement,eN),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Lt(this,Tm),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(xl(this,Tm,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return xl(this,Tm,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=en(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[YS];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return ye(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Lt(this,xr).coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Lt(this,xr).TD,a=this.hot.rootElement,l=on(a),u=$l(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,f=l.top-h,g=Lt(this,xr).eventPageY-f+c,p=o.hider.offsetHeight,y=o.TBODY.offsetTop,E=this.backlight.getOffset().top,v=this.backlight.getSize().height,C=s.offsetHeight/2,S=s.offsetHeight;let T=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const _=g>=T+C;this.isFixedRowTop(e.row)&&(T+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Lt(this,xr).row=n>0?n-1:n:_?(Lt(this,xr).row=e.row+1,T+=e.row===0?S-1:S):Lt(this,xr).row=e.row;let H=g,D=T;g+v+E>=p?H=p-v-E:g+E<y&&(H=y+Math.abs(E)),T>=p-1&&(D=p-1),this.backlight.setPosition(H),this.guideline.setPosition(D)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Lu(this,nN,Jwe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Lu(this,iN,tve).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){this.backlight.build(),this.guideline.build()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}function Zwe(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Lt(this,oa)||t.button!==0){xl(this,oa,!1),Lt(this,hs).length=0,Le(this.hot.rootElement,[MR,Tw]);return}const l=this.guideline.isBuilt()&&!this.guideline.isAppended(),u=this.backlight.isBuilt()&&!this.backlight.isAppended();l&&u&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:c,to:h}=a,f=Math.min(c.row,h.row),g=Math.max(c.row,h.row);if(e.col<0&&e.row>=f&&e.row<=g){r.row=!0,xl(this,oa,!0),Lt(this,xr).eventPageY=t.pageY,Lt(this,xr).coords=e,Lt(this,xr).TD=n,xl(this,hs,this.prepareRowsToMoving());const p=i.holder.scrollLeft+o.getRowHeaderWidth(),y=this.getRowsHeight(f,e.row-1)+t.offsetY;this.backlight.setPosition(null,p),this.backlight.setSize(i.hider.offsetWidth-p,this.getRowsHeight(f,g)),this.backlight.setOffset(-y,null),te(this.hot.rootElement,MR),this.refreshPositions()}else Le(this.hot.rootElement,xR),xl(this,oa,!1),Lt(this,hs).length=0}function Jwe(t){Lt(this,oa)&&(Lt(this,xr).eventPageY=t.pageY,this.refreshPositions())}function eve(t,e,n,r){!this.hot.getSelectedRangeLast()||!Lt(this,oa)||(Lt(this,hs).indexOf(e.row)>-1?Le(this.hot.rootElement,Tw):te(this.hot.rootElement,Tw),r.row=!0,r.column=!0,r.cell=!0,Lt(this,xr).coords=e,Lt(this,xr).TD=n)}function tve(){const t=Lt(this,xr).row,e=Lt(this,hs).length;if(xl(this,oa,!1),Le(this.hot.rootElement,[MR,Tw,xR]),this.hot.selection.isSelectedByRowHeader()&&te(this.hot.rootElement,xR),e<1||t===void 0)return;const n=Lt(this,hs)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Lt(this,hs),t);if(Lt(this,hs).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function nve(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;this.backlight.setPosition(null,r),this.backlight.setSize(t.hider.offsetWidth-r)}function rve(){this.moveBySettingsOrLoad()}function hl(t,e){vz(t,e),e.add(t)}function ive(t,e,n){vz(t,e),e.set(t,n)}function vz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ar(t,e,n){return e=ove(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ove(t){var e=sve(t,"string");return typeof e=="symbol"?e:String(e)}function sve(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aN(t,e){var n=yz(t,e,"get");return ave(t,n)}function ave(t,e){return e.get?e.get.call(t):e.value}function Cz(t,e,n){var r=yz(t,e,"set");return lve(t,r,n),n}function yz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function lve(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function dl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const _w="manualRowResize",uve=30,lN="manualRowHeights";var _d=new WeakMap,uN=new WeakSet,cN=new WeakSet,hN=new WeakSet,dN=new WeakSet,fN=new WeakSet,gN=new WeakSet,mN=new WeakSet;class cve extends at{static get PLUGIN_KEY(){return _w}static get PLUGIN_PRIORITY(){return uve}constructor(e){super(e),hl(this,mN),hl(this,gN),hl(this,fN),hl(this,dN),hl(this,hN),hl(this,cN),hl(this,uN),ar(this,"currentTH",null),ar(this,"currentRow",null),ar(this,"selectedRows",[]),ar(this,"currentHeight",null),ar(this,"newSize",null),ar(this,"startY",null),ar(this,"startHeight",null),ar(this,"startOffset",null),ar(this,"handle",this.hot.rootDocument.createElement("DIV")),ar(this,"guide",this.hot.rootDocument.createElement("DIV")),ar(this,"pressed",!1),ar(this,"isTriggeredByRMB",!1),ar(this,"dblclick",0),ar(this,"autoresizeTimeout",null),ar(this,"rowHeightsMap",void 0),ive(this,_d,{writable:!0,value:void 0}),te(this.handle,"manualRowResizer"),te(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[_w]}enablePlugin(){this.enabled||(this.rowHeightsMap=new Da,this.rowHeightsMap.addLocalHook("init",()=>dl(this,mN,wve).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(e,n)=>dl(this,gN,pve).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Cz(this,_d,this.rowHeightsMap.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",lN,this.rowHeightsMap.getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",lN,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,qV.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(r,i),i}setupHandlePosition(e){this.currentTH=e;const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(this.currentTH),o=i.row;if(o<0)return;const s=gt(this.currentTH),a=this.currentTH.getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),this.selectedRows=[];const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const f=this.hot.getSelectedRange();P(f,g=>{const p=g.getTopStartCorner().row,y=g.getBottomStartCorner().row;ye(p,y,E=>{this.selectedRows.includes(E)||this.selectedRows.push(E)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=c.top-6,this.startHeight=parseInt(a.height,10),this.handle.style.top=`${this.startOffset+this.startHeight}px`,this.handle.style[this.inlineDir]=`${c.start}px`,this.handle.style.width=`${s}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style.top=`${this.startOffset+this.currentHeight}px`}setupGuidePosition(){const e=parseInt(gt(this.handle),10),n=parseInt(this.handle.style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);te(this.handle,"active"),te(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=`${n}px`,this.guide.style.width=`${r-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){Le(this.handle,"active"),Le(this.guide,"active")}checkIfRowHeader(e){var n;return Ra(e,["TH"],this.hot.rootElement)&&((n=e.parentNode)===null||n===void 0||(n=n.parentNode)===null||n===void 0?void 0:n.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&this.newSize<n?n:this.newSize}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&(this.newSize=o),this.setManualSize(r,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};this.dblclick>=2&&(this.selectedRows.length>1?(P(this.selectedRows,i=>{n(i)}),e()):P(this.selectedRows,i=>{n(i,!0)})),this.dblclick=0,this.autoresizeTimeout=null}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>dl(this,uN,hve).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>dl(this,cN,dve).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>dl(this,hN,fve).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>dl(this,dN,gve).call(this)),this.eventManager.addEventListener(this.handle,"contextmenu",()=>dl(this,fN,mve).call(this))}destroy(){super.destroy()}}function hve(t){if(!pT(t.target)&&this.isTriggeredByRMB!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(this.pressed||this.setupHandlePosition(e))}}function dve(t){De(t.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=t.pageY,this.newSize=this.startHeight)}function fve(t){this.pressed&&(this.currentHeight=this.startHeight+(t.pageY-this.startY),P(this.selectedRows,e=>{this.newSize=this.setManualSize(e,this.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}function gve(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?(P(this.selectedRows,r=>{e(r)}),t()):P(this.selectedRows,r=>{e(r,!0)})),this.setupHandlePosition(this.currentTH))}function mve(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}function pve(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=this.rowHeightsMap.getValueAtIndex(r);this.hot.getSettings()[_w]&&i&&(n=i)}return n}function wve(){const t=this.hot.getSettings()[_w],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{this.rowHeightsMap.setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{this.rowHeightsMap.setValueAtIndex(r,n)}),Cz(this,_d,t)):t===!0&&Array.isArray(aN(this,_d))&&aN(this,_d).forEach((n,r)=>{this.rowHeightsMap.setValueAtIndex(r,n)})},!0)}function fl(t,e,n){return e=vve(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vve(t){var e=Cve(t,"string");return typeof e=="symbol"?e:String(e)}function Cve(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yve{constructor(e,n,r,i,o,s){fl(this,"row",void 0),fl(this,"col",void 0),fl(this,"rowspan",void 0),fl(this,"colspan",void 0),fl(this,"removed",!1),fl(this,"cellCoordsFactory",void 0),fl(this,"cellRangeFactory",void 0),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return mt`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return mt`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return mt`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return mt`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const h=l-u+1,f=Math.abs(r)-h;this[s]-=f+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const po=yve;function PR(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function KS(t,e,n){return e=Sve(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sve(t){var e=bve(t,"string");return typeof e=="symbol"?e:String(e)}function bve(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CM{constructor(e){KS(this,"plugin",void 0),KS(this,"mergedCells",[]),KS(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return mt`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){const r=this.mergedCells;let i=!1;return P(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=n&&o.col+o.colspan-1>=n?(i=o,!1):!0),i}getByRange(e){const n=this.mergedCells;let r=!1;return P(n,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,i=[];let o=e;if(!o.includesRange){const s=this.hot._createCellCoords(o.from.row,o.from.col),a=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(s,s,a)}return P(r,s=>{const a=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),u=this.hot._createCellRange(a,a,l);n?o.overlaps(u)&&i.push(s):o.includesRange(u)&&i.push(s)}),i.length?i:!1}add(e){const n=this.mergedCells,r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new po(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),n.push(a),a):(Rt(CM.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.mergedCells,i=this.get(e,n),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(r.splice(o,1),i):!1}clear(){const e=this.mergedCells,n=[],r=[];P(e,i=>{const o=this.hot.getCell(i.row,i.col);o&&n.push([o,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,P(n,(i,o)=>{ye(0,i.rowspan-1,s=>{ye(0,i.colspan-1,a=>{if(a!==0||s!==0){const l=this.hot.getCell(i.row+s,i.col+a);l&&r.push([l,null,null,null])}})}),n[o][1]=null}),P(n,i=>{PR(...i)}),P(r,i=>{PR(...i)})}isOverlapping(e){const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return P(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(n)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}P(this.mergedCells,o=>{o.shift(i,n)}),rw(this.mergedCells.length-1,0,o=>{const s=this.mergedCells[o];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}}const Rve=CM;function XS(t,e,n){return e=Eve(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eve(t){var e=Tve(t,"string");return typeof e=="symbol"?e:String(e)}function Tve(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _ve{constructor(e){XS(this,"plugin",void 0),XS(this,"mergedCellsCollection",void 0),XS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,f=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,g=Math.floor(s/f)*f,p=s-g,y=this.getFarthestCollection(e,n,r,i);if(y){if(r==="down"){const E=y.row+y.rowspan-a-p;o[2]+E>=this.plugin.hot.countRows()?o[2]-=p:o[2]+=p?E:0}else if(r==="right"){const E=y.col+y.colspan-l-p;o[3]+E>=this.plugin.hot.countCols()?o[3]-=p:o[3]+=p?E:0}else if(r==="up"){const E=u-p-y.row+1;o[0]+E<0?o[0]+=p:o[0]-=p?E:0}else if(r==="left"){const E=c-p-y.col+1;o[1]+E<0?o[1]+=p:o[1]-=p?E:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:f}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),sn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":return[s+1,o,c,a];case"left":return[l,u,s,o-1];case"right":return[i,a+1,c,h];default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,f=this.getAutofillSize(e,n,r),g=u?a-o+1:l-s+1,p=Math.floor(f/g)*g,y=f-p;let E=null,v=null,C=null;switch(r){case"up":E="includesVertically",C=c-y+1;break;case"left":E="includesHorizontally",C=c-y+1;break;case"down":E="includesVertically",C=h+y-1;break;case"right":E="includesHorizontally",C=h+y-1;break}return P(i,S=>{S[E](C)&&S.isFarther(v,r)&&(v=S)}),v}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return P(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(h,!0)}}const Mve=_ve;function qS(t,e,n){return e=xve(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xve(t){var e=Pve(t,"string");return typeof e=="symbol"?e:String(e)}function Pve(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ove{constructor(e){qS(this,"plugin",void 0),qS(this,"hot",void 0),qS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}snapDelta(e,n,r){const i=n.to,o=i.row+e.row,s=i.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,s)}jumpOverMergedCell(e,n,r){let i=e.row||e.col,o=null,s=null,a=null;e.row?(o=n.includesVertically(r),s=n.row,a=n.getLastRow()):e.col&&(o=n.includesHorizontally(r),s=n.col,a=n.getLastColumn()),i!==0&&(i>0?o&&r!==s&&(i+=a-r+1):o&&r!==a&&(i-=r-s+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,n){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+n.row,e.to.col+n.col))}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),f=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=f)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const Ave=Ove;function Ive(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(T1)}return this.getTranslatedPhrase(E1)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?po.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Zt(t,e){Sz(t,e),e.add(t)}function Hve(t,e,n){Sz(t,e),e.set(t,n)}function Sz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QS(t,e,n){return e=Dve(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dve(t){var e=Nve(t,"string");return typeof e=="symbol"?e:String(e)}function Nve(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ZS(t,e,n){var r=bz(t,e,"set");return kve(t,r,n),n}function kve(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function $u(t,e){var n=bz(t,e,"get");return Lve(t,n)}function bz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Lve(t,e){return e.get?e.get.call(t):e.value}function Bt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}me.getSingleton().register("beforeMergeCells");me.getSingleton().register("afterMergeCells");me.getSingleton().register("beforeUnmergeCells");me.getSingleton().register("afterUnmergeCells");const Md="mergeCells",$ve=150,pN=Md;var fo=new WeakMap,wN=new WeakSet,vN=new WeakSet,CN=new WeakSet,yN=new WeakSet,SN=new WeakSet,bN=new WeakSet,RN=new WeakSet,JS=new WeakSet,EN=new WeakSet,TN=new WeakSet,_N=new WeakSet,MN=new WeakSet,xN=new WeakSet,PN=new WeakSet,ON=new WeakSet,AN=new WeakSet,IN=new WeakSet,HN=new WeakSet,DN=new WeakSet,NN=new WeakSet,kN=new WeakSet,LN=new WeakSet;class Fve extends at{constructor(){super(...arguments),Zt(this,LN),Zt(this,kN),Zt(this,NN),Zt(this,DN),Zt(this,HN),Zt(this,IN),Zt(this,AN),Zt(this,ON),Zt(this,PN),Zt(this,xN),Zt(this,MN),Zt(this,_N),Zt(this,TN),Zt(this,EN),Zt(this,JS),Zt(this,RN),Zt(this,bN),Zt(this,SN),Zt(this,yN),Zt(this,CN),Zt(this,vN),Zt(this,wN),QS(this,"mergedCellsCollection",null),QS(this,"autofillCalculations",null),QS(this,"selectionCalculations",null),Hve(this,fo,{writable:!0,value:null})}static get PLUGIN_KEY(){return Md}static get PLUGIN_PRIORITY(){return $ve}isEnabled(){return!!this.hot.getSettings()[Md]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Rve(this),this.autofillCalculations=new Mve(this),this.selectionCalculations=new Ave(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,wN,Wve).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,CN,Bve).call(e,...r)}),this.addHook("afterModifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,NN,iCe).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,yN,Uve).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,SN,zve).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,JS,$N).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,JS,$N).call(e,...r)}),this.addHook("beforeSetRangeEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,EN,Yve).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,vN,Vve).call(e,...r)}),this.addHook("afterRenderer",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,RN,jve).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,bN,Gve).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,TN,Kve).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,_N,Xve).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,MN,qve).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,xN,Qve).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,PN,Zve).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,ON,Jve).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,AN,eCe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,IN,tCe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,HN,nCe).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,DN,rCe).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,kN,oCe).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bt(e,LN,sCe).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[Md];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!ST())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=xc(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=xc(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let n=!0;return e?(po.containsNegativeValues(e)?(Rt(po.NEGATIVE_VALUES_WARNING(e)),n=!1):po.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Rt(po.IS_OUT_OF_BOUNDS_WARNING(e)),n=!1):po.isSingleCell(e)?(Rt(po.IS_SINGLE_CELL(e)),n=!1):po.containsZeroSpan(e)&&(Rt(po.ZERO_SPAN_WARNING(e)),n=!1),n):!1}generateFromSettings(e){if(Array.isArray(e)){const n=[];if(P(e,r=>{if(!this.validateSetting(r))return;const i=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(i,i,o);this.mergeRange(s,!0,!0),ye(r.row,r.row+r.rowspan-1,a=>{ye(r.col,r.col+r.colspan-1,l=>{a===r.row&&l===r.col||n.push([a,l,null])})})}),n.length===0)return;this.hot.setDataAtCell(n)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.toggleMerge(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),ye(0,s.rowspan-1,c=>{ye(0,s.colspan-1,h=>{let f=null;a[c]||(a[c]=[]),c===0&&h===0?f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=f})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),P(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),ye(0,i.rowspan-1,o=>{ye(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:pN})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(pN)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Be(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Be(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Be(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Be(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function Wve(){this.generateFromSettings(this.hot.getSettings()[Md]),this.hot.render()}function Vve(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1}return t}function Bve(t){const e=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},r=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),o=this.mergedCellsCollection.get(i.row,i.col);if($u(this,fo)||ZS(this,fo,this.hot._createCellCoords(null,null)),o){const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);this.hot._createCellRange(a,a,l).includes($u(this,fo))||ZS(this,fo,this.hot._createCellCoords(null,null)),n.row=$u(this,fo).row?$u(this,fo).row-i.row:n.row,n.col=$u(this,fo).col?$u(this,fo).col-i.col:n.col,t.row>0?n.row=o.row+o.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-o.row+t.row),t.col>0?n.col=o.col+o.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-o.col+t.col)}r=this.hot._createCellCoords(e.highlight.row+n.row,e.highlight.col+n.col);const s=this.mergedCellsCollection.get(r.row,r.col);if(s){const a=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);ZS(this,fo,r),n={row:a.row-i.row,col:a.col-i.col}}n.row!==0&&(t.row=n.row),n.col!==0&&(t.col=n.col)}function Uve(t){const e=this.hot.getSelectedRangeLast(),n=gr(t),r=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=gr(n);const o=this.mergedCellsCollection.getWithinRange(r,!0);do i=gr(n),this.selectionCalculations.getUpdatedSelectionRange(e,n),P(o,s=>{this.selectionCalculations.snapDelta(n,e,s)});while(n.row!==i.row||n.col!==i.col);t.row=n.row,t.col=n.col}function zve(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:r,col:i,colspan:o,rowspan:s}=n;return[r,i,r+s-1,i+o-1]}function Gve(t){t.items.push({name:"---------"},Ive(this))}function jve(t,e,n){const r=this.mergedCellsCollection.get(e,n),i=Be(r)?gr(r):void 0;if(Be(i)){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:a,col:l,colspan:u,rowspan:c}=i,[h,f]=this.translateMergedCellToRenderable(a,c,l,u),g=o.getRenderableFromVisualIndex(e),p=s.getRenderableFromVisualIndex(n),y=h-g+1,E=f-p+1;i.row=o.getNearestNotHiddenIndex(i.row,1),i.col=s.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,y),i.colspan=Math.min(i.colspan,E)}PR(t,i,e,n)}function $N(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function Yve(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){const o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}function Kve(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Xve(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function qve(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Qve(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(r=this.autofillCalculations.snapDragArea(e,r,n,i)),r}function Zve(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Jve(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function eCe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function tCe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function nCe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function rCe(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);P(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function iCe(t,e,n){if(!this.enabled)return;const r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;const i=e>0,o=e<0,s=n<0,a=n>0,l=r.row+r.rowspan-1===this.hot.countRows()-1,u=r.row===0,c=r.col+r.colspan-1===this.hot.countCols()-1,h=r.col===0;(i&&l||o&&u||a&&c||s&&h)&&(t.row=r.row,t.col=r.col)}function oCe(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function sCe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function aCe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],f=u.multiColumnSorting,p=(f.compareFunctionFactory?f.compareFunctionFactory:U2(u.type))(l,u,f)(c,h);if(p===Eo){const y=a+1;if(typeof e[y]<"u")return s(y)}return p}(0)}}function FN(){Rt(mt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const Rz="sort";function lCe(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${Rz}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function uCe(t){const e=t.className.split(" "),n=new RegExp(`^${Rz}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function cCe(t,e,n){return e=hCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hCe(t){var e=dCe(t,"string");return typeof e=="symbol"?e:String(e)}function dCe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Mw="multiColumnSorting",fCe=170,WN="columnSorting",VN=Mw;B2(Mw,aCe);class gCe extends z2{constructor(){super(...arguments),cCe(this,"pluginKey",Mw)}static get PLUGIN_KEY(){return Mw}static get PLUGIN_PRIORITY(){return fCe}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[WN]&&FN(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,pw))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:VN})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(VN)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),Le(e,uCe(e)),this.enabled!==!1&&te(e,lCe(...r))}updateSortingIndicator(e,n){super.updateSortingIndicator(e,n);const r=n.querySelector(".columnSortingIndicator");if(!r||!this.hot.getSettings().ariaTags||!this.columnStatesManager.isColumnSorted(e)||this.columnStatesManager.getNumberOfSortedColumns()<=1)return;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e)+1,o=ba(`${this.hot.getTranslatedPhrase(A_)} ${i}.`);Ha(r,_s()[0]),Re(r,...o)}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[WN]&&FN(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){aM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,pw))):this.sort(this.getColumnNextConfig(n.col)))}}function BN(t,e,n){return e=mCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mCe(t){var e=pCe(t,"string");return typeof e=="symbol"?e:String(e)}function pCe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const wCe="multipleSelectionHandles",vCe=160;class CCe extends at{constructor(){super(...arguments),BN(this,"dragged",[]),BN(this,"lastSetCell",null)}static get PLUGIN_KEY(){return wCe}static get PLUGIN_PRIORITY(){return vCe}isEnabled(){return ss()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(De(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(De(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(De(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(De(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const f=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!f||f===e.lastSetCell||((f.nodeName==="TD"||f.nodeName==="TH")&&(s=e.hot.getCoords(f),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=f),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function OR(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function Ez(){return{label:"",isPlaceholder:!0}}function yCe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;P(t,i=>{const o=[];let s=0;n.push(o),P(i,a=>{const l=OR();if(Be(a)){const{label:c,colspan:h}=a;l.label=Yt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h)}else l.label=Yt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(Ez());return!u})});const r=Math.max(...Ge(n,i=>i.length));return P(n,i=>{if(i.length<r){const o=Ge(new Array(r-i.length),()=>OR());i.splice(i.length,0,...o)}}),n}function eb(t,e,n){SCe(t,e),e.set(t,n)}function SCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pi(t,e){var n=Tz(t,e,"get");return bCe(t,n)}function bCe(t,e){return e.get?e.get.call(t):e.value}function Vh(t,e,n){var r=Tz(t,e,"set");return RCe(t,r,n),n}function Tz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function RCe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const UN=["label","collapsible"];var Ko=new WeakMap,gl=new WeakMap,tb=new WeakMap;class ECe{constructor(){eb(this,Ko,{writable:!0,value:[]}),eb(this,gl,{writable:!0,value:0}),eb(this,tb,{writable:!0,value:1/0})}setColumnsLimit(e){Vh(this,tb,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Vh(this,Ko,yCe(e,Pi(this,tb))),Vh(this,gl,Pi(this,Ko).length)}getData(){return Pi(this,Ko)}mergeWith(e){P(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&sn(s,o,UN)})}map(e){P(Pi(this,Ko),n=>{P(n,r=>{const i=e({...r});Be(i)&&sn(r,i,UN)})})}getHeaderSettings(e,n){var r;if(e>=Pi(this,gl)||e<0)return null;const i=Pi(this,Ko)[e];return n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Pi(this,gl)||e<0)return i;const o=Pi(this,Ko)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Pi(this,gl)}getColumnsCount(){return Pi(this,gl)>0?Pi(this,Ko)[0].length:0}clear(){Vh(this,Ko,[]),Vh(this,gl,0)}}function nb(t,e,n){return e=TCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TCe(t){var e=_Ce(t,"string");return typeof e=="symbol"?e:String(e)}function _Ce(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _z="DF-pre-order";function Mz(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=Mz.call(this.childs[r],t,e)}return n}const MCe="DF-post-order";function xz(t,e){for(let n=0;n<this.childs.length;n++)if(xz.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const Pz="BF";function xCe(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const PCe=Pz,zN=new Map([[_z,Mz],[MCe,xz],[Pz,xCe]]);class xw{constructor(e){nb(this,"data",{}),nb(this,"parent",null),nb(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new xw({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:PCe;if(!zN.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);zN.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function rb(t,e,n){OCe(t,e),e.set(t,n)}function OCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lr(t,e){var n=Oz(t,e,"get");return ACe(t,n)}function ACe(t,e){return e.get?e.get.call(t):e.value}function ICe(t,e,n){var r=Oz(t,e,"set");return HCe(t,r,n),n}function Oz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function HCe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Fu=new WeakMap,ml=new WeakMap,Wu=new WeakMap;class DCe{constructor(e){rb(this,Fu,{writable:!0,value:new Map}),rb(this,ml,{writable:!0,value:new Map}),rb(this,Wu,{writable:!0,value:null}),ICe(this,Wu,e)}getRoots(){return Array.from(lr(this,Fu).values())}getRootByColumn(e){let n;return lr(this,ml).has(e)&&(n=lr(this,Fu).get(lr(this,ml).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-lr(this,ml).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;lr(this,ml).clear(),P(lr(this,Fu),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)lr(this,ml).set(i,e);e+=r})}buildTree(){this.clear();const e=lr(this,Wu).getColumnsCount();let n=0;for(;n<e;){const r=lr(this,Wu).getHeaderSettings(0,n),i=new xw;lr(this,Fu).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=lr(this,Wu).getHeadersSettings(r,n,i);r+=1,P(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new xw(a),e.addChild(l)),r<lr(this,Wu).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){lr(this,Fu).clear(),lr(this,ml).clear()}}function Az(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function Pw(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function Ow(t){return Pw(t,"origColspan")===t.data.origColspan}function yM(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Ow(t))return yM(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)P(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,Az(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Ow(a)&&(l.isCollapsed=Pw(a,"isCollapsed"))}),{rollbackModification:()=>SM(t),affectedColumns:Array.from(o),colspanCompensation:s}}function SM(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Ow(t))return SM(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)P(o,l=>{Az(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=Pw(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Ow(l)&&(u.isCollapsed=Pw(l,"isCollapsed"))}),{rollbackModification:()=>yM(t),affectedColumns:Array.from(s),colspanCompensation:a}}function NCe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(mt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function kCe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(mt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const GN=new Map([["collapse",SM],["expand",yM],["hide-column",NCe],["show-column",kCe]]);function LCe(t,e,n){if(!GN.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return GN.get(t)(e,n)}function _m(t){const e=[];return P(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=FCe(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(Ez());else{const g=$Ce(i);g.isRoot=!0,u.push(g),c=!0}})}),e}function $Ce(t){const{crossHiddenColumns:e,...n}=OR(t);return n}function FCe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function ib(t,e,n){WCe(t,e),e.set(t,n)}function WCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bh(t,e,n){var r=Iz(t,e,"set");return VCe(t,r,n),n}function VCe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ut(t,e){var n=Iz(t,e,"get");return BCe(t,n)}function Iz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function BCe(t,e){return e.get?e.get.call(t):e.value}var co=new WeakMap,br=new WeakMap,pl=new WeakMap;class UCe{constructor(){ib(this,co,{writable:!0,value:new ECe}),ib(this,br,{writable:!0,value:new DCe(Ut(this,co))}),ib(this,pl,{writable:!0,value:[[]]})}setState(e){Ut(this,co).setData(e);let n=!1;try{Ut(this,br).buildTree()}catch{Ut(this,br).clear(),Ut(this,co).clear(),n=!0}return Bh(this,pl,_m(Ut(this,br).getRoots())),n}setColumnsLimit(e){Ut(this,co).setColumnsLimit(e)}mergeStateWith(e){const n=Ge(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Ut(this,co).mergeWith(n),Ut(this,br).buildTree(),Bh(this,pl,_m(Ut(this,br).getRoots()))}mapState(e){Ut(this,co).map(e),Ut(this,br).buildTree(),Bh(this,pl,_m(Ut(this,br).getRoots()))}mapNodes(e){return en(Ut(this,br).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Ut(this,br).getNode(n,r);let o;return i&&(o=LCe(e,i,r),Bh(this,pl,_m(Ut(this,br).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Ut(this,pl)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Ut(this,br).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let o=!1,s=null;for(let a=e;a<=r;a++){const l=Ut(this,br).getRootByColumn(a);if(!l)break;o=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:h,origColspan:f,isHidden:g}=u.data;g||f<=i&&c>=e&&c+f-1<=r&&(s===null||h<s)&&(s=h)},_z)}return o&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Ut(this,co).getLayersCount()}getColumnsCount(){return Ut(this,co).getColumnsCount()}clear(){Bh(this,pl,[]),Ut(this,co).clear(),Ut(this,br).clear()}}function Uh(t,e,n){return e=zCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zCe(t){var e=GCe(t,"string");return typeof e=="symbol"?e:String(e)}function GCe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jCe{constructor(e,n){Uh(this,"hot",void 0),Uh(this,"nestedHeaderSettingsGetter",void 0),Uh(this,"layersCount",0),Uh(this,"container",void 0),Uh(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const f=n.createElement("th"),g=this.nestedHeaderSettingsGetter(l,h);if(g&&(!g.isPlaceholder||g.isHidden)){let p=g.label;s&&(p+='<button class="changeType"></button>'),Ql(f,p),f.colSpan=g.colspan,u.appendChild(f)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}const YCe=jCe;function En(t,e){Hz(t,e),e.add(t)}function jN(t,e,n){return e=KCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KCe(t){var e=XCe(t,"string");return typeof e=="symbol"?e:String(e)}function XCe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mm(t,e,n){Hz(t,e),e.set(t,n)}function Hz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pl(t,e,n){var r=Dz(t,e,"set");return qCe(t,r,n),n}function qCe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function rt(t,e){var n=Dz(t,e,"get");return QCe(t,n)}function Dz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function QCe(t,e){return e.get?e.get.call(t):e.value}function cn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const YN="nestedHeaders",ZCe=280;var ft=new WeakMap,Us=new WeakMap,xd=new WeakMap,nC=new WeakMap,xm=new WeakSet,KN=new WeakSet,XN=new WeakSet,qN=new WeakSet,QN=new WeakSet,ZN=new WeakSet,JN=new WeakSet,ek=new WeakSet,tk=new WeakSet,nk=new WeakSet,rk=new WeakSet,ik=new WeakSet,ok=new WeakSet,sk=new WeakSet,ak=new WeakSet,lk=new WeakSet,uk=new WeakSet,ck=new WeakSet;class JCe extends at{constructor(){super(...arguments),En(this,ck),En(this,uk),En(this,lk),En(this,ak),En(this,sk),En(this,ok),En(this,ik),En(this,rk),En(this,nk),En(this,tk),En(this,ek),En(this,JN),En(this,ZN),En(this,QN),En(this,qN),En(this,XN),En(this,KN),En(this,xm),Mm(this,ft,{writable:!0,value:new UCe}),Mm(this,Us,{writable:!0,value:null}),Mm(this,xd,{writable:!0,value:null}),Mm(this,nC,{writable:!0,value:!1}),jN(this,"ghostTable",new YCe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),jN(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return YN}static get PLUGIN_PRIORITY(){return ZCe}isEnabled(){return!!this.hot.getSettings()[YN]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&Rt(mt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>cn(this,uk,mye).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cn(e,ck,pye).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cn(e,QN,rye).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cn(e,ZN,iye).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cn(e,JN,oye).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cn(e,ek,sye).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cn(e,tk,aye).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cn(e,nk,lye).call(e,...i)}),this.addHook("afterSelection",()=>cn(this,xm,ob).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cn(e,KN,eye).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>cn(this,ik,cye).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cn(e,sk,dye).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cn(e,ak,fye).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cn(e,XN,tye).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cn(e,qN,nye).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cn(e,rk,uye).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cn(e,ok,hye).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cn(e,lk,gye).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>cn(this,xm,ob).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>cn(this,xm,ob).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();rt(this,ft).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=rt(this,ft).setState(e)),this.detectedOverlappedHeaders&&Rt(mt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";rt(this,ft).triggerColumnModification(i,r)}),!rt(this,Us)&&this.enabled&&Pl(this,Us,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";rt(this,ft).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),rt(this,ft).clear(),rt(this,Us).unsubscribe(),Pl(this,Us,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return rt(this,ft)}getLayersCount(){return rt(this,ft).getLayersCount()}getHeaderSettings(e,n){return rt(this,ft).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),Le(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),Le(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),Le(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),Le(o,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:f}=(s=rt(this,ft).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(f||h)te(o,"hiddenHeader");else if(c>1){var g,p;const{wtOverlays:y}=l._wt,E=(g=y.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),v=(p=y.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o),C=E||v?Math.min(c,r-i):c;C>1&&o.setAttribute("colspan",C)}this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=rt(this,ft).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){Pl(this,ft,null),rt(this,Us)!==null&&(rt(this,Us).unsubscribe(),Pl(this,Us,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return rt(this,ft).getHeaderTreeNodeData(e.row,e.col)}}function ob(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=rt(this,ft).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function eye(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const i=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=rt(this,ft).findLeftMostColumnIndex(n.row,n.col),a=rt(this,ft).findRightMostColumnIndex(n.row,n.col);return s<i&&a>o?t:s<i?s:a}function tye(t,e,n){const r=rt(this,ft).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=rt(this,ft).getHeaderSettings(e,t);if(o===UT){if(!a)return r.columnIndex}else if(o===dB&&(l>s-i||!a))return null;return t}function nye(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let f=a;f<=u;f++)for(let g=s;g<=l;g++){var i;const p=c+g,y=f-a;if(y===0)continue;((i=rt(this,ft).getHeaderTreeNodeData(g,f))===null||i===void 0?void 0:i.isRoot)===!1&&(t[p][y]="")}}}function rye(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function iye(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Pl(this,xd,e.clone()),Pl(this,nC,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(yv(t)||_a(t)&&l)&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function oye(t,e,n,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],f=Or(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,f):e.col>c.col?h.push(l.col,o+s-1,f):h.push(o,o+s-1,f),this.hot.selection.selectColumns(...h)}function sye(){Pl(this,nC,!1)}function aye(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!rt(this,nC)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=rt(this,ft).getHeaderTreeNodeData(rt(this,xd).row,rt(this,xd).col);if(e.setHighlight(rt(this,xd)),o>e.getWidth()||i<n||i+o-1>r){const s=rt(this,ft).findTopMostEntireHeaderLevel(Or(n,i,i+o-1),Or(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function lye(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=rt(this,ft).findLeftMostColumnIndex(n.row,n.col),o=rt(this,ft).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function uye(t,e){const n=t.row,r=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function cye(t){t.length=0;for(let e=0;e<rt(this,ft).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function hye(t){const e=rt(this,ft).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=rt(this,ft).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),dr(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?rt(this,ft).getHeaderTreeNodeData(0,n).columnIndex:n}function dye(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function fye(t,e,n){var r;const{label:i}=(r=rt(this,ft).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function gye(t,e){if(t<0)return this.hot.getCell(t,rt(this,ft).findLeftMostColumnIndex(t,e),!0)}function mye(){this.updatePlugin()}function pye(t,e){e||this.updatePlugin()}function zh(t,e,n){return e=wye(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wye(t){var e=vye(t,"string");return typeof e=="symbol"?e:String(e)}function vye(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cye{constructor(e,n){zh(this,"hot",void 0),zh(this,"data",null),zh(this,"plugin",void 0),zh(this,"parentReference",new WeakMap),zh(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},ye(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&P(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&P(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return je(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(P(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(ye(e[0],e[2],f=>{const g=this.translateTrimmedRow(f);i.push(this.getDataObject(g))}),ye(0,i.length-2,f=>{this.detachFromParent(i[f],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const f=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,f,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,f,this.plugin.pluginName),u){h=c+this.countChildren(u);const g=this.getChild(u,this.countChildren(u)-1),p=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",p+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];P(r,o=>{i.push(this.getDataObject(o))}),P(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),f=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&f?1:0),1),this.syncRowWithRawSource(s),f||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const yye=Cye;function hk(t,e,n){return e=Sye(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sye(t){var e=bye(t,"string");return typeof e=="symbol"?e:String(e)}function bye(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rye{constructor(e,n){hk(this,"hot",void 0),hk(this,"plugin",void 0),this.hot=n,this.plugin=e}}const bM=Rye;class Jo extends bM{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(P(l,c=>{c&&s.removeChild(c)}),te(n,Jo.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",ye(0,i-1,()=>{const f=c.createElement("SPAN");te(f,Jo.CSS_CLASSES.emptyIndicator),s.appendChild(f)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Re(c,[_s()]),te(n,Jo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(te(c,`${Jo.CSS_CLASSES.button} ${Jo.CSS_CLASSES.expandButton}`),u&&Re(n,[xn(!1),Qd(this.hot.getTranslatedPhrase(N_))])):(te(c,`${Jo.CSS_CLASSES.button} ${Jo.CSS_CLASSES.collapseButton}`),u&&Re(n,[xn(!0),Qd(this.hot.getTranslatedPhrase(k_))])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}const Nz=Jo;class Eye extends bM{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),P(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{ye(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&P(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];P(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return P(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);P(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return P(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);P(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&P(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];P(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];P(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];P(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{P(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{P(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&P(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);De(e.target,Nz.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Ci(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const Tye=Eye;function _ye(t,e,n){Mye(t,e),e.set(t,n)}function Mye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xye(t,e,n){return e=Pye(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pye(t){var e=Oye(t,"string");return typeof e=="symbol"?e:String(e)}function Oye(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Aye(t,e){var n=Iye(t,e,"get");return Hye(t,n)}function Iye(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Hye(t,e){return e.get?e.get.call(t):e.value}var dk=new WeakMap;class Dye extends bM{constructor(){super(...arguments),xye(this,"dataManager",this.plugin.dataManager),_ye(this,dk,{writable:!0,value:{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(z1)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(G1)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return ye(0,e.items.length-1,r=>{if(r===0)return P(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return ye(0,e.items.length-1,n=>{const r=Aye(this,dk)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}const Nye=Dye;function Pm(t,e,n){return e=kye(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kye(t){var e=Lye(t,"string");return typeof e=="symbol"?e:String(e)}function Lye(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $ye{constructor(e){Pm(this,"plugin",void 0),Pm(this,"hot",void 0),Pm(this,"dataManager",void 0),Pm(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(p=>{if(!l)return!1;const y=this.dataManager.translateTrimmedRow(p);return l=this.shouldAllowMoving(y,a),y}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),f=this.getTargetParent(s,a),g=h===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,g),this.moveRows(u,a,f),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return bt(i)&&(Rt(mt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function Bn(t,e){kz(t,e),e.add(t)}function fk(t,e,n){kz(t,e),e.set(t,n)}function kz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sb(t,e,n){return e=Fye(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fye(t){var e=Wye(t,"string");return typeof e=="symbol"?e:String(e)}function Wye(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gp(t,e){var n=Lz(t,e,"get");return Vye(t,n)}function Vye(t,e){return e.get?e.get.call(t):e.value}function Aw(t,e,n){var r=Lz(t,e,"set");return Bye(t,r,n),n}function Lz(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Bye(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Dn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Iw="nestedRows",Uye=300,gk=Iw,zye="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var rC=new WeakMap,Vu=new WeakMap,mk=new WeakSet,pk=new WeakSet,wk=new WeakSet,vk=new WeakSet,Ck=new WeakSet,yk=new WeakSet,Sk=new WeakSet,bk=new WeakSet,Rk=new WeakSet,Ek=new WeakSet,Tk=new WeakSet,_k=new WeakSet,Mk=new WeakSet,xk=new WeakSet,Pk=new WeakSet,ab=new WeakSet;class Gye extends at{constructor(){super(...arguments),Bn(this,ab),Bn(this,Pk),Bn(this,xk),Bn(this,Mk),Bn(this,_k),Bn(this,Tk),Bn(this,Ek),Bn(this,Rk),Bn(this,bk),Bn(this,Sk),Bn(this,yk),Bn(this,Ck),Bn(this,vk),Bn(this,wk),Bn(this,pk),Bn(this,mk),sb(this,"dataManager",null),sb(this,"headersUI",null),sb(this,"collapsedRowsMap",null),fk(this,rC,{writable:!0,value:!1}),fk(this,Vu,{writable:!0,value:!1})}static get PLUGIN_KEY(){return Iw}static get PLUGIN_PRIORITY(){return Uye}isEnabled(){return!!this.hot.getSettings()[Iw]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new $f),this.dataManager=new yye(this,this.hot),this.collapsingUI=new Tye(this,this.hot),this.headersUI=new Nz(this,this.hot),this.contextMenuUI=new Nye(this,this.hot),this.rowMoveController=new $ye(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dn(e,xk,oSe).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dn(e,Pk,sSe).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dn(e,wk,Kye).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dn(e,vk,Xye).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dn(e,Ck,qye).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dn(e,pk,Yye).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dn(e,bk,Jye).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dn(e,Sk,Zye).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dn(e,Rk,eSe).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dn(e,Ek,tSe).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dn(e,Tk,nSe).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dn(e,_k,rSe).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dn(e,yk,Qye).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dn(e,Mk,iSe).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dn(e,mk,jye).call(e,...r)}),this.addHook("beforeLoadData",n=>Dn(this,ab,Ok).call(this,n)),this.addHook("beforeUpdateData",n=>Dn(this,ab,Ok).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){const n=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n)}},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:gk})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gk)}disableCoreAPIModifiers(){Aw(this,Vu,!0)}enableCoreAPIModifiers(){Aw(this,Vu,!1)}onModifyRowData(e){if(!gp(this,Vu))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!gp(this,Vu))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return gp(this,Vu)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function jye(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function Yye(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Kye(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),Aw(this,rC,!0),this.dataManager.getData().slice()}function Xye(t){return this.contextMenuUI.appendOptions(t)}function qye(t,e){this.headersUI.appendLevelIndicators(t,e)}function Qye(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Zye(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{Aw(this,rC,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Jye(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function eSe(){this.collapsingUI.collapsedRowsStash.stash()}function tSe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function nSe(){this.collapsingUI.collapsedRowsStash.stash()}function rSe(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function iSe(){this.dataManager.rewriteCache()}function oSe(){this.headersUI.updateRowHeaderWidth()}function sSe(t,e){gp(this,rC)&&(e.skipRender=!0)}function Ok(t){if(!RB(t)){_T(zye),this.hot.getSettings()[Iw]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function lb(t,e,n){return e=aSe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aSe(t){var e=lSe(t,"string");return typeof e=="symbol"?e:String(e)}function lSe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uSe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;lb(this,"rootWindow",void 0),lb(this,"prefix",void 0),lb(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){P(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const cSe=uSe;function hSe(t,e,n){return e=dSe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dSe(t){var e=fSe(t,"string");return typeof e=="symbol"?e:String(e)}function fSe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}me.getSingleton().register("persistentStateSave");me.getSingleton().register("persistentStateLoad");me.getSingleton().register("persistentStateReset");const Ak="persistentState",gSe=0;class mSe extends at{constructor(){super(...arguments),hSe(this,"storage",void 0)}static get PLUGIN_KEY(){return Ak}static get PLUGIN_PRIORITY(){return gSe}isEnabled(){return!!this.hot.getSettings()[Ak]}enablePlugin(){this.enabled||(this.storage||(this.storage=new cSe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function pSe(t,e){wSe(t,e),e.add(t)}function wSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ub(t,e,n){return e=vSe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vSe(t){var e=CSe(t,"string");return typeof e=="symbol"?e:String(e)}function CSe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ik(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const cb="search",ySe=190,SSe="htSearchResult",bSe=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},RSe=function(t,e,n){return bt(t)||t===null||!t.toLocaleLowerCase||t.length===0||bt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var hb=new WeakSet;class ESe extends at{constructor(){super(...arguments),pSe(this,hb),ub(this,"callback",bSe),ub(this,"queryMethod",RSe),ub(this,"searchResultClass",SSe)}static get PLUGIN_KEY(){return cb}static get PLUGIN_PRIORITY(){return ySe}isEnabled(){return this.hot.getSettings()[cb]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[cb];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ik(e,hb,Hk).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ik(e,hb,Hk).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return ye(0,i-1,l=>{ye(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),f=h.search.callback||n,p=(h.search.queryMethod||r)(e,c,h);if(p){const y={row:l,col:u,data:c};s.push(y)}f&&f(a,l,u,c,p)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Be(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function Hk(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function db(t,e){TSe(t,e),e.add(t)}function TSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Om(t,e,n){return e=_Se(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _Se(t){var e=MSe(t,"string");return typeof e=="symbol"?e:String(e)}function MSe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fb(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const xSe="touchScroll",PSe=200;var Dk=new WeakSet,Nk=new WeakSet,kk=new WeakSet;class OSe extends at{constructor(){super(...arguments),db(this,kk),db(this,Nk),db(this,Dk),Om(this,"scrollbars",[]),Om(this,"clones",[]),Om(this,"lockedCollection",!1),Om(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return xSe}static get PLUGIN_PRIORITY(){return PSe}static get SETTING_KEYS(){return!0}isEnabled(){return kT()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>fb(this,Dk,ASe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>fb(this,Nk,ISe).call(this)),this.addHook("afterMomentumScroll",()=>fb(this,kk,HSe).call(this))}}function ASe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function ISe(){this.freezeOverlays=!0,P(this.clones,t=>{te(t,"hide-tween")})}function HSe(){this.freezeOverlays=!1,P(this.clones,t=>{Le(t,"hide-tween"),te(t,"show-tween")}),this.hot._registerTimeout(()=>{P(this.clones,t=>{Le(t,"show-tween")})},400),P(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function DSe(t,e){NSe(t,e),e.add(t)}function NSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kSe(t,e,n){return e=LSe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LSe(t){var e=$Se(t,"string");return typeof e=="symbol"?e:String(e)}function $Se(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FSe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const mp="trimRows",WSe=330;var Lk=new WeakSet;class VSe extends at{constructor(){super(...arguments),DSe(this,Lk),kSe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return mp}static get PLUGIN_PRIORITY(){return WSe}isEnabled(){return!!this.hot.getSettings()[mp]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new $f),this.trimmedRowsMap.addLocalHook("init",()=>FSe(this,Lk,BSe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[mp];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),P(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{P(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(P(e,l=>{o[l]=!1}),i=en(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function BSe(){const t=this.hot.getSettings()[mp];Array.isArray(t)&&this.hot.batchExecution(()=>{P(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}const $z="undoRedo",USe="undoRedo";function de(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(n,r){const i=n&&n.length;if(!i||!n.find(a=>{const[,,l,u]=a;return l!==u}))return;const s=()=>{const a=n.reduce((u,c)=>(u.push([...c]),u),[]);P(a,u=>{u[1]=t.propToCol(u[1])});const l=i>1?this.getSelected():[[a[0][0],a[0][1]]];return new de.ChangeAction(a,l)};e.done(s,r)}),t.addHook("afterCreateRow",(n,r,i)=>{e.done(()=>new de.CreateRowAction(n,r),i)}),t.addHook("beforeRemoveRow",(n,r,i,o)=>{const s=()=>{const a=t.toPhysicalRow(n),l=Zn(e.instance.getSourceData(a,0,a+r-1,e.instance.countSourceCols()-1));return new de.RemoveRowAction(a,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(s,o)}),t.addHook("afterCreateCol",(n,r,i)=>{e.done(()=>new de.CreateColumnAction(n,r),i)}),t.addHook("beforeRemoveCol",(n,r,i,o)=>{const s=()=>{const a=e.instance.getSourceDataArray(),l=(e.instance.countCols()+n)%e.instance.countCols(),u=[],c=[],h=[];ye(a.length-1,p=>{const y=[],E=a[p];ye(l,l+(r-1),v=>{y.push(E[t.toPhysicalColumn(v)])}),u.push(y)}),ye(r-1,p=>{h.push(t.toPhysicalColumn(l+p))}),Array.isArray(t.getSettings().colHeaders)&&ye(r-1,p=>{c.push(t.getSettings().colHeaders[t.toPhysicalColumn(l+p)]||null)});const f=t.columnIndexMapper.getIndexesSequence(),g=t.rowIndexMapper.getIndexesSequence();return new de.RemoveColumnAction(l,h,u,c,f,g,t.getSettings().fixedColumnsStart)};e.done(s,o)}),t.addHook("beforeCellAlignment",(n,r,i,o)=>{e.done(()=>new de.CellAlignmentAction(n,r,i,o))}),t.addHook("beforeFilter",n=>{e.done(()=>new de.FiltersAction(n))}),t.addHook("beforeRowMove",(n,r)=>{n!==!1&&e.done(()=>new de.RowMoveAction(n,r))}),t.addHook("beforeMergeCells",(n,r)=>{r||e.done(()=>new de.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",(n,r)=>{r||e.done(()=>new de.UnmergeCellsAction(t,n))}),t.addHook("afterInit",()=>{e.init()})}de.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};de.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=Zn(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};de.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=Zn(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};de.prototype.isUndoAvailable=function(){return this.doneActions.length>0};de.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};de.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};de.prototype.isEnabled=function(){return this.enabled};de.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,jSe(t),this.registerShortcuts(),t.addHook("afterChange",Fz)};de.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,YSe(t),this.unregisterShortcuts(),t.removeHook("afterChange",Fz)};de.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};de.Action=function(){};de.Action.prototype.undo=function(){};de.Action.prototype.redo=function(){};de.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Ms(de.ChangeAction,de.Action);de.ChangeAction.prototype.undo=function(t,e){const n=Zn(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let o=0,s=n.length;o<s;o++)n[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let o=0,s=n.length;o<s;o++){const[a,l]=n[o];t.getSettings().minSpareRows&&a+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(a+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&l+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(l+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};de.ChangeAction.prototype.redo=function(t,e){const n=Zn(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};de.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Ms(de.CreateRowAction,de.Action);de.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};de.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};de.RemoveRowAction=function(t,e,n,r,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i};Ms(de.RemoveRowAction,de.Action);de.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,o)=>{Object.keys(i).forEach(s=>{const a=parseInt(s,10);r.push([this.index+o,isNaN(a)?s:a,i[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};de.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};de.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Ms(de.CreateColumnAction,de.Action);de.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};de.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};de.RemoveColumnAction=function(t,e,n,r,i,o,s){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s};Ms(de.RemoveColumnAction,de.Action);de.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,h)=>h[this.indexes.indexOf(r[c])],o=this.data.length,s=[];for(let u=0;u<o;u++)s.push(Ge(this.data[u],i));const a=Ge(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),P(t.getSourceDataArray(),(u,c)=>{P(r,(h,f)=>{u[h]=s[c][f],l.push([c,h,u[h]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&P(a,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};de.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};de.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};de.CellAlignmentAction.prototype.undo=function(t,e){P(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};de.CellAlignmentAction.prototype.redo=function(t,e){Gs(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,o)=>t.setCellMeta(n,r,i,o)),t.addHookOnce("afterViewRender",e),t.render()};de.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};Ms(de.FiltersAction,de.Action);de.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()};de.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class zSe extends de.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}de.MergeCellsAction=zSe;class GSe extends de.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}de.UnmergeCellsAction=GSe;de.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};Ms(de.RowMoveAction,de.Action);de.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(a=>a>this.finalIndex),o=r.filter(a=>a<=this.finalIndex),s=i.sort((a,l)=>l-a).concat(o.sort((a,l)=>a-l));t.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){const l=t.toVisualRow(s[a]);n.moveRow(l,s[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};de.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};de.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};de.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:$z};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};de.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup($z)};function Fz(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function jSe(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function YSe(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const Yf=me.getSingleton();Yf.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});Yf.register("beforeUndo");Yf.register("afterUndo");Yf.register("beforeRedo");Yf.register("afterRedo");de.PLUGIN_KEY=USe;de.SETTING_KEYS=!0;function KSe(){it(Cd),it(mle),it(yd),it(jle),it(tue),it(z2),it(Yue),it(Ice),it(Zv),it(rde),it(Mde),it(Nde),it(eC),it(lfe),it(pme),it(Qme),it(Epe),it(Lpe),it(Qpe),it(gwe),it(Mwe),it(Qwe),it(cve),it(Fve),it(gCe),it(CCe),it(JCe),it(Gye),it(mSe),it(ESe),it(OSe),it(VSe),it(de)}function XSe(){Vse(),nae(),cae(),Iae(),KSe()}function qSe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var gb,mb,pb,wb,vb;XSe();qSe(le);le.__GhostTable=oM;le._getListenersCounter=JQ;le._getRegisteredMapsCounter=gne;le.EventManager=Kr;const QSe=[Mq,DQ,ene,iae,PJ,mQ,Aq,gZ,AQ,Hq,LQ,fZ],ZSe=[hQ,$Q];le.helper={};le.dom={};P(QSe,t=>{P(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(le.helper[e]=t[e])})});P(ZSe,t=>{P(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(le.dom[e]=t[e])})});le.cellTypes=(gb=le.cellTypes)!==null&&gb!==void 0?gb:{};P(Dre(),t=>{le.cellTypes[t]=V_(t)});le.cellTypes.registerCellType=ri;le.cellTypes.getCellType=V_;le.editors=(mb=le.editors)!==null&&mb!==void 0?mb:{};P(jQ(),t=>{le.editors[`${Qn(t)}Editor`]=nw(t)});le.editors.registerEditor=_r;le.editors.getEditor=nw;le.renderers=(pb=le.renderers)!==null&&pb!==void 0?pb:{};P(PZ(),t=>{const e=iw(t);t==="base"&&(le.renderers.cellDecorator=e),le.renderers[`${Qn(t)}Renderer`]=e});le.renderers.registerRenderer=mo;le.renderers.getRenderer=iw;le.validators=(wb=le.validators)!==null&&wb!==void 0?wb:{};P(IZ(),t=>{le.validators[`${Qn(t)}Validator`]=OT(t)});le.validators.registerValidator=ac;le.validators.getValidator=OT;le.plugins=(vb=le.plugins)!==null&&vb!==void 0?vb:{};P(PT(),t=>{le.plugins[t]=Nf(t)});le.plugins[`${Qn(at.PLUGIN_KEY)}Plugin`]=at;le.plugins.registerPlugin=it;le.plugins.getPlugin=Nf;const Wz=t=>{var e;vf.useEffect(()=>{var r;const n=(r=t.cellProperties)==null?void 0:r.className;n!==void 0&&t.TD&&le.dom.addClass(t.TD,n)},[(e=t.cellProperties)==null?void 0:e.className,t.TD])};function JSe(t){return Wz(t),we.jsx("div",{"aria-label":`${t.value*10}%`,className:"progressBar",style:{width:`${t.value*10}px`}})}function ebe(t){return Wz(t),we.jsx("div",{className:"star htCenter","aria-label":t.value,children:"★".repeat(t.value)})}var RM={exports:{}};RM.exports;(function(t){(function(e,n,r){function i(l){var u=this,c=a();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function s(l,u){var c=new i(l),h=u&&u.state,f=c.next;return f.int32=function(){return c.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,h&&(typeof h=="object"&&o(h,c),f.state=function(){return o(c,{})}),f}function a(){var l=4022871197,u=function(c){c=String(c);for(var h=0;h<c.length;h++){l+=c.charCodeAt(h);var f=.02519603282416938*l;l=f>>>0,f-=l,f*=l,l=f>>>0,f-=l,l+=f*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.alea=s})(Wi,t,!1)})(RM);var tbe=RM.exports,EM={exports:{}};EM.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,p=(f+g)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xor128=s})(Wi,t,!1)})(EM);var nbe=EM.exports,TM={exports:{}};TM.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,p=(f+g)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xorwow=s})(Wi,t,!1)})(TM);var rbe=TM.exports,_M={exports:{}};_M.exports;(function(t){(function(e,n,r){function i(a){var l=this;l.next=function(){var c=l.x,h=l.i,f,g;return f=c[h],f^=f>>>7,g=f^f<<24,f=c[h+1&7],g^=f^f>>>10,f=c[h+3&7],g^=f^f>>>3,f=c[h+4&7],g^=f^f<<7,f=c[h+7&7],f=f^f<<13,g^=f^f<<9,c[h]=g,l.i=h+1&7,g};function u(c,h){var f,g=[];if(h===(h|0))g[0]=h;else for(h=""+h,f=0;f<h.length;++f)g[f&7]=g[f&7]<<15^h.charCodeAt(f)+g[f+1&7]<<13;for(;g.length<8;)g.push(0);for(f=0;f<8&&g[f]===0;++f);for(f==8?g[7]=-1:g[f],c.x=g,c.i=0,f=256;f>0;--f)c.next()}u(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function s(a,l){a==null&&(a=+new Date);var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,p=(f+g)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(c.x&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xorshift7=s})(Wi,t,!1)})(_M);var ibe=_M.exports,MM={exports:{}};MM.exports;(function(t){(function(e,n,r){function i(a){var l=this;l.next=function(){var c=l.w,h=l.X,f=l.i,g,p;return l.w=c=c+1640531527|0,p=h[f+34&127],g=h[f=f+1&127],p^=p<<13,g^=g<<17,p^=p>>>15,g^=g>>>12,p=h[f]=p^g,l.i=f,p+(c^c>>>16)|0};function u(c,h){var f,g,p,y,E,v=[],C=128;for(h===(h|0)?(g=h,h=null):(h=h+"\0",g=0,C=Math.max(C,h.length)),p=0,y=-32;y<C;++y)h&&(g^=h.charCodeAt((y+32)%h.length)),y===0&&(E=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,y>=0&&(E=E+1640531527|0,f=v[y&127]^=g+E,p=f==0?p+1:0);for(p>=128&&(v[(h&&h.length||0)&127]=-1),p=127,y=4*128;y>0;--y)g=v[p+34&127],f=v[p=p+1&127],g^=g<<13,f^=f<<17,g^=g>>>15,f^=f>>>12,v[p]=g^f;c.w=E,c.X=v,c.i=p}u(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function s(a,l){a==null&&(a=+new Date);var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,p=(f+g)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(c.X&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xor4096=s})(Wi,t,!1)})(MM);var obe=MM.exports,xM={exports:{}};xM.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.next=function(){var h=l.b,f=l.c,g=l.d,p=l.a;return h=h<<25^h>>>7^f,f=f-g|0,g=g<<24^g>>>8^p,p=p-h|0,l.b=h=h<<20^h>>>12^f,l.c=f=f-g|0,l.d=g<<16^f>>>16^p,l.a=p-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,p=(f+g)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.tychei=s})(Wi,t,!1)})(xM);var sbe=xM.exports,Vz={exports:{}};const abe={},lbe=Object.freeze(Object.defineProperty({__proto__:null,default:abe},Symbol.toStringTag,{value:"Module"})),ube=zk(lbe);(function(t){(function(e,n,r){var i=256,o=6,s=52,a="random",l=r.pow(i,o),u=r.pow(2,s),c=u*2,h=i-1,f;function g(T,_,H){var D=[];_=_==!0?{entropy:!0}:_||{};var B=v(E(_.entropy?[T,S(n)]:T??C(),3),D),z=new p(D),G=function(){for(var Z=z.g(o),re=l,ne=0;Z<u;)Z=(Z+ne)*i,re*=i,ne=z.g(1);for(;Z>=c;)Z/=2,re/=2,ne>>>=1;return(Z+ne)/re};return G.int32=function(){return z.g(4)|0},G.quick=function(){return z.g(4)/4294967296},G.double=G,v(S(z.S),n),(_.pass||H||function(Z,re,ne,ue){return ue&&(ue.S&&y(ue,z),Z.state=function(){return y(z,{})}),ne?(r[a]=Z,re):Z})(G,B,"global"in _?_.global:this==r,_.state)}function p(T){var _,H=T.length,D=this,B=0,z=D.i=D.j=0,G=D.S=[];for(H||(T=[H++]);B<i;)G[B]=B++;for(B=0;B<i;B++)G[B]=G[z=h&z+T[B%H]+(_=G[B])],G[z]=_;(D.g=function(Z){for(var re,ne=0,ue=D.i,Ee=D.j,$e=D.S;Z--;)re=$e[ue=h&ue+1],ne=ne*i+$e[h&($e[ue]=$e[Ee=h&Ee+re])+($e[Ee]=re)];return D.i=ue,D.j=Ee,ne})(i)}function y(T,_){return _.i=T.i,_.j=T.j,_.S=T.S.slice(),_}function E(T,_){var H=[],D=typeof T,B;if(_&&D=="object")for(B in T)try{H.push(E(T[B],_-1))}catch{}return H.length?H:D=="string"?T:T+"\0"}function v(T,_){for(var H=T+"",D,B=0;B<H.length;)_[h&B]=h&(D^=_[h&B]*19)+H.charCodeAt(B++);return S(_)}function C(){try{var T;return f&&(T=f.randomBytes)?T=T(i):(T=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(T)),S(T)}catch{var _=e.navigator,H=_&&_.plugins;return[+new Date,e,H,e.screen,S(n)]}}function S(T){return String.fromCharCode.apply(0,T)}if(v(r.random(),n),t.exports){t.exports=g;try{f=ube}catch{}}else r["seed"+a]=g})(typeof self<"u"?self:Wi,[],Math)})(Vz);var cbe=Vz.exports,hbe=tbe,dbe=nbe,fbe=rbe,gbe=ibe,mbe=obe,pbe=sbe,eu=cbe;eu.alea=hbe;eu.xor128=dbe;eu.xorwow=fbe;eu.xorshift7=gbe;eu.xor4096=mbe;eu.tychei=pbe;var wbe=eu;const Bz=pf(wbe);let Uz=Bz();function zz(){return Uz()}function vbe(t){Uz=Bz(t)}function tu(t,e){let n=t;if(Array.isArray(t)){let r=t;e!=null&&e.maxCharCount&&typeof t[0]=="string"&&(r=t.filter(i=>i.length<=e.maxCharCount)),n=()=>Gz(r)}return(e==null?void 0:e.length)===void 0?n(0):Array.from({length:e.length},(r,i)=>n(i))}function Gz(t){return t[Math.floor(zz()*t.length)]}function Cbe({min:t=1,max:e=9999.99,fraction:n=0}={}){if(e<t)throw new Error("Max must be bigger than min");return Number((zz()*(e-t)+t).toFixed(n))}function $k(t){return tu(()=>Gz([!0,!1]),t)}function Lr(t){const e={min:(t==null?void 0:t.min)??0,max:(t==null?void 0:t.max)??999999,precision:t==null?void 0:t.precision,fraction:t==null?void 0:t.fraction};return tu(()=>{if(e.min===e.max)return e.min;const n=Cbe(e);return e.precision!==void 0?Math.floor(n/e.precision)*e.precision:n},t)}function ybe(t){const e=new Date(t.from).getTime(),n=new Date(t.to).getTime();if(e>=n)throw new Error("From must be before to");return tu(()=>new Date(Lr({min:e,max:n})),t)}var Sbe=["Kautzer, Macejkovic and Fisher","Greenholt - Mosciski","Marquardt - Runolfsdottir","Abernathy Inc","Dickens - Lang","Hand, Bernhard and Kessler","Abbott LLC","Kub Inc","Johnston - Wisozk","Reichert LLC","Kohler LLC","Shanahan - Boyle","Batz - Rice","Cronin, Oberbrunner and Beier","Kuhlman, Schowalter and West","Luettgen Inc","Ward Group","Hills and Sons","Prohaska, Balistreri and Walker","Rempel - Durgan","Bernier LLC","Stehr - Lockman","Roberts, Rogahn and Dooley","Lesch - Jakubowski","Jenkins - Turcotte","Gerhold - Rowe","Block - Rau","Dickinson, Tremblay and Moore","Nader - Fritsch","Kreiger and Sons","Bartell, Wehner and Schowalter","Hegmann Inc","Orn, Spencer and Kiehn","Graham, Sipes and Towne","Hodkiewicz Inc","Mills Group","Legros, Tillman and Hodkiewicz","Lesch - Carter","Lesch Group","Kreiger - Sauer","Cartwright - Schuster","Labadie LLC","Pfannerstill, White and Mosciski","Jenkins LLC","Boehm, Hettinger and Huels","Maggio, Wisoky and Blick","Kozey Inc","Stracke - Wisozk","Olson, Olson and Carter","Orn, Gerlach and Runolfsdottir","Stracke - Kertzmann","Walker - Zieme","Hodkiewicz - Hintz","Lind Group","Fahey, Leannon and Gleichner","Mertz, Gusikowski and Lemke","Heidenreich - Aufderhar","Zboncak and Sons","Carroll Group","Brown LLC","Weber Inc","Rath LLC","Walker Inc","Heller, Hyatt and Jaskolski","Jacobi - Kutch","Skiles and Sons","Durgan - Stamm","Renner - Prosacco","Hahn - Welch","Lesch, Dooley and Bartell","Crona and Sons","Rogahn, Armstrong and Goyette","Lubowitz, Kuhlman and Bailey","Doyle Group","Dooley and Sons","Kerluke LLC","Bogan - Daniel","Hintz - Boehm","Swaniawski and Sons","Kris, Legros and Cartwright","Reichel Group","Russel - Hintz","Welch, Lockman and Hand","Pouros - Brakus","Mohr, Fritsch and Wisozk","Upton - Reichert","Koepp and Sons","Weber and Sons","Quigley, Bins and Becker","Strosin, Oberbrunner and Wunsch","Rodriguez - Spencer","Wilkinson - Dare","Gutkowski Inc","OReilly LLC","Collins, Mante and Pacocha","Steuber, Luettgen and Corkery","Kub and Sons","Lesch and Sons"];function Gh(t){return tu(Sbe,t)}var bbe=["Argentina","Peru","Colombia","Chile","Uruguay","Gabon","Congo","Norfolk Island","Qatar","Syrian Arab Republic","Wallis and Futuna","Somalia","Saint Barthelemy","Comoros","Sri Lanka","Czech Republic","Christmas Island","Macao","Montenegro","Anguilla","Canada","Mayotte","Tajikistan","Afghanistan","Liechtenstein","Cocos (Keeling) Islands","Angola","Bahrain","Dominican Republic","Croatia","Latvia","Virgin Islands, U.S.","United Kingdom","Brazil","Spain","Mongolia","Montserrat","Estonia","Benin","Guinea","Guinea-Bissau","Greece","Lao Peoples Democratic Republic","Puerto Rico","Slovakia (Slovak Republic)","United States of America","Switzerland","Costa Rica","Mauritius","Nigeria","Russian Federation","Germany","Antigua and Barbuda","Albania","Romania","Moldova","Senegal","Tanzania","British Indian Ocean Territory (Chagos Archipelago)","Central African Republic","New Caledonia","Burundi","Panama","Azerbaijan","Namibia","French Southern Territories","Vanuatu","Ethiopia","Burkina Faso","Tunisia","Mozambique","Belarus","Saint Kitts and Nevis","Hungary","Indonesia","Cyprus","Ecuador","Saint Martin","Nauru","Faroe Islands","Iran","Bolivia","Pitcairn Islands","France","Paraguay","Isle of Man","Sierra Leone","Monaco","Belize","Trinidad and Tobago"];function Rbe(t){return tu(bbe,t)}var Ebe={china:["Peking roasted duck","Kung pao chicken","Sweet and sour pork","Hot pot","Dim sum","Dumplings","Ma po tofu","Char siu","Chicken chow mein","Beef chow mein","vegetable chow mein","Chicken fried rice","Beef fried rice","Vegetable fried Rice","Special fried Rice","Sichuan pork","Xiaolongbao","Zhajiangmian","Wonton soup","Sweet and sour pork","Duck spring Rolls","Vegetable spring Rolls","Wonton","Peking duck","Lamb hot pot","Spicy crayfish","Guilin rice noodles","Lanzhou hand-pulled noodles","Steamed crab","Shredded pork with garlic sauce","Red braised pork","Sweet and sour Ribs","Xinjiang","Braised pork with vermicelli"],italy:["Butternut squash risotto","Mushroom risotto","Beetroot risotto","Courgette risotto","Pizza","Gnocchi","Spaghetti bolognese","Spaghetti carbonara","Pesto alla Genovese","Beef lasagne","Vegetable lasagne","Gelato","Prosciutto di Parma","Ribollita","Bagna cauda","Polenta","Tortelli and ravioli","Focaccia","Garlic bread","Arancini","Il tartufo","Panzerotto fritto","Fiorentina","Minestrone","Frico","Arrosticini","Olive ascolante","Fritto misto piemontes","Tiramisù"],india:["Biryani","Dosa","Tandoori chicken","Samosas","Chaat","Plain naan","Garlic naan","Pilau rice","Steamed rice","Chicken madras","Vegetable madras","Chicken vindaloo","Chicken jalfrezi","Chicken roghan josh","Lamb roghan josh","Beef roghan josh","Butter chicken","Dosa","Gulab jamun","Chicken korma","Mutter paneer","Papadum","Paratha","Raita","Saag paneer","Tandoori chicken","Chicken tikka masala","Pakora","Dal","Chapati","Pasanda","Aloo gobi","Kofta","Chicken makhani","Paneer naan","Chana Aloo Curry"],mexico:["Chilaquiles","Pozole","Tacos al pastor","Tostadas","Chiles en nogada","Elote","Enchiladas","Mole","Guacamole","Tamales","Huevos rancheros","Machaca","Discada","Beef Burrito","Chicken Burrito","Pozole de pollo o duajolote","Menudo","Cochinita pibil","Tamale","Quesadilla","Frijoles puercos","Chile en nogada","Esquites","Alegria de amaranto","Pipián","Aguachile","Ceviche","Pescado zarandeado","Camarones a la diabla","Birria de chivo","Tlayuda","Guacamole con chapulines","Flautas","Torta Ahogada","Carnitas","Caldo Azteca","Gorditas de Nata"],japan:["Sushi","Udon","Tofu","Tempura","Yakitori","Sashimi","Ramen","Donburi","Natto","Oden","Tamagoyaki","Soba","Tonkatsu","Kashipan","Sukiyaki","Miso soup","Okonomiyaki","Mentaiko","Nikujaga","Unagi no kabayaki","Shabu Shabu","Onigiri","Gyoza","Takoyaki","aiseki ryori","Edamame","Yakisoba","Chawanmushi","Wagashi"],france:["Foie gras","Huîtres","Cassoulet","Poulet basquaise","Escargots au beurre persillé","Mouclade charentaise","Galettes bretonnes","Flemish carbonnade","Quiche lorraine","Raclette","Cheese fondue","Beef fondue","Gratin dauphinois","Tartiflette","Bouillabaisse","Ratatouille","Boeuf bourguignon","Blanquette de veau","Pot-au-feu","Coq-au-vin","Hachis parmentier","Steak tartare","Choucroute","Soufflé au fromage","Cuisses de grenouilles","Soupe à l’oignon","Baguette","Croissant","French cheeses","Fondant au chocolat","Tarte tatin","Macarons","Crème brûlée","Île flottante","Profiteroles","Pain au chocolat"],lebanon:["Kibbeh","Kafta","Kanafeh","Hummus","Rice pilaf","Fattoush","Manakish","Tabbouleh","Sfeeha","Fattoush","Labneh","Muhammara","Lahm bi ajin","Kaak","Chanklich","Mssabaha","Shawarma","Kebbe","Falafel","Halewit el jeben","Namoura","Maamoul","Foul mdammas","Balila","Kawarma","Fattouch"],thailand:["Pad kra pao moo","Tom kha gai","Khao Pad","Chicken pad Thai","Vegetable pad Thai","Moo satay","Tom yum goong","Khao niew mamuang","Kai yad sai","Khao soi","Pad see ew","Laab moo","Gaeng panang","Gai pad med ma muang","Som tam","Poh pia tod","Gaeng massaman","Pla kapung nueng manao","Tod mun pla","Gaeng ped","Gaeng garee","Gaeng keow wan","Moo ping","Durian","Sai ooah","Hoy tod","Kuay teow reua","Mu kratha","Kao ka moo","Yam nua"],greece:["Moussaka","Papoutsakia","Pastitsio","Souvlaki","Soutzoukakia","Stifado","Tomatokeftedes","Tzatziki","Kolokithokeftedes","Giouvetsi","Choriatiki","Kleftiko","Gemista","Fasolada","Bougatsa","Tiropita","Spanakopita","Feta Cheese with Honey","Horta","Tirokroketes","Briam","Saganaki","Gigantes","Dolmades","Fasolatha","Koulouri","Loukoumades","Gyros","Galaktoboureko","Baklava"],turkey:["Şiş kebap","Döner","Köfte","Pide","Kumpir","Meze","Mantı","Lahmacun","Menemen","Şiş kebap","İskender kebab","Corba","Kuzu tandir","Çiğ Köfte","Pilav","Yaprak sarma","Dolma","İmam bayıldı","Borek","Durum","Kumpir","Balik ekmek","Simit","Kunefe","Baklava","Lokum","Halva","Mozzaik pasta","Güllaç","Mercimek Köftesi","Haydari","Tursu suyu","Kahvalti","Kazan dibi","Hunkar begendi","Islak burgers","Salep","Yogurtlu kebab"],spain:["Tortilla de patatas","Fabada asturiana","Calçots","Boquerones al vinagre","Empanada gallega","Paella","Gazpacho","Gachas","Migas","Bocadillo de calamares","Pulpo a feira","Caldo gallego","Lentejas con chorizo","Cocido madrileño","Cachopo","Caracoles"],venezuela:["Pabellón criollo","Arepa","Mondongo","Empanadas","Quesillo","Chicha andina","Tequeños","Cachapa","Hallaca","Perico","Pasticho","Mandocas","Caraotas negras","Patacones","Dulce de leche","Pan de Jamón"],chile:["Humitas","Empanadas","Porotos con riendas","Completos","Manjar","Cordero al palo","Pastel de choclo","Mote con huesillos","Sopaipillas","Curanto"],argentina:["Milanesas","Empanadas","Pizza fugazeta","Asado","Choripan","Bondiola","Bife de chorizo"],colombia:["Bandeja paisa","Chuleta valluna","Sancocho trifásico","Empanada valluna","Salpicon de frutas","Pastel de garbanzo","Ajiaco","Arepas","Arroz de lisa","Sancocho","Pan de bono","Cuchuco","Oblea","Cazuela de mariscos","Pan de yuca","Bollo Limpio","Almojábana","Empanadas","Arroz con Coco","Sopa de mondongo","Cazuela de Mariscos","Arroz con Pollo","Arepa de Huevo","Mote de Queso"],ecuador:["Encebollado","Ceviche","Tigrillo","Bolon de verde","Llapingacho","Mote pillo","Locro de papa","Churrasco"],peru:["Ceviche","Arroz con pollo","Aji de gallina","Llunca de gallina"],"el salvador":["Pupusa","Sopa de patas","Rigua","Flor de izote con huevo","Gallo en chicha"],romania:["Sarmale","Mici","Pomana porcului","Ciorbă de fasole cu ciolan","Ciorbă de burtă","Ciorbă rădăuțeană","Plăcintă cu brânză","Ciorbă de potroace","Mămăligă cu brânză și smântână","Tochitură","Piftie","Iahnie de fasole","Slănină afumată","Cârnați afumați","Varză a la Cluj","Gulaș de cartofi cu afumătură","Cozonac de casă","Ciorbă ardelenească de porc","Mucenici moldovenești","Salată de boeuf","Dovleac copt","Papanași cu brânză de vacă și afine","Drob de miel","Pârjoale moldovenești","Zacuscă de vinete","Zacuscă de fasole","Turtă dulce","Clătitele cu gem","Clătitele cu brânza de vacă","Balmoș","Cozonac","Chiftele"]},Uk;(Uk=Object.keys(Ebe))==null||Uk.length;function Fk(t){const e=(t==null?void 0:t.years)??1;if(e<=0)throw new Error("Years must be positive, use future() instead");const n=365*e*24*60*60*1e3,r=new Date,i=new Date(r.getTime()-n);return tu(()=>ybe({from:i,to:r}),t)}var Tbe=["Small Rubber Shoes","Fantastic Wooden Sausages","Handmade Frozen Salad","Intelligent Soft Car","Intelligent Concrete Chips","Handcrafted Concrete Bacon","Small Fresh Fish","Rustic Metal Towels","Unbranded Cotton Hat","Fantastic Frozen Bike","Generic Rubber Shirt","Unbranded Wooden Keyboard","Awesome Metal Computer","Gorgeous Fresh Shoes","Unbranded Concrete Sausages","Practical Wooden Ball","Ergonomic Soft Towels","Small Plastic Table","Awesome Metal Pants","Licensed Steel Sausages","Handcrafted Rubber Bike","Ergonomic Cotton Computer","Generic Wooden Ball","Fantastic Frozen Soap","Generic Plastic Keyboard","Awesome Cotton Pizza","Licensed Metal Chips","Handcrafted Cotton Towels","Handmade Plastic Tuna","Practical Granite Keyboard","Intelligent Concrete Soap","Rustic Concrete Chips","Fantastic Steel Hat","Rustic Cotton Chair","Gorgeous Metal Pants","Intelligent Metal Bacon","Handmade Rubber Car","Tasty Concrete Keyboard","Incredible Granite Hat","Practical Rubber Fish","Rustic Cotton Gloves","Rustic Cotton Ball","Refined Fresh Shirt","Generic Granite Sausages","Rustic Granite Fish","Practical Wooden Bacon","Sleek Plastic Chair","Handcrafted Fresh Mouse","Small Concrete Shoes","Awesome Fresh Chair","Incredible Soft Computer","Tasty Concrete Chips","Generic Rubber Sausages","Intelligent Concrete Chicken","Rustic Soft Ball","Awesome Steel Towels","Incredible Fresh Bike","Unbranded Granite Chicken","Rustic Concrete Bike","Small Frozen Sausages","Intelligent Plastic Gloves","Ergonomic Frozen Towels","Refined Frozen Ball","Refined Cotton Ball","Licensed Steel Salad","Intelligent Wooden Bacon","Unbranded Metal Shoes","Fantastic Granite Car","Ergonomic Granite Bacon","Awesome Wooden Shirt","Rustic Wooden Pizza","Tasty Frozen Table","Awesome Wooden Hat","Awesome Rubber Salad","Licensed Concrete Fish","Fantastic Soft Cheese","Rustic Frozen Pizza","Refined Concrete Tuna","Small Frozen Tuna","Licensed Granite Cheese","Practical Rubber Car","Rustic Steel Sausages","Awesome Concrete Hat","Awesome Granite Sausages","Sleek Plastic Chips","Handcrafted Wooden Gloves","Intelligent Metal Computer","Fantastic Fresh Sausages","Fantastic Plastic Salad","Unbranded Steel Sausages","Handcrafted Wooden Fish","Sleek Wooden Bacon","Unbranded Plastic Towels","Tasty Soft Sausages","Generic Metal Shirt","Handmade Granite Cheese","Small Fresh Bacon","Tasty Granite Towels","Licensed Steel Chips"];function Wk(t){return tu(Tbe,t)}vbe("42219");const jz=[{companyName:Gh({maxCharCount:18}),productName:Wk({maxCharCount:18}),sellDate:Fk().toLocaleDateString(),inStock:$k(),qty:Lr({max:500}),progress:Lr({max:10}),rating:Lr({max:5}),orderId:`${Lr({max:9,min:0})}${Lr({max:9,min:0})}-${Lr({max:9999999,min:1111111})}`,country:"United Kingdom",__children:[{companyName:Gh({maxCharCount:18})},{companyName:Gh({maxCharCount:18})},{companyName:Gh({maxCharCount:18})}]},...Array.from({length:150},()=>({companyName:Gh({maxCharCount:18}),productName:Wk({maxCharCount:18}),sellDate:Fk().toLocaleDateString(),inStock:$k(),qty:Lr({max:500}),progress:Lr({max:10}),rating:Lr({max:5}),orderId:`${Lr({max:9,min:0})}${Lr({max:9,min:0})}-${Lr({max:9999999,min:1111111})}`,country:Rbe({maxCharCount:28})}))],_be=jz.reduce((t,e)=>t.includes(e.country)?t:[...t,e.country],[]);function Mbe({disableTabNavigation:t,navigableHeaders:e,renderAllRows:n,enterBeginsEditing:r,autoWrapRow:i,autoWrapCol:o,enterMoves:s,changeToggleOptions:a}){const l=u=>{switch(u){case"enableTabNavigation":a(c=>({...c,disableTabNavigation:!t}));break;case"enableHeaderNavigation":a(c=>({...c,navigableHeaders:!e}));break;case"enableCellVirtualization":a(c=>({...c,renderAllRows:!n,viewportColumnRenderingOffset:n?"auto":9}));break;case"enableCellEnterEditing":a(c=>({...c,enterBeginsEditing:!r}));break;case"enableArrowRLFirstLastColumn":a(c=>({...c,autoWrapRow:!i}));break;case"enableArrowTDFirstLastColumn":a(c=>({...c,autoWrapCol:!o}));break;case"enableEnterFocusEditing":a(c=>({...c,enterMoves:s.row!==1?{col:0,row:1}:{col:0,row:0}}));break}};return we.jsx(we.Fragment,{children:we.jsxs("div",{className:"checkboxContainer",children:[we.jsxs("div",{className:"checkboxGroup",children:[we.jsx("div",{children:we.jsxs("label",{className:"optionLabel",htmlFor:"enableTabNavigation",id:"tabNavigationLabel",children:[we.jsx("input",{checked:!t,type:"checkbox",id:"enableTabNavigation",name:"enableTabNavigation","aria-label":"Enable navigation with the Tab key",onChange:()=>l("enableTabNavigation")}),"Enable navigation with the Tab key"]})}),we.jsx("div",{children:we.jsxs("label",{className:"optionLabel",htmlFor:"enableHeaderNavigation",id:"headerNavigationLabel",children:[we.jsx("input",{checked:e,type:"checkbox",id:"enableHeaderNavigation",name:"enableHeaderNavigation","aria-labelledby":"headerNavigationLabel",onChange:()=>l("enableHeaderNavigation")}),"Enable navigation across headers"]})}),we.jsx("div",{children:we.jsxs("label",{className:"optionLabel",htmlFor:"enableCellVirtualization",id:"cellVirtualizationLabel",children:[we.jsx("input",{checked:!n,type:"checkbox",id:"enableCellVirtualization",name:"enableCellVirtualization","aria-labelledby":"cellVirtualizationLabel",onChange:()=>l("enableCellVirtualization")}),"Enable cells virtualization"]})}),we.jsxs("div",{children:[we.jsxs("label",{className:"optionLabel",htmlFor:"enableCellEnterEditing",id:"cellEnterEditingLabel",children:[we.jsx("input",{checked:r,type:"checkbox",id:"enableCellEnterEditing",name:"enableCellEnterEditing","aria-labelledby":"cellEnterEditingLabel",onChange:()=>l("enableCellEnterEditing")}),"The Enter key begins cell editing"]}),we.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#enterbeginsediting",target:"_blank",className:"externalLink",rel:"noopener noreferrer","aria-label":"Learn more about Enter key cell editing (opens in a new window)",children:we.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-external-link","aria-hidden":"true",children:[we.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),we.jsx("polyline",{points:"15 3 21 3 21 9"}),we.jsx("line",{x1:"10",x2:"21",y1:"14",y2:"3"})]})})]})]}),we.jsxs("div",{className:"checkboxGroup",children:[we.jsxs("div",{children:[we.jsxs("label",{className:"optionLabel",htmlFor:"enableArrowRLFirstLastColumn",id:"arrowRLFirstLastColumnLabel",children:[" ",we.jsx("input",{checked:i,type:"checkbox",id:"enableArrowRLFirstLastColumn",name:"enableArrowFirstLastColumn","aria-labelledby":"arrowRLFirstLastColumnLabel",onChange:()=>l("enableArrowRLFirstLastColumn")}),"The right/left arrow keys move the focus to the first/last column"]}),we.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#autowrapcol",target:"_blank",className:"externalLink",rel:"noopener noreferrer","aria-label":"Learn more about right/left arrow key behavior (opens in a new window)",children:we.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-external-link","aria-hidden":"true",children:[we.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),we.jsx("polyline",{points:"15 3 21 3 21 9"}),we.jsx("line",{x1:"10",x2:"21",y1:"14",y2:"3"})]})})]}),we.jsxs("div",{children:[we.jsxs("label",{className:"optionLabel",htmlFor:"enableArrowTDFirstLastColumn",id:"arrowTDFirstLastColumnLabel",children:[we.jsx("input",{checked:o,type:"checkbox",id:"enableArrowTDFirstLastColumn",name:"enableArrowTDFirstLastColumn","aria-labelledby":"arrowTDFirstLastColumnLabel",onChange:()=>l("enableArrowTDFirstLastColumn")}),"The up/down arrow keys move the focus to the first/last row"]}),we.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#autowraprow",target:"_blank",className:"externalLink",rel:"noopener noreferrer","aria-label":"Learn more about up/down arrow key behavior (opens in a new window)",children:we.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-external-link","aria-hidden":"true",children:[we.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),we.jsx("polyline",{points:"15 3 21 3 21 9"}),we.jsx("line",{x1:"10",x2:"21",y1:"14",y2:"3"})]})})]}),we.jsxs("div",{children:[we.jsxs("label",{className:"optionLabel",htmlFor:"enableEnterFocusEditing",id:"enterFocusEditingLabel",children:[we.jsx("input",{checked:s.row!==0,type:"checkbox",id:"enableEnterFocusEditing",name:"enableEnterFocusEditing","aria-labelledby":"enterFocusEditingLabel",onChange:()=>l("enableEnterFocusEditing")}),"The Enter key moves the focus after cell edition"]}),we.jsx("a",{href:"https://handsontable.com/docs/react-data-grid/api/options/#entermoves",target:"_blank",className:"externalLink",rel:"noopener noreferrer","aria-label":"Learn more about Enter key focus behavior (opens in a new window)",children:we.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-external-link","aria-hidden":"true",children:[we.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),we.jsx("polyline",{points:"15 3 21 3 21 9"}),we.jsx("line",{x1:"10",x2:"21",y1:"14",y2:"3"})]})})]})]})]})})}const Vk="odd",Bk=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]),xbe=(t,e,n,r,i)=>{if(n!==0)return;const o=t.parentElement;o!==null&&(e%2===0?le.dom.addClass(o,Vk):le.dom.removeClass(o,Vk))};function Pbe(t,e){if(t<0)return;const n=this.isRtl()?"htRight":"htLeft";e.firstChild&&(Bk.has(t.toString())?(le.dom.removeClass(e.firstChild,n),le.dom.addClass(e.firstChild,Bk.get(t.toString()))):le.dom.addClass(e.firstChild,n))}const Obe={data:jz,height:464,colWidths:[140,165,100,100,100,90,90,110,178],colHeaders:["Company name","Product name","Sell date","In stock","Qty","Progress","Rating","Order ID","Country"],dropdownMenu:!0,hiddenColumns:{indicators:!0},multiColumnSorting:!0,filters:!0,rowHeaders:!0,manualRowMove:!0,nestedRows:!0,afterGetColHeader:Pbe,beforeRenderer:xbe,licenseKey:"non-commercial-and-evaluation"};function Abe(){const[t,e]=vf.useState({disableTabNavigation:!1,navigableHeaders:!0,renderAllRows:!1,enterBeginsEditing:!0,autoWrapRow:!0,autoWrapCol:!0,enterMoves:{col:0,row:1}});return we.jsxs(we.Fragment,{children:[we.jsx(Mbe,{changeToggleOptions:e,...t}),we.jsx("input",{type:"text",placeholder:"Focusable text input"}),we.jsxs(f2,{...Obe,...t,children:[we.jsx(ho,{data:"companyName",type:"text"}),we.jsx(ho,{data:"productName",type:"text"}),we.jsx(ho,{data:"sellDate",type:"date",allowInvalid:!1}),we.jsx(ho,{data:"inStock",type:"checkbox",className:"htCenter"}),we.jsx(ho,{data:"qty",type:"numeric"}),we.jsx(ho,{data:"progress",readOnly:!0,className:"htMiddle",children:we.jsx(JSe,{"hot-renderer":!0})}),we.jsx(ho,{data:"rating",readOnly:!0,className:"htCenter",children:we.jsx(ebe,{"hot-renderer":!0})}),we.jsx(ho,{data:"orderId",type:"text"}),we.jsx(ho,{data:"country",type:"dropdown",source:_be})]},String(t.renderAllRows)),we.jsx("input",{type:"text",placeholder:"Focusable text input"})]})}Cb.createRoot(document.getElementById("root")).render(we.jsx(dn.StrictMode,{children:we.jsx(Abe,{})}))});export default Ibe();
